
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>100 | It so life</title>
<meta name="author" content="RobinChia">

<meta name="description" content="100%纯java调用windows的wmi获取监控数据 - 肖国颖的个人页面 - 开源中国社区开源中国社区

开源项目发现、使用和交流平台

项目
讨论
代码
资讯
翻译
博客
Android
招聘">


<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<meta property="og:title" content="100"/>
<meta property="og:site_name" content="It so life"/>

<!--[if IE]><style>.testIE.IE{display:inline;}</style><![endif]-->
<!--[if lte IE 7]><link rel="stylesheet" href="/css/ie7.css" type="text/css"><![endif]-->
<!--[if (lt IE 9)&(gt IE 7)]><style>.testIE.IE8{display:inline;}</style><![endif]-->
<!--[if gt IE 8]><style>.testIE.IE9{display:inline;}</style><![endif]-->

<link href="/favicon.png" rel="icon">
<link rel="alternate" href="/atom.xml" title="It so life Feed" type="application/atom+xml">

<link rel="stylesheet" href="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.0.3/css/font-awesome.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/prettify/r298/prettify.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" type="text/css">
<link rel="stylesheet" href="/css/style.css" type="text/css">
<!--[if lt IE 9]>
   <style>article,aside,dialog,footer,header,section,footer,nav,figure,menu{display:block}</style>
   <script src="http://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
   <script src="http://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
<link href="http://cdn.staticfile.org/respond.js/1.4.2/respond-proxy.html" id="respond-proxy" rel="respond-proxy" />
<link href="/js/respond.proxy.gif" id="respond-redirect" rel="respond-redirect" />
<script src="/js/respond.proxy.js"></script>
   <script src="http://cdn.bootcss.com/selectivizr/1.0.2/selectivizr-min.js"></script>
<![endif]-->
<script type="text/javascript">
function loadjs(c,d){var a=document.createElement("script");a.async=!0;a.type="text/javascript";a.src=c;a.charset=d||"gbk";(document.getElementsByTagName("HEAD")[0]||document.getElementsByTagName("BODY")[0]).appendChild(a)};
var _protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
var _js2load = [];
</script>

</head>
<body>
      <header id="header" class="container"><nav id="main-nav" class="navbar navbar-default navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="/">It so life</a>
    </div>
    <div  class="collapse navbar-collapse">
      <ul  class="nav navbar-nav">
  
        <li><a href="/" title="Home">Home</a></li>      
        <li><a href="/about/" title="About">About</a></li>      
        <li><a href="/archives/" title="Archives">Archives</a></li>      
      <li class='dropdown'>
        <a class='dropdown-toggle' data-toggle='dropdown' href='#'>website<b class='caret'></b></a>
        <ul class='dropdown-menu pure-menu-selected'>
    
          <li><a href="//groups.google.com/forum/#!forum/pongba" title="TopLanguage">TopLanguage</a></li>    
          <li><a href="//itpub.net/" title="ITPub">ITPub</a></li>    
          <li><a href="//blog.jobbole.com/" title="Bole">Bole</a></li>    
          <li><a href="//nosql-database.org/" title="nosql">nosql</a></li>    
          <li><a href="//gitimmersion.googol.im/" title="Git">Git</a></li>    
        </ul>
      </li>
    
      </ul>
      <ul class="nav navbar-nav navbar-right">
      
        <li><a href="/atom.xml">RSS</a></li>
      
      
        <li><a href="https://twitter.com/robinchia">twitter</a></li>
      
      
      
      
        <li><a href="https://github.com/robinchia">github</a></li>
      
      </ul>
    </div>
  </div>
</nav>
<div class="clearfix"></div>
</header>
  <div id='content' class="container">
     <div class="page-header-wrapper">
      <!--[if lt IE 9]><div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong>提示:</strong>您的浏览器版本太低了,建议升级到 <strong><a href="http://windows.microsoft.com/zh-cn/internet-explorer/download-ie" title="IE9">IE9</a></strong> 以上,本站使用<a href="https://www.google.com/intl/zh-CN/chrome/">Chrome浏览器</a>可以获得最好的显示效果.</div><![endif]-->
      <div class="page-header"><h1 align="center"><big>It so life</big> </h1>
        <h5 align="center"><big>love as life</big></h5>
      </div>
     </div>
     <div class="row">
       <div id="main-col" class="alignleft col-sx-12 col-sm-8 col-md-9 col-lg-9">
      <section id='header_widget'></section>
          <div id="wrapper"><article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title">100</h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:41.000Z"> <a href="/2014/02/02/2014-02-02-JavaJ2EE-java-com-wmi-监控--100-纯java调用windows的wmi获取监控数据-肖国颖的个人页面-开源中国社区/">feb. 2 2014</a></time></span>      
    </header>
    
    <section id='before_content_widget'></section>
    <div class="entry">
      
        <h1 id="100-java-windows-wmi-">100%纯java调用windows的wmi获取监控数据 - 肖国颖的个人页面 - 开源中国社区</h1>
<p><a href="http://www.oschina.net/" title="开源中国社区首页" target="_blank">开源中国社区</a></p>
<p>开源项目发现、使用和交流平台</p>
<ul>
<li><a href="http://www.oschina.net/project" target="_blank">项目</a></li>
<li><a href="http://www.oschina.net/question" target="_blank">讨论</a></li>
<li><a href="http://www.oschina.net/code/list" target="_blank">代码</a></li>
<li><a href="http://www.oschina.net/news" target="_blank">资讯</a></li>
<li><a href="http://www.oschina.net/translate" target="_blank">翻译</a></li>
<li><a href="http://www.oschina.net/blog" target="_blank">博客</a></li>
<li><a href="http://www.oschina.net/android" target="_blank">Android</a></li>
<li><a href="http://www.oschina.net/job" target="_blank">招聘</a></li>
</ul>
<p>当前访客身份： arctichia [ <a href="http://my.oschina.net/arcichia" target="_blank">我的空间</a> | <a href="http://my.oschina.net/action/user/logout?session=9c386f172b1174553110&amp;goto_page=http%3A%2F%2Fmy.oschina.net%2Fnoahxiao" target="_blank">退出</a> ]  <a href="http://my.oschina.net/arcichia/admin/inbox" title="进入我的留言箱" target="_blank">你有<em>0</em>新留言</a></p>
<p>软件 代码 讨论区 新闻 博客</p>
<p>软件</p>
<ul>
<li><a href="">软件</a></li>
<li><a href="">代码</a></li>
<li><a href="">讨论区</a></li>
<li><a href="">新闻</a></li>
<li><a href="">博客</a>
<a href="http://my.oschina.net/noahxiao" target="_blank"><img src="&quot;肖国颖&quot;" alt="肖国颖"></a>  <a href="http://my.oschina.net/noahxiao" title="男" target="_blank">肖国颖</a>  <img src="&quot;男&quot;" alt=""> <a href="&quot;成为TA的粉丝&quot;">关注此人</a></li>
</ul>
<p><a href="http://my.oschina.net/noahxiao/fellow" target="_blank">关注(4)</a> <a href="http://my.oschina.net/noahxiao/fans" target="_blank">粉丝(71)</a> <a href="http://www.oschina.net/question/3307_20931" title="查看OSCHINA积分规则" target="_blank">积分(280)</a></p>
<p>不做鬼中鬼，怎做人上人
<a href="">.发送留言</a> <a href="http://www.oschina.net/question/ask?user=569848" target="_blank">.请教问题</a></p>
<p><strong>博客分类</strong></p>
<ul>
<li><a href="http://my.oschina.net/noahxiao/blog?catalog=186739" target="_blank">工作日志</a>(47)</li>
<li><a href="http://my.oschina.net/noahxiao/blog?catalog=186740" target="_blank">日常记录</a>(0)</li>
<li><a href="http://my.oschina.net/noahxiao/blog?catalog=186741" target="_blank">转贴的文章</a>(0)
<strong>阅读排行</strong></li>
</ul>
<ol>
<li><a href="http://my.oschina.net/noahxiao/blog/61987" target="_blank">1. 在Android中嵌入AdMob广告，赚午饭钱</a></li>
<li><a href="http://my.oschina.net/noahxiao/blog/86328" target="_blank">2. 解决iOS6看YouTb的心酸，补充可看版(goagent+opendoor)</a></li>
<li><a href="http://my.oschina.net/noahxiao/blog/126357" target="_blank">3. 当单例（Singleton）爱上多线程——重复初始化问题</a></li>
<li><a href="http://my.oschina.net/noahxiao/blog/112759" target="_blank">4. Java序列化与JSON序列化大比拼</a></li>
<li><a href="http://my.oschina.net/noahxiao/blog/61495" target="_blank">5. 在Eclipse中用Scala语言开发Android应用</a></li>
<li><a href="http://my.oschina.net/noahxiao/blog/88687" target="_blank">6. Ubuntu 12.10下用Empathy（pidgin-lwqq）登录QQ</a></li>
<li><a href="http://my.oschina.net/noahxiao/blog/65071" target="_blank">7. 解决Ubuntu 12.04下频繁死机-Chrome</a></li>
<li><a href="http://my.oschina.net/noahxiao/blog/140771" target="_blank">8. 以Jar形式为Web项目提供资源文件（JS、CSS与图片）</a></li>
</ol>
<p><strong>最新评论</strong></p>
<ul>
<li><a href="http://my.oschina.net/wenshao" target="_blank">@wenshao</a>：fastjson缺省是做循环引用检测的，你关掉这个再测... <a href="http://my.oschina.net/action/tweet/go?obj=274988152&amp;type=18&amp;user=127152" target="_blank">查看»</a></li>
<li><a href="http://my.oschina.net/wenshao" target="_blank">@wenshao</a>：这个测试不对，你直接测试JavaBean而不是Map看看... <a href="http://my.oschina.net/action/tweet/go?obj=274988031&amp;type=18&amp;user=127152" target="_blank">查看»</a></li>
<li><a href="http://my.oschina.net/u/1182868" target="_blank">@rrstpit</a>：Fffff <a href="http://my.oschina.net/action/tweet/go?obj=274896306&amp;type=18&amp;user=1182868" target="_blank">查看»</a></li>
<li><a href="http://my.oschina.net/fxl" target="_blank">@付学良</a>：引用来自“xautlx”的评论 Servlet3规范好像已经... <a href="http://my.oschina.net/action/tweet/go?obj=274529269&amp;type=18&amp;user=83617" target="_blank">查看»</a></li>
<li><a href="http://my.oschina.net/112358" target="_blank">@yezheng1993</a>：引用来自“肖国颖”的评论 引用来自“yezheng19... <a href="http://my.oschina.net/action/tweet/go?obj=274481572&amp;type=18&amp;user=1173735" target="_blank">查看»</a></li>
<li><a href="http://my.oschina.net/noahxiao" target="_blank">@肖国颖</a>：引用来自“yezheng1993”的评论 请问一下怎么在那... <a href="http://my.oschina.net/action/tweet/go?obj=274479348&amp;type=18&amp;user=569848" target="_blank">查看»</a></li>
<li><a href="http://my.oschina.net/112358" target="_blank">@yezheng1993</a>：请问一下怎么在那边创建文件以及文件夹，新手，还... <a href="http://my.oschina.net/action/tweet/go?obj=274477519&amp;type=18&amp;user=1173735" target="_blank">查看»</a></li>
<li><a href="http://my.oschina.net/u/151176" target="_blank">@xautlx</a>：Servlet3规范好像已经有标准支持：<a href="https://blogs" target="_blank">https://blogs</a>... <a href="http://my.oschina.net/action/tweet/go?obj=274464191&amp;type=18&amp;user=151176" target="_blank">查看»</a></li>
<li><a href="http://my.oschina.net/u/613918" target="_blank">@ahnan</a>：www.webjars.org <a href="http://my.oschina.net/action/tweet/go?obj=274462857&amp;type=18&amp;user=613918" target="_blank">查看»</a></li>
<li><p><a href="http://my.oschina.net/wj2699" target="_blank">@wj2699</a>：spring的mvc确实有这么个功能，但是如果和apach... <a href="http://my.oschina.net/action/tweet/go?obj=274461745&amp;type=18&amp;user=106294" target="_blank">查看»</a>
<strong>访客统计</strong></p>
</li>
<li><p>今日访问：26</p>
</li>
<li>昨日访问：148</li>
<li>本周访问：389</li>
<li>本月访问：1573</li>
<li>所有访问：52224</li>
</ul>
<p><a href="http://my.oschina.net/noahxiao" target="_blank">空间</a> » <a href="http://my.oschina.net/noahxiao/blog" target="_blank">博客</a> » <a href="http://my.oschina.net/noahxiao/blog?catalog=186739" target="_blank">工作日志</a> » 博客正文</p>
<h1 id="-100-java-windows-wmi-"><img src="" alt=""> 100%纯java调用windows的wmi获取监控数据</h1>
<p><em>23</em>人收藏此文章,  <a href="&quot;添加到收藏夹&quot;">我要收藏</a>   发表于12个月前(2012-08-16 18:17) , 已有<strong>2348</strong>次阅读 ，共<strong><a href="">5</a></strong>个评论</p>
<p>纯java主要体现在可以跨平台调用com。所用的是j-Interop，它是100%纯java实现的com的调用</p>
<h3 id="1-">1、环境准备</h3>
<p>a、windows要开启Remote Registry与Windows Management Instrumentation服务</p>
<p>b、修改安全策略</p>
<p>我系统是英文的，如果是中文系统，翻译为中文，相对应的查找并修改。</p>
<p>Administrative Tools&gt;Local Security Policy&gt;Local Policy&gt;Security Policy&gt;Network access: Sharing and security model for local accounts</p>
<p>修改为Classic（经典）</p>
<p>c、禁用放火墙</p>
<p>d、window2008系统注册表越狱（高版本的win）</p>
<p>需要修改regedit中HKEY_CLASSES_ROOT\CLSID{76A64158-CB41-11D1-8B02-00600806D9B6}的权限，windows2008不再给Administrators完全控制权。</p>
<p>下载SetACL.exe，下载地址：<a href="http://files.helgeklein.com/downloads/SetACL/current/SetACL%20(executable%20version).zip" target="_blank">http://files.helgeklein.com/downloads/SetACL/current/SetACL%20(executable%20version).zip</a></p>
<p>set_wmi_reg_acl.cmd</p>
<p><a href="&quot;view source&quot;">view source</a><a href="&quot;print&quot;">print</a><a href="&quot;?&quot;">?</a></p>
<p>1</p>
<p>SetACL.exe -on</p>
<p>&quot;HKEY_CLASSES_ROOT\CLSID{76A64158-CB41-11D1-8B02-00600806D9B6}&quot;</p>
<p>-ot reg -actn setowner -ownr</p>
<p>&quot;n:Administrators&quot;</p>
<p>2</p>
<p>SetACL.exe -on</p>
<p>&quot;HKEY_CLASSES_ROOT\CLSID{76A64158-CB41-11D1-8B02-00600806D9B6}&quot;</p>
<p>-ot reg -actn ace -ace</p>
<p>&quot;n:Administrators;p:full&quot;</p>
<p>以超级管理员身份执行这个cms，就会把owner与完全控制权限授予Administrators组</p>
<h2 id="-">#</h2>
<h3 id="2-">2、程序代码</h3>
<p>java类</p>
<p><a href="&quot;view source&quot;">view source</a><a href="&quot;print&quot;">print</a><a href="&quot;?&quot;">?</a></p>
<p>001</p>
<p>package</p>
<p>org.noah.wmitest;</p>
<p>002</p>
<p>003</p>
<p>import</p>
<p>org.jinterop.dcom.common.JIException;</p>
<p>004</p>
<p>import</p>
<p>org.jinterop.dcom.common.JISystem;
005</p>
<p>import</p>
<p>org.jinterop.dcom.core./*;</p>
<p>006</p>
<p>import</p>
<p>org.jinterop.dcom.impls.JIObjectFactory;
007</p>
<p>import</p>
<p>org.jinterop.dcom.impls.automation.IJIDispatch;</p>
<p>008</p>
<p>import</p>
<p>org.jinterop.dcom.impls.automation.IJIEnumVariant;
009</p>
<p>import</p>
<p>org.slf4j.Logger;</p>
<p>010</p>
<p>import</p>
<p>org.slf4j.LoggerFactory;
011</p>
<p>012</p>
<p>import</p>
<p>java.net.UnknownHostException;
013</p>
<p>import</p>
<p>java.util.logging.Level;</p>
<p>014</p>
<p>015</p>
<p>//<em>/</em></p>
<p>016</p>
<p>/* Created with IntelliJ IDEA.
017</p>
<p>/* User: noah</p>
<p>018</p>
<p>/* Date: 8/16/12
019</p>
<p>/* Time: 8:00 AM</p>
<p>020</p>
<p>/* To change this template use File | Settings | File Templates.
021</p>
<p>/*/</p>
<p>022</p>
<p>public</p>
<p>class</p>
<p>WmiService {
023</p>
<p>024</p>
<p>private</p>
<p>JIComServer m_ComStub =</p>
<p>null</p>
<p>;
025</p>
<p>private</p>
<p>IJIComObject m_ComObject =</p>
<p>null</p>
<p>;</p>
<p>026</p>
<p>private</p>
<p>IJIDispatch m_Dispatch =</p>
<p>null</p>
<p>;
027</p>
<p>private</p>
<p>String m_Address =</p>
<p>null</p>
<p>;</p>
<p>028</p>
<p>private</p>
<p>JISession m_Session =</p>
<p>null</p>
<p>;
029</p>
<p>private</p>
<p>IJIDispatch m_WbemServices =</p>
<p>null</p>
<p>;</p>
<p>030</p>
<p>031</p>
<p>private</p>
<p>static</p>
<p>final</p>
<p>String WMI_CLSID =</p>
<p>&quot;76A6415B-CB41-11d1-8B02-00600806D9B6&quot;</p>
<p>;</p>
<p>032</p>
<p>private</p>
<p>static</p>
<p>final</p>
<p>String WMI_PROGID =</p>
<p>&quot;WbemScripting.SWbemLocator&quot;</p>
<p>;
033</p>
<p>034</p>
<p>private</p>
<p>Logger logger = LoggerFactory.getLogger(</p>
<p>this</p>
<p>.getClass());
035</p>
<p>036</p>
<p>037</p>
<p>public</p>
<p>WmiService(String address) {</p>
<p>038</p>
<p>JISystem.setAutoRegisteration(</p>
<p>true</p>
<p>);
039</p>
<p>JISystem.getLogger().setLevel(Level.WARNING);</p>
<p>040</p>
<p>m_Address = address;
041</p>
<p>}</p>
<p>042</p>
<p>043</p>
<p>public</p>
<p>void</p>
<p>query(String strQuery) {</p>
<p>044</p>
<p>045</p>
<p>System.out.println(</p>
<p>&quot;query:&quot;</p>
<ul>
<li>strQuery);</li>
</ul>
<p>046</p>
<p>047</p>
<p>JIVariant results[] =</p>
<p>new</p>
<p>JIVariant[</p>
<p>0</p>
<p>];</p>
<p>048</p>
<p>try</p>
<p>{
049</p>
<p>results = m_WbemServices.callMethodA(</p>
<p>&quot;ExecQuery&quot;</p>
<p>,</p>
<p>new</p>
<p>Object[]{</p>
<p>new</p>
<p>JIString(strQuery), JIVariant.OPTIONAL_PARAM(), JIVariant.OPTIONAL_PARAM(), JIVariant.OPTIONAL_PARAM()});</p>
<p>050</p>
<p>IJIDispatch wOSd = (IJIDispatch) JIObjectFactory.narrowObject((results[</p>
<p>0</p>
<p>]).getObjectAsComObject());
051</p>
<p>052</p>
<p>int</p>
<p>count = wOSd.get(</p>
<p>&quot;Count&quot;</p>
<p>).getObjectAsInt();
053</p>
<p>054</p>
<p>IJIComObject enumComObject = wOSd.get(</p>
<p>&quot;_NewEnum&quot;</p>
<p>).getObjectAsComObject();
055</p>
<p>IJIEnumVariant enumVariant = (IJIEnumVariant) JIObjectFactory.narrowObject(enumComObject.queryInterface(IJIEnumVariant.IID));</p>
<p>056</p>
<p>057</p>
<p>IJIDispatch wbemObject_dispatch =</p>
<p>null</p>
<p>;</p>
<p>058</p>
<p>059</p>
<p>for</p>
<p>(</p>
<p>int</p>
<p>c =</p>
<p>0</p>
<p>; c &lt; count; c++) {</p>
<p>060</p>
<p>061</p>
<p>Object[] values = enumVariant.next(</p>
<p>1</p>
<p>);</p>
<p>062</p>
<p>JIArray array = (JIArray) values[</p>
<p>0</p>
<p>];
063</p>
<p>Object[] arrayObj = (Object[]) array.getArrayInstance();</p>
<p>064</p>
<p>for</p>
<p>(</p>
<p>int</p>
<p>j =</p>
<p>0</p>
<p>; j &lt; arrayObj.length; j++) {
065</p>
<p>wbemObject_dispatch = (IJIDispatch) JIObjectFactory.narrowObject(((JIVariant) arrayObj[j]).getObjectAsComObject());</p>
<p>066</p>
<p>}
067</p>
<p>068</p>
<p>String str = (wbemObject_dispatch.callMethodA(</p>
<p>&quot;GetObjectText_&quot;</p>
<p>,</p>
<p>new</p>
<p>Object[]{</p>
<p>1</p>
<p>}))[</p>
<p>0</p>
<p>].getObjectAsString2();
069</p>
<p>System.out.println(</p>
<p>&quot;(&quot;</p>
<ul>
<li>c +</li>
</ul>
<p>&quot;):&quot;</p>
<p>);</p>
<p>070</p>
<p>System.out.println(str);
071</p>
<p>System.out.println();</p>
<p>072</p>
<p>}
073</p>
<p>074</p>
<p>075</p>
<p>}</p>
<p>catch</p>
<p>(JIException e) {</p>
<p>076</p>
<p>e.printStackTrace();
077</p>
<p>}</p>
<p>078</p>
<p>}
079</p>
<p>080</p>
<p>public</p>
<p>void</p>
<p>connect(</p>
<p>final</p>
<p>String domain,</p>
<p>final</p>
<p>String username,</p>
<p>final</p>
<p>String password) {
081</p>
<p>try</p>
<p>{</p>
<p>082</p>
<p>083</p>
<p>m_Session = JISession.createSession(domain, username, password);</p>
<p>084</p>
<p>m_Session.useSessionSecurity(</p>
<p>true</p>
<p>);
085</p>
<p>m_Session.setGlobalSocketTimeout(</p>
<p>5000</p>
<p>);</p>
<p>086</p>
<p>087</p>
<p>m_ComStub =</p>
<p>new</p>
<p>JIComServer(JIProgId.valueOf(WMI_PROGID), m_Address, m_Session);</p>
<p>088</p>
<p>089</p>
<p>IJIComObject unknown = m_ComStub.createInstance();</p>
<p>090</p>
<p>m_ComObject = unknown.queryInterface(WMI_CLSID);
091</p>
<p>092</p>
<p>m_Dispatch = (IJIDispatch) JIObjectFactory.narrowObject(m_ComObject.queryInterface(IJIDispatch.IID));
093</p>
<p>JIVariant results[] = m_Dispatch.callMethodA(</p>
<p>094</p>
<p>&quot;ConnectServer&quot;</p>
<p>,
095</p>
<p>new</p>
<p>Object[]{</p>
<p>096</p>
<p>new</p>
<p>JIString(m_Address),
097</p>
<p>JIVariant.OPTIONAL_PARAM(),</p>
<p>098</p>
<p>JIVariant.OPTIONAL_PARAM(),
099</p>
<p>JIVariant.OPTIONAL_PARAM(),</p>
<p>100</p>
<p>JIVariant.OPTIONAL_PARAM(),
101</p>
<p>JIVariant.OPTIONAL_PARAM(),</p>
<p>102</p>
<p>0</p>
<p>,
103</p>
<p>JIVariant.OPTIONAL_PARAM()</p>
<p>104</p>
<p>}
105</p>
<p>);</p>
<p>106</p>
<p>107</p>
<p>m_WbemServices = (IJIDispatch) JIObjectFactory.narrowObject((results[</p>
<p>0</p>
<p>]).getObjectAsComObject());</p>
<p>108</p>
<p>109</p>
<p>}</p>
<p>catch</p>
<p>(JIException e) {</p>
<p>110</p>
<p>e.printStackTrace();
111</p>
<p>if</p>
<p>(m_Session !=</p>
<p>null</p>
<p>) {</p>
<p>112</p>
<p>try</p>
<p>{
113</p>
<p>JISession.destroySession(m_Session);</p>
<p>114</p>
<p>}</p>
<p>catch</p>
<p>(JIException e1) {
115</p>
<p>logger.error(e.getMessage(), e);</p>
<p>116</p>
<p>}
117</p>
<p>}</p>
<p>118</p>
<p>}</p>
<p>catch</p>
<p>(UnknownHostException e) {
119</p>
<p>if</p>
<p>(m_Session !=</p>
<p>null</p>
<p>) {</p>
<p>120</p>
<p>try</p>
<p>{
121</p>
<p>JISession.destroySession(m_Session);</p>
<p>122</p>
<p>}</p>
<p>catch</p>
<p>(JIException e1) {
123</p>
<p>logger.error(e.getMessage(), e);</p>
<p>124</p>
<p>}
125</p>
<p>}</p>
<p>126</p>
<p>}
127</p>
<p>}</p>
<p>128</p>
<p>129</p>
<p>public</p>
<p>void</p>
<p>disconnect() {</p>
<p>130</p>
<p>try</p>
<p>{
131</p>
<p>JISession.destroySession(m_Session);</p>
<p>132</p>
<p>}</p>
<p>catch</p>
<p>(JIException e) {
133</p>
<p>logger.error(e.getMessage(), e);</p>
<p>134</p>
<p>}
135</p>
<p>}</p>
<p>136</p>
<p>137</p>
<p>138</p>
<p>public</p>
<p>static</p>
<p>void</p>
<p>main(String[] args) {
139</p>
<p>140</p>
<p>WmiService wmiService =</p>
<p>new</p>
<p>WmiService(</p>
<p>&quot;172.16.158.129&quot;</p>
<p>);
141</p>
<p>142</p>
<p>//域（一般为空字符），用户名，密码
143</p>
<p>wmiService.connect(</p>
<p>&quot;&quot;</p>
<p>,</p>
<p>&quot;username&quot;</p>
<p>,</p>
<p>&quot;password&quot;</p>
<p>);</p>
<p>144</p>
<p>145</p>
<p>//系统信息</p>
<p>146</p>
<p>wmiService.query(</p>
<p>&quot;SELECT /* FROM Win32_ComputerSystem&quot;</p>
<p>);
147</p>
<p>148</p>
<p>//CPU信息
149</p>
<p>wmiService.query(</p>
<p>&quot;SELECT /* FROM Win32_PerfFormattedData_PerfOS_Processor WHERE Name != &#39;_Total&#39;&quot;</p>
<p>);</p>
<p>150</p>
<p>151</p>
<p>//内存信息</p>
<p>152</p>
<p>wmiService.query(</p>
<p>&quot;SELECT /* FROM Win32_PerfFormattedData_PerfOS_Memory&quot;</p>
<p>);
153</p>
<p>154</p>
<p>//磁盘信息
155</p>
<p>wmiService.query(</p>
<p>&quot;SELECT /* FROM Win32_PerfRawData_PerfDisk_PhysicalDisk Where Name != &#39;_Total&#39;&quot;</p>
<p>);</p>
<p>156</p>
<p>157</p>
<p>wmiService.disconnect();</p>
<p>158</p>
<p>}
159</p>
<p>}</p>
<p>mavne配置(pom.xml)
<a href="&quot;view source&quot;">view source</a><a href="&quot;print&quot;">print</a><a href="&quot;?&quot;">?</a></p>
<p>01</p>
<p>&lt;?</p>
<p>xml</p>
<p>version</p>
<p>=</p>
<p>&quot;1.0&quot;</p>
<p>encoding</p>
<p>=</p>
<p>&quot;UTF-8&quot;</p>
<p>?&gt;</p>
<p>02</p>
<p>&lt;</p>
<p>project</p>
<p>xmlns</p>
<p>=</p>
<p>&quot;<a href="http://maven.apache.org/POM/4.0.0" target="_blank">http://maven.apache.org/POM/4.0.0</a>&quot;
03</p>
<p>xmlns:xsi</p>
<p>=</p>
<p>&quot;<a href="http://www.w3.org/2001/XMLSchema-instance" target="_blank">http://www.w3.org/2001/XMLSchema-instance</a>&quot;</p>
<p>04</p>
<p>xsi:schemaLocation</p>
<p>=</p>
<p>&quot;<a href="http://maven.apache.org/POM/4.0.0" target="_blank">http://maven.apache.org/POM/4.0.0</a> <a href="http://maven.apache.org/xsd/maven-4.0.0.xsd" target="_blank">http://maven.apache.org/xsd/maven-4.0.0.xsd</a>&quot;</p>
<p>&gt;
05</p>
<p>&lt;</p>
<p>modelVersion</p>
<blockquote>
<p>4.0.0&lt;/</p>
</blockquote>
<p>modelVersion</p>
<p>&gt;</p>
<p>06</p>
<p>07</p>
<p>&lt;</p>
<p>groupId</p>
<blockquote>
<p>org.noahx&lt;/</p>
</blockquote>
<p>groupId</p>
<p>&gt;</p>
<p>08</p>
<p>&lt;</p>
<p>artifactId</p>
<blockquote>
<p>wmi-test&lt;/</p>
</blockquote>
<p>artifactId</p>
<p>&gt;
09</p>
<p>&lt;</p>
<p>version</p>
<blockquote>
<p>1.0&lt;/</p>
</blockquote>
<p>version</p>
<p>&gt;</p>
<p>10</p>
<p>11</p>
<p>12</p>
<p>&lt;</p>
<p>dependencies</p>
<p>&gt;
13</p>
<p>14</p>
<p>&lt;</p>
<p>dependency</p>
<p>&gt;
15</p>
<p>&lt;</p>
<p>groupId</p>
<blockquote>
<p>org.kohsuke.jinterop&lt;/</p>
</blockquote>
<p>groupId</p>
<p>&gt;</p>
<p>16</p>
<p>&lt;</p>
<p>artifactId</p>
<blockquote>
<p>j-interop&lt;/</p>
</blockquote>
<p>artifactId</p>
<p>&gt;
17</p>
<p>&lt;</p>
<p>version</p>
<blockquote>
<p>2.0.8-kohsuke-1&lt;/</p>
</blockquote>
<p>version</p>
<p>&gt;</p>
<p>18</p>
<p>&lt;/</p>
<p>dependency</p>
<p>&gt;
19</p>
<p>20</p>
<p>&lt;</p>
<p>dependency</p>
<p>&gt;
21</p>
<p>&lt;</p>
<p>groupId</p>
<blockquote>
<p>org.slf4j&lt;/</p>
</blockquote>
<p>groupId</p>
<p>&gt;</p>
<p>22</p>
<p>&lt;</p>
<p>artifactId</p>
<blockquote>
<p>slf4j-log4j12&lt;/</p>
</blockquote>
<p>artifactId</p>
<p>&gt;
23</p>
<p>&lt;</p>
<p>version</p>
<blockquote>
<p>1.6.4&lt;/</p>
</blockquote>
<p>version</p>
<p>&gt;</p>
<p>24</p>
<p>&lt;/</p>
<p>dependency</p>
<p>&gt;
25</p>
<p>26</p>
<p>&lt;/</p>
<p>dependencies</p>
<p>&gt;
27</p>
<p>28</p>
<p>&lt;/</p>
<p>project</p>
<p>&gt;</p>
<p>运行结果</p>
<p><a href="&quot;view source&quot;">view source</a><a href="&quot;print&quot;">print</a><a href="&quot;?&quot;">?</a></p>
<p>001</p>
<p>query:SELECT /* FROM Win32_ComputerSystem</p>
<p>002</p>
<p>(0):
003</p>
<p>004</p>
<p>instance of Win32_ComputerSystem
005</p>
<p>{</p>
<p>006</p>
<p>AdminPasswordStatus = 1;
007</p>
<p>AutomaticResetBootOption = FALSE;</p>
<p>008</p>
<p>AutomaticResetCapability = TRUE;
009</p>
<p>BootOptionOnLimit = 3;</p>
<p>010</p>
<p>BootOptionOnWatchDog = 3;
011</p>
<p>BootROMSupported = TRUE;</p>
<p>012</p>
<p>BootupState =</p>
<p>&quot;Normal boot&quot;</p>
<p>;
013</p>
<p>Caption =</p>
<p>&quot;NAK-E1A7C21EA3C&quot;</p>
<p>;</p>
<p>014</p>
<p>ChassisBootupState = 3;
015</p>
<p>CreationClassName =</p>
<p>&quot;Win32_ComputerSystem&quot;</p>
<p>;</p>
<p>016</p>
<p>CurrentTimeZone = 480;
017</p>
<p>Description =</p>
<p>&quot;AT/AT COMPATIBLE&quot;</p>
<p>;</p>
<p>018</p>
<p>Domain =</p>
<p>&quot;WORKGROUP&quot;</p>
<p>;
019</p>
<p>DomainRole = 0;</p>
<p>020</p>
<p>EnableDaylightSavingsTime = TRUE;
021</p>
<p>FrontPanelResetStatus = 3;</p>
<p>022</p>
<p>InfraredSupported = FALSE;
023</p>
<p>KeyboardPasswordStatus = 3;</p>
<p>024</p>
<p>Manufacturer =</p>
<p>&quot;VMware, Inc.&quot;</p>
<p>;
025</p>
<p>Model =</p>
<p>&quot;VMware Virtual Platform&quot;</p>
<p>;</p>
<p>026</p>
<p>Name =</p>
<p>&quot;NAK-E1A7C21EA3C&quot;</p>
<p>;
027</p>
<p>NetworkServerModeEnabled = TRUE;</p>
<p>028</p>
<p>NumberOfLogicalProcessors = 2;
029</p>
<p>NumberOfProcessors = 1;</p>
<p>030</p>
<p>OEMStringArray = {</p>
<p>&quot;[MS_VM_CERT/SHA1/27d66596a61c48dd3dc7216fd715126e33f59ae7]&quot;</p>
<p>,</p>
<p>&quot;Welcome to the Virtual Machine&quot;</p>
<p>};
031</p>
<p>PartOfDomain = FALSE;</p>
<p>032</p>
<p>PauseAfterReset =</p>
<p>&quot;3932100000&quot;</p>
<p>;
033</p>
<p>PowerOnPasswordStatus = 0;</p>
<p>034</p>
<p>PowerState = 0;
035</p>
<p>PowerSupplyState = 3;</p>
<p>036</p>
<p>PrimaryOwnerName =</p>
<p>&quot;nak&quot;</p>
<p>;
037</p>
<p>ResetCapability = 1;</p>
<p>038</p>
<p>ResetCount = -1;
039</p>
<p>ResetLimit = -1;</p>
<p>040</p>
<p>Roles = {</p>
<p>&quot;LM_Workstation&quot;</p>
<p>,</p>
<p>&quot;LM_Server&quot;</p>
<p>,</p>
<p>&quot;NT&quot;</p>
<p>,</p>
<p>&quot;Potential_Browser&quot;</p>
<p>,</p>
<p>&quot;Master_Browser&quot;</p>
<p>};
041</p>
<p>Status =</p>
<p>&quot;OK&quot;</p>
<p>;</p>
<p>042</p>
<p>SystemStartupDelay = 0;
043</p>
<p>SystemStartupOptions = {</p>
<p>&quot;\&quot;Microsoft Windows XP Professional\&quot; /noexecute=optin /fastdetect&quot;</p>
<p>};</p>
<p>044</p>
<p>SystemStartupSetting = 0;
045</p>
<p>SystemType =</p>
<p>&quot;X86-based PC&quot;</p>
<p>;</p>
<p>046</p>
<p>ThermalState = 3;
047</p>
<p>TotalPhysicalMemory =</p>
<p>&quot;1610063872&quot;</p>
<p>;</p>
<p>048</p>
<p>UserName =</p>
<p>&quot;NAK-E1A7C21EA3C\a&quot;</p>
<p>;
049</p>
<p>WakeUpType = 6;</p>
<p>050</p>
<p>};
051</p>
<p>052</p>
<p>053</p>
<p>query:SELECT /* FROM Win32_PerfFormattedData_PerfOS_Processor WHERE Name !=</p>
<p>&#39;_Total&#39;</p>
<p>054</p>
<p>(0):
055</p>
<p>056</p>
<p>instance of Win32_PerfFormattedData_PerfOS_Processor
057</p>
<p>{</p>
<p>058</p>
<p>C1TransitionsPersec =</p>
<p>&quot;77&quot;</p>
<p>;
059</p>
<p>C2TransitionsPersec =</p>
<p>&quot;0&quot;</p>
<p>;</p>
<p>060</p>
<p>C3TransitionsPersec =</p>
<p>&quot;0&quot;</p>
<p>;
061</p>
<p>DPCRate = 0;</p>
<p>062</p>
<p>DPCsQueuedPersec = 4;
063</p>
<p>InterruptsPersec = 71;</p>
<p>064</p>
<p>Name =</p>
<p>&quot;0&quot;</p>
<p>;
065</p>
<p>PercentC1Time =</p>
<p>&quot;96&quot;</p>
<p>;</p>
<p>066</p>
<p>PercentC2Time =</p>
<p>&quot;0&quot;</p>
<p>;
067</p>
<p>PercentC3Time =</p>
<p>&quot;0&quot;</p>
<p>;</p>
<p>068</p>
<p>PercentDPCTime =</p>
<p>&quot;0&quot;</p>
<p>;
069</p>
<p>PercentIdleTime =</p>
<p>&quot;100&quot;</p>
<p>;</p>
<p>070</p>
<p>PercentInterruptTime =</p>
<p>&quot;0&quot;</p>
<p>;
071</p>
<p>PercentPrivilegedTime =</p>
<p>&quot;0&quot;</p>
<p>;</p>
<p>072</p>
<p>PercentProcessorTime =</p>
<p>&quot;0&quot;</p>
<p>;
073</p>
<p>PercentUserTime =</p>
<p>&quot;0&quot;</p>
<p>;</p>
<p>074</p>
<p>};
075</p>
<p>076</p>
<p>077</p>
<p>(1):</p>
<p>078</p>
<p>079</p>
<p>instance of Win32_PerfFormattedData_PerfOS_Processor</p>
<p>080</p>
<p>{
081</p>
<p>C1TransitionsPersec =</p>
<p>&quot;83&quot;</p>
<p>;</p>
<p>082</p>
<p>C2TransitionsPersec =</p>
<p>&quot;0&quot;</p>
<p>;
083</p>
<p>C3TransitionsPersec =</p>
<p>&quot;0&quot;</p>
<p>;</p>
<p>084</p>
<p>DPCRate = 0;
085</p>
<p>DPCsQueuedPersec = 10;</p>
<p>086</p>
<p>InterruptsPersec = 67;
087</p>
<p>Name =</p>
<p>&quot;1&quot;</p>
<p>;</p>
<p>088</p>
<p>PercentC1Time =</p>
<p>&quot;96&quot;</p>
<p>;
089</p>
<p>PercentC2Time =</p>
<p>&quot;0&quot;</p>
<p>;</p>
<p>090</p>
<p>PercentC3Time =</p>
<p>&quot;0&quot;</p>
<p>;
091</p>
<p>PercentDPCTime =</p>
<p>&quot;0&quot;</p>
<p>;</p>
<p>092</p>
<p>PercentIdleTime =</p>
<p>&quot;100&quot;</p>
<p>;
093</p>
<p>PercentInterruptTime =</p>
<p>&quot;0&quot;</p>
<p>;</p>
<p>094</p>
<p>PercentPrivilegedTime =</p>
<p>&quot;0&quot;</p>
<p>;
095</p>
<p>PercentProcessorTime =</p>
<p>&quot;0&quot;</p>
<p>;</p>
<p>096</p>
<p>PercentUserTime =</p>
<p>&quot;0&quot;</p>
<p>;
097</p>
<p>};</p>
<p>098</p>
<p>099</p>
<p>100</p>
<p>query:SELECT /* FROM Win32_PerfFormattedData_PerfOS_Memory
101</p>
<p>(0):</p>
<p>102</p>
<p>103</p>
<p>instance of Win32_PerfFormattedData_PerfOS_Memory</p>
<p>104</p>
<p>{
105</p>
<p>AvailableBytes =</p>
<p>&quot;1142099968&quot;</p>
<p>;</p>
<p>106</p>
<p>AvailableKBytes =</p>
<p>&quot;1115332&quot;</p>
<p>;
107</p>
<p>AvailableMBytes =</p>
<p>&quot;1089&quot;</p>
<p>;</p>
<p>108</p>
<p>CacheBytes =</p>
<p>&quot;70725632&quot;</p>
<p>;
109</p>
<p>CacheBytesPeak =</p>
<p>&quot;72904704&quot;</p>
<p>;</p>
<p>110</p>
<p>CacheFaultsPersec = 634;
111</p>
<p>CommitLimit =</p>
<p>&quot;3063078912&quot;</p>
<p>;</p>
<p>112</p>
<p>CommittedBytes =</p>
<p>&quot;326488064&quot;</p>
<p>;
113</p>
<p>DemandZeroFaultsPersec = 13965;</p>
<p>114</p>
<p>FreeSystemPageTableEntries = 159743;
115</p>
<p>PageFaultsPersec = 13965;</p>
<p>116</p>
<p>PageReadsPersec = 0;
117</p>
<p>PagesInputPersec = 0;</p>
<p>118</p>
<p>PagesOutputPersec = 0;
119</p>
<p>PagesPersec = 0;</p>
<p>120</p>
<p>PageWritesPersec = 0;
121</p>
<p>PercentCommittedBytesInUse = 10;</p>
<p>122</p>
<p>PoolNonpagedAllocs = 38040;
123</p>
<p>PoolNonpagedBytes =</p>
<p>&quot;7585792&quot;</p>
<p>;</p>
<p>124</p>
<p>PoolPagedAllocs = 57820;
125</p>
<p>PoolPagedBytes =</p>
<p>&quot;29380608&quot;</p>
<p>;</p>
<p>126</p>
<p>PoolPagedResidentBytes =</p>
<p>&quot;28622848&quot;</p>
<p>;
127</p>
<p>SystemCacheResidentBytes =</p>
<p>&quot;40235008&quot;</p>
<p>;</p>
<p>128</p>
<p>SystemCodeResidentBytes =</p>
<p>&quot;1867776&quot;</p>
<p>;
129</p>
<p>SystemCodeTotalBytes =</p>
<p>&quot;1167360&quot;</p>
<p>;</p>
<p>130</p>
<p>SystemDriverResidentBytes =</p>
<p>&quot;0&quot;</p>
<p>;
131</p>
<p>SystemDriverTotalBytes =</p>
<p>&quot;4071424&quot;</p>
<p>;</p>
<p>132</p>
<p>TransitionFaultsPersec = 0;
133</p>
<p>WriteCopiesPersec = 0;</p>
<p>134</p>
<p>};
135</p>
<p>136</p>
<p>137</p>
<p>query:SELECT /* FROM Win32_PerfRawData_PerfDisk_PhysicalDisk Where Name !=</p>
<p>&#39;_Total&#39;</p>
<p>138</p>
<p>(0):
139</p>
<p>140</p>
<p>instance of Win32_PerfRawData_PerfDisk_PhysicalDisk
141</p>
<p>{</p>
<p>142</p>
<p>AvgDiskBytesPerRead =</p>
<p>&quot;138920448&quot;</p>
<p>;
143</p>
<p>AvgDiskBytesPerRead_Base = 8000;</p>
<p>144</p>
<p>AvgDiskBytesPerTransfer =</p>
<p>&quot;208285696&quot;</p>
<p>;
145</p>
<p>AvgDiskBytesPerTransfer_Base = 13701;</p>
<p>146</p>
<p>AvgDiskBytesPerWrite =</p>
<p>&quot;69365248&quot;</p>
<p>;
147</p>
<p>AvgDiskBytesPerWrite_Base = 5701;</p>
<p>148</p>
<p>AvgDiskQueueLength =</p>
<p>&quot;581460650&quot;</p>
<p>;
149</p>
<p>AvgDiskReadQueueLength =</p>
<p>&quot;405581626&quot;</p>
<p>;</p>
<p>150</p>
<p>AvgDisksecPerRead = 2794786622;
151</p>
<p>AvgDisksecPerRead_Base = 8000;</p>
<p>152</p>
<p>AvgDisksecPerTransfer = 322083534;
153</p>
<p>AvgDisksecPerTransfer_Base = 13701;</p>
<p>154</p>
<p>AvgDisksecPerWrite = 1822264208;
155</p>
<p>AvgDisksecPerWrite_Base = 5701;</p>
<p>156</p>
<p>AvgDiskWriteQueueLength =</p>
<p>&quot;175879024&quot;</p>
<p>;
157</p>
<p>CurrentDiskQueueLength = 0;</p>
<p>158</p>
<p>DiskBytesPersec =</p>
<p>&quot;208285696&quot;</p>
<p>;
159</p>
<p>DiskReadBytesPersec =</p>
<p>&quot;138920448&quot;</p>
<p>;</p>
<p>160</p>
<p>DiskReadsPersec = 8000;
161</p>
<p>DiskTransfersPersec = 13701;</p>
<p>162</p>
<p>DiskWriteBytesPersec =</p>
<p>&quot;69365248&quot;</p>
<p>;
163</p>
<p>DiskWritesPersec = 5701;</p>
<p>164</p>
<p>Frequency_Object =</p>
<p>&quot;0&quot;</p>
<p>;
165</p>
<p>Frequency_PerfTime =</p>
<p>&quot;3034010000&quot;</p>
<p>;</p>
<p>166</p>
<p>Frequency_Sys100NS =</p>
<p>&quot;10000000&quot;</p>
<p>;
167</p>
<p>Name =</p>
<p>&quot;0 C:&quot;</p>
<p>;</p>
<p>168</p>
<p>PercentDiskReadTime =</p>
<p>&quot;405581626&quot;</p>
<p>;
169</p>
<p>PercentDiskReadTime_Base =</p>
<p>&quot;129895856572522792&quot;</p>
<p>;</p>
<p>170</p>
<p>PercentDiskTime =</p>
<p>&quot;581460650&quot;</p>
<p>;
171</p>
<p>PercentDiskTime_Base =</p>
<p>&quot;129895856572522792&quot;</p>
<p>;</p>
<p>172</p>
<p>PercentDiskWriteTime =</p>
<p>&quot;175879024&quot;</p>
<p>;
173</p>
<p>PercentDiskWriteTime_Base =</p>
<p>&quot;129895856572522792&quot;</p>
<p>;</p>
<p>174</p>
<p>PercentIdleTime =</p>
<p>&quot;18446744072967667781&quot;</p>
<p>;
175</p>
<p>PercentIdleTime_Base =</p>
<p>&quot;129895856572522792&quot;</p>
<p>;</p>
<p>176</p>
<p>SplitIOPerSec = 1074;
177</p>
<p>Timestamp_Object =</p>
<p>&quot;0&quot;</p>
<p>;</p>
<p>178</p>
<p>Timestamp_PerfTime =</p>
<p>&quot;3635534093651&quot;</p>
<p>;
179</p>
<p>Timestamp_Sys100NS =</p>
<p>&quot;129895856572522792&quot;</p>
<p>;</p>
<p>180</p>
<p>};&lt;span style=</p>
<p>&quot;font-family:&#39;sans serif, tahoma, verdana, helvetica&#39;;font-size:x-small;&quot;</p>
<blockquote>
<p>&lt;span style=</p>
</blockquote>
<p>&quot;line-height:18.18181800842285px;white-space:normal;&quot;</p>
<blockquote>
<p></span></span></p>
</blockquote>
<h2 id="-">#</h2>
<h3 id="3-">3、有可能出现的问题</h3>
<p>报错a</p>
<p><a href="&quot;view source&quot;">view source</a><a href="&quot;print&quot;">print</a><a href="&quot;?&quot;">?</a></p>
<p>01</p>
<p>org.jinterop.dcom.common.JIException: Message not found</p>
<p>for</p>
<p>errorCode:</p>
<p>0xC0000034</p>
<p>02</p>
<p>at org.jinterop.winreg.smb.JIWinRegStub.winreg_OpenHKLM(JIWinRegStub.java:</p>
<p>115</p>
<p>)
03</p>
<p>at org.jinterop.dcom.core.JIProgId.getIdFromWinReg(JIProgId.java:</p>
<p>130</p>
<p>)</p>
<p>04</p>
<p>at org.jinterop.dcom.core.JIProgId.getCorrespondingCLSID(JIProgId.java:</p>
<p>162</p>
<p>)
05</p>
<p>at org.jinterop.dcom.core.JIComServer.<init>(JIComServer.java:</p>
<p>413</p>
<p>)</p>
<p>06</p>
<p>at org.noah.wmitest.WmiService.connect(WmiService.java:</p>
<p>122</p>
<p>)
07</p>
<p>at org.noah.wmitest.WmiService.main(WmiService.java:</p>
<p>177</p>
<p>)</p>
<p>08</p>
<p>at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
09</p>
<p>at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:</p>
<p>39</p>
<p>)</p>
<p>10</p>
<p>at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:</p>
<p>25</p>
<p>)
11</p>
<p>at java.lang.reflect.Method.invoke(Method.java:</p>
<p>597</p>
<p>)</p>
<p>12</p>
<p>at com.intellij.rt.execution.application.AppMain.main(AppMain.java:</p>
<p>120</p>
<p>)
13</p>
<p>Caused by: jcifs.smb.SmbException: The system cannot find the file specified.</p>
<p>14</p>
<p>at jcifs.smb.SmbTransport.checkStatus(SmbTransport.java:</p>
<p>522</p>
<p>)
15</p>
<p>at jcifs.smb.SmbTransport.send(SmbTransport.java:</p>
<p>622</p>
<p>)</p>
<p>16</p>
<p>at jcifs.smb.SmbSession.send(SmbSession.java:</p>
<p>239</p>
<p>)
17</p>
<p>at jcifs.smb.SmbTree.send(SmbTree.java:</p>
<p>109</p>
<p>)</p>
<p>18</p>
<p>at jcifs.smb.SmbFile.send(SmbFile.java:</p>
<p>718</p>
<p>)
19</p>
<p>at jcifs.smb.SmbFile.open0(SmbFile.java:</p>
<p>923</p>
<p>)</p>
<p>20</p>
<p>at jcifs.smb.SmbFile.open(SmbFile.java:</p>
<p>940</p>
<p>)
21</p>
<p>at jcifs.smb.SmbFileOutputStream.<init>(SmbFileOutputStream.java:</p>
<p>142</p>
<p>)</p>
<p>22</p>
<p>at jcifs.smb.TransactNamedPipeOutputStream.<init>(TransactNamedPipeOutputStream.java:</p>
<p>32</p>
<p>)
23</p>
<p>at jcifs.smb.SmbNamedPipe.getNamedPipeOutputStream(SmbNamedPipe.java:</p>
<p>187</p>
<p>)</p>
<p>24</p>
<p>at rpc.ncacn_np.RpcTransport.attach(RpcTransport.java:</p>
<p>92</p>
<p>)
25</p>
<p>at rpc.Stub.attach(Stub.java:</p>
<p>105</p>
<p>)</p>
<p>26</p>
<p>at rpc.Stub.call(Stub.java:</p>
<p>110</p>
<p>)
27</p>
<p>at org.jinterop.winreg.smb.JIWinRegStub.winreg_OpenHKLM(JIWinRegStub.java:</p>
<p>113</p>
<p>)</p>
<p>28</p>
<p>...</p>
<p>10</p>
<p>more</p>
<p>需要开启Remote Registry服务
报错b</p>
<p><a href="&quot;view source&quot;">view source</a><a href="&quot;print&quot;">print</a><a href="&quot;?&quot;">?</a></p>
<p>01</p>
<p>org.jinterop.dcom.common.JIException: Message not found</p>
<p>for</p>
<p>errorCode:</p>
<p>0xC0000001</p>
<p>02</p>
<p>at org.jinterop.winreg.smb.JIWinRegStub.winreg_OpenHKLM(JIWinRegStub.java:</p>
<p>115</p>
<p>)
03</p>
<p>at org.jinterop.dcom.core.JIProgId.getIdFromWinReg(JIProgId.java:</p>
<p>130</p>
<p>)</p>
<p>04</p>
<p>at org.jinterop.dcom.core.JIProgId.getCorrespondingCLSID(JIProgId.java:</p>
<p>162</p>
<p>)
05</p>
<p>at org.jinterop.dcom.core.JIComServer.<init>(JIComServer.java:</p>
<p>413</p>
<p>)</p>
<p>06</p>
<p>at org.noah.wmitest.WmiService.connect(WmiService.java:</p>
<p>87</p>
<p>)
07</p>
<p>at org.noah.wmitest.WmiService.main(WmiService.java:</p>
<p>142</p>
<p>)</p>
<p>08</p>
<p>at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
09</p>
<p>at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:</p>
<p>39</p>
<p>)</p>
<p>10</p>
<p>at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:</p>
<p>25</p>
<p>)
11</p>
<p>at java.lang.reflect.Method.invoke(Method.java:</p>
<p>597</p>
<p>)</p>
<p>12</p>
<p>at com.intellij.rt.execution.application.AppMain.main(AppMain.java:</p>
<p>120</p>
<p>)
13</p>
<p>Caused by: jcifs.smb.SmbException: Connection timeout</p>
<p>14</p>
<p>jcifs.util.transport.TransportException: Connection timeout
15</p>
<p>16</p>
<p>或
17</p>
<p>18</p>
<p>org.jinterop.dcom.common.JIException: Message not found</p>
<p>for</p>
<p>errorCode:</p>
<p>0x8001FFFF
19</p>
<p>at org.jinterop.dcom.core.JIComServer.init(JIComServer.java:</p>
<p>576</p>
<p>)</p>
<p>20</p>
<p>at org.jinterop.dcom.core.JIComServer.initialise(JIComServer.java:</p>
<p>481</p>
<p>)
21</p>
<p>at org.jinterop.dcom.core.JIComServer.<init>(JIComServer.java:</p>
<p>414</p>
<p>)</p>
<p>22</p>
<p>at org.noah.wmitest.WmiService.connect(WmiService.java:</p>
<p>87</p>
<p>)
23</p>
<p>at org.noah.wmitest.WmiService.main(WmiService.java:</p>
<p>142</p>
<p>)</p>
<p>24</p>
<p>at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
25</p>
<p>at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:</p>
<p>39</p>
<p>)</p>
<p>26</p>
<p>at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:</p>
<p>25</p>
<p>)
27</p>
<p>at java.lang.reflect.Method.invoke(Method.java:</p>
<p>597</p>
<p>)</p>
<p>28</p>
<p>at com.intellij.rt.execution.application.AppMain.main(AppMain.java:</p>
<p>120</p>
<p>)
29</p>
<p>Caused by: java.net.ConnectException: Connection timed out</p>
<p>需要禁用放火墙</p>
<h3 id="4-">4、总结</h3>
<p>j-Interop纯java跨平台，我就是linux系统。</p>
<p>用j-Interop就可以很方便的调用windows系统com，虽然这里只演示了WMI。
如果关心WMI与监控的话，建议去opennms-wmi看一看，他们有更好api封装（底层也是j-Interop）。
<strong>关键字：</strong> <a href="http://www.oschina.net/search?scope=blog&amp;q=wmi" target="_blank">wmi</a> <a href="http://www.oschina.net/search?scope=blog&amp;q=windows" target="_blank">windows</a> <a href="http://www.oschina.net/search?scope=blog&amp;q=j-interop" target="_blank">j-interop</a></p>
<p>声明：OSCHINA 博客文章版权属于作者，受法律保护。未经作者同意不得转载。</p>
<ul>
<li><a href="http://my.oschina.net/noahxiao/blog/72861" title="上一篇：既爱又恨的VA-API(Ubuntu视频加速)" target="_blank">« 既爱又恨的VA-API(Ubuntu视频加速)</a></li>
<li><a href="http://my.oschina.net/noahxiao/blog/75463" title="下一篇：通过javamelody监控web应用的性能指标" target="_blank">通过javamelody监控web应用的性能指标 »</a></li>
</ul>
<p>开源中国-程序员在线工具：<a href="http://www.ostools.net/apidocs" target="_blank">API文档大全(120+)</a> <a href="http://runjs.cn/" target="_blank">JS在线编辑演示</a> <a href="http://www.ostools.net/qr" target="_blank">二维码</a> <a href="http://www.ostools.net/" target="_blank">更多&gt;&gt;</a>
<strong>分享到：</strong> <a href="&quot;分享到新浪微博&quot;"></a> <a href="&quot;分享到腾讯微博&quot;"></a>  <a href="">顶</a>已有 <em>0</em>人顶</p>
<h2 id="-5-"><a href=""></a>共有 5 条网友评论</h2>
<ul>
<li><a href="http://my.oschina.net/u/657242" target="_blank"><img src="&quot;leehark&quot;" alt="leehark"></a> 1楼：<a href="http://my.oschina.net/u/657242" target="_blank">leehark</a>(Android) 发表于 2012-08-18 19:35 <a href="">回复此评论</a></li>
</ul>
<p>能通过代码禁止防火墙么？是都要管理员权限？</p>
<ul>
<li><a href="http://my.oschina.net/mingyuejingque" target="_blank"><img src="&quot;明月惊鹊&quot;" alt="明月惊鹊"></a> 2楼：<a href="http://my.oschina.net/mingyuejingque" target="_blank">明月惊鹊</a> 发表于 2012-08-19 14:40 <a href="">回复此评论</a></li>
</ul>
<p>WMI里应该就有控制防火墙的。这种操作肯定需要管理员权限了。</p>
<ul>
<li><a href="http://my.oschina.net/u/124197" target="_blank"><img src="&quot;黄金比&quot;" alt="黄金比"></a> 3楼：<a href="http://my.oschina.net/u/124197" target="_blank">黄金比</a>(iPhone) 发表于 2012-08-21 07:06 <a href="">回复此评论</a></li>
</ul>
<p>不知道远程调用行不行呢?请博主明确一下。</p>
<ul>
<li><a href="http://my.oschina.net/noahxiao" target="_blank"><img src="&quot;肖国颖&quot;" alt="肖国颖"></a> 4楼：<a href="http://my.oschina.net/noahxiao" target="_blank">肖国颖</a>(iPhone) 发表于 2012-08-21 08:23 <a href="">回复此评论</a></li>
</ul>
<h3 id="-">引用来自“黄金比”的评论</h3>
<p>不知道远程调用行不行呢?请博主明确一下。
你指的是非本机吗？我测试的方式就是一台linux运行程序指定ip调用另一台win服务器的wmi</p>
<ul>
<li><a href="http://my.oschina.net/u/124197" target="_blank"><img src="&quot;黄金比&quot;" alt="黄金比"></a> 5楼：<a href="http://my.oschina.net/u/124197" target="_blank">黄金比</a>(iPhone) 发表于 2012-08-21 12:47 <a href="">回复此评论</a></li>
</ul>
<h3 id="-">引用来自“肖国颖”的评论</h3>
<h3 id="-">引用来自“黄金比”的评论</h3>
<p>不知道远程调用行不行呢?请博主明确一下。
你指的是非本机吗？我测试的方式就是一台linux运行程序指定ip调用另一台win服务器的wmi</p>
<p>收到，谢博主，试下先!</p>
<p>文明上网，理性发言
<a href=""></a></p>
<p><img src="" alt=""> 文明上网，理性发言  <a href="">回到页首</a> | <a href="">回到评论列表</a></p>
<p><strong><a href="">关闭</a>相关文章阅读</strong></p>
<ul>
<li>2012/08/16 <a href="http://my.oschina.net/u/581475/blog/73199" title="100%纯java调用windows的wmi获取监控数据" target="_blank">100%纯java调用windows的wmi获取监控...</a></li>
<li>2011/07/06 <a href="http://my.oschina.net/veterans/blog/27840" title="使用WMI修改文件文件夹的NTFS权限" target="_blank">使用WMI修改文件文件夹的NTFS权限...</a></li>
<li>2013/04/24 <a href="http://my.oschina.net/fenlog/blog/124859" title="利用WMI实现ring3进程监控 - vc" target="_blank">利用WMI实现ring3进程监控 - vc...</a></li>
<li>2012/03/22 <a href="http://my.oschina.net/zhajiang/blog/50524" title="py2exe打包包含wmi模块的脚本后，运行时出现win32api.pyd错误的解决办法。" target="_blank">py2exe打包包含wmi模块的脚本后，运...</a></li>
<li>2011/09/02 <a href="http://my.oschina.net/u/129490/blog/30675" title="在windows下使用OpenSSH（上）" target="_blank">在windows下使用OpenSSH（上）...</a></li>
</ul>
<p>© 开源中国(OsChina.NET) | <a href="http://www.oschina.net/home/about" target="_blank">关于我们</a> | <a href="mailto:oschina.net@gmail.com">广告联系</a> | <a href="http://weibo.com/oschina2010" target="_blank">@新浪微博</a> | <a href="http://m.oschina.net/" target="_blank">开源中国手机版</a> | <a href="http://www.miitbeian.gov.cn/" target="_blank">粤ICP备12009483号-3</a> 开源中国手机客户端： <a href="http://www.oschina.net/app" title="Android客户端" target="_blank">Android</a> <a href="http://www.oschina.net/app" title="iPhone 客户端" target="_blank">iPhone</a> <a href="http://www.oschina.net/app" title="Windows Phone 客户端" target="_blank">WP7</a></p>
<p><a href=""></a><a href=""></a><a href=""></a>
<img src="" alt=""></p>

      
    </div>
    <section id='after_content_widget'><div class="widget" id="widget_after_content_wumiiRelatedItems>">
<script type="text/javascript" id="wumiiRelatedItems"></script>
</div><div class="widget" id="widget_after_content_post_footer_info>">
<div class="panel panel-success">
    <div class="panel-heading" align="center">希望本站内容对您有点用处,有什么疑问或建议请在后面留言评论</div>
    <div align="center" class="panel-body">转载请注明作者(<a href="http://itsolife.com/about/">RobinChia</a>)和出处 <a href="http://itsolife.com">It so life</a> ，请勿用于任何商业用途</div>
    <div class="panel-body">本文链接: <a href="/2014/02/02/2014-02-02-JavaJ2EE-java-com-wmi-监控--100-纯java调用windows的wmi获取监控数据-肖国颖的个人页面-开源中国社区/">100</a></div>
</div>
</div></section>
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/Java&J2EE/">Java&J2EE</a></li></span><span class="breadcrumb"><li><a href="/categories/Java&J2EE/">Java&J2EE</a></li><li><a href="/categories/Java&J2EE/java-com/">java-com</a></li><li><a href="/categories/Java&J2EE/java-com/wmi-监控/">wmi-监控</a></li></span></span> | <span class="tags">Tagged <a href="/tags/Java&J2EE/" class="label label-primary">Java&J2EE</a><a href="/tags/java-com/" class="label label-success">java-com</a><a href="/tags/wmi-监控/" class="label label-info">wmi-监控</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:41"datetime="2014-03-07 09:54:41"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-JavaJ2EE-java-com-wmi-监控--100-纯java调用windows的wmi获取监控数据-肖国颖的个人页面-开源中国社区/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-JavaJ2EE-java-com-wmi-监控--100-纯java调用windows的wmi获取监控数据-肖国颖的个人页面-开源中国社区" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>


    <section id='after_post_widget'><div class="widget" id="widget_after_post_post_pageNav>">
<ul class="pager">
  
  <li class="previous"><a href="/2014/02/02/2014-02-02-JavaJ2EE-java-com-wmi-监控--使用J-Interop在Java中调用WMI/" title="使用 J">&larr; 使用 J</a></li>
  
  
  <li class="next"><a href="/2014/02/02/2014-02-02-JavaJ2EE-java-com-jacob--java操作word文档jacob-poi/" title="java操作word文档(jacob">java操作word文档(jacob &rarr;</a></li>
  
</ul></div><div class="widget" id="widget_after_post_related_posts>">
<ul class="list-group"><li class="list-group-item"><a href="/2014/02/02/2014-02-02-JavaJ2EE-Java_常用--switch之enum/">switch之enum</a></li><li class="list-group-item"><a href="/2014/02/02/2014-02-02-JavaJ2EE-JVM--Java7的新特性一览表/">Java 7 的新特性一览表</a></li><li class="list-group-item"><a href="/2014/02/02/2014-02-02-JavaJ2EE-java-com-wmi-监控--100-纯java调用windows的wmi获取监控数据-肖国颖的个人页面-开源中国社区/">100</a></li><li class="list-group-item"><a href="/2014/02/02/2014-02-02-JavaJ2EE--JSTL标签参考手册/">JSTL标签 参考手册</a></li><li class="list-group-item"><a href="/2014/02/02/2014-02-02-JavaJ2EE-SQL_Java--SQL解析Jsqlparser/">SQL解析(Jsqlparser)</a></li><li class="list-group-item"><a href="/2014/02/02/2014-02-02-JavaJ2EE-JVM--JVM调优总结（五）-分代垃圾回收详述1/">JVM调优总结（五）</a></li><li class="list-group-item"><a href="/2014/02/02/2014-02-02-JavaJ2EE-SQL_Java--Java中，获得ResultSet的总行数与总列数/">Java中，获得ResultSet的总行数与总列数</a></li><li class="list-group-item"><a href="/2014/02/02/2014-02-02-JavaJ2EE-JVM--JVM调优的-标准参数-的各种陷阱/">JVM调优的</a></li></ul></div></section>    
	<div id="comments"><!-- Duoshuo Comment BEGIN -->

<div class="ds-thread"  data-thread-key="2014-02-02-JavaJ2EE-java-com-wmi-监控--100-纯java调用windows的wmi获取监控数据-肖国颖的个人页面-开源中国社区"  data-url="http://itsolife.com/2014/02/02/2014-02-02-JavaJ2EE-java-com-wmi-监控--100-纯java调用windows的wmi获取监控数据-肖国颖的个人页面-开源中国社区/" data-title="100"></div>

		

<!-- Duoshuo Comment END -->

</div></div><!--wapper-->
       </div><!-- ID main-col END -->
       <aside id="sidebar" class="alignright col-sx-6 col-sm-4 col-md-3 col-lg-3">
<div id="widget_search" class="widget panel panel-primary">
    <form action="//google.com/search" method="get" accept-charset="utf-8">
  <div class="input-group">
    <input class="form-control" id="searchbox" type="search" name="q" results="0" placeholder="search">
    <span class="input-group-btn">
      <button class="btn btn-default" type="submit">Go!</button>
    </span>
    <input type="hidden" name="q" value="site:itsolife.com">
  </div>
</form>
</div>

<div id="widget_category" class="widget panel panel-primary">
  <div class="panel-heading">category</div>  <div data-src='category' class='ajax_widgets'>正在加载...</div>
</div>

<div id="widget_recent_posts" class="widget panel panel-primary">
  <div class="panel-heading">recent posts</div>  <div data-src='recent_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_tagcloud" class="widget panel panel-primary">
  <div class="panel-heading">tagcloud</div>  <div data-src='tagcloud' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_latest_update_posts" class="widget panel panel-primary">
  <div class="panel-heading">最近更新</div>  <div data-src='latest_update_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_recent_comments" class="widget panel panel-primary">
  <div class="panel-heading">recent comments</div>  

<div class="list-group-item ds-recent-comments" data-num-items="6" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="50"></div>



</div>

</aside>
       <div class="clearfix"></div>
     </div><!-- row END -->
  </div>
  <footer id="footer" class="container">
  <div class="panel panel-info">
  <section id='footer_widget'></section>  <div class="panel-footer">
  <div id="site-info">
    <span class='author'>
  
  &copy; 2014 RobinChia
  
    &nbsp;&nbsp;</span>
  
  <span id='analytics-51la'></span><span id='analytics-google'>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-48559895-1']);
  _gaq.push(['_trackPageview']);
  _js2load.push({src:('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'});
</script></span><span id='analytics-cnzz'>
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_5774006'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s17.cnzz.com/stat.php%3Fid%3D5774006%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
</span><span id='analytics-baidu'>
<script>
var _hmt = _hmt || [];
_js2load.push({src:"//hm.baidu.com/hm.js?1442f50724afc42380b51f097c43082c"});
</script>
</span>  </div>
  <div id="copyright">Blog powered by <a href='http://zespia.tw/hexo/'><strong>hexo</strong></a> Theme <strong><a href='https://github.com/chenall/hexo-theme-chenall'>chenall</a></strong>(Some change in it)<span class="pull-right"> 更新时间: <em>2014-03-07 09:54:41</em></span></div>
</div>
<div class="clearfix"></div>


  </div>
  </footer>
  
        <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>        
        <script src="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/js/bootstrap.min.js"></script>        
                
        <script src="http://cdn.bootcss.com/prettify/r298/prettify.min.js"></script>    <script type="text/javascript">
   var lang=["bsh", "c", "cc", "cpp", "cs", "csh", "cyc", "cv", "htm", "html",
    "java", "js", "m", "mxml", "perl", "pl", "pm", "py", "rb", "sh",
    "xhtml", "xml", "xsl"];
   var pretty_base='';
   $('script').each(function(){
	var c = $(this).attr('src');
	if (!c)
	    return;
	if (c.match(/(\/)?prettify(\.min)?\.js/i))
	{
	    var index = c.lastIndexOf('/');
	    if (index != -1)
		pretty_base = c.substr(0,index + 1);
	    return false;
	}
   })
   $('pre code').each(function(){
	var c = $(this).attr('class')
	if (!c)
	    return;
	c = c.match(/\s?(lang\-\w+)/i);
	if (c && lang.indexOf(c[1]) == -1)
	{
	    lang.push(c[1]);
	    $.getScript(pretty_base + c[1] + '.min.js');
	}
   })

    $(window).load(function(){
       $("pre").addClass("prettyprint");
       prettyPrint();
    })
</script>    
            <script type="text/javascript">
var duoshuoQuery = {short_name:"robinchia"};
_js2load.push({src:'http://static.duoshuo.com/embed.js',charset:'UTF-8'});
</script>
    
            <!--wumii_relatedItems-->

<script type="text/javascript">
    var wumiiPermaLink = "http://itsolife.com/2014/02/02/2014-02-02-JavaJ2EE-java-com-wmi-监控--100-纯java调用windows的wmi获取监控数据-肖国颖的个人页面-开源中国社区/";
    var wumiiTitle = "100";
    var wumiiTags = "Java&J2EE,java-com,wmi-监控";
    var wumiiCategories = ["Java&J2EE","Java&J2EE","java-com","wmi-监控"];
    var wumiiSitePrefix = "http://itsolife.com";
    var wumiiParams = "&num=5&mode=3&pf=JAVASCRIPT";
    _js2load.push({src:'http://widget.wumii.cn/ext/relatedItemsWidget'});
</script>
<a href="http://www.wumii.com/widget/relatedItems" style="border:0;">
<img src="http://static.wumii.cn/images/pixel.png" alt="无觅关联推荐，快速提升流量" style="border:0;padding:0;margin:0;" />
</a>
    
        <script src="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js"></script>    <script type="text/javascript">
(function($){
  $('.entry').each(function(i){
    $(this).find('img').each(function(){
      var alt = this.alt;

      if (alt){
        $(this).before('<span class="caption">' + alt + '</span>');
      }

      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="fancybox' + i + '" />');
    });
  });

  $('.fancybox').fancybox();
})(jQuery);
</script>    
        <script src="http://cdn.bootcss.com/mathjax/2.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>
    
<script type="text/javascript">
$('.ajax_widgets').each(function(){var src=$(this).attr('data-src');if(src)$(this).load('/widgets/'+src+'.html');});
$.each(_js2load,function(index,obj){loadjs(obj.src,obj.charset)});
</script>

<div id="scroll2top">
<img src="/scroll2top/arrow.png"/>
</div>
<script src="/scroll2top/scroll2top.min.js"></script>
<div id="winterland">
  <canvas></canvas>
</div>
<script src="/js/winterland.min.js"></script>

  </body>
</html>
