
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Java NIO API详解 | It so life</title>
<meta name="author" content="RobinChia">

<meta name="description" content="Java NIO API详解【永恒的瞬间】
☜Give me hapy ☞

BlogJava   首页      新文章   联系   聚合   管理
诱惑的世界,难以自我!
名利的生活,面具包裹!">


<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<meta property="og:title" content="Java NIO API详解"/>
<meta property="og:site_name" content="It so life"/>

<!--[if IE]><style>.testIE.IE{display:inline;}</style><![endif]-->
<!--[if lte IE 7]><link rel="stylesheet" href="/css/ie7.css" type="text/css"><![endif]-->
<!--[if (lt IE 9)&(gt IE 7)]><style>.testIE.IE8{display:inline;}</style><![endif]-->
<!--[if gt IE 8]><style>.testIE.IE9{display:inline;}</style><![endif]-->

<link href="/favicon.png" rel="icon">
<link rel="alternate" href="/atom.xml" title="It so life Feed" type="application/atom+xml">

<link rel="stylesheet" href="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.0.3/css/font-awesome.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/prettify/r298/prettify.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" type="text/css">
<link rel="stylesheet" href="/css/style.css" type="text/css">
<!--[if lt IE 9]>
   <style>article,aside,dialog,footer,header,section,footer,nav,figure,menu{display:block}</style>
   <script src="http://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
   <script src="http://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
<link href="http://cdn.staticfile.org/respond.js/1.4.2/respond-proxy.html" id="respond-proxy" rel="respond-proxy" />
<link href="/js/respond.proxy.gif" id="respond-redirect" rel="respond-redirect" />
<script src="/js/respond.proxy.js"></script>
   <script src="http://cdn.bootcss.com/selectivizr/1.0.2/selectivizr-min.js"></script>
<![endif]-->
<script type="text/javascript">
function loadjs(c,d){var a=document.createElement("script");a.async=!0;a.type="text/javascript";a.src=c;a.charset=d||"gbk";(document.getElementsByTagName("HEAD")[0]||document.getElementsByTagName("BODY")[0]).appendChild(a)};
var _protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
var _js2load = [];
</script>

</head>
<body>
      <header id="header" class="container"><nav id="main-nav" class="navbar navbar-default navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="/">It so life</a>
    </div>
    <div  class="collapse navbar-collapse">
      <ul  class="nav navbar-nav">
  
        <li><a href="/" title="Home">Home</a></li>      
        <li><a href="/about/" title="About">About</a></li>      
        <li><a href="/archives/" title="Archives">Archives</a></li>      
      <li class='dropdown'>
        <a class='dropdown-toggle' data-toggle='dropdown' href='#'>website<b class='caret'></b></a>
        <ul class='dropdown-menu pure-menu-selected'>
    
          <li><a href="//groups.google.com/forum/#!forum/pongba" title="TopLanguage">TopLanguage</a></li>    
          <li><a href="//itpub.net/" title="ITPub">ITPub</a></li>    
          <li><a href="//blog.jobbole.com/" title="Bole">Bole</a></li>    
          <li><a href="//nosql-database.org/" title="nosql">nosql</a></li>    
          <li><a href="//gitimmersion.googol.im/" title="Git">Git</a></li>    
        </ul>
      </li>
    
      </ul>
      <ul class="nav navbar-nav navbar-right">
      
        <li><a href="/atom.xml">RSS</a></li>
      
      
        <li><a href="https://twitter.com/robinchia">twitter</a></li>
      
      
      
      
        <li><a href="https://github.com/robinchia">github</a></li>
      
      </ul>
    </div>
  </div>
</nav>
<div class="clearfix"></div>
</header>
  <div id='content' class="container">
     <div class="page-header-wrapper">
      <!--[if lt IE 9]><div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong>提示:</strong>您的浏览器版本太低了,建议升级到 <strong><a href="http://windows.microsoft.com/zh-cn/internet-explorer/download-ie" title="IE9">IE9</a></strong> 以上,本站使用<a href="https://www.google.com/intl/zh-CN/chrome/">Chrome浏览器</a>可以获得最好的显示效果.</div><![endif]-->
      <div class="page-header"><h1 align="center"><big>It so life</big> </h1>
        <h5 align="center"><big>love as life</big></h5>
      </div>
     </div>
     <div class="row">
       <div id="main-col" class="alignleft col-sx-12 col-sm-8 col-md-9 col-lg-9">
      <section id='header_widget'></section>
          <div id="wrapper"><article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title">Java NIO API详解</h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:41.000Z"> <a href="/2014/02/02/2014-02-02-JavaJ2EE-NIO--JavaNIOAPI详解/">feb. 2 2014</a></time></span>      
    </header>
    
    <section id='before_content_widget'></section>
    <div class="entry">
      
        <h1 id="java-nio-api-">Java NIO API详解</h1>
<p><a href="http://www.blogjava.net/19851985lili/" target="_blank">【永恒的瞬间】</a>
☜Give me hapy ☞</p>
<p><a href="http://www.blogjava.net/" target="_blank">BlogJava</a>   <a href="http://www.blogjava.net/19851985lili/" target="_blank">首页</a>      <a href="http://www.blogjava.net/EnterMyBlog.aspx?NewArticle=1" target="_blank">新文章</a>   <a href="http://www.blogjava.net/19851985lili/contact.aspx?id=1" target="_blank">联系</a>   <a href="http://www.blogjava.net/19851985lili/rss" target="_blank">聚合</a><a href="http://www.blogjava.net/19851985lili/rss" target="_blank"><img src="" alt=""></a>   <a href="http://www.blogjava.net/19851985lili/admin/EditPosts.aspx" target="_blank">管理</a>
诱惑的世界,难以自我!
名利的生活,面具包裹!
我们的人生,充当角色!
寂静的深夜,真实自我!
<img src="" alt=""></p>
<h3 id="-">常用链接</h3>
<ul>
<li><a href="http://www.blogjava.net/19851985lili/MyPosts.html" target="_blank">我的随笔</a></li>
<li><a href="http://www.blogjava.net/19851985lili/MyComments.html" target="_blank">我的评论</a></li>
<li><a href="http://www.blogjava.net/19851985lili/OtherPosts.html" target="_blank">我的参与</a></li>
<li><a href="http://www.blogjava.net/19851985lili/RecentComments.html" target="_blank">最新评论</a></li>
</ul>
<h3 id="-3-">留言簿(3)</h3>
<ul>
<li><a href="http://www.blogjava.net/19851985lili/Contact.aspx?id=1" target="_blank">给我留言</a></li>
<li><a href="http://www.blogjava.net/19851985lili/default.aspx?opt=msg" target="_blank">查看公开留言</a></li>
<li><a href="http://www.blogjava.net/19851985lili/admin/MyMessages.aspx" target="_blank">查看私人留言</a></li>
</ul>
<h1 id="-6-">随笔档案(6)</h1>
<ul>
<li><a href="http://www.blogjava.net/19851985lili/archive/2008/05.html" target="_blank">2008年5月 (1)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/archive/2007/05.html" target="_blank">2007年5月 (1)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/archive/2007/04.html" target="_blank">2007年4月 (2)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/archive/2007/02.html" target="_blank">2007年2月 (1)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/archive/2007/01.html" target="_blank">2007年1月 (1)</a></li>
</ul>
<h1 id="-188-">文章分类(188)</h1>
<ul>
<li><a href="http://www.blogjava.net/19851985lili/category/27256.html" target="_blank">Canada (Independent Skilled Worker)(2)</a><a href="http://www.blogjava.net/19851985lili/category/27256.html/rss" title="Subscribe to Canada (Independent Skilled Worker)(2)" target="_blank"><img src="&quot;Subscribe to Canada (Independent Skilled Worker" alt="">(2)&quot;)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/category/26726.html" target="_blank">EJB3.0(4)</a><a href="http://www.blogjava.net/19851985lili/category/26726.html/rss" title="Subscribe to EJB3.0(4)" target="_blank"><img src="&quot;Subscribe to EJB3.0(4" alt="">&quot;)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/category/19161.html" target="_blank">flex2.0(40)</a><a href="http://www.blogjava.net/19851985lili/category/19161.html/rss" title="Subscribe to flex2.0(40)" target="_blank"><img src="&quot;Subscribe to flex2.0(40" alt="">&quot;)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/category/19815.html" target="_blank">flex2Cairngorm(6)</a><a href="http://www.blogjava.net/19851985lili/category/19815.html/rss" title="Subscribe to flex2Cairngorm(6)" target="_blank"><img src="&quot;Subscribe to flex2Cairngorm(6" alt="">&quot;)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/category/18358.html" target="_blank">hibernate(17)</a><a href="http://www.blogjava.net/19851985lili/category/18358.html/rss" title="Subscribe to hibernate(17)" target="_blank"><img src="&quot;Subscribe to hibernate(17" alt="">&quot;)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/category/19706.html" target="_blank">java_code(7)</a><a href="http://www.blogjava.net/19851985lili/category/19706.html/rss" title="Subscribe to java_code(7)" target="_blank"><img src="&quot;Subscribe to java_code(7" alt="">&quot;)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/category/18943.html" target="_blank">JavaBasic(15)</a><a href="http://www.blogjava.net/19851985lili/category/18943.html/rss" title="Subscribe to JavaBasic(15)" target="_blank"><img src="&quot;Subscribe to JavaBasic(15" alt="">&quot;)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/category/18368.html" target="_blank">JAVAEE(20)</a><a href="http://www.blogjava.net/19851985lili/category/18368.html/rss" title="Subscribe to JAVAEE(20)" target="_blank"><img src="&quot;Subscribe to JAVAEE(20" alt="">&quot;)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/category/19705.html" target="_blank">javamail(4)</a><a href="http://www.blogjava.net/19851985lili/category/19705.html/rss" title="Subscribe to javamail(4)" target="_blank"><img src="&quot;Subscribe to javamail(4" alt="">&quot;)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/category/18934.html" target="_blank">Log4j(8)</a><a href="http://www.blogjava.net/19851985lili/category/18934.html/rss" title="Subscribe to Log4j(8)" target="_blank"><img src="&quot;Subscribe to Log4j(8" alt="">&quot;)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/category/22482.html" target="_blank">meshwork(1)</a><a href="http://www.blogjava.net/19851985lili/category/22482.html/rss" title="Subscribe to meshwork(1)" target="_blank"><img src="&quot;Subscribe to meshwork(1" alt="">&quot;)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/category/20441.html" target="_blank">ORACLE(13)</a><a href="http://www.blogjava.net/19851985lili/category/20441.html/rss" title="Subscribe to ORACLE(13)" target="_blank"><img src="&quot;Subscribe to ORACLE(13" alt="">&quot;)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/category/19306.html" target="_blank">server(5)</a><a href="http://www.blogjava.net/19851985lili/category/19306.html/rss" title="Subscribe to server(5)" target="_blank"><img src="&quot;Subscribe to server(5" alt="">&quot;)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/category/18359.html" target="_blank">Spring(6)</a><a href="http://www.blogjava.net/19851985lili/category/18359.html/rss" title="Subscribe to Spring(6)" target="_blank"><img src="&quot;Subscribe to Spring(6" alt="">&quot;)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/category/18360.html" target="_blank">struts(8)</a><a href="http://www.blogjava.net/19851985lili/category/18360.html/rss" title="Subscribe to struts(8)" target="_blank"><img src="&quot;Subscribe to struts(8" alt="">&quot;)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/category/20166.html" target="_blank">Sun_Solaris(11)</a><a href="http://www.blogjava.net/19851985lili/category/20166.html/rss" title="Subscribe to Sun_Solaris(11)" target="_blank"><img src="&quot;Subscribe to Sun_Solaris(11" alt="">&quot;)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/category/19127.html" target="_blank">Tomcat(2)</a><a href="http://www.blogjava.net/19851985lili/category/19127.html/rss" title="Subscribe to Tomcat(2)" target="_blank"><img src="&quot;Subscribe to Tomcat(2" alt="">&quot;)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/category/20208.html" target="_blank">UML(2)</a><a href="http://www.blogjava.net/19851985lili/category/20208.html/rss" title="Subscribe to UML(2)" target="_blank"><img src="&quot;Subscribe to UML(2" alt="">&quot;)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/category/19707.html" target="_blank">Vmware(2)</a><a href="http://www.blogjava.net/19851985lili/category/19707.html/rss" title="Subscribe to Vmware(2)" target="_blank"><img src="&quot;Subscribe to Vmware(2" alt="">&quot;)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/category/20445.html" target="_blank">VSS(2)</a><a href="http://www.blogjava.net/19851985lili/category/20445.html/rss" title="Subscribe to VSS(2)" target="_blank"><img src="&quot;Subscribe to VSS(2" alt="">&quot;)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/category/19285.html" target="_blank">webotx(5)</a><a href="http://www.blogjava.net/19851985lili/category/19285.html/rss" title="Subscribe to webotx(5)" target="_blank"><img src="&quot;Subscribe to webotx(5" alt="">&quot;)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/category/21579.html" target="_blank">Windows x(3)</a><a href="http://www.blogjava.net/19851985lili/category/21579.html/rss" title="Subscribe to Windows x(3)" target="_blank"><img src="&quot;Subscribe to Windows x(3" alt="">&quot;)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/category/19189.html" target="_blank">常用正则表达式 (5)</a><a href="http://www.blogjava.net/19851985lili/category/19189.html/rss" title="Subscribe to 常用正则表达式 (5)" target="_blank"><img src="&quot;Subscribe to 常用正则表达式 (5" alt="">&quot;)</a></li>
</ul>
<h1 id="-206-">文章档案(206)</h1>
<ul>
<li><a href="http://www.blogjava.net/19851985lili/archives/2008/05.html" target="_blank">2008年5月 (10)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/archives/2007/11.html" target="_blank">2007年11月 (2)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/archives/2007/10.html" target="_blank">2007年10月 (4)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/archives/2007/06.html" target="_blank">2007年6月 (5)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/archives/2007/05.html" target="_blank">2007年5月 (21)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/archives/2007/04.html" target="_blank">2007年4月 (33)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/archives/2007/03.html" target="_blank">2007年3月 (10)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/archives/2007/02.html" target="_blank">2007年2月 (58)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/archives/2007/01.html" target="_blank">2007年1月 (63)</a></li>
</ul>
<h1 id="url">URL</h1>
<ul>
<li><a href="http://www.w3school.com.cn/index.html" target="_blank">Web 技术教程</a><a href="http://www.w3school.com.cn/index.html" title="Subscribe to Web 技术教程" target="_blank"><img src="&quot;Subscribe to Web 技术教程&quot;" alt=""></a></li>
<li><a href="http://www.forbeschina.com/cmslive/index.jsp" target="_blank">福布斯中文版</a><a href="http://www.forbeschina.com/cmslive/index.jsp" title="Subscribe to 福布斯中文版" target="_blank"><img src="&quot;Subscribe to 福布斯中文版&quot;" alt=""></a></li>
<li><a href="http://rt.openfoundry.org/Foundry/" target="_blank">自由软体铸造场</a><a href="http://rt.openfoundry.org/Foundry/" title="Subscribe to 自由软体铸造场" target="_blank"><img src="&quot;Subscribe to 自由软体铸造场&quot;" alt=""></a></li>
<li><a href="http://caterpillar.onlyfun.net/GossipCN/index.html" target="_blank">良葛格学习笔记</a><a href="http://caterpillar.onlyfun.net/GossipCN/index.html" title="Subscribe to 良葛格学习笔记" target="_blank"><img src="&quot;Subscribe to 良葛格学习笔记&quot;" alt=""></a></li>
</ul>
<h3 id="-">搜索</h3>
<p>*</p>
<ul>
<li></li>
</ul>
<h3 id="-http-www-blogjava-net-19851985lili-commentsrss-aspx-">最新评论 <a href="http://www.blogjava.net/19851985lili/CommentsRSS.aspx" target="_blank"><img src="" alt=""></a></h3>
<ul>
<li><a href="http://www.blogjava.net/19851985lili/archive/2012/08/27/98475.html#386372" target="_blank">1. re: 研究一下springside的核心部分源代码</a></li>
<li><a href="http://www.easy518.com/" target="_blank"><a href="http://www.easy518.com">http://www.easy518.com</a></a></li>
<li>--美丽说</li>
<li><a href="http://www.blogjava.net/19851985lili/archive/2012/06/08/154836.html#380302" target="_blank">2. re: EJB 简介</a></li>
<li>垃圾</li>
<li>--fff</li>
<li><a href="http://www.blogjava.net/19851985lili/archive/2011/12/27/93705.html#367319" target="_blank">3. webotx https 如何配置</a></li>
<li>你好，请问WebOTX如何配置https服务呢？
如果可以，在线等哦。 谢谢。。。。</li>
<li>--janson</li>
<li><a href="http://www.blogjava.net/19851985lili/archive/2010/11/22/97631.html#338704" target="_blank">4. 你好</a></li>
<li>长须鲸努力掉书袋事故 GUDDSUDUSADSIAUDSFYDIDFSLIFAFSDYIO8YFDOS</li>
<li>--余风好</li>
<li><a href="http://www.blogjava.net/19851985lili/archive/2010/06/08/97622.html#323049" target="_blank">5. re: Flex2 发现之旅：AS3中新的XML处理方法 - E4X</a></li>
<li>不知道为什么，如果使用item.title访问title节点的话，返回是空的</li>
</ul>
<hr>
<p>这个跟返回的XML的namespace有关。</p>
<ul>
<li>--kennethpoon</li>
</ul>
<h3 id="-">阅读排行榜</h3>
<ul>
<li><a href="http://www.blogjava.net/19851985lili/archive/2007/02/06/98199.html" target="_blank">1. explorer.exe文件损坏，如何修复(12012)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/archive/2007/05/23/119380.html" target="_blank">2. 如何解决cmd.exe占CPU资源100%问题(560)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/archive/2007/04/13/110320.html" target="_blank">3. 亲情之歌(346)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/archive/2007/01/03/91573.html" target="_blank">4. 数码相机的原理(336)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/archive/2008/05/29/203793.html" target="_blank">5. 防止IE被黑的技巧(318)</a></li>
</ul>
<h3 id="-">评论排行榜</h3>
<ul>
<li><a href="http://www.blogjava.net/19851985lili/archive/2007/02/06/98199.html" target="_blank">1. explorer.exe文件损坏，如何修复(1)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/archive/2007/01/03/91573.html" target="_blank">2. 数码相机的原理(0)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/archive/2008/05/29/203793.html" target="_blank">3. 防止IE被黑的技巧(0)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/archive/2007/05/23/119380.html" target="_blank">4. 如何解决cmd.exe占CPU资源100%问题(0)</a></li>
<li><a href="http://www.blogjava.net/19851985lili/archive/2007/04/13/110320.html" target="_blank">5. 亲情之歌(0)</a></li>
</ul>
<p><a href="http://www.blogjava.net/19851985lili/articles/93524.html" target="_blank">Java NIO API详解</a></p>
<p>NIO API 主要集中在 java.nio 和它的 subpackages 中：</p>
<p>java.nio</p>
<p>定义了 Buffer 及其数据类型相关的子类。其中被 java.nio.channels 中的类用来进行 IO 操作的 ByteBuffer 的作用非常重要。</p>
<p>java.nio.channels</p>
<p>定义了一系列处理 IO 的 Channel 接口以及这些接口在文件系统和网络通讯上的实现。通过 Selector 这个类，还提供了进行非阻塞 IO 操作的办法。这个包可以说是 NIO API 的核心。</p>
<p>java.nio.channels.spi</p>
<p>定义了可用来实现 channel 和 selector API 的抽象类。</p>
<p>java.nio.charset</p>
<pre><code>     定义了处理字符编码和解码的类。
</code></pre><p>java.nio.charset.spi</p>
<pre><code>     定义了可用来实现 charset API 的抽象类。
</code></pre><p>java.nio.channels.spi 和 java.nio.charset.spi 这两个包主要被用来对现有 NIO API 进行扩展，在实际的使用中，我们一般只和另外的 3 个包打交道。下面将对这 3 个包一一介绍。</p>
<p>Package java.nio</p>
<p>这个包主要定义了 Buffer 及其子类。 Buffer 定义了一个线性存放 primitive type 数据的容器接口。对于除 boolean 以外的其他 primitive type ，都有一个相应的 Buffer 子类， ByteBuffer 是其中最重要的一个子类。</p>
<p>下面这张 UML 类图描述了 java.nio 中的类的关系：</p>
<p><img src="" alt=""></p>
<p><strong>Buffer</strong></p>
<p>定义了一个可以线性存放 primitive type 数据的容器接口。 Buffer 主要包含了与类型（ byte, char… ）无关的功能。值得注意的是 Buffer 及其子类都不是线程安全的。</p>
<p>每个 Buffer 都有以下的属性：</p>
<p>capacity</p>
<p>这个 Buffer 最多能放多少数据。 capacity 一般在 buffer 被创建的时候指定。</p>
<p>limit</p>
<p>在 Buffer 上进行的读写操作都不能越过这个下标。当写数据到 buffer 中时， limit 一般和 capacity 相等，当读数据时， limit 代表 buffer 中有效数据的长度。</p>
<p>position</p>
<p>读 / 写操作的当前下标。当使用 buffer 的相对位置进行读 / 写操作时，读 / 写会从这个下标进行，并在操作完成后， buffer 会更新下标的值。</p>
<p>mark</p>
<p>一个临时存放的位置下标。调用 mark() 会将 mark 设为当前的 position 的值，以后调用 reset() 会将 position 属性设置为 mark 的值。 mark 的值总是小于等于 position 的值，如果将 position 的值设的比 mark 小，当前的 mark 值会被抛弃掉。</p>
<p>这些属性总是满足以下条件：</p>
<p>0 &lt;= mark &lt;= position &lt;= limit &lt;= capacity</p>
<p>limit 和 position 的值除了通过 limit() 和 position() 函数来设置，也可以通过下面这些函数来改变：</p>
<p>Buffer clear()</p>
<p>把 position 设为 0 ，把 limit 设为 capacity ，一般在把数据写入 Buffer 前调用。</p>
<p>Buffer flip()</p>
<p>把 limit 设为当前 position ，把 position 设为 0 ，一般在从 Buffer 读出数据前调用。</p>
<p>Buffer rewind()</p>
<p>把 position 设为 0 ， limit 不变，一般在把数据重写入 Buffer 前调用。</p>
<p>Buffer 对象有可能是只读的，这时，任何对该对象的写操作都会触发一个 ReadOnlyBufferException 。 isReadOnly() 方法可以用来判断一个 Buffer 是否只读。</p>
<p><strong>ByteBuffer</strong></p>
<p>在 Buffer 的子类中， ByteBuffer 是一个地位较为特殊的类，因为在 java.io.channels 中定义的各种 channel 的 IO 操作基本上都是围绕 ByteBuffer 展开的。</p>
<p>ByteBuffer 定义了 4 个 static 方法来做创建工作：</p>
<p>ByteBuffer allocate(int capacity)</p>
<p>创建一个指定 capacity 的 ByteBuffer 。</p>
<p>ByteBuffer allocateDirect(int capacity)</p>
<p>创建一个 direct 的 ByteBuffer ，这样的 ByteBuffer 在参与 IO 操作时性能会更好（很有可能是在底层的实现使用了 DMA 技术），相应的，创建和回收 direct 的 ByteBuffer 的代价也会高一些。 isDirect() 方法可以检查一个 buffer 是否是 direct 的。</p>
<p>ByteBuffer wrap(byte [] array)</p>
<p>ByteBuffer wrap(byte [] array, int offset, int length)</p>
<p>把一个 byte 数组或 byte 数组的一部分包装成 ByteBuffer 。</p>
<p>ByteBuffer 定义了一系列 get 和 put 操作来从中读写 byte 数据，如下面几个：</p>
<p>byte get()</p>
<p>ByteBuffer get(byte [] dst)</p>
<p>byte get(int index)</p>
<p>ByteBuffer put(byte b)</p>
<p>ByteBuffer put(byte [] src)</p>
<p>ByteBuffer put(int index, byte b)</p>
<p>这些操作可分为绝对定位和相对定为两种，相对定位的读写操作依靠 position 来定位 Buffer 中的位置，并在操作完成后会更新 position 的值。</p>
<p>在其它类型的 buffer 中，也定义了相同的函数来读写数据，唯一不同的就是一些参数和返回值的类型。</p>
<p>除了读写 byte 类型数据的函数， ByteBuffer 的一个特别之处是它还定义了读写其它 primitive 数据的方法，如：</p>
<p>int getInt()</p>
<pre><code>     从 ByteBuffer 中读出一个 int 值。
</code></pre><p>ByteBuffer putInt(int value)</p>
<pre><code>     写入一个 int 值到 ByteBuffer 中。
</code></pre><p>读写其它类型的数据牵涉到字节序问题， ByteBuffer 会按其字节序（大字节序或小字节序）写入或读出一个其它类型的数据（ int,long… ）。字节序可以用 order 方法来取得和设置：</p>
<p>ByteOrder order()</p>
<pre><code>     返回 ByteBuffer 的字节序。
</code></pre><p>ByteBuffer order(ByteOrder bo)</p>
<pre><code>     设置 ByteBuffer 的字节序。
</code></pre><p>ByteBuffer 另一个特别的地方是可以在它的基础上得到其它类型的 buffer 。如：</p>
<p>CharBuffer asCharBuffer()</p>
<p>为当前的 ByteBuffer 创建一个 CharBuffer 的视图。在该视图 buffer 中的读写操作会按照 ByteBuffer 的字节序作用到 ByteBuffer 中的数据上。</p>
<p>用这类方法创建出来的 buffer 会从 ByteBuffer 的 position 位置开始到 limit 位置结束，可以看作是这段数据的视图。视图 buffer 的 readOnly 属性和 direct 属性与 ByteBuffer 的一致，而且也只有通过这种方法，才可以得到其他数据类型的 direct buffer 。</p>
<p><strong>ByteOrder</strong></p>
<p>用来表示 ByteBuffer 字节序的类，可将其看成 java 中的 enum 类型。主要定义了下面几个 static 方法和属性：</p>
<p>ByteOrder BIG_ENDIAN</p>
<pre><code>     代表大字节序的 ByteOrder 。
</code></pre><p>ByteOrder LITTLE_ENDIAN</p>
<pre><code>     代表小字节序的 ByteOrder 。
</code></pre><p>ByteOrder nativeOrder()</p>
<pre><code>     返回当前硬件平台的字节序。
</code></pre><p><strong>MappedByteBuffer</strong></p>
<p>ByteBuffer 的子类，是文件内容在内存中的映射。这个类的实例需要通过 FileChannel 的 map() 方法来创建。</p>
<p>接下来看看一个使用 ByteBuffer 的例子，这个例子从标准输入不停地读入字符，当读满一行后，将收集的字符写到标准输出：</p>
<pre><code> **public** **static** **void** main(String [] args)

    **throws** IOException

 {

    //   创建一个 capacity 为 256 的 ByteBuffer

    ByteBuffer buf = ByteBuffer.allocate(256);

    **while** ( **true** ) {

        //   从标准输入流读入一个字符

        **int** c = System.in.read();

        //   当读到输入流结束时，退出循环

        **if** (c == -1)

           **break** ;



        //   把读入的字符写入 ByteBuffer 中

        buf.put(( **byte** ) c);

        //   当读完一行时，输出收集的字符

        **if** (c == &#39;\n&#39; ) {

           //   调用 flip() 使 limit 变为当前的 position 的值 ,position 变为 0,

           //   为接下来从 ByteBuffer 读取做准备

           buf.flip();

           //   构建一个 byte 数组

           **byte** [] content = **new** **byte** [buf.limit()];

           //   从 ByteBuffer 中读取数据到 byte 数组中

           buf.get(content);

             //   把 byte 数组的内容写到标准输出

           System.out.print( **new** String(content));

           //   调用 clear() 使 position 变为 0,limit 变为 capacity 的值，

           //   为接下来写入数据到 ByteBuffer 中做准备

           buf.clear();

        }

    }

 }
</code></pre><p>Package java.nio.channels</p>
<p>这个包定义了 Channel 的概念， Channel 表现了一个可以进行 IO 操作的通道（比如，通过 FileChannel ，我们可以对文件进行读写操作）。 java.nio.channels 包含了文件系统和网络通讯相关的 channel 类。这个包通过 Selector 和 SelectableChannel 这两个类，还定义了一个进行非阻塞（ non-blocking ） IO 操作的 API ，这对需要高性能 IO 的应用非常重要。</p>
<p>下面这张 UML 类图描述了 java.nio.channels 中 interface 的关系：</p>
<p><img src="" alt=""></p>
<p><strong>Channel</strong></p>
<p>Channel 表现了一个可以进行 IO 操作的通道，该 interface 定义了以下方法：</p>
<p>boolean isOpen()</p>
<pre><code>     该 Channel 是否是打开的。
</code></pre><p>void close()</p>
<pre><code>     关闭这个 Channel ，相关的资源会被释放。
</code></pre><p><strong>ReadableByteChannel</strong></p>
<p>定义了一个可从中读取 byte 数据的 channel interface 。</p>
<p>int read(ByteBuffer dst)</p>
<p>从 channel 中读取 byte 数据并写到 ByteBuffer 中。返回读取的 byte 数。</p>
<p><strong>WritableByteChannel</strong></p>
<p>定义了一个可向其写 byte 数据的 channel interface 。</p>
<p>int write(ByteBuffer src)</p>
<pre><code>     从 ByteBuffer 中读取 byte 数据并写到 channel 中。返回写出的 byte 数。
</code></pre><p><strong>ByteChannel</strong></p>
<p>ByteChannel 并没有定义新的方法，它的作用只是把 ReadableByteChannel 和 WritableByteChannel 合并在一起。</p>
<p><strong>ScatteringByteChannel</strong></p>
<p>继承了 ReadableByteChannel 并提供了同时往几个 ByteBuffer 中写数据的能力。</p>
<p><strong>GatheringByteChannel</strong></p>
<p>继承了 WritableByteChannel 并提供了同时从几个 ByteBuffer 中读数据的能力。</p>
<p><strong>InterruptibleChannel</strong></p>
<p>用来表现一个可以被异步关闭的 Channel 。这表现在两方面：</p>
<p>1．     当一个 InterruptibleChannel 的 close() 方法被调用时，其它 block 在这个 InterruptibleChannel 的 IO 操作上的线程会接收到一个 AsynchronousCloseException 。</p>
<p>2．     当一个线程 block 在 InterruptibleChannel 的 IO 操作上时，另一个线程调用该线程的 interrupt() 方法会导致 channel 被关闭，该线程收到一个 ClosedByInterruptException ，同时线程的 interrupt 状态会被设置。</p>
<p>接下来的这张 UML 类图描述了 java.nio.channels 中类的关系：</p>
<p><img src="" alt=""></p>
<p><strong>非阻塞 IO</strong></p>
<p>非阻塞 IO 的支持可以算是 NIO API 中最重要的功能，非阻塞 IO 允许应用程序同时监控多个 channel 以提高性能，这一功能是通过 Selector ， SelectableChannel 和 SelectionKey 这 3 个类来实现的。</p>
<p>SelectableChannel 代表了可以支持非阻塞 IO 操作的 channel ，可以将其注册在 Selector 上，这种注册的关系由 SelectionKey 这个类来表现（见 UML 图）。 Selector 这个类通过 select() 函数，给应用程序提供了一个可以同时监控多个 IO channel 的方法：</p>
<p>应用程序通过调用 select() 函数，让 Selector 监控注册在其上的多个 SelectableChannel ，当有 channel 的 IO 操作可以进行时， select() 方法就会返回以让应用程序检查 channel 的状态，并作相应的处理。</p>
<p>下面是 JDK 1.4 中非阻塞 IO 的一个例子，这段 code 使用了非阻塞 IO 实现了一个 time server ：</p>
<pre><code> **private** **static** **void** acceptConnections( **int** port) **throws** Exception {

    //   打开一个 Selector

    Selector acceptSelector =

        SelectorProvider.provider().openSelector();



    //   创建一个 ServerSocketChannel ，这是一个 SelectableChannel 的子类

    ServerSocketChannel ssc = ServerSocketChannel.open();

    //   将其设为 non-blocking 状态，这样才能进行非阻塞 IO 操作

    ssc.configureBlocking( **false** );



    //   给 ServerSocketChannel 对应的 socket 绑定 IP 和端口

    InetAddress lh = InetAddress.getLocalHost();

    InetSocketAddress isa = **new** InetSocketAddress(lh, port);

    ssc.socket().bind(isa);



    //   将 ServerSocketChannel 注册到 Selector 上，返回对应的 SelectionKey

    SelectionKey acceptKey =

        ssc.register(acceptSelector, SelectionKey.OP_ACCEPT);



    **int** keysAdded = 0;



    //   用 select() 函数来监控注册在 Selector 上的 SelectableChannel

    //   返回值代表了有多少 channel 可以进行 IO 操作  (ready for IO)

    **while** ((keysAdded = acceptSelector.select()) &gt; 0) {

        // selectedKeys()  返回一个 SelectionKey 的集合，

        //   其中每个 SelectionKey 代表了一个可以进行 IO 操作的 channel 。

        //   一个 ServerSocketChannel 可以进行 IO 操作意味着有新的 TCP 连接连入了

        Set readyKeys = acceptSelector.selectedKeys();

        Iterator i = readyKeys.iterator();



        **while** (i.hasNext()) {

           SelectionKey sk = (SelectionKey) i.next();

           //   需要将处理过的 key 从 selectedKeys 这个集合中删除

           i.remove();

           //   从 SelectionKey 得到对应的 channel

           ServerSocketChannel nextReady =

               (ServerSocketChannel) sk.channel();

           //   接受新的 TCP 连接

           Socket s = nextReady.accept().socket();

           //   把当前的时间写到这个新的 TCP 连接中

           PrintWriter out =

               **new** PrintWriter(s.getOutputStream(), **true** );

           Date now = **new** Date();

           out.println(now);

           //   关闭连接

           out.close();

        }

    }

 }
</code></pre><p>这是个纯粹用于演示的例子，因为只有一个 ServerSocketChannel 需要监控，所以其实并不真的需要使用到非阻塞 IO 。不过正因为它的简单，可以很容易地看清楚非阻塞 IO 是如何工作的。</p>
<p><strong>SelectableChannel</strong></p>
<p>这个抽象类是所有支持非阻塞 IO 操作的 channel （如 DatagramChannel 、 SocketChannel ）的父类。 SelectableChannel 可以注册到一个或多个 Selector 上以进行非阻塞 IO 操作。</p>
<p>SelectableChannel 可以是 blocking 和 non-blocking 模式（所有 channel 创建的时候都是 blocking 模式），只有 non-blocking 的 SelectableChannel 才可以参与非阻塞 IO 操作。</p>
<p>SelectableChannel configureBlocking(boolean block)</p>
<pre><code>     设置 blocking 模式。
</code></pre><p>boolean isBlocking()</p>
<pre><code>     返回 blocking 模式。
</code></pre><p>通过 register() 方法， SelectableChannel 可以注册到 Selector 上。</p>
<p>int validOps()</p>
<p>返回一个 bit mask ，表示这个 channel 上支持的 IO 操作。当前在 SelectionKey 中，用静态常量定义了 4 种 IO 操作的 bit 值： OP_ACCEPT ， OP_CONNECT ， OP_READ 和 OP_WRITE 。</p>
<p>SelectionKey register(Selector sel, int ops)</p>
<p>将当前 channel 注册到一个 Selector 上并返回对应的 SelectionKey 。在这以后，通过调用 Selector 的 select() 函数就可以监控这个 channel 。 ops 这个参数是一个 bit mask ，代表了需要监控的 IO 操作。</p>
<p>SelectionKey register(Selector sel, int ops, Object att)</p>
<p>这个函数和上一个的意义一样，多出来的 att 参数会作为 attachment 被存放在返回的 SelectionKey 中，这在需要存放一些 session state 的时候非常有用。</p>
<p>boolean isRegistered()</p>
<pre><code>     该 channel 是否已注册在一个或多个 Selector 上。
</code></pre><p>SelectableChannel 还提供了得到对应 SelectionKey 的方法：</p>
<p>SelectionKey keyFor(Selector sel)</p>
<p>返回该 channe 在 Selector 上的注册关系所对应的 SelectionKey 。若无注册关系，返回 null 。</p>
<p><strong>Selector</strong></p>
<p>Selector 可以同时监控多个 SelectableChannel 的 IO 状况，是非阻塞 IO 的核心。</p>
<p>Selector open()</p>
<pre><code>   Selector 的一个静态方法，用于创建实例。
</code></pre><p>在一个 Selector 中，有 3 个 SelectionKey 的集合：</p>
<p>1． key set 代表了所有注册在这个 Selector 上的 channel ，这个集合可以通过 keys() 方法拿到。</p>
<p>2． Selected-key set 代表了所有通过 select() 方法监测到可以进行 IO 操作的 channel ，这个集合可以通过 selectedKeys() 拿到。</p>
<p>3． Cancelled-key set 代表了已经 cancel 了注册关系的 channel ，在下一个 select() 操作中，这些 channel 对应的 SelectionKey 会从 key set 和 cancelled-key set 中移走。这个集合无法直接访问。</p>
<p>以下是 select() 相关方法的说明：</p>
<p>int select()</p>
<p>监控所有注册的 channel ，当其中有注册的 IO 操作可以进行时，该函数返回，并将对应的 SelectionKey 加入 selected-key set 。</p>
<p>int select(long timeout)</p>
<pre><code>     可以设置超时的 select() 操作。
</code></pre><p>int selectNow()</p>
<pre><code>     进行一个立即返回的 select() 操作。
</code></pre><p>Selector wakeup()</p>
<pre><code>     使一个还未返回的 select() 操作立刻返回。
</code></pre><p><strong>SelectionKey</strong></p>
<p>代表了 Selector 和 SelectableChannel 的注册关系。</p>
<p>Selector 定义了 4 个静态常量来表示 4 种 IO 操作，这些常量可以进行位操作组合成一个 bit mask 。</p>
<p>int OP_ACCEPT</p>
<p>有新的网络连接可以 accept ， ServerSocketChannel 支持这一非阻塞 IO 。</p>
<p>int OP_CONNECT</p>
<pre><code>     代表连接已经建立（或出错）， SocketChannel 支持这一非阻塞 IO 。
</code></pre><p>int OP_READ</p>
<p>int OP_WRITE</p>
<pre><code>     代表了读、写操作。
</code></pre><p>以下是其主要方法：</p>
<p>Object attachment()</p>
<p>返回 SelectionKey 的 attachment ， attachment 可以在注册 channel 的时候指定。</p>
<p>Object attach(Object ob)</p>
<pre><code>     设置 SelectionKey 的 attachment 。
</code></pre><p>SelectableChannel channel()</p>
<pre><code>     返回该 SelectionKey 对应的 channel 。
</code></pre><p>Selector selector()</p>
<pre><code>     返回该 SelectionKey 对应的 Selector 。
</code></pre><p>void cancel()</p>
<pre><code>   cancel 这个 SelectionKey 所对应的注册关系。
</code></pre><p>int interestOps()</p>
<pre><code>     返回代表需要 Selector 监控的 IO 操作的 bit mask 。
</code></pre><p>SelectionKey interestOps(int ops)</p>
<pre><code>     设置 interestOps 。
</code></pre><p>int readyOps()</p>
<pre><code>     返回一个 bit mask ，代表在相应 channel 上可以进行的 IO 操作。
</code></pre><p><strong>ServerSocketChannel</strong></p>
<p>支持非阻塞操作，对应于 java.net.ServerSocket 这个类，提供了 TCP 协议 IO 接口，支持 OP_ACCEPT 操作。</p>
<p>ServerSocket socket()</p>
<pre><code>     返回对应的 ServerSocket 对象。
</code></pre><p>SocketChannel accept()</p>
<pre><code>     接受一个连接，返回代表这个连接的 SocketChannel 对象。
</code></pre><p><strong>SocketChannel</strong></p>
<p>支持非阻塞操作，对应于 java.net.Socket 这个类，提供了 TCP 协议 IO 接口，支持 OP_CONNECT ， OP_READ 和 OP_WRITE 操作。这个类还实现了 ByteChannel ， ScatteringByteChannel 和 GatheringByteChannel 接口。</p>
<p>DatagramChannel 和这个类比较相似，其对应于 java.net.DatagramSocket ，提供了 UDP 协议 IO 接口。</p>
<p>Socket socket()</p>
<pre><code>     返回对应的 Socket 对象。
</code></pre><p>boolean connect(SocketAddress remote)</p>
<p>boolean finishConnect()</p>
<p>connect() 进行一个连接操作。如果当前 SocketChannel 是 blocking 模式，这个函数会等到连接操作完成或错误发生才返回。如果当前 SocketChannel 是 non-blocking 模式，函数在连接能立刻被建立时返回 true ，否则函数返回 false ，应用程序需要在以后用 finishConnect() 方法来完成连接操作。</p>
<p><strong>Pipe</strong></p>
<p>包含了一个读和一个写的 channel(Pipe.SourceChannel 和 Pipe.SinkChannel) ，这对 channel 可以用于进程中的通讯。</p>
<p><strong>FileChannel</strong></p>
<p>用于对文件的读、写、映射、锁定等操作。和映射操作相关的类有 FileChannel.MapMode ，和锁定操作相关的类有 FileLock 。值得注意的是 FileChannel 并不支持非阻塞操作。</p>
<p><strong>Channels</strong></p>
<p>这个类提供了一系列 static 方法来支持 stream 类和 channel 类之间的互操作。这些方法可以将 channel 类包装为 stream 类，比如，将 ReadableByteChannel 包装为 InputStream 或 Reader ；也可以将 stream 类包装为 channel 类，比如，将 OutputStream 包装为 WritableByteChannel 。</p>
<p>Package java.nio.charset</p>
<p>这个包定义了 Charset 及相应的 encoder 和 decoder 。下面这张 UML 类图描述了这个包中类的关系，可以将其中 Charset ， CharsetDecoder 和 CharsetEncoder 理解成一个 Abstract Factory 模式的实现：</p>
<p><img src="" alt=""></p>
<p><strong>Charset</strong></p>
<p>代表了一个字符集，同时提供了 factory method 来构建相应的 CharsetDecoder 和 CharsetEncoder 。</p>
<p>Charset 提供了以下 static 的方法：</p>
<p>SortedMap availableCharsets()</p>
<pre><code>     返回当前系统支持的所有 Charset 对象，用 charset 的名字作为 set 的 key 。
</code></pre><p>boolean isSupported(String charsetName)</p>
<pre><code>     判断该名字对应的字符集是否被当前系统支持。
</code></pre><p>Charset forName(String charsetName)</p>
<pre><code>     返回该名字对应的 Charset 对象。
</code></pre><p>Charset 中比较重要的方法有：</p>
<p>String name()</p>
<pre><code>     返回该字符集的规范名。
</code></pre><p>Set aliases()</p>
<pre><code>     返回该字符集的所有别名。
</code></pre><p>CharsetDecoder newDecoder()</p>
<pre><code>     创建一个对应于这个 Charset 的 decoder 。
</code></pre><p>CharsetEncoder newEncoder()</p>
<pre><code>     创建一个对应于这个 Charset 的 encoder 。
</code></pre><p><strong>CharsetDecoder</strong></p>
<p>将按某种字符集编码的字节流解码为 unicode 字符数据的引擎。</p>
<p>CharsetDecoder 的输入是 ByteBuffer ，输出是 CharBuffer 。进行 decode 操作时一般按如下步骤进行：</p>
<p>1． 调用 CharsetDecoder 的 reset() 方法。（第一次使用时可不调用）</p>
<p>2． 调用 decode() 方法 0 到 n 次，将 endOfInput 参数设为 false ，告诉 decoder 有可能还有新的数据送入。</p>
<p>3． 调用 decode() 方法最后一次，将 endOfInput 参数设为 true ，告诉 decoder 所有数据都已经送入。</p>
<p>4． 调用 decoder 的 flush() 方法。让 decoder 有机会把一些内部状态写到输出的 CharBuffer 中。</p>
<p>CharsetDecoder reset()</p>
<pre><code>     重置 decoder ，并清除 decoder 中的一些内部状态。
</code></pre><p>CoderResult decode(ByteBuffer in, CharBuffer out, boolean endOfInput)</p>
<p>从 ByteBuffer 类型的输入中 decode 尽可能多的字节，并将结果写到 CharBuffer 类型的输出中。根据 decode 的结果，可能返回 3 种 CoderResult ： CoderResult.UNDERFLOW 表示已经没有输入可以 decode ； CoderResult.OVERFLOW 表示输出已满；其它的 CoderResult 表示 decode 过程中有错误发生。根据返回的结果，应用程序可以采取相应的措施，比如，增加输入，清除输出等等，然后再次调用 decode() 方法。</p>
<p>CoderResult flush(CharBuffer out)</p>
<p>有些 decoder 会在 decode 的过程中保留一些内部状态，调用这个方法让这些 decoder 有机会将这些内部状态写到输出的 CharBuffer 中。调用成功返回 CoderResult.UNDERFLOW 。如果输出的空间不够，该函数返回 CoderResult.OVERFLOW ，这时应用程序应该扩大输出 CharBuffer 的空间，然后再次调用该方法。</p>
<p>CharBuffer decode(ByteBuffer in)</p>
<p>一个便捷的方法把 ByteBuffer 中的内容 decode 到一个新创建的 CharBuffer 中。在这个方法中包括了前面提到的 4 个步骤，所以不能和前 3 个函数一起使用。</p>
<p>decode 过程中的错误有两种： malformed-input CoderResult 表示输入中数据有误； unmappable-character CoderResult 表示输入中有数据无法被解码成 unicode 的字符。如何处理 decode 过程中的错误取决于 decoder 的设置。对于这两种错误， decoder 可以通过 CodingErrorAction 设置成：</p>
<p>1． 忽略错误</p>
<p>2． 报告错误。（这会导致错误发生时， decode() 方法返回一个表示该错误的 CoderResult 。）</p>
<p>3． 替换错误，用 decoder 中的替换字串替换掉有错误的部分。</p>
<p>CodingErrorAction malformedInputAction()</p>
<pre><code>     返回 malformed-input 的出错处理。
</code></pre><p>CharsetDecoder onMalformedInput(CodingErrorAction newAction)</p>
<pre><code>     设置 malformed-input 的出错处理。
</code></pre><p>CodingErrorAction unmappableCharacterAction()</p>
<pre><code>     返回 unmappable-character 的出错处理。
</code></pre><p>CharsetDecoder onUnmappableCharacter(CodingErrorAction newAction)</p>
<pre><code>     设置 unmappable-character 的出错处理。
</code></pre><p>String replacement()</p>
<pre><code>     返回 decoder 的替换字串。
</code></pre><p>CharsetDecoder replaceWith(String newReplacement)</p>
<pre><code>     设置 decoder 的替换字串。
</code></pre><p><strong>CharsetEncoder</strong></p>
<p>将 unicode 字符数据编码为特定字符集的字节流的引擎。其接口和 CharsetDecoder 相类似。</p>
<p><strong>CoderResult</strong></p>
<p>描述 encode/decode 操作结果的类。</p>
<p>CodeResult 包含两个 static 成员：</p>
<p>CoderResult OVERFLOW</p>
<pre><code>     表示输出已满
</code></pre><p>CoderResult UNDERFLOW</p>
<pre><code>     表示输入已无数据可用。
</code></pre><p>其主要的成员函数有：</p>
<p>boolean isError()</p>
<p>boolean isMalformed()</p>
<p>boolean isUnmappable()</p>
<p>boolean isOverflow()</p>
<p>boolean isUnderflow()</p>
<pre><code>     用于判断该 CoderResult 描述的错误。
</code></pre><p>int length()</p>
<pre><code>     返回错误的长度，比如，无法被转换成 unicode 的字节长度。
</code></pre><p>void throwException()</p>
<pre><code>     抛出一个和这个 CoderResult 相对应的 exception 。
</code></pre><p><strong>CodingErrorAction</strong></p>
<p>表示 encoder/decoder 中错误处理方法的类。可将其看成一个 enum 类型。有以下 static 属性：</p>
<p>CodingErrorAction IGNORE</p>
<pre><code>     忽略错误。
</code></pre><p>CodingErrorAction REPLACE</p>
<pre><code>     用替换字串替换有错误的部分。
</code></pre><p>CodingErrorAction REPORT</p>
<p>报告错误，对于不同的函数，有可能是返回一个和错误有关的 CoderResult ，也有可能是抛出一个 CharacterCodingException 。
posted on 2007-01-12 20:07 <a href="http://www.blogjava.net/19851985lili/" target="_blank">☜♥☞MengChuChen</a> 阅读(6999) <a href="">评论(0)</a>  <a href="http://www.blogjava.net/19851985lili/admin/EditArticles.aspx?postid=93524" target="_blank">编辑</a>  <a href="http://www.blogjava.net/19851985lili/AddToFavorite.aspx?id=93524" target="_blank">收藏</a> <img src="" alt=""></p>
<p><a href="http://www.blogjava.net/RequireRegister.aspx" target="_blank">新用户注册</a>  <a href="">刷新评论列表</a>  </p>
<p><a href=""></a> <a href="http://www.aliyun.com/cps/channel?channel_id=1306&amp;user=0&amp;lv=1">推荐购买云服务器（15%返利+最高千元奖金）</a>   <a href="http://www.cnblogs.com/" target="_blank">博客园</a>  <a href="http://q.cnblogs.com/" target="_blank">博问</a>  <a href="http://news.cnblogs.com/" target="_blank">IT新闻</a>  <a href="http://job.cnblogs.com/cate-java_programmer/" target="_blank">Java程序员招聘</a> 标题  请输入标题 姓名  请输入你的姓名 主页 请输入验证码 验证码 /*  <img src="http://www.blogjava.net/Modules/CaptchaImage/JpegImage.aspx?cacheid=20130718160740" alt=""> 内容(请不要发表任何与政治相关的内容) 请输入评论内容 Remember Me?   <a href="http://www.blogjava.net/login.aspx?ReturnURL=http://www.blogjava.net/19851985lili/articles/93524.html&amp;SourceURL=/19851985lili/articles/93524.html" target="_blank">登录</a>       [使用Ctrl+Enter键可以直接提交]      网站导航:</p>
<p><a href="http://www.cnblogs.com/" title="程序员的网上家园" target="_blank">博客园</a>   <a href="http://news.cnblogs.com/" target="_blank">IT新闻</a>   <a href="http://kb.cnblogs.com/" target="_blank">知识库</a>   <a href="http://www.cppblog.com/" target="_blank">C++博客</a>   <a href="http://job.cnblogs.com/" target="_blank">程序员招聘</a>   <a href="http://www.blogjava.net/19851985lili/articles/93524.html?opt=admin" target="_blank">管理</a><br>Copyright ©2013 ☜♥☞MengChuChen Powered By<a href="http://www.blogjava.net/" target="_blank">博客园</a> 模板提供：<a href="http://blog.hjenglish.com/" target="_blank">沪江博客</a></p>

      
    </div>
    <section id='after_content_widget'><div class="widget" id="widget_after_content_wumiiRelatedItems>">
<script type="text/javascript" id="wumiiRelatedItems"></script>
</div><div class="widget" id="widget_after_content_post_footer_info>">
<div class="panel panel-success">
    <div class="panel-heading" align="center">希望本站内容对您有点用处,有什么疑问或建议请在后面留言评论</div>
    <div align="center" class="panel-body">转载请注明作者(<a href="http://itsolife.com/about/">RobinChia</a>)和出处 <a href="http://itsolife.com">It so life</a> ，请勿用于任何商业用途</div>
    <div class="panel-body">本文链接: <a href="/2014/02/02/2014-02-02-JavaJ2EE-NIO--JavaNIOAPI详解/">Java NIO API详解</a></div>
</div>
</div></section>
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/Java&J2EE/">Java&J2EE</a></li></span><span class="breadcrumb"><li><a href="/categories/Java&J2EE/">Java&J2EE</a></li><li><a href="/categories/Java&J2EE/NIO/">NIO</a></li></span></span> | <span class="tags">Tagged <a href="/tags/Java&J2EE/" class="label label-primary">Java&J2EE</a><a href="/tags/NIO/" class="label label-success">NIO</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:41"datetime="2014-03-07 09:54:41"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-JavaJ2EE-NIO--JavaNIOAPI详解/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-JavaJ2EE-NIO--JavaNIOAPI详解" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>


    <section id='after_post_widget'><div class="widget" id="widget_after_post_post_pageNav>">
<ul class="pager">
  
  <li class="previous"><a href="/2014/02/02/2014-02-02-JavaJ2EE-NIO--javanio网络编程的一点心得/" title="java nio网络编程的一点心得">&larr; java nio网络编程的一点心得</a></li>
  
  
  <li class="next"><a href="/2014/02/02/2014-02-02-JavaJ2EE-NIO--Javaaio异步网络IO初探/" title="Java aio(异步网络IO)初探">Java aio(异步网络IO)初探 &rarr;</a></li>
  
</ul></div><div class="widget" id="widget_after_post_related_posts>">
<ul class="list-group"><li class="list-group-item"><a href="/2014/02/02/2014-02-02-JavaJ2EE-IO--java中的io系统详解/">java中的io系统详解</a></li><li class="list-group-item"><a href="/2014/02/02/2014-02-02-JavaJ2EE-JVM--GC策略的调优/">GC策略的调优</a></li><li class="list-group-item"><a href="/2014/02/02/2014-02-02-JavaJ2EE-算法数组优化-算法--时间复杂度/">时间复杂度</a></li><li class="list-group-item"><a href="/2014/02/02/2014-02-02-JavaJ2EE-java深入分析--线性表分析及Java实现/">线性表分析及Java实现</a></li><li class="list-group-item"><a href="/2014/02/02/2014-02-02-JavaJ2EE-Java_设计类--浅谈Java开发中的设计模式/">浅谈Java开发中的设计模式</a></li><li class="list-group-item"><a href="/2014/02/02/2014-02-02-JavaJ2EE-算法数组优化-算法--KnowThyComplexities/">Know Thy Complexities!</a></li><li class="list-group-item"><a href="/2014/02/02/2014-02-02-JavaJ2EE-Java_总结类--使用MemoryAnalyzertoolMAT分析内存泄漏（二）/">使用Memory Analyzer tool(MAT)分析内存泄漏（二）</a></li><li class="list-group-item"><a href="/2014/02/02/2014-02-02-JavaJ2EE-JVM--JVM调优总结（九）-新一代的垃圾回收算法/">JVM调优总结（九）</a></li></ul></div></section>    
	<div id="comments"><!-- Duoshuo Comment BEGIN -->

<div class="ds-thread"  data-thread-key="2014-02-02-JavaJ2EE-NIO--JavaNIOAPI详解"  data-url="http://itsolife.com/2014/02/02/2014-02-02-JavaJ2EE-NIO--JavaNIOAPI详解/" data-title="Java NIO API详解"></div>

		

<!-- Duoshuo Comment END -->

</div></div><!--wapper-->
       </div><!-- ID main-col END -->
       <aside id="sidebar" class="alignright col-sx-6 col-sm-4 col-md-3 col-lg-3">
<div id="widget_search" class="widget panel panel-primary">
    <form action="//google.com/search" method="get" accept-charset="utf-8">
  <div class="input-group">
    <input class="form-control" id="searchbox" type="search" name="q" results="0" placeholder="search">
    <span class="input-group-btn">
      <button class="btn btn-default" type="submit">Go!</button>
    </span>
    <input type="hidden" name="q" value="site:itsolife.com">
  </div>
</form>
</div>

<div id="widget_category" class="widget panel panel-primary">
  <div class="panel-heading">category</div>  <div data-src='category' class='ajax_widgets'>正在加载...</div>
</div>

<div id="widget_recent_posts" class="widget panel panel-primary">
  <div class="panel-heading">recent posts</div>  <div data-src='recent_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_tagcloud" class="widget panel panel-primary">
  <div class="panel-heading">tagcloud</div>  <div data-src='tagcloud' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_latest_update_posts" class="widget panel panel-primary">
  <div class="panel-heading">最近更新</div>  <div data-src='latest_update_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_recent_comments" class="widget panel panel-primary">
  <div class="panel-heading">recent comments</div>  

<div class="list-group-item ds-recent-comments" data-num-items="6" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="50"></div>



</div>

</aside>
       <div class="clearfix"></div>
     </div><!-- row END -->
  </div>
  <footer id="footer" class="container">
  <div class="panel panel-info">
  <section id='footer_widget'></section>  <div class="panel-footer">
  <div id="site-info">
    <span class='author'>
  
  &copy; 2014 RobinChia
  
    &nbsp;&nbsp;</span>
  
  <span id='analytics-51la'></span><span id='analytics-google'>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-48559895-1']);
  _gaq.push(['_trackPageview']);
  _js2load.push({src:('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'});
</script></span><span id='analytics-cnzz'>
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_5774006'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s17.cnzz.com/stat.php%3Fid%3D5774006%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
</span><span id='analytics-baidu'>
<script>
var _hmt = _hmt || [];
_js2load.push({src:"//hm.baidu.com/hm.js?1442f50724afc42380b51f097c43082c"});
</script>
</span>  </div>
  <div id="copyright">Blog powered by <a href='http://zespia.tw/hexo/'><strong>hexo</strong></a> Theme <strong><a href='https://github.com/chenall/hexo-theme-chenall'>chenall</a></strong>(Some change in it)<span class="pull-right"> 更新时间: <em>2014-03-07 09:54:41</em></span></div>
</div>
<div class="clearfix"></div>


  </div>
  </footer>
  
        <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>        
        <script src="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/js/bootstrap.min.js"></script>        
                
        <script src="http://cdn.bootcss.com/prettify/r298/prettify.min.js"></script>    <script type="text/javascript">
   var lang=["bsh", "c", "cc", "cpp", "cs", "csh", "cyc", "cv", "htm", "html",
    "java", "js", "m", "mxml", "perl", "pl", "pm", "py", "rb", "sh",
    "xhtml", "xml", "xsl"];
   var pretty_base='';
   $('script').each(function(){
	var c = $(this).attr('src');
	if (!c)
	    return;
	if (c.match(/(\/)?prettify(\.min)?\.js/i))
	{
	    var index = c.lastIndexOf('/');
	    if (index != -1)
		pretty_base = c.substr(0,index + 1);
	    return false;
	}
   })
   $('pre code').each(function(){
	var c = $(this).attr('class')
	if (!c)
	    return;
	c = c.match(/\s?(lang\-\w+)/i);
	if (c && lang.indexOf(c[1]) == -1)
	{
	    lang.push(c[1]);
	    $.getScript(pretty_base + c[1] + '.min.js');
	}
   })

    $(window).load(function(){
       $("pre").addClass("prettyprint");
       prettyPrint();
    })
</script>    
            <script type="text/javascript">
var duoshuoQuery = {short_name:"robinchia"};
_js2load.push({src:'http://static.duoshuo.com/embed.js',charset:'UTF-8'});
</script>
    
            <!--wumii_relatedItems-->

<script type="text/javascript">
    var wumiiPermaLink = "http://itsolife.com/2014/02/02/2014-02-02-JavaJ2EE-NIO--JavaNIOAPI详解/";
    var wumiiTitle = "Java NIO API详解";
    var wumiiTags = "Java&J2EE,NIO";
    var wumiiCategories = ["Java&J2EE","Java&J2EE","NIO"];
    var wumiiSitePrefix = "http://itsolife.com";
    var wumiiParams = "&num=5&mode=3&pf=JAVASCRIPT";
    _js2load.push({src:'http://widget.wumii.cn/ext/relatedItemsWidget'});
</script>
<a href="http://www.wumii.com/widget/relatedItems" style="border:0;">
<img src="http://static.wumii.cn/images/pixel.png" alt="无觅关联推荐，快速提升流量" style="border:0;padding:0;margin:0;" />
</a>
    
        <script src="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js"></script>    <script type="text/javascript">
(function($){
  $('.entry').each(function(i){
    $(this).find('img').each(function(){
      var alt = this.alt;

      if (alt){
        $(this).before('<span class="caption">' + alt + '</span>');
      }

      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="fancybox' + i + '" />');
    });
  });

  $('.fancybox').fancybox();
})(jQuery);
</script>    
        <script src="http://cdn.bootcss.com/mathjax/2.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>
    
<script type="text/javascript">
$('.ajax_widgets').each(function(){var src=$(this).attr('data-src');if(src)$(this).load('/widgets/'+src+'.html');});
$.each(_js2load,function(index,obj){loadjs(obj.src,obj.charset)});
</script>

<div id="scroll2top">
<img src="/scroll2top/arrow.png"/>
</div>
<script src="/scroll2top/scroll2top.min.js"></script>
<div id="winterland">
  <canvas></canvas>
</div>
<script src="/js/winterland.min.js"></script>

  </body>
</html>
