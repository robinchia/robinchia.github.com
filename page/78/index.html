
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>The 78 Page | It so life</title>
<meta name="author" content="RobinChia">

<meta name="description" content="It so life">


<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta property="og:site_name" content="It so life"/>

<!--[if IE]><style>.testIE.IE{display:inline;}</style><![endif]-->
<!--[if lte IE 7]><link rel="stylesheet" href="/css/ie7.css" type="text/css"><![endif]-->
<!--[if (lt IE 9)&(gt IE 7)]><style>.testIE.IE8{display:inline;}</style><![endif]-->
<!--[if gt IE 8]><style>.testIE.IE9{display:inline;}</style><![endif]-->

<link href="/favicon.png" rel="icon">
<link rel="alternate" href="/atom.xml" title="It so life Feed" type="application/atom+xml">

<link rel="stylesheet" href="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.0.3/css/font-awesome.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/prettify/r298/prettify.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" type="text/css">
<link rel="stylesheet" href="/css/style.css" type="text/css">
<!--[if lt IE 9]>
   <style>article,aside,dialog,footer,header,section,footer,nav,figure,menu{display:block}</style>
   <script src="http://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
   <script src="http://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
<link href="http://cdn.staticfile.org/respond.js/1.4.2/respond-proxy.html" id="respond-proxy" rel="respond-proxy" />
<link href="/js/respond.proxy.gif" id="respond-redirect" rel="respond-redirect" />
<script src="/js/respond.proxy.js"></script>
   <script src="http://cdn.bootcss.com/selectivizr/1.0.2/selectivizr-min.js"></script>
<![endif]-->
<script type="text/javascript">
function loadjs(c,d){var a=document.createElement("script");a.async=!0;a.type="text/javascript";a.src=c;a.charset=d||"gbk";(document.getElementsByTagName("HEAD")[0]||document.getElementsByTagName("BODY")[0]).appendChild(a)};
var _protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
var _js2load = [];
</script>

</head>
<body>
      <header id="header" class="container"><nav id="main-nav" class="navbar navbar-default navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="/">It so life</a>
    </div>
    <div  class="collapse navbar-collapse">
      <ul  class="nav navbar-nav">
  
        <li><a href="/" title="Home">Home</a></li>      
        <li><a href="/about/" title="About">About</a></li>      
        <li><a href="/archives/" title="Archives">Archives</a></li>      
      <li class='dropdown'>
        <a class='dropdown-toggle' data-toggle='dropdown' href='#'>website<b class='caret'></b></a>
        <ul class='dropdown-menu pure-menu-selected'>
    
          <li><a href="//groups.google.com/forum/#!forum/pongba" title="TopLanguage">TopLanguage</a></li>    
          <li><a href="//itpub.net/" title="ITPub">ITPub</a></li>    
          <li><a href="//blog.jobbole.com/" title="Bole">Bole</a></li>    
          <li><a href="//nosql-database.org/" title="nosql">nosql</a></li>    
          <li><a href="//gitimmersion.googol.im/" title="Git">Git</a></li>    
        </ul>
      </li>
    
      </ul>
      <ul class="nav navbar-nav navbar-right">
      
        <li><a href="/atom.xml">RSS</a></li>
      
      
        <li><a href="https://twitter.com/robinchia">twitter</a></li>
      
      
      
      
        <li><a href="https://github.com/robinchia">github</a></li>
      
      </ul>
    </div>
  </div>
</nav>
<div class="clearfix"></div>
</header>
  <div id='content' class="container">
     <div class="page-header-wrapper">
      <!--[if lt IE 9]><div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong>提示:</strong>您的浏览器版本太低了,建议升级到 <strong><a href="http://windows.microsoft.com/zh-cn/internet-explorer/download-ie" title="IE9">IE9</a></strong> 以上,本站使用<a href="https://www.google.com/intl/zh-CN/chrome/">Chrome浏览器</a>可以获得最好的显示效果.</div><![endif]-->
      <div class="page-header"><h1 align="center"><big>It so life</big> </h1>
        <h5 align="center"><big>love as life</big></h5>
      </div>
     </div>
     <div class="row">
       <div id="main-col" class="alignleft col-sx-12 col-sm-8 col-md-9 col-lg-9">
      <section id='header_widget'></section>
          <div id="wrapper"><article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-JavaJ2EE-算法数组优化-算法--数学之美番外篇：快排为什么那样快/">数学之美番外篇：快排为什么那样快</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:40.000Z"> <a href="/2014/02/02/2014-02-02-JavaJ2EE-算法数组优化-算法--数学之美番外篇：快排为什么那样快/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-">数学之美番外篇：快排为什么那样快</h1>
<ul>
<li><a href="http://mindhacks.cn/about/" target="_blank">Mind Hacks 的含义</a></li>
<li><a href="http://mindhacks.cn/former-life-of-mindhacks/" target="_blank">前世档案 | C++的罗浮宫</a></li>
<li><a href="http://mindhacks.cn/archives/" target="_blank">所有文章</a></li>
<li><a href="http://mindhacks.cn/about-toplanguage/" target="_blank">TopLanguage 讨论组</a></li>
<li><a href="http://mindhacks.cn/friend-links/" target="_blank">价值博客们</a></li>
</ul>
<p><a href="http://mindhacks.cn/" target="_blank">刘未鹏 | Mind Hacks</a> 思维改变生活</p>
<ul>
<li><a href="http://mindhacks.cn/topics/learning-method/" target="_blank">学习方法</a></li>
<li><a href="http://mindhacks.cn/topics/mind/" target="_blank">思维改变生活</a></li>
<li><a href="http://mindhacks.cn/topics/algorithms/" target="_blank">算法</a></li>
<li><a href="http://mindhacks.cn/topics/computer-science/" target="_blank">计算机科学</a></li>
<li><a href="http://mindhacks.cn/topics/math/" target="_blank">数学</a></li>
<li><a href="http://mindhacks.cn/topics/machine-learning/" target="_blank">机器学习与人工智能</a></li>
<li><p><a href="http://mindhacks.cn/topics/programming/" target="_blank">编程</a></p>
</li>
<li><p><a href="http://mindhacks.cn/feed/" title="刘未鹏 | Mind Hacks RSS Feed" target="_blank">RSS Feed</a></p>
</li>
</ul>
<h1 id="-http-mindhacks-cn-2008-06-13-why-is-quicksort-so-quick-"><a href="http://mindhacks.cn/2008/06/13/why-is-quicksort-so-quick/" target="_blank">数学之美番外篇：快排为什么那样快</a></h1>
<p>By <a href="http://mindhacks.cn/author/pongba/" title="???" target="_blank">???</a> – June 13, 2008<strong>Posted in:</strong><a href="http://mindhacks.cn/topics/math/" target="_blank">数学</a>, <a href="http://mindhacks.cn/topics/algorithms/" target="_blank">算法</a>, <a href="http://mindhacks.cn/topics/computer-science/" target="_blank">计算机科学</a></p>
<p><strong>目录</strong></p>
<ol>
<li><p>前言</p>
</li>
<li><p>猜数字</p>
</li>
<li><p>称球</p>
</li>
<li><p>排序</p>
<p> 3.1 为什么堆排比快排慢</p>
<p> 3.2 为什么快排其实也不是那么快</p>
<p> 3.3 基排又为什么那么快呢</p>
</li>
<li><p>信息论！信息论？</p>
</li>
<li><p>小结</p>
</li>
</ol>
<p><strong>0.**</strong>前言**</p>
<p>知道这个理论是在<a href="http://groups.google.com/group/pongba" target="_blank">TopLanguage</a>上的一次讨论，先是g9<a href="http://groups.google.com/group/pongba/msg/f95aa12feb4dfd67" target="_blank">转了David MacKay的一篇文章</a>，然后引发了牛人们的<a href="http://groups.google.com/group/pongba/browse_frm/thread/28ac39e0222becf2" target="_blank">一场关于信息论的讨论</a>。Anyway，正如g9很久以前在<a href="http://blog.csdn.net/g9yuayon" target="_blank">Blog</a>里面所<a href="http://blog.csdn.net/g9yuayon/archive/2007/04/22/1574518.aspx" target="_blank">说</a>的：
有时无知是福。俺看到一点新鲜的科普也能觉得造化神奇。刚才读Gerald Jay Sussman（<a href="http://mitpress.mit.edu/sicp/" target="_blank">SICP</a>作者）的文章，<a href="http://swiss.csail.mit.edu/classes/symbolic/spring07/readings/robust-systems.pdf" target="_blank">Building Robust Systems – an essay</a>，竟然心如小鹿乱撞，手心湿润，仿佛第一次握住初恋情人温柔的手。</p>
<p>而看到<a href="http://users.aims.ac.za/~mackay/" target="_blank">MacKay</a>的这篇文章我也有这种感觉——以前模糊的东西忽然有了深刻的解释，一切顿时变得明白无比。原来看问题的角度或层面能够带来这么大的变化。再一次印证了越是深刻的原理往往越是简单和强大。所以说，土鳖也有土鳖的幸福:P</p>
<p>这篇文章相当于MacKay<a href="http://users.aims.ac.za/~mackay/sorting/sorting.html" target="_blank">原文</a>的白话文版。MacKay在原文中用到了信息论的知识，后者在我看来并不是必须的，尽管计算的时候方便，但与本质无关。所以我用大白话解释了一通。</p>
<p><strong>1.**</strong>猜数字**</p>
<p>我们先来玩一个猜数字游戏：我心里默念一个1~64之间的数，你来猜（你只能问答案是“是”或“否”的问题）。为了保证不论在什么情况下都能以尽量少的次数猜中，你应该采取什么策略呢？很显然，二分。先是猜是不是位于1~32之间，排除掉一半可能性，然后对区间继续二分。这种策略能够保证无论数字怎么跟你捉迷藏，都能在log_2{n}次以内猜中。用算法的术语来说就是它的下界是最好的。</p>
<p>我们再来回顾一下这个游戏所蕴含的本质：为什么这种策略具有最优下界？答案也很简单，这个策略是平衡的。反之如果策略不是平衡的，比如问是不是在1~10之间，那么一旦发现不是在1~10之间的话就会剩下比N/2更多的可能性需要去考察了。</p>
<p><a href="http://blog.youxu.info/" target="_blank">徐宥</a>在讨论中提到，这种策略的本质可以概括成“让未知世界无机可乘”。它是没有“弱点的”，<strong>答案的任何一个分支都是等概率的</strong>。反之，一旦某个分支蕴含的可能性更多，当情况落到那个分支上的时候你就郁闷了。比如猜数字游戏最糟糕的策略就是一个一个的猜：是1吗？是2吗？… 因为这种猜法最差的情况下需要64次才能猜对，下界非常糟糕。二分搜索为什么好，就是因为它每次都将可能性排除一半并且<strong>无论如何</strong>都能排除一半（它是最糟情况下表现最好的）。</p>
<p><strong>2.**</strong>称球**</p>
<p>12个小球，其中有一个是坏球。有一架天平。需要你用最少的称次数来确定哪个小球是坏的并且它到底是轻还是重。</p>
<p>这个问题是一道流传已久的智力题。网络上也有很多讲解，还有泛化到N个球的情况下的严格证明。也有零星的一些地方提到从信息论的角度来看待最优解法。本来我一直认为这道题目除了试错之外没有其它高妙的思路了，只能一个个方法试，并尽量从结果中寻找信息，然后看看哪种方案最少。</p>
<p>然而，实际上它的确有其它的思路，一个更本质的思路，而且根本用不着信息论这么拗口的知识。</p>
<p>我们先回顾一下猜数字游戏。为了保证任何情况下以最少次数猜中，我们的策略是每次都排除恰好一半的可能性。类比到称球问题上：坏球可能是12个球中的任意一个，这就是12种可能性；而其中每种可能性下坏球可能轻也可能重。于是“坏球是哪个球，是轻是重”这个问题的答案就有12×2=24种可能性。现在我们用天平来称球，就等同于对这24种可能性发问，由于天平的输出结果有三种“平衡、左倾、右倾”，这就相当于我们的问题有三个答案，即可以将所有的可能性切成三份，根据猜数字游戏的启发，我们应当尽量让这三个分支概率均等，即平均切分所有的可能性为三等份。如此一来的话一次称量就可以将答案的可能性缩减为原来的1/3，三次就能缩减为1/27。而总共才有24种可能性，所以理论上是完全可以3次称出来的。</p>
<p>如何称的指导原则有了，构造一个称的策略就不是什么太困难的事情了。首先不妨解释一下为什么最直观的称法不是最优的——6、6称：在6、6称的时候，天平平衡的可能性是0。刚才说了，最优策略应该使得天平三种状态的概率均等，这样才能三等分答案的所有可能性。</p>
<p>为了更清楚的看待这个问题，我们不妨假设有6个球，来考虑一下3、3称和2、2称的区别：</p>
<p>在未称之前，一共有12种可能性：1轻、1重、2轻、2重、…、6轻、6重。现在将1、2、3号放在左边，4、5、6放在右边3、3称了之后，不失一般性假设天平左倾，那么小球的可能性就变成了原来的一半（6种）：1重、2重、3重、4轻、5轻、6轻。即这种称法能排除一半可能性。</p>
<p>现在再来看2、2称法，即1、2放左边，3、4放右边，剩下的5、6不称，放一边。假设结果是天平平衡，那么可能性剩下——4种：5重、5轻、6重、6轻。假设天平左倾，可能性也剩下4种：1重、2重、3轻、4轻。右倾和左倾的情况类似。总之，这种称法，不管天平结果如何，情况都被我们缩小到了原来的三分之一！我们充分利用了“天平的结果状态可能有三种”这个条件来三等分所有可能性，而不是二等分。</p>
<p>说到这里，剩下的事情就实在很简单了：第二步称法，只要记着这样一个指导思想——你选择的称法必须使得当天平平衡的时候答案剩下的可能性和天平左倾（右倾）的时候答案剩下的可能性一样多。实际上，这等同于你得选择一种称法，使得天平输出三种结果的概率是均等的，因为天平输出某个结果的概率就等同于所有支持这个结果（左倾、右倾、平衡）的答案可能性的和，并且答案的每个可能性都是等概率的。</p>
<p>MacKay在他的书《Information Theory: Inference and Learning Algorithms》（<a href="http://users.aims.ac.za/~mackay/itila/book.html" target="_blank">作者开放免费电子书</a>）里面4.1节专门讲了这个称球问题，还画了一张不错的图，我就照抄了：</p>
<p><a href="http://mindhacks.cn/wp-content/uploads/2009/02/23131201.jpg" target="_blank"><img src="&quot;2313120&quot;" alt="2313120"></a></p>
<p>图中“1+”是指“1号小球为重”这一可能性。一开始一共有24种可能性。4、4称了之后不管哪种情况（分支），剩下来的可能性总是4种。这是一个完美的三分。然后对每个分支构造第二次称法，这里你只要稍加演算就可以发现，分支1上的第二次称法，即“1、2、6对3、4、5”这种称法，天平输出三种结果的可能性是均等的（严格来说是几乎均等）。这就是为什么这个称法能够在最坏的情况下也能表现最好的原因，没有哪个分支是它的弱点，它必然能将情况缩小到原来的1/3。</p>
<p><strong>3.**</strong>排序**</p>
<p>用前面的看问题视角，排序的本质可以这样来表述：一组未排序的N个数字，它们一共有N!种重排，其中只有一种排列是满足题意的（譬如从大到小排列）。换句话说，排序问题的可能性一共有N!种。任何基于比较的排序的基本操作单元都是“比较a和b”，这就相当于猜数字游戏里面的一个问句，显然这个问句的答案只能是“是”或“否”，一个只有两种输出的问题最多只能将可能性空间切成两半，根据上面的思路，最佳切法就是切成1/2和1/2。也就是说，我们希望在比较了a和b的大小关系之后，如果发现a<b的话剩下的排列可能性就变成N!/2，如果发现a>b也是剩下N!/2种可能性。由于假设每种排列的概率是均等的，所以这也就意味着支持a<b的排列一共有N!/2个，支持a>b的也是N!/2个，换言之，a<b的概率等于a>b的概率。</p>
<p>我们希望每次在比较a和b的时候，a<b和a>b的概率是均等的，这样我们就能保证无论如何都能将可能性缩小为原来的一半了！最优下界。</p>
<p>一个直接的推论是，如果每次都像上面这样的完美比较，那么N个元素的N!种可能排列只需要log_2{N!}就排查玩了，而log_2{N!}近似于NlogN。这正是快排的复杂度。</p>
<p><strong>3.1**</strong>为什么堆排比快排慢**</p>
<p>回顾一下堆排的过程：</p>
<ol>
<li><p>建立最大堆（堆顶的元素大于其两个儿子，两个儿子又分别大于它们各自下属的两个儿子… 以此类推）</p>
</li>
<li><p>将堆顶的元素和最后一个元素对调（相当于将堆顶元素（最大值）拿走，然后将堆底的那个元素补上它的空缺），然后让那最后一个元素从顶上往下滑到恰当的位置（重新使堆最大化）。</p>
</li>
<li><p>重复第2步。</p>
</li>
</ol>
<p>这里的关键问题就在于第2步，堆底的元素肯定很小，将它拿到堆顶和原本属于最大元素的两个子节点比较，它比它们大的可能性是微乎其微的。实际上它肯定小于其中的一个儿子。而大于另一个儿子的可能性非常小。于是，这一次比较的结果就是概率不均等的，根据前面的分析，概率不均等的比较是不明智的，因为它并不能保证在糟糕情况下也能将问题的可能性削减到原本的1/2。可以想像一种极端情况，如果a肯定小于b，那么比较a和b就会什么信息也得不到——原本剩下多少可能性还是剩下多少可能性。</p>
<p>在堆排里面有大量这种近乎无效的比较，因为被拿到堆顶的那个元素几乎肯定是很小的，而靠近堆顶的元素又几乎肯定是很大的，将一个很小的数和一个很大的数比较，结果几乎肯定是“小于”的，这就意味着问题的可能性只被排除掉了很小一部分。</p>
<p>这就是为什么堆排比较慢（堆排虽然和快排一样复杂度都是O(NlogN)但堆排复杂度的常系数更大）。</p>
<p>MacKay也提供了一个修改版的堆排：每次不是将堆底的元素拿到上面去，而是直接比较堆顶（最大）元素的两个儿子，即选出次大的元素。由于这两个儿子之间的大小关系是很不确定的，两者都很大，说不好哪个更大哪个更小，所以这次比较的两个结果就是概率均等的了。具体参考<a href="http://users.aims.ac.za/~mackay/sorting/sorting.html" target="_blank">这里</a>。</p>
<p><strong>3.2**</strong>为什么快排其实也不是那么快**</p>
<p>我们考虑快排的过程：随机选择一个元素做“轴元素”，将所有大于轴元素的移到左边，其余移到右边。根据这个过程，快排的第一次比较就是将一个元素和轴元素比较，这个时候显而易见的是，“大于”和“小于”的可能性各占一半。这是一次漂亮的比较。</p>
<p>然而，快排的第二次比较就不那么高明了：我们不妨令轴元素为pivot，第一次比较结果是a1<pivot，那么可以证明第二次比较a2也小于pivot的可能性是2/3！这容易证明：如果a2>pivot的话，那么a1，a2，pivot这三个元素之间的关系就完全确定了——a1&lt;pivot&lt;a2，剩下来的元素排列的可能性我们不妨记为P（不需要具体算出来）。而如果a2&lt;pivot呢？那么a1和a2的关系就仍然是不确定的，也就是说，这个分支里面含有两种情况：a1&lt;a2&lt;pivot，以及a2&lt;a1&lt;pivot。对于其中任一种情况，剩下的元素排列的可能性都是P，于是这个分支里面剩下的排列可能性就是2P。所以当a2&lt;pivot的时候，还剩下2/3的可能性需要排查。</p>
<p>再进一步，如果第二步比较果真发现a2&lt;pivot的话，第三步比较就更不妙了，模仿上面的推理，a3&lt;pivot的概率将会是3/4！</p>
<p>这就是快排也不那么快的原因，因为它也没有做到每次比较都能将剩下的可能性砍掉一半。</p>
<p><strong>3.3**</strong>鸡排为什么又那么快呢？**</p>
<p>传统的解释是：<a href="http://en.wikipedia.org/wiki/Radix_sort" target="_blank">基排</a>不是基于比较的，所以不具有后者的局限性。话是没错，但其实还可以将它和基于比较的排序做一个类比。</p>
<p>基排的过程也许是源于我们理顺一副牌的过程：如果你有N（N&lt;=13）张牌，乱序，如何理顺呢？我们假象桌上有十三个位置，然后我们将手里的牌一张一张放出去，如果是3，就放在位置3上，如果是J，就放在位置11上，放完了之后从位置1到位置13收集所有的牌（没有牌的位置上不收集任何牌）。</p>
<p>我们可以这样来理解基排高效的本质原因：假设前i张牌都已经放到了它们对应的位置上，第i+1张牌放出去的时候，实际上就相当于“一下子”就确立了它和前i张牌的大小关系，用O(1)的操作就将这张牌正确地插入到了前i张牌中的正确位置上，这个效果就相当于插入排序的第i轮原本需要比较O(i)次的，现在只需要O(1)了。</p>
<p>但是，为什么基排能够达到这个效果呢？上面只是解释了过程，解释了过程不代表解释了本质。</p>
<p>当i张牌放到位之后，放置第i+1张牌的时候有多少种可能性？大约i+1种，因为前i张牌将13个位置分割成了i+1个区间——第i+1张牌可以落在任意一个区间。所以放置第i+1张牌就好比是询问这样一个问题：“这张牌落在哪个区间呢？”而这个问题的答案有i+1种可能性？所以它就将剩下来的可能性均分成了i+1份（换句话说，砍掉了i/i+1的可能性！）。再看看基于比较的排序吧：由于每次比较只有两种结果，所以最多只能将剩下的可能性砍掉一半。</p>
<p>这就是为什么基排要快得多。而所有基于比较的排序都逃脱不了NlogN的宿命。</p>
<p><strong>4.**</strong>信息论！信息论？**</p>
<p>本来呢，MacKay写那篇文章是想用信息论来解释为什么堆排慢，以及为什么快排也慢的。MacKay在他的文章中的解释是，只有提出每种答案的概率都均等的问题，才能获得最大信息量。然而，仔细一想，其实这里信息论并不是因，而是果。这里不需要用信息论就完全能够解释，而且更明白。信息论只是对这个解释的一个形式化。当然，信息论在其它地方还是有应用的。但这里其实用不着信息论这么重量级的东西（也许具体计算一些数据的时候是需要的），而是只需要一种看问题的本质视角：将排序问题看成和猜数字一样，是通过问问题来缩小/排除（narrow down）结果的可能性区间，这样一来，就会发现，“最好的问题”就是那些能够均分所有可能性的问题，因为那样的话不管问题的答案如何，都能排除掉k-1/k（k为问题的答案有多少种输出——猜数字里面是2，称球里面是3）种可能性，而不均衡的问题总会有一个或一些答案分支排除掉的可能性要小于k-1/k。于是策略的下界就被拖累了。</p>
<p><strong>5.**</strong>小结**</p>
<p>这的确是“小结”，因为两点：</p>
<ol>
<li><p>这个问题可以有信息论的理论解释，而信息论则是一个相当大的领域了。</p>
</li>
<li><p>文中提到的这种看问题的视角除了用于排序、称球，还能够运用到哪些问题上（比如搜索）。</p>
</li>
</ol>
<p><strong>Update(06/13/2008)</strong> : <a href="http://blog.youxu.info/" target="_blank">徐宥</a>在讨论中<a href="http://groups.google.com/group/pongba/msg/07493e329ed920ff" target="_blank">继续提到</a>：
另外，这几天我重新把TAOCP 第三卷(第二版)翻出来看了看 Knuth 怎么说这个问题的, 发现真是牛大了：</p>
<p>先说性能：</p>
<p>pp148, section 5.2.3 说：</p>
<p>When N = 1000, the approximate average runiing time on MIX are
160000u for heapsort
130000u for shellsort
80000u  for quicksort</p>
<p>这里,  Knuth 同学发现一般情况下 heapsort 表现很不好. 于是，在下文他就说，习题18 (pp156, 难度21)</p>
<p>(R.W.Floyd) During the selection phase of heapsort, the key K tends to
be quite small, so that nearly all the comparisons in step H6 find
K&lt;K_j. Show how to modify the algorithm so that K is not compared with
K_j in the main loop of the computation, thereby nearly cutting the
average number of comparisons in half.</p>
<p>答案里面的方法和DMK的方法是一样的。(我觉得DMK是看了这个论文或者TAoCP的) 这里说 by half，就正好和快排差不多了。</p>
<p>再说信息论分析：</p>
<p>在5.3.1 (pp181) 高爷爷就说, “排序问题可以看成是一个树上的鸟儿排排站的问题. (还特地画了一棵树), 下一段就说, 其实这个也
有等价说法, 就是信息论, 我们从称球问题说起…”</p>
<p>然后后面一直讲信息论和最小比较排序…</p>
<p>高爷爷真不愧是姓高的，囧rz..
<strong>Tags:</strong> <a href="http://mindhacks.cn/tags/%e6%95%b0%e5%ad%a6/" target="_blank">数学</a>, <a href="http://mindhacks.cn/tags/%e7%ae%97%e6%b3%95/" target="_blank">算法</a>, <a href="http://mindhacks.cn/tags/%e8%ae%a1%e7%ae%97%e6%9c%ba%e7%a7%91%e5%ad%a6/" target="_blank">计算机科学</a></p>
<p><a href="http://mindhacks.cn/author/pongba/"></a></p>
<h3 id="about-">About ???</h3>
<p> <a href=""></a> <a href=""></a></p>
<p><a href="">喜欢取消喜欢</a>2 人喜欢</p>
<p><a href="">最新</a><a href="">最早</a><a href="">最热</a></p>
<ul>
<li><a href="">26条评论</a></li>
<li><a href="">14条转载</a></li>
<li><a href="">28条新浪微博</a></li>
<li><p><a href="">1条腾讯微博</a></p>
</li>
<li><p><img src="" alt="chaonin"></p>
</li>
</ul>
<p>chaonin</p>
<p>@@之前就在你的卢浮宫看到了，写的直白明了！
小弟学的是编码，呵呵。
Mackay的那本书重点是介绍编码的，具体的说是纠错码的。编码理论的重要基础是信息论。
他对这些问题的分析不是专门要来分析这写问题的，而只是用信息论的方法来解释这些现象。</p>
<p>2009年2月17日<a href="">回复</a><a href="">顶</a><a href="">转发</a><a href="">举报</a></p>
<ul>
<li><a href="http://stupidpig.cublog.cn/" title="帅得不敢出门" target="_blank"><img src="" alt="帅得不敢出门"></a></li>
</ul>
<p><a href="http://stupidpig.cublog.cn/" target="_blank">帅得不敢出门</a></p>
<p>受益良多
每每看到一些精妙的解法(算法),都想拍手称快.</p>
<p>2009年3月23日<a href="">回复</a><a href="">顶</a><a href="">转发</a><a href="">举报</a></p>
<ul>
<li><a href="http://www.cloved.cn/" title="conan" target="_blank"><img src="" alt="conan"></a></li>
</ul>
<p><a href="http://www.cloved.cn/" target="_blank">conan</a></p>
<p>关注toplanguage很久了.只是一直不敢在上面留言,看上面的聊天就感觉自己是沧海一粟.今天看到一篇.可能你是幸运的吧.我大概算了下,你应该是和我同届的.不过我比你小一岁.马上就毕业两年了.研究生们也快毕业了....回忆这些日子,感觉偏离了自己的目标,也感觉工作后并没有自己希望的成长着.一直觉得学校的东西很迂腐,什么都需要自己去学习.曾经也深深相信自己能好好成长起来.只是,到了今天,不知道自己是否还跟着大家的脚步....</p>
<p>2009年5月11日<a href="">回复</a><a href="">顶</a><a href="">转发</a><a href="">举报</a></p>
<ul>
<li><img src="" alt="metal-fan"></li>
</ul>
<p>metal-fan</p>
<p>写的太棒了～深入本质～受益匪浅！！！</p>
<p>2009年10月15日<a href="">回复</a><a href="">顶</a><a href="">转发</a><a href="">举报</a></p>
<ul>
<li><img src="" alt="raymond"></li>
</ul>
<p>raymond</p>
<p>这是最大熵原则的几个例子，即保留最大的不确定性，因为这样才能保留最大的信息。生活中很多问题都可以归结为一些简单的法则，而在实际处理问题的时候，这些简单的法则会被以各种各样的形式掩盖，从而让我们失去探索的机会。博主是个有心人啊</p>
<p>2009年12月25日<a href="">回复</a><a href="">顶</a><a href="">转发</a><a href="">举报</a></p>
<ul>
<li><img src="" alt="bigining"></li>
</ul>
<p>bigining</p>
<p>在说到12个的例子时，第二次称时：“这是一个完美的三分。然后对每个分支构造第二次称法，这里你只要稍加演算就可以发现，分支1上的第二次称法，即“1、2、6对3、4、5”这种称法，天平输出三种结果的可能性是均等的（严格来说是几乎均等）。”，但是这样好像是找不出那个不同的球的。不知道1、2、6对3、4、5之后要怎么进行判断？（可以假设1、2、6比3、4、5重，然后只能说明1、 2较重或5较轻，然后第三次要怎么进行？）</p>
<p>2010年4月24日<a href="">回复</a><a href="">顶</a><a href="">转发</a><a href="">举报</a></p>
<ul>
<li><img src="" alt="Ted"></li>
</ul>
<p>Ted</p>
<p>晕，你都说了“然后只能说明1、 2较重或5较轻”，这还不明显，再把1，2分别放2边，哪个重，哪个就是，否则就是平衡，那5就是目标。</p>
<p>2011年11月28日<a href="">回复</a><a href="">顶</a><a href="">转发</a><a href="">举报</a></p>
<ul>
<li><img src="" alt="simple"></li>
</ul>
<p>simple</p>
<p>以6个球的例子来说，这个策略的“答案”是随着剩下的可能性（或者说剩下的球）的数量而发生变化的，比如，当球剩下2个时，那么天平的输出结果只可能有两种：左或右倾。因此，这时候应该是以以2去平分剩下的可能性。</p>
<p>2012年9月21日<a href="">回复</a><a href="">顶</a><a href="">转发</a><a href="">举报</a></p>
<ul>
<li><img src="" alt="rrison"></li>
</ul>
<p>rrison</p>
<p>离散数学里的博弈树</p>
<p>2010年5月6日<a href="">回复</a><a href="">顶</a><a href="">转发</a><a href="">举报</a></p>
<ul>
<li><a href="http://www.usbphoneworld.com/lbded6620.html" title="dell latitude d620 laptop battery" target="_blank"><img src="" alt="dell latitude d620 laptop battery"></a></li>
</ul>
<p><a href="http://www.usbphoneworld.com/lbded6620.html" target="_blank">dell latitude d620 laptop battery</a></p>
<p>非常感谢。受益良多。</p>
<p>2010年6月13日<a href="">回复</a><a href="">顶</a><a href="">转发</a><a href="">举报</a></p>
<ul>
<li><img src="" alt="kmplayer"></li>
</ul>
<p>kmplayer</p>
<p>&quot;那么可以证明第二次比较a2也小于pivot的可能性是2/3！&quot;
”a3&lt;pivot的概率将会是3/4！“
这两个地方的”叹号“很容易误解为”阶层“</p>
<p>2010年12月16日<a href="">回复</a><a href="">顶</a><a href="">转发</a><a href="">举报</a></p>
<ul>
<li><img src="" alt="hit_alex"></li>
</ul>
<p>hit_alex</p>
<p>把这西抽象出来确实也挺有意思的。另外，我注意到标题：<strong>鸡排为什么又那么快呢？</strong>中“鸡排”是不是写错了？莫非是作者故意为之？</p>
<p>2010年12月26日<a href="">回复</a><a href="">顶</a><a href="">转发</a><a href="">举报</a></p>
<ul>
<li><a href="http://www.lisher.tk/" title="Miller" target="_blank"><img src="" alt="Miller"></a></li>
</ul>
<p><a href="http://www.lisher.tk/" target="_blank">Miller</a></p>
<p>4、4称了之后不管哪种情况（分支），剩下来的可能性总是》 8 《种吧</p>
<p>2011年2月14日<a href="">回复</a><a href="">顶</a><a href="">转发</a><a href="">举报</a></p>
<ul>
<li><img src="" alt="wosunziwuwan"></li>
</ul>
<p>wosunziwuwan</p>
<p>&quot;那么可以证明第二次比较a2也小于pivot的可能性是2/3&quot;这句话有问题吧，可能性应该还是1/2吧？因为只是a2和pivot相对次序的比较，和a1无关，是一次独立的比较。这和取排问题不同，确定了2张牌后，第3张牌只有从剩下的牌中去取</p>
<p>2011年11月27日<a href="">回复</a><a href="">顶(1)</a><a href="">转发</a><a href="">举报</a></p>
<ul>
<li><a href="http://yeasy.blogspot.com/" title="yeasy" target="_blank"><img src="" alt="yeasy"></a></li>
</ul>
<p><a href="http://yeasy.blogspot.com/" target="_blank">yeasy</a></p>
<p>更为本质一些，我觉得跟最大熵原理有些关系。
参考<a href="http://yeasy.blogspot.com/2011/11/blog-post.html" target="_blank"><a href="http://yeasy.blogspot.com/2011/11/blog-post.html">http://yeasy.blogspot.com/2011/11/blog-post.html</a></a></p>
<p>2011年12月15日<a href="">回复</a><a href="">顶</a><a href="">转发</a><a href="">举报</a></p>
<ul>
<li><img src="" alt="LittleJ"></li>
</ul>
<p>LittleJ</p>
<p>&quot;第一次比较结果是a1&lt;pivot，那么可以证明第二次比较a2也小于pivot的可能性是2/3！&quot;这里我也不是很明白。这里指的第一次第二次都是相对于快排的一次排序来说的吧？那么第一次将a1和pivot比较，大或者小的概率是相等的这里没有问题。为什么第二次比较a2要“也”小于pivot呢？我的意思就是第一次比较和第二次比较之间有什么关联？这里我没有看明白，能不能解释一下呢？谢谢：）</p>
<p>2012年3月19日<a href="">回复</a><a href="">顶(1)</a><a href="">转发</a><a href="">举报</a></p>
<ul>
<li><a href="http://www.douban.com/people/49902334/" title="透明的沙子" target="_blank"><img src="" alt="透明的沙子"></a></li>
</ul>
<p><a href="http://www.douban.com/people/49902334/" target="_blank">透明的沙子</a></p>
<p>看起来很多人不理解这个，反复想不明白，坐等解答啊</p>
<p>2012年9月3日<a href="">回复</a><a href="">顶</a><a href="">转发</a><a href="">举报</a></p>
<ul>
<li><a href="http://www.douban.com/people/49902334/" title="透明的沙子" target="_blank"><img src="" alt="透明的沙子"></a></li>
</ul>
<p><a href="http://www.douban.com/people/49902334/" target="_blank">透明的沙子</a></p>
<p>“然而，快排的第二次比较就不那么高明了：我们不妨令轴元素为pivot，第一次比较结果是a1pivot的话，那么a1，a2，pivot这三个元素之间的关系就完全确定了——a1</p>
<p>2012年9月3日<a href="">回复</a><a href="">顶</a><a href="">转发</a><a href="">举报</a></p>
<ul>
<li><a href="http://weibo.com/1742521405" title="滔要考研" target="_blank"><img src="" alt="滔要考研"></a></li>
</ul>
<p><a href="http://weibo.com/1742521405" target="_blank">滔要考研</a></p>
<p>关于快排的部分，其实本质是指轴元素如果选取的不够“中间”，会导致第一次排序后左右不均，从而导致较差的效率表现。刘大牛从缩减可能性这个角度出发，让人耳目一新。受教了。</p>
<p>2012年9月7日<a href="">回复</a><a href="">顶</a><a href="">转发</a><a href="">举报</a></p>
<ul>
<li><img src="" alt="simple"></li>
</ul>
<p>simple</p>
<p>鸡排之所以快，我觉得还可以用另一种说法（以13张牌的例子为例）：第i张牌确定位置后，放第i+1张牌时，桌上剩下的位置还有 13-i 个，即放牌的可能性为13-i种，然后，摸牌再看是什么点数就相当于公布答案，而这个答案刚好也是有 13-i 种，即，13-i种答案把13-i种可能性平均分为了13-i/13-i = 1种，最后得到鸡排需要的时间复杂度为O（1）</p>
<p>2012年9月22日<a href="">回复</a><a href="">顶</a><a href="">转发</a><a href="">举报</a></p>
<ul>
<li><img src="" alt="imgen"></li>
</ul>
<p>imgen</p>
<p>关于称球问题，我正是用了信息论的方法为指引，三分而称球，而且我也给出了推广到N的解法，从中获得了很多乐趣和满足。不过那是在大学时代了，久远了</p>
<p>2012年9月29日<a href="">回复</a><a href="">顶</a><a href="">转发</a><a href="">举报</a></p>
<ul>
<li><a href="http://weibo.com/2177249280" title="icrt_" target="_blank"><img src="" alt="icrt_"></a></li>
</ul>
<p><a href="http://weibo.com/2177249280" target="_blank">icrt_</a></p>
<p>真心佩服了。之前觉得称球问题没有什么，看这文章才知道原来有这么多的东西！</p>
<p>2012年10月10日<a href="">回复</a><a href="">顶</a><a href="">转发</a><a href="">举报</a></p>
<ul>
<li><a href="http://weibo.com/1238983263" title="_小毛童鞋_" target="_blank"><img src="" alt="_小毛童鞋_"></a></li>
</ul>
<p><a href="http://weibo.com/1238983263" target="_blank"><em>小毛童鞋</em></a></p>
<p>高爷爷是谁？</p>
<p>2012年10月16日<a href="">回复</a><a href="">顶</a><a href="">转发</a><a href="">举报</a></p>
<ul>
<li><a href="http://weibo.com/brightown" title="鸡翅呀鸡翅" target="_blank"><img src="" alt="鸡翅呀鸡翅"></a></li>
</ul>
<p><a href="http://weibo.com/brightown" target="_blank">鸡翅呀鸡翅</a></p>
<p>哇高爷爷果然是神人也，查了一下73年v3的第一版就有神论<figure class="highlight 膜拜orz~~~"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
</pre></td><td class="code"><pre>
<span class="number">2012</span>年<span class="number">11</span>月<span class="number">6</span>日[回复]()[顶]()[转发]()[举报]()
* [![ouqi]()](http://weibo.com/xianqings "ouqi")

[ouqi](http://weibo.com/xianqings)

同不明白这一块：
然而，快排的第二次比较就不那么高明了：我们不妨令轴元素为pivot，第一次比较结果是a1&lt;pivot，那么可以证明第二次比较a2也小于pivot的可能性是<span class="number">2</span>/<span class="number">3</span>！这容易证明：如果a2&gt;pivot的话，那么a1，a2，pivot这三个元素之间的关系就完全确定了——a1&lt;pivot&lt;a2，剩下来的元素排列的可能性我们不妨记为P（不需要具体算出来）。而如果a2&lt;pivot呢？那么a1和a2的关系就仍然是不确定的，也就是说，这个分支里面含有两种情况：a1&lt;a2&lt;pivot，以及a2&lt;a1&lt;pivot。对于其中任一种情况，剩下的元素排列的可能性都是P，于是这个分支里面剩下的排列可能性就是<span class="number">2</span>P。所以当a2&lt;pivot的时候，还剩下<span class="number">2</span>/<span class="number">3</span>的可能性需要排查。
我的疑惑在于，第一次的a2是什么，为什么要把第二次的排序和第一次的排序相关联?
不明白您定义的第二次排序是什么，我以为的第二次排序是对第一次的起始位置到第一次的pivot之间的数字的排序，那么第二次的privot又是重新选定的。也就是说在第一次排序之后，任何一个值跟第一次的privot的大小关系都是确定了的，要么比他大 要么比他小。那您说a2是什么？

<span class="number">4</span>月<span class="number">10</span>日[回复]()[顶]()[转发]()[举报]()
* [![ナイキ 通販]()](http://www.abcsnk.com/ "ナイキ 通販")

[ナイキ 通販](http://www.abcsnk.com/)

searching is another thing no doubt you like to accomplish (specially me), when i don't recognize how but searching is one particular activity which offers us eminence delight and relaxation whenever we are generally tired as well as frustrated as well as irritated, but while using ever raising targets along with office update they have became next to impossible <span class="flow">for</span> us to determine some time <span class="flow">for</span> it to hang out with his friends and enjoy that period while rooming around <span class="flow">for</span> the streets involving market.
But even as we always say there's [http://www.abcsnk.com/adidas-スパイクサッカー-アディピュア-<span class="number">11</span>pro-c-<span class="number">22</span>_23_29.html](http://www.abcsnk.com/adidas-スパイクサッカー-アディピュア-<span class="number">11</span>pro-c-<span class="number">22</span>_23_29.html) アディピュア<span class="number">11</span>pro a option <span class="flow">for</span> just about every problem along with situation on the [http:///www.sportrakuten.com](http:/www.sportrakuten.com) サングラス通販 globe, all you want to <span class="flow">do</span> is seek out that option with [http://www.sportrakuten.com/categories/<span class="number">1369471366</span>-<span class="number">179</span>.html](http://www.sportrakuten.com/categories/<span class="number">1369471366</span>-<span class="number">179</span>.html) レイバン サングラス 'something different' perspective. And which is the very reason we invented a many new method involving shopping which <span class="flow">in</span> turn know while online searching method. But staying this strategy new types of quarries that happen to be there inside mind of folks related on the same and were here to unravel those themselves.
But today you'll find thousands involving products that is purchased via an web shop starting coming from a bugger to your flat <span class="flow">in</span> fact it is impossible <span class="flow">for</span> individuals to cover hundreds of <span class="flow">in</span> one particular discussion themselves therefore today we'll be only talking over facts pertains to [http://www.abcsnk.com](http://www.abcsnk.com/) ナイキ 通販 online searching of sneakers <span class="flow">for</span> adult men.
Buying some your favourite Adidas [http://www.abcsnk.com/adidas-スパイクサッカー-プレデター-アディダス-<span class="number">11</span>-c-<span class="number">22</span>_23_25.html](http://www.abcsnk.com/adidas-スパイクサッカー-プレデター-アディダス-<span class="number">11</span>-c-<span class="number">22</span>_23_25.html) adidas プレデター sneakers from these websites is just about the easiest thing on the [http:///www.sportrakuten.com/categories/<span class="number">1369471516</span>-<span class="number">183</span>.html](http:/www.sportrakuten.com/categories/<span class="number">1369471516</span>-<span class="number">183</span>.html) レイバン(RAY BAN) globe, but to generate it truly easy you've got to keep up few <span class="flow">in</span> the things as well as points that happen to be listed down below.

<span class="number">6</span>月<span class="number">19</span>日[回复]()[顶]()[转发]()[举报]()
[<span class="number">1</span>]()[]()

社交帐号登录:
* [微博](http://pongba.duoshuo.com/login/weibo/?sso=<span class="number">1</span>&redirect_uri=http<span class="envvar">%3A%</span><span class="number">2</span>F<span class="envvar">%2Fmindhacks.cn%</span><span class="number">2</span>Fwp-login.php<span class="envvar">%3Faction%</span><span class="number">3</span>Dduoshuo_login&redirect_to<span class="envvar">%3Dhttp%</span><span class="number">3</span>A<span class="envvar">%2F%</span><span class="number">2</span>Fmindhacks.cn<span class="envvar">%2F2008%</span><span class="number">2</span>F06<span class="envvar">%2F13%</span><span class="number">2</span>Fwhy-is-quicksort-so-quick%<span class="number">2</span>F)
* [QQ](http://pongba.duoshuo.com/login/qq/?sso=<span class="number">1</span>&redirect_uri=http<span class="envvar">%3A%</span><span class="number">2</span>F<span class="envvar">%2Fmindhacks.cn%</span><span class="number">2</span>Fwp-login.php<span class="envvar">%3Faction%</span><span class="number">3</span>Dduoshuo_login&redirect_to<span class="envvar">%3Dhttp%</span><span class="number">3</span>A<span class="envvar">%2F%</span><span class="number">2</span>Fmindhacks.cn<span class="envvar">%2F2008%</span><span class="number">2</span>F06<span class="envvar">%2F13%</span><span class="number">2</span>Fwhy-is-quicksort-so-quick%<span class="number">2</span>F)
* [人人](http://pongba.duoshuo.com/login/renren/?sso=<span class="number">1</span>&redirect_uri=http<span class="envvar">%3A%</span><span class="number">2</span>F<span class="envvar">%2Fmindhacks.cn%</span><span class="number">2</span>Fwp-login.php<span class="envvar">%3Faction%</span><span class="number">3</span>Dduoshuo_login&redirect_to<span class="envvar">%3Dhttp%</span><span class="number">3</span>A<span class="envvar">%2F%</span><span class="number">2</span>Fmindhacks.cn<span class="envvar">%2F2008%</span><span class="number">2</span>F06<span class="envvar">%2F13%</span><span class="number">2</span>Fwhy-is-quicksort-so-quick%<span class="number">2</span>F)
* [豆瓣](http://pongba.duoshuo.com/login/douban/?sso=<span class="number">1</span>&redirect_uri=http<span class="envvar">%3A%</span><span class="number">2</span>F<span class="envvar">%2Fmindhacks.cn%</span><span class="number">2</span>Fwp-login.php<span class="envvar">%3Faction%</span><span class="number">3</span>Dduoshuo_login&redirect_to<span class="envvar">%3Dhttp%</span><span class="number">3</span>A<span class="envvar">%2F%</span><span class="number">2</span>Fmindhacks.cn<span class="envvar">%2F2008%</span><span class="number">2</span>F06<span class="envvar">%2F13%</span><span class="number">2</span>Fwhy-is-quicksort-so-quick%<span class="number">2</span>F)
* [更多»]()

* [开心](http://pongba.duoshuo.com/login/kaixin/?sso=<span class="number">1</span>&redirect_uri=http<span class="envvar">%3A%</span><span class="number">2</span>F<span class="envvar">%2Fmindhacks.cn%</span><span class="number">2</span>Fwp-login.php<span class="envvar">%3Faction%</span><span class="number">3</span>Dduoshuo_login&redirect_to<span class="envvar">%3Dhttp%</span><span class="number">3</span>A<span class="envvar">%2F%</span><span class="number">2</span>Fmindhacks.cn<span class="envvar">%2F2008%</span><span class="number">2</span>F06<span class="envvar">%2F13%</span><span class="number">2</span>Fwhy-is-quicksort-so-quick%<span class="number">2</span>F)
* [网易](http://pongba.duoshuo.com/login/netease/?sso=<span class="number">1</span>&redirect_uri=http<span class="envvar">%3A%</span><span class="number">2</span>F<span class="envvar">%2Fmindhacks.cn%</span><span class="number">2</span>Fwp-login.php<span class="envvar">%3Faction%</span><span class="number">3</span>Dduoshuo_login&redirect_to<span class="envvar">%3Dhttp%</span><span class="number">3</span>A<span class="envvar">%2F%</span><span class="number">2</span>Fmindhacks.cn<span class="envvar">%2F2008%</span><span class="number">2</span>F06<span class="envvar">%2F13%</span><span class="number">2</span>Fwhy-is-quicksort-so-quick%<span class="number">2</span>F)
* [搜狐](http://pongba.duoshuo.com/login/sohu/?sso=<span class="number">1</span>&redirect_uri=http<span class="envvar">%3A%</span><span class="number">2</span>F<span class="envvar">%2Fmindhacks.cn%</span><span class="number">2</span>Fwp-login.php<span class="envvar">%3Faction%</span><span class="number">3</span>Dduoshuo_login&redirect_to<span class="envvar">%3Dhttp%</span><span class="number">3</span>A<span class="envvar">%2F%</span><span class="number">2</span>Fmindhacks.cn<span class="envvar">%2F2008%</span><span class="number">2</span>F06<span class="envvar">%2F13%</span><span class="number">2</span>Fwhy-is-quicksort-so-quick%<span class="number">2</span>F)
* [百度](http://pongba.duoshuo.com/login/baidu/?sso=<span class="number">1</span>&redirect_uri=http<span class="envvar">%3A%</span><span class="number">2</span>F<span class="envvar">%2Fmindhacks.cn%</span><span class="number">2</span>Fwp-login.php<span class="envvar">%3Faction%</span><span class="number">3</span>Dduoshuo_login&redirect_to<span class="envvar">%3Dhttp%</span><span class="number">3</span>A<span class="envvar">%2F%</span><span class="number">2</span>Fmindhacks.cn<span class="envvar">%2F2008%</span><span class="number">2</span>F06<span class="envvar">%2F13%</span><span class="number">2</span>Fwhy-is-quicksort-so-quick%<span class="number">2</span>F)
* [谷歌](http://pongba.duoshuo.com/login/google/?sso=<span class="number">1</span>&redirect_uri=http<span class="envvar">%3A%</span><span class="number">2</span>F<span class="envvar">%2Fmindhacks.cn%</span><span class="number">2</span>Fwp-login.php<span class="envvar">%3Faction%</span><span class="number">3</span>Dduoshuo_login&redirect_to<span class="envvar">%3Dhttp%</span><span class="number">3</span>A<span class="envvar">%2F%</span><span class="number">2</span>Fmindhacks.cn<span class="envvar">%2F2008%</span><span class="number">2</span>F06<span class="envvar">%2F13%</span><span class="number">2</span>Fwhy-is-quicksort-so-quick%<span class="number">2</span>F)
[![]()]()

发布

[]( "插入表情")

[刘未鹏 | Mind Hacks正在使用多说](http://duoshuo.com/)
<span class="number">1</span>. chaonin on [February <span class="number">17</span>, <span class="number">2009</span> at <span class="number">10</span>:<span class="number">34</span> am](http://mindhacks.cn/<span class="number">2008</span>/<span class="number">06</span>/<span class="number">13</span>/why-is-quicksort-so-quick/comment-page-<span class="number">1</span>/#comment-<span class="number">93</span>) said:

@@之前就在你的卢浮宫看到了，写的直白明了！

小弟学的是编码，呵呵。
Mackay的那本书重点是介绍编码的，具体的说是纠错码的。编码理论的重要基础是信息论。
他对这些问题的分析不是专门要来分析这写问题的，而只是用信息论的方法来解释这些现象。
<span class="number">1</span>. [帅得不敢出门](http://stupidpig.cublog.cn/) on [March <span class="number">23</span>, <span class="number">2009</span> at <span class="number">8</span>:<span class="number">46</span> pm](http://mindhacks.cn/<span class="number">2008</span>/<span class="number">06</span>/<span class="number">13</span>/why-is-quicksort-so-quick/comment-page-<span class="number">1</span>/#comment-<span class="number">292</span>) said:

受益良多
每每看到一些精妙的解法(算法),都想拍手称快.
<span class="number">1</span>. [conan](http://www.cloved.cn/) on [May <span class="number">11</span>, <span class="number">2009</span> at <span class="number">9</span>:<span class="number">43</span> am](http://mindhacks.cn/<span class="number">2008</span>/<span class="number">06</span>/<span class="number">13</span>/why-is-quicksort-so-quick/comment-page-<span class="number">1</span>/#comment-<span class="number">407</span>) said:

关注toplanguage很久了.只是一直不敢在上面留言,看上面的聊天就感觉自己是沧海一粟.今天看到一篇.可能你是幸运的吧.我大概算了下,你应该是和我同届的.不过我比你小一岁.马上就毕业两年了.研究生们也快毕业了….回忆这些日子,感觉偏离了自己的目标,也感觉工作后并没有自己希望的成长着.一直觉得学校的东西很迂腐,什么都需要自己去学习.曾经也深深相信自己能好好成长起来.只是,到了今天,不知道自己是否还跟着大家的脚步….
<span class="number">1</span>. metal-fan on [October <span class="number">15</span>, <span class="number">2009</span> at <span class="number">9</span>:<span class="number">13</span> pm](http://mindhacks.cn/<span class="number">2008</span>/<span class="number">06</span>/<span class="number">13</span>/why-is-quicksort-so-quick/comment-page-<span class="number">1</span>/#comment-<span class="number">616</span>) said:

写的太棒了～深入本质～受益匪浅！！！
<span class="number">1</span>. raymond on [December <span class="number">25</span>, <span class="number">2009</span> at <span class="number">10</span>:<span class="number">38</span> pm](http://mindhacks.cn/<span class="number">2008</span>/<span class="number">06</span>/<span class="number">13</span>/why-is-quicksort-so-quick/comment-page-<span class="number">1</span>/#comment-<span class="number">709</span>) said:

这是最大熵原则的几个例子，即保留最大的不确定性，因为这样才能保留最大的信息。生活中很多问题都可以归结为一些简单的法则，而在实际处理问题的时候，这些简单的法则会被以各种各样的形式掩盖，从而让我们失去探索的机会。博主是个有心人啊
<span class="number">1</span>. bigining on [April <span class="number">24</span>, <span class="number">2010</span> at <span class="number">6</span>:<span class="number">10</span> pm](http://mindhacks.cn/<span class="number">2008</span>/<span class="number">06</span>/<span class="number">13</span>/why-is-quicksort-so-quick/comment-page-<span class="number">1</span>/#comment-<span class="number">888</span>) said:

在说到<span class="number">12</span>个的例子时，第二次称时：“这是一个完美的三分。然后对每个分支构造第二次称法，这里你只要稍加演算就可以发现，分支<span class="number">1</span>上的第二次称法，即“<span class="number">1</span>、<span class="number">2</span>、<span class="number">6</span>对<span class="number">3</span>、<span class="number">4</span>、<span class="number">5</span>”这种称法，天平输出三种结果的可能性是均等的（严格来说是几乎均等）。”，但是这样好像是找不出那个不同的球的。不知道<span class="number">1</span>、<span class="number">2</span>、<span class="number">6</span>对<span class="number">3</span>、<span class="number">4</span>、<span class="number">5</span>之后要怎么进行判断？（可以假设<span class="number">1</span>、<span class="number">2</span>、<span class="number">6</span>比<span class="number">3</span>、<span class="number">4</span>、<span class="number">5</span>重，然后只能说明<span class="number">1</span>、 <span class="number">2</span>较重或<span class="number">5</span>较轻，然后第三次要怎么进行？）

* Ted on [November <span class="number">28</span>, <span class="number">2011</span> at <span class="number">3</span>:<span class="number">30</span> am](http://mindhacks.cn/<span class="number">2008</span>/<span class="number">06</span>/<span class="number">13</span>/why-is-quicksort-so-quick/comment-page-<span class="number">1</span>/#comment-<span class="number">18264</span>) said:

晕，你都说了“然后只能说明<span class="number">1</span>、 <span class="number">2</span>较重或<span class="number">5</span>较轻”，这还不明显，再把<span class="number">1</span>，<span class="number">2</span>分别放<span class="number">2</span>边，哪个重，哪个就是，否则就是平衡，那<span class="number">5</span>就是目标。
* rrison on [May <span class="number">6</span>, <span class="number">2010</span> at <span class="number">11</span>:<span class="number">26</span> am](http://mindhacks.cn/<span class="number">2008</span>/<span class="number">06</span>/<span class="number">13</span>/why-is-quicksort-so-quick/comment-page-<span class="number">1</span>/#comment-<span class="number">904</span>) said:

离散数学里的博弈树
* [dell latitude d620 laptop battery](http://www.usbphoneworld.com/lbded6620.html) on [June <span class="number">13</span>, <span class="number">2010</span> at <span class="number">10</span>:<span class="number">56</span> am](http://mindhacks.cn/<span class="number">2008</span>/<span class="number">06</span>/<span class="number">13</span>/why-is-quicksort-so-quick/comment-page-<span class="number">1</span>/#comment-<span class="number">934</span>) said:

非常感谢。受益良多。
* 
Pingback: [数学之美番外篇：快排为什么那样快 | 天道酬勤](http://www.iskycloud.com/blog/algorithm/<span class="number">52</span>.html)
* kmplayer on [December <span class="number">16</span>, <span class="number">2010</span> at <span class="number">3</span>:<span class="number">25</span> pm](http://mindhacks.cn/<span class="number">2008</span>/<span class="number">06</span>/<span class="number">13</span>/why-is-quicksort-so-quick/comment-page-<span class="number">1</span>/#comment-<span class="number">11214</span>) said:

“那么可以证明第二次比较a2也小于pivot的可能性是<span class="number">2</span>/<span class="number">3</span>！”
”a3&lt;pivot的概率将会是<span class="number">3</span>/<span class="number">4</span>！“
这两个地方的”叹号“很容易误解为”阶层“
* hit_alex on [December <span class="number">26</span>, <span class="number">2010</span> at <span class="number">5</span>:<span class="number">15</span> pm](http://mindhacks.cn/<span class="number">2008</span>/<span class="number">06</span>/<span class="number">13</span>/why-is-quicksort-so-quick/comment-page-<span class="number">1</span>/#comment-<span class="number">11319</span>) said:

把这西抽象出来确实也挺有意思的。另外，我注意到标题：**鸡排为什么又那么快呢？**中“鸡排”是不是写错了？莫非是作者故意为之？
* [Miller](http://www.lisher.tk/) on [February <span class="number">14</span>, <span class="number">2011</span> at <span class="number">10</span>:<span class="number">23</span> pm](http://mindhacks.cn/<span class="number">2008</span>/<span class="number">06</span>/<span class="number">13</span>/why-is-quicksort-so-quick/comment-page-<span class="number">1</span>/#comment-<span class="number">12358</span>) said:

<span class="number">4</span>、<span class="number">4</span>称了之后不管哪种情况（分支），剩下来的可能性总是》 <span class="number">8</span> 《种吧
* 
Pingback: [知其所以然（续） - 东莞律师网](http://www.lawyer888.com/?p=<span class="number">122</span>)
* 
Pingback: [知其所以然（续） | w3er](http://w3er.com/<span class="envvar">%e6%</span><span class="number">9</span>c<span class="envvar">%aa%</span>e5<span class="envvar">%88%</span><span class="number">86</span><span class="envvar">%e7%</span>b1<span class="envvar">%bb/%</span>e7<span class="envvar">%9f%</span>a5<span class="envvar">%e5%</span><span class="number">85</span><span class="envvar">%b6%</span>e6<span class="envvar">%89%</span><span class="number">80</span><span class="envvar">%e4%</span>bb<span class="envvar">%a5%</span>e7<span class="envvar">%84%</span>b6<span class="envvar">%ef%</span>bc<span class="envvar">%88%</span>e7<span class="envvar">%bb%</span>ad<span class="envvar">%ef%</span>bc%<span class="number">89</span>/)
* 
Pingback: [知其所以然（三）——为什么算法这么难？](http://mindhacks.cn/<span class="number">2011</span>/<span class="number">07</span>/<span class="number">10</span>/the-importance-of-knowing-why-part3/)
* 
Pingback: [推荐读书《暗时间》](http://www.whoisnerd.com/<span class="number">2011</span>/<span class="number">07</span>/<span class="number">31</span>/<span class="envvar">%e6%</span><span class="number">8</span>e<span class="envvar">%a8%</span>e8<span class="envvar">%8d%</span><span class="number">90</span><span class="envvar">%e8%</span>af<span class="envvar">%bb%</span>e4<span class="envvar">%b9%</span>a6<span class="envvar">%e3%</span><span class="number">80</span><span class="envvar">%8a%</span>e6<span class="envvar">%9a%</span><span class="number">97</span><span class="envvar">%e6%</span><span class="number">97</span><span class="envvar">%b6%</span>e9<span class="envvar">%97%</span>b4<span class="envvar">%e3%</span><span class="number">80</span>%<span class="number">8</span>b/)
* 
Pingback: [转：为什么算法这么难？ | South♂楠个人博客](http://southmagic.sinaapp.com/?p=<span class="number">18</span>)
* 
Pingback: [知其所以然（续） | 风的天地](http://blog69.tk/?p=<span class="number">540</span>)
* 
Pingback: [知其所以然（三）：为什么算法这么难？ | 风的天地](http://blog69.tk/?p=<span class="number">114</span>)
* wosunziwuwan on [November <span class="number">27</span>, <span class="number">2011</span> at <span class="number">9</span>:<span class="number">55</span> pm](http://mindhacks.cn/<span class="number">2008</span>/<span class="number">06</span>/<span class="number">13</span>/why-is-quicksort-so-quick/comment-page-<span class="number">1</span>/#comment-<span class="number">18259</span>) said:

“那么可以证明第二次比较a2也小于pivot的可能性是<span class="number">2</span>/<span class="number">3</span>″这句话有问题吧，可能性应该还是<span class="number">1</span>/<span class="number">2</span>吧？因为只是a2和pivot相对次序的比较，和a1无关，是一次独立的比较。这和取排问题不同，确定了<span class="number">2</span>张牌后，第<span class="number">3</span>张牌只有从剩下的牌中去取
* [yeasy](http://yeasy.blogspot.com/) on [December <span class="number">15</span>, <span class="number">2011</span> at <span class="number">4</span>:<span class="number">23</span> pm](http://mindhacks.cn/<span class="number">2008</span>/<span class="number">06</span>/<span class="number">13</span>/why-is-quicksort-so-quick/comment-page-<span class="number">1</span>/#comment-<span class="number">18653</span>) said:

更为本质一些，我觉得跟最大熵原理有些关系。
参考http://yeasy.blogspot.com/<span class="number">2011</span>/<span class="number">11</span>/blog-post.html
* 
Pingback: [罗青-技术博客 | [re]趣谈二分法](http://tsingroo.sinaapp.com/?p=<span class="number">302</span>)
* 
Pingback: [趣题：天平找假币 - Aikilis' Blog](http://aikilis.tk/<span class="number">1398</span>)
* 
Pingback: [快排_quicksort() - C++](http://cblog.lylzone.info/<span class="number">2012</span>/<span class="number">03</span>/<span class="number">6</span>/quicksort.html)
* LittleJ on [March <span class="number">19</span>, <span class="number">2012</span> at <span class="number">6</span>:<span class="number">12</span> pm](http://mindhacks.cn/<span class="number">2008</span>/<span class="number">06</span>/<span class="number">13</span>/why-is-quicksort-so-quick/comment-page-<span class="number">1</span>/#comment-<span class="number">20448</span>) said:

“第一次比较结果是a1&lt;pivot，那么可以证明第二次比较a2也小于pivot的可能性是<span class="number">2</span>/<span class="number">3</span>！"这里我也不是很明白。这里指的第一次第二次都是相对于快排的一次排序来说的吧？那么第一次将a1和pivot比较，大或者小的概率是相等的这里没有问题。为什么第二次比较a2要“也”小于pivot呢？我的意思就是第一次比较和第二次比较之间有什么关联？这里我没有看明白，能不能解释一下呢？谢谢：）
* 
Pingback: [知其所以然（三）：为什么算法这么难？ | 吃杂烩](http://blog.chiapp.com/html/<span class="number">2012</span>-<span class="number">08</span>-<span class="number">09</span>/<span class="number">4159</span>.html)
* 
Pingback: [所有排序总结（内排序）（续）——基于比较排序下界 | 编程·早晨](http://code.zc4u.com/articles/<span class="number">5362</span>.html)
* 
Pingback: [孙吾饭的游乐场 | 暗时间](http://patdelphi.com/wordpress/?p=<span class="number">508</span>)
* [透明的沙子](http://www.douban.com/people/<span class="number">49902334</span>/) on [September <span class="number">3</span>, <span class="number">2012</span> at <span class="number">8</span>:<span class="number">51</span> pm](http://mindhacks.cn/<span class="number">2008</span>/<span class="number">06</span>/<span class="number">13</span>/why-is-quicksort-so-quick/comment-page-<span class="number">1</span>/#comment-<span class="number">31818</span>) said:

“然而，快排的第二次比较就不那么高明了：我们不妨令轴元素为pivot，第一次比较结果是a1pivot的话，那么a1，a2，pivot这三个元素之间的关系就完全确定了——a1
* [透明的沙子](http://www.douban.com/people/<span class="number">49902334</span>/) on [September <span class="number">3</span>, <span class="number">2012</span> at <span class="number">8</span>:<span class="number">53</span> pm](http://mindhacks.cn/<span class="number">2008</span>/<span class="number">06</span>/<span class="number">13</span>/why-is-quicksort-so-quick/comment-page-<span class="number">1</span>/#comment-<span class="number">31819</span>) said:

看起来很多人不理解这个，反复想不明白，坐等解答啊
* [滔要考研](http://weibo.com/<span class="number">1742521405</span>) on [September <span class="number">7</span>, <span class="number">2012</span> at <span class="number">1</span>:<span class="number">06</span> am](http://mindhacks.cn/<span class="number">2008</span>/<span class="number">06</span>/<span class="number">13</span>/why-is-quicksort-so-quick/comment-page-<span class="number">1</span>/#comment-<span class="number">31827</span>) said:

关于快排的部分，其实本质是指轴元素如果选取的不够“中间”，会导致第一次排序后左右不均，从而导致较差的效率表现。刘大牛从缩减可能性这个角度出发，让人耳目一新。受教了。
* simple on [September <span class="number">21</span>, <span class="number">2012</span> at <span class="number">11</span>:<span class="number">34</span> pm](http://mindhacks.cn/<span class="number">2008</span>/<span class="number">06</span>/<span class="number">13</span>/why-is-quicksort-so-quick/comment-page-<span class="number">1</span>/#comment-<span class="number">31875</span>) said:

以<span class="number">6</span>个球的例子来说，这个策略的“答案”是随着剩下的可能性（或者说剩下的球）的数量而发生变化的，比如，当球剩下<span class="number">2</span>个时，那么天平的输出结果只可能有两种：左或右倾。因此，这时候应该是以以<span class="number">2</span>去平分剩下的可能性。
* simple on [September <span class="number">22</span>, <span class="number">2012</span> at <span class="number">1</span>:<span class="number">35</span> am](http://mindhacks.cn/<span class="number">2008</span>/<span class="number">06</span>/<span class="number">13</span>/why-is-quicksort-so-quick/comment-page-<span class="number">1</span>/#comment-<span class="number">31876</span>) said:

鸡排之所以快，我觉得还可以用另一种说法（以<span class="number">13</span>张牌的例子为例）：第i张牌确定位置后，放第i+<span class="number">1</span>张牌时，桌上剩下的位置还有 <span class="number">13</span>-i 个，即放牌的可能性为<span class="number">13</span>-i种，然后，摸牌再看是什么点数就相当于公布答案，而这个答案刚好也是有 <span class="number">13</span>-i 种，即，<span class="number">13</span>-i种答案把<span class="number">13</span>-i种可能性平均分为了<span class="number">13</span>-i/<span class="number">13</span>-i = <span class="number">1</span>种，最后得到鸡排需要的时间复杂度为O（<span class="number">1</span>）
* imgen on [September <span class="number">29</span>, <span class="number">2012</span> at <span class="number">5</span>:<span class="number">45</span> pm](http://mindhacks.cn/<span class="number">2008</span>/<span class="number">06</span>/<span class="number">13</span>/why-is-quicksort-so-quick/comment-page-<span class="number">1</span>/#comment-<span class="number">31903</span>) said:

关于称球问题，我正是用了信息论的方法为指引，三分而称球，而且我也给出了推广到N的解法，从中获得了很多乐趣和满足。不过那是在大学时代了，久远了
* [icrt_](http://weibo.com/<span class="number">2177249280</span>) on [October <span class="number">10</span>, <span class="number">2012</span> at <span class="number">9</span>:<span class="number">03</span> pm](http://mindhacks.cn/<span class="number">2008</span>/<span class="number">06</span>/<span class="number">13</span>/why-is-quicksort-so-quick/comment-page-<span class="number">1</span>/#comment-<span class="number">31922</span>) said:

真心佩服了。之前觉得称球问题没有什么，看这文章才知道原来有这么多的东西！
* [_小毛童鞋_](http://weibo.com/<span class="number">1238983263</span>) on [October <span class="number">16</span>, <span class="number">2012</span> at <span class="number">6</span>:<span class="number">25</span> pm](http://mindhacks.cn/<span class="number">2008</span>/<span class="number">06</span>/<span class="number">13</span>/why-is-quicksort-so-quick/comment-page-<span class="number">1</span>/#comment-<span class="number">31942</span>) said:

高爷爷是谁？
* [鸡翅呀鸡翅](http://weibo.com/brightown) on [November <span class="number">6</span>, <span class="number">2012</span> at <span class="number">3</span>:<span class="number">21</span> pm](http://mindhacks.cn/<span class="number">2008</span>/<span class="number">06</span>/<span class="number">13</span>/why-is-quicksort-so-quick/comment-page-<span class="number">1</span>/#comment-<span class="number">32004</span>) said:

哇高爷爷果然是神人也，查了一下<span class="number">73</span>年v3的第一版就有神论~~~膜拜orz
</pre></td></tr></table></figure></p>
<ul>
<li><a href="http://weibo.com/xianqings" target="_blank">ouqi</a> on <a href="http://mindhacks.cn/2008/06/13/why-is-quicksort-so-quick/comment-page-1/#comment-32350" target="_blank">April 10, 2013 at 9:46 pm</a> said:</li>
</ul>
<p>同不明白这一块：
然而，快排的第二次比较就不那么高明了：我们不妨令轴元素为pivot，第一次比较结果是a1<pivot，那么可以证明第二次比较a2也小于pivot的可能性是2/3！这容易证明：如果a2>pivot的话，那么a1，a2，pivot这三个元素之间的关系就完全确定了——a1&lt;pivot&lt;a2，剩下来的元素排列的可能性我们不妨记为P（不需要具体算出来）。而如果a2&lt;pivot呢？那么a1和a2的关系就仍然是不确定的，也就是说，这个分支里面含有两种情况：a1&lt;a2&lt;pivot，以及a2&lt;a1&lt;pivot。对于其中任一种情况，剩下的元素排列的可能性都是P，于是这个分支里面剩下的排列可能性就是2P。所以当a2&lt;pivot的时候，还剩下2/3的可能性需要排查。</p>
<p>我的疑惑在于，第一次的a2是什么，为什么要把第二次的排序和第一次的排序相关联?
不明白您定义的第二次排序是什么，我以为的第二次排序是对第一次的起始位置到第一次的pivot之间的数字的排序，那么第二次的privot又是重新选定的。也就是说在第一次排序之后，任何一个值跟第一次的privot的大小关系都是确定了的，要么比他大 要么比他小。那您说a2是什么？</p>
<ul>
<li><a href="http://www.abcsnk.com/" target="_blank">ナイキ 通販</a> on <a href="http://mindhacks.cn/2008/06/13/why-is-quicksort-so-quick/comment-page-1/#comment-32490" target="_blank">June 19, 2013 at 10:11 am</a> said:</li>
</ul>
<p>searching is another thing no doubt you like to accomplish (specially me), when i don’t recognize how but searching is one particular activity which offers us eminence delight and relaxation whenever we are generally tired as well as frustrated as well as irritated, but while using ever raising targets along with office update they have became next to impossible for us to determine some time for it to hang out with his friends and enjoy that period while rooming around for the streets involving market.</p>
<p>But even as we always say there’s <a href="http://www.abcsnk.com/adidas-スパイクサッカー-アディピュア-11pro-c-22_23_29.html" target="_blank"><a href="http://www.abcsnk.com/adidas-スパイクサッカー-アディピュア-11pro-c-22_23_29.html">http://www.abcsnk.com/adidas-スパイクサッカー-アディピュア-11pro-c-22_23_29.html</a></a> アディピュア11pro a option for just about every problem along with situation on the <a href="http:/www.sportrakuten.com"><a href="http:///www.sportrakuten.com">http:///www.sportrakuten.com</a></a> サングラス通販 globe, all you want to do is seek out that option with <a href="http://www.sportrakuten.com/categories/1369471366-179.html" target="_blank"><a href="http://www.sportrakuten.com/categories/1369471366-179.html">http://www.sportrakuten.com/categories/1369471366-179.html</a></a> レイバン サングラス ‘something different’ perspective. And which is the very reason we invented a many new method involving shopping which in turn know while online searching method. But staying this strategy new types of quarries that happen to be there inside mind of folks related on the same and were here to unravel those themselves.</p>
<p>But today you’ll find thousands involving products that is purchased via an web shop starting coming from a bugger to your flat in fact it is impossible for individuals to cover hundreds of in one particular discussion themselves therefore today we’ll be only talking over facts pertains to <a href="http://www.abcsnk.com/" target="_blank"><a href="http://www.abcsnk.com">http://www.abcsnk.com</a></a> ナイキ 通販 online searching of sneakers for adult men.</p>
<p>Buying some your favourite Adidas <a href="http://www.abcsnk.com/adidas-スパイクサッカー-プレデター-アディダス-11-c-22_23_25.html" target="_blank"><a href="http://www.abcsnk.com/adidas-スパイクサッカー-プレデター-アディダス-11-c-22_23_25.html">http://www.abcsnk.com/adidas-スパイクサッカー-プレデター-アディダス-11-c-22_23_25.html</a></a> adidas プレデター sneakers from these websites is just about the easiest thing on the <a href="http:/www.sportrakuten.com/categories/1369471516-183.html"><a href="http:///www.sportrakuten.com/categories/1369471516-183.html">http:///www.sportrakuten.com/categories/1369471516-183.html</a></a> レイバン(RAY BAN) globe, but to generate it truly easy you’ve got to keep up few in the things as well as points that happen to be listed down below.</p>
<ul>
<li>wang on <a href="http://mindhacks.cn/2008/06/13/why-is-quicksort-so-quick/comment-page-1/#comment-32571" target="_blank">July 5, 2013 at 10:12 am</a> said:</li>
</ul>
<p><a href="http://www.allsnk.com/nddbc.html" target="_blank"><a href="http://www.allsnk.com/nddbc.html">http://www.allsnk.com/nddbc.html</a></a>
<a href="http://www.allsnk.com/nddbc.html" target="_blank"><a href="http://www.allsnk.com/nddbc.html">http://www.allsnk.com/nddbc.html</a></a>
<a href="http://www.allsnk.com/nddbc.html" target="_blank"><a href="http://www.allsnk.com/nddbc.html">http://www.allsnk.com/nddbc.html</a></a></p>
<ul>
<li><h3 id="-">关于</h3>
</li>
</ul>
<p>如果你对我的文章感兴趣，那么<strong>很可能你也对我平时的阅读感兴趣</strong>，以下是一些你可以参考或订阅的资源：</p>
<ol>
<li><p><a href="http://www.douban.com/people/pongba/" target="_blank">我在豆瓣</a>上的豆列列举了一些看过的好书：<a href="http://www.douban.com/doulist/46003/" target="_blank">[只读经典]思维改变生活</a> | <a href="http://www.douban.com/doulist/127649/" target="_blank">[只读经典]思考的技术与艺术</a> | <a href="http://www.douban.com/doulist/197706/" target="_blank">决策与判断</a> | <a href="http://www.douban.com/doulist/176513/" target="_blank">机器学习与人工智能书籍资源导引</a>
我翻译的书：</p>
</li>
<li><p><a href="http://book.douban.com/subject/1470838/" target="_blank">《Imperfect C++ 中文版》</a></p>
</li>
<li><a href="http://book.douban.com/subject/1470842/" target="_blank">《Exceptional C++ Style 中文版》</a></li>
<li><p><a href="http://book.douban.com/subject/2248759/" target="_blank">《修改代码的艺术》</a>
我写的书：</p>
</li>
<li><p><a href="http://book.douban.com/subject/6709809/" target="_blank"><img src="" alt=""></a></p>
</li>
<li><h3 id="-">被阅读得最多的</h3>
</li>
</ol>
<ul>
<li><a href="http://mindhacks.cn/2009/02/15/why-you-should-start-blogging-now/" title="[BetterExplained]为什么你应该（从现在开始就）写博客" target="_blank">[BetterExplained]为什么你应该（从现在开始就）写博客</a> - 210,263 views</li>
<li><a href="http://mindhacks.cn/2011/11/04/how-to-interview-a-person-for-two-years/" title="怎样花两年时间去面试一个人" target="_blank">怎样花两年时间去面试一个人</a> - 207,509 views</li>
<li><a href="http://mindhacks.cn/2009/03/15/preconception-explained/" title="逃出你的肖申克（二）：仁者见仁智者见智？从视觉错觉到偏见" target="_blank">逃出你的肖申克（二）：仁者见仁智者见智？从视觉错觉到偏见</a> - 194,733 views</li>
<li><a href="http://mindhacks.cn/2009/12/20/dark-time/" title="暗时间" target="_blank">暗时间</a> - 193,494 views</li>
<li><a href="http://mindhacks.cn/2009/05/17/seven-years-in-nju/" title="我在南大的七年" target="_blank">我在南大的七年</a> - 176,349 views</li>
<li><a href="http://mindhacks.cn/2009/03/28/effective-learning-and-memorization/" title="[BetterExplained]如何有效地记忆与学习" target="_blank">[BetterExplained]如何有效地记忆与学习</a> - 169,039 views</li>
<li><a href="http://mindhacks.cn/2008/09/21/the-magical-bayesian-method/" title="数学之美番外篇：平凡而又神奇的贝叶斯方法" target="_blank">数学之美番外篇：平凡而又神奇的贝叶斯方法</a> - 166,636 views</li>
<li><a href="http://mindhacks.cn/2009/01/18/escape-from-your-shawshank-part1/" title="逃出你的肖申克（一）：为什么一定要亲身经历了之后才能明白？" target="_blank">逃出你的肖申克（一）：为什么一定要亲身经历了之后才能明白？</a> - 139,011 views</li>
<li><a href="http://mindhacks.cn/2010/03/18/escape-from-your-shawshank-part3/" title="逃出你的肖申克（三）：遇见20万年前的自己" target="_blank">逃出你的肖申克（三）：遇见20万年前的自己</a> - 135,486 views</li>
<li><a href="http://mindhacks.cn/2009/02/09/writing-is-better-thinking/" title="[BetterExplained]书写是为了更好的思考" target="_blank">[BetterExplained]书写是为了更好的思考</a> - 118,613 views</li>
<li><h3 id="-">我的微博</h3>
</li>
<li><h3 id="-">你可能也会喜欢以下文章</h3>
</li>
<li><p><a href="http://mindhacks.cn/2008/09/21/the-magical-bayesian-method/" title="数学之美番外篇：平凡而又神奇的贝叶斯方法" target="_blank">数学之美番外篇：平凡而又神奇的贝叶斯方法</a> (113)</p>
</li>
<li><a href="http://mindhacks.cn/2007/12/02/probability-theory-in-evolution/" title="数学之美番外篇：进化论中的概率论" target="_blank">数学之美番外篇：进化论中的概率论</a> (16)</li>
<li><a href="http://mindhacks.cn/2006/10/15/cantor-godel-turing-an-eternal-golden-diagonal/" title="康托尔、哥德尔、图灵——永恒的金色对角线(rev#2)" target="_blank">康托尔、哥德尔、图灵——永恒的金色对角线(rev/#2)</a> (56)</li>
<li><a href="http://mindhacks.cn/2011/07/10/the-importance-of-knowing-why-part3/" title="知其所以然（三）：为什么算法这么难？" target="_blank">知其所以然（三）：为什么算法这么难？</a> (74)</li>
<li><a href="http://mindhacks.cn/2010/11/14/the-importance-of-knowing-why-part2/" title="知其所以然（续）" target="_blank">知其所以然（续）</a> (54)</li>
<li><a href="http://mindhacks.cn/2008/09/11/machine-learning-and-ai-resources/" title="机器学习与人工智能学习资源导引" target="_blank">机器学习与人工智能学习资源导引</a> (18)</li>
<li><a href="http://mindhacks.cn/2008/07/07/the-importance-of-knowing-why/" title="知其所以然（以算法学习为例）" target="_blank">知其所以然（以算法学习为例）</a> (46)</li>
<li><a href="http://mindhacks.cn/2008/04/18/learning-from-polya/" title="跟波利亚学解题(rev#3)" target="_blank">跟波利亚学解题(rev/#3)</a> (32)
*</li>
</ul>
<p>*</p>
<p><a href="http://www.arrastheme.com/" target="_blank"><strong>About Arras WordPress Theme</strong></a></p>
<p>Copyright 刘未鹏 | Mind Hacks. All Rights Reserved. <a href="http://www.miibeian.gov.cn/" target="_blank">苏ICP备09004067号</a>. Powered by <a href="http://wordpress.org/" target="_blank">Wordpress</a>. Using <a href="http://www.arrastheme.com/" target="_blank">Arras Theme</a>.</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/Java&J2EE/">Java&J2EE</a></li></span><span class="breadcrumb"><li><a href="/categories/Java&J2EE/">Java&J2EE</a></li><li><a href="/categories/Java&J2EE/算法&数组&优化/">算法&数组&优化</a></li><li><a href="/categories/Java&J2EE/算法&数组&优化/算法/">算法</a></li></span></span> | <span class="tags">Tagged <a href="/tags/Java&J2EE/" class="label label-primary">Java&J2EE</a><a href="/tags/算法/" class="label label-success">算法</a><a href="/tags/算法&数组&优化/" class="label label-info">算法&数组&优化</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:40"datetime="2014-03-07 09:54:40"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-JavaJ2EE-算法数组优化-算法--数学之美番外篇：快排为什么那样快/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-JavaJ2EE-算法数组优化-算法--数学之美番外篇：快排为什么那样快" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-JavaJ2EE-算法数组优化-算法--递归面试题汇总/">递归面试题汇总</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:40.000Z"> <a href="/2014/02/02/2014-02-02-JavaJ2EE-算法数组优化-算法--递归面试题汇总/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-">递归面试题汇总</h1>
<p>您还未登录！|<a href="https://passport.csdn.net/account/login" target="_blank">登录</a>|<a href="https://passport.csdn.net/account/register" target="_blank">注册</a>|<a href="https://passport.csdn.net/help/faq" target="_blank">帮助</a></p>
<ul>
<li><a href="http://www.csdn.net/" target="_blank">首页</a></li>
<li><a href="http://news.csdn.net/" target="_blank">业界</a></li>
<li><a href="http://mobile.csdn.net/" target="_blank">移动</a></li>
<li><a href="http://cloud.csdn.net/" target="_blank">云计算</a></li>
<li><a href="http://sd.csdn.net/" target="_blank">研发</a></li>
<li><a href="http://bbs.csdn.net/" target="_blank">论坛</a></li>
<li><a href="http://blog.csdn.net/" target="_blank">博客</a></li>
<li><a href="http://download.csdn.net/" target="_blank">下载</a></li>
<li><h2 id="-"><a href="">更多</a></h2>
</li>
</ul>
<h1 id="-http-blog-csdn-net-ssjhust123-"><a href="http://blog.csdn.net/ssjhust123" target="_blank">石锅拌饭</a></h1>
<h2 id="-">一介书生，读两三卷诗书，四体不勤，五谷不分，行六百里路途，乱七八糟到大学，久不思上进，十分颓废之人的胡言乱语</h2>
<ul>
<li><a href="http://blog.csdn.net/ssjhust123?viewmode=contents" target="_blank"><img src="" alt="">目录视图</a></li>
<li><a href="http://blog.csdn.net/ssjhust123?viewmode=list" target="_blank"><img src="" alt="">摘要视图</a></li>
<li><a href="http://blog.csdn.net/ssjhust123/rss/list" target="_blank"><img src="" alt="">订阅</a>
<a href="http://www.csdn.net/article/2013-07-09/2816160" target="_blank">专访赵霏：应把握机会 HTML5游戏开发已臻成熟</a>        <a href="http://blog.csdn.net/blogdevteam/article/details/9226601" target="_blank">2013年7月微软MVP当选名单揭晓</a>      <a href="http://blog.csdn.net/csdnproduct/article/details/9226265" target="_blank">CSDN博客频道自定义摘要、图片水印、热门标签等功能上线啦</a>      <a href="http://blog.csdn.net/blogdevteam/article/details/9136613" target="_blank">CSDN博客第二期云计算最佳博主评选</a>      <a href=""></a></li>
</ul>
<h3 id="-"><a href="">递归面试题汇总</a></h3>
<p>分类： <a href="http://blog.csdn.net/ssjhust123/article/category/1112654" target="_blank">面试题系列</a> <a href="http://blog.csdn.net/ssjhust123/article/category/1190606" target="_blank">数据结构与算法</a>  2012-08-27 21:30 707人阅读 <a href="">评论</a>(0) <a href="&quot;收藏&quot;">收藏</a> <a href="&quot;举报&quot;">举报</a>
目录<a href="&quot;系统根据文章中H1到H6标签自动生成文章目录&quot;">(?)</a><a href="&quot;展开&quot;">[+]</a></p>
<ol>
<li><a href=""></a></li>
<li><a href="">一前言</a></li>
<li><a href="">二递归算法初探</a></li>
<li><p><a href="">三递归算法题</a></p>
</li>
<li><p><a href="">汉诺塔问题</a></p>
</li>
<li><a href="">求二叉树的深度</a></li>
<li><p><a href="">判断二叉树是否平衡</a></p>
</li>
<li><p><a href=""></a></p>
</li>
<li><p><a href="">排列算法</a></p>
</li>
<li><a href="">组合算法</a></li>
</ol>
<h2 id="-"><a href=""></a></h2>
<h2 id="-"><a href=""></a>一、前言</h2>
<p>找工作面试时最喜欢问的是算法题，虽然我觉得有些取巧的算法题只是跟刷题量有关。但是为了找工作不得不加强算法，特别是基础算法，这是一个人基本功的体现。《算法导论》是不错的教材，不过大部头看起来确实需要发时间，到现在还只是大略看了一遍，很多推导过程没细心看下来，深以为憾，以后有时间还是要猛补。算法题中最能体现算法精髓的则非递归莫属了，我对递归一直总觉得是一知半解，为了加深自己的理解，决定把自己的一些想法记下来，方便更好的理清自己的思路，也恳请各路大牛指正。</p>
<h2 id="-"><a href=""></a>二、递归算法初探</h2>
<p>本段内容素材来自《linux C一站式编程》，作者是宋劲松老师，说实话这是目前看到的国内关于linux C编程的最好的一本技术书籍，强烈推荐！</p>
<p>关于递归的一个简单例子是求整数阶乘，n!=n/*(n-1)!，0!=1 。则可以写出如下的递归程序：</p>
<p><strong>[cpp]</strong> <a href="&quot;view plain&quot;">view plain</a><a href="&quot;copy&quot;">copy</a><a href="&quot;print&quot;">print</a><a href="&quot;?&quot;">?</a></p>
<ol>
<li>int factorial(int n)  </li>
<li>{  </li>
<li>if (n == 0)  </li>
<li>return 1;  </li>
<li>else {  </li>
<li>int recurse = factorial(n-1);  </li>
<li>int result = n /* recurse;  </li>
<li>return result;  </li>
<li>}  </li>
<li>}<br>int factorial(int n) { if (n == 0) return 1; else { int recurse = factorial(n-1); int result = n /* recurse; return result; } }</li>
</ol>
<p>factorial
这个函数就是一个递归函数，它调用了它自己。<strong>自己直接或间接调用自己的函数称为递归函数。</strong>这里的</p>
<p>factorial
是直接调用自己，有些时候函数A调用函数B，函数B又调用函数A，也就是函数A间接调用自己，这也是递归函数。如果觉得迷惑，<strong>可以把**</strong>
factorial(n-1)
<strong>**这一步看成是在调用另一个函数</strong>－－另一个有着相同函数名和相同代码的函数，调用它就是跳到它的代码里执行，然后再返回</p>
<p>factorial(n-1)
这个调用的下一步继续执行。</p>
<p>为了证明递归算法的正确性，我们可以一步步跟进去看执行结果。记得刚学递归算法的时候，老是有丈二和尚摸不着头脑的感觉，那时候总是想着把递归一步步跟进去看执行结果。递归层次少还算好办，但是层次一多，头就大了，完全不知道自己跟到了递归的哪一层。比如求阶乘，如果只是factorial(3)跟进去问题不大，但是若是factorial(100)那就麻烦了。</p>
<p>事实上，我们并不是每个函数都需要跟进去看执行结果的，比如我们在自己的函数中调用printf函数时，并没有钻进去看它是怎么打印的，因为我们<strong>相信</strong>它能完成打印工作。我们在写factorial函数时有如下代码：</p>
<p><strong>[cpp]</strong> <a href="&quot;view plain&quot;">view plain</a><a href="&quot;copy&quot;">copy</a><a href="&quot;print&quot;">print</a><a href="&quot;?&quot;">?</a></p>
<ol>
<li>...  </li>
<li>int recurse = factorial(n-1);  </li>
<li>int result = n /* recurse;  </li>
<li>...<br>... int recurse = factorial(n-1); int result = n /* recurse; ...</li>
</ol>
<p>这时，如果我们相信factorial是正确的，那么传递参数为n-1它就会返回(n-1)!，那么result=n/*(n-1)!=n!，从而这就是factorial(n)的结果。</p>
<p>当然这有点奇怪：我们还没写完</p>
<p>factorial
这个函数，凭什么要相信</p>
<p>factorial(n-1)
是正确的？可Leap of Faith本身就是Leap（跳跃）的，不是吗？<strong>如果你相信你正在写的递归函数是正确的，并调用它，然后在此基础上写完这个递归函数，那么它就会是正确的，从而值得你相信它正确。</strong></p>
<p>这么说好像有点儿玄，我们从数学上严格证明一下</p>
<p>factorial
函数的正确性。刚才说了，</p>
<p>factorial(n)
的正确性依赖于</p>
<p>factorial(n-1)
的正确性，只要后者正确，在后者的结果上乘个</p>
<p>n
返回这一步显然也没有疑问，那么我们的函数实现就是正确的。因此要证明</p>
<p>factorial(n)
的正确性就是要证明</p>
<p>factorial(n-1)
的正确性，同理，要证明</p>
<p>factorial(n-1)
的正确性就是要证明</p>
<p>factorial(n-2)
的正确性，依此类推下去，最后是：要证明</p>
<p>factorial(1)
的正确性就是要证明</p>
<p>factorial(0)
的正确性。而</p>
<p>factorial(0)
的正确性不依赖于别的函数调用，它就是程序中的一个小的分支</p>
<p>return 1;
这个1是我们根据阶乘的定义写的，肯定是正确的，因此</p>
<p>factorial(1)
的实现是正确的，因此</p>
<p>factorial(2)
也正确，依此类推，最后</p>
<p>factorial(n)
也是正确的。其实这就是在中学时学的数学归纳法（Mathematical Induction），用数学归纳法来证明只需要证明两点：Base Case正确，递推关系正确。<strong>写递归函数时一定要记得写Base Case</strong>，否则即使递推关系正确，整个函数也不正确。如果</p>
<p>factorial
函数漏掉了Base Case，那么会导致无限循环。</p>
<h2 id="-"><a href=""></a>三、递归算法题</h2>
<p>从上一节的一个关于求阶乘的简单例子的论述，我们可以了解到递归算法的精髓：<strong>要从功能上理解函数，同时你要相信你正在写的函数是正确的，在此基础上调用它，那么它就是正确的。</strong>下面就从几个常见的算法题来看看如何理解递归，这是我的一些理解，欢迎大家提出更好的方法。</p>
<h3 id="-1-"><a href=""></a>1）汉诺塔问题</h3>
<p>汉诺塔问题是个常见问题，就是说有n个大小不等的盘子放在一个塔A上面，自底向上按照从小到大的顺序排列。要求将所有n个盘子搬到另一个塔C上面，可以借助一个塔B中转，但是要满足任何时刻大盘子不能放在小盘子上面。</p>
<p>基本思想分三步，先把上面的N-1个盘子经C移到B，然后将最底下的盘子移到C，再讲B上面的N-1个盘子经A移动到C。总的时间复杂度f(n)=2f(n-1)+1，所以f(n)=2^n-1。
<strong>[cpp]</strong> <a href="&quot;view plain&quot;">view plain</a><a href="&quot;copy&quot;">copy</a><a href="&quot;print&quot;">print</a><a href="&quot;?&quot;">?</a></p>
<ol>
<li>void hano(char a, char b, char c, int n) {  </li>
<li>if (n &gt; 0) {  </li>
<li>hano(a, c, b, n-1);  </li>
<li>move(a, c);  </li>
<li>hano(b, a, c, n-1);  </li>
<li>}  </li>
<li>}  </li>
<li></li>
<li>void move(char a, char b)  </li>
<li>{  </li>
<li>cout &lt;&lt; a &lt;&lt; &quot;-&gt;&quot; &lt;&lt; b &lt;&lt; endl;  </li>
<li>}<br>void hano(char a, char b, char c, int n) { if (n &gt; 0) { hano(a, c, b, n-1); move(a, c); hano(b, a, c, n-1); } } void move(char a, char b) { cout &lt;&lt; a &lt;&lt; &quot;-&gt;&quot; &lt;&lt; b &lt;&lt; endl; }</li>
</ol>
<h3 id="-2-"><a href=""></a>2）求二叉树的深度</h3>
<p>这里的深度指的是二叉树从根结点到叶结点最大的高度，比如只有一个结点，则深度为1，如果有N层，则高度为N。</p>
<p><strong>[cpp]</strong> <a href="&quot;view plain&quot;">view plain</a><a href="&quot;copy&quot;">copy</a><a href="&quot;print&quot;">print</a><a href="&quot;?&quot;">?</a></p>
<ol>
<li>int depth(struct node/* root)    </li>
<li>{    </li>
<li>if (root == NULL)    </li>
<li>return 0;    </li>
<li>else {    </li>
<li>int lDepth = depth(root-&gt;left);  //获取左子树深度    </li>
<li>int rDepth = depth(root-&gt;right); //获取右子树深度    </li>
<li>return lDepth&gt;rDepth? lDepth+1: rDepth+1; //取较大值+1即为二叉树深度    </li>
<li>}    </li>
<li>}<br>int depth(struct node/* root) { if (root == NULL) return 0; else { int lDepth = depth(root-&gt;left); //获取左子树深度 int rDepth = depth(root-&gt;right); //获取右子树深度 return lDepth&gt;rDepth? lDepth+1: rDepth+1; //取较大值+1即为二叉树深度 } }</li>
</ol>
<p>那么如何从功能上理解depth函数呢？我们可以知道定义该函数的目的就是求二叉树深度，也就是说我们要是完成了函数depth，那么depth(root)就能正确返回以root为根结点的二叉树的深度。<strong>因此我们的代码中depth(root-&gt;left)返回左子树的深度，而depth(root-&gt;right)返回右子树的深度。尽管这个时候我们还没有写完depth函数，但是我们相信depth函数能够正确完成功能。</strong>因此我们得到了lDepth和rDepth，而后通过比较返回较大值加1为二叉树的深度。如果不好理解，可以想象在depth中调用的函数depth(root-&gt;left)为另外一个同样名字完成相同功能的函数，这样就好理解了。</p>
<p>注意Base Case，这里就是当root==NULL时，则深度为0，函数返回0。</p>
<h3 id="-3-"><a href=""></a>3）判断二叉树是否平衡</h3>
<p>一颗平衡的二叉树是指其任意结点的左右子树深度之差不大于1。判断一棵二叉树是否是平衡的，可以使用递归算法来实现。</p>
<p><strong>[cpp]</strong> <a href="&quot;view plain&quot;">view plain</a><a href="&quot;copy&quot;">copy</a><a href="&quot;print&quot;">print</a><a href="&quot;?&quot;">?</a></p>
<ol>
<li>bool is_balanced(BinaryTreeNode/* pRoot)  </li>
<li>{  </li>
<li>if(pRoot == NULL) //基本情况，为空的话，返回true  </li>
<li>return true;  </li>
<li></li>
<li>int left = depth(pRoot-&gt;m_pLeft);  </li>
<li>int right = depth(pRoot-&gt;m_pRight);  </li>
<li>int diff = left - right; //计算左右子树深度之差  </li>
<li>if(diff &gt; 1 || diff &lt; -1) //如果深度之差大于1返回false  </li>
<li>return false;  </li>
<li></li>
<li>return is_balanced(pRoot-&gt;m_pLeft) &amp;&amp; is_balanced(pRoot-&gt;m_pRight); //递归判断左右子树，注意是&amp;&amp;，即左右子树都必须是平衡的这棵二叉树才是平衡的  </li>
<li>}<br>bool is_balanced(BinaryTreeNode/* pRoot) { if(pRoot == NULL) //基本情况，为空的话，返回true return true; int left = depth(pRoot-&gt;m_pLeft); int right = depth(pRoot-&gt;m_pRight); int diff = left - right; //计算左右子树深度之差 if(diff &gt; 1 || diff &lt; -1) //如果深度之差大于1返回false return false; return is_balanced(pRoot-&gt;m_pLeft) &amp;&amp; is_balanced(pRoot-&gt;m_pRight); //递归判断左右子树，注意是&amp;&amp;，即左右子树都必须是平衡的这棵二叉树才是平衡的 }</li>
</ol>
<h2 id="-"><a href=""></a></h2>
<p><strong>该函数的功能定义是二叉树pRoot是平衡二叉树，即它所有结点的左右子树深度之差不大于1。首先判断根结点是否满足条件，如果不满足，则直接返回false。如果满足，则需要判断左子树和右子树是否都是平衡二叉树，若都是则返回true，否则false。</strong></p>
<p>上面代码性能不高，会重复遍历结点，一个改进的算法是采用后序遍历的方式遍历树的结点，在遍历到本结点前我们已经遍历完了它的左右子树，我们只需要在遍历的时候记录结点的深度，就可以一边遍历一边判断该结点是否是平衡的。代码如下：
<strong>[cpp]</strong> <a href="&quot;view plain&quot;">view plain</a><a href="&quot;copy&quot;">copy</a><a href="&quot;print&quot;">print</a><a href="&quot;?&quot;">?</a></p>
<ol>
<li>bool is_balanced_2(BinaryTreeNode/<em> pRoot, int/</em> pDepth)  </li>
<li>{  </li>
<li>if(pRoot == NULL)  </li>
<li>{  </li>
<li>/*pDepth = 0;  </li>
<li>return true;  </li>
<li>}  </li>
<li></li>
<li>int left, right;  </li>
<li>if(is_balanced_2(pRoot-&gt;m_pLeft, &amp;left) //左子树平衡  </li>
<li>&amp;&amp; is_balanced_2(pRoot-&gt;m_pRight, &amp;right)) //右子树平衡  </li>
<li>{  </li>
<li>int diff = left - right;  </li>
<li>if(diff &lt;= 1 &amp;&amp; diff &gt;= -1)  </li>
<li>{  </li>
<li>/*pDepth = 1 + (left &gt; right ? left : right);  </li>
<li>return true;  </li>
<li>}  </li>
<li>}  </li>
<li></li>
<li>return false;  </li>
<li>}<br>bool is_balanced_2(BinaryTreeNode/<em> pRoot, int/</em> pDepth) { if(pRoot == NULL) { /<em>pDepth = 0; return true; } int left, right; if(is_balanced_2(pRoot-&gt;m_pLeft, &amp;left) //左子树平衡 &amp;&amp; is_balanced_2(pRoot-&gt;m_pRight, &amp;right)) //右子树平衡 { int diff = left - right; if(diff &lt;= 1 &amp;&amp; diff &gt;= -1) { /</em>pDepth = 1 + (left &gt; right ? left : right); return true; } } return false; }</li>
</ol>
<p><strong>该函数功能定义是返回以pRoot为根的二叉树是否是平衡二叉树，同时把树的深度保存在pDepth指向的值中。</strong>基本情况是树为NULL，则深度为0，返回true。否则只有左右子树都是平衡的情况下，深度分别存在变量left和right中，判断左右子树的深度之差是否不大于1，如果是则返回true，注意还要设置树的深度值。
调用的函数定义如下：</p>
<p><strong>[cpp]</strong> <a href="&quot;view plain&quot;">view plain</a><a href="&quot;copy&quot;">copy</a><a href="&quot;print&quot;">print</a><a href="&quot;?&quot;">?</a></p>
<ol>
<li>bool IsBalanced(BinaryTreeNode/* pRoot)  </li>
<li>{  </li>
<li>int depth = 0;  </li>
<li>return is_balanced_2(pRoot, &amp;depth);  </li>
<li>}<br>bool IsBalanced(BinaryTreeNode/* pRoot) { int depth = 0; return is_balanced_2(pRoot, &amp;depth); }</li>
</ol>
<h3 id="-4-"><a href=""></a>4）排列算法</h3>
<p>排列算法也是递归的典范，记得当初第一次看时一层层跟代码，头都大了，现在从函数功能上来看确实好理解多了。先看代码：</p>
<p><strong>[cpp]</strong> <a href="&quot;view plain&quot;">view plain</a><a href="&quot;copy&quot;">copy</a><a href="&quot;print&quot;">print</a><a href="&quot;?&quot;">?</a></p>
<ol>
<li>void perm(int a[], int k, int N) { //k为起始位置，N为数组大小  </li>
<li>if (k == N-1) {   </li>
<li>output(a, N); //输出排列  </li>
<li>} else {  </li>
<li>for (int i=k; i&lt;N; i++) {  </li>
<li>swap(a, i, k); //交换  </li>
<li>perm(a, k+1, N); //下一次排列  </li>
<li>swap(a, i, k); //恢复原来的序列  </li>
<li>}  </li>
<li>}  </li>
<li>}<br>void perm(int a[], int k, int N) { //k为起始位置，N为数组大小 if (k == N-1) { output(a, N); //输出排列 } else { for (int i=k; i&lt;N; i++) { swap(a, i, k); //交换 perm(a, k+1, N); //下一次排列 swap(a, i, k); //恢复原来的序列 } } }<strong>首先明确的是perm(a, k, N)函数的功能:输出数组a从位置k开始的所有排列，数组长度为N。这样我们在调用程序的时候，调用格式为perm(a, 0, N)，即输出数组从位置0开始的所有排列，也就是该数组的所有排列。</strong>
基础条件是k==N-1，此时已经到达最后一个元素，一次排列已经完成，直接输出。否则，从位置k开始的每个元素都与位置k的值交换(包括自己与自己交换)，然后进行下一次排列，排列完成后记得恢复原来的序列。
假定数组a大小N=3，则程序调用perm(a, 0, 3)可以如下理解：</li>
</ol>
<p>第一次交换0，0，并执行perm(a, 1, 3)，执行完再次交换0，0，数组此时又恢复成初始值。
第二次交换1，0（注意数组此时是初始值），并执行perm(a, 1, 3), 执行完再次交换1，0，数组此时又恢复成初始值。</p>
<p>第三次交换2，0，并执行perm(a, 1, 3)，执行完成后交换2，0，数组恢复成初始值。
也就是说，从功能上看，首先确定第0个位置，然后调用perm(a, 1, 3)输出从1开始的排列，这样就可以输出所有排列。而第0个位置可能的值为a[0], a[1],a[2]，这通过交换来保证第0个位置可能出现的值，记得每次交换后要恢复初始值。</p>
<p>如数组a={1,2,3}，则程序运行输出结果为：1 2 3 ，1 3 2 ，2 1 3 ，2 3 1 ，3 2 1 ，3 1 2 。即先输出以1为排列第一个值的排列，而后是2和3为第一个值的排列。</p>
<h3 id="-5-"><a href=""></a>5）组合算法</h3>
<p>组合算法也可以用递归实现，只是它的原理跟0-1背包问题类似。即要么选要么不选，注意不能选重复的数。完整代码如下：</p>
<p><strong>[cpp]</strong> <a href="&quot;view plain&quot;">view plain</a><a href="&quot;copy&quot;">copy</a><a href="&quot;print&quot;">print</a><a href="&quot;?&quot;">?</a></p>
<ol>
<li>/#include<iostream>  </li>
<li>using namespace std;  </li>
<li>/#define N 3  //数组大小为3  </li>
<li>int select[N] = {0}; //选择数组，用于存储数组哪些数字被选中。  </li>
<li>//<em>输出数组中选中的数/</em>/  </li>
<li>void output(int a[], int n)  </li>
<li>{  </li>
<li>for (int i=0; i&lt;n; i++) {  </li>
<li>if (select[i])  </li>
<li>cout &lt;&lt; a[i] &lt;&lt; &quot; &quot;;  </li>
<li>}  </li>
<li>cout &lt;&lt; endl;  </li>
<li>}  </li>
<li>//<em>数组a从位置i开始选取k个数/</em>/  </li>
<li>void combination(int a[], int i, int k)  </li>
<li>{  </li>
<li>if (i &gt; N) return; //位置超出数组范围直接返回，否则非法访问会出段错误  </li>
<li>if (k == 0) {  //选取完了，输出选取的数字  </li>
<li>output(a, N);  </li>
<li>} else {  </li>
<li>select[i] = 1;    </li>
<li>combination(a, i+1, k-1); //第i个数字被选取，从后续i+1开始选取k-1个数  </li>
<li>select[i] = 0;  </li>
<li>combination(a, i+1, k); //第i个数字不选，则从后续i+1位置开始还要选取k个数  </li>
<li>}  </li>
<li>}  </li>
<li></li>
<li>//<em>组合主函数，包括选取1到n个数字/</em>/  </li>
<li>void combination_helper(int a[], int n) {  </li>
<li>for (int k=1; k&lt;=n; k++) {  </li>
<li>combination(a, 0, k);  </li>
<li>}  </li>
<li>}  </li>
<li></li>
<li>int main()  </li>
<li>{  </li>
<li>int a[N] = {1, 2, 3};  </li>
<li>combination_helper(a, N);  </li>
<li>return 0;  </li>
<li><p>}<br>/#include<iostream> using namespace std; /#define N 3 //数组大小为3 int select[N] = {0}; //选择数组，用于存储数组哪些数字被选中。 //<em>输出数组中选中的数/</em>/ void output(int a[], int n) { for (int i=0; i<n; i++) { if (select[i]) cout << a[i] << " "; } cout << endl; } //*数组a从位置i开始选取k个数/*/ void combination(int a[], int i, int k) { if (i > N) return; //位置超出数组范围直接返回，否则非法访问会出段错误 if (k == 0) { //选取完了，输出选取的数字 output(a, N); } else { select[i] = 1; combination(a, i+1, k-1); //第i个数字被选取，从后续i+1开始选取k-1个数 select[i] = 0; combination(a, i+1, k); //第i个数字不选，则从后续i+1位置开始还要选取k个数 } } //<em>组合主函数，包括选取1到n个数字/</em>/ void combination_helper(int a[], int n) { for (int k=1; k&lt;=n; k++) { combination(a, 0, k); } } int main() { int a[N] = {1, 2, 3}; combination_helper(a, N); return 0; }
分享到： <a href="&quot;分享到新浪微博&quot;"></a><a href="&quot;分享到腾讯微博&quot;"></a></p>
</li>
<li><p>上一篇：<a href="http://blog.csdn.net/ssjhust123/article/details/7912490" target="_blank">数学之美—快排为什么那样快</a></p>
</li>
<li><p>下一篇：<a href="http://blog.csdn.net/ssjhust123/article/details/7916358" target="_blank">组合算法面试题</a>
查看评论<a href=""></a></p>
<p>暂无评论
您还没有登录,请<a href="">[登录]</a>或<a href="http://passport.csdn.net/account/register?from=http%3A%2F%2Fblog.csdn.net%2Fssjhust123%2Farticle%2Fdetails%2F7913137" target="_blank">[注册]</a></p>
</li>
</ol>
<p>/* 以上用户言论只代表其个人观点，不代表CSDN网站的观点或立场<a href=""></a><a href=""></a>
<a href="&quot;回到顶部&quot;"><img src="" alt="TOP"></a></p>
<p>个人资料</p>
<p><a href="http://my.csdn.net/ssjhust123" target="_blank"><img src="&quot;访问我的空间&quot;" alt=""></a>
<a href="http://my.csdn.net/ssjhust123" target="_blank">ssjhust123</a></p>
<p><a href="&quot;[加关注]&quot;"></a> <a href="&quot;[发私信]&quot;"></a>
<a href="http://medal.blog.csdn.net/allmedal.aspx" target="_blank"><img src="" alt=""></a></p>
<ul>
<li>访问：57759次</li>
<li>积分：1427分</li>
<li><p>排名：第6777名</p>
</li>
<li><p>原创：79篇</p>
</li>
<li>转载：22篇</li>
<li>译文：3篇</li>
<li>评论：43条</li>
</ul>
<p>文章搜索</p>
<p><a href=""></a></p>
<p>文章分类</p>
<ul>
<li><a href="http://blog.csdn.net/ssjhust123/article/category/1112654" target="_blank">面试题系列</a>(59)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/category/1190606" target="_blank">数据结构与算法</a>(40)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/category/1146662" target="_blank">JAVA相关</a>(11)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/category/1191115" target="_blank">Cassandra源码分析</a>(6)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/category/1194764" target="_blank">Linux杂谈</a>(8)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/category/1215816" target="_blank">链表</a>(8)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/category/1215817" target="_blank">二叉树</a>(18)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/category/1235411" target="_blank">字符串</a>(5)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/category/1237423" target="_blank">自己动手系列</a>(4)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/category/1240352" target="_blank">栈</a>(2)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/category/1249446" target="_blank">数字之趣</a>(8)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/category/1254833" target="_blank">排序</a>(4)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/category/1266438" target="_blank">MYSQL杂谈</a>(3)</li>
<li><p><a href="http://blog.csdn.net/ssjhust123/article/category/1418274" target="_blank">python相关</a>(5)
文章存档</p>
</li>
<li><p><a href="http://blog.csdn.net/ssjhust123/article/month/2013/06" target="_blank">2013年06月</a>(2)</p>
</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/month/2013/05" target="_blank">2013年05月</a>(9)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/month/2013/02" target="_blank">2013年02月</a>(1)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/month/2012/12" target="_blank">2012年12月</a>(2)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/month/2012/11" target="_blank">2012年11月</a>(1)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/month/2012/10" target="_blank">2012年10月</a>(13)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/month/2012/09" target="_blank">2012年09月</a>(13)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/month/2012/08" target="_blank">2012年08月</a>(26)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/month/2012/07" target="_blank">2012年07月</a>(31)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/month/2012/05" target="_blank">2012年05月</a>(6)</li>
</ul>
<p>展开</p>
<p>阅读排行</p>
<ul>
<li><a href="http://blog.csdn.net/ssjhust123/article/details/8001651" title="中缀表达式转换为后缀表达式" target="_blank">中缀表达式转换为后缀表达式</a>(4679)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/details/7783935" title="中序遍历和先序遍历/后序遍历构建二叉树" target="_blank">中序遍历和先序遍历/后序遍历构建二叉树</a>(3637)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/details/7772153" title="brk(), sbrk() 用法详解" target="_blank">brk(), sbrk() 用法详解</a>(1968)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/details/7777665" title="序列化/反序列化二叉树" target="_blank">序列化/反序列化二叉树</a>(1891)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/details/7771096" title="判定一棵二叉树是否是二叉搜索树" target="_blank">判定一棵二叉树是否是二叉搜索树</a>(1869)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/details/8040283" title="给定一个字符数组，存储有R、G、B字符，将所有字符按照RGB顺序排序" target="_blank">给定一个字符数组，存储有R、G、B字符，将所有字符按照RGB顺序排序</a>(1806)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/details/7766499" title="Cassandra中布隆过滤器详解" target="_blank">Cassandra中布隆过滤器详解</a>(1698)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/details/7566137" title="JAVA泛型编程全面总结" target="_blank">JAVA泛型编程全面总结</a>(1320)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/details/8224659" title="Debian6安装笔记" target="_blank">Debian6安装笔记</a>(1143)</li>
<li><p><a href="http://blog.csdn.net/ssjhust123/article/details/7773103" title="二叉树遍历之非递归算法" target="_blank">二叉树遍历之非递归算法</a>(1121)
评论排行</p>
</li>
<li><p><a href="http://blog.csdn.net/ssjhust123/article/details/8001651" title="中缀表达式转换为后缀表达式" target="_blank">中缀表达式转换为后缀表达式</a>(8)</p>
</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/details/7979541" title="最长回文子串" target="_blank">最长回文子串</a>(5)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/details/7580510" title="JAVA类库分析之HashMap" target="_blank">JAVA类库分析之HashMap</a>(5)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/details/8224659" title="Debian6安装笔记" target="_blank">Debian6安装笔记</a>(3)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/details/7566137" title="JAVA泛型编程全面总结" target="_blank">JAVA泛型编程全面总结</a>(2)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/details/7935537" title="二叉树两结点的最低公共祖先结点(一)" target="_blank">二叉树两结点的最低公共祖先结点(一)</a>(2)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/details/7773103" title="二叉树遍历之非递归算法" target="_blank">二叉树遍历之非递归算法</a>(2)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/details/7753785" title="在数组中找出3个数使得它们和为0" target="_blank">在数组中找出3个数使得它们和为0</a>(2)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/details/7753012" title="已知一个函数rand7()能够生成1-7的随机数，请给出一个函数rand10()，该函数能够生成1-10的随机数。" target="_blank">已知一个函数rand7()能够生成1-7的随机数，请给出一个函数rand10()，该函数能够生成1-10的随机数。</a>(2)</li>
<li><a href="http://blog.csdn.net/ssjhust123/article/details/7978337" title="链表模拟加法问题" target="_blank">链表模拟加法问题</a>(2)</li>
</ul>
<p>最新评论</p>
<ul>
<li><a href="http://blog.csdn.net/ssjhust123/article/details/7566137#comments" target="_blank">JAVA泛型编程全面总结</a></li>
</ul>
<p><a href="http://blog.csdn.net/ssjhust123" target="_blank">ssjhust123</a>: @zhuzi51job:哈哈，不客气，请多指正。</p>
<ul>
<li><a href="http://blog.csdn.net/ssjhust123/article/details/7566137#comments" target="_blank">JAVA泛型编程全面总结</a></li>
</ul>
<p><a href="http://blog.csdn.net/zhuzi51job" target="_blank">zhuzi51job</a>: 写的很详细，谢谢你的分享。</p>
<ul>
<li><a href="http://blog.csdn.net/ssjhust123/article/details/8035815#comments" target="_blank">最大连续子序列乘积</a></li>
</ul>
<p><a href="http://blog.csdn.net/huhuang03" target="_blank">huhuang03</a>: mark</p>
<ul>
<li><a href="http://blog.csdn.net/ssjhust123/article/details/8001651#comments" target="_blank">中缀表达式转换为后缀表达式</a></li>
</ul>
<p><a href="http://blog.csdn.net/wjflyhigh" target="_blank">Flyhigh</a>: @naruto2011sasuke:不对，这里就不应该这么写，应该是只要有“（”，则直接进栈。进栈以...</p>
<ul>
<li><a href="http://blog.csdn.net/ssjhust123/article/details/7783935#comments" target="_blank">中序遍历和先序遍历/后序遍历构建二叉树</a></li>
</ul>
<p><a href="http://blog.csdn.net/ssjhust123" target="_blank">ssjhust123</a>: @handong1587:呵呵，不客气。请多多指正。</p>
<ul>
<li><a href="http://blog.csdn.net/ssjhust123/article/details/7783935#comments" target="_blank">中序遍历和先序遍历/后序遍历构建二叉树</a></li>
</ul>
<p><a href="http://blog.csdn.net/handong1587" target="_blank">handong1587</a>: 讲得很清楚，谢谢！</p>
<ul>
<li><a href="http://blog.csdn.net/ssjhust123/article/details/8001651#comments" target="_blank">中缀表达式转换为后缀表达式</a></li>
</ul>
<p><a href="http://blog.csdn.net/haiyaojing" target="_blank">haiyaojing</a>: 灰常感谢~</p>
<ul>
<li><a href="http://blog.csdn.net/ssjhust123/article/details/8001651#comments" target="_blank">中缀表达式转换为后缀表达式</a></li>
</ul>
<p><a href="http://blog.csdn.net/ssjhust123" target="_blank">ssjhust123</a>: @tcstory::-)，最近都没有时间写咯。</p>
<ul>
<li><a href="http://blog.csdn.net/ssjhust123/article/details/8001651#comments" target="_blank">中缀表达式转换为后缀表达式</a></li>
</ul>
<p><a href="http://blog.csdn.net/tcstory" target="_blank">tcstory</a>: 师兄啊 代码啥时候贴上来啊</p>
<ul>
<li><a href="http://blog.csdn.net/ssjhust123/article/details/8001651#comments" target="_blank">中缀表达式转换为后缀表达式</a></li>
</ul>
<p><a href="http://blog.csdn.net/tcstory" target="_blank">tcstory</a>: 谢谢了 写得非常好 比我的书《数据结构使用C语言》 第三版 朱战立 里面的 写得好多了</p>
<p><a href="http://www.csdn.net/company/about.html" target="_blank">公司简介</a>|<a href="http://www.csdn.net/company/recruit.html" target="_blank">招贤纳士</a>|<a href="http://www.csdn.net/company/marketing.html" target="_blank">广告服务</a>|<a href="http://www.csdn.net/company/account.html" target="_blank">银行汇款帐号</a>|<a href="http://www.csdn.net/company/contact.html" target="_blank">联系方式</a>|<a href="http://www.csdn.net/company/statement.html" target="_blank">版权声明</a>|<a href="http://www.csdn.net/company/layer.html" target="_blank">法律顾问</a>|<a href="mailto:webmaster@csdn.net">问题报告</a><a href="http://wpa.qq.com/msgrd?v=3&amp;uin=2355263776&amp;site=qq&amp;menu=yes" target="_blank">QQ客服</a> <a href="http://e.weibo.com/csdnsupport/profile" target="_blank">微博客服</a> <a href="http://bbs.csdn.net/forums/Service" target="_blank">论坛反馈</a> <a href="mailto:webmaster@csdn.net">联系邮箱：webmaster@csdn.net</a> 服务热线：400-600-2320京 ICP 证 070598 号北京创新乐知信息技术有限公司 版权所有世纪乐知(北京)网络技术有限公司 提供技术支持江苏乐知网络技术有限公司 提供商务支持Copyright © 1999-2012, CSDN.NET, All Rights Reserved <a href="http://www.hd315.gov.cn/beian/view.asp?bianhao=010202001032100010" target="_blank"><img src="" alt="GongshangLogo"></a>
<img src="http://counter.csdn.net/pv.aspx?id=24" alt=""></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/Java&J2EE/">Java&J2EE</a></li></span><span class="breadcrumb"><li><a href="/categories/Java&J2EE/">Java&J2EE</a></li><li><a href="/categories/Java&J2EE/算法&数组&优化/">算法&数组&优化</a></li><li><a href="/categories/Java&J2EE/算法&数组&优化/算法/">算法</a></li></span></span> | <span class="tags">Tagged <a href="/tags/Java&J2EE/" class="label label-primary">Java&J2EE</a><a href="/tags/算法/" class="label label-success">算法</a><a href="/tags/算法&数组&优化/" class="label label-info">算法&数组&优化</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:40"datetime="2014-03-07 09:54:40"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-JavaJ2EE-算法数组优化-算法--递归面试题汇总/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-JavaJ2EE-算法数组优化-算法--递归面试题汇总" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-JavaJ2EE-Java_集合--DWR如何获得返回对象listMapSetlist/">DWR如何获得返回对象 list Map Set list</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:40.000Z"> <a href="/2014/02/02/2014-02-02-JavaJ2EE-Java_集合--DWR如何获得返回对象listMapSetlist/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="dwr-list-map-set-list">DWR如何获得返回对象 list Map Set list</h1>
<p><strong>DWR**</strong>如何获得返回对象<strong>**list Map Set list.add(JavaBean)</strong></p>
<p><strong>1**</strong>、调用没有返回值和参数的JAVA方法**</p>
<p>1.1、dwr.xml的配置</p>
<p><dwr></p>
<p><allow></p>
<p><create creator="new" javascript="testClass" ></p>
<p><param name="class" value="/com.dwr.TestClass" /></p>
<p><include method="testMethod1"/>
</create>
</allow>
</dwr></p>
<p><allow>标签中包括可以暴露给javascript访问的东西。</p>
<p><create>标签中指定javascript中可以访问的java类，并定义DWR应当如何获得要进行远程的类的实例。creator=&quot;new&quot;属性指定java类实例的生成方式，new意味着DWR应当调用类的默认构造函数来获得实例，其他的还有spring方式，通过与IOC容器Spring进行集成来获得实例等等。javascript=&quot; testClass &quot;属性指定javascript代码访问对象时使用的名称。</p>
<p><param>标签指定要公开给javascript的java类名。</p>
<p><include>标签指定要公开给javascript的方法。不指定的话就公开所有方法。</p>
<p><exclude>标签指定要防止被访问的方法。
1.2、javascript中调用
首先，引入javascript脚本</p>
<p><script src='dwr/interface/ testClass.js'></script></p>
<p><script src="/dwr/engine.js"></script></p>
<p><script src="/dwr/util.js"></script>
其中TestClass.js是dwr根据配置文件自动生成的，engine.js和util.js是dwr自带的脚本文件。
其次，编写调用java方法的javascript函数
Function callTestMethod1(){
       testClass.testMethod1();
}
<strong>2**</strong>、调用有简单返回值的java方法**</p>
<p><strong>2.1**</strong>、dwr.xml的配置<strong><em>**</em></strong>配置同1.1</p>
<p><dwr></p>
<p><allow></p>
<p><create creator="new" javascript="testClass" ></p>
<p><param name="class" value="/com.dwr.TestClass" /></p>
<p><include method="testMethod2"/>
</create>
</allow>
</dwr>
2.2、javascript中调用
首先，引入javascript脚本
其次，编写调用java方法的javascript函数和接收返回值的回调函数
Function callTestMethod2(){
       testClass.testMethod2(callBackFortestMethod2);
}
Function callBackFortestMethod2(data){
      //其中date接收方法的返回值
      //可以在这里对返回值进行处理和显示等等
alert(&quot;the return value is &quot; + data);
}
其中callBackFortestMethod2是接收返回值的回调函数**</p>
<p><strong>3**</strong>、调用有简单参数的java方法**</p>
<p><strong>3.1**</strong>、dwr.xml的配置<strong><em>**</em></strong>配置同1.1</p>
<p><dwr></p>
<p><allow></p>
<p><create creator="new" javascript="testClass" ></p>
<p><param name="class" value="/com.dwr.TestClass" /></p>
<p><include method="testMethod3"/>
</create>
</allow>
</dwr>
3.2、javascript中调用
首先，引入javascript脚本
其次，编写调用java方法的javascript函数
Function callTestMethod3(){
                  //定义要传到java方法中的参数
       var data;
       //构造参数
       data = “test String”;
       testClass.testMethod3(data);
}**</p>
<p><strong>4**</strong>、调用返回JavaBean的java方法<strong><strong>4.1</strong></strong>、dwr.xml的配置<em>**</em><dwr></p>
<p><allow></p>
<p><create creator="new" javascript="testClass" ></p>
<p><param name="class" value="/com.dwr.TestClass" /></p>
<p><include method="testMethod4"/>
</create></p>
<p>&lt;convert converter=&quot;bean&quot; match=&quot;&quot;com.dwr.TestBean&quot;&gt;
                   <param name="include" value="username,password" />
</convert>
</allow>
</dwr></p>
<p><creator><strong>**标签负责公开用于Web远程的类和类的方法，<convertor>标签则负责这些方法的参数和返回类型。convert元素的作用是告诉DWR在服务器端Java 对象表示和序列化的JavaScript之间如何转换数据类型。DWR自动地在Java和JavaScript表示之间调整简单数据类型。这些类型包括Java原生类型和它们各自的封装类表示，还有String、Date、数组和集合类型。DWR也能把JavaBean转换成JavaScript 表示，但是出于安全性的原因，要求显式的配置，<convertor>标签就是完成此功能的。converter=&quot;bean&quot;属性指定转换的方式采用JavaBean命名规范，match=&quot;&quot;com.dwr.TestBean&quot;属性指定要转换的javabean名称，<param>标签指定要转换的JavaBean属性。
4.2、javascript中调用
首先，引入javascript脚本
其次，编写调用java方法的javascript函数和接收返回值的回调函数
Function callTestMethod4(){
       testClass.testMethod4(callBackFortestMethod4);
}
Function callBackFortestMethod4(data){
      //其中date接收方法的返回值
//对于JavaBean返回值，有两种方式处理
              //不知道属性名称时，使用如下方法
            for(var property in data){
               alert(&quot;property:&quot;+property);
               alert(property+&quot;:&quot;+data[property]);
            }
//知道属性名称时，使用如下方法
            alert(data.username);
            alert(data.password);
}
其中callBackFortestMethod4是接收返回值的回调函数</strong></p>
<p><strong>5**</strong>、调用有JavaBean参数的java方法<strong><strong>5.1</strong></strong>、dwr.xml的配置
<em>**</em>配置同4.1</p>
<p><dwr></p>
<p><allow></p>
<p><create creator="new" javascript="testClass" ></p>
<p><param name="class" value="/com.dwr.TestClass" /></p>
<p><include method="testMethod5"/>
</create></p>
<p><convert converter="bean" match="com.dwr.TestBean">
                   <param name="include" value="username,password" />
</convert>
</allow>
</dwr>
5.2、javascript中调用
首先，引入javascript脚本
其次，编写调用java方法的javascript函数
Function callTestMethod5(){
                  //定义要传到java方法中的参数
       var data;
       //构造参数，date实际上是一个object
       data = { username:&quot;user&quot;, password:&quot;password&quot; }
       testClass.testMethod5(data);
}**</p>
<p><strong>6**</strong>、调用返回List、Set或者Map的java方法<strong><strong>6.1</strong></strong>、dwr.xml的配置<strong><em>**</em></strong>配置同4.1</p>
<p><dwr></p>
<p><allow></p>
<p><create creator="new" javascript="testClass" ></p>
<p><param name="class" value="/com.dwr.TestClass" /></p>
<p><include method="testMethod6"/>
</create></p>
<p><convert converter="bean" match="com.dwr.TestBean"></p>
<p><param name="include" value="username,password" />
</convert>
</allow>
</dwr>
注意：如果List、Set或者Map中的元素均为简单类型（包括其封装类）或String、Date、数组和集合类型，则不需要<convert>标签。
6.2、javascript中调用(以返回List为例，List的元素为TestBean)
首先，引入javascript脚本
其次，编写调用java方法的javascript函数和接收返回值的回调函数
Function callTestMethod6(){
       testClass.testMethod6(callBackFortestMethod6);
}
Function callBackFortestMethod6(data){
      //其中date接收方法的返回值
//对于JavaBean返回值，有两种方式处理
              //不知道属性名称时，使用如下方法
            for(var i=0;i&lt;data.length;i++){
for(var property in data){
                   alert(&quot;property:&quot;+property);
                   alert(property+&quot;:&quot;+data[property]);
                }
}
//知道属性名称时，使用如下方法
for(var i=0;i&lt;data.length;i++){
                alert(data.username);
                alert(data.password);
}
}**</p>
<p><strong>7**</strong>、调用有List、Set或者Map参数的java方法**</p>
<p><strong>7.1**</strong>、dwr.xml的配置<em>**</em><dwr></p>
<p><allow></p>
<p><create creator="new" javascript="testClass" ></p>
<p><param name="class" value="/com.dwr.TestClass" /></p>
<p><include method="testMethod7"/>
</create></p>
<p><convert converter="bean" match="com.dwr.TestBean"></p>
<p><param name="include" value="username,password" />
</convert>
</allow></p>
<p><signatures>
&lt;![CDATA[
import java.util.List;
import com.dwr.TestClass;
import com.dwr.TestBean;
TestClass.testMethod7(List<TestBean>);
]]&gt;
</signatures>
</dwr></p>
<p><signatures><em>**</em>标签是用来声明java方法中List、Set或者Map参数所包含的确切类，以便java代码作出判断。
7.2、javascript中调用(以返回List为例，List的元素为TestBean)
首先，引入javascript脚本
其次，编写调用java方法的javascript函数
Function callTestMethod7(){
//定义要传到java方法中的参数
       var data;
       //构造参数，date实际上是一个object数组，即数组的每个元素均为object
data = [
                       {
                          username:&quot;user1&quot;,
                          password:&quot;password2&quot;
                       },
                       {
                          username:&quot;user2&quot;,
                          password:&quot; password2&quot;
                       }
                   ];
       testClass.testMethod7(data);
}
注意：
1、对于第6种情况，如果java方法的返回值为Map，则在接收该返回值的javascript回调函数中如下处理：
function callBackFortestMethod(data){
            //其中date接收方法的返回值
            for(var property in data){
                   var bean = data[property];
                   alert(bean.username);
                   alert(bean.password);
               }
}
2、对于第7种情况，如果java的方法的参数为Map（假设其key为String，value为TestBean），则在调用该方法的javascript函数中用如下方法构造要传递的参数：
function callTestMethod (){
               //定义要传到java方法中的参数
               var data;
               //构造参数，date实际上是一个object，其属性名为Map的key，属性值为Map的value
               data = {
                          &quot;key1&quot;:{
                              username:&quot;user1&quot;,
                             password:&quot;password2&quot;
                          },
                          &quot;key2&quot;:{
                             username:&quot;user2&quot;,
                             password:&quot; password2&quot;
                          }
                      };
               testClass.testMethod(data);
}
并且在dwr.xml中增加如下的配置段</p>
<p><signatures>
&lt;![CDATA[
import java.util.List;
import com.dwr.TestClass;
import com.dwr.TestBean;
TestClass.testMethod7(Map<String,TestBean>);
]]&gt;
</signatures>
3、由以上可以发现，对于java方法的返回值为List(Set)的情况，DWR将其转化为Object数组，传递个javascript；对于java方法的返回值为Map的情况，DWR将其转化为一个Object，其中Object的属性为原Map的key值，属性值为原Map相应的value值。
4、如果java方法的参数为List(Set)和Map的情况，javascript中也要根据3种所说，构造相应的javascript数据来传递到java中。**</p>
<p><strong>======================================================================================</strong></p>
<p><a href=""></a><strong>Scripting Introduction</strong></p>
<p><strong>DWR**</strong>根据dwr.xml生成和Java代码类似的Javascript代码。**</p>
<p><strong>相对而言Java同步调用，创建与Java代码匹配的Ajax远程调用接口的最大挑战来至与实现Ajax的异步调用特性。</strong></p>
<p><strong>DWR**</strong>通过引入回调函数来解决这个问题，当结果被返回时，DWR会调用这个函数。**</p>
<p><strong>有两种推荐的方式来使用DWR实现远程方法调用。可以通过把回调函数放在参数列表里，也可以把回调函数放到元数据对象里。</strong></p>
<p><strong>当然也可以把回调函数做为第一个参数，但是不建议使用这种方法。因为这种方法在处理</strong><a href="http://wiki.javascud.org/display/dwrcn/Accessing+Servlet+Objects" title="Accessing Servlet Objects" target="_blank">自动处理http对象</a><strong>时(查看&quot;Alternative Method&quot;)上会有问题。这个方法主要是为向下兼容而存在的。</strong></p>
<p><a href=""></a><strong>简单的回调函数</strong></p>
<p><strong>假设你有一个这样的Java方法：</strong></p>
<p><strong>public class Remote {    public String getData(int index) { ... }}</strong></p>
<p><strong>我们可以在Javascript中这样使用：</strong></p>
<p><strong><script type="text/javascript"    src="[WEBAPP]/dwr/interface/Remote.js"> </script><script type="text/javascript"    src="[WEBAPP]/dwr/engine.js"> </script>...function handleGetData(str) {  alert(str);}Remote.getData(42, handleGetData);</strong></p>
<p><strong>42**</strong>是Java方法getData()的一个参数。**</p>
<p><strong>此外你也可以使用这种减缩格式：</strong></p>
<p><strong>Remote.getData**</strong>(42, function(str) { alert(str); });**</p>
<p><a href=""></a><strong>调用元数据对象(Meta-Data)</strong></p>
<p><strong>另外一种语法时使用&quot;调用元数据对象&quot;来指定回调函数和其他的选项。上面的例子可以写成这样：</strong></p>
<p><strong>Remote.getData**</strong>(42, {  callback:function(str) { alert(str); }});**</p>
<p><strong>这种方法有很多优点：易于阅读，更重要的指定额外的调用选项。</strong></p>
<p><a href=""></a><strong>超时和错误处理</strong></p>
<p><strong>在回调函数的元数据中你可以指定超时和错误的处理方式。例如：</strong></p>
<p><strong>Remote.getData**</strong>(42, {  callback:function(str) { alert(str); },  timeout:5000,  errorHandler:function(message) { alert(&quot;Oops: &quot; + message); }});**</p>
<p><a href=""></a><strong>查找回调函数</strong></p>
<p><strong>有些情况下我们很难区分各种回调选项(记住，Javascript是不支持函数重载的)。例如：</strong></p>
<p><strong>Remote.method**</strong>({ timeout:3 }, { errorHandler:somefunc });**</p>
<p><strong>这两个参数之一是bean的参数，另一个是元数据对象，但是我们不能清楚的告诉DWR哪个是哪个。为了可以跨浏览器，我们假定null == undefined。 所以当前的情况，规则是：</strong></p>
<ul>
<li><strong>如果第一个或最后一个是一个函数，那么它就是回调函数，没有元数据对象，并且其他参数都是Java的方法参数。</strong></li>
<li><strong>另外，如果最后一个参数是一个对象，这个对象中有一个callback成员，并且它是个函数，那么这个对象就是元数据对象，其他的都是Java方法参数。</strong></li>
<li><strong>另外，如果第一个参数是 null ，我们就假设没有回调函数，并且其他的都是Java方法参数。尽管如此，我们会检查最后一个参数是不是null，如果是就发出警告。</strong></li>
<li><strong>最后如果最后一个参数是null，那么就没有callback函数。</strong></li>
<li><strong>另外，发出错误信号是个糟糕的请求格式。</strong></li>
</ul>
<p><a href=""></a><strong>创造一个与Java对象匹配的Javascript对象</strong></p>
<p><strong>假设你有这样的Java方法：</strong></p>
<p><strong>public class Remote {  public void setPerson(Person p) {    this.person = p;  }}</strong></p>
<p><strong>Person**</strong>对象的结构是这样的：**</p>
<p><strong>public Person {  private String name;  private int age;  private Date[] appointments;  // getters and setters ...}</strong></p>
<p><strong>那么你可以在Javascript中这样写：</strong></p>
<p><strong>var**</strong>p = {  name:&quot;Fred Bloggs&quot;,  age:42,  appointments:[ new Date(), new Date(&quot;1 Jan 2008&quot;) ]};Remote.setPerson(p);**</p>
<p><strong>在Javascript没有出现的字段，在Java中就不会被设置。</strong></p>
<p><strong>因为setter都是返回&#39;void&#39;，我们就不需要使用callback函数了。如果你想要一个返回void的服务端方法的完整版，你也可以加上callback函数。很明显DWR不会向它传递任何参数。</strong></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/Java&J2EE/">Java&J2EE</a></li></span><span class="breadcrumb"><li><a href="/categories/Java&J2EE/">Java&J2EE</a></li><li><a href="/categories/Java&J2EE/Java_集合/">Java_集合</a></li></span></span> | <span class="tags">Tagged <a href="/tags/Java&J2EE/" class="label label-primary">Java&J2EE</a><a href="/tags/Java_集合/" class="label label-success">Java_集合</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:40"datetime="2014-03-07 09:54:40"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-JavaJ2EE-Java_集合--DWR如何获得返回对象listMapSetlist/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-JavaJ2EE-Java_集合--DWR如何获得返回对象listMapSetlist" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-缓存-ehcache--基于EHCache实现缓存去重-passover【毕成功的博客】-51CTO技术博客/">基于EHCache实现缓存去重 </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:39.000Z"> <a href="/2014/02/02/2014-02-02-缓存-ehcache--基于EHCache实现缓存去重-passover【毕成功的博客】-51CTO技术博客/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-ehcache-passover-51cto-">基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客</h1>
<h3 id="-">分享到</h3>
<ul>
<li><a href="http://passover.blog.51cto.com/#" target="_blank">QQ空间</a></li>
<li><a href="http://passover.blog.51cto.com/#" target="_blank">新浪微博</a></li>
<li><a href="http://passover.blog.51cto.com/#" target="_blank">百度搜藏</a></li>
<li><a href="http://passover.blog.51cto.com/#" target="_blank">人人网</a></li>
<li><a href="http://passover.blog.51cto.com/#" target="_blank">腾讯微博</a></li>
<li><a href="http://passover.blog.51cto.com/#" target="_blank">开心网</a></li>
<li><a href="http://passover.blog.51cto.com/#" target="_blank">腾讯朋友</a></li>
<li><a href="http://passover.blog.51cto.com/#" target="_blank">百度空间</a></li>
<li><a href="http://passover.blog.51cto.com/#" target="_blank">豆瓣网</a></li>
<li><a href="http://passover.blog.51cto.com/#" target="_blank">搜狐微博</a></li>
<li><a href="http://passover.blog.51cto.com/#" target="_blank">百度新首页</a></li>
<li><a href="http://passover.blog.51cto.com/#" target="_blank">QQ收藏</a></li>
<li><a href="http://passover.blog.51cto.com/#" target="_blank">和讯微博</a></li>
<li><a href="http://passover.blog.51cto.com/#" target="_blank">我的淘宝</a></li>
<li><a href="http://passover.blog.51cto.com/#" target="_blank">百度贴吧</a></li>
<li><a href="http://passover.blog.51cto.com/#" target="_blank">更多...</a></li>
</ul>
<p><a href="http://passover.blog.51cto.com/#" target="_blank">百度分享</a></p>
<p><a href="http://blog.51cto.com/" target="_blank"><img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/head_blog_sibebar_logo.gif" alt=""></a><a href="http://www.51cto.com/" target="_blank">51CTO首页</a><img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/top_bg_xian.gif" alt=""><a href="http://blog.51cto.com/" target="_blank">51CTO博客</a><img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/top_bg_xian.gif" alt=""><a href="http://home.51cto.com/?reback=http%253A%252F%252Fpassover.blog.51cto.com%252F2431658%252F486709" target="_blank">我的博客</a><img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/top_bg_xian.gif" alt=""> <a href="http://blog.51cto.com/search.php" target="_blank">搜索</a> <a href="">每日博报</a></p>
<p><img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/top_shequ.gif" alt="">社区：<a href="http://bbs.51cto.com/" target="_blank">论坛</a><a href="http://blog.51cto.com/" target="_blank">博客</a><a href="http://down.51cto.com/" target="_blank">下载</a><a href="http://book.51cto.com/" target="_blank">读书</a><a href="">更多<img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/nav_ico1.gif" alt=""></a></p>
<p><a href="http://home.51cto.com/index.php?s=/Home/index" target="_blank"><img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/dia.gif" alt="" title="今天领无忧币了吗？"></a><a href="http://home.51cto.com/?reback=http%253A%252F%252Fpassover.blog.51cto.com%252F2431658%252F486709" target="_blank">登录</a><a href="http://ucenter.51cto.com/reg_01.php?reback=http%253A%252F%252Fpassover.blog.51cto.com%252F2431658%252F486709" target="_blank">注册</a></p>
<ul>
<li><a href="http://home.51cto.com/" target="_blank">家园</a></li>
<li><a href="http://t.51cto.com/" target="_blank">微博</a></li>
<li><a href="http://blog.51cto.com/" target="_blank">博客</a></li>
<li><a href="http://bbs.51cto.com/" target="_blank">论坛</a></li>
<li><a href="http://down.51cto.com/" target="_blank">下载</a></li>
<li><a href="http://selftest.51cto.com/" target="_blank">自测</a></li>
<li><a href="http://doctor.51cto.com/" target="_blank">门诊</a></li>
<li><a href="http://blog.51cto.com/newsletter/" target="_blank">周刊</a></li>
<li><a href="http://book.51cto.com/" target="_blank">读书</a></li>
<li><a href="http://g.51cto.com/" target="_blank">技术圈</a></li>
<li><a href="http://zhidao.51cto.com/" target="_blank">知道</a></li>
</ul>
<p><a href="http://blog.51cto.com/blogcommend" target="_blank"><img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/blogLogo01.png" alt=""></a></p>
<p>[</p>
<h1 id="passover-">passover【毕成功的博客】</h1>
<p>](<a href="http://passover.blog.51cto.com/" target="_blank">http://passover.blog.51cto.com/</a>)</p>
<p><a href="http://passover.blog.51cto.com/" target="_blank"><a href="http://passover.blog.51cto.com">http://passover.blog.51cto.com</a></a>  <a href="">【复制】</a> <a href="http://passover.blog.51cto.com/rss.php?uid=2431658" target="_blank"></a><a href="http://passover.blog.51cto.com/rss.php?uid=2431658">【订阅】</a></p>
<p><a href="http://passover.blog.51cto.com/2431658/o" title="察看passover所有原创文章" target="_blank">原创</a>:94<a href="http://passover.blog.51cto.com/2431658/t" title="察看passover所有翻译文章" target="_blank">翻译</a>:2<a href="http://passover.blog.51cto.com/2431658/c" title="察看passover所有转载文章" target="_blank">转载</a>:21</p>
<p><a href="http://passover.blog.51cto.com/" target="_blank">博 客</a>|<a href="http://passover.blog.51cto.com/pic/" target="_blank">图库</a>|<a href="http://passover.blog.51cto.com/addblog.php" target="_blank">写博文</a>|<a href="http://51ctoblog.blog.51cto.com/all/26414/4" target="_blank">帮 助</a></p>
<ul>
<li><a href="http://passover.blog.51cto.com/#" target="_blank">首页</a>|</li>
<li><a href="http://passover.blog.51cto.com/2431658/d-1" target="_blank">Java</a>|</li>
<li><a href="http://passover.blog.51cto.com/2431658/d-15" target="_blank">Game</a>|</li>
<li><a href="http://passover.blog.51cto.com/2431658/d-11" target="_blank">Open Source</a>|</li>
<li><a href="http://passover.blog.51cto.com/2431658/d-5" target="_blank">Design</a>|</li>
<li><a href="http://passover.blog.51cto.com/2431658/d-4" target="_blank">Agile</a>|</li>
<li><a href="http://passover.blog.51cto.com/2431658/d-9" target="_blank">Manage</a>|</li>
<li><a href="http://passover.blog.51cto.com/2431658/d-7" target="_blank">Linux</a>|</li>
<li><a href="http://passover.blog.51cto.com/2431658/d-6" target="_blank">Database</a>|</li>
<li><a href="http://passover.blog.51cto.com/2431658/d-16" target="_blank">Server</a>|</li>
<li><a href="http://passover.blog.51cto.com/2431658/d-13" target="_blank">Tool</a>|</li>
<li><a href="http://passover.blog.51cto.com/2431658/d-10" target="_blank">Experience</a>|</li>
<li><a href="http://passover.blog.51cto.com/2431658/d-3" target="_blank">Grails</a>|</li>
<li><a href="http://passover.blog.51cto.com/2431658/d-2" target="_blank">Scala</a>|</li>
<li><a href="http://passover.blog.51cto.com/2431658/d-14" target="_blank">Other</a></li>
</ul>
<h2 id="-passover-blog"><strong>passover</strong> 的BLOG</h2>
<p><img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/avatar.php" alt=""></p>
<p><a href="http://51ctoblog.blog.51cto.com/26414/928875" target="_blank">头像升级了？来看看&gt;&gt;</a>
<a href="http://home.51cto.com/index.php?s=/space/2431658#message" target="_blank">写留言</a><a href="http://g.51cto.com/addgroup.php?uid=" target="_blank">邀请进圈子</a><a href="http://home.51cto.com/index.php?s=/Notify/write/uid/2431658" target="_blank">发消息</a> <a href="http://passover.blog.51cto.com/" target="_blank">加友情链接</a><a href="http://home.51cto.com/index.php?s=/space/2431658" target="_blank">进家园 加好友</a></p>
<h2 id="-">博客统计信息</h2>
<p><a href="http://blog.51cto.com/blogcommend" target="_blank"><strong>51CTO推荐博客</strong></a>
用户名：passover
文章数：117
评论数：174
访问量：162194
无忧币：1682
<a href="http://51ctoblog.blog.51cto.com/26414/5591" target="_blank">博客积分</a>：2780
<a href="http://51ctoblog.blog.51cto.com/26414/5591" target="_blank">博客等级</a>：7
注册日期：2010-11-16
<a href="http://blog.51cto.com/active/no1/ing.html" target="_blank">距离博客No.1争夺赛结束还有 10 天</a></p>
<h2 id="-">热门文章</h2>
<ul>
<li><a href="http://passover.blog.51cto.com/2431658/531075" target="_blank">按能力发薪酬？还是按贡..</a></li>
<li><a href="http://passover.blog.51cto.com/2431658/484673" target="_blank">利用Jsoup解析HTML</a></li>
<li><a href="http://passover.blog.51cto.com/2431658/648182" target="_blank">利用nginx+tomcat+memcac..</a></li>
<li><a href="http://passover.blog.51cto.com/2431658/517931" target="_blank">初试超轻量级actor框架—..</a></li>
<li><a href="">基于EHCache实现缓存去重</a></li>
<li><a href="http://passover.blog.51cto.com/2431658/568972" target="_blank">SolrJ学习的一点总结</a></li>
<li><a href="http://passover.blog.51cto.com/2431658/502232" target="_blank">代理IP自动切换的方法</a></li>
<li><a href="http://passover.blog.51cto.com/2431658/803094" target="_blank">Java游戏引擎libgdx的简介</a></li>
</ul>
<h2 id="-blog-">搜索BLOG文章</h2>
<h2 id="-2-http-passover-blog-51cto-com-mygroup-php-">我的技术圈(<a href="http://passover.blog.51cto.com/mygroup.php" target="_blank"><strong>2</strong></a>)</h2>
<p><a href="http://home.51cto.com/apps/group/index.php?s=/Index/index/" target="_blank">更多&gt;&gt;</a></p>
<ul>
<li><a href="http://g.51cto.com/soa" target="_blank">SOA讨论与实践</a>  </li>
<li><a href="http://g.51cto.com/scala" target="_blank">Scala</a>  </li>
</ul>
<h2 id="-">最近访客</h2>
<ul>
<li><a href="http://5985626.blog.51cto.com/" target="_blank"><img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/avatar(1" alt="">.php)</a></li>
</ul>
<p><a href="http://5985626.blog.51cto.com/" target="_blank">yyxxxn</a></p>
<ul>
<li><a href="http://vnet111.blog.51cto.com/" target="_blank"><img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/avatar(2" alt="">.php)</a></li>
</ul>
<p><a href="http://vnet111.blog.51cto.com/" target="_blank">vnet111</a></p>
<ul>
<li><a href="http://tntdba.blog.51cto.com/" target="_blank"><img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/avatar(3" alt="">.php)</a></li>
</ul>
<p><a href="http://tntdba.blog.51cto.com/" target="_blank">vbbb625</a></p>
<ul>
<li><a href="http://2739597.blog.51cto.com/" target="_blank"><img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/avatar(4" alt="">.php)</a></li>
</ul>
<p><a href="http://2739597.blog.51cto.com/" target="_blank">naxxmm</a></p>
<ul>
<li><a href="http://2951265.blog.51cto.com/" target="_blank"><img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/avatar(5" alt="">.php)</a></li>
</ul>
<p><a href="http://2951265.blog.51cto.com/" target="_blank">mumab..</a></p>
<ul>
<li><a href="http://4733437.blog.51cto.com/" target="_blank"><img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/avatar(6" alt="">.php)</a></li>
</ul>
<p><a href="http://4733437.blog.51cto.com/" target="_blank">wangj..</a></p>
<ul>
<li><a href="http://1711891.blog.51cto.com/" target="_blank"><img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/avatar(7" alt="">.php)</a></li>
</ul>
<p><a href="http://1711891.blog.51cto.com/" target="_blank">hjdon..</a></p>
<ul>
<li><a href="http://5920597.blog.51cto.com/" target="_blank"><img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/avatar(8" alt="">.php)</a></li>
</ul>
<p><a href="http://5920597.blog.51cto.com/" target="_blank">睡着了</a></p>
<ul>
<li><a href="http://fallenleaves.blog.51cto.com/" target="_blank"><img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/avatar(9" alt="">.php)</a></li>
</ul>
<p><a href="http://fallenleaves.blog.51cto.com/" target="_blank">李惟忠</a></p>
<ul>
<li><a href="http://2798724.blog.51cto.com/" target="_blank"><img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/avatar(10" alt="">.php)</a></li>
</ul>
<p><a href="http://2798724.blog.51cto.com/" target="_blank">李大玉</a></p>
<ul>
<li><a href="http://51ctohome.blog.51cto.com/" target="_blank"><img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/avatar(11" alt="">.php)</a></li>
</ul>
<p><a href="http://51ctohome.blog.51cto.com/" target="_blank">51cto..</a></p>
<ul>
<li><a href="http://glories.blog.51cto.com/" target="_blank"><img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/avatar(12" alt="">.php)</a></li>
</ul>
<p><a href="http://glories.blog.51cto.com/" target="_blank">glories</a></p>
<h2 id="-">最新评论</h2>
<ul>
<li><a href="http://bbaobelief.blog.51cto.com/" target="_blank"><strong>bbaobelief</strong></a>：<a href="http://passover.blog.51cto.com/2431658/578817" target="_blank">你们是window啊，360修复一些漏洞，..</a></li>
<li><a href="http://aquarius.blog.51cto.com/" target="_blank"><strong>Aquarius_</strong></a>：<a href="http://passover.blog.51cto.com/2431658/1004429" target="_blank">呵呵，感谢博主分享了</a></li>
<li>[匿名]aaaa：<a href="http://passover.blog.51cto.com/2431658/648182" target="_blank">极其的不靠谱，配置起访问一直报400</a></li>
<li><a href="http://passover.blog.51cto.com/" target="_blank"><strong>passover</strong></a>：<a href="http://passover.blog.51cto.com/2431658/836918" target="_blank">回复 whocares: pm管理员就能拿到..</a></li>
<li>[匿名]whocares：<a href="http://passover.blog.51cto.com/2431658/836918" target="_blank">没有邀请码，等了半年都拿不到，郁闷啊</a></li>
<li>[匿名]33：<a href="http://passover.blog.51cto.com/2431658/487411" target="_blank">3333发达省份是地方</a></li>
</ul>
<h2 id="51cto-">51CTO推荐博文</h2>
<p><a href="http://blog.51cto.com/artcommend" target="_blank">更多&gt;&gt;</a></p>
<ul>
<li><a href="http://johnchina.blog.51cto.com/4390273/1017894" title="RSA加密解密相关 前端js加密，服务端java解密" target="_blank">RSA加密解密相关 前端js加密，服..</a></li>
<li><a href="http://mrwlh.blog.51cto.com/2238823/1017728" title="struts2.0中struts.xml配置文件详解 " target="_blank">struts2.0中struts.xml配置文件详解</a></li>
<li><a href="http://wzk89.blog.51cto.com/1660752/1017949" title="快速构建Windows 8风格应用16-SettingContract原理及构建" target="_blank">快速构建Windows 8风格应用16-Set..</a></li>
<li><a href="http://2745881.blog.51cto.com/2735881/1017921" title="如何处理ORA-00376错误的恢复问题" target="_blank">如何处理ORA-00376错误的恢复问题</a></li>
<li><a href="http://woshixy.blog.51cto.com/5637578/1018125" title="ajax效果模拟——隐藏的iframe无刷新效果" target="_blank">ajax效果模拟——隐藏的iframe无..</a></li>
<li><a href="http://zhanfeng.blog.51cto.com/6109904/1018081" title="用javascript做的一个简单的乒乓球游戏" target="_blank">用javascript做的一个简单的乒乓..</a></li>
<li><a href="http://virusswb.blog.51cto.com/115214/1019513" title="Rails开发细节《五》Migrations 数据迁移" target="_blank">Rails开发细节《五》Migrations ..</a></li>
<li><a href="http://yisuowushinian.blog.51cto.com/4241271/1016527" title="SQLServer存储过程和ADO.NET访问存储过程" target="_blank">SQLServer存储过程和ADO.NET访问..</a></li>
<li><a href="http://wzk89.blog.51cto.com/1660752/1017700" title="快速构建Windows 8风格应用15-ShareContract构建" target="_blank">快速构建Windows 8风格应用15-Sha..</a></li>
<li><a href="http://yisuowushinian.blog.51cto.com/4241271/1016524" title="网络工作室暑假后第二次培训资料（SQLServer存储过程和ADO.NET访问存储过程）整理（一）" target="_blank">网络工作室暑假后第二次培训资料..</a></li>
<li><p><a href="http://legend2011.blog.51cto.com/3018495/1015003" title="MyBatis多参数传递之注解方式示例" target="_blank">MyBatis多参数传递之注解方式示例</a></p>
<h2 id="-">友情链接</h2>
</li>
<li><p><a href="http://51ctoblog.blog.51cto.com/" title="51CTO博客开发" target="_blank">51CTO博客开发</a> <img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/tubiao3.gif" alt="本周内更新"></p>
</li>
</ul>
<p><a href="http://51ctomvp.blog.51cto.com/192695/1019865" target="_blank">2012年10月MVP名单公布啦！</a><a href="http://blog.51cto.com/newsletter/175/" target="_blank">周刊：从需求看《IT人员应聘建议》</a><a href="http://doctor.51cto.com/develop-271.html" target="_blank">【有奖门诊】探索式测试的奥秘</a></p>
<p><a href="http://passover.blog.51cto.com/all/2431658" target="_blank">博主的更多文章&gt;&gt;</a></p>
<p><a href="http://blog.51cto.com/artcommend" target="_blank"><img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/tj.png" alt=""></a></p>
<p><img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/artType01.jpg" alt=""> 基于EHCache实现缓存去重 2011-01-27 16:15:10
标签：<a href="http://blog.51cto.com/tagindex.php?keyword=%BB%BA%B4%E6" target="_blank">缓存</a> <a href="http://blog.51cto.com/tagindex.php?keyword=%D6%B0%B3%A1" target="_blank">职场</a> <a href="http://blog.51cto.com/tagindex.php?keyword=%D0%DD%CF%D0" target="_blank">休闲</a> <a href="http://blog.51cto.com/tagindex.php?keyword=ehcache" target="_blank">ehcache</a></p>
<pre><code> 由于近期的工作主要集中在数据处理上，而性能问题时而暴露出来，我对需要处理的数据进行了一下简单的分析，发现存在大量的重复数据，这自然让我想到了去建立一个二级缓存把曾经处理过的数据缓存起来，避免重复处理。我们业务上其实就是对最近处理过的数据重复出现几率比较高，所以有一个几百兆的内存空间用LRU的策略进行去重应该就足够了。

其实可以选择的方案有很多，初步筛选了一下，我决定在对Java支持度比较好且应用广泛的OSCache和EHCache中选一个。上了官网一查，发现OSCache在几年前就停止更新了，而EHCache则一直有公司在维护，所以自然选定了后者。官方文档的地址是[http://www.ehcache.org/documentation/index.html](http://www.ehcache.org/documentation/index.html)。

先让同事研究了一下，弄的是1.7.0的版本，这个版本比较好的是对其他包的依赖很少，很快就把自己的demo建立起来了。然后上官网下载了最新的版本ehcache-core-2.3.1-distribution，里面其实就多了两个slf4j的包，原来的代码一行没动就可以运行起来了。这里新版本加入的内容比较多，jar包就是1.7.0的3倍大，看了下官方文档的说明，主要加入的就是对分布式的支持，当然还有很多新特性。新特性以后慢慢研究吧，我目前也用不到什么高级功能，既然新版本使用起来也很方便，那就用这个好了。

这里简单解释一下，我们原先想试一下他提供的FIFO和LRU的策略，结果刚开始测试输出的结果和预期居然不一致，官方文档上也没看到相应的解释。经过反复测试，感觉他不是严格按照这个策略来，可能是算法有些问题吧。

另外补充一下参数设置的经验。
</code></pre><ol>
<li>对于存储对象个数的设置：由于配置文件中只能指定maxElementsInMemory，这就会有可能存入的对象太多而超出VM的heap大小，当然你可以通过jvm参数增大heap大小，但这总还是有可能溢出。这里可以把maxElementsInMemory值设置到一个比较安全的大小，自己预先测试一下最好。如果内存仍然存不下你需要存的对象个数，那么可以开启overflowToDisk来增加可以存储的Element个数。这里要注意一下，EHCache不会自动帮助你去把内存对象写入到磁盘，当超过maxElementsInMemory程序会自动把更多的部分开始往硬盘写，但是内存的对象其实并没有清出去，这时需要手动使用Cache.flush()方法来把内存对象清出去。 对于是否需要用磁盘扩充缓存，这个还是根据自己应用判断。</li>
<li>重建上一次运行的缓存：这个需求肯定比较普遍，我们当然不希望一旦程序退出，整个缓存就要重建了。开启diskPersistent功能，只要使用的是CacheManager单例模式，下一次启动的时候就会调用上一次运行的缓存。比较麻烦的是写入磁盘的时间还是要自己调用 Cache.flush()方法。如果仅仅考虑到程序重启的话，我建议这里把diskStore写入到一个ramfs，这样性能就更高了，但重启电脑的话就不得不重建缓存了。</li>
<li>索引的建立：如果你测试的maxElementsOnDisk量比较大的话，我本地设置成100000，那么你会在临时文件目录下看到有index文件，这个文件显然是对磁盘上的文件建立索引，加快查询速度。所以这个索引是否建立是EHCache自动帮你做的，你不用操心了。</li>
<li>写入缓存的速度：在本地不断调整参数，惊讶的发现有时写入缓存的速度奇慢。因为开启了 diskPersistent功能，程序运行时经常会卡在backOffIfDiskSpoolFull方法上，作用是If the disk store spool is full wait a short time to give it a chance to catch up。这个参数对应的是diskSpoolBufferSizeMB，默认是30MB，如果存储的对象比较多，强烈建议调大，或者直接把 diskPersistent关掉。</li>
<li>缓存内容写入磁盘的速度：如果你把maxElementsOnDisk参数配置的远小于maxElementsInMemory值的话，你会发现速度又变得很慢，这是因为程序一直要去找到底哪些内容应该写入磁盘。建议这 maxElementsOnDisk值的配置应该不小于 maxElementsInMemory，其实正常用应该也会这么配置，只是我测试无聊试了下出问题了。</li>
<li>内存Element数量不能控制：一旦开启了 diskPersistent，惊讶的发现居然设置的 maxElementsInMemory无效了，内存的 Element数量一直在增长。反复测试，问题稳定重现，又找不到解释，无奈之下给官方提了个bug，等答复吧，汗...</li>
</ol>
<pre><code> 这里还是给出测试代码，主要用到的就是一个ehcache.xml的配置文件，定义了Cache的具体策略。程序调用的时候非常方便，就是典型key/value的方式。
</code></pre><ol>
<li>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; </li>
<li><ehcache> </li>
<li></li>
<li><diskStore path="java.io.tmpdir" /> </li>
<li></li>
<li>&lt;defaultCache  </li>
<li>maxElementsInMemory=&quot;10000&quot;  </li>
<li>eternal=&quot;false&quot; </li>
<li>timeToIdleSeconds=&quot;120&quot;  </li>
<li>timeToLiveSeconds=&quot;120&quot;  </li>
<li>overflowToDisk=&quot;true&quot; </li>
<li>diskPersistent=&quot;false&quot;  </li>
<li>diskExpiryThreadIntervalSeconds=&quot;120&quot; </li>
<li>memoryStoreEvictionPolicy=&quot;LRU&quot;  </li>
<li>/&gt; </li>
<li></li>
<li>&lt;cache name=&quot;sample&quot;          </li>
<li>maxElementsInMemory=&quot;5&quot;   </li>
<li>maxElementsOnDisk = &quot;5&quot;  </li>
<li>eternal=&quot;false&quot;   </li>
<li>timeToIdleSeconds=&quot;1440&quot;   </li>
<li>diskPersistent=&quot;false&quot;  </li>
<li>timeToLiveSeconds=&quot;2880&quot;   </li>
<li>overflowToDisk=&quot;false&quot;  </li>
<li>memoryStoreEvictionPolicy=&quot;FIFO&quot;  </li>
<li>statistics=&quot;true&quot;  </li>
<li>/&gt; </li>
<li></li>
<li><p></ehcache> </p>
<p> 以下就是测试代码：</p>
</li>
<li><strong>package ehcache; </strong></li>
<li><hr>
</li>
<li><strong>import org.apache.log4j.Logger; </strong></li>
<li><hr>
</li>
<li><strong>import net.sf.ehcache.Cache; </strong></li>
<li><strong>import net.sf.ehcache.CacheManager; </strong></li>
<li><strong>import net.sf.ehcache.Element; </strong></li>
<li><hr>
</li>
<li><strong>public class EhcacheTest { </strong></li>
<li><hr>
</li>
<li><strong>    private static final Logger logger = Logger.getLogger(EhcacheTest.class); </strong></li>
<li><hr>
</li>
<li><strong>    private static Cache sampleCache = null; </strong></li>
<li><hr>
</li>
<li><strong>    public static void main(String[] args) { </strong></li>
<li><strong>        init(); </strong></li>
<li><strong>        test(); </strong></li>
<li><strong>    } </strong></li>
<li><hr>
</li>
<li><strong>    private static void test() { </strong></li>
<li><strong>        logger.info(sampleCache.getMemoryStoreEvictionPolicy()); </strong></li>
<li><strong>        for(int i=0; i&lt;10; i++){ </strong></li>
<li><strong>            //写入缓存 </strong></li>
<li><strong>            sampleCache.put(new Element(i, &quot;v&quot; + i)); </strong></li>
<li><strong>            //打印当前缓存的所有值 </strong></li>
<li><strong>            logger.info(sampleCache.getKeys()); </strong></li>
<li><strong>            //读取缓存 </strong></li>
<li><strong>            Element e = sampleCache.get(i); </strong></li>
<li><strong>            logger.info(e.getValue()); </strong></li>
<li><strong>        } </strong></li>
<li><strong>        //打印命中统计 </strong></li>
<li><strong>        logger.info(sampleCache.getStatistics()); </strong></li>
<li><strong>    } </strong></li>
<li><hr>
</li>
<li><strong>    private static void init() { </strong></li>
<li><strong>        CacheManager manager = CacheManager.create(); </strong></li>
<li><strong>//      manager.addCache(&quot;sample&quot;); //已经在配置文件定义过了 </strong></li>
<li><strong>        sampleCache = manager.getCache(&quot;sample&quot;); 
</strong></li>
<li><strong>    } </strong></li>
<li><hr>
</li>
<li><strong>} </strong></li>
</ol>
<p><img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/ssk.png" alt="分享至"> <a href="http://passover.blog.51cto.com/#" title="分享到新浪微博" target="_blank"></a> <a href="http://passover.blog.51cto.com/#" title="分享到QQ空间"></a> <a href="http://passover.blog.51cto.com/#" title="分享到腾讯微博" target="_blank"></a> <a href="http://passover.blog.51cto.com/#" title="分享到百度搜藏"></a> <a href="http://passover.blog.51cto.com/#" title="分享到人人网" target="_blank"></a> <a href="http://passover.blog.51cto.com/#" title="分享到QQ收藏"></a> <a href="http://passover.blog.51cto.com/#" title="分享到豆瓣网" target="_blank"></a> <a href="http://passover.blog.51cto.com/#" title="分享到百度空间"></a> <a href="http://passover.blog.51cto.com/#" title="分享到MSN" target="_blank"></a> ** 更多 <a href="http://passover.blog.51cto.com/#" title="累计分享0次">0</a> <a href="&quot;一键收藏，随时查看，分享好友！&quot;"><img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/favorite_add_small.gif" alt="一键收藏，随时查看，分享好友！"></a></p>
<p><img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/icon01.png" alt=""> <a href="">姜周、倔强的土豆</a> 2人 了这篇文章</p>
<p>类别：<a href="http://passover.blog.51cto.com/2431658/d-11" target="_blank">Open Source</a>┆<a href="">技术圈</a>(0)┆阅读(3391)┆评论(2) ┆ <a href="http://passover.blog.51cto.com/#" target="_blank">推送到技术圈</a>┆<a href="http://passover.blog.51cto.com/" target="_blank">返回首页</a>
上一篇 <a href="http://passover.blog.51cto.com/2431658/484673" title="利用Jsoup解析HTML" target="_blank">利用Jsoup解析HTML</a> 下一篇 <a href="http://passover.blog.51cto.com/2431658/487411" title="初试Redis的感受" target="_blank">初试Redis的感受</a></p>
<h2 id="-">相关文章</h2>
<ul>
<li><a href="http://wujuxiang.blog.51cto.com/2250829/422377" title="EhCache构建Hibernate二级缓存" target="_blank">EhCache构建Hibernate二级缓存</a></li>
<li><a href="http://kerry.blog.51cto.com/172631/402923" title="CentOS 5.5环境下安装配置Varnish" target="_blank">CentOS 5.5环境下安装配置Varnish</a></li>
<li><a href="http://sdbaby.blog.51cto.com/149645/303987" title="如何删除系统漏洞修复的缓存文件夹" target="_blank">如何删除系统漏洞修复的缓存文件夹</a></li>
<li><a href="http://8807131.blog.51cto.com/2425232/435135" title="网站性能优化之应用程序缓存-初篇" target="_blank">网站性能优化之应用程序缓存-初篇</a></li>
<li><a href="http://rickyfang.blog.51cto.com/1213/130032" title="域账号缓存登陆的故障排除一例" target="_blank">域账号缓存登陆的故障排除一例</a></li>
<li><a href="http://yueyuanyuan.blog.51cto.com/1342062/337873" title="ASP.NET数据缓存" target="_blank">ASP.NET数据缓存</a>
<a href=""></a></li>
</ul>
<h2 id="-">文章评论</h2>
<p> <a href=""></a></p>
<p>[1楼]    <img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/reply.gif" alt="">  <a href="http://jiangzhou.blog.51cto.com/" target="_blank"><strong>姜周</strong></a> <a href="http://passover.blog.51cto.com/#" target="_blank">回复</a></p>
<p>2011-01-28 14:44:20
支持一个！
<a href=""></a></p>
<p>[2楼]    <img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/reply.gif" alt="">  <a href="http://juejiangdetudou.blog.51cto.com/" target="_blank"><strong>倔强的土豆</strong></a> <a href="http://passover.blog.51cto.com/#" target="_blank">回复</a></p>
<p>2012-08-24 17:55:22
不错，顶了。</p>
<p> <a href=""></a></p>
<p><a href=""></a></p>
<h2 id="-">发表评论</h2>
<p><a href="http://51ctomvp.blog.51cto.com/192695/1019565" target="_blank">2013年1月MVP申请公告[截止10月15日]</a>
昵  称： <a href="http://home.51cto.com/index.php?reback=http%253A%252F%252Fpassover.blog.51cto.com%252F2431658%252F486709" target="_blank">登录</a>  <a href="http://ucenter.51cto.com/reg_01.php?reback=http://blog.51cto.com" target="_blank">快速注册</a> 验证码： <img src="" alt=""></p>
<p>点击图片可刷新验证码请点击后输入验证码<a href="http://51ctoblog.blog.51cto.com/26414/5591" target="_blank">博客过2级，无需填写验证码</a> 内  容：</p>
<p>同时赞一个
返回顶部</p>
<p>Copyright By 51CTO.COM 版权所有
<a href="http://blog.51cto.com/" target="_blank"><img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/copyright.jpg" alt=""></a>
<a href="http://www.cnzz.com/stat/website.php?web_id=4274540" title="站长统计" target="_blank"><img src="http://./基于EHCache实现缓存去重 - passover【毕成功的博客】 - 51CTO技术博客_files/pic.gif" alt=""></a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/缓存/">缓存</a></li></span><span class="breadcrumb"><li><a href="/categories/缓存/">缓存</a></li><li><a href="/categories/缓存/ehcache/">ehcache</a></li></span></span> | <span class="tags">Tagged <a href="/tags/ehcache/" class="label label-primary">ehcache</a><a href="/tags/缓存/" class="label label-success">缓存</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:39"datetime="2014-03-07 09:54:39"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-缓存-ehcache--基于EHCache实现缓存去重-passover【毕成功的博客】-51CTO技术博客/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-缓存-ehcache--基于EHCache实现缓存去重-passover【毕成功的博客】-51CTO技术博客" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-缓存-ehcache--是使用分布式缓存Ehcache或者NoSQL数据库呢？-ThinkingInJdon/">是使用分布式缓存Ehcache或者NoSQL数据库呢？ </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:39.000Z"> <a href="/2014/02/02/2014-02-02-缓存-ehcache--是使用分布式缓存Ehcache或者NoSQL数据库呢？-ThinkingInJdon/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-ehcache-nosql-thinking-in-jdon">是使用分布式缓存Ehcache或者NoSQL数据库呢？ - Thinking In Jdon</h1>
<p> 标签的主题列表  <a href="http://www.jdon.com/tags/313" target="_blank"><strong>缓存Cache</strong>     </a><a href="http://www.jdon.com/account/protected/sub/subAction.shtml?subscribeType=2&amp;subscribeId=313" target="_blank"><img src="" alt="关注本标签 有新回复自动通知我"> 关注</a> <img src="" alt=""><a href="http://www.jdon.com/44212" title="通过cache来发挥同步与异步的优势" target="_blank">通过cache来发挥同步与异步的优势</a> <img src="" alt=""><a href="http://www.jdon.com/44161" title="关于CQRS中，对于一个领域对象的lock" target="_blank">关于CQRS中，对于一个领域对象的lock</a> <img src="" alt=""><a href="http://www.jdon.com/44132" title="JVM堆大小的建议" target="_blank">JVM堆大小的建议</a> <img src="" alt=""><a href="http://www.jdon.com/43889" title="关于牛XX的内存领域+事件驱动的问题！！！" target="_blank">关于牛XX的内存领域+事件驱动的问题！！！</a> <img src="" alt=""><a href="http://www.jdon.com/43818" title="Stack Overflow:memcached和Redis的比较" target="_blank">Stack Overflow:memcached和Redis的比较</a> <img src="" alt=""><a href="http://www.jdon.com/43802" title="海量数据的查询缓存问题" target="_blank">海量数据的查询缓存问题</a> <img src="" alt=""><a href="http://www.jdon.com/43760" title="为Domain寻求一种缓存" target="_blank">为Domain寻求一种缓存</a> <img src="" alt=""><a href="http://www.jdon.com/43743" title="突破JVM内存：开源DirectMemory" target="_blank">突破JVM内存：开源DirectMemory</a> <img src="" alt=""><a href="http://www.jdon.com/43724" title="数据网格 Data Grid和NoSQL相同和区别-异同" target="_blank">数据网格 Data Grid和NoSQL相同和区别-异同</a> <img src="" alt=""><a href="http://www.jdon.com/43717" title="高并发开发？？" target="_blank">高并发开发？？</a> <img src="" alt=""><a href="http://www.jdon.com/43246" title="弱一致性在现实世界中到处存在" target="_blank">弱一致性在现实世界中到处存在</a> <img src="" alt=""><a href="http://www.jdon.com/43156" title="一个常见但不是那么容易的架构问题" target="_blank">一个常见但不是那么容易的架构问题</a> <img src="" alt=""><a href="http://www.jdon.com/43067" title="如何处理频繁创建对象然后丢弃导致频繁GC的情况" target="_blank">如何处理频繁创建对象然后丢弃导致频繁GC的情况</a> <img src="" alt=""><a href="http://www.jdon.com/42736" title="使用ehcache元注释提高Spring 性能源码案例" target="_blank">使用ehcache元注释提高Spring 性能源码案例</a> <img src="" alt=""><a href="http://www.jdon.com/42661" title="SNS Webgame 社区类页面网游开发， 自己所用的架构，以及遇到的一些问题和困惑" target="_blank">SNS Webgame 社区类页面网游开发， 自己所用的架构，以及遇到的一些问题和困惑</a> <img src="" alt=""><a href="http://www.jdon.com/42451" title="JVM伪共享" target="_blank">JVM伪共享</a> <img src="" alt=""><a href="http://www.jdon.com/42438" title="数据管理的未来: “Disk-less” 风格数据库?" target="_blank">数据管理的未来: “Disk-less” 风格数据库?</a> <img src="" alt=""><a href="http://www.jdon.com/42361" title="亚马逊的弹性缓存" target="_blank">亚马逊的弹性缓存</a> <img src="" alt=""><a href="http://www.jdon.com/41686" title="如何驯服java GC导致暂停? 使用16GiB以上heap" target="_blank">如何驯服java GC导致暂停? 使用16GiB以上heap</a> <img src="" alt=""><a href="http://www.jdon.com/41612" title="使用设计模式后的副作用" target="_blank">使用设计模式后的副作用</a></p>
<h3 id="-">分享到</h3>
<ul>
<li><a href="http://www.jdon.com/39931#" target="_blank">QQ空间</a></li>
<li><a href="http://www.jdon.com/39931#" target="_blank">新浪微博</a></li>
<li><a href="http://www.jdon.com/39931#" target="_blank">百度搜藏</a></li>
<li><a href="http://www.jdon.com/39931#" target="_blank">人人网</a></li>
<li><a href="http://www.jdon.com/39931#" target="_blank">腾讯微博</a></li>
<li><a href="http://www.jdon.com/39931#" target="_blank">开心网</a></li>
<li><a href="http://www.jdon.com/39931#" target="_blank">腾讯朋友</a></li>
<li><a href="http://www.jdon.com/39931#" target="_blank">百度空间</a></li>
<li><a href="http://www.jdon.com/39931#" target="_blank">豆瓣网</a></li>
<li><a href="http://www.jdon.com/39931#" target="_blank">搜狐微博</a></li>
<li><a href="http://www.jdon.com/39931#" target="_blank">百度新首页</a></li>
<li><a href="http://www.jdon.com/39931#" target="_blank">QQ收藏</a></li>
<li><a href="http://www.jdon.com/39931#" target="_blank">和讯微博</a></li>
<li><a href="http://www.jdon.com/39931#" target="_blank">我的淘宝</a></li>
<li><a href="http://www.jdon.com/39931#" target="_blank">百度贴吧</a></li>
<li><a href="http://www.jdon.com/39931#" target="_blank">更多...</a></li>
</ul>
<p><a href="http://www.jdon.com/39931#" target="_blank">百度分享</a>
<a href="http://www.jdon.com/" target="_blank"><img src="" alt="JiveJdon Community Forums"></a><a href="">在线</a>    <a href="http://www.jdon.com/threads" target="_blank">主题表</a>   <a href="http://www.jdon.com/tags" target="_blank">标签</a>   <a href="http://www.jdon.com/query/threadViewQuery.shtml" target="_blank">查搜</a>   <a href="http://www.jdon.com/account/newAccountForm.shtml" target="_blank">注册</a>   <a href="">登陆</a>   <a href="http://www.jdon.com/forum/post.jsp" target="_blank">发帖</a>   <a href="http://www.jdon.com/followus.html" target="_blank">关注</a>   <a href="http://www.jdon.com/designpatterns/" target="_blank">设计模式</a> <a href="http://www.jdon.com/ddd.html" target="_blank">领域驱动设计</a> <a href="http://www.jdon.com/design.htm" target="_blank">云架构</a> <a href="http://www.jdon.com/jdonframework/jivejdon3/index.html" target="_blank">JiveJdon</a> <a href="http://www.jdon.com/jdonframework/" target="_blank">Jdon框架</a> <a href="http://www.jdon.com/consultant.html" target="_blank">企业咨询</a> <a href="http://www.jdon.com/threads" target="_blank">主题讨论</a></p>
<p>  用户      自动登陆 密码      <a href="http://www.jdon.com/account/newAccountForm.shtml" target="_blank">新用户注册</a> <a href="http://www.jdon.com/account/forgetPasswd.jsp" target="_blank">忘记密码?</a> <a href="http://www.jdon.com/account/oauth/sinaCallAction.shtml" target="_blank"><img src="" alt="登录">新浪微博</a> <a href="http://www.jdon.com/account/oauth/tecentCallAction.shtml" target="_blank"><img src="" alt="登录">腾讯微博</a> <a href="http://www.jdon.com/account/oauth/googleCallAction.shtml" target="_blank"><img src="" alt="登录">Google</a>
<strong><a href="http://www.jdon.com/" target="_blank">首页</a> » <a href="http://www.jdon.com/forum/" title="返回论坛列表" target="_blank">论坛</a> » <a href="http://www.jdon.com/forum/121" target="_blank">云架构等扩展性讨论</a></strong> <img src="" alt=""> <a href="&quot;网上收藏本主题&quot;">  </a></p>
<p><a href="&quot;手机条码扫描浏览本页&quot;">  </a>
<a href="http://www.jdon.com/account/protected/sub/subAction.shtml?subscribeType=1&amp;subscribeId=39931" title="关注本主题" target="_blank">  </a></p>
<p><a href="&quot;加入本帖到收藏夹&quot;">  </a></p>
<p>阅读3831次 1人关注</p>
<p>前往下页:
  <a href="http://www.jdon.com/message/messageAction.shtml?forum.forumId=121" target="_blank"><img src="" alt="发表新帖子"></a>  <a href=""><img src="" alt="回复该主题贴"></a> <a href=""></a></p>
<p><strong>banq</strong>
<a href="http://www.jdon.com/blog/banq"><img src="" alt="">
个人详介按这里
</a> <a href="http://www.jdon.com/query/threadViewQuery.shtml?queryType=userMessageQueryAction&amp;user=2" target="_blank">文章: 12593</a>
注册: 2002-08-03</p>
<ul>
<li>当前离线</li>
<li><a href="http://www.jdon.com/account/protected/sub/subAction.shtml?subscribeType=3&amp;subscribeId=2" title="我要关注该作者发言" target="_blank">184人关注</a></li>
<li><a href="">悄悄话</a></li>
<li><a href="http://www.jdon.com/profile.jsp?user=banq" target="_blank">个人博客</a></li>
</ul>
<p>是使用分布式缓存Ehcache或者NoSQL数据库呢？</p>
<p>2011-03-03 10:31
<a href="&quot;到本帖网址&quot;">  </a>  <a href="">  </a>  <a href="">  </a></p>
<p><a href="http://www.jdon.com/query/tagsList.shtml?count=150" title="标签" target="_blank"><img src="" alt="标签"></a> <a href="http://www.jdon.com/tags/313" target="_blank">缓存Cache</a>        <a href="http://www.jdon.com/tags/8600" target="_blank">NoSQL</a>        <a href="http://www.jdon.com/tags/1103" target="_blank">ehcache</a>        <a href="http://www.jdon.com/tags/2513" target="_blank">可扩展性Scalable</a><br>10</p>
<p><a href="">顶一下</a></p>
<h1 id="ehcache-java-http-www-jdon-com-cache-html-http-www-jdon-com-scalable-html-terracotta-ehcache-http-www-jdon-com-cache-html-schema-less-key-value-java-http-www-jdon-com-cache-html-key-value-">Ehcache实际是一个Java的开源<a href="http://www.jdon.com/cache.html" target="_blank"><strong>缓存</strong></a>产品，用来提升性能，降低负载，方便可<a href="http://www.jdon.com/scalable.html" target="_blank"><strong>伸缩性</strong></a>。后面有秦始皇Terracotta兵马俑式的服务器矩阵支持, Ehcache成为一种线性可扩展的分布式<a href="http://www.jdon.com/cache.html" target="_blank"><strong>缓存</strong></a>。它是一个无关系结构schema-less, key-value, 基于Java的分布式<a href="http://www.jdon.com/cache.html" target="_blank"><strong>缓存</strong></a>，它提供可靠的一致性控制，可根据主键key 值value或属性索引搜索。</h1>
<p><strong>Flexible Consistency可靠的一致性</strong>
从Ehcache 和 Terracotta整合性来看, 我们可以激活相关的数据跨集群共享，按照CAP理论来说， 由于避免单机硬编码权衡考虑，我们在一个个<a href="http://www.jdon.com/cache.html" target="_blank"><strong>缓存</strong></a>中创建了一个丰富的一致性模型；同时为了易于理解，我们采取统一标准客户端一致性模型来描述和配置它。
我们可以实现一个比<a href="http://www.jdon.com/DistributedSystems.html" target="_blank"><strong>NoSQL</strong></a>解决方案更加丰富的一致性富模型(模型驱动框架开源<a href="http://www.jdon.com/jdonframework/" target="_blank"><strong>Jdonframework</strong></a>缺省采取echcahe的原因)。我们可以为每一个<a href="http://www.jdon.com/cache.html" target="_blank"><strong>缓存</strong></a>提供跨集群的如下特性:
1.通过悲观锁支持强壮的一致性(缺省，一致性也就是<a href="http://www.jdon.com/jivejdon/tags/354" target="_blank"><strong>事务</strong></a>性，数据<a href="http://www.jdon.com/jivejdon/tags/354" target="_blank"><strong>事务</strong></a>安全性)
2.未加锁的弱一致性，用来先写后读，或只读，或者只写。
3.乐观锁 Compare and Swap (“CAS”)，跨集群服务器的原子操作 。
4.XA分布式<a href="http://www.jdon.com/jivejdon/tags/354" target="_blank"><strong>事务</strong></a>和本地<a href="http://www.jdon.com/jivejdon/tags/354" target="_blank"><strong>事务</strong></a>机制transactions
5.一个显式的锁API，可以运行用户优化<a href="http://www.jdon.com/jivejdon/tags/354" target="_blank"><strong>事务</strong></a>一致性带来的性能问题。
Ehcache架构非常不同于<a href="http://www.jdon.com/DistributedSystems.html" target="_blank"><strong>NoSQL</strong></a>(如memorycache ). 每个服务器内存中会驻留使用最频繁(LRU算法)的数据或对象。可以有4-6 GB heap 空间, 如果辅助以BigMemory, 能够扩展至上百 GBs(注意这是每台，如果考虑集群多台，几乎可以把数据库中数据都加载到内存中，相当于一个内存数据库). 这是一种Level 1 (“L1”) <a href="http://www.jdon.com/cache.html" target="_blank"><strong>缓存</strong></a>，完全基于内存in-process. 访问L1 速度一般少于1 μs.
整个<a href="http://www.jdon.com/cache.html" target="_blank"><strong>缓存</strong></a>一般都驻扎Terracotta服务器阵列中. 这是一种Level 2 (“L2”) <a href="http://www.jdon.com/cache.html" target="_blank"><strong>缓存</strong></a>. 访问L2少于2 ms.
你从这个架构中得到的依赖于你使用经验，最普通一个情况是：the Pareto distribution, 80% 数据从 L1获得 , 20%时间从L2获得， 这样，普通延迟性一般是少于.401 ms. 通过比较，Yahoo! Cloud Serving Benchmark 基准测试表明 HBase 和 Cassandra延迟性是在 8 to 18 ms.
这使得Ehcache要快于<a href="http://www.jdon.com/DistributedSystems.html" target="_blank"><strong>NoSQL</strong></a>一个数量级别.
<strong>持久化</strong>
缓存能够被设置为持久化，能够提供永久保存和可重启性。一般使用一种写日志。缓存将能够恢复到一种一致性状态. 当ehcache被配置为一种分布式<a href="http://www.jdon.com/cache.html" target="_blank"><strong>缓存</strong></a>时，Ehcache将使用Terracotta Server Array 作为二级<a href="http://www.jdon.com/cache.html" target="_blank"><strong>缓存</strong></a>Level 2 cache. Terracotta servers通常是每个区配置两个，有HA. 另外，Terracotta 使用JMX tools实现备份,备份或恢复都能立即进行。 RDBMS关系数据库典型提供一个广泛归档索引 ETL等系列功能, 正因为这些理由，作者认为 Ehcache具有一些持久化小特性. 当然，这和许多<a href="http://www.jdon.com/DistributedSystems.html" target="_blank"><strong>NoSQL</strong></a> 产品类似。
<strong>大数据量Big Data</strong>
大数据量指成打T级别terabytes甚至达到 petabytes.
Ehcache目前 可以达到2 TB. 以后会不断提升(banq注：集群的问题还是一个群的问题，群的规模是有上限天花板的，这和破坏了数据关系的<a href="http://www.jdon.com/DistributedSystems.html" target="_blank"><strong>NoSQL</strong></a>分布式是无法比拟的)
ehcache对大数据量的限制主要还是受制于关系数据库RDBMSs.
如果使用BigMemory，Terracotta server可以加载到每台服务器内存中有250GB或更多. <a href="http://www.jdon.com/DistributedSystems.html" target="_blank"><strong>NoSQL</strong></a> 解决方案使用内存和磁盘混合，基于Java的Cassandra问题可能是垃圾回收, 受其限制只能有很小的heaps. BigMemory 是脱离heap使用额外内存，使用NIO的 DirectByteBuffer. 最终结果你可以用很小的服务部署付出得到同样的回报。
<strong>进入分布式[</strong>缓存<strong>](<a href="http://www.jdon.com/cache.html" target="_blank">http://www.jdon.com/cache.html</a>)</strong>
如果Ehcahce不是<a href="http://www.jdon.com/DistributedSystems.html" target="_blank"><strong>NoSQL</strong></a>, 那它是什么? 答案是它是一个分布式<a href="http://www.jdon.com/cache.html" target="_blank"><strong>缓存</strong></a>distributed cache. 象它的<a href="http://www.jdon.com/DistributedSystems.html" target="_blank"><strong>NoSQL</strong></a>表兄弟, 它经常用于传统数据库不能覆盖的领域，缓存一个web page或或者耗费CPU计算是经常碰到的情况.
关键问题是要更快地访问到这些计算好的结果，这时并不是需要持久化. 在Java中最快的访问架构就是in-process caching, 通过网络作为一种in-memory cache.
Gartner 和Forrester已经对分布式<a href="http://www.jdon.com/cache.html" target="_blank"><strong>缓存</strong></a>Distributed Caching 和弹性<a href="http://www.jdon.com/cache.html" target="_blank"><strong>缓存</strong></a>Elastic Caching有一个公开定义. Gartner： “分布式<a href="http://www.jdon.com/cache.html" target="_blank"><strong>缓存</strong></a>Distributed caching平台让用户管理内存中非常大的in-memory data，以便使得关系数据库减轻负载、以及<a href="http://www.jdon.com/cloudcompute.html" target="_blank"><strong>云计算</strong></a>和云<a href="http://www.jdon.com/jivejdon/tags/354" target="_blank"><strong>事务</strong></a>处理、 以及更杰出性能的<a href="http://www.jdon.com/jivejdon/tags/354" target="_blank"><strong>事务</strong></a>处理，或复杂的事件处理以及高性能计算”.
他们也将分布式<a href="http://www.jdon.com/cache.html" target="_blank"><strong>缓存</strong></a>作为一个服务(“aPaaS”) 加入他们应用平台。
当然，我们可以在RDBMSs 和 <a href="http://www.jdon.com/DistributedSystems.html" target="_blank"><strong>NoSQL</strong></a>两者之前都使用分布式<a href="http://www.jdon.com/cache.html" target="_blank"><strong>缓存</strong></a>(因为<a href="http://www.jdon.com/jivejdon/tags/354" target="_blank"><strong>事务</strong></a>的需要)。
但是，同样<a href="http://www.jdon.com/cache.html" target="_blank"><strong>缓存</strong></a>作为分布，而需要得到一些搜索之类企业特性时，和<a href="http://www.jdon.com/DistributedSystems.html" target="_blank"><strong>NoSQL</strong></a>自己区别就非常明显。
<strong>Use Cases场景用例</strong>
如果需要一个‘key-value plus search’key-value增强式的搜索，一旦数据量超过2 TB，那么<a href="http://www.jdon.com/DistributedSystems.html" target="_blank"><strong>NoSQL</strong></a>合适。
我们看看下面一些常用ehache缓存场景：
Hibernate Caching. JDBC caching. Web caching. Collection caching.使用echcache
快速的分析结果查询
信用卡等与钱有关......见原文
<strong>结论</strong>
NoSQL是瞄准替代RDBMS, <a href="http://www.jdon.com/cache.html" target="_blank"><strong>缓存</strong></a>是瞄准低延迟和速度，可以根据CAP理论来衡量。缓存主要和应用有关，可以帮助应用脱离任何存储技术，无论是RDBMS 和 <a href="http://www.jdon.com/DistributedSystems.html" target="_blank"><strong>NoSQL</strong></a>(这点比较认同，jdonframework将<a href="http://www.jdon.com/cache.html" target="_blank"><strong>缓存</strong></a>作为领域模型的生存空间，后面可以接关系数据库或<a href="http://www.jdon.com/DistributedSystems.html" target="_blank"><strong>NoSQL</strong></a>).
原文网址被封，需要翻墙。监管带来信息闭塞以致落后在我们经常看外文资料的人来说来感受非常明显。
<a href="http://nosql.mypopescu.com/post/3585092735/ehcache-distributed-cache-or-nosql-store" target="_blank">Ehcache: Distributed Cache or</a><a href="http://www.jdon.com/DistributedSystems.html" target="_blank"><strong>NoSQL</strong></a> Store? :: myNoSQL
[该贴被banq于2011-03-03 10:33修改过]
<a href=""></a></p>
<p><strong>banq</strong>
<a href="http://www.jdon.com/blog/banq"><img src="" alt="">
个人详介按这里
</a> <a href="http://www.jdon.com/query/threadViewQuery.shtml?queryType=userMessageQueryAction&amp;user=2" target="_blank">文章: 12593</a>
注册: 2002-08-03</p>
<ul>
<li>当前离线</li>
<li><a href="http://www.jdon.com/account/protected/sub/subAction.shtml?subscribeType=3&amp;subscribeId=2" title="我要关注该作者发言" target="_blank">184人关注</a></li>
<li><a href="">悄悄话</a></li>
<li><a href="http://www.jdon.com/profile.jsp?user=banq" target="_blank">个人博客</a></li>
</ul>
<p>1楼 是使用分布式缓存Ehcache或者NoSQL数据库呢？</p>
<p>2011-03-03 12:30
<a href="http://www.jdon.com/nav/39931/23131906#23131906" title="到本帖网址" target="_blank">  </a>  <a href="">  </a>  <a href="">  </a>
<a href="">顶一下</a></p>
<h1 id="ehcache-memcached-http-www-jdon-com-jivejdon-tags-354-memcached-hash-memcached-hash-">ehcache与memcached区别是在一致性，也就是<a href="http://www.jdon.com/jivejdon/tags/354" target="_blank"><strong>事务</strong></a>性方面，memcached使用HASH算法实现负载平衡，但是集群的另外一个要素：失败恢复，也就是服务器当了，数据还在其他地方存在共享；memcached的一台服务器宕了，上面数据就丢失了，由于采取Hash环，损失有限。</h1>
<p>但是也由于没有状态数据在服务器之间共享复制，memcached对于只读性能应该比集群的更好。
上面文章主要是在基于Java的比较。</p>
<p>-
<a href=""></a></p>
<p><strong>SpeedVan</strong>
<a href="http://www.jdon.com/blog/SpeedVan"><img src="" alt="">
个人详介按这里
</a> <a href="http://www.jdon.com/query/threadViewQuery.shtml?queryType=userMessageQueryAction&amp;user=71950" target="_blank">文章: 494</a>
注册: 2010-08-24</p>
<ul>
<li>当前离线</li>
<li><a href="http://www.jdon.com/account/protected/sub/subAction.shtml?subscribeType=3&amp;subscribeId=71950" title="我要关注该作者发言" target="_blank">8人关注</a></li>
<li><a href="">悄悄话</a></li>
<li><a href="http://www.jdon.com/profile.jsp?user=SpeedVan" target="_blank">个人博客</a></li>
</ul>
<p>是使用分布式缓存Ehcache或者NoSQL数据库呢？</p>
<p>2011-03-03 21:24
<a href="http://www.jdon.com/nav/39931/23131916#23131916" title="到本帖网址" target="_blank">  </a>  <a href="">  </a>  <a href="">  </a>
<a href="">顶一下</a></p>
<h1 id="-cache-repository-web-cache-web-">我现在使用cache，只是用Repository封装后，作为单系统内存接口来使用。分布技术，有待学习呢，真是路漫漫啊。自从认识web的cache之后，就知道了一个web架构，就相当于一个游戏引擎——缓存管理是其一个核心部分。</h1>
<p><a href="http://www.jdon.com/39931#" title="分享到QQ空间" target="_blank"></a> <a href="http://www.jdon.com/39931#" title="分享到新浪微博"></a> <a href="http://www.jdon.com/39931#" title="分享到腾讯微博" target="_blank"></a> <a href="http://www.jdon.com/39931#" title="分享到人人网"></a> 更多<a href="http://www.jdon.com/query/tagsList.shtml?count=150" title="标签" target="_blank"><img src="" alt="标签"></a> <a href="http://www.jdon.com/tags/313" target="_blank">缓存Cache(171)</a>       <a href="http://www.jdon.com/tags/8600" target="_blank">NoSQL(55)</a>       <a href="http://www.jdon.com/tags/1103" target="_blank">ehcache(9)</a>       <a href="http://www.jdon.com/tags/2513" target="_blank">可扩展性Scalable(98)</a><br>推荐贴列表  <strong>置顶热贴</strong> <img src="" alt=""><a href="http://www.jdon.com/42452" title="LMAX架构" target="_blank">LMAX架构</a> [<a href="http://www.jdon.com/tags/3380" target="_blank">EDA事件驱动</a> <a href="http://www.jdon.com/tags/544" target="_blank">异步编程</a> ] <img src="" alt=""><a href="http://www.jdon.com/42708" title="五年java人的一点感悟" target="_blank">五年java人的一点感悟</a> [<a href="http://www.jdon.com/tags/619" target="_blank">软件观点</a> <a href="http://www.jdon.com/tags/514" target="_blank">工具心得</a> ] <img src="" alt=""><a href="http://www.jdon.com/43463" title="分享我的：领域驱动设计（DDD）学习成果精简总结" target="_blank">分享我的：领域驱动设计（DDD）学习成果精简总结</a> [<a href="http://www.jdon.com/tags/272" target="_blank">DDD领域驱动设计</a> ] <img src="" alt=""><a href="http://www.jdon.com/43666" title="如何提高web系统的吞吐能力？" target="_blank">如何提高web系统的吞吐能力？</a> [<a href="http://www.jdon.com/tags/18277" target="_blank">吞吐量</a> <a href="http://www.jdon.com/tags/344" target="_blank">高性能</a> ] <img src="" alt=""><a href="http://www.jdon.com/43750" title="实践ddd，太让人沮丧了。。" target="_blank">实践ddd，太让人沮丧了。。</a> [<a href="http://www.jdon.com/tags/272" target="_blank">DDD领域驱动设计</a> <a href="http://www.jdon.com/tags/365" target="_blank">jivejdon</a> ] <img src="" alt=""><a href="http://www.jdon.com/43808" title="使用Disruptor实现并发编程 PPT文档" target="_blank">使用Disruptor实现并发编程 PPT文档</a> [<a href="http://www.jdon.com/tags/18365" target="_blank">disruptor</a> <a href="http://www.jdon.com/tags/4973" target="_blank">并发并行</a> ] <img src="" alt=""><a href="http://www.jdon.com/43851" title="jdon框架优缺点之我见" target="_blank">jdon框架优缺点之我见</a> [<a href="http://www.jdon.com/tags/315" target="_blank">JdonFramework</a> <a href="http://www.jdon.com/tags/1013" target="_blank">DSL领域特定语言</a> ] <img src="" alt=""><a href="http://www.jdon.com/43895" title="Instagram卖出10亿美金的启示" target="_blank">Instagram卖出10亿美金的启示</a> [<a href="http://www.jdon.com/tags/612" target="_blank">云计算</a> <a href="http://www.jdon.com/tags/13342" target="_blank">项目管理</a> ] <img src="" alt=""><a href="http://www.jdon.com/43937" title="Martin Fowler厌倦ORM了" target="_blank">Martin Fowler厌倦ORM了</a> [<a href="http://www.jdon.com/tags/564" target="_blank">对象数据库阻抗</a> <a href="http://www.jdon.com/tags/11737" target="_blank">ORM模式</a> ] <img src="" alt=""><a href="http://www.jdon.com/44074" title="Spring创始人Rod Johnson离开东家VMWARE" target="_blank">Spring创始人Rod Johnson离开东家VMWARE</a> [<a href="http://www.jdon.com/tags/253" target="_blank">spring</a> <a href="http://www.jdon.com/tags/10531" target="_blank">akka</a> ]-</p>
<p><a href="">使用帮助</a> <a href="">联系管理员</a> 探索 分享 交流 解惑 授道 OpenSource <a href="http://www.jdon.com/jdonframework/jivejdon3/index.html" target="_blank"><strong>JIVEJDON</strong></a> Powered by <a href="http://www.jdon.com/jdonframework/" target="_blank"><strong>JdonFramework</strong></a> Code © 2002-15 <a href="http://www.jdon.com/" target="_blank"><strong>jdon.com</strong></a>  <a href="http://www.jdon.com/common/503warn.jsp" target="_blank">anti spam</a></p>
<p>-</p>
<p>-</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/缓存/">缓存</a></li></span><span class="breadcrumb"><li><a href="/categories/缓存/">缓存</a></li><li><a href="/categories/缓存/ehcache/">ehcache</a></li></span></span> | <span class="tags">Tagged <a href="/tags/ehcache/" class="label label-primary">ehcache</a><a href="/tags/缓存/" class="label label-success">缓存</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:39"datetime="2014-03-07 09:54:39"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-缓存-ehcache--是使用分布式缓存Ehcache或者NoSQL数据库呢？-ThinkingInJdon/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-缓存-ehcache--是使用分布式缓存Ehcache或者NoSQL数据库呢？-ThinkingInJdon" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>





<ul id="pagination" class="pagination pagination-lg">
  <li><a class="extend prev" href="/page/77/">&laquo;</a></li><li><a class="page-number" href="/">1</a></li><li><a class="page-number" href="/page/2/">2</a></li><li><span class="space">&hellip;</span></li><li><a class="page-number" href="/page/75/">75</a></li><li><a class="page-number" href="/page/76/">76</a></li><li><a class="page-number" href="/page/77/">77</a></li><li class="active"><li><span class="page-number current">78</span></li><li><a class="page-number" href="/page/79/">79</a></li><li><a class="page-number" href="/page/80/">80</a></li><li><a class="page-number" href="/page/81/">81</a></li><li><span class="space">&hellip;</span></li></li><li><a class="page-number" href="/page/161/">161</a></li><li><a class="page-number" href="/page/162/">162</a></li><li><a class="extend next" href="/page/79/">&raquo;</a></li>
  <div class="clearfix"></div>
</ul></div><!--wapper-->
       </div><!-- ID main-col END -->
       <aside id="sidebar" class="alignright col-sx-6 col-sm-4 col-md-3 col-lg-3">
<div id="widget_search" class="widget panel panel-primary">
    <form action="//google.com/search" method="get" accept-charset="utf-8">
  <div class="input-group">
    <input class="form-control" id="searchbox" type="search" name="q" results="0" placeholder="search">
    <span class="input-group-btn">
      <button class="btn btn-default" type="submit">Go!</button>
    </span>
    <input type="hidden" name="q" value="site:itsolife.com">
  </div>
</form>
</div>

<div id="widget_category" class="widget panel panel-primary">
  <div class="panel-heading">category</div>  <div data-src='category' class='ajax_widgets'>正在加载...</div>
</div>

<div id="widget_recent_posts" class="widget panel panel-primary">
  <div class="panel-heading">recent posts</div>  <div data-src='recent_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_tagcloud" class="widget panel panel-primary">
  <div class="panel-heading">tagcloud</div>  <div data-src='tagcloud' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_latest_update_posts" class="widget panel panel-primary">
  <div class="panel-heading">最近更新</div>  <div data-src='latest_update_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_recent_comments" class="widget panel panel-primary">
  <div class="panel-heading">recent comments</div>  

<div class="list-group-item ds-recent-comments" data-num-items="6" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="50"></div>



</div>

</aside>
       <div class="clearfix"></div>
     </div><!-- row END -->
  </div>
  <footer id="footer" class="container">
  <div class="panel panel-info">
  <section id='footer_widget'></section>  <div class="panel-footer">
  <div id="site-info">
    <span class='author'>
  
  &copy; 2014 RobinChia
  
    &nbsp;&nbsp;</span>
  
  <span id='analytics-51la'></span><span id='analytics-google'>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-48559895-1']);
  _gaq.push(['_trackPageview']);
  _js2load.push({src:('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'});
</script></span><span id='analytics-cnzz'>
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_5774006'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s17.cnzz.com/stat.php%3Fid%3D5774006%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
</span><span id='analytics-baidu'>
<script>
var _hmt = _hmt || [];
_js2load.push({src:"//hm.baidu.com/hm.js?1442f50724afc42380b51f097c43082c"});
</script>
</span>  </div>
  <div id="copyright">Site powered by <a href='http://zespia.tw/hexo/'><strong>hexo</strong></a>  update time: <em>2014-04-07 19:25:39</em></span></div>
</div>
<div class="clearfix"></div>


  </div>
  </footer>
  
        <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>        
        <script src="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/js/bootstrap.min.js"></script>        
                
        <script src="http://cdn.bootcss.com/prettify/r298/prettify.min.js"></script>    <script type="text/javascript">
   var lang=["bsh", "c", "cc", "cpp", "cs", "csh", "cyc", "cv", "htm", "html",
    "java", "js", "m", "mxml", "perl", "pl", "pm", "py", "rb", "sh",
    "xhtml", "xml", "xsl"];
   var pretty_base='';
   $('script').each(function(){
	var c = $(this).attr('src');
	if (!c)
	    return;
	if (c.match(/(\/)?prettify(\.min)?\.js/i))
	{
	    var index = c.lastIndexOf('/');
	    if (index != -1)
		pretty_base = c.substr(0,index + 1);
	    return false;
	}
   })
   $('pre code').each(function(){
	var c = $(this).attr('class')
	if (!c)
	    return;
	c = c.match(/\s?(lang\-\w+)/i);
	if (c && lang.indexOf(c[1]) == -1)
	{
	    lang.push(c[1]);
	    $.getScript(pretty_base + c[1] + '.min.js');
	}
   })

    $(window).load(function(){
       $("pre").addClass("prettyprint");
       prettyPrint();
    })
</script>    
            <script type="text/javascript">
var duoshuoQuery = {short_name:"robinchia"};
_js2load.push({src:'http://static.duoshuo.com/embed.js',charset:'UTF-8'});
</script>
    
            <!--wumii_relatedItems-->
    
        <script src="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js"></script>    <script type="text/javascript">
(function($){
  $('.entry').each(function(i){
    $(this).find('img').each(function(){
      var alt = this.alt;

      if (alt){
        $(this).before('<span class="caption">' + alt + '</span>');
      }

      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="fancybox' + i + '" />');
    });
  });

  $('.fancybox').fancybox();
})(jQuery);
</script>    
        <script src="http://cdn.bootcss.com/mathjax/2.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>
    
<script type="text/javascript">
$('.ajax_widgets').each(function(){var src=$(this).attr('data-src');if(src)$(this).load('/widgets/'+src+'.html');});
$.each(_js2load,function(index,obj){loadjs(obj.src,obj.charset)});
</script>

<div id="scroll2top">
<img src="/scroll2top/arrow.png"/>
</div>
<script src="/scroll2top/scroll2top.min.js"></script>
<div id="winterland">
  <canvas></canvas>
</div>
<script src="/js/winterland.min.js"></script>

  </body>
</html>
