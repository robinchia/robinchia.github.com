
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>The 25 Page | It so life</title>
<meta name="author" content="RobinChia">

<meta name="description" content="It so life">


<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta property="og:site_name" content="It so life"/>

<!--[if IE]><style>.testIE.IE{display:inline;}</style><![endif]-->
<!--[if lte IE 7]><link rel="stylesheet" href="/css/ie7.css" type="text/css"><![endif]-->
<!--[if (lt IE 9)&(gt IE 7)]><style>.testIE.IE8{display:inline;}</style><![endif]-->
<!--[if gt IE 8]><style>.testIE.IE9{display:inline;}</style><![endif]-->

<link href="/favicon.png" rel="icon">
<link rel="alternate" href="/atom.xml" title="It so life Feed" type="application/atom+xml">

<link rel="stylesheet" href="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.0.3/css/font-awesome.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/prettify/r298/prettify.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" type="text/css">
<link rel="stylesheet" href="/css/style.css" type="text/css">
<!--[if lt IE 9]>
   <style>article,aside,dialog,footer,header,section,footer,nav,figure,menu{display:block}</style>
   <script src="http://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
   <script src="http://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
<link href="http://cdn.staticfile.org/respond.js/1.4.2/respond-proxy.html" id="respond-proxy" rel="respond-proxy" />
<link href="/js/respond.proxy.gif" id="respond-redirect" rel="respond-redirect" />
<script src="/js/respond.proxy.js"></script>
   <script src="http://cdn.bootcss.com/selectivizr/1.0.2/selectivizr-min.js"></script>
<![endif]-->
<script type="text/javascript">
function loadjs(c,d){var a=document.createElement("script");a.async=!0;a.type="text/javascript";a.src=c;a.charset=d||"gbk";(document.getElementsByTagName("HEAD")[0]||document.getElementsByTagName("BODY")[0]).appendChild(a)};
var _protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
var _js2load = [];
</script>

</head>
<body>
      <header id="header" class="container"><nav id="main-nav" class="navbar navbar-default navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="/">It so life</a>
    </div>
    <div  class="collapse navbar-collapse">
      <ul  class="nav navbar-nav">
  
        <li><a href="/" title="Home">Home</a></li>      
        <li><a href="/about/" title="About">About</a></li>      
        <li><a href="/archives/" title="Archives">Archives</a></li>      
      <li class='dropdown'>
        <a class='dropdown-toggle' data-toggle='dropdown' href='#'>website<b class='caret'></b></a>
        <ul class='dropdown-menu pure-menu-selected'>
    
          <li><a href="//groups.google.com/forum/#!forum/pongba" title="TopLanguage">TopLanguage</a></li>    
          <li><a href="//itpub.net/" title="ITPub">ITPub</a></li>    
          <li><a href="//blog.jobbole.com/" title="Bole">Bole</a></li>    
          <li><a href="//nosql-database.org/" title="nosql">nosql</a></li>    
          <li><a href="//gitimmersion.googol.im/" title="Git">Git</a></li>    
        </ul>
      </li>
    
      </ul>
      <ul class="nav navbar-nav navbar-right">
      
        <li><a href="/atom.xml">RSS</a></li>
      
      
        <li><a href="https://twitter.com/robinchia">twitter</a></li>
      
      
      
      
        <li><a href="https://github.com/robinchia">github</a></li>
      
      </ul>
    </div>
  </div>
</nav>
<div class="clearfix"></div>
</header>
  <div id='content' class="container">
     <div class="page-header-wrapper">
      <!--[if lt IE 9]><div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong>提示:</strong>您的浏览器版本太低了,建议升级到 <strong><a href="http://windows.microsoft.com/zh-cn/internet-explorer/download-ie" title="IE9">IE9</a></strong> 以上,本站使用<a href="https://www.google.com/intl/zh-CN/chrome/">Chrome浏览器</a>可以获得最好的显示效果.</div><![endif]-->
      <div class="page-header"><h1 align="center"><big>It so life</big> </h1>
        <h5 align="center"><big>love as life</big></h5>
      </div>
     </div>
     <div class="row">
       <div id="main-col" class="alignleft col-sx-12 col-sm-8 col-md-9 col-lg-9">
      <section id='header_widget'></section>
          <div id="wrapper"><article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-xml-xstream--XStream使用方法总结附实例代码_JSP编程_脚本之家/">XStream使用方法总结附实例代码_JSP编程_脚本之家</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:44.000Z"> <a href="/2014/02/02/2014-02-02-xml-xstream--XStream使用方法总结附实例代码_JSP编程_脚本之家/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="xstream-_jsp-_-">XStream使用方法总结附实例代码<em>JSP编程</em>脚本之家</h1>
<p>页面导航： <a href="http://www.jb51.net/index.htm" target="_blank">首页</a> → <a href="http://www.jb51.net/list/index_1.htm" title="网络编程" target="_blank">网络编程</a> → <a href="http://www.jb51.net/list/list_83_1.htm" title="JSP编程" target="_blank">JSP编程</a> → 正文内容 XStream 实例 </p>
<h1 id="xstream-">XStream使用方法总结附实例代码</h1>
<p>发布：dxy 字体：[<a href="">增加</a> <a href="">减小</a>] 类型：转载 </p>
<p>XStream是一个Java对象和XML相互转换的工具，很好很强大。提供了所有的基础类型、数组、集合等类型直接转换的支持。因此XML常用于数据交换、对象序列化（这种序列化和Java对象的序列化技术有着本质的区别）。
XStream中的核心类就是XStream类，一般来说，熟悉这个类基本就够用了，如果你用的更多，估计是你设计有问题，否则不需要。 
XStream对象相当Java对象和XML之间的转换器，转换过程是双向的。创建XSteam对象的方式很简单，只需要new XStream()即可。 
Java到xml，用toXML()方法。 
Xml到Java，用fromXML()方法。 
在没有任何设置默认情况下，java到xml的映射，是java成员名对应xml的元素名，java类的全名对应xml根元素的名字。而实际中，往往是xml和java类都有了，要完成相互转换，必须进行别名映射。 
别名配置包含三种情况： 
1、类别名，用alias(String name, Class type)。 
2、类成员别名，用aliasField(String alias, Class definedIn, String fieldName) 
3、类成员作为属性别名，用 aliasAttribute(Class definedIn, String attributeName, String alias)，单独命名没有意义，还要通过useAttributeFor(Class definedIn, String fieldName) 应用到某个类上。 
别名的配置是非常重要的，但是其中有些细节问题很重要，在例子中会专门做详细说明。 
另外还有不太常用的方法： 
addImplicitCollection(Class ownerType, String fieldName)，去掉集合类型生成xml的父节点。 
registerConverter(Converter converter) ，注册一个转换器。 
如果你的xml很大，或者为了安全性，以流的方式传输，那么XStream也提供丰富的API， 
使用起来也非常简便。目前还用不到，暂不考虑。 
如果这些基本的操作还不能满足你应用的需求，XStream提供丰富的扩展点。你可以实现自己的转换器。还可以利用XStream完成更负责的功能，比如输出其他非xml格式的数据，还可以输出html，还支持XML Dom类型数据，这些应用起来稍微复杂些。当然这些不是XStream应用的重点，也不用理会，真正需要的时候再查看API和源码研究研究。 
XStream的优点很多，但是也有一些小bug，比如在定义别名中的下划线“<em>”转换为xml后会变成“_</em>”这个符号，很变态。因此，尽量避免在别名中实用任何符号，却是需要下划线的时候，可以考虑实用连接符“-”，这个没有问题。 
另外，我们的Java Bean中，常常有一些常量，在转换过程，XStream也会将这些常量转换过去，形成常量的xml节点，这显然不是想要的结果，对于常量字段，就不做转换了。 
下面给出一个非常典型的而且实用的例子，作为对总结的补充： 
package test; 
import java.util.List; 
//<em>/</em> 
/<em> Created by IntelliJ IDEA.<br> 
/</em> <b>User</b>: leizhimin<br> 
/<em> <b>Date</b>: 2008-5-22 21:10:13<br> 
/</em> <b>Note</b>: Please add comment here! 
/<em>/ 
public class Person { 
private String name; 
private String age; 
private Profile profile; 
private List<Address> addlist; 
public Person(String name, String age, Profile profile, List<Address> addlist) { 
this.name = name; 
this.age = age; 
this.profile = profile; 
this.addlist = addlist; 
} 
public String toString() { 
return &quot;Person{&quot; + 
&quot;name=&#39;&quot; + name + &#39;\&#39;&#39; + 
&quot;, age=&#39;&quot; + age + &#39;\&#39;&#39; + 
&quot;, profile=&quot; + profile + 
&quot;, addlist=&quot; + addlist + 
&#39;}&#39;; 
} 
} 
package test; 
import java.sql.Date; 
//</em>/<em> 
/</em> Created by IntelliJ IDEA.<br> 
/<em> <b>User</b>: leizhimin<br> 
/</em> <b>Date</b>: 2008-5-22 21:10:32<br> 
/<em> <b>Note</b>: Please add comment here! 
/</em>/ 
public class Profile { 
private String job; 
private String tel; 
private String remark; 
public Profile(String job, String tel, String remark) { 
this.job = job; 
this.tel = tel; 
this.remark = remark; 
} 
public String toString() { 
return &quot;Profile{&quot; + 
&quot;job=&#39;&quot; + job + &#39;\&#39;&#39; + 
&quot;, tel=&#39;&quot; + tel + &#39;\&#39;&#39; + 
&quot;, remark=&#39;&quot; + remark + &#39;\&#39;&#39; + 
&#39;}&#39;; 
} 
} 
package test; 
//<em>/</em> 
/<em> Created by IntelliJ IDEA.<br> 
/</em> <b>User</b>: leizhimin<br> 
/<em> <b>Date</b>: 2008-5-22 21:10:22<br> 
/</em> <b>Note</b>: Please add comment here! 
/<em>/ 
public class Address { 
private String add; 
private String zipcode; 
public Address(String add, String zipcode) { 
this.add = add; 
this.zipcode = zipcode; 
} 
public String toString() { 
return &quot;Address{&quot; + 
&quot;add=&#39;&quot; + add + &#39;\&#39;&#39; + 
&quot;, zipcode=&#39;&quot; + zipcode + &#39;\&#39;&#39; + 
&#39;}&#39;; 
} 
} 
package test; 
import com.thoughtworks.xstream.XStream; 
import java.util.List; 
import java.util.ArrayList; 
//</em>/<em> 
/</em> Created by IntelliJ IDEA.<br> 
/<em> <b>User</b>: leizhimin<br> 
/</em> <b>Date</b>: 2008-5-22 21:10:47<br> 
/<em> <b>Note</b>: XStream学习[<a href="http://lavasoft.blog.51cto.com" target="_blank">http://lavasoft.blog.51cto.com</a>] 
/</em>/ 
public class TestXStream { 
public static void main(String args[]) { 
test(); 
} 
public static void test() { 
System.out.println(&quot;----------XStream学习:<a href="http://lavasoft.blog.51cto.com----------" target="_blank">http://lavasoft.blog.51cto.com----------</a>&quot;); 
//目标对象 
Address address1 = new Address(&quot;郑州市经三路&quot;, &quot;450001&quot;); 
Address address2 = new Address(&quot;西安市雁塔路&quot;, &quot;710002&quot;); 
List<Address> addList = new ArrayList<Address>(); 
addList.add(address1); 
addList.add(address2); 
Profile profile = new Profile(&quot;软件工程师&quot;, &quot;13512129933&quot;, &quot;备注说明&quot;); 
Person person = new Person(&quot;熔岩&quot;, &quot;27&quot;, profile, addList); 
//转换装配 
XStream xStream = new XStream(); 
//<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em> 设置类别名 /<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/ 
xStream.alias(&quot;PERSON&quot;, test.Person.class); 
xStream.alias(&quot;PROFILE&quot;, test.Profile.class); 
xStream.alias(&quot;ADDRESS&quot;, test.Address.class); 
output(1, xStream, person); 
//<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em> 设置类成员的别名 /</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/ 
//设置Person类的name成员别名Name 
xStream.aliasField(&quot;Name&quot;, Person.class, &quot;name&quot;); 
//<em>[注意] 设置Person类的profile成员别名PROFILE,这个别名和Profile类的别名一致, 
/</em> 这样可以保持XStream对象可以从profile成员生成的xml片段直接转换为Profile成员, 
/<em> 如果成员profile的别名和Profile的别名不一致,则profile成员生成的xml片段不可 
/</em> 直接转换为Profile对象,需要重新创建XStream对象,这岂不给自己找麻烦? /<em>/ 
xStream.aliasField(&quot;PROFILE&quot;, test.Person.class, &quot;profile&quot;); 
xStream.aliasField(&quot;ADDLIST&quot;, test.Person.class, &quot;addlist&quot;); 
xStream.aliasField(&quot;Add&quot;, test.Address.class, &quot;add&quot;); 
xStream.aliasField(&quot;Job&quot;, test.Profile.class, &quot;job&quot;); 
output(2, xStream, person); 
//</em>/<em>/</em>/<em>/</em>/<em>/</em> 设置类成员为xml一个元素上的属性 /<em>/</em>/<em>/</em>/<em>/</em>/<em>/ 
xStream.useAttributeFor(Address.class, &quot;zipcode&quot;); 
//</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em> 设置属性的别名 /<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/ 
xStream.aliasAttribute(test.Address.class, &quot;zipcode&quot;, &quot;Zipcode&quot;); 
output(3, xStream, person); 
//</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em> 将xml转为java对象 /<em>/</em>/<em>/</em>/<em>/</em>×/<em>/</em>/<em>/</em>/ 
String person_xml = &quot;<PERSON>\n&quot; + 
&quot; <Name>熔岩</Name>\n&quot; + 
&quot; <age>27</age>\n&quot; + 
&quot; <PROFILE>\n&quot; + 
&quot; <Job>软件工程师</Job>\n&quot; + 
&quot; <tel>13512129933</tel>\n&quot; + 
&quot; <remark>备注说明</remark>\n&quot; + 
&quot; </PROFILE>\n&quot; + 
&quot; <ADDLIST>\n&quot; + 
&quot; <ADDRESS Zipcode=\"450001\">\n&quot; + 
&quot; <Add>郑州市经三路</Add>\n&quot; + 
&quot; </ADDRESS>\n&quot; + 
&quot; <ADDRESS Zipcode=\"710002\">\n&quot; + 
&quot; <Add>西安市雁塔路</Add>\n&quot; + 
&quot; </ADDRESS>\n&quot; + 
&quot; </ADDLIST>\n&quot; + 
&quot;</PERSON>&quot;; 
String profile_xml = &quot; <PROFILE>\n&quot; + 
&quot; <Job>软件工程师</Job>\n&quot; + 
&quot; <tel>13512129933</tel>\n&quot; + 
&quot; <remark>备注说明</remark>\n&quot; + 
&quot; </PROFILE>&quot;; 
String address_xml = &quot; <ADDRESS Zipcode=\"710002\">\n&quot; + 
&quot; <Add>西安市雁塔路</Add>\n&quot; + 
&quot; </ADDRESS>&quot;; 
//同样实用上面的XStream对象xStream 
System.out.println(xStream.fromXML(person_xml).toString()); 
System.out.println(xStream.fromXML(profile_xml).toString()); 
System.out.println(xStream.fromXML(address_xml).toString()); 
} 
public static void output(int i, XStream xStream, Object obj) { 
String xml = xStream.toXML(obj); 
System.out.println(&quot;&gt;&gt;&gt;第[ &quot; + i + &quot;]次输出\n&quot;); 
System.out.println(xml + &quot;\n&quot;); 
} 
} 
----------XStream学习:<a href="http://lavasoft.blog.51cto.com----------" target="_blank">http://lavasoft.blog.51cto.com----------</a> </p>
<blockquote>
<blockquote>
<blockquote>
<p>第[ 1]次输出 </p>
<p><PERSON> </p>
<p><name>熔岩</name> </p>
<p><age>27</age> </p>
<p><profile> </p>
<p><job>软件工程师</job> </p>
<p><tel>13512129933</tel> </p>
<p><remark>备注说明</remark> 
</profile> </p>
<p><addlist> </p>
<p><ADDRESS> </p>
<p><add>郑州市经三路</add> </p>
<p><zipcode>450001</zipcode> 
</ADDRESS> </p>
<p><ADDRESS> </p>
<p><add>西安市雁塔路</add> </p>
<p><zipcode>710002</zipcode> 
</ADDRESS> 
</addlist> 
</PERSON> 
第[ 2]次输出 </p>
<p><PERSON> </p>
<p><Name>熔岩</Name> </p>
<p><age>27</age> </p>
<p><PROFILE> </p>
<p><Job>软件工程师</Job> </p>
<p><tel>13512129933</tel> </p>
<p><remark>备注说明</remark> 
</PROFILE> </p>
<p><ADDLIST> </p>
<p><ADDRESS> </p>
<p><Add>郑州市经三路</Add> </p>
<p><zipcode>450001</zipcode> 
</ADDRESS> </p>
<p><ADDRESS> </p>
<p><Add>西安市雁塔路</Add> </p>
<p><zipcode>710002</zipcode> 
</ADDRESS> 
</ADDLIST> 
</PERSON> 
第[ 3]次输出 </p>
<p><PERSON> </p>
<p><Name>熔岩</Name> </p>
<p><age>27</age> </p>
<p><PROFILE> </p>
<p><Job>软件工程师</Job> </p>
<p><tel>13512129933</tel> </p>
<p><remark>备注说明</remark> 
</PROFILE> </p>
<p><ADDLIST> </p>
<p><ADDRESS Zipcode="450001"> </p>
<p><Add>郑州市经三路</Add> 
</ADDRESS> </p>
<p><ADDRESS Zipcode="710002"> </p>
<p><Add>西安市雁塔路</Add> 
</ADDRESS> 
</ADDLIST> 
</PERSON> 
Person{name=&#39;熔岩&#39;, age=&#39;27&#39;, profile=Profile{job=&#39;软件工程师&#39;, tel=&#39;13512129933&#39;, remark=&#39;备注说明&#39;}, addlist=[Address{add=&#39;郑州市经三路&#39;, zipcode=&#39;450001&#39;}, Address{add=&#39;西安市雁塔路&#39;, zipcode=&#39;710002&#39;}]} 
Profile{job=&#39;软件工程师&#39;, tel=&#39;13512129933&#39;, remark=&#39;备注说明&#39;} 
Address{add=&#39;西安市雁塔路&#39;, zipcode=&#39;710002&#39;} 
Process finished with exit code 0 
在实际中，类的属性很多，嵌套层次也很复杂，如果仅仅使用XStream原生API来硬编码设置别名等属性，显得太生硬也难以维护。完全可以考虑通过一个xml配置文件来定义所有用到的类的别名定义（包括其成员），然后，通过读取配置构建一个XStream的工厂，在用到时候直接去取，而不是让实用者组装。我目前的一个项目中，就是这么实现的，效果非常的好。 
下面我给出针对上面提出的问题一个解决方案： 
思想：考虑做一个过滤器，在xml转java之前，在Java转xml之后，应用这个过滤器。这个过滤器提供将xml中的“<strong>”替换为“-”，并且将xml中的不需要的节点剔除。 
在过滤之前，我实现了个转换器装配，这一步通过xml来配置，并在java中获取。 
代码就省略了，这一步很灵活，关键看你的应用了。 
为了能过滤xml，我们需要用Dom4j递归遍历xml文档。下面一些算法代码： 
//递归算法：遍历配置文件，找出所有有效的xpath 
private static void recursiveElement(Element element) { 
List<Element> elements = element.elements(); 
validXPathList.add(element.getPath()); 
if (elements.size() == 0) { 
//没有子元素 
} else { 
//有子元素 
for (Iterator<Element> it = elements.iterator(); it.hasNext();) { 
//递归遍历 
recursiveElement(it.next()); 
} 
} 
} 
//递归算法：遍历xml，标识无效的元素节点 
private static void recursiveFixElement(Element element) { 
List<Element> elements = element.elements(); 
if (!validXPathList.contains(element.getPath())) { 
element.addAttribute(&quot;delete&quot;, &quot;true&quot;); 
} 
if (elements.size() == 0) { 
//没有子元素 
} else { 
//有子元素 
for (Iterator<Element> it = elements.iterator(); it.hasNext();) { 
Element e = it.next(); 
if (!validXPathList.contains(e.getPath())) { 
e.addAttribute(&quot;delete&quot;, &quot;true&quot;); 
} 
//递归遍历 
recursiveFixElement(e); 
} 
} 
} 
//<em>/</em> 
/<em> 过滤器接口方法，转换不规范字符，剔除无效节点 
/</em> 
/<em> @param xmlStr 要过滤的xml 
/</em> @return 符合转换器要求的xml 
/*/ 
public static String filter(String xmlStr) { 
Document document = null; 
try { 
document = DocumentHelper.parseText(xmlStr.replaceAll(&quot;</strong>&quot;, &quot;_&quot;)); 
//递归的调用：标记要剔除的xml元素 
recursiveFixElement(document.getRootElement()); 
List<Node> nodeList = document.selectNodes(&quot;//@delete&quot;); 
for (Node node : nodeList) { 
node.getParent().detach(); //剔除xml元素 
} 
} catch (DocumentException e) { 
System.out.println(e.getMessage()); 
e.printStackTrace(); 
} 
return document.asXML(); 
} </p>
</blockquote>
</blockquote>
</blockquote>
<p>-</p>
<p><strong>Tags：</strong><a href="http://img.jb51.net/tag/XStream/1.htm" title="搜索关于XStream的文章" target="_blank">XStream</a> <a href="http://img.jb51.net/tag/%CA%B5%C0%FD/1.htm" title="搜索关于实例的文章" target="_blank">实例</a>
<a href="&quot;复制本文链接发给你QQ/MSN上的好友&quot;">复制链接</a><a href="">收藏本文</a><a href="">打印本文</a><a href="">关闭本文</a><a href="http://www.jb51.net/index.htm" target="_blank">返回首页</a> </p>
<p>上一篇：<a href="http://www.jb51.net/article/13684.htm" title="下载完成后页面不自动关闭的方法" target="_blank">下载完成后页面不自动关闭的方法</a></p>
<p>下一篇：<a href="http://www.jb51.net/article/27084.htm" target="_blank">java+sql2005 随机抽取试题的代码</a>
<a href="http://s.jb51.net/"></a></p>
<h2 id="-">相关文章</h2>
<ul>
<li><a href="http://www.jb51.net/article/16686.htm" title="java struts常见错误以及原因分析" target="_blank">java struts常见错误以及原因分析</a></li>
<li><a href="http://www.jb51.net/article/2657.htm" title="指南：想成为一个JSP网站程序员吗？" target="_blank">指南：想成为一个JSP网站程序员吗？</a></li>
<li><a href="http://www.jb51.net/article/2544.htm" title="实例讲解JSP Model2体系结构（上）" target="_blank">实例讲解JSP Model2体系结构（上）</a></li>
<li><a href="http://www.jb51.net/article/16653.htm" title="jsp JFreeChart使用心得与例子" target="_blank">jsp JFreeChart使用心得与例子</a></li>
<li><a href="http://www.jb51.net/article/2665.htm" title="JSP的内部对象" target="_blank">JSP的内部对象</a></li>
<li><a href="http://www.jb51.net/article/16478.htm" title="jsp Hibernate入门教程" target="_blank">jsp Hibernate入门教程</a></li>
<li><a href="http://www.jb51.net/article/2572.htm" title="使用JavaBean创建您的网上日历本(2)" target="_blank">使用JavaBean创建您的网上日历本(2)</a></li>
<li><a href="http://www.jb51.net/article/13160.htm" title="jsp中文乱码 jsp mysql 乱码的解决方法" target="_blank">jsp中文乱码 jsp mysql 乱码的解决方法</a>
<strong>友情提醒</strong>：本站文件的解压密码：<a href="http://www.jb51.net" target="_blank">www.jb51.net</a> (请使用最新的winrar)<a href="http://www.tuidc.com/" title="腾佑科技"></a></li>
</ul>
<h2 id="-">文章评论</h2>
<p>共有 <strong>0 </strong> 位脚本之家网友发表了评论<a href="http://img.jb51.net/comment.asp?id=14542" target="_blank">我来说两句</a></p>
<p><a href="http://idc567.com/" target="_blank"></a>  <a href="http://www.geisnic.com/"></a></p>
<h3 id="-">最 近 更 新</h3>
<ul>
<li><a href="http://www.jb51.net/article/2800.htm" title="为Java应用程序添加退出事件响应" target="_blank">为Java应用程序添加退出事件响应</a></li>
<li><a href="http://www.jb51.net/article/2531.htm" title="我认为JSP有问题(下)" target="_blank">我认为JSP有问题(下)</a></li>
<li><a href="http://www.jb51.net/article/17863.htm" title="jsp 页面上图片分行输出小技巧" target="_blank">jsp 页面上图片分行输出小技巧</a></li>
<li><a href="http://www.jb51.net/article/2527.htm" title="JSP教程(五)-JSP Actions的使用下" target="_blank">JSP教程(五)-JSP Actions的使用下</a></li>
<li><a href="http://www.jb51.net/article/2618.htm" title="也谈用JSP实现新郎、sohu新闻系统的技术。" target="_blank">也谈用JSP实现新郎、sohu新闻系统的技术。</a></li>
<li><a href="http://www.jb51.net/article/2770.htm" title="Java开源项目Hibernate" target="_blank">Java开源项目Hibernate</a></li>
<li><a href="http://www.jb51.net/article/2470.htm" title="一个可以防止刷新的JSP计数器" target="_blank">一个可以防止刷新的JSP计数器</a></li>
<li><a href="http://www.jb51.net/article/2712.htm" title="面向对象编程,我的思想(5)" target="_blank">面向对象编程,我的思想(5)</a></li>
<li><a href="http://www.jb51.net/article/2510.htm" title="JAVA/JSP学习系列之二(Tomcat安装)" target="_blank">JAVA/JSP学习系列之二(Tomcat安装)</a></li>
<li><a href="http://www.jb51.net/article/5296.htm" title="JDBC板块精华整理20051226" target="_blank">JDBC板块精华整理20051226</a></li>
</ul>
<h3 id="-">热 点 排 行</h3>
<ul>
<li><a href="http://www.jb51.net/article/15792.htm" title="FCKeditor使用方法(FCKeditor_2.6.3)详细使用说明" target="_blank">FCKeditor使用方法(FCKeditor_2.</a></li>
<li><a href="http://www.jb51.net/article/15976.htm" title="struts2+spring+hibernate分页代码[比较多]" target="_blank">struts2+spring+hibernate分页代</a></li>
<li><a href="http://www.jb51.net/article/16653.htm" title="jsp JFreeChart使用心得与例子" target="_blank">jsp JFreeChart使用心得与例子</a></li>
<li><a href="http://www.jb51.net/article/21204.htm" title="搭建EXTJS和STRUTS2框架(ext和struts2简单实例)" target="_blank">搭建EXTJS和STRUTS2框架(ext和st</a></li>
<li><a href="http://www.jb51.net/article/6740.htm" title="jsp生成静态页面的方法" target="_blank">jsp生成静态页面的方法</a></li>
<li><a href="http://www.jb51.net/article/13388.htm" title="Jsp页面实现文件上传下载类代码" target="_blank">Jsp页面实现文件上传下载类代码</a></li>
<li><a href="http://www.jb51.net/article/15974.htm" title="一个实用的JSP分页代码" target="_blank">一个实用的JSP分页代码</a></li>
<li><a href="http://www.jb51.net/article/6742.htm" title="JSP连接Access数据库" target="_blank">JSP连接Access数据库</a></li>
<li><a href="&quot;XStream使用方法总结附实例代码&quot;">XStream使用方法总结附实例代码</a></li>
<li><a href="http://www.jb51.net/article/16437.htm" title="response.setHeader参数、用法的介绍" target="_blank">response.setHeader参数、用法的</a></li>
</ul>
<h3 id="js-css-">Js与CSS工具</h3>
<ul>
<li><a href="http://www.jb51.net/tools/cssyasuo.shtml" target="_blank">CSS在线压缩格式化(中文)</a></li>
<li><a href="http://www.codebeautifier.com/" target="_blank">css 格式化整理工具(英文)</a></li>
<li><a href="http://www.jb51.net/csstidy/css_optimiser.php?lang=zh" target="_blank">CSS整形格式化</a></li>
<li><a href="http://tools.jb51.net/tools/js_geshihua.asp" target="_blank">JavaScript 格式化整理工具</a></li>
<li><a href="http://jsbeautifier.org/" target="_blank">jsbeautifier Js格式化整理工具(英文)</a></li>
<li><a href="http://www.phpformatter.com/" target="_blank">php 格式化整理工具(英文)</a></li>
<li><a href="http://www.jb51.net/tools/html-js.htm" target="_blank">HTML/JS互相转换工具</a></li>
<li><a href="http://www.jb51.net/tools/packer.htm" target="_blank">javascript pack加密压缩工具</a></li>
<li><a href="http://www.jb51.net/tools/jsmin/index.htm" target="_blank">JS Minifier压缩</a></li>
<li><a href="http://www.jb51.net/tools/JShunxiao.htm" target="_blank">JS混淆工具</a></li>
<li><a href="http://www.jb51.net/tools/js_Debug.htm" target="_blank">在线JS脚本校验器错误</a></li>
<li><p><a href="http://tools.jb51.net/tools/regex.asp" target="_blank">JavaScript 正则表达式在线测试工具</a></p>
<h3 id="-">代码转换工具</h3>
</li>
<li><p><a href="http://www.jb51.net/tools/base64.htm" target="_blank">Base64编码加密</a></p>
</li>
<li><a href="http://tools.jb51.net//tools/Escape.asp" target="_blank">Escape加解密</a></li>
<li><a href="http://tools.jb51.net/html_ubb.asp" target="_blank">HTML/UBB代码转换</a></li>
<li><a href="http://www.jb51.net/tools/fanjianzhi.htm" target="_blank">GB2312/BIG5繁简字转换</a></li>
<li><a href="http://www.jb51.net/tools/jingdian.shtml" target="_blank">经典小工具集 数字转换</a></li>
<li><a href="http://www.jb51.net/tools/htmlto.htm" target="_blank">HTML多功能代码转换器</a></li>
<li><a href="http://www.jb51.net/tools/xunleijm.htm" target="_blank">迅雷快车加/解密</a></li>
<li><a href="http://tools.jb51.net/tools/pinyin.asp" target="_blank">汉字转换拼音</a>
<a href="http://www.enkj.com/" target="_blank"></a> <a href="http://www.tuidc.com/"></a></li>
</ul>
<p><a href="http://www.xunbiz.com/click/click.asp?str=44717c87b8d8fc3a3e18797345b90434"></a></p>
<p>-</p>
<ul>
<li><a href="http://www.jb51.net/tools/cssyasuo.shtml" target="_blank">CSS在线压缩格式化(中文)</a></li>
<li><a href="http://www.codebeautifier.com" target="_blank">css 格式化整理工具(英文)</a></li>
<li><a href="http://www.jb51.net/csstidy/css_optimiser.php?lang=zh" target="_blank">CSS整形格式化</a></li>
<li><a href="http://tools.jb51.net/tools/js_geshihua.asp" target="_blank">JavaScript 格式化整理工具</a></li>
<li><a href="http://jsbeautifier.org" target="_blank">jsbeautifier Js格式化整理工具(英文)</a></li>
<li><a href="http://www.phpformatter.com" target="_blank">php 格式化整理工具(英文)</a></li>
<li><a href="http://www.jb51.net/tools/html-js.htm" target="_blank">HTML/JS互相转换工具</a></li>
<li><a href="http://www.jb51.net/tools/packer.htm" target="_blank">javascript pack加密压缩工具</a></li>
<li><a href="http://www.jb51.net/tools/jsmin/index.htm" target="_blank">JS Minifier压缩</a></li>
<li><a href="http://www.jb51.net/tools/JShunxiao.htm" target="_blank">JS混淆工具</a></li>
<li><a href="http://www.jb51.net/tools/js_Debug.htm" target="_blank">在线JS脚本校验器错误</a></li>
<li><p><a href="http://tools.jb51.net/tools/regex.asp" target="_blank">JavaScript 正则表达式在线测试工具</a></p>
</li>
<li><p><a href="http://www.jb51.net/tools/base64.htm" target="_blank">Base64编码加密</a></p>
</li>
<li><a href="http://tools.jb51.net//tools/Escape.asp" target="_blank">Escape加解密</a></li>
<li><a href="http://tools.jb51.net/html_ubb.asp" target="_blank">HTML/UBB代码转换</a></li>
<li><a href="http://www.jb51.net/tools/fanjianzhi.htm" target="_blank">GB2312/BIG5繁简字转换</a></li>
<li><a href="http://www.jb51.net/tools/jingdian.shtml" target="_blank">经典小工具集 数字转换</a></li>
<li><a href="http://www.jb51.net/tools/htmlto.htm" target="_blank">HTML多功能代码转换器</a></li>
<li><a href="http://www.jb51.net/tools/xunleijm.htm" target="_blank">迅雷快车加/解密</a></li>
<li><a href="http://tools.jb51.net/tools/pinyin.asp" target="_blank">汉字转换拼音</a></li>
</ul>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/xml/">xml</a></li></span><span class="breadcrumb"><li><a href="/categories/xml/">xml</a></li><li><a href="/categories/xml/xstream/">xstream</a></li></span></span> | <span class="tags">Tagged <a href="/tags/xml/" class="label label-primary">xml</a><a href="/tags/xstream/" class="label label-success">xstream</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:44"datetime="2014-03-07 09:54:44"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-xml-xstream--XStream使用方法总结附实例代码_JSP编程_脚本之家/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-xml-xstream--XStream使用方法总结附实例代码_JSP编程_脚本之家" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-xml-xstream--XStream-FrequentlyAskedQuestions/">XStream </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:44.000Z"> <a href="/2014/02/02/2014-02-02-xml-xstream--XStream-FrequentlyAskedQuestions/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="xstream-frequently-asked-questions">XStream - Frequently Asked Questions</h1>
<p><a href="http://xstream.codehaus.org/index.html" target="_blank"><img src="" alt="XStream"></a></p>
<h1 id="frequently-asked-questions">Frequently Asked Questions</h1>
<ol>
<li><a href="http://xstream.codehaus.org/faq.html#Compatibility" target="_blank">Compatibility</a></li>
<li><a href="http://xstream.codehaus.org/faq.html#Serialization" target="_blank">Serialization</a></li>
<li><a href="http://xstream.codehaus.org/faq.html#XML" target="_blank">XML specifics</a></li>
<li><a href="http://xstream.codehaus.org/faq.html#JSON" target="_blank">JSON specifics</a></li>
<li><a href="http://xstream.codehaus.org/faq.html#Other_Products" target="_blank">Comparison to other products</a></li>
<li><a href="http://xstream.codehaus.org/faq.html#Scalability" target="_blank">Scalability</a></li>
<li><a href="http://xstream.codehaus.org/faq.html#Uses" target="_blank">Uses of XStream</a></li>
</ol>
<h1 id="compatibility">Compatibility</h1>
<h2 id="which-jdk-is-required-to-use-xstream-">Which JDK is required to use XStream?</h2>
<p>1.3 or later.</p>
<h2 id="does-xstream-behave-differently-across-different-jvms-">Does XStream behave differently across different JVMs?</h2>
<p>XStream has two modes of operation: <strong>Pure Java</strong> and <strong>Enhanced</strong>. In pure Java mode, XStream behaves in the same way across different JVMs, however its features are limited to what reflection allows, meaning it cannot serialize certain classes or fields. In <strong>enhanced</strong> mode, XStream does not have these limitations, however this mode of operation is not available to all JVMs.</p>
<h2 id="which-jvms-allow-xstream-to-operate-in-enhanced-mode-">Which JVMs allow XStream to operate in enhanced mode?</h2>
<p>Currently on the Sun, Apple, HP, IBM and Blackdown 1.4 JVMs and onwards. Also for Hitachi, SAP and Diablo from 1.5 and onwards. Support for BEA JRockit starting with R25.1.0. For all other JVMs, XStream should be used in pure Java mode.</p>
<h2 id="what-are-the-advantages-of-using-enhanced-mode-over-pure-java-mode-">What are the advantages of using enhanced mode over pure Java mode?</h2>
<p>Feature Pure Java Enhanced Mode Public classes Yes Yes Non public classes No Yes Static inner classes Yes Yes Non-static inner classes No Yes Anonymous inner classes No Yes With default constructor Yes Yes Without default constructor No Yes Private fields Yes Yes Final fields Yes &gt;= JDK 1.5 Yes</p>
<h2 id="can-i-use-xstream-in-an-android-application-">Can I use XStream in an Android application?</h2>
<p>XStream does work in Android 1.0, but has limited capabilities. XStream does not support enhanced mode for Android. Additionally Android reports itself as implementation of JDK specification 0.9, so it is not possible to write into final fields. Android also does not include the java.beans package. Therefore you cannot use the JavaBeanConverter.</p>
<h2 id="why-does-xstream-fail-on-harmony-">Why does XStream fail on Harmony?</h2>
<p>Since JDK 5 it is possible according the Java specification to write into final fields using reflection. This is not yet supported by Harmony and therefore the PureJavaReflectionProvider fails. We have also already investigated into enhanced mode in Harmony, but the Harmony JVM currently crashes running the unit tests. It is simply not yet ready.</p>
<h2 id="are-there-plans-to-provide-enhanced-mode-support-to-other-jvms-">Are there plans to provide enhanced mode support to other JVMs?</h2>
<p>Yes. <a href="http://xstream.codehaus.org/list-user.html" target="_blank">Let us know</a> which JVM you would like supported.</p>
<h2 id="when-should-i-use-xstream-not-in-enhanced-mode-">When should I use XStream not in enhanced mode?</h2>
<p>Running XStream in a secured environment can prevent XStream from running in enhanced mode. This is especially true when running XStream in an applet. You may also try to use the JavaBeanConverter as alternative to the ReflectionConverter running in enhanced or pure Java mode.</p>
<h2 id="which-permissions-does-xstream-need-when-running-with-an-active-securitymanager-">Which permissions does XStream need when running with an active SecurityManager?</h2>
<p>This depends on the mode XStream is running in. Refer to the <a href="http://svn.xstream.codehaus.org/browse/xstream/trunk/xstream/src/test/com/thoughtworks/acceptance/SecurityManagerTest.java" target="_blank">SecurityManagerTest</a> for details.</p>
<h2 id="why-does-xstream-1-2-no-longer-read-xml-generated-with-xstream-1-1-x-">Why does XStream 1.2 no longer read XML generated with XStream 1.1.x?</h2>
<p>The architecture in XStream has slightly changed. Starting with XStream 1.2 the <a href="http://xstream.codehaus.org/javadoc/com/thoughtworks/xstream/io/HierarchicalStreamDriver.html" target="_blank">HierarchicalStreamDriver</a> implementation is responsible to ensure that XML tags and attributes are valid names in XML, in XStream 1.1.x this responsibility was part of the ClassMapper implementations. Under some rare circumstances this will result in an unreadable XML due to the different processing order in the workflow of such problematic tag names.</p>
<p>You can run XStream in 1.1 compatibility mode though:
XStream xstream = new XStream(new XppDriver(new XStream11XmlFriendlyReplacer())) { protected boolean useXStream11XmlFriendlyMapper() { return true; } };</p>
<h2 id="xstream-1-3-ignores-suddenly-annotated-converters-xstreamconverter-and-xstreamconverters-">XStream 1.3 ignores suddenly annotated converters (@XStreamConverter and @XStreamConverters)?</h2>
<p>XStream treats now all annotations the same and therefore it no longer auto-detects any annotation by default. You can configure XStream to run in auto-detection mode, but be aware if the <a href="http://xstream.codehaus.org/annotations-tutorial.html#AutoDetect" target="_blank">implications</a>. As alternative you might register the deprecated AnnotationReflectionConverter, that was used for XStream pre 1.3.x, but as drawback the functionality to register a local converter with XStream.registerLocalConverter will no longer work.</p>
<h2 id="xstream-1-3-suddenly-has-a-different-field-order-">XStream 1.3 suddenly has a different field order?</h2>
<p>Yes. This was announced with the last 1.2.x release and was done to support the type inheritance of XML schemas. However, XStream is delivered with the <a href="http://xstream.codehaus.org/javadoc/com/thoughtworks/xstream/io/HierarchicalStreamDriver.html" target="_blank">XStream12FieldKeySorter</a> that can be used to <a href="http://xstream.codehaus.org/faq.html#Serialization_sort_fields" target="_blank">sort the fields</a> according XStream 1.2.2.</p>
<h1 id="serialization">Serialization</h1>
<h2 id="which-class-types-can-be-serialized-by-xstream-">Which class types can be serialized by XStream?</h2>
<p>In contrast to the JDK XStream is not tied to a marker interface to serialize a class. XStream ships with some specialized <a href="http://xstream.codehaus.org/converters.html" target="_blank">converters</a>, but will use reflection by default for &quot;unknown&quot; classes to examine, read and write the class&#39; data. Therefore XStream can handle quite any class, especially the ones referred as POJO (Plain Old Java Object).</p>
<p>However, some types of classes exist with typical characteristics, that cannot be handled - at least not out of the box:</p>
<ol>
<li>Objects that are based on threads or thread local data: Thread, Timer, ThreadLocal and so on. These classes keep different data for different threads and there&#39;s no possibility to recreate a thread in a generic way nor recreating thread specific data. There might be special use cases, but this will always involve a custom converter where threads can be recreated in a specific way tied to that use case.</li>
<li>Class types that are based on generated classes. Such types have often names that are unique to the current process and will have no meaning in a different process. A custom converter might help to write the appropriate data into the serializing stream to be able to recreate a equivalent class at deserialization time.</li>
<li>Types that keep and use system resources like file handles, sockets, pipes and so on. ClassLoader, FileInputStream, FileOutputStream, Socket and so on. To deserialize such a class the converter must be able to claim the appropriate resource from the system again. With the help of a custom converter this might be possible, but with the reflection converter the deserialized class might refer a system resource that is no longer valid or belongs to somebody else. Behavior is undefined then.</li>
<li>A very special case of such allocated system resources are those classes that keep handles to system memory directly, because they are partly implemented native. It is known to be true for the Linux version of Sun&#39;s JDK that the BufferedImage references some system specific types of the JDK that themselves have member fields with such memory handles. While it is possible at first sight to serialize and deserialize a BufferedImage, the reflection converter will also duplicate the memory handle. As a result the JVM might crash easily because of freeing unallocated memory or freeing the same memory twice. It might be possible to create a custom converter, but the data structure is really complex in this area and nobody has been investigating so far to such an extent. However, <strong>do not use the reflection converter for these types! You have been warned!</strong></li>
</ol>
<h2 id="how-do-i-specify-that-a-field-should-not-be-serialized-">How do I specify that a field should not be serialized?</h2>
<p>Make it</p>
<p>transient
, specify it with</p>
<p>XStream.omitField()
or annotate it with @XStreamOmitField</p>
<h2 id="how-do-i-initialize-a-transient-field-at-deserialization-">How do I initialize a transient field at deserialization?</h2>
<p>XStream uses the same mechanism as the JDK serialization. Example:
class ThreadAwareComponent { private transient ThreadLocal component; // ... private Object readResolve() { component = new ThreadLocal(); return this; } }</p>
<h2 id="xstream-is-not-calling-the-default-constructor-during-deserialization-">XStream is not calling the default constructor during deserialization.</h2>
<p>This is, in fact, the same case as above. XStream uses the same mechanism as the JDK serialization. When using the enhanced mode with the optimized reflection API, it does not invoke the default constructor. The solution is to implement the readResolve method as above:
class MyExecutor { private Object readResolve() { // do what you need to do here System.out.println(&quot;After instantiating MyExecutor&quot;); // at the end returns itself return this; } }</p>
<h2 id="what-do-serialized-collections-look-like-">What do serialized collections look like?</h2>
<p>See example for the <a href="http://xstream.codehaus.org/converters.html#java.util" target="_blank">CollectionConverter</a>.</p>
<p>Note, that it is possible to configure XStream to omit the container element toys using implicit collections.</p>
<h2 id="do-my-classes-have-to-implement-serializable-if-xstream-is-to-serialize-them-">Do my classes have to implement Serializable if XStream is to serialize them?</h2>
<p>No.</p>
<h2 id="can-dynamic-proxies-be-serialized-">Can dynamic proxies be serialized?</h2>
<p>Yes.</p>
<h2 id="can-cglib-proxies-be-serialized-">Can CGLIB proxies be serialized?</h2>
<p>Only limitedly. A proxy generated with the CGLIB Enhancer is supported, if the proxy uses either a factory or only one callback. Then it is possible to recreate the proxy instance at unmarshalling time. Starting with XStream 1.3.1 CGLIB support is no longer automatically installed because of possible classloader problems and side-effects, because of incompatible ASM versions. You can enable CGLIB support with:
XStream xstream = new XStream() { protected MapperWrapper wrapMapper(MapperWrapper next) { return new CGLIBMapper(next); } }; xstream.registerConverter(new CGLIBEnhancedConverter(xstream.getMapper(), xstream.getReflectionProvider()));</p>
<h2 id="cglibenhancedconverter-fails-at-initialization-with-exceptionininitializererror">CGLIBEnhancedConverter fails at initialization with ExceptionInInitializerError</h2>
<p>This is not a problem of XStream. You have incompatible ASM versions in your classpath. CGLIB 2.1.x and below is based on ASM 1.5.x which is incompatible to newer versions that are used by common packages like Hibernate, Groovy or Guice. Check your dependencies and ensure that you are using either using cglib-nodep-2.x.jar instead of cglib-2.x.jar or update to cglib-2.2.x that depends on ASM 3.1. However, the <em>nodep</em> version contains a copy of the ASM classes with private packages and will therefore not raise class incompatibilities at all.</p>
<h2 id="serialization-fails-with-nosuchmethoderror-net-sf-cglib-proxy-enhancer-isenhanced-ljava-lang-class-z">Serialization fails with NoSuchMethodError: net.sf.cglib.proxy.Enhancer.isEnhanced(Ljava/lang/Class;)Z</h2>
<p>XStream uses this method to detect a CGLIB-enhanced proxy. Unfortunately the method is not available in the cglib-2.0 version. Since this version is many years old and the method is available starting with cglib-2.0.1, please consider an upgrade of the dependency, it works usually smoothly.</p>
<h2 id="my-attributes-are-interpreted-by-xstream-itself-and-cause-unexpected-behavior">My attributes are interpreted by XStream itself and cause unexpected behavior</h2>
<p>XStream&#39;s generic converters and the marshalling strategies use a number of attributes on their own. Especially the attributes named <em>id</em>, <em>class</em> and <em>reference</em> are likely to cause such collisions. Main reason is XStream&#39;s history, because originally user defined attributes were not supported and all attribute were system generated. Starting with XStream 1.3.1 you can redefine those attributes to allow the names to be used for your own ones. The following snippet defines XStream to use different system attributes for <em>id</em> and <em>class</em> while the field <em>id</em> of YourClass is written into the attribute <em>class</em>:
XStream xstream = new XStream() { xstream.useAttributeFor(YourClass.class, &quot;id&quot;); xstream.aliasAttribute(&quot;class&quot;, &quot;id&quot;); xstream.aliasSystemAttribute(&quot;type&quot;, &quot;class&quot;); xstream.aliasSystemAttribute(&quot;refid&quot;, &quot;id&quot;);</p>
<h2 id="can-i-select-the-field-order-in-which-xstream-serializes-objects-">Can I select the field order in which XStream serializes objects?</h2>
<p>Yes. XStream&#39;s ReflectionConverter uses the defined field order by default. You can override it by using an specific FieldKeySorter:
SortableFieldKeySorter sorter = new SortableFieldKeySorter(); sorter.registerFieldOrder(MyType.class, new String[] { &quot;firstToSerialize&quot;, &quot;secondToSerialize&quot;, &quot;thirdToSerialize&quot; }); xstream = new XStream(new Sun14ReflectionProvider(new FieldDictionary(sorter)));</p>
<h2 id="how-does-xstream-deal-with-newer-versions-of-classes-">How does XStream deal with newer versions of classes?</h2>
<ul>
<li>If a new field is added to the class, deserializing an old version will leave the field uninitialized.</li>
<li>If a field is removed from the class, deserializing an old version that contains the field will cause an exception. Leaving the field in place but declaring it as transient will avoid the exception, but XStream will not try to deserialize it.</li>
<li>If a class is renamed, aliases can be used to create an abstraction between the name used in XML and the real class name.</li>
<li>If a field is renamed, this should be treated as adding a field and removing a field.</li>
</ul>
<p>For more advanced class migrations, you may</p>
<ul>
<li>have to do custom pre-processing of the XML before sending it to XStream (for example, with XSLT or DOM manipulations)</li>
<li>declare new fields as transient</li>
<li>implement your own converter, that can handle the situation</li>
<li>add a readResolve() method to your class, that initializes the object accordingly</li>
<li>implement a custom mapper to ignore unknown fields automatically (see acceptance test CustomMapperTest.testCanBeUsedToOmitUnexpectedElements())</li>
</ul>
<p>Future versions of XStream will include features to make these type of migrations easier.</p>
<h2 id="how-does-xstream-cope-with-isolated-class-loaders-">How does XStream cope with isolated class loaders?</h2>
<p>Serializing an object graph is never a problem, even if the classes of those objects have been loaded by a different class loader. The situation changes completely at deserialization time. In this case you must set the class loader to use with:
xstream.setClassLoader(yourClassLoader);</p>
<p>Although XStream caches a lot of type related information to gain speed, it keeps those information in tables with weak references that should be cleaned by the garbage collector when the class loader is freed.</p>
<p>Note, that this call should be made quite immediately after creating the XStream and before any other configuration is done. Otherwise configuration based on special types might refer classes loaded with the wrong classloader.</p>
<h1 id="xml-specifics">XML specifics</h1>
<h2 id="why-does-xstream-not-respect-the-encoding-in-the-xml-declaration-">Why does XStream not respect the encoding in the XML declaration?</h2>
<p>XStream architecture is based on IO Readers and Writers, while the XML declaration is the responsibility of XML parsers. XStream all <a href="http://xstream.codehaus.org/javadoc/com/thoughtworks/xstream/io/HierarchicalStreamDriver.html" target="_blank">HierarchicalStreamDriver</a> implementation respect the encoding since version 1.3, but only if you provide an <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/io/InputStream.html" target="_blank">InputStream</a>. If XStream consumes a <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/io/Reader.html" target="_blank">Reader</a> you have to initialize the reader with the appropriate encoding yourself, since it is now the reader&#39;s task to perform the encoding and no XML parser can change the encoding of a Reader and any encoding definition in the XML header will be ignored.</p>
<h2 id="why-does-xstream-not-write-an-xml-declaration-">Why does XStream not write an XML declaration?</h2>
<p>XStream is designed to write XML snippets, so you can embed its output into an existing stream or string. You can write the XML declaration yourself into the Writer before using it to call XStream.toXML(writer).</p>
<h2 id="why-does-xstream-not-write-xml-in-utf-8-">Why does XStream not write XML in UTF-8?</h2>
<p>XStream does no character encoding by itself, it relies on the configuration of the underlying XML writer. By default it uses its own PrettyPrintWriter which writes into the default encoding of the current locale. To write UTF-8 you have to provide a <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/io/Writer.html" target="_blank">Writer</a> with the appropriate encoding yourself.</p>
<h2 id="why-do-field-names-suddenly-have-double-underscores-in-the-generated-xml-">Why do field names suddenly have double underscores in the generated XML?</h2>
<p>XStream maps Java class names and field names to XML tags or attributes. Unfortunately this mapping cannot be 1:1, since some identifiers of Java contain a dollar sign which is invalid in XML names. Therefore XStream uses an <a href="http://xstream.codehaus.org/javadoc/com/thoughtworks/xstream/io/xml/XmlFriendlyReplacer.html" target="_blank">XmlFriendlyReplacer</a> to replace this character with a replacement. By default this replacement uses an underscore and therefore the replacer must escape the underscore itself also. You may provide a different configured instance of the XmlFriendlyReplacer or a complete own implementation, but you must ensure, that the resulting names are valid for XML.</p>
<h2 id="xstream-fails-to-unmarshal-my-given-xml-and-i-do-not-know-why-">XStream fails to unmarshal my given XML and I do not know why?</h2>
<p>By default XStream is written for persistence i.e. it will read the XML it can write. If you have to transform a given XML into an object graph, you should go the other way round. Use XStream to transfer your objects into XML. If the written XML matches your schema, XStream is also able to read it. This way is much easier, since you can spot the differences in the XML much more easy than to interpret the exceptions XStream will throw if it cannot match the XML into your objects.</p>
<h2 id="my-parser-claims-the-x0-character-to-be-invalid-but-it-was-written-with-xstream-">My parser claims the &amp;/#x0; character to be invalid, but it was written with XStream!</h2>
<p>Your parser is basically right! A character of value 0 is not valid as part of XML according the XML specification (see version <a href="http://www.w3.org/TR/2006/REC-xml-20060816/#charsets" target="_blank">1.0</a> or <a href="http://www.w3.org/TR/2006/REC-xml11-20060816/#charsets" target="_blank">1.1</a>), neither directly nor as character entity nor within CDATA. But not every parser respects this part of the specification (e.g. Xpp3 will ignore it and read character entities). If you expect such characters in your strings and you do not use the Xpp3 parser, you should consider to use a converter that writes the string as byte array in Base64 code. As alternative you may force the <a href="http://xstream.codehaus.org/javadoc/com/thoughtworks/xstream/io/xml/PrettyPrintWriter.html" target="_blank">PrettyPrintWriter</a> or derived writers to be XML 1.0 or 1.1. compliant, i.e. in this mode a StreamException is thrown.</p>
<h2 id="my-parser-claims-a-control-character-to-be-invalid-but-it-was-written-with-xstream-">My parser claims a control character to be invalid, but it was written with XStream!</h2>
<p>Your parser is probably right! Control characters are only valid as part of XML 1.1. You should add an XML header declaring this version or use a parser that does not care about this part of the specification (e.g. Xpp3 parser).</p>
<h2 id="why-is-my-element-not-written-as-xml-attribute-although-i-have-configured-it-">Why is my element not written as XML attribute although I have configured it?</h2>
<p>You can only write types as attributes that are represented as a single String value and are handled therefore by SingleValueConverter implementations. If your type is handled by a Converter implementation, the configuration of XStream to write an attribute (using XStream.useAttributeFor() or @XStreamAsAttribute) is simply ignored.</p>
<h2 id="why-are-whitespace-characters-missing-in-my-attribute-values-after-deserialization-">Why are whitespace characters missing in my attribute values after deserialization?</h2>
<p>This is part of the XML specification and a required functionality for any XML parser called <a href="http://www.w3.org/TR/2006/REC-xml-20060816/#AVNormalize" target="_blank">attribute value normalization</a>. It cannot be influenced by XStream. Do not use attributes if your values contain leading or trailing whitespaces, other whitespaces than blanks, or sequences of whitespaces.</p>
<h2 id="why-does-xstream-not-have-any-namespace-support-">Why does XStream not have any namespace support?</h2>
<p>Not every XML parser supports namespaces and not every XML parser that supports namespaces can be configured within XStream to use those. Basically namespaces must be supported individually for the different XML parsers and the only support for namespaces that has currently been implemented in XStream is for the StAX paser. Therefore use and configure the StaxDriver of XStream to use namespaces.</p>
<h1 id="json-specifics">JSON specifics</h1>
<h2 id="why-are-there-two-json-driver-implementations-">Why are there two JSON driver implementations?</h2>
<p>As always, first for historical reasons! Main difference is that the <a href="http://xstream.codehaus.org/javadoc/com/thoughtworks/xstream/io/json/JettisonMappedXmlDriver.html" target="_blank">JettisonMappedXmlDriver</a> is a thin wrapper around <a href="http://jettison.codehaus.org/" target="_blank">Jettison</a> in combination with the <a href="http://xstream.codehaus.org/javadoc/com/thoughtworks/xstream/io/xml/StaxDriver.html" target="_blank">StaxDriver</a>, while the <a href="http://xstream.codehaus.org/javadoc/com/thoughtworks/xstream/io/json/JsonHierarchicalStreamDriver.html" target="_blank">JsonHierarchicalStreamDriver</a> uses an own more flexible implementation, but can only be used to generate JSON, deserialization is not implemented.</p>
<h2 id="why-is-it-not-possible-to-deserialize-a-json-string-starting-with-an-array-">Why is it not possible to deserialize a JSON string starting with an array?</h2>
<p>XStream&#39;s implementation to deserialize JSON is based on Jettison and StAX. Jettison implements a XMLStreamReader of StaX and transforms the processed JSON virtually into XML first. However, if the JSON string starts with an array it is not possible for Jettison to create a valid root element, since it has no name.</p>
<h2 id="xstream-fails-to-unmarshal-my-json-string-and-i-do-not-know-why-">XStream fails to unmarshal my JSON string and I do not know why?</h2>
<p>Deserialization of JSON is currently done by Jettison, that transforms the JSON string into a StAX stream. XStream itself does nothing know about the JSON format here. If your JSON string reaches some kind of complexity and you do not know how to design your Java objects and configure XStream to match those, you should have a look at the intermediate XML that is processed by XStream in the end. This might help to identify the problematic spots. Also consider then <a href="http://xstream.codehaus.org/faq.html#XML_unmarshalling_fails" target="_blank">marshalling your Java objects into XML first</a>. You can use following code to generate the XML:
String json = &quot;{\&quot;string\&quot;: \&quot;foo\&quot;}&quot;; HierarchicalStreamDriver driver = new JettisonMappedXmlDriver(); StringReader reader = new StringReader(json); HierarchicalStreamReader hsr = driver.createReader(reader); StringWriter writer = new StringWriter(); new HierarchicalStreamCopier().copy(hsr, new PrettyPrintWriter(writer)); writer.close(); System.out.println(writer.toString());</p>
<h2 id="what-limitations-has-xstream-s-json-support-">What limitations has XStream&#39;s JSON support?</h2>
<p>JSON represents a very simple data model for easy data transfer. Especially it has no equivalent for XML attributes. Those are written with a leading &quot;@&quot; character, but this is not always possible without violating the syntax (e.g. for array types). Those may silently dropped (and makes it therefore difficult to implement deserialization). References are another issue in the serialized object graph, since JSON has no possibility to express such a construct. You should therefore always set the NO_REFERENCES mode of XStream.</p>
<h2 id="why-are-there-invalid-characters-in-my-json-representation-">Why are there invalid characters in my JSON representation?</h2>
<p>The JSON spec requires any JSON string to be in UTF-8 encoding. However, XStream ensures this only if you provide an InputStream or an OutputStream. If you provide a Reader or Writer you have to ensure this requirement on your own.</p>
<h2 id="the-generated-json-is-invalid-it-contains-a-dash-in-the-label-">The generated JSON is invalid, it contains a dash in the label!</h2>
<p>Well, no, the JSON is valid! Please check yourself with the <a href="http://www.jslint.com/" target="_blank">JSON syntax checker</a>. However, some JavaScript libraries silently assume that the JSON labels are valid JavaScript identifiers, because JavaScript supports a convenient way to address an element, <strong>if</strong> the label is a valid JavaScript identifier:
var json = {&quot;label&quot;: &quot;foo&quot;, &quot;label-with-dash&quot;: &quot;bar&quot;}; var fooVar = json.label; // works for labels that are JavaScript identifiers var barVar = json[&quot;label-with-dash&quot;]; // using an array index works always</p>
<p>As alternative you may wrap the JsonWriter and replace any dash with an underscore:</p>
<p>HierarchicalStreamDriver driver = new JsonHierarchicalStreamDriver() { public HierarchicalStreamWriter createWriter(Writer out) { return new WriterWrapper(super.createWriter(out)) { public void startNode(String name) { startNode(name, null); } public void startNode(String name, Class clazz) { wrapped.startNode(name.replace(&#39;-&#39;, &#39;_&#39;), clazz); } } } }; XStream xstream = new XStream(driver);</p>
<h1 id="comparison-to-other-products">Comparison to other products</h1>
<h2 id="how-does-xstream-compare-to-java-beans-xmlencoder-">How does XStream compare to java.beans.XMLEncoder?</h2>
<p>XStream is designed for serializing objects using internal fields, whereas <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/beans/XMLEncoder.html" target="_blank">XMLEncoder</a> is designed for serializing JavaBeans using public API methods (typically in the form of</p>
<p>getXXX()
,</p>
<p>setXXX()
,</p>
<p>addXXX()
and</p>
<p>removeXXX()
methods.</p>
<h2 id="how-does-xstream-compare-to-jaxb-java-api-for-xml-binding-">How does XStream compare to JAXB (Java API for XML Binding)?</h2>
<p>JAXB is a Java binding tool. It generates Java code from a schema and you are able to transform from those classes into XML matching the processed schema and back. Note, that you cannot use your own objects, you have to use what is generated.</p>
<h1 id="scalability">Scalability</h1>
<h2 id="is-xstream-thread-safe-">Is XStream thread safe?</h2>
<p>Yes. Once the XStream instance has been created and configured, it may be shared across multiple threads allowing objects to be serialized/deserialized concurrently (unless you enable the auto.detection and processing of annotations). Actually the creation and initialization of XStream is quite expensive, therefore it is recommended to keep the XStream instance itself.</p>
<h2 id="how-much-memory-does-xstream-consume-">How much memory does XStream consume?</h2>
<p>This cannot be answered in general, but following topics have impact on the memory:</p>
<ol>
<li>XML parser technology in use: You should use a streaming parser like Xpp3 or StAX. DOM-based parsers process the complete XML and create their document model in memory before the first converter of XStream is called.</li>
<li>Your object model: Is it necessary to keep the complete object graph in memory at once. As alternative you might use <a href="http://xstream.codehaus.org/objectstream.html" target="_blank">object streams</a> or write custom converters that can load and save objects of your object model on the fly without adding them to the object graph physically. As example see the implementation of the <a href="http://xstream.codehaus.org/javadoc/com/thoughtworks/xstream/persistence/XmlArrayList.html" target="_blank">XmlArrayList</a> in combination with the <a href="http://xstream.codehaus.org/javadoc/com/thoughtworks/xstream/persistence/FileStreamStrategy.html" target="_blank">FileStreamStrategy</a> to keep parts of the object graph separate.</li>
<li>References: By default XStream supports references to the same object in an object graph. This implies that XStream keeps track of all serialized and deserialized objects internally. These references are kept with WeakReferences, so that the memory can be freed as soon as nobody references these objects anymore.</li>
<li>XML values: Any tag and attribute value that is converted into a Java String in the object graph will use the same String instance.</li>
<li>XStream caches: To increase performance XStream caches quite a lot like classes, converters to use, aliasing, tag names. All those caches make usage of WeakReferences or will exist only while marshalling one object graph resp. unmarshalling one input stream.</li>
</ol>
<h2 id="can-the-performance-of-xstream-be-increased-">Can the performance of XStream be increased?</h2>
<p>XStream is a generalizing library, it inspects and handles your types on the fly. Therefore it will normally be slower than a piece of optimized Java code generated out of a schema. However, it is possible to increase the performance anyway:</p>
<ul>
<li>Write custom converters for those of your types that occur very often in your XML.</li>
<li>Keep a configured XStream instance for multiple usage. Creation and initialization is quite expensive compared to the overhead of XStream when calling marshall or unmarshal.</li>
<li>Use Xpp3 or StAX parsers.</li>
</ul>
<p>Note, you should never try to optimize code for performance simply because you <strong>believe</strong> that you have detected a bottle neck. Always use proper tools like a profiler to verify where your hotspots are and whether your optimization was really successful or not.</p>
<h1 id="uses-of-xstream">Uses of XStream</h1>
<h2 id="is-xstream-a-data-binding-tool-">Is XStream a data binding tool?</h2>
<p>No. It is a serialization tool.</p>
<h2 id="can-xstream-generate-classes-from-xsd-">Can XStream generate classes from XSD?</h2>
<p>No. For this kind of work a data binding tool such as <a href="http://xmlbeans.apache.org/" target="_blank">XMLBeans</a> is appropriate.</p>
<h2 id="why-is-there-no-saxreader-">Why is there no SaxReader?</h2>
<p>XStream works on a stream-based parser model, while SAX is event-based. The stream based model implies, that the caller consumes the individual tokens from the XML parser on demand, while in an event-based model the parser controls the application flow on its own and will use callbacks to support client processing. The different architecture makes it therefore impossible for XStream to use an event-driven XML parser.</p>
<h1 id="software">Software</h1>
<ul>
<li><a href="http://xstream.codehaus.org/index.html" target="_blank">About XStream</a></li>
<li><a href="http://xstream.codehaus.org/news.html" target="_blank">News</a></li>
<li><a href="http://xstream.codehaus.org/changes.html" target="_blank">Change History</a></li>
<li><a href="http://xstream.codehaus.org/versioning.html" target="_blank">About Versioning</a></li>
</ul>
<h1 id="evaluating-xstream">Evaluating XStream</h1>
<ul>
<li><a href="http://xstream.codehaus.org/tutorial.html" target="_blank">Two Minute Tutorial</a></li>
<li><a href="http://xstream.codehaus.org/graphs.html" target="_blank">Object references</a></li>
<li><a href="http://xstream.codehaus.org/manual-tweaking-output.html" target="_blank">Tweaking the Output</a></li>
<li><a href="http://xstream.codehaus.org/license.html" target="_blank">License</a></li>
<li><a href="http://xstream.codehaus.org/download.html" target="_blank">Download</a></li>
<li><a href="http://xstream.codehaus.org/references.html" target="_blank">References</a></li>
<li><p><a href="http://www.ohloh.net/projects/3459" target="_blank">Statistics</a></p>
<h1 id="using-xstream">Using XStream</h1>
</li>
<li><p><a href="http://xstream.codehaus.org/architecture.html" target="_blank">Architecture Overview</a></p>
</li>
<li><a href="http://xstream.codehaus.org/converters.html" target="_blank">Converters</a></li>
<li>Frequently Asked Questions</li>
<li><a href="http://xstream.codehaus.org/list-user.html" target="_blank">Users&#39; Mailing List</a></li>
<li><a href="http://xstream.codehaus.org/javadoc/index.html" target="_blank">JavaDoc Core</a></li>
<li><a href="http://xstream.codehaus.org/benchmark-javadoc/index.html" target="_blank">JavaDoc Benchmark</a></li>
<li><a href="http://xstream.codehaus.org/issues.html" target="_blank">Reporting Issues</a></li>
</ul>
<h1 id="tutorials">Tutorials</h1>
<ul>
<li><a href="http://xstream.codehaus.org/tutorial.html" target="_blank">Two Minute Tutorial</a></li>
<li><a href="http://xstream.codehaus.org/alias-tutorial.html" target="_blank">Alias Tutorial</a></li>
<li><a href="http://xstream.codehaus.org/annotations-tutorial.html" target="_blank">Annotations Tutorial</a></li>
<li><a href="http://xstream.codehaus.org/converter-tutorial.html" target="_blank">Converter Tutorial</a></li>
<li><a href="http://xstream.codehaus.org/objectstream.html" target="_blank">Object Streams Tutorial</a></li>
<li><a href="http://xstream.codehaus.org/persistence-tutorial.html" target="_blank">Persistence API Tutorial</a></li>
<li><p><a href="http://xstream.codehaus.org/json-tutorial.html" target="_blank">JSON Tutorial</a></p>
<h1 id="developing-xstream">Developing XStream</h1>
</li>
<li><p><a href="http://xstream.codehaus.org/how-to-contribute.html" target="_blank">How to Contribute</a></p>
</li>
<li><a href="http://xstream.codehaus.org/list-dev.html" target="_blank">Developers&#39; Mailing List</a></li>
<li><a href="http://xstream.codehaus.org/team.html" target="_blank">Development Team</a></li>
<li><a href="http://xstream.codehaus.org/repository.html" target="_blank">Source Repository</a></li>
<li><a href="http://bamboo.ci.codehaus.org/browse/XSTREAM" target="_blank">Continuous Integration</a></li>
</ul>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/xml/">xml</a></li></span><span class="breadcrumb"><li><a href="/categories/xml/">xml</a></li><li><a href="/categories/xml/xstream/">xstream</a></li></span></span> | <span class="tags">Tagged <a href="/tags/xml/" class="label label-primary">xml</a><a href="/tags/xstream/" class="label label-success">xstream</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:44"datetime="2014-03-07 09:54:44"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-xml-xstream--XStream-FrequentlyAskedQuestions/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-xml-xstream--XStream-FrequentlyAskedQuestions" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-Nutz--Nutz的数据库事务/">Nutz的 数据库事务</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:44.000Z"> <a href="/2014/02/02/2014-02-02-Nutz--Nutz的数据库事务/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="nutz-">Nutz的 数据库事务</h1>
<p>1.数据库事务
 数据库的事务是作为单个逻辑工作单元执行的一系列操作。一个逻辑工作单元必须有四个属性，称为原子性、一致性、隔离性和持久性 (ACID) 属性，只有这样才能成为一个事务。一般来讲，隔离性是通过锁机制来实现，而其他三个特性通过日志机制实现。
 当一个数据库的某些数据由多个客户端并发访问操作的时候，可能会出现一系列的问题：(1)脏读(dirty read),(2)不可重复读(unrepeatable read),(3)幻象读(phantom read),(4)丢失更新</p>
<p>2.使用Nutz来处理事务
 在nutz中使用一个类org.nutz.trans.Trans来处理事务，使用方式如下：
Java代码  <a href="&quot;收藏这段代码&quot;"><img src="" alt="收藏代码"></a></p>
<ol>
<li>//TODO 选择事务级别   </li>
<li>int level=Connection.TRANSACTION_SERIALIZABLE;  </li>
<li>Trans.exec(level, new Atom(){  </li>
<li>@Override  </li>
<li>public void run() {  </li>
<li>//TODO 事务内的操作逻辑  </li>
<li>}     </li>
<li>});  </li>
</ol>
<p>  当然你也可是使用如下默认方式：</p>
<p>Java代码  <a href="&quot;收藏这段代码&quot;"><img src="" alt="收藏代码"></a></p>
<ol>
<li>Trans.exec(new Atom(){  </li>
<li>@Override  </li>
<li>public void run() {  </li>
<li>//TODO   </li>
<li>}  </li>
<li><p>});  </p>
<p>在这种情况下，level默认是Connection.TRANSACTION_READ_COMMITTED
注：如果你使用jdbc来直接操作事务，当然你可以在某一个位置设置保存点，如果事务失败，可以回滚到那个点，在nutz中整个事务要么成功，要么失败，全部回滚。如果你希望使用savepoint改怎么办呢，你可以这么用：</p>
</li>
</ol>
<p>Java代码  <a href="&quot;收藏这段代码&quot;"><img src="" alt="收藏代码"></a></p>
<ol>
<li>Dao dao=null;  </li>
<li>dao.run(new ConnCallback(){  </li>
<li>@Override  </li>
<li>public void invoke(Connection conn) throws Exception {  </li>
<li>// TODO 在这里面使用Connection来操作     </li>
<li>}     </li>
<li>});  </li>
</ol>
<p>3.ThreadLocal
 Nutz在实现Trans这个类的时候用到了ThreadLcoal（方便了使用者存储变量到当前线程。）,用来存储用户的每一次事务动作。具体实现请参见源代码类org.nutz.trans.Trans。 </p>
<p>来源： <a href="[http://amosleaf.iteye.com/blog/548337](http://amosleaf.iteye.com/blog/548337)">[http://amosleaf.iteye.com/blog/548337](http://amosleaf.iteye.com/blog/548337)</a></p>
<p>4、事务的嵌套</p>
<h2 id="-">设置事务的级别</h2>
<p>在 JDBC 的 java.sql.Connection 接口中定义的 setTransactionIsolation 函数可以设置事务的级别Nutz.Dao 也提供另外一个静态函数，允许你设置事务的级别:</p>
<p><strong>Trans.exec 的函数声明</strong>
public static void exec(int level, Atom... atoms);</p>
<p>这里的第一个参数 level 和 java.sql.Connection 接口中的 setTransactionIsolation 规定的 level 是一样的。下面是在 java.sql.Connection 里面关于 level 参数的 JDoc 说明：</p>
<p>它可以是下列常量中的任意一个值：</p>
<ul>
<li>Connection.TRANSACTION_READ_UNCOMMITTED</li>
<li>Connection.TRANSACTION_READ_COMMITTED</li>
<li>Connection.TRANSACTION_REPEATABLE_READ</li>
<li>Connection.TRANSACTION_SERIALIZABLE</li>
</ul>
<p><strong>注意： </strong>不能使用常量 Connection.TRANSACTION_NONE，因为它的意思是“不支持事务”</p>
<p>关于 level 参数的更多说明，请参看<a href="http://java.sun.com/javase/6/docs/api/java/sql/Connection.html#setTransactionIsolation(int" target="_blank">java.sql.Connection 的文档</a>)</p>
<p>不同的数据库，对于 JDBC 事务级别的规范，支持的力度不同。请参看相应数据库的文档，已 确定你设置的数据库事务级别是否被支持。</p>
<p><a href="http://code.google.com/p/nutz/wiki/dao_transaction#Top" target="_blank">/#Top</a></p>
<h2 id="-"><a href=""></a>事务的嵌套</h2>
<p>Nutz 的事务模板可以嵌套吗？ 答案是肯定的。事实上，Nutz 支持事务模板的无限层级嵌套。</p>
<p>这里，如果每一层嵌套，指定的事务级别有所不同，不同的数据库，可能引发不可预知的错误。所以，嵌套的事务模板的事务，将以最顶层的事务为级别为标准。就是说，如果最顶层的事务级别为 &#39;TRANSACTION_READ_COMMITTED&#39;，那么下面所包含的所有事务，无论你指定什么样的事务级别，都是 &#39;TRANSACTION_READ_COMMITTED&#39;， 这一点，由抽象类 Transaction 来保证。其 setLevel 当被设置了一个大于 0 的整数以后，将不再 接受任何其他的值。</p>
<p>你可以通过继承 Transaction 来修改这个默认的行为，当然，这个行为修改一般是没有必要的。</p>
<p>另外，你还可能需要知道，通过 Trans.setup 方法，能让整个虚拟机的 Nutz 事务操作都使用你的 Transaction 实现</p>
<p>下面我给出两个例子:</p>
<p><strong>最外层模板决定了整个事务的级别:</strong>
Trans.exec(Connection.TRANSACTION_READ_COMMITTED, new Atom(){
        public void run(){
                dao.update(xxx);
                dao.update(bbb);
                // 在下层模板，虽然你指定了新的事务级别，但是这里的事务级别还是
                // &#39;TRANSACTION_READ_COMMITTED&#39;。在一个事务中，级别一旦设定就不可更改
                Trans.exec(Connection.TRANSACTION_SERIALIZABLE, new Atom(){
                        public void run(){
                                dao.update(CCC);
                                dao.update(EEE);
                        }
                });
        }
});</p>
<p><strong>让整个函数都是事务的:</strong></p>
<p>public void updatePet(final Pet pet){
        Trans.exec(new Atom(){
                public void run(){
                        dao.update(pet);
                        dao.update(pet.getMaster());
                }
        });
}
// 在另外一个函数里，可以这么使用
public void updateDogAndCat(final Pet dog, final Pet cat){
        Trans.exec(new Atom(){
                public void run(){
                        updatePet(dog);
                        updatePet(cat);
                }
        });
}</p>
<p>来源： <a href="[http://code.google.com/p/nutz/wiki/dao_transaction](http://code.google.com/p/nutz/wiki/dao_transaction)">[http://code.google.com/p/nutz/wiki/dao_transaction](http://code.google.com/p/nutz/wiki/dao_transaction)</a>
以上需要注意的几个细节,文档还没提及: <strong>1. 数据库连接池的AutoCommit属性</strong> 对于我见到的大部分连接池和数据库驱动,默认情况下AutoCommit=true,应该是为了性能 这就导致如果用户不自行设置的话,Trans的大部分操作都是不可回滚的.故,如果使用Trans,那么务必设置AutoCommit</p>
<p><strong>2. 多个数据源的事务</strong> 大部分情况下,用户都不是使用XA驱动,故,多数据源的事务提交,在最后的提交阶段出错的话,已经执行commit操作的数据源,是不可能回滚的</p>
<p><strong>3. 子线程的事务</strong> 考虑下面的代码:
Trans.exec(new Atom(){   public void run() {       dao.insert(pet);       new MySuperPowerThread().start();       dao.count(Pet.class);   }});</p>
<p>那么MySuperPowerThread的代码并不是在事务模板中执行的,因为这里的事务不会被子线程继承</p>
<p><strong>4. 返回值问题(更新了)</strong> 使用Molecule
Molecule<object> mc = new Molecule<object>() {    public void run() {        dao.insert(pet);        setObj(dao.count(Pet.class));    }};Trans.exec(mc);System.out.println(mc.getObj());</p>
<p>来源： <a href="[http://wendal.net/324.html](http://wendal.net/324.html)">[http://wendal.net/324.html](http://wendal.net/324.html)</a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/Nutz/">Nutz</a></li></span></span> | <span class="tags">Tagged <a href="/tags/Nutz/" class="label label-primary">Nutz</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:44"datetime="2014-03-07 09:54:44"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-Nutz--Nutz的数据库事务/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-Nutz--Nutz的数据库事务" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-AlgorithmGossip-AlgorithmGossip--GrayCode/">GrayCode</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:44.000Z"> <a href="/2014/02/02/2014-02-02-AlgorithmGossip-AlgorithmGossip--GrayCode/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="graycode">GrayCode</h1>
<h1 id="-algorithm-gossip-gray-code-"><a href="">Algorithm Gossip: 格雷码（Gray Code）</a></h1>
<h2 id="-">说明</h2>
<p>Gray Code是一个数列集合，每个数使用二进位来表示，假设使用n位元来表示每个数好了，任两个数之间只有一个位元值不同，例如以下为3位元的Gray Code：
000 001 011 010 110 111 101 100
由定义可以知道，Gray Code的顺序并不是唯一的，例如将上面的数列反过来写，也是一组Gray Code：
100 101 111 110 010 011 001 000
Gray Code是由贝尔实验室的Frank Gray在1940年代提出的，用来在使用PCM（Pusle Code Modulation）方法传送讯号时避免出错，并于1953年三月十七日取得美国专利。</p>
<h2 id="-">解法</h2>
<p>由于Gray Code相邻两数之间只改变一个位元，所以可观 察Gray Code从1变0或从0变1时的位置，假设有4位元的Gray Code如下：
0000 0001 0011 0010 0110 0111 0101 0100
1100 1101 1111 1110 1010 1011 1001 1000
观察奇数项的变化时，我们发现无论它是第几个Gray Code，永远只改变最右边的位元，如果是1就改为0，如果是0就改为1。
观察偶数项的变化时，我们发现所改变的位元，是由右边算来第一个1的左边位元。
以上两个变化规则是固定的，无论位元数为何；所以只要判断位元的位置是奇数还是偶数，就可以决定要改变哪一个位元的值，为了程式撰写方便，将阵列索引 0当作最右边的值，而在列印结果时，是由索引数字大的开始反向列印。
将2位元的Gray Code当作平面座标来看，可以构成一个四边形，您可以发现从任一顶点出发，绕四边形周长绕一圈，所经过的顶点座标就是一组Gray Code，所以您可以得到四组Gray Code。
同样的将3位元的Gray Code当作平面座标来看的话，可以构成一个正立方体，如果您可以从任一顶点出发，将所有的边长走过，并不重复经过顶点的话，所经过的顶点座标顺序之组合也就是一组Gray Code。</p>
<h2 id="-">实作</h2>
<ul>
<li><p>C
/#include <stdio.h>
/#include <stdlib.h>
/#define MAXBIT 20
/#define TRUE 1
/#define CHANGE_BIT(x) x = ((x) == &#39;0&#39; ? &#39;1&#39; : &#39;0&#39;)
/#define NEXT(x) x = (1 - (x))
int main(void) {
char digit[MAXBIT];
int i, bits, odd;
printf(&quot;输入位元数：&quot;);
scanf(&quot;%d&quot;, &amp;bits);
for(i = 0; i &lt; bits; i++) {
digit[i] = &#39;0&#39;;
printf(&quot;0&quot;);
}
printf(&quot;\n&quot;);
odd = TRUE;
while(1) {
if(odd)
CHANGE_BIT(digit[0]);
else {
// 计算第一个1的位置
for(i = 0; i &lt; bits &amp;&amp; digit[i] == &#39;0&#39;; i++) ;
if(i == bits - 1) // 最后一个Gray Code
break;
CHANGE_BIT(digit[i+1]);
}
for(i = bits - 1; i &gt;= 0; i--)
printf(&quot;%c&quot;, digit[i]);
printf(&quot;\n&quot;);
NEXT(odd);
}
return 0;
}</p>
</li>
<li><p>Java
public class GrayCode {
private char[] digit;
private boolean first;
private boolean odd;
private int count;
public GrayCode(int length) {
digit = new char[length];
for(int i = 0; i &lt; length; i++) {
digit[i] = &#39;0&#39;;
}
first = true;
odd = true;
}
public boolean hasNext() {
// 计算第一个1的位置
for(count = 0;
(count &lt; digit.length) &amp;&amp; (digit[count] == &#39;0&#39;);
count++) ;
return count != digit.length - 1;
}
public char[] next() {
if(first) {
first = false;
return digit;
}
if(odd)
chargeBit(digit, 0);
else {
// 最后一个Gray Code 吗
if(hasNext())
chargeBit(digit, count+1);
}
odd = ((odd == true) ? false : true);
return digit;
}
private void chargeBit(char[] digit, int i) {
digit[i] = ((digit[i] == &#39;0&#39;) ? &#39;1&#39; : &#39;0&#39;);
}
public static void main(String[] args) {
GrayCode code = new GrayCode(4);
while(code.hasNext()) {
char[] digit = code.next();
for(int i = digit.length - 1; i &gt;= 0; i--)
System.out.print(digit[i]);
System.out.println();
}
}
}</p>
</li>
</ul>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/AlgorithmGossip/">AlgorithmGossip</a></li></span></span> | <span class="tags">Tagged <a href="/tags/AlgorithmGossip/" class="label label-primary">AlgorithmGossip</a></span> | <span class="time">recent updated:<time title="2014-03-07 10:37:44"datetime="2014-03-07 10:37:44"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-AlgorithmGossip-AlgorithmGossip--GrayCode/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-AlgorithmGossip-AlgorithmGossip--GrayCode" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-AlgorithmGossip-AlgorithmGossip--GCDPNumber/">GCDPNumber</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:44.000Z"> <a href="/2014/02/02/2014-02-02-AlgorithmGossip-AlgorithmGossip--GCDPNumber/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="gcdpnumber">GCDPNumber</h1>
<h1 id="-algorithm-gossip-"><a href="">Algorithm Gossip: 最大公因数、最小公倍数、因式分解</a></h1>
<h2 id="-">说明</h2>
<p>最大公因数使用辗转相除法来求，最小公倍数则由这个公式来求：
GCD /* LCM = 两数乘积</p>
<h2 id="-">解法</h2>
<p>最大公因数可以使用递回与非递回求解，因式分解基本上就是使用小于输入数的数值当作除数，去除以输入数值，如果可以整除就视为因数，要比较快的解法就是求出小于该数的所有质数，并试试看是不是可以整除，求质数的问题是另一个课题，请参考 <a href="">Eratosthenes 筛选求质数</a>。</p>
<h2 id="-">实作（最大公因数、最小公倍数）</h2>
<ul>
<li><p>C
/#include <stdio.h>
/#include <stdlib.h>
int main(void) {
int m, n, r;
int s;
printf(&quot;输入两数：&quot;);
scanf(&quot;%d %d&quot;, &amp;m, &amp;n);
s = m /* n;
while(n != 0) {
r = m % n;
m = n;
n = r;
}
printf(&quot;GCD：%d\n&quot;, m);
printf(&quot;LCM：%d\n&quot;, s/m);
return 0;
}</p>
</li>
<li><p>Java
public class GcdLcm {
public static int gcdOf(int m, int n) {
int r;
while(n != 0) {
r = m % n;
m = n;
n = r;
}
return m;
}
public static int lcmOf(int m, int n) {
return m /* n / gcdOf(m, n);
}
public static void main(String[] args) {
System.out.println(&quot;GCD of (10, 4) = &quot; +
GcdLcm.gcdOf(10, 4));
System.out.println(&quot;LCM of (10, 4) = &quot; +
GcdLcm.lcmOf(10, 4));
}
}</p>
</li>
</ul>
<h2 id="-">实作（因式分解）</h2>
<ul>
<li><p>C（不用质数表）
/#include <stdio.h>
/#include <stdlib.h>
int main(void) {
int i, n;
printf(&quot;请输入整数：&quot;);
scanf(&quot;%d&quot;, &amp;n);
printf(&quot;%d = &quot;, n);
for(i = 2; i /<em> i &lt;= n;) {
if(n % i == 0) {
printf(&quot;%d /</em> &quot;, i);
n /= i;
}
else
i++;
}
printf(&quot;%d\n&quot;, n);
return 0;
}</p>
</li>
<li><p>C（使用质数表）
/#include <stdio.h>
/#include <stdlib.h>
/#define N 1000
int prime(int/<em>); // 求质数表
void factor(int/</em>, int); // 求factor
int main(void) {
int ptable[N+1] = {0};
int count, i, temp;
count = prime(ptable);
printf(&quot;请输入一数：&quot;);
scanf(&quot;%d&quot;, &amp;temp);
factor(ptable, temp);
printf(&quot;\n&quot;);
return 0;
}
int prime(int/<em> pNum) {
int i, j;
int prime[N+1];
for(i = 2; i &lt;= N; i++)
prime[i] = 1;
for(i = 2; i/</em>i &lt;= N; i++) {
if(prime[i] == 1) {
for(j = 2/<em>i; j &lt;= N; j++) {
if(j % i == 0)
prime[j] = 0;
}
}
}
for(i = 2, j = 0; i &lt; N; i++) {
if(prime[i] == 1)
pNum[j++] = i;
}
return j;
}
void factor(int/</em> table, int num) {
int i;
for(i = 0; table[i] /<em> table[i] &lt;= num;) {
if(num % table[i] == 0) {
printf(&quot;%d /</em> &quot;, table[i]);
num /= table[i];
}
else
i++;
}
printf(&quot;%d\n&quot;, num);
}</p>
</li>
<li><p>Java（使用质数表）
import java.util.ArrayList;
public class Factor {
public static int[] factor(int num) {
int[] pNum = Prime.findPrimes(num);
ArrayList list = new ArrayList();
for(int i = 0; pNum[i] /* pNum[i] &lt;= num;) {
if(num % pNum[i] == 0) {
list.add(new Integer(pNum[i]));
num /= pNum[i];
}
else
i++;
}
list.add(new Integer(num));
int[] f = new int[list.size()];
Object[] objs = list.toArray();
for(int i = 0; i &lt; f.length; i++) {
f[i] = ((Integer) objs[i]).intValue();
}
return f;
}
public static void main(String[] args) {
int[] f = Factor.factor(100);
for(int i = 0; i &lt; f.length; i++) {
System.out.print(f[i] + &quot; &quot;);
}
System.out.println();
}
}</p>
</li>
</ul>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/AlgorithmGossip/">AlgorithmGossip</a></li></span></span> | <span class="tags">Tagged <a href="/tags/AlgorithmGossip/" class="label label-primary">AlgorithmGossip</a></span> | <span class="time">recent updated:<time title="2014-03-07 10:37:52"datetime="2014-03-07 10:37:52"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-AlgorithmGossip-AlgorithmGossip--GCDPNumber/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-AlgorithmGossip-AlgorithmGossip--GCDPNumber" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>





<ul id="pagination" class="pagination pagination-lg">
  <li><a class="extend prev" href="/page/24/">&laquo;</a></li><li><a class="page-number" href="/">1</a></li><li><a class="page-number" href="/page/2/">2</a></li><li><span class="space">&hellip;</span></li><li><a class="page-number" href="/page/22/">22</a></li><li><a class="page-number" href="/page/23/">23</a></li><li><a class="page-number" href="/page/24/">24</a></li><li class="active"><li><span class="page-number current">25</span></li><li><a class="page-number" href="/page/26/">26</a></li><li><a class="page-number" href="/page/27/">27</a></li><li><a class="page-number" href="/page/28/">28</a></li><li><span class="space">&hellip;</span></li></li><li><a class="page-number" href="/page/164/">164</a></li><li><a class="page-number" href="/page/165/">165</a></li><li><a class="extend next" href="/page/26/">&raquo;</a></li>
  <div class="clearfix"></div>
</ul></div><!--wapper-->
       </div><!-- ID main-col END -->
       <aside id="sidebar" class="alignright col-sx-6 col-sm-4 col-md-3 col-lg-3">
<div id="widget_search" class="widget panel panel-primary">
    <form action="//google.com/search" method="get" accept-charset="utf-8">
  <div class="input-group">
    <input class="form-control" id="searchbox" type="search" name="q" results="0" placeholder="search">
    <span class="input-group-btn">
      <button class="btn btn-default" type="submit">Go!</button>
    </span>
    <input type="hidden" name="q" value="site:itsolife.com">
  </div>
</form>
</div>

<div id="widget_category" class="widget panel panel-primary">
  <div class="panel-heading">category</div>  <div data-src='category' class='ajax_widgets'>正在加载...</div>
</div>

<div id="widget_recent_posts" class="widget panel panel-primary">
  <div class="panel-heading">recent posts</div>  <div data-src='recent_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_tagcloud" class="widget panel panel-primary">
  <div class="panel-heading">tagcloud</div>  <div data-src='tagcloud' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_latest_update_posts" class="widget panel panel-primary">
  <div class="panel-heading">最近更新</div>  <div data-src='latest_update_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_recent_comments" class="widget panel panel-primary">
  <div class="panel-heading">recent comments</div>  

<div class="list-group-item ds-recent-comments" data-num-items="6" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="50"></div>



</div>

</aside>
       <div class="clearfix"></div>
     </div><!-- row END -->
  </div>
  <footer id="footer" class="container">
  <div class="panel panel-info">
  <section id='footer_widget'></section>  <div class="panel-footer">
  <div id="site-info">
    <span class='author'>
  
  &copy; 2014 RobinChia
  
    &nbsp;&nbsp;</span>
  
  <span id='analytics-51la'></span><span id='analytics-google'>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-48559895-1']);
  _gaq.push(['_trackPageview']);
  _js2load.push({src:('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'});
</script></span><span id='analytics-cnzz'>
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_5774006'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s17.cnzz.com/stat.php%3Fid%3D5774006%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
</span><span id='analytics-baidu'>
<script>
var _hmt = _hmt || [];
_js2load.push({src:"//hm.baidu.com/hm.js?1442f50724afc42380b51f097c43082c"});
</script>
</span>  </div>
  <div id="copyright">Blog powered by <a href='http://zespia.tw/hexo/'><strong>hexo</strong></a> Theme <strong><a href='https://github.com/chenall/hexo-theme-chenall'>chenall</a></strong>(Some change in it)<span class="pull-right"> 更新时间: <em>2014-03-15 17:47:11</em></span></div>
</div>
<div class="clearfix"></div>


  </div>
  </footer>
  
        <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>        
        <script src="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/js/bootstrap.min.js"></script>        
                
        <script src="http://cdn.bootcss.com/prettify/r298/prettify.min.js"></script>    <script type="text/javascript">
   var lang=["bsh", "c", "cc", "cpp", "cs", "csh", "cyc", "cv", "htm", "html",
    "java", "js", "m", "mxml", "perl", "pl", "pm", "py", "rb", "sh",
    "xhtml", "xml", "xsl"];
   var pretty_base='';
   $('script').each(function(){
	var c = $(this).attr('src');
	if (!c)
	    return;
	if (c.match(/(\/)?prettify(\.min)?\.js/i))
	{
	    var index = c.lastIndexOf('/');
	    if (index != -1)
		pretty_base = c.substr(0,index + 1);
	    return false;
	}
   })
   $('pre code').each(function(){
	var c = $(this).attr('class')
	if (!c)
	    return;
	c = c.match(/\s?(lang\-\w+)/i);
	if (c && lang.indexOf(c[1]) == -1)
	{
	    lang.push(c[1]);
	    $.getScript(pretty_base + c[1] + '.min.js');
	}
   })

    $(window).load(function(){
       $("pre").addClass("prettyprint");
       prettyPrint();
    })
</script>    
            <script type="text/javascript">
var duoshuoQuery = {short_name:"robinchia"};
_js2load.push({src:'http://static.duoshuo.com/embed.js',charset:'UTF-8'});
</script>
    
            <!--wumii_relatedItems-->
    
        <script src="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js"></script>    <script type="text/javascript">
(function($){
  $('.entry').each(function(i){
    $(this).find('img').each(function(){
      var alt = this.alt;

      if (alt){
        $(this).before('<span class="caption">' + alt + '</span>');
      }

      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="fancybox' + i + '" />');
    });
  });

  $('.fancybox').fancybox();
})(jQuery);
</script>    
        <script src="http://cdn.bootcss.com/mathjax/2.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>
    
<script type="text/javascript">
$('.ajax_widgets').each(function(){var src=$(this).attr('data-src');if(src)$(this).load('/widgets/'+src+'.html');});
$.each(_js2load,function(index,obj){loadjs(obj.src,obj.charset)});
</script>

<div id="scroll2top">
<img src="/scroll2top/arrow.png"/>
</div>
<script src="/scroll2top/scroll2top.min.js"></script>
<div id="winterland">
  <canvas></canvas>
</div>
<script src="/js/winterland.min.js"></script>

  </body>
</html>
