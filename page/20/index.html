
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>The 20 Page | It so life</title>
<meta name="author" content="RobinChia">

<meta name="description" content="It so life">


<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta property="og:site_name" content="It so life"/>

<!--[if IE]><style>.testIE.IE{display:inline;}</style><![endif]-->
<!--[if lte IE 7]><link rel="stylesheet" href="/css/ie7.css" type="text/css"><![endif]-->
<!--[if (lt IE 9)&(gt IE 7)]><style>.testIE.IE8{display:inline;}</style><![endif]-->
<!--[if gt IE 8]><style>.testIE.IE9{display:inline;}</style><![endif]-->

<link href="/favicon.png" rel="icon">
<link rel="alternate" href="/atom.xml" title="It so life Feed" type="application/atom+xml">

<link rel="stylesheet" href="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.0.3/css/font-awesome.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/prettify/r298/prettify.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" type="text/css">
<link rel="stylesheet" href="/css/style.css" type="text/css">
<!--[if lt IE 9]>
   <style>article,aside,dialog,footer,header,section,footer,nav,figure,menu{display:block}</style>
   <script src="http://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
   <script src="http://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
<link href="http://cdn.staticfile.org/respond.js/1.4.2/respond-proxy.html" id="respond-proxy" rel="respond-proxy" />
<link href="/js/respond.proxy.gif" id="respond-redirect" rel="respond-redirect" />
<script src="/js/respond.proxy.js"></script>
   <script src="http://cdn.bootcss.com/selectivizr/1.0.2/selectivizr-min.js"></script>
<![endif]-->
<script type="text/javascript">
function loadjs(c,d){var a=document.createElement("script");a.async=!0;a.type="text/javascript";a.src=c;a.charset=d||"gbk";(document.getElementsByTagName("HEAD")[0]||document.getElementsByTagName("BODY")[0]).appendChild(a)};
var _protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
var _js2load = [];
</script>

</head>
<body>
      <header id="header" class="container"><nav id="main-nav" class="navbar navbar-default navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="/">It so life</a>
    </div>
    <div  class="collapse navbar-collapse">
      <ul  class="nav navbar-nav">
  
        <li><a href="/" title="Home">Home</a></li>      
        <li><a href="/about/" title="About">About</a></li>      
        <li><a href="/archives/" title="Archives">Archives</a></li>      
      <li class='dropdown'>
        <a class='dropdown-toggle' data-toggle='dropdown' href='#'>website<b class='caret'></b></a>
        <ul class='dropdown-menu pure-menu-selected'>
    
          <li><a href="//groups.google.com/forum/#!forum/pongba" title="TopLanguage">TopLanguage</a></li>    
          <li><a href="//itpub.net/" title="ITPub">ITPub</a></li>    
          <li><a href="//blog.jobbole.com/" title="Bole">Bole</a></li>    
          <li><a href="//nosql-database.org/" title="nosql">nosql</a></li>    
          <li><a href="//gitimmersion.googol.im/" title="Git">Git</a></li>    
        </ul>
      </li>
    
      </ul>
      <ul class="nav navbar-nav navbar-right">
      
        <li><a href="/atom.xml">RSS</a></li>
      
      
        <li><a href="https://twitter.com/robinchia">twitter</a></li>
      
      
      
      
        <li><a href="https://github.com/robinchia">github</a></li>
      
      </ul>
    </div>
  </div>
</nav>
<div class="clearfix"></div>
</header>
  <div id='content' class="container">
     <div class="page-header-wrapper">
      <!--[if lt IE 9]><div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong>提示:</strong>您的浏览器版本太低了,建议升级到 <strong><a href="http://windows.microsoft.com/zh-cn/internet-explorer/download-ie" title="IE9">IE9</a></strong> 以上,本站使用<a href="https://www.google.com/intl/zh-CN/chrome/">Chrome浏览器</a>可以获得最好的显示效果.</div><![endif]-->
      <div class="page-header"><h1 align="center"><big>It so life</big> </h1>
        <h5 align="center"><big>love as life</big></h5>
      </div>
     </div>
     <div class="row">
       <div id="main-col" class="alignleft col-sx-12 col-sm-8 col-md-9 col-lg-9">
      <section id='header_widget'></section>
          <div id="wrapper"><article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-AlgorithmGossip-AlgorithmGossip--HeapSort/">HeapSort</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:44.000Z"> <a href="/2014/02/02/2014-02-02-AlgorithmGossip-AlgorithmGossip--HeapSort/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="heapsort">HeapSort</h1>
<h1 id="-algorithm-gossip-heap-"><a href="">Algorithm Gossip: Heap 排序法 - 改良的选择排序</a></h1>
<h2 id="-">说明</h2>
<p>选择排序法的概念简单，每次从未排序部份选一最小值，插入已排序部份的后端，其时间主要花费于在整个未排序部份寻找最小值，如果能让搜寻最小值的方式加 快，选择排序法的速率也就可以加快，Heap排序法让搜寻的路径由树根至最后一个树叶，而不是整个未排序部份，因而称之为改良的选择排序法。</p>
<h2 id="-">解法</h2>
<p>Heap排序法使用Heap Tree（堆积树），树是一种资料结构，而堆积树是一个二元树，也就是每一个父节点最多只有两个子节点（关于树的详细定义还请见资料结构书籍），堆积树的 父节点若小于子节点，则称之为最小堆积（Min Heap），父节点若大于子节点，则称之为最大堆积（Max Heap），而同一层的子节点则无需理会其大小关系，例如下面就是一个堆积树：
<img src="&quot;Heap 排序&quot;" alt="Heap 排序">
可以使用一维阵列来储存堆积树的所有元素与其顺序，为了计算方便，使用的起始索引是1而不是0，索引1是树根位置，如果左子节点储存在阵列中的索引为s，则其父节点的索引为s/2，而右子节点为s+1，就如上图所示，将上图的堆积树转换为一维阵列之后如下所示：
<img src="&quot;Heap 排序&quot;" alt="Heap 排序">
首先必须知道如何建立堆积树，加至堆积树的元素会先放置在最后一个树叶节点位置，然后检查父节点是否小于子节点（最小堆积），将小的元素不断与父节点交换，直到满足堆积树的条件为止，例如在上图的堆积加入一个元素12，则堆积树的调整方式如下所示：
<img src="&quot;Heap 排序&quot;" alt="Heap 排序">
建立好堆积树之后，树根一定是所有元素的最小值，您的目的就是：</p>
<ol>
<li>将最小值取出</li>
<li>然后调整树为堆积树
不断重复以上的步骤，就可以达到排序的效果，最小值的取出方式是将树根与最后一个树叶节点交换，然后切下树叶节点，重新调整树为堆积树，如下所示：
<img src="&quot;Heap 排序&quot;" alt="Heap 排序">
调整完毕后，树根节点又是最小值了，于是我们可以重覆这个步骤，再取出最小值，并调整树为堆积树，如下所示：
<img src="&quot;Heap 排序&quot;" alt="Heap 排序">
如此重覆步骤之后，由于使用一维阵列来储存堆积树，每一次将树叶与树根交换的动作就是将最小值放至后端的阵列，所以最后阵列就是变为已排序的状态。
其实堆积在调整的过程中，就是一个选择的行为，每次将最小值选至树根，而选择的路径并不是所有的元素，而是由树根至树叶的路径，因而可以加快选择的过程， 所以Heap排序法才会被称之为改良的选择排序法。</li>
</ol>
<h2 id="-">实作</h2>
<ul>
<li><p>C
/#include <stdio.h>
/#include <stdlib.h>
/#include <time.h>
/#define MAX 10
/#define SWAP(x,y) {int t; t = x; x = y; y = t;}
void createheap(int[]);
void heapsort(int[]);
int main(void) {
int number[MAX+1] = {-1};
int i, num;
srand(time(NULL));
printf(&quot;排序前：&quot;);
for(i = 1; i &lt;= MAX; i++) {
number[i] = rand() % 100;
printf(&quot;%d &quot;, number[i]);
}
printf(&quot;\n建立堆积树：&quot;);
createheap(number);
for(i = 1; i &lt;= MAX; i++)
printf(&quot;%d &quot;, number[i]);
printf(&quot;\n&quot;);
heapsort(number);
printf(&quot;\n&quot;);
return 0;
}
void createheap(int number[]) {
int i, s, p;
int heap[MAX+1] = {-1};
for(i = 1; i &lt;= MAX; i++) {
heap[i] = number[i];
s = i;
p = i / 2;
while(s &gt;= 2 &amp;&amp; heap[p] &gt; heap[s]) {
SWAP(heap[p], heap[s]);
s = p;
p = s / 2;
}
}
for(i = 1; i &lt;= MAX; i++)
number[i] = heap[i];
}
void heapsort(int number[]) {
int i, m, p, s;
m = MAX;
while(m &gt; 1) {
SWAP(number[1], number[m]);
m--;
p = 1;
s = 2 /<em> p;
while(s &lt;= m) {
if(s &lt; m &amp;&amp; number[s+1] &lt; number[s])
s++;
if(number[p] &lt;= number[s])
break;
SWAP(number[p], number[s]);
p = s;
s = 2 /</em> p;
}
printf(&quot;\n排序中：&quot;);
for(i = MAX; i &gt; 0; i--)
printf(&quot;%d &quot;, number[i]);
}
}</p>
</li>
<li><p>Java
public class HeapSort {
public static void sort(int[] number) {
int[] tmp = new int[number.length + 1];
// 配合说明，使用一个有遍移的暂存阵列
for(int i = 1; i &lt; tmp.length; i++) {
tmp[i] = number[i-1];
}
createHeap(tmp);
int m = number.length;
while(m &gt; 1) {
swap(tmp, 1, m);
m--;
int p = 1;
int s = 2 /<em> p;
while(s &lt;= m) {
if(s &lt; m &amp;&amp; tmp[s+1] &lt; tmp[s])
s++;
if(tmp[p] &lt;= tmp[s])
break;
swap(tmp, p, s);
p = s;
s = 2 /</em> p;
}
}
// 这边将排序好的暂存阵列设定回原阵列
for(int i = 0; i &lt; number.length; i++) {
number[i] = tmp[i+1];
}
}
private static void createHeap(int[] tmp) {
int[] heap = new int[tmp.length];
for(int i = 0; i &lt; heap.length; i++)
heap[i] = -1;
for(int i = 1; i &lt; heap.length; i++) {
heap[i] = tmp[i];
int s = i;
int p = i / 2;
while(s &gt;= 2 &amp;&amp; heap[p] &gt; heap[s]) {
swap(heap, p, s);
s = p;
p = s / 2;
}
}
for(int i = 1; i &lt; tmp.length; i++)
tmp[i] = heap[i];
}
private static void swap(int[] number, int i, int j) {
int t;
t = number[i];
number[i] = number[j];
number[j] = t;
}
}</p>
</li>
</ul>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/AlgorithmGossip/">AlgorithmGossip</a></li></span></span> | <span class="tags">Tagged <a href="/tags/AlgorithmGossip/" class="label label-primary">AlgorithmGossip</a></span> | <span class="time">recent updated:<time title="2014-03-07 10:37:38"datetime="2014-03-07 10:37:38"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-AlgorithmGossip-AlgorithmGossip--HeapSort/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-AlgorithmGossip-AlgorithmGossip--HeapSort" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-服务器-haproxy--haproxykeepalived实现高可用负载均衡/">haproxy+keepalived实现高可用负载均衡</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:44.000Z"> <a href="/2014/02/02/2014-02-02-服务器-haproxy--haproxykeepalived实现高可用负载均衡/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="haproxy-keepalived-">haproxy+keepalived实现高可用负载均衡</h1>
<p>软件负载均衡一般通过两种方式来实现：基于操作系统的软负载实现和基于第三方应用的软负载实现。LVS就是基于Linux操作系统实现的一种软负载，HAProxy就是开源的并且基于第三应用实现的软负载。</p>
<p>HAProxy相比LVS的使用要简单很多，功能方面也很丰富。当 前，HAProxy支持两种主要的代理模式:&quot;tcp&quot;也即4层（大多用于邮件服务器、内部协议通信服务器等），和7层（HTTP）。在4层模式 下，HAProxy仅在客户端和服务器之间转发双向流量。7层模式下，HAProxy会分析协议，并且能通过允许、拒绝、交换、增加、修改或者删除请求 (request)或者回应(response)里指定内容来控制协议，这种操作要基于特定规则。</p>
<p>我现在用HAProxy主要在于它有以下优点，这里我总结下：</p>
<p><strong>一、</strong>免费开源，稳定性也是非常好，这个可通过我做的一些小项目可以看出来，单Haproxy也跑得不错，稳定性可以与LVS相媲美；</p>
<p><strong>二、</strong>根据官方文档，HAProxy可以跑满10Gbps-New benchmark of HAProxy at 10 Gbps using Myricom&#39;s 10GbE NICs (Myri-10G PCI-Express)，这个作为软件级负载均衡，也是比较惊人的；</p>
<p><strong>三、</strong>HAProxy可以作为MySQL、邮件或其它的非web的负载均衡，我们常用于它作为MySQL(读)负载均衡；</p>
<p>四<strong>、</strong>自带强大的监控服务器状态的页面，实际环境中我们结合Nagios进行邮件或短信报警，这个也是我非常喜欢它的原因之一；</p>
<p>五<strong>、</strong>HAProxy支持虚拟主机。</p>
<p>===================================================================================</p>
<p>在做反向代理服务器的负载均衡时，我们通常会使用nginx的均衡配置。其实，haproxy的负载均衡也是属于这一类的。那么关于这方面的配置过程我们现在来进行一下讲解。首先，对haproxy进行一个简单的介绍，之后就是安装和配置环节了。</p>
<p><strong>HAProxy介绍</strong></p>
<p>反向代理服务器,支持双机热备支持虚拟主机,但其配置简单,拥有非常不错的服务器健康检查功能,当其代理的后端服务器出现故障, HAProxy会自动将该服务器摘除,故障恢复后再自动将该服务器加入｡新的1.3引入了frontend,backend；frontend根据任意 HTTP请求头内容做规则匹配,然后把请求定向到相关的backend.</p>
<p><a href="http://blog.liuts.com/post/223/" target="_blank"><a href="http://blog.liuts.com/post/223/">http://blog.liuts.com/post/223/</a></a> （搭建四层负载均衡器）</p>
<p><a href="http://rfyimcool.blog.51cto.com/1030776/413187" target="_blank"><a href="http://rfyimcool.blog.51cto.com/1030776/413187">http://rfyimcool.blog.51cto.com/1030776/413187</a></a> （搭建七层负载均衡器）</p>
<p>===================================================================================</p>
<p>keepalived简介　　</p>
<p><a href="http://www.keepalived.org/" target="_blank"><a href="http://www.keepalived.org">http://www.keepalived.org</a></a></p>
<p>keepalived是一个类似于layer3, 4 &amp; 5交换机制的软件，也就是我们平时说的第3层、第4层和第5层交换。Keepalived的作用是检测web服务器的状态，如果有一台web服务器死机，或工作出现故障，Keepalived将检测到，并将有故障的web服务器从系统中剔除，当web服务器工作正常后Keepalived自动将web服务器加入到服务器群中，这些工作全部自动完成，不需要人工干涉，需要人工做的只是修复故障的web服务器。</p>
<p>类似的HA工具还有heatbeat、drbd等，heatbeat、drbd配置都较为复杂。</p>
<h2 id="keepalived-">keepalived理论工作原理</h2>
<p>keepalived可提供vrrp以及health-check功能，可以只用它提供双机浮动的vip（vrrp虚拟路由功能），这样可以简单实现一个双机热备高可用功能。</p>
<p>keepalived是一个类似于layer3, 4 &amp; 5交换机制的软件，也就是我们平时说的第3层、第4层和第5层交换。Keepalived的作用是检测web 服务器的状态。 Layer3,4&amp;5工作在IP/TCP协议栈的IP层，TCP层，及应用层,原理分别如下：</p>
<p>Layer3：Keepalived使用Layer3的方式工作式时，Keepalived会定期向服务器群中的服务器</p>
<p>发送一个ICMP的数据包（既我们平时用的Ping程序）,如果发现某台服务的IP地址没有激活，Keepalived便报告这台服务器失效，并将它从服务器群中剔除，这种情况的典型例子是某台服务器被非法关机。Layer3的方式是以服务器的IP地址是否有效作为服务器工作正常与否的标准。在本文中将采用这种方式。</p>
<p>Layer4:如果您理解了Layer3的方式，Layer4就容易了。Layer4主要以TCP端口的状态来决定服务器工作正常与否。如web server的服务端口一般是80，如果Keepalived检测到80端口没有启动，则Keepalived将把这台服务器从服务器群中剔除。</p>
<p>Layer5：Layer5就是工作在具体的应用层了，比Layer3,Layer4要复杂一点，在网络上占用的带宽也要大一些。Keepalived将根据用户的设定检查服务器程序的运行是否正常，如果与用户的设定不相符，则Keepalived将把服务器从服务器群中剔除。</p>
<p>vip即虚拟ip，是附在主机网卡上的，即对主机网卡进行虚拟，此IP仍然是占用了此网段的某个IP。</p>
<h2 id="keepalived-">keepalived作用</h2>
<p>随着你的网站业务量的增长你网站的服务器压力越来越大？需要负载均衡方案！商业的硬件如F5又太贵，你们又是创业型互联公司如何有效节约成本，节省不必要的浪费？同时实现商业硬件一样的高性能高可用的功能？有什么好的负载均衡可伸张可扩展的方案吗？答案是肯定的！有！我们利用 LVS+Keepalived基于完整开源软件的架构可以为你提供一个负载均衡及高可用的服务器。</p>
<p>LVS+Keepalived 介绍</p>
<p>LVS</p>
<p>LVS是Linux Virtual Server的简写，意即Linux虚拟服务器，是一个虚拟的服务器集群系统。本项目在1998年5月由章文嵩博士成立，是中国国内最早出现的自由软件项目之一.目前有三种IP负载均衡技术（VS/NAT、VS/TUN和VS/DR）八种调度算法（rr,wrr,lc,wlc,lblc,lblcr,dh,sh）。</p>
<p>Keepalvied</p>
<p>Keepalived在这里主要用作RealServer的健康状态检查以及LoadBalance主机和BackUP主机之间failover的实现。keepalived简介　　keepalived是一个类似于layer3, 4 &amp; 5交换机制的软件，也就是我们平时说的第3层、第4层和第5层交换。Keepalived的作用是检测web服务器的状态，如果有一台web服务器死机，或工作出现故障，Keepalived将检测到，并将有故障的web服务器从系统中剔除，当web服务器工作正常后Keepalived自动将web服务器加入到服务器群中，这些工作全部自动完成，不需要人工干涉，需要人工做的只是修复故障的web服务器。</p>
<p>===================================================================================</p>
<p><strong>**</strong>Keepalived<strong>介绍**</strong></p>
<p>Keepalived是一个基于VRRP协议来实现的WEB 服务高可用方案，可以利用其来避免单点故障。一个WEB服务至少会有2台服务器运行Keepalived，一台为主服务器（MASTER），一台为备份服务器（BACKUP），但是对外表现为一个虚拟IP，主服务器会发送特定的消息给备份服务器，当备份服务器收不到这个消息的时候，即主服务器宕机的时候，备份服务器就会接管虚拟IP，继续提供服务，从而保证了高可用性。
1 +-------------VIP(192.168.0.7)------------------+</p>
<p>2 | | |
3 | | |</p>
<p>4 server(MASTER) &lt;----keepalived----&gt; server(BACKUP)
5 (192.168.0.1) (192.168.0.2)</p>
<p>keepalived是VRRP的完美实现，因此在介绍keepalived之前，先介绍一下VRRP的原理。</p>
<p><strong>VRRP**</strong>协议简介**</p>
<p>在现实的网络环境中，两台需要通信的主机大多数情况下并没有直接的物理连接。对于这样的情况，它们之间路由怎样选择？主机如何选定到达目的主机的下一跳路由，这个问题通常的解决方法有二种：</p>
<p>· 在主机上使用动态路由协议(RIP、OSPF等)</p>
<p>· 在主机上配置静态路由</p>
<p>很明显，在主机上配置路态路由是非常不切实际的，因为管理、维护成本以及是否支持等诸多问题。配置静态路由就变得十分流行，但路由器(或者说默认网关default gateway)却经常成为单点。</p>
<p>VRRP的目的就是为了解决静态路由单点故障问题。</p>
<p>VRRP通过一竞选(election)协议来动态的将路由任务交给LAN中虚拟路由器中的某台VRRP路由器。</p>
<p><strong>工作机制</strong></p>
<p>在一个VRRP虚拟路由器中，有多台物理的VRRP路由器，但是这多台的物理的机器并不能同时工作，而是由一台称为MASTER的负责路由工作，其它的都是BACKUP，MASTER并非一成不变，VRRP让每个VRRP路由器参与竞选，最终获胜的就是MASTER。MASTER拥有一些特权，比如 拥有虚拟路由器的IP地址，我们的主机就是用这个IP地址作为静态路由的。拥有特权的MASTER要负责转发发送给网关地址的包和响应ARP请求。</p>
<p>VRRP通过竞选协议来实现虚拟路由器的功能，所有的协议报文都是通过IP多播(multicast)包(多播地址 224.0.0.18)形式发送的。虚拟路由器由VRID(范围0-255)和一组IP地址组成，对外表现为一个周知的MAC地址。所以，在一个虚拟路由 器中，不管谁是MASTER，对外都是相同的MAC和IP(称之为VIP)。客户端主机并不需要因为MASTER的改变而修改自己的路由配置，对他们来 说，这种主从的切换是透明的。</p>
<p>在一个虚拟路由器中，只有作为MASTER的VRRP路由器会一直发送VRRP广告包(VRRPAdvertisement message)，BACKUP不会抢占MASTER，除非它的优先级(priority)更高。当MASTER不可用时(BACKUP收不到广告包)， 多台BACKUP中优先级最高的这台会被抢占为MASTER。这种抢占是非常快速的(&lt;1s)，以保证服务的连续性。</p>
<p>由于安全性考虑，VRRP包使用了加密协议进行加密。</p>
<p>==========================================</p>
<p><strong>vrrp简介</strong>
随着Internet的迅猛发展，基于网络的应用逐渐增多。这就对网络的可靠性提出了越来越高的要求。斥资对所有网络设备进行更新当然是一种很好的可靠性解决方案；但本着保护现有投资的角度考虑，可以采用廉价冗余的思路，在可靠性和经济性方面找到平衡点。
虚拟路由冗余协议就是一种很好的解决方案。在该协议中，对共享多存取访问介质（如以太网）上终端IP设备的默认网关(Default Gateway)进行冗余备份，从而在其中一台路由设备宕机时，备份路由设备及时接管转发工作，向用户提供透明的切换，提高了网络服务质量。
一、协议概述
在基于TCP/IP协议的网络中，为了保证不直接物理连接的设备之间的通信，必须指定路由。目前常用的指定路由的方法有两种：一种是通过路由协议（比如：内部路由协议RIP和OSPF）动态学习；另一种是静态配置。在每一个终端都运行动态路由协议是不现实的，大多客户端操作系统平台都不支持动态路由协议，即使支持也受到管理开销、收敛度、安全性等许多问题的限制。因此普遍采用对终端IP设备静态路由配置，一般是给终端设备指定一个或者多个默认网关(Default Gateway)。静态路由的方法简化了网络管理的复杂度和减轻了终端设备的通信开销，但是它仍然有一个缺点：如果作为默认网关的路由器损坏，所有使用该网关为下一跳主机的通信必然要中断。即便配置了多个默认网关，如不重新启动终端设备，也不能切换到新的网关。采用虚拟路由冗余协议 (Virtual Router Redundancy Protocol，简称VRRP)可以很好的避免静态指定网关的缺陷。
在VRRP协议中，有两组重要的概念：VRRP路由器和虚拟路由器，主控路由器和备份路由器。VRRP路由器是指运行VRRP的路由器，是物理实体，虚拟路由器是指VRRP协议创建的，是逻辑概念。一组VRRP路由器协同工作，共同构成一台虚拟路由器。该虚拟路由器对外表现为一个具有唯一固定IP地址和MAC地址的逻辑路由器。处于同一个VRRP组中的路由器具有两种互斥的角色：主控路由器和备份路由器，一个VRRP组中有且只有一台处于主控角色的路由器，可以有一个或者多个处于备份角色的路由器。VRRP协议使用选择策略从路由器组中选出一台作为主控，负责ARP相应和转发IP数据包，组中的其它路由器作为备份的角色处于待命状态。当由于某种原因主控路由器发生故障时，备份路由器能在几秒钟的时延后升级为主路由器。由于此切换非常迅速而且不用改变IP地址和MAC地址，故对终端使用者系统是透明的。
二、工作原理
一个VRRP路由器有唯一的标识：VRID，范围为0—255。该路由器对外表现为唯一的虚拟MAC地址，地址的格式为00-00-5E-00-01-[VRID]。主控路由器负责对ARP请求用该MAC地址做应答。这样，无论如何切换，保证给终端设备的是唯一一致的IP和MAC地址，减少了切换对终端设备的影响。
VRRP控制报文只有一种：VRRP通告(advertisement)。它使用IP多播数据包进行封装，组地址为224.0.0.18，发布范围只限于同一局域网内。这保证了VRID在不同网络中可以重复使用。为了减少网络带宽消耗只有主控路由器才可以周期性的发送VRRP通告报文。备份路由器在连续三个通告间隔内收不到VRRP或收到优先级为0的通告后启动新的一轮VRRP选举。
在VRRP路由器组中，按优先级选举主控路由器，VRRP协议中优先级范围是0—255。若VRRP路由器的IP地址和虚拟路由器的接口IP地址相同，则称该虚拟路由器作VRRP组中的IP地址所有者；IP地址所有者自动具有最高优先级：255。优先级0一般用在IP地址所有者主动放弃主控者角色时使用。可配置的优先级范围为1—254。优先级的配置原则可以依据链路的速度和成本、路由器性能和可靠性以及其它管理策略设定。主控路由器的选举中，高优先级的虚拟路由器获胜，因此，如果在VRRP组中有IP地址所有者，则它总是作为主控路由的角色出现。对于相同优先级的候选路由器，按照IP地址大小顺序选举。VRRP还提供了优先级抢占策略，如果配置了该策略，高优先级的备份路由器便会剥夺当前低优先级的主控路由器而成为新的主控路由器。
为了保证VRRP协议的安全性，提供了两种安全认证措施：明文认证和IP头认证。明文认证方式要求：在加入一个VRRP路由器组时，必须同时提供相同的VRID和明文密码。适合于避免在局域网内的配置错误，但不能防止通过网络监听方式获得密码。IP头认证的方式提供了更高的安全性，能够防止报文重放和修改等攻击。
三、 应用实例
最典型的VRRP应用：RTA、RTB组成一个VRRP路由器组，假设RTB的处理能力高于RTA，则将RTB配置成IP地址所有者，H1、H2、H3的默认网关设定为RTB。则RTB成为主控路由器，负责ICMP重定向、ARP应答和IP报文的转发；一旦RTB失败，RTA立即启动切换，成为主控，从而保证了对客户透明的安全切换。
在VRRP应用中，RTA在线时RTB只是作为后备，不参与转发工作，闲置了路由器RTA和链路L1。通过合理的网络设计，可以到达备份和负载分担双重效果。让RTA、RTB同时属于互为备份的两个VRRP组：在组1中RTA为IP地址所有者；组2中RTB为IP地址所有者。将H1的默认网关设定为RTA；H2、H3的默认网关设定为RTB。这样，既分担了设备负载和网络流量，又提高了网络可靠性。
VRRP协议的工作机理与CISCO公司的HSRP（Hot Standby Routing Protocol）有许多相似之处。但二者主要的区别是在CISCO的HSRP中，需要单独配置一个IP地址作为虚拟路由器对外体现的地址，这个地址不能是组中任何一个成员的接口地址。</p>
<h1 id="-vrrp-">使用VRRP协议，不用改造目前的网络结构，最大限度保护了当前投资，只需最少的管理费用，却大大提升了网络性能，具有重大的应用价值。</h1>
<h1 id="keepalive-vip-">keepalive的简单应用——管理VIP的飘动</h1>
<p>from:<a href="http://www.cnblogs.com/killkill/archive/2010/12/31/1922360.html" target="_blank">http://www.cnblogs.com/killkill/archive/2010/12/31/1922360.html</a></p>
<p>VIP的飘动可以为我们解决很多问题，以前我试过使用ifup/ifdown的方式控制网卡的up/down来实现，这种方式有个小问题，就是每次VIP 飘动之后都要等上几十秒才能生效，感觉时间比较长，而且还要配合一些逻辑脚本才能很好地工作，有没有更好的方法呢？当然有，这就是本文的主角—— keepalived。</p>
<p>安装很简单：
1</p>
<p>tar zxvf keepalived-1.1.20.tar.gz</p>
<p>2</p>
<p>cd keepalived-1.1.20
3</p>
<p>./configure --prefix=/</p>
<p>4</p>
<p>make
5</p>
<p>make install</p>
<p>修改一下 /etc/keepalived/keepalived.conf 这个配置文件就可以用了，以下是我的环境，192.168.10.141和192.168.10.142是两个VIP，可以在两台服务器之间飘动：</p>
<p><img src="" alt=""></p>
<p>主机的配置：
01</p>
<p>global_defs {</p>
<p>02</p>
<p>notification_email {
03</p>
<p>failover@firewall.loc</p>
<p>04</p>
<p>}
05</p>
<p>notification_email_from Alexandre.Cassen@firewall.loc</p>
<p>06</p>
<p>smtp_server 192.168.0.48
07</p>
<p>smtp_connect_timeout 10</p>
<p>08</p>
<p>router_id nginx
09</p>
<p>}</p>
<p>10
11</p>
<p>vrrp_instance VI_141 {</p>
<p>12</p>
<p>state BACKUP
13</p>
<p>interface eth0</p>
<p>14</p>
<p>virtual_router_id 141
15</p>
<p>priority 50</p>
<p>16</p>
<p>advert_int 1
17</p>
<p>authentication {</p>
<p>18</p>
<p>auth_type PASS
19</p>
<p>auth_pass 141</p>
<p>20</p>
<p>}
21</p>
<p>virtual_ipaddress {</p>
<p>22</p>
<p>192.168.10.141/26 dev eth0
23</p>
<p>}</p>
<p>24</p>
<p>}
25</p>
<p>26</p>
<p>vrrp_instance VI_142 {
27</p>
<p>state BACKUP</p>
<p>28</p>
<p>interface eth0
29</p>
<p>virtual_router_id 142</p>
<p>30</p>
<p>priority 100
31</p>
<p>advert_int 1</p>
<p>32</p>
<p>authentication {
33</p>
<p>auth_type PASS</p>
<p>34</p>
<p>auth_pass 142
35</p>
<p>}</p>
<p>36</p>
<p>virtual_ipaddress {
37</p>
<p>192.168.10.142/26 dev eth0</p>
<p>38</p>
<p>}
39</p>
<p>}</p>
<p>备机的配置：</p>
<p>01</p>
<p>global_defs {</p>
<p>02</p>
<p>notification_email {
03</p>
<p>failover@firewall.loc</p>
<p>04</p>
<p>}
05</p>
<p>notification_email_from Alexandre.Cassen@firewall.loc</p>
<p>06</p>
<p>smtp_server 10.168.0.48
07</p>
<p>smtp_connect_timeout 10</p>
<p>08</p>
<p>router_id nginx
09</p>
<p>}</p>
<p>10
11</p>
<p>vrrp_instance VI_141 {</p>
<p>12</p>
<p>state BACKUP
13</p>
<p>interface eth0</p>
<p>14</p>
<p>virtual_router_id 141
15</p>
<p>priority 100</p>
<p>16</p>
<p>advert_int 1
17</p>
<p>authentication {</p>
<p>18</p>
<p>auth_type PASS
19</p>
<p>auth_pass 141</p>
<p>20</p>
<p>}
21</p>
<p>virtual_ipaddress {</p>
<p>22</p>
<p>192.168.10.141/26 dev eth0
23</p>
<p>}</p>
<p>24</p>
<p>}
25</p>
<p>26</p>
<p>vrrp_instance VI_142 {
27</p>
<p>state BACKUP</p>
<p>28</p>
<p>interface eth0
29</p>
<p>virtual_router_id 142</p>
<p>30</p>
<p>priority 50
31</p>
<p>advert_int 1</p>
<p>32</p>
<p>authentication {
33</p>
<p>auth_type PASS</p>
<p>34</p>
<p>auth_pass 142
35</p>
<p>}</p>
<p>36</p>
<p>virtual_ipaddress {
37</p>
<p>192.168.10.142/26 dev eth0</p>
<p>38</p>
<p>}
39</p>
<p>}</p>
<p>乍一看，主机和备机的配置文件是一样的，仔细看一下priority的值，使用以下命令即可将keepalived加入linux的服务中：</p>
<p>1</p>
<p>chkconfig --add keepalived ;</p>
<p>通过启、停keepalived这个服务即可观察到VIP的飘动，至于为什么VIP飘动后可以很快地生效，还有待研究。</p>
<p>===================================================================================</p>
<h2 id="haproxy-keepalived-">haproxy+keepalived实现高可用负载均衡</h2>
<p><img src="http://www.cnblogs.cc2/2054285_112154067_files/11207101_1.gif" alt="" title="此博文包含图片"> 我的环境：
haproxy keepalived 主：192.168.1.192
haproxy keepalived 备：192.168.1.193
vip：192.168.1.200
web：192.168.1.187:80 192.168.1.187:8000
<img src="" alt="">
一：安装过程，在192.168.1.192上：
keepalived的安装:
/#tar -zxvf keepalived-1.1.17.tar.gz
/#ln -s /usr/src/kernels/2.6.18-128.el5-i686/ /usr/src/linux
/#cd keepalived-1.1.17
/#./configure --prefix=/ --mandir=/usr/local/share/man/ --with-kernel-dir=/usr/src/kernels/2.6.18-128.el5-i686/
/#make &amp;&amp; make install
/#cd /etc/keepalived/
/#mv keepalived.conf keepalived.conf.default
/#vi keepalived.conf
! Configuration File for keepalived
vrrp_script chk_http_port {
script &quot;/etc/keepalived/check_haproxy.sh&quot;
interval 2
weight 2
global_defs {
router_id LVS_DEVEL
}
vrrp_instance VI_1 {
state MASTER /#192.168.1.193上改为BACKUP
interface eth0
virtual_router_id 51
priority 150 /#192.168.1.193上改为120
advert_int 1
authentication {
auth_type PASS
auth_pass 1111
}
track_script {
chk_http_port
}
virtual_ipaddress {
192.168.1.200
}
}
}
/#vi /etc/keepalived/check_haproxy.sh
/#!/bin/bash
A=<code>ps -C haproxy --no-header |wc -l</code>
if [ $A -eq 0 ];then
/usr/local/haproxy/sbin/haproxy -f /usr/local/haproxy/conf/haproxy.cfg
sleep 3
if [ <code>ps -C haproxy --no-header |wc -l</code> -eq 0 ];then
/etc/init.d/keepalived stop
fi
fi
/#chmod 755 /etc/keepalived/check_haproxy.sh
haproxy的安装(主备都一样)：
/#tar -zxvf haproxy-1.4.9.tar.gz
/#cd haproxy-1.4.9
/#make TARGET=linux26 PREFIX=/usr/local/haproxy install
/#cd /usr/local/haproxy/
/#mkdir conf logs
/#cd conf
/#vi haproxy.cfg
global
log 127.0.0.1 local3 info
maxconn 4096
user nobody
group nobody
daemon
nbproc 1
pidfile /usr/local/haproxy/logs/haproxy.pid
defaults
maxconn 2000
contimeout 5000
clitimeout 30000
srvtimeout 30000
mode http
log global
log 127.0.0.1 local3 info
stats uri /admin?stats
option forwardfor
frontend http_server
bind :80
log global
default_backend info_cache
acl test hdr_dom(host) -i test.domain.com
use_backend cache_test if test
backend info_cache
/#balance roundrobin
balance source
option httpchk HEAD /haproxy.txt HTTP/1.1\r\nHost:192.168.1.187
server inst2 192.168.1.187:80 check inter 5000 fall 3
backend cache_test
balance roundrobin
/#balance source
option httpchk HEAD /haproxy.txt HTTP/1.1\r\nHost:test.domain.com
server inst1 192.168.1.187:8000 check inter 5000 fall 3
二：再两台机器上都分别启动：
/etc/init.d/keepalived start （这条命令会自动把haproxy启动）
三：测试：
1.再两台机器上分别执行ip add
主: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast qlen 1000
link/ether 00:0c:29:98:cd:c0 brd ff:ff:ff:ff:ff:ff
inet 192.168.1.192/24 brd 192.168.1.255 scope global eth0
inet 192.168.1.200/32 scope global eth0
inet6 fe80::20c:29ff:fe98:cdc0/64 scope link
valid_lft forever preferred_lft forever
备: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast qlen 1000
link/ether 00:0c:29:a6:0c:7e brd ff:ff:ff:ff:ff:ff
inet 192.168.1.193/24 brd 255.255.255.254 scope global eth0
inet6 fe80::20c:29ff:fea6:c7e/64 scope link
valid_lft forever preferred_lft forever
2.停掉主上的haproxy，3秒后keepalived会自动将其再次启动
3.停掉主的keepalived，备机马上接管服务
备: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast qlen 1000
link/ether 00:0c:29:a6:0c:7e brd ff:ff:ff:ff:ff:ff
inet 192.168.1.193/24 brd 255.255.255.254 scope global eth0
inet 192.168.1.200/32 scope global eth0
inet6 fe80::20c:29ff:fea6:c7e/64 scope link
valid_lft forever preferred_lft forever
4.更改hosts
192.168.1.200 test.com
192.168.1.200 test.domain.com
通过IE测试，可以发现
test.com的请求发向了192.168.1.187:80
test.domain.com的请求发向了192.168.1.187:8000
<img src="" alt=""></p>
<p><img src="" alt="">
from:<a href="http://www.360doc.com/content/11/0425/11/2054285_112154067.shtml" target="_blank"><a href="http://www.360doc.com/content/11/0425/11/2054285_112154067.shtml">http://www.360doc.com/content/11/0425/11/2054285_112154067.shtml</a></a></p>
<p>来源： &lt;<a href="http://www.cnblogs.com/dkblog/archive/2011/07/06/2098949.html" target="_blank">haproxy+keepalived实现高可用负载均衡 - dkcndk - 博客园</a>&gt;</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/服务器/">服务器</a></li></span><span class="breadcrumb"><li><a href="/categories/服务器/">服务器</a></li><li><a href="/categories/服务器/haproxy/">haproxy</a></li></span></span> | <span class="tags">Tagged <a href="/tags/haproxy/" class="label label-primary">haproxy</a><a href="/tags/服务器/" class="label label-success">服务器</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:44"datetime="2014-03-07 09:54:44"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-服务器-haproxy--haproxykeepalived实现高可用负载均衡/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-服务器-haproxy--haproxykeepalived实现高可用负载均衡" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-服务器-集群--ApacheTomcat2集群负载平衡Linux环境/">Apache + Tomcat 2集群 负载平衡(Linux环境) </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:44.000Z"> <a href="/2014/02/02/2014-02-02-服务器-集群--ApacheTomcat2集群负载平衡Linux环境/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="apache-tomcat-2-linux-derek-guo-blog-blogjava">Apache + Tomcat 2集群 负载平衡(Linux环境) - Derek.Guo BLOG - BlogJava</h1>
<p><a href="http://www.blogjava.net/envoydada/" target="_blank"><strong>Derek.Guo BLOG</strong></a></p>
<p><a href="http://www.blogjava.net/" target="_blank">BlogJava</a>   <a href="http://www.blogjava.net/envoydada/" target="_blank">首页</a>   <a href="http://www.blogjava.net/envoydada/admin/EditPosts.aspx?opt=1" target="_blank">新随笔</a> <a href="http://www.blogjava.net/envoydada/contact.aspx?id=1" target="_blank">联系</a>   <a href="http://www.blogjava.net/envoydada/rss" target="_blank">聚合</a><a href="http://www.blogjava.net/envoydada/rss" target="_blank"><img src="" alt=""></a>   <a href="http://www.blogjava.net/envoydada/admin/EditPosts.aspx" target="_blank">管理</a></p>
<p>随笔-82  评论-31  文章-0  trackbacks-0
<a href="">Apache + Tomcat/*2集群 负载平衡(Linux环境)</a></p>
<p>Apache + Tomcat/*2集群 负载平衡（Linux环境）</p>
<p>说明：一台apache主机，两台tomcat主机</p>
<p>安装JDK、安装Apache、安装Tomcat、配置Apache代理、配置Tomcat集群</p>
<p>一、安装JDK（所有运行Tomcat主机，即web服务器）
  1.下载JDK的bin包，如jdk-1_5_0_02-linux-i586.rpm.bin ，给其添加执行权限，执行/#./jdk-1_5_0_02-linux-i586.rpm.bin , 在</p>
<p>当前目录生成rpm安装包，同样给其添加执行权限。 再执行 /#rpm -ivh jdk-1_5_0_02-linux-i586.rpm 出现安装协议 按<Enter>接受</p>
<p>即可。
  2.设置环境变量 /#vi /etc/profile  在其最后加入
        JAVA_HOME =/ usr / java / jdk1. 5 .0_02
        CLASSPATH = .:$JAVA_HOME / lib:$JAVA_HOME / jre / lib
        PATH = $PATH:$JAVA_HOME / bin:$JAVA_HOME / jre / bin
        export JAVA_HOME CLASSPATH PATH</p>
<pre><code> 保存退出
</code></pre><p>  3.要使JDK在所有的用户中使用，可以这样：vi /etc/profile.d/java.sh在新的java.sh中输入以下内容：
        /#set java environment
        JAVA_HOME=/usr/java/jdk1.5.0_02
        CLASSPATH=.:$JAVA_HOME/lib:$JAVA_HOME/jre/lib
        PATH=$PATH:$JAVA_HOME/bin:$JAVA_HOME/jre/bin
        export JAVA_HOME CLASSPATH PATH
     保存退出，然后给java.sh分配权限：chmod 755 /etc/profile.d/java.sh</p>
<p>二、安装Apache（访问代理主机）
  1.下载apache源代码 <a href="http://archive.apache.org/dist/httpd/httpd-2.2.2.tar.gz" target="_blank"><a href="http://archive.apache.org/dist/httpd/httpd-2.2.2.tar.gz">http://archive.apache.org/dist/httpd/httpd-2.2.2.tar.gz</a></a></p>
<p> 解压缩 tar fvxz httpd-2.2.2.tar.gz</p>
<p>  2.进入解压后的目录。进行配置：
. / configure  -- prefix =/ usr / apache  -- enable - module = most  -- enable - proxy  -- enable - proxy - ajp  -- enable - forward  -- enable - proxy - connect  -- enable - proxy - http  -- enable - so  -- enable - deflate  -- enable - headers  -- enable - include</p>
<p>上面的配置，用到了其他一些模块，说不定以后会用到，如支持ssi的include模块。</p>
<p>  3.编译（编译如果不成功，确认一下你的linux是否安装有编译所需要的c环境和其他需要的类库）
    make</p>
<p>  4.安装 make install</p>
<p>  5.进入/usr/apache目录，运行apache  ./apachectl -k start</p>
<pre><code>  运行apache后，浏览一下是否运行正常。

关闭apache ./apachectl -k stop
</code></pre><p>   6.把apache作为linux的启动就运行服务程序
     执行如下操作：cp /usr/apache/bin/apachectl /etc/rc.d/init.d/httpd
     确认linux以前安装的httpd（apache）不需要了，你可覆盖掉以前apache的httpd文件。
     chkconfig --add httpd
     运行linux的setup，把httpd服务默认设定为自动运行。
     到现在，你就可用另一种方式来启动、关闭apache了。如service httpd start</p>
<p>三、安装tomcat（Web服务器）
    1.下载jakarta-tomcat-5.5.20.tar.gz
      tar zxf jakarta-tomcat-5.5.20.tar.gz 解压文件 （如解压到/usr/local/）
    2.设置环境变量 /#vi /etc/profile  添加
  CATALINA_HOME=/usr/local/jakarta-tomcat-5.5.30
  export CATALINA_HOME
      保存退出</p>
<pre><code>3.修改JVM内存：/bin/catalina.sh 文件
    在下/# ----- Execute The Requested Command -----------------
        /# Bugzilla 37848: only output this if we have a TTY
          if [ $have_tty -eq 1 ]; then
             echo &quot;Using CATALINA_BASE:   $CATALINA_BASE&quot;
             echo &quot;Using CATALINA_HOME:   $CATALINA_HOME&quot;
             echo &quot;Using CATALINA_TMPDIR: $CATALINA_TMPDIR&quot;
            if [ &quot;$1&quot; = &quot;debug&quot; -o &quot;$1&quot; = &quot;javac&quot; ] ; then
                echo &quot;Using JAVA_HOME:       $JAVA_HOME&quot;
            else
               echo &quot;Using JRE_HOME:       $JRE_HOME&quot;
            fi
           fi
        添加以下内容：
            CATALINA_OPTS = &quot; $CATALINA_OPTS -Xms256m -Xmx512m -XX:PermSize=32m  -XX:MaxPermSize=128m $JPDA_OPTS &quot;
            JAVA_OPTS = &quot; $JAVA_OPTS -Djava.awt.headless=true &quot;
            echo  &quot; Using CATALINA_OPTS: $CATALINA_OPTS &quot;
            echo  &quot; Using JAVA_OPTS: $JAVA_OPTS &quot;

4.运行/usr/local/jakarta-tomcat-5.5.30/bin/startup.sh 启动tomcat服务器 测试是否正常
</code></pre><p>四、配置apache代理(适用mod_proxy_ajp.so)
    编辑apache配置文件 /#vi /usr/apache/conf/httpd.conf
    1.配置proxy_ajp
 /#加载解析模块（windows下，或linux采用动态加载模式下需配置。前面我们的linux编译时把下面的模块嵌入到了apache中 </p>
<pre><code>   ，所以不用再加载）
</code></pre><p> LoadModule proxy_module modules/mod_proxy.so
 LoadModule proxy_ajp_module modules/mod_proxy_ajp.so
    2.配置文件添加
 ProxyPass  /  balancer: // tomcatcluster/ lbmethod=byrequests stickysession=JSESSIONID nofailover=on timeout=5  maxattempts = 3
 ProxyPassReverse  /  balancer: // tomcatcluster/
  &lt; Proxy balancer: // tomcatcluster &gt;
    BalancerMember ajp: // 192.168.40.15:8009 smax=2 loadfactor=1  route=tomca t1
    BalancerMember ajp: // 192.168.71.106:8009 smax=2 loadfactor=2  route=tomc at2
  &lt;/ Proxy &gt;</p>
<pre><code>    以上说明请参见mod_proxy中文手册 [http://www.6bee.com/tech/ApacheMenu/mod/mod_proxy.html](http://www.6bee.com/tech/ApacheMenu/mod/mod_proxy.html)
3.其他说明
</code></pre><p> 1、apache对tomcat的支持历史：apache第2.1版本后，内置了proxy_ajp，而jk2已经没人开发了，jk则支持到apache的</p>
<p>2.0.58版本。
proxy_ajp配置较简单，但可配置性还不如jk2，主要表现在proxy_ajp目前只支持配置到目录，还不支持对文件名称的pattern模式匹</p>
<p>配（即还不能定义到只对jsp文件起作用）。</p>
<p> 2、因为proxy_ajp的配置，还不支持对文件名称的pattern模式匹配，所以你要特别注意：
——尽量把jsp和静态文件和图片路径分不同的目录来管理；
——对于静态文件和图片路径，如/images，你可用“ProxyPass /images !”来禁止ProxyPass，从而来让apache来直接处理图片的请</p>
<p>求。
——关于apache的ssi（即shtml，include）与tomcat的集成时，shtml文件不能处于ProxyPass的控制下（即不能在ProxyPass目录）</p>
<p>，而shtml调用的jsp须在ProxyPass有效控制下；</p>
<p>五、配置Tomcat负载均衡、集群
    1.修改tomcat 的 conf/server.xml 的<Engine><br>    去掉注释<Engine name="Standalone" defaultHost="localhost" jvmRoute="tomcat1">
        jvmRoute是tomcat路由标示，由此区分两台tomcat主机，那么第二台就改为
            <Engine name="Standalone" defaultHost="localhost" jvmRoute="tomcat2">
    加上注释<Engine name="Catalina" defaultHost="localhost"></p>
<pre><code>2.修改tomcat 的 conf/server.xml 的&lt;Connector&gt; 
去掉注释&lt;Connector port=&quot;8009&quot;
           enableLookups=&quot;false&quot; redirectPort=&quot;8443&quot; debug=&quot;0&quot;
           protocol=&quot;AJP/1.3&quot; /&gt;   

3.修改tomcat 的 conf/server.xml 的&lt;Cluster&gt;   
&lt;!--  
     &lt; Cluster className = &quot; org.apache.catalina.cluster.tcp.SimpleTcpCluster &quot;
             managerClassName = &quot; org.apache.catalina.cluster.session.DeltaManager &quot;
             expireSessionsOnShutdown = &quot; false &quot;
             useDirtyFlag = &quot; true &quot;
             notifyListenersOnReplication = &quot; true &quot; &gt;
         &lt; Membership 
            className = &quot; org.apache.catalina.cluster.mcast.McastService &quot;
            mcastAddr = &quot; 228.0.0.4 &quot;
            mcastPort = &quot; 45564 &quot;
            mcastFrequency = &quot; 500 &quot;
            mcastDropTime = &quot; 3000 &quot; /&gt;
         &lt; Receiver 
            className = &quot; org.apache.catalina.cluster.tcp.ReplicationListener &quot;
            tcpListenAddress = &quot; auto &quot;
            tcpListenPort = &quot; 4001 &quot;
            tcpSelectorTimeout = &quot; 100 &quot;
            tcpThreadCount = &quot; 6 &quot; /&gt;
         &lt; Sender
            className = &quot; org.apache.catalina.cluster.tcp.ReplicationTransmitter &quot;
            replicationMode = &quot; pooled &quot;
            ackTimeout = &quot; 5000 &quot; /&gt;
         &lt; Valve className = &quot; org.apache.catalina.cluster.tcp.ReplicationValve &quot;
               filter = &quot; ./*\.gif;./*\.js;./*\.jpg;./*\.png;./*\.htm;./*\.html;./*\.css;./*\.txt; &quot; /&gt;

         &lt; Deployer className = &quot; org.apache.catalina.cluster.deploy.FarmWarDeployer &quot;
                  tempDir = &quot; /tmp/war-temp/ &quot;
                  deployDir = &quot; /tmp/war-deploy/ &quot;
                  watchDir = &quot; /tmp/war-listen/ &quot;
                  watchEnabled = &quot; false &quot; /&gt;

         &lt; ClusterListener className = &quot; org.apache.catalina.cluster.session.ClusterSessionListener &quot; /&gt;
     &lt;/ Cluster &gt;
     --&gt;
</code></pre><p>把上面的注释拿掉 就ok 了！</p>
<p>4.在每个webapps应用中,修改web.xml文件 添加元素<distributable/>
最后完工，重启tomcat,apahce测试平衡负载，新建jsp页面
&lt;%
Runtime lRuntime = Runtime.getRuntime();
out.println(&quot;/<em>/</em>/<em> BEGIN MEMORY STATISTICS /</em>/<em>/</em><br/>&quot;);
out.println(&quot;Free  Memory: &quot;+lRuntime.freeMemory()/1024/1024+&quot;M<br/>&quot;);
out.println(&quot;Max   Memory: &quot;+lRuntime.maxMemory()/1024/1024+&quot;M<br/>&quot;);
out.println(&quot;Total Memory: &quot;+lRuntime.totalMemory()/1024/1024+&quot;M<br/>&quot;);
out.println(&quot;Available Processors : &quot;+lRuntime.availableProcessors()+&quot;<br/>&quot;);
out.println(&quot;/<em>/</em>/<em> END MEMORY STATISTICS /</em>/<em>/</em>&quot;);
%&gt;
<br>
&lt;%= request.getSession().getId() %&gt;
放入到两台tomcat的ROOT目录中测试
再测试集群(session复制)
posted on 2006-11-15 11:06 <a href="http://www.blogjava.net/envoydada/" target="_blank">Derek.Guo</a> 阅读(3196) <a href="http://www.blogjava.net/envoydada/archive/2006/11/15/81196.html#Post" target="_blank">评论(0)</a>  <a href="http://www.blogjava.net/envoydada/admin/EditPosts.aspx?postid=81196" target="_blank">编辑</a>  <a href="http://www.blogjava.net/envoydada/AddToFavorite.aspx?id=81196" target="_blank">收藏</a> 所属分类: <a href="http://www.blogjava.net/envoydada/category/32100.html" target="_blank">Linux/Unix</a> <img src="" alt=""></p>
<p><a href="http://www.blogjava.net/RequireRegister.aspx" target="_blank">新用户注册</a>  <a href="">刷新评论列表</a>  </p>
<p><a href=""></a> <a href="http://job.cnblogs.com/">找优秀程序员，就在博客园</a>
IT新闻：
· <a href="http://news.cnblogs.com/n/128015/" target="_blank">开源Tizen系统视频泄露 外观似诺基亚MeeGo</a>
· <a href="http://news.cnblogs.com/n/128014/" target="_blank">Opera推出电视应用商店 提供HTML5应用</a>
· <a href="http://news.cnblogs.com/n/128013/" target="_blank">CES 2012 开展前演讲：电子设备消费将达 1 万亿美元</a>
· <a href="http://news.cnblogs.com/n/128012/" target="_blank">分析师称苹果借转售NAND闪存获数十亿美元利润</a>
· <a href="http://news.cnblogs.com/n/128011/" target="_blank">爱创会：火花，火焰，火光</a>   <a href="http://www.cnblogs.com/" target="_blank">博客园</a>  <a href="http://q.cnblogs.com/" target="_blank">博问</a>  <a href="http://news.cnblogs.com/" target="_blank">IT新闻</a>  <a href="http://job.cnblogs.com/cate-java_programmer/" target="_blank">Java程序员招聘</a> 标题  请输入标题 姓名  请输入你的姓名 主页 请输入验证码 验证码 /*  <img src="" alt=""> 内容(请不要发表任何与政治相关的内容) 请输入评论内容 Remember Me?   <a href="http://www.blogjava.net/login.aspx?ReturnURL=http://www.blogjava.net/envoydada/archive/2006/11/15/81196.html&amp;SourceURL=/envoydada/archive/2006/11/15/81196.html" target="_blank">登录</a>       [使用Ctrl+Enter键可以直接提交]    推荐职位：
· <a href="http://job.cnblogs.com/Offer/18582/" target="_blank">北京C++游戏服务端研发工程师(武神世纪网络)</a>
· <a href="http://job.cnblogs.com/offer/16502/" target="_blank">知识库技术编辑(博客园)</a>
· <a href="http://job.cnblogs.com/offer/18594/" target="_blank">北京Web系统工程师(嘉康利中国)</a>
· <a href="http://job.cnblogs.com/offer/13272/" target="_blank">.NET 高级软件开发工程师(5173.com)</a>
· <a href="http://job.cnblogs.com/offer/10223/" target="_blank">中高级.NET程序员(沪江网)</a>
· <a href="http://job.cnblogs.com/Offer/13754/" target="_blank">石家庄高级.NET工程师（月薪6K-8K）(盛安德科技)</a></p>
<p>博客园首页随笔：
· <a href="http://www.cnblogs.com/ralphjzhang/archive/2012/01/09/2317463.html" target="_blank">再论 Time stamp counter</a>
· <a href="http://www.cnblogs.com/default/archive/2012/01/09/2317506.html" target="_blank">我在ZZ这八年</a>
· <a href="http://www.cnblogs.com/phphuaibei/archive/2012/01/09/2317484.html" target="_blank">写在2012里的2011总结</a>
· <a href="http://www.cnblogs.com/west-link/archive/2012/01/09/2317477.html" target="_blank">高效程序员秘籍（8）：养成使用网络笔记本、网络文件同步工具的习惯</a>
· <a href="http://www.cnblogs.com/judgelee/archive/2012/01/09/2317474.html" target="_blank">Ext.get()与Ext.fly()之区别</a>
知识库：
· <a href="http://kb.cnblogs.com/page/127846/" target="_blank">持续集成之“Everything is code”</a>
· <a href="http://kb.cnblogs.com/page/127845/" target="_blank">持续集成之“软件自我识别”</a>
· <a href="http://kb.cnblogs.com/page/127843/" target="_blank">持续集成之戏说Check-in Dance</a>
· <a href="http://kb.cnblogs.com/page/111014/" target="_blank">什么是闭包，我的理解</a>
· <a href="http://kb.cnblogs.com/page/111780/" target="_blank">什么是闭包(Closure)？</a>  网站导航:</p>
<p><a href="http://www.cnblogs.com/" title="程序员的网上家园" target="_blank">博客园</a>   <a href="http://news.cnblogs.com/" target="_blank">IT新闻</a>   <a href="http://kb.cnblogs.com/" target="_blank">知识库</a>   <a href="http://www.cppblog.com/" target="_blank">C++博客</a>   <a href="http://job.cnblogs.com/" target="_blank">程序员招聘</a>   <a href="http://www.blogjava.net/envoydada/archive/2006/11/15/81196.html?opt=admin" target="_blank">管理</a> 相关文章:</p>
<ul>
<li><a href="http://www.blogjava.net/envoydada/archive/2011/12/29/367529.html" target="_blank">使用 sendfile() 提升网络文件发送性能</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2011/03/15/346300.html" target="_blank">Web服务器性能/压力测试工具http_load、webbench、ab、Siege(转)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2010/04/08/317711.html" target="_blank">liunx下安装Subversion</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2008/07/29/218323.html" target="_blank">Window下配置SVN服务器与客户端(转)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2008/06/11/207028.html" target="_blank">Solaris系统进程的查看和管理</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2007/09/29/149640.html" target="_blank">Solaris 操作系统的动态跟踪工具Dtrace</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2007/08/01/133838.html" target="_blank">Linux自启Tomcat,Solaris自启glassfish</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2007/07/30/133285.html" target="_blank">JProfiler远程监控Tomcat</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2007/07/24/132080.html" target="_blank">Glassfish的安装</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2007/07/10/129316.html" target="_blank">启动Solaris10-webmin</a>  </li>
</ul>
<p><a href="&quot;Go to the previous month&quot;">&lt;</a>2006年11月<a href="&quot;Go to the next month&quot;">&gt;</a>日一二三四五六293031123456<a href="http://www.blogjava.net/envoydada/archive/2006/11/07.html" target="_blank">7</a><a href="http://www.blogjava.net/envoydada/archive/2006/11/08.html" target="_blank">8</a>9<a href="http://www.blogjava.net/envoydada/archive/2006/11/10.html" target="_blank">10</a>11121314<a href="http://www.blogjava.net/envoydada/archive/2006/11/15.html" target="_blank">15</a><a href="http://www.blogjava.net/envoydada/archive/2006/11/16.html" target="_blank">16</a>1718192021222324252627282930123456789</p>
<h3 id="-7-">留言簿(7)</h3>
<ul>
<li><a href="http://www.blogjava.net/envoydada/Contact.aspx?id=1" target="_blank">给我留言</a></li>
<li><a href="http://www.blogjava.net/envoydada/default.aspx?opt=msg" target="_blank">查看公开留言</a></li>
<li><a href="http://www.blogjava.net/envoydada/admin/MyMessages.aspx" target="_blank">查看私人留言</a></li>
</ul>
<h1 id="-80-">随笔分类(80)</h1>
<ul>
<li><a href="http://www.blogjava.net/envoydada/category/45572.html" target="_blank">Cache(2)</a><a href="http://www.blogjava.net/envoydada/category/45572.html/rss" title="Subscribe to Cache(2)" target="_blank"><img src="&quot;Subscribe to Cache(2" alt="">&quot;)</a></li>
<li><a href="http://www.blogjava.net/envoydada/category/32101.html" target="_blank">Database(9)</a><a href="http://www.blogjava.net/envoydada/category/32101.html/rss" title="Subscribe to Database(9)" target="_blank"><img src="&quot;Subscribe to Database(9" alt="">&quot;)</a></li>
<li><a href="http://www.blogjava.net/envoydada/category/32099.html" target="_blank">Java(51)</a><a href="http://www.blogjava.net/envoydada/category/32099.html/rss" title="Subscribe to Java(51)" target="_blank"><img src="&quot;Subscribe to Java(51" alt="">&quot;)</a></li>
<li><a href="http://www.blogjava.net/envoydada/category/32100.html" target="_blank">Linux/Unix(14)</a><a href="http://www.blogjava.net/envoydada/category/32100.html/rss" title="Subscribe to Linux/Unix(14)" target="_blank"><img src="&quot;Subscribe to Linux/Unix(14" alt="">&quot;)</a></li>
<li><a href="http://www.blogjava.net/envoydada/category/45571.html" target="_blank">NoSqlDB(4)</a><a href="http://www.blogjava.net/envoydada/category/45571.html/rss" title="Subscribe to NoSqlDB(4)" target="_blank"><img src="&quot;Subscribe to NoSqlDB(4" alt="">&quot;)</a></li>
</ul>
<h1 id="-">技术网站</h1>
<ul>
<li><a href="http://www.54chen.com/" target="_blank">54chen</a></li>
<li><a href="http://www.coreseek.com/" target="_blank">Coreseek中文全文检索</a></li>
<li><a href="http://dominic.blog.chinaunix.net/" target="_blank">Dominic-Blog</a></li>
<li><a href="http://code.google.com/p/gflot/" target="_blank">GFlot</a></li>
<li>GWT charting library <a href="http://repository.jboss.org/maven2/ca/nanometrics/gflot/1.0.0/" target="_blank">http://repository.jboss.org/maven2/ca/nanometrics/gflot/1.0.0/</a></li>
<li><a href="http://gwt.google.com/samples/Showcase/Showcase.html" target="_blank">GWT Showcase</a></li>
<li><a href="http://www.ibm.com/developerworks/cn/xml/x-javacc/part1/" target="_blank">JavaCC、解析树和 XQuery 语法</a></li>
<li><a href="http://www.mongodb.org/display/DOCS/Manual" target="_blank">Mongodb手册</a></li>
<li><a href="http://doc.mysql.cn/mysql5/refman-5.1-zh.html-chapter/" target="_blank">MySQL 5.1参考手册</a></li>
<li><a href="http://www.mysqlsystems.com/" target="_blank">Mysql部落</a></li>
<li><a href="http://wiki.nginx.org/NginxChs" target="_blank">Nginx 的中文维基</a></li>
<li><a href="http://redis.io/" target="_blank">Redis</a></li>
<li><a href="http://sphinxsearch.com/" target="_blank">Sphinxsearch</a></li>
<li><a href="http://code.google.com/p/spymemcached/" target="_blank">spymemcached</a></li>
<li>A simple, asynchronous, single-threaded memcached client written in java.</li>
<li><a href="http://code.google.com/p/spymemcached/" target="_blank">Spymemcached</a></li>
<li><a href="http://www.tigase.org/" target="_blank">Tigase</a></li>
<li>轻量高性能JABBER/XMPP服务器，带GWT开发的客户端</li>
<li><a href="http://www.ibm.com/developerworks/cn/java/j-lo-tomcat1/index.html" target="_blank">Tomcat 系统架构与设计模式</a></li>
<li><a href="http://code.google.com/p/xmemcached/" target="_blank">xmemcached</a></li>
<li>Extreme performance modern memcached client for java</li>
<li><a href="http://www.boobooke.com/bbs/index.php" target="_blank">播布客</a></li>
<li><a href="http://blog.csdn.net/chinull/archive/2010/03/17/5390830.aspx" target="_blank">百度文库浏览器分析及实现</a></li>
<li><a href="http://www.linuxdiyf.com/" target="_blank">红联Linux</a></li>
</ul>
<h3 id="-">积分与排名</h3>
<ul>
<li>积分 - 107622</li>
<li>排名 - 186</li>
</ul>
<h3 id="-">最新随笔</h3>
<ul>
<li><a href="http://www.blogjava.net/envoydada/archive/2011/12/29/367529.html" target="_blank">1. 使用 sendfile() 提升网络文件发送性能</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2011/03/15/346300.html" target="_blank">2. Web服务器性能/压力测试工具http_load、webbench、ab、Siege(转)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2010/07/13/325947.html" target="_blank">3. Magent：Memcached集群代理</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2010/07/05/325305.html" target="_blank">4. Mongodb Import Export Tools</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2010/07/05/325266.html" target="_blank">5. Mongodb dbshell Reference</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2010/06/23/324266.html" target="_blank">6. 转mongodb入门</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2010/06/23/324255.html" target="_blank">7. Mongodb Dynamic querys select</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2010/04/08/317718.html" target="_blank">8. mysql常用的hint</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2010/04/08/317716.html" target="_blank">9. Mysql innodb引擎优化</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2010/04/08/317713.html" target="_blank">10. J2SE6 分析工具</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2010/04/08/317711.html" target="_blank">11. liunx下安装Subversion</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2009/02/07/253698.html" target="_blank">12. ORACLE 中dbms_stats的使用</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2008/09/28/231708.html" target="_blank">13. Memcached 剖析(转)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2008/07/29/218323.html" target="_blank">14. Window下配置SVN服务器与客户端(转)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2008/06/18/208808.html" target="_blank">15. Oracle 10g Recycle Bin</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2008/06/16/208221.html" target="_blank">16. Oracle中分区表的使用</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2008/06/12/207472.html" target="_blank">17. ORACLE CTXCAT-CATSEARCH</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2008/06/12/207288.html" target="_blank">18. ORACLE JOBS</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2008/06/11/207090.html" target="_blank">19. Oracle 分区表(Partition)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2008/06/11/207028.html" target="_blank">20. Solaris系统进程的查看和管理</a></li>
</ul>
<h3 id="-http-www-blogjava-net-envoydada-commentsrss-aspx-">最新评论 <a href="http://www.blogjava.net/envoydada/CommentsRSS.aspx" target="_blank"><img src="" alt=""></a></h3>
<ul>
<li><a href="http://www.blogjava.net/envoydada/archive/2011/07/13/106322.html#354291" target="_blank">1. re: Hibernate 本地SQL查询SQLQuery</a></li>
<li>不错,很受用</li>
<li>--happytjn</li>
<li><a href="http://www.blogjava.net/envoydada/archive/2010/05/21/46964.html#321538" target="_blank">2. re: DES加密</a></li>
<li>评论内容较长,点击标题查看</li>
<li>--woxiangbo</li>
<li><a href="http://www.blogjava.net/envoydada/archive/2010/04/07/138549.html#317660" target="_blank">3. re: JAVA缩放图片（转贴）</a></li>
<li>希望能用</li>
<li>--moguji</li>
<li><a href="http://www.blogjava.net/envoydada/archive/2009/10/20/106322.html#299083" target="_blank">4. re: Hibernate 本地SQL查询SQLQuery[未登录]</a></li>
<li>很好，谢谢啦</li>
<li>--xx</li>
<li><a href="http://www.blogjava.net/envoydada/archive/2009/09/30/106322.html#296990" target="_blank">5. re: Hibernate 本地SQL查询SQLQuery</a></li>
<li>很不错啊， 谢谢。。</li>
<li>--carvin</li>
</ul>
<h3 id="-">阅读排行榜</h3>
<ul>
<li><a href="http://www.blogjava.net/envoydada/archive/2007/03/26/106322.html" target="_blank">1. Hibernate 本地SQL查询SQLQuery(11576)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2005/09/13/12894.html" target="_blank">2. Hibernate批量更新和批量删除(8941)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2006/05/10/45438.html" target="_blank">3. Spring+Hibernate+Struts(4960)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2007/07/30/133285.html" target="_blank">4. JProfiler远程监控Tomcat(4646)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2006/11/07/79516.html" target="_blank">5. Spring DataSource注入(3902)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2007/03/06/102152.html" target="_blank">6. Spring+hibernate分页查询(3677)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2006/08/28/66182.html" target="_blank">7. Spring Hibernate 模板实现分页(3500)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2007/05/08/115877.html" target="_blank">8. Java调用Linux命令(3496)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2006/09/07/68308.html" target="_blank">9. Hibernate one-to-many学习笔记(3431)</a></li>
<li><a href="">10. Apache + Tomcat/*2集群 负载平衡(Linux环境)(3196)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2009/02/07/253698.html" target="_blank">11. ORACLE 中dbms_stats的使用(3084)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2007/07/23/131803.html" target="_blank">12. java虚拟机参数详解(3009)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2006/04/26/43355.html" target="_blank">13. WEB定时器-Timer(2151)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2007/07/30/133329.html" target="_blank">14. 工具分析GC日志(2014)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2005/09/11/12654.html" target="_blank">15. Struts中logic:iterate标记的使用(1871)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2006/11/10/80309.html" target="_blank">16. Tomcat内存配置(1823)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2007/05/09/116195.html" target="_blank">17. JAVA访问LDAP(1709)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2005/09/11/12655.html" target="_blank">18. Tomcat5.0连接池(1697)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2005/09/11/12679.html" target="_blank">19. Hibernate-Extension和Middlegen-Hibernate(1692)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2007/07/20/131410.html" target="_blank">20. Spring配置总结(1663)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2006/08/30/66559.html" target="_blank">21. EL表达式(1341)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2007/08/22/138549.html" target="_blank">22. JAVA缩放图片（转贴）(1326)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2006/04/20/42153.html" target="_blank">23. Hibernate主键生成方式(1285)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2006/08/15/63743.html" target="_blank">24. JAVA的RSS阅读器(1276)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2006/11/07/79585.html" target="_blank">25. Tomcat 通过数据库验证的配置方法(BASIC,FORM).(1274)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2006/12/15/87862.html" target="_blank">26. hibernate二级缓存攻略 Ehcache(转贴)(1224)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2008/06/16/208221.html" target="_blank">27. Oracle中分区表的使用(1180)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2006/03/15/35434.html" target="_blank">28. Hibernate3.0批量更新和批量删除(1175)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2007/07/20/131433.html" target="_blank">29. GC调优(1162)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2007/09/20/146797.html" target="_blank">30. Hibernate属性延迟加载(1122)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2006/03/28/37791.html" target="_blank">31. Struts常用标签(1120)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2006/10/12/74758.html" target="_blank">32. RedHat终端中文乱码解决(1077)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2007/12/27/170920.html" target="_blank">33. 数据库性能 常用SQL(1070)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2006/06/05/50423.html" target="_blank">34. Spring 定时器(927)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2006/05/19/46964.html" target="_blank">35. DES加密(869)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2006/01/18/28446.html" target="_blank">36. Log4j配置(849)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2007/07/24/132080.html" target="_blank">37. Glassfish的安装(785)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2006/05/11/45645.html" target="_blank">38. Java调用windows程序(747)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2007/06/08/122881.html" target="_blank">39. Hibernate3支持DetachedCriteria(转贴)(718)</a></li>
<li><a href="http://www.blogjava.net/envoydada/archive/2008/06/11/207090.html" target="_blank">40. Oracle 分区表(Partition)(705)</a>
Powered by: <a href="http://www.cnblogs.com/" target="_blank">博客园</a> 模板提供：<a href="http://blog.hjenglish.com/" target="_blank">沪江博客</a> Copyright ©2012 Derek.Guo</li>
</ul>
<p>MSN:envoydada@hotmail.com QQ:34935442</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/服务器/">服务器</a></li></span><span class="breadcrumb"><li><a href="/categories/服务器/">服务器</a></li><li><a href="/categories/服务器/集群/">集群</a></li></span></span> | <span class="tags">Tagged <a href="/tags/服务器/" class="label label-primary">服务器</a><a href="/tags/集群/" class="label label-success">集群</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:44"datetime="2014-03-07 09:54:44"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-服务器-集群--ApacheTomcat2集群负载平衡Linux环境/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-服务器-集群--ApacheTomcat2集群负载平衡Linux环境" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-服务器-集群--LINUX下使用apachetomcat构建WEB集群系统/">最新分享_分享_百度空间</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:44.000Z"> <a href="/2014/02/02/2014-02-02-服务器-集群--LINUX下使用apachetomcat构建WEB集群系统/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-_-_-">最新分享<em>分享</em>百度空间</h1>
<p><a href="http://hi.baidu.com/index.htm" target="_blank"><img src="" alt="百度空间Logo"></a></p>
<ul>
<li><p><a href="http://apps.hi.baidu.com/" target="_blank">应用</a>
<a href="http://hi.baidu.com/reg/new" target="_blank">注册</a>用户名:   密码:</p>
</li>
<li><p><a href="http://apps.hi.baidu.com/hoho" target="_blank">HOHO</a></p>
</li>
<li><a href="http://apps.hi.baidu.com/share" target="_blank">分享</a></li>
<li><a href="http://apps.hi.baidu.com/vote" target="_blank">投票</a></li>
<li><a href="http://apps.hi.baidu.com/test" target="_blank">测试</a></li>
<li><a href="http://apps.hi.baidu.com/gift" target="_blank">礼物</a></li>
</ul>
<h3 id="-http-hi-baidu-com-ihome-square-"><a href="http://hi.baidu.com//ihome/square" target="_blank">交友中心</a></h3>
<ul>
<li><a href="http://apps.hi.baidu.com/dashan" target="_blank">搭讪</a></li>
<li><a href="http://apps.hi.baidu.com/duiwei" target="_blank">对味测试</a></li>
<li><a href="http://apps.hi.baidu.com/suliao" target="_blank">闪电速聊</a></li>
<li><p><a href="http://hi.baidu.com//ihome/square" target="_blank">找朋友</a></p>
<h3 id="-http-apps-hi-baidu-com-apps-"><a href="http://apps.hi.baidu.com/apps" target="_blank">应用大厅</a></h3>
</li>
<li><p><a href="http://apps.hi.baidu.com/kaixinbuluo" target="_blank">开心部落</a></p>
</li>
<li><a href="http://apps.hi.baidu.com/rongcar" target="_blank">汽车工厂</a></li>
<li><p><a href="http://apps.hi.baidu.com/paopaoyu" target="_blank">泡泡鱼</a></p>
</li>
<li><p><a href="http://youxi.baidu.com/prom.xhtml?code=G-%D7%8E%81%B2%29%FF%8AR%BC%8B%EE%85%1C%E5" target="_blank">网页游戏</a></p>
</li>
</ul>
<h2 id="-">分享</h2>
<ul>
<li><a href="http://apps.hi.baidu.com/share/" target="_blank">热门分享</a></li>
<li><a href="http://apps.hi.baidu.com/share/latest/?type=video" target="_blank">最新分享</a></li>
<li><a href="http://apps.hi.baidu.com/share/detail/14955683#" target="_blank">好友的分享</a></li>
<li><a href="http://apps.hi.baidu.com/share/detail/14955683#" target="_blank">我的分享</a>
<a href="http://apps.hi.baidu.com/share/detail/14955683#" target="_blank">如何分享?</a> <a href="http://tieba.baidu.com/f?kw=%B0%D9%B6%C8%BF%D5%BC%E4" target="_blank">问题反馈</a></li>
</ul>
<p><a href=""></a></p>
<p><a href="http://hi.baidu.com/sys/checkuser/lpwok/3" target="_blank"><img src="" alt=""></a></p>
<p>   <a href="http://apps.hi.baidu.com/share/user/68db6c70776f6bd905" target="_blank">lpwok的分享</a></p>
<p>分享</p>
<p><a href="http://apps.hi.baidu.com/share/detail/14959808#content" target="_blank"></a>  <a href="http://apps.hi.baidu.com/share/detail/14797932#content"></a>
LINUX下使用apache+tomcat构建WEB集群系统</p>
<p><strong>一、集群的基本知识</strong>
        集群技术是目前非 常流行的提高系统服务能力与高可靠性（ HA- High Availability ）的手段，通过把多个独立的服务器组成一个集群可以实现失效无缝转移。也就是说当有某一台集群中的服务器当机后，其上的用户状态数据可以无缝迁移到集群中 的其他服务器上。这样，正在使用应用的客户可以完全感觉不到影响，大大提供了系统的可靠性。</p>
<p>集群有很多种类和层次，例如：操作系统集群（如 Linux 、 Solaris 等），数据库集群（如 DB2 、 Oracle 等），应用服务器集群（如 GlassFish 、 WebLogic 等） ,Web 集群（如 Tomcat 等）。本教程将向读者介绍由 Tomcat 搭建的 Web 集群。</p>
<p>不管是由什么技术搭建的集群，其基本组成由下图所示：
<img src="" alt="">
图 1-1</p>
<p>从图中可以看出，每个集群都需要一个负载均衡器，其负责根据一定的算法将外界发送到集群的请求尽量均匀地分配到集群中的每个服务器，使得集群中所有 服务器的负载尽量平衡。对外界的客户端而言其并不知道具体访问了集群中的哪台服务器，多台服务器从逻辑上对外界而言可以看作一台&quot;大&quot;服务器。这样，当集 群的服务能力不能满足当前的需要时，可以非常方便地再向集群中添加新的服务器来满足需要。可以看出，使用了集群之后，系统具有非常好的可扩展性。</p>
<p>当不幸集群中有某台服务器突然当机时，其用户状态数据可以迁移到其他服务器上，不影响在线用户的使用。这样，通过使用集群技术可以方便地实现系统的高可靠性。</p>
<p>本教程中将介绍的使用 Tomcat 搭建的 Web 集群结构如图 1-2 所示：</p>
<p><img src="" alt="">
图 1-2</p>
<p>从图中可以看出集群的负载均衡器由开源的 Apache 服务器担任，集群中的 Web 服务器由两个 Tomcat 服务器分别担任，后台的数据库服务器由一个 MySQL 服务器担任。</p>
<p>提示：本教程中介绍的是 Web 集群，因此数据库服务器只有一个，并没有搭建集群。在需要的情况下，多台数据库服务器也可以组成集群以提高服务能力与可靠性。</p>
<p><strong>二、安装JDK</strong></p>
<p><strong>三、安装TOMCAT</strong></p>
<ol>
<li>下载tomcat，可以通过下面的命令下载：</li>
</ol>
<p>/#wget <a href="http://apache.mirror.phpchina.com/tomcat/tomcat-6/v6.0.18/bin/apache-tomcat-6.0.18.tar.gz" target="_blank">http://apache.mirror.phpchina.com/tomcat/tomcat-6/v6.0.18/bin/apache-tomcat-6.0.18.tar.gz</a></p>
<ol>
<li>解压启动测试：</li>
</ol>
<p>/#tar -zxvf apache-tomcat-6.0.18.tar.gz
/#./apache-tomcat-6.0.18/bin/startup.sh</p>
<p>在浏览器中输入：<a href=""><a href="http://localhost:8080">http://localhost:8080</a></a>,看是否启动正常，若正常进行第三步。</p>
<ol>
<li>下面通过一个简单的&quot; Test.jsp &quot;程序进一步验证 Tomcat 是否安装成功，新建名称为&quot; Test.jsp &quot;的 Jsp 源文件并在其中输入如下代码。</li>
</ol>
<p>&lt;%@ page contentType=&quot;text/html;charset=GBK&quot;%&gt;</p>
<p><html></p>
<p><head></p>
<p><title> Tomcat<em> </em>测试 </title>
</head></p>
<p><body></p>
<p><font color = "red" size = "20" >
&lt;% out.print( &quot;<em> </em>恭喜您，成功的安装并启动了 Tomcat<em> </em>！！！ &quot; ); %&gt;
</font>
</body>
</html></p>
<ol>
<li>重启（命令如下），然后输入：<a href=""><a href="http://localhost:8080/Test.jsp">http://localhost:8080/Test.jsp</a></a> 看是否正常。</li>
</ol>
<p>/#./apache-tomcat-6.0.18/bin/shutdown.sh
/#./apache-tomcat-6.0.18/bin/startup.sh</p>
<p><strong>四：TOMCAT集群的搭建</strong></p>
<ol>
<li>安装两个或以上tomcat</li>
</ol>
<p>/#./apache-tomcat-6.0.18/bin/shutdown.sh
/#mv apache-tomcat-6.0.18 /usr/local/TC6_A
/#cd /usr/local
/#cp -a TC6_A TC6_B</p>
<p>提示：进行上述步骤操作的原因是，本案例中集群的各个 Tomcat 服务器实例运行在同一个物理服务器上，因此集群中有几个 Tomcat 实例一般就需要几个 Tomcat 的安装。另外，由于集群中的各个 Tomcat 实例位于同一个物理服务器上的一个操作系统下，因此各个实例占用的各种网络端口不能相同，否则集群中的多个 Tomcat 实例不能同时正常启动，下面的步骤将介绍如何修改 Tomcat 实例需要使用的各个网络端口。</p>
<ol>
<li>修改 Tomcat 实例需要使用的各个网络端口</li>
</ol>
<ul>
<li>找到 server.xml 配置文件中的&quot; Server &quot;配置项目，并进行修改。
<Server port="8005" shutdown="SHUTDOWN">
<Server port="10005" shutdown="SHUTDOWN"><Server port="20005" shutdown="SHUTDOWN">

</li>
</ul>
<p>说明：第一行为两个 Tomcat 修改前的情况，第二行为 TC6_A Tomcat 修改后的情况，第三行为 TC6_B Tomcat 修改后的情况。</p>
<ul>
<li><p>找到 server.xml 配置文件中的相应&quot; Connector &quot;配置项目，并进行修改。</p>
</li>
<li><p>修改前内容如下：</p>
</li>
</ul>
<p><!-- Define an AJP 1.3 Connector on port 8009 --></p>
<p><Connector port = "8009" protocol = "AJP/1.3" redirectPort = "8443" /></p>
<ul>
<li>TC6_A 中修改后内容如下：</li>
</ul>
<p><!-- Define an AJP 1.3 Connector on port 8009 --></p>
<p><Connector port = " 10009 " protocol = "AJP/1.3" redirectPort = " 10043 " /></p>
<ul>
<li>TC6_B 中修改后内容如下：</li>
</ul>
<p><!-- Define an AJP 1.3 Connector on port 8009 --></p>
<Connector port = " 20009 " protocol = "AJP/1.3" redirectPort = " 20043 " />

<p>提示：此步骤目的是修改 AJP Connector 端口。</p>
<ul>
<li><p>找到 server.xml 配置文件中的另一个相应&quot; Connector &quot;配置项目，并进行修改。</p>
</li>
<li><p>修改前内容如下：</p>
</li>
</ul>
<p><Connector port = "8080" protocol = "HTTP/1.1" connectionTimeout = "20000"
redirectPort = "8443" /></p>
<ul>
<li>TC6_A 中修改后内容如下：</li>
</ul>
<p><Connector port = "10001" protocol = "HTTP/1.1" connectionTimeout = "20000"
redirectPort = "10043" /></p>
<ul>
<li>TC6_B 中修改后内容如下：</li>
</ul>
<Connector port = "20001" protocol = "HTTP/1.1" connectionTimeout = "20000"
redirectPort = "20043" />

<p>提示：此步骤目的是修改 HTTP Connector 端口，其中的&quot; 10001 &quot;与&quot; 20001 &quot;是未来通过浏览器访问集群中各个 Tomcat 实例的 HTTP 端口。</p>
<ul>
<li><p>通过修改 Engine 配置选项，配置集群中每个 Tomcat 实例的名称。</p>
</li>
<li><p>修改前内容如下：</p>
</li>
</ul>
<p>&lt;!-- You should set jvmRoute to support load-balancing via AJP ie :</p>
<p><Engine name = "Standalone" defaultHost = "localhost" jvmRoute = "jvm1"></p>
<p><Engine name = "Catalina" defaultHost = "localhost">
--&gt;</p>
<ul>
<li>TC6_A 中修改后内容如下：</li>
</ul>
<p><Engine name = "Standalone" defaultHost = "localhost" jvmRoute = " Tomcat1"></p>
<ul>
<li>TC6_B 中修改后内容如下：</li>
</ul>
<Engine name = "Standalone" defaultHost = "localhost" jvmRoute = " Tomcat2">

<p>提示：请读者注意在修改过程中要注释掉原来 name 为 Catalina 的 Engine 配置项目，将 name 为 Standalone 的 Engine 配置项目的注释去掉并修改 jvmRoute 属性。</p>
<ul>
<li><p>修改配置文件中的 Cluster 配置项目，对集群的各项参数进行设置。</p>
</li>
<li><p>修改前内容如下：</p>
</li>
</ul>
<Cluster className="org.apache.catalina.ha.tcp.SimpleTcpCluster" />
<em> TC6_A 中修改后内容如下：

<Cluster className = "org.apache.catalina.ha.tcp.SimpleTcpCluster" channelSendOptions = "8">
<Manager className = "org.apache.catalina.ha.session.DeltaManager"
expireSessionsOnShutdown = "false"
notifyListenersOnReplication = "true" />
<Channel className = "org.apache.catalina.tribes.group.GroupChannel" >
<Membership className = "org.apache.catalina.tribes.membership.McastService"
address = "228.0.0.4"
port = "45564"
frequency = "500"
dropTime = "3000"/>
<Receiver className = "org.apache.catalina.tribes.transport.nio.NioReceiver"
address = "auto"
port = "4000"
autoBind = "100"
selectorTimeout = "5000"
maxThreads = "6" />
<Sender className = "org.apache.catalina.tribes.transport.ReplicationTransmitter" >
<Transport className = "org.apache.catalina.tribes.transport.nio.PooledParallelSender" />
</Sender>
<Interceptor
className = "org.apache.catalina.tribes.group.interceptors.TcpFailureDetector" />
<Interceptor className="org.apache.catalina.tribes.group.interceptors.MessageDispatch15Interceptor" />
</Channel>
<Valve className = "org.apache.catalina.ha.tcp.ReplicationValve" filter="" />
<Valve className = "org.apache.catalina.ha.session.JvmRouteBinderValve" />
<Deployer className = "org.apache.catalina.ha.deploy.FarmWarDeployer"
tempDir = "/tmp/war-temp/"
deployDir = "/tmp/war-deploy/"
watchDir = "/tmp/war-listen/"
watchEnabled = "false"/>
<ClusterListener className = "org.apache.catalina.ha.session.JvmRouteSessionIDBinderListener" />
<ClusterListener className = "org.apache.catalina.ha.session.ClusterSessionListener" />
</Cluster>
</em> TC6_B 中修改后内容如下：

<Cluster
className = "org.apache.catalina.ha.tcp.SimpleTcpCluster"
channelSendOptions = "8"
>
<Manager className = "org.apache.catalina.ha.session.DeltaManager"
expireSessionsOnShutdown = "false"
notifyListenersOnReplication = "true" />
<Channel className = "org.apache.catalina.tribes.group.GroupChannel">
<Membership className = "org.apache.catalina.tribes.membership.McastService"
address = "228.0.0.4"
port = "45564"
frequency = "500"
dropTime = "3000" />
<Receiver className = "org.apache.catalina.tribes.transport.nio.NioReceiver"
address = "auto"
port = "4000"
autoBind = "100"
selectorTimeout = "5000"
maxThreads = "6" />
<Sender className = "org.apache.catalina.tribes.transport.ReplicationTransmitter">
<Transport className = "org.apache.catalina.tribes.transport.nio.PooledParallelSender" />
</Sender>
<Interceptor className = "org.apache.catalina.tribes.group.interceptors.TcpFailureDetector" />
<Interceptor className="org.apache.catalina.tribes.group.interceptors.MessageDispatch15Interceptor" />
</Channel>
<Valve className = "org.apache.catalina.ha.tcp.ReplicationValve"
filter = ""/>
<Valve className = "org.apache.catalina.ha.session.JvmRouteBinderValve" />
<Deployer className = "org.apache.catalina.ha.deploy.FarmWarDeployer"
tempDir = "/tmp/war-temp/"
deployDir = "/tmp/war-deploy/"
watchDir = "/tmp/war-listen/"
watchEnabled = "false" />
<ClusterListener className = "org.apache.catalina.ha.session.JvmRouteSessionIDBinderListener" />
<ClusterListener className = "org.apache.catalina.ha.session.ClusterSessionListener" />
</Cluster>

<p>提示：上述配置内容主要是对集群中各个 Tomcat 实例间进行通信的方式、端口以及 Session 共享算法的设置。本教程由于篇幅所限，不能一一详细介绍，有兴趣的读者可以参看 Tomcat 的官方文档，其中有非常详细的说明。</p>
<p>3、测试搭建，分别启动两个tomcat，看是否正常，若正常进行第四步。
<a href=""><a href="http://localhost:10001">http://localhost:10001</a></a>
<a href=""><a href="http://localhost:20001">http://localhost:20001</a></a></p>
<p>4、简单的 JSP 来进一步测试对&quot; TC6_A &quot;和&quot; TC6_B &quot;的设置是否成功,分别建立两个文件：Hello.jsp。
&lt;%@ page contentType=&quot;text/html;charset=GBK&quot;%&gt;</p>
<p><html></p>
<p><head></p>
<p><title>Tomcat 测试 </title>
</head></p>
<p><body></p>
<p><font color="red" size="20">
&lt;!— 使用 out 内建对象打印一条消息到输出页面 --&gt;
&lt;% out.print( &quot;Tomcat 集群测试 A ！！！ &quot; ); %&gt;
</font>
</body>
</html>
TC6_B的改一行输出：
&lt;% out.print( &quot;Tomcat 集群测试 B ！！！ &quot; ); %&gt;</p>
<p>如果能顺利地在浏览器中见到上述两个页面，则说明集群中的两个 Tomcat 实例工作完全正常。下面就可以为集群安装、设置 Apache 负载均衡器了。</p>
<p><strong>五、Apache负载均衡器的安装与配置</strong></p>
<ol>
<li>下载安装</li>
</ol>
<p>/# wget <a href="http://www.apache.org/dist/httpd/httpd-2.2.9.tar.gz" target="_blank">http://www.apache.org/dist/httpd/httpd-2.2.9.tar.gz</a>
/# tar -zxvf httpd-2.2.9.tar.gz
/# cd httpd-2.2.9
/# ./configure --prefix=/usr/local/httpd --enable-mods-shared=&#39;proxy proxy_ajp proxy_balancer&#39;
/# make
/# make install</p>
<ol>
<li>配置Apache 为 Tomcat 集群的负载均衡器</li>
</ol>
<p>ProxyRequests Off
ProxyPass / balancer://myCluster/</p>
<Proxy balancer://myCluster/>
BalancerMember ajp://localhost:10009 route=Tomcat1
BalancerMember ajp://localhost:20009 route=Tomcat2
</Proxy>

<p>说明：其中&quot; myCluster &quot;是集群的名称，&quot; ajp://localhost:10009 route=Tomcat1 &quot; 对应 Tomcat 集群中的 TC6_A 实例，&quot; ajp://localhost:20009 route=Tomcat2 &quot; 对应 Tomcat 集群中的 TC6_B 实例。经过上述配置后， Apache 就可以成为前面搭建的 Tomcat 集群的负载均衡器了。</p>
<p><strong>六、感受成果</strong></p>
<ol>
<li>重启apache httpd后，访问：<a href=""><a href="http://localhost/Hello.jsp">http://localhost/Hello.jsp</a></a>。</li>
<li><p>由 于 Apache 作为 Tomcat 集群的负载均衡器，使用的是轮换算法，其均匀地将请求发送到集群中的各个 Tomcat 实例。因此，从1的测试中可以看出，是轮换访问两个不同 Tomcat 实例中的 Hello.jsp 页面的。当然，看到轮换的情况也就说明 Apache 负载均衡器正常工作了。
<strong>七、补充重要细节</strong></p>
<p> 1、在应用时候，工程的web.xml里面要加上这么一个属性，实现Session共享：
……<em><distributable/></em></p>
</li>
</ol>
<p><em></web-app>
</em></p>
<pre><code>文件中的“ *&lt;distributable/&gt;*”项，是由于本案例将部署到集群中的多个服务器上。如果在配置文件中没 有此项，则应用在集群中不能实现分布式 Session 共享，也就是说当机后用户状态数据（存放在 Session 中的）无法无缝迁移到 Tomcat 集群中的其他服务器上。此项非常重要，请读者多加留心。

然后在依次启动TC6_A,TC6_B,你会在TC6_A的日志里面看到他们的通信日志，不然就是没有成功。

2、Tomcat6 集群要求负载均衡器工作在“ sticky session ”模式下，否则集群可能工作不正常。
</code></pre><p>对“ <strong><em>ProxyPass</em></strong>”项目进行如下修改。</p>
<ul>
<li>修改前</li>
</ul>
<p><strong><em>ProxyPass / balancer://myCluster/</em></strong></p>
<ul>
<li>修改后</li>
</ul>
<p><strong><em>ProxyPass / balancer://myCluster/ lbmethod=byrequests stickysession=JSESSIONID nofailover=Off</em></strong></p>
<p>提示： 修改后添加的“ stickysession=JSESSIONID ”项就是让 Apache 负载均衡器工作在“ sticky session ”模式下。所谓“ sticky session ”模式就是对于使用到同一个 Session 的请求绑定到集群中的特定服务器上，而不是轮换访问各个服务器，这样 Session 就不会工作不正常了。当然，对于使用不同 Session 的请求，还是进行负载均衡轮换的。</p>
<p>本文参照：<a href="http://www.unix-center.net" target="_blank">http://www.unix-center.net</a>
为了您的安全，请只打开来源可靠的网址</p>
<p><a href="http://hi.baidu.com/iammonster/blog/item/84710cdbb1b9f660d1164e60.html" target="_blank">打开网站</a>    <a href="http://apps.hi.baidu.com/share/detail/14955683#" target="_blank">取消</a></p>
<p> 来自: <a href="http://hi.baidu.com/iammonster/blog/item/84710cdbb1b9f660d1164e60.html" target="_blank"><a href="http://hi.baidu.com/iammonster/blog/item/84710cdbb1b9f660d1164e60.html">http://hi.baidu.com/iammonster/blog/item/84710cdbb1b9f660d1164e60.html</a></a></p>
<p><a href=""></a></p>
<p><a href="http://apps.hi.baidu.com/share/detail/14959808#content" target="_blank"></a>  <a href="http://apps.hi.baidu.com/share/detail/14797932#content"></a>
来自: <a href="http://hi.baidu.com/sys/checkuser/iammonster007/3" target="_blank"><img src="" alt=""></a> <a href="http://hi.baidu.com/sys/checkuser/iammonster007/3" target="_blank">iammonster007</a> 第一分享: <a href="http://hi.baidu.com/sys/checkuser/lpwok/3" target="_blank"><img src="" alt=""></a> <a href="http://hi.baidu.com/sys/checkuser/lpwok/3" target="_blank">lpwok</a>  时间: 2010-07-20 16:58 评论: 1条 投票: 1次 本贴分享: 5 累计分享: 6</p>
<h3 id="-1-">共有1人发表观点</h3>
<ul>
<li><p>色妹Q:2372819618
...或者输入其他标签词：
lpwok的 博客 相关分享:</p>
</li>
<li><p><a href="http://apps.hi.baidu.com/share/detail/6723926" title="经典智力挑战游戏——【密室逃脱】全集！！！" target="_blank">经典智力挑战游戏——【密室逃脱】全集！！...</a></p>
</li>
<li><a href="http://apps.hi.baidu.com/share/detail/2863700" title="Ubuntu Linux下Apache的配置文件" target="_blank">Ubuntu Linux下Apache的配置文件</a></li>
<li><a href="http://apps.hi.baidu.com/share/detail/2863689" title="ubuntu中tar.gz/tar.bz2/rar等压缩包软件安装教程" target="_blank">ubuntu中tar.gz/tar.bz2/rar等压缩包软件安...</a></li>
<li><a href="http://apps.hi.baidu.com/share/detail/2327312" title="SEO工具大集合" target="_blank">SEO工具大集合</a></li>
</ul>
<h3 id="-1-">评论(1)</h3>
<p><a href="http://hi.baidu.com/sys/checkuser/784633420/3" target="_blank"><img src="" alt=""></a></p>
<p>2011年12月21日 16:48 <a href="http://hi.baidu.com/sys/checkuser/784633420/3" target="_blank">784633420</a></p>
<p>非常准确</p>
<p><a href="http://help.baidu.com/question?prod_en=space" target="_blank">帮助中心</a> | <a href="http://tieba.baidu.com/f?kw=%B0%D9%B6%C8%BF%D5%BC%E4&amp;fr=wwwt" target="_blank">空间客服</a> | <a href="http://tousu.baidu.com/hi/add" target="_blank">投诉中心</a> | <a href="http://www.baidu.com/search/hi_contract.html" target="_blank">空间协议</a></p>
<p>©2012 Baidu</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/服务器/">服务器</a></li></span><span class="breadcrumb"><li><a href="/categories/服务器/">服务器</a></li><li><a href="/categories/服务器/集群/">集群</a></li></span></span> | <span class="tags">Tagged <a href="/tags/服务器/" class="label label-primary">服务器</a><a href="/tags/集群/" class="label label-success">集群</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:44"datetime="2014-03-07 09:54:44"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-服务器-集群--LINUX下使用apachetomcat构建WEB集群系统/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-服务器-集群--LINUX下使用apachetomcat构建WEB集群系统" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-服务器-集群--Linux下Apache与Tomcat整合的简单方法-LinuxSirOrg/">Linux下Apache与Tomcat整合的简单方法 </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:44.000Z"> <a href="/2014/02/02/2014-02-02-服务器-集群--Linux下Apache与Tomcat整合的简单方法-LinuxSirOrg/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="linux-apache-tomcat-linuxsir-org">Linux下Apache与Tomcat整合的简单方法 - LinuxSir.Org</h1>
<p><a href=""></a> <a href="http://www.linuxsir.org/bbs/index.php?s=b91078e77de0bd2a626708973b8082ac"><img src="&quot;LinuxSir.Org&quot;" alt="LinuxSir.Org"></a>   用户名  密码   记住信息</p>
<p>| <a href="http://www.linuxsir.org/" target="_blank">网站首页</a> |   <a href="http://www.linuxsir.org/bbs/faq.php?s=b91078e77de0bd2a626708973b8082ac" target="_blank">论坛帮助</a> |
欢迎来到<strong>LinuxSir.Org</strong>! 您还未登录，请登录后查看论坛，或者点击论坛上方的注册链接注册新账号。
<a href="http://www.linuxsir.org/bbs/showthread.php?t=236915#" target="_blank"><img src="&quot;返回&quot;" alt="返回"></a>   <a href="http://www.linuxsir.org/bbs/index.php?s=b91078e77de0bd2a626708973b8082ac" target="_blank">LinuxSir.Org</a> &gt; <a href="http://www.linuxsir.org/bbs/forumdisplay.php?s=b91078e77de0bd2a626708973b8082ac&amp;f=39" target="_blank">Linux 发行版讨论区 —— LinuxSir.Org</a> &gt; <a href="http://www.linuxsir.org/bbs/forumdisplay.php?s=b91078e77de0bd2a626708973b8082ac&amp;f=49" target="_blank">Linux 发行版Debian专题</a> &gt; Linux下Apache与Tomcat整合的简单方法
转到页面...  <a href=""></a>  <a href="http://www.linuxsir.org/bbs/newthread.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newthread&amp;f=49"><img src="&quot;发表新主题&quot;" alt="发表新主题"></a>  <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;noquote=1&amp;p=1354073" target="_blank"><img src="&quot;回复&quot;" alt="回复"></a>     <a href="http://www.linuxsir.org/bbs/showthread.php?t=236915&amp;nojs=1#goto_threadtools" target="_blank">主题工具</a>  <img src="" alt=""></p>
<p><a href=""><img src="&quot;旧&quot;" alt="旧"></a> 05-12-23, 20:51 <a href="http://www.linuxsir.org/bbs/showpost.php?s=b91078e77de0bd2a626708973b8082ac&amp;p=1354073&amp;postcount=1" target="_blank"><strong>第 1 帖</strong></a> <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=45616" target="_blank"><strong>Kilin</strong></a></p>
<p><img src="" alt=""></p>
<p><a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=45616" target="_blank"><img src="&quot;Kilin 的头像&quot;" alt="Kilin 的头像"></a>  </p>
<p>注册会员<br>  注册日期: Jun 2004</p>
<p>  帖子: 321
  <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;goodnees=1&amp;u=45616" target="_blank">精华</a>: 1        <strong>标题: Linux下Apache与Tomcat整合的简单方法</strong>
1、准备，下载需要的文件。这里假定你已经正确安装配置好了JDK。
到Apache官方网站下载所需要的文件：
httpd-2.2.0.tar.gz
apache-tomcat-5.5.12.tar.gz
jakarta-tomcat-connectors-1.2.15-src.tar.gz
其中httpd和jakarta-tomcat-connectors为源码包，apache-tomcat为二进制包。
2、安装Apache。
代码: /# tar xzvf httpd-2.2.0.tar.gz /# cd httpd-2.2.0 /# ./configure --prefix=/usr/local/apache2 --enable-so /# make /# make install3、安装Tomcat。
代码: /# cp apache-tomcat-5.5.12.tar.gz /usr/local/ /# cd /usr/local /# tar xzvf apache-tomcat-5.5.12.tar.gz /# ln -s apache-tomcat-5.5.12 tomcat4、编译生成mod_jk。
代码: /# tar xzvf jakarta-tomcat-connectors-1.2.15-src.tar.gz /# cd jakarta-tomcat-connectors-1.2.15-src/jk/native /# ./configure --with-apxs=/usr/local/apache2/bin/apxs /# make /# cp ./apache-2.0/mod_jk.so /usr/local/apache2/modules/5、配置。
在/usr/local/apache2/conf/下面建立两个配置文件mod_jk.conf和workers.properties。
/# vi mod_jk.conf
添加以下内容：
代码: /# 指出mod_jk模块工作所需要的工作文件workers.properties的位置 JkWorkersFile /usr/local/apache2/conf/workers.properties /# Where to put jk logs JkLogFile /usr/local/apache2/logs/mod_jk.log /# Set the jk log level [debug/error/info] JkLogLevel info /# Select the log format JkLogStampFormat &quot;[%a %b %d %H:%M:%S %Y]&quot; /# JkOptions indicate to send SSL KEY SIZE, JkOptions +ForwardKeySize +ForwardURICompat -ForwardDirectories /# JkRequestLogFormat set the request format JkRequestLogFormat &quot;%w %V %T&quot; /# 将所有servlet 和jsp请求通过ajp13的协议送给Tomcat，让Tomcat来处理 JkMount /servlet//<em> worker1 JkMount //</em>.jsp worker1/# vi workers.properties
添加以下内容：
代码: /# Defining a worker named worker1 and of type ajp13 worker.list=worker1 /# Set properties for worker1 worker.worker1.type=ajp13 worker.worker1.host=localhost worker.worker1.port=8009 worker.worker1.lbfactor=50 worker.worker1.cachesize=10 worker.worker1.cache_timeout=600 worker.worker1.socket_keepalive=1 worker.worker1.socket_timeout=300再配置httpd.conf，作以下修改：
将Listen 80 修改为 Listen 127.0.0.1:80
将ServerName 修改为 ServerName LocalHost:80
在DirectoryIndex中添加 index.jsp
我的网页放在/var/wwwroot下，所以要修改DocumentRoot
代码: DocumentRoot &quot;/var/wwwroot&quot; <Directory "/var/wwwroot"> Options Includes FollowSymLinks AllowOverride None Order deny,allow Allow from all XBitHack on </Directory> <Directory "/var/wwwroot/WEB-INF"> Order deny,allow Deny from all </Directory>增加关于加载mod_jk的语句：
代码: LoadModule jk_module modules/mod_jk.so Include /usr/local/apache2/conf/mod_jk.conf最后编辑Tomcat的配置文件server.xml，在HOST段中加入：
代码: <Context path="" docBase="/var/wwwroot" debug="0" reloadable="true" crossContext="true"/>在/var/wwwroot下建立一个index.jsp，启动Apache和Tomcat，用浏览器访问<a href="http://localhost/，应该可以看到正确的页面了。" target="_blank">http://localhost/，应该可以看到正确的页面了。</a></p>
<hr>
<p>Only the strong survive.
Blog:<a href="http://www.ylxiong.cn/" target="_blank">http://www.ylxiong.cn/</a>
Linux 2.6</p>
<p><em>此帖于 05-12-23 20:55 被 Kilin 编辑.</em>   <img src="&quot;Kilin 当前离线&quot;" alt="Kilin 当前离线">   <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;p=1354073" target="_blank"><img src="&quot;回复时引用此帖&quot;" alt="回复时引用此帖"></a></p>
<p>Kilin <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=45616" target="_blank">查看公开信息</a> <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;u=45616" target="_blank">查找 Kilin 发表的更多帖子</a></p>
<p><a href=""><img src="&quot;旧&quot;" alt="旧"></a> 05-12-24, 19:59 <a href="http://www.linuxsir.org/bbs/showpost.php?s=b91078e77de0bd2a626708973b8082ac&amp;p=1354576&amp;postcount=2" target="_blank"><strong>第 2 帖</strong></a> <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank"><strong>lyingjie</strong></a>  <img src="&quot;帅哥&quot;" alt="帅哥"></p>
<p><img src="" alt=""></p>
<p><a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank"><img src="&quot;lyingjie 的头像&quot;" alt="lyingjie 的头像"></a>  </p>
<p>注册会员<br>  注册日期: Aug 2005</p>
<p>  帖子: 284
  精华: 0        问一下老兄，Apache2不能用apt进行安装吗</p>
<hr>
<p>Debian Linux学习基地
<a href="http://www.debian.ha.cn" target="_blank">http://www.debian.ha.cn</a>   <img src="&quot;lyingjie 当前离线&quot;" alt="lyingjie 当前离线">   <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;p=1354576" target="_blank"><img src="&quot;回复时引用此帖&quot;" alt="回复时引用此帖"></a></p>
<p>lyingjie <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank">查看公开信息</a> <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;u=89579" target="_blank">查找 lyingjie 发表的更多帖子</a>
<a href=""><img src="&quot;旧&quot;" alt="旧"></a> 05-12-24, 20:58 <a href="http://www.linuxsir.org/bbs/showpost.php?s=b91078e77de0bd2a626708973b8082ac&amp;p=1354612&amp;postcount=3" target="_blank"><strong>第 3 帖</strong></a> <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank"><strong>lyingjie</strong></a>  <img src="&quot;帅哥&quot;" alt="帅哥"></p>
<p><img src="" alt=""></p>
<p><a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank"><img src="&quot;lyingjie 的头像&quot;" alt="lyingjie 的头像"></a>  </p>
<p>注册会员<br>  注册日期: Aug 2005</p>
<p>  帖子: 284
  精华: 0        我用apt安装时进入apache2目录后没有conf这个子目录   <img src="&quot;lyingjie 当前离线&quot;" alt="lyingjie 当前离线">   <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;p=1354612" target="_blank"><img src="&quot;回复时引用此帖&quot;" alt="回复时引用此帖"></a></p>
<p>lyingjie <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank">查看公开信息</a> <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;u=89579" target="_blank">查找 lyingjie 发表的更多帖子</a></p>
<p><a href=""><img src="&quot;旧&quot;" alt="旧"></a> 05-12-24, 21:35 <a href="http://www.linuxsir.org/bbs/showpost.php?s=b91078e77de0bd2a626708973b8082ac&amp;p=1354644&amp;postcount=4" target="_blank"><strong>第 4 帖</strong></a> <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=45616" target="_blank"><strong>Kilin</strong></a></p>
<p><img src="" alt=""></p>
<p><a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=45616" target="_blank"><img src="&quot;Kilin 的头像&quot;" alt="Kilin 的头像"></a>  </p>
<p>注册会员<br>  注册日期: Jun 2004</p>
<p>  帖子: 321
  <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;goodnees=1&amp;u=45616" target="_blank">精华</a>: 1        可以吧 应该在/etc/local/etc/目录下吧.......
或者在/etc/local/share/etc/下
如果做服务器用的话 建议安装基本系统 然后再自己安装需要的Server端软件。   <img src="&quot;Kilin 当前离线&quot;" alt="Kilin 当前离线">   <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;p=1354644" target="_blank"><img src="&quot;回复时引用此帖&quot;" alt="回复时引用此帖"></a></p>
<p>Kilin <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=45616" target="_blank">查看公开信息</a> <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;u=45616" target="_blank">查找 Kilin 发表的更多帖子</a>
<a href=""><img src="&quot;旧&quot;" alt="旧"></a> 05-12-25, 11:35 <a href="http://www.linuxsir.org/bbs/showpost.php?s=b91078e77de0bd2a626708973b8082ac&amp;p=1354810&amp;postcount=5" target="_blank"><strong>第 5 帖</strong></a> <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank"><strong>lyingjie</strong></a>  <img src="&quot;帅哥&quot;" alt="帅哥"></p>
<p><img src="" alt=""></p>
<p><a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank"><img src="&quot;lyingjie 的头像&quot;" alt="lyingjie 的头像"></a>  </p>
<p>注册会员<br>  注册日期: Aug 2005</p>
<p>  帖子: 284
  精华: 0        谢了我在试试   <img src="&quot;lyingjie 当前离线&quot;" alt="lyingjie 当前离线">   <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;p=1354810" target="_blank"><img src="&quot;回复时引用此帖&quot;" alt="回复时引用此帖"></a></p>
<p>lyingjie <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank">查看公开信息</a> <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;u=89579" target="_blank">查找 lyingjie 发表的更多帖子</a></p>
<p><a href=""><img src="&quot;旧&quot;" alt="旧"></a> 05-12-25, 11:58 <a href="http://www.linuxsir.org/bbs/showpost.php?s=b91078e77de0bd2a626708973b8082ac&amp;p=1354826&amp;postcount=6" target="_blank"><strong>第 6 帖</strong></a> <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=45616" target="_blank"><strong>Kilin</strong></a></p>
<p><img src="" alt=""></p>
<p><a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=45616" target="_blank"><img src="&quot;Kilin 的头像&quot;" alt="Kilin 的头像"></a>  </p>
<p>注册会员<br>  注册日期: Jun 2004</p>
<p>  帖子: 321
  <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;goodnees=1&amp;u=45616" target="_blank">精华</a>: 1        汗.....昨天喝高了 把路径打得一塌糊涂.....
应该是/etc
或者是/usr/etc
或者是/usr/local/etc
猜的~   <img src="&quot;Kilin 当前离线&quot;" alt="Kilin 当前离线">   <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;p=1354826" target="_blank"><img src="&quot;回复时引用此帖&quot;" alt="回复时引用此帖"></a></p>
<p>Kilin <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=45616" target="_blank">查看公开信息</a> <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;u=45616" target="_blank">查找 Kilin 发表的更多帖子</a>
<a href=""><img src="&quot;旧&quot;" alt="旧"></a> 05-12-25, 14:24 <a href="http://www.linuxsir.org/bbs/showpost.php?s=b91078e77de0bd2a626708973b8082ac&amp;p=1354897&amp;postcount=7" target="_blank"><strong>第 7 帖</strong></a> <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank"><strong>lyingjie</strong></a>  <img src="&quot;帅哥&quot;" alt="帅哥"></p>
<p><img src="" alt=""></p>
<p><a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank"><img src="&quot;lyingjie 的头像&quot;" alt="lyingjie 的头像"></a>  </p>
<p>注册会员<br>  注册日期: Aug 2005</p>
<p>  帖子: 284
  精华: 0        好的，那在问你一个问题我现在按照你所讲的我已经配成了JSP可以为什么我打开静态页是打不开呀？
提示你无权查看该页   <img src="&quot;lyingjie 当前离线&quot;" alt="lyingjie 当前离线">   <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;p=1354897" target="_blank"><img src="&quot;回复时引用此帖&quot;" alt="回复时引用此帖"></a></p>
<p>lyingjie <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank">查看公开信息</a> <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;u=89579" target="_blank">查找 lyingjie 发表的更多帖子</a></p>
<p><a href=""><img src="&quot;旧&quot;" alt="旧"></a> 05-12-25, 17:38 <a href="http://www.linuxsir.org/bbs/showpost.php?s=b91078e77de0bd2a626708973b8082ac&amp;p=1354988&amp;postcount=8" target="_blank"><strong>第 8 帖</strong></a> <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=45616" target="_blank"><strong>Kilin</strong></a></p>
<p><img src="" alt=""></p>
<p><a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=45616" target="_blank"><img src="&quot;Kilin 的头像&quot;" alt="Kilin 的头像"></a>  </p>
<p>注册会员<br>  注册日期: Jun 2004</p>
<p>  帖子: 321
  <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;goodnees=1&amp;u=45616" target="_blank">精华</a>: 1        httpd.conf里的权限设置.....   <img src="&quot;Kilin 当前离线&quot;" alt="Kilin 当前离线">   <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;p=1354988" target="_blank"><img src="&quot;回复时引用此帖&quot;" alt="回复时引用此帖"></a></p>
<p>Kilin <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=45616" target="_blank">查看公开信息</a> <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;u=45616" target="_blank">查找 Kilin 发表的更多帖子</a>
<a href=""><img src="&quot;旧&quot;" alt="旧"></a> 05-12-25, 17:43 <a href="http://www.linuxsir.org/bbs/showpost.php?s=b91078e77de0bd2a626708973b8082ac&amp;p=1354995&amp;postcount=9" target="_blank"><strong>第 9 帖</strong></a> <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank"><strong>lyingjie</strong></a>  <img src="&quot;帅哥&quot;" alt="帅哥"></p>
<p><img src="" alt=""></p>
<p><a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank"><img src="&quot;lyingjie 的头像&quot;" alt="lyingjie 的头像"></a>  </p>
<p>注册会员<br>  注册日期: Aug 2005</p>
<p>  帖子: 284
  精华: 0        能不能说的在明白点呀，我以前做LAMP时有时也会出现这样子的问题   <img src="&quot;lyingjie 当前离线&quot;" alt="lyingjie 当前离线">   <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;p=1354995" target="_blank"><img src="&quot;回复时引用此帖&quot;" alt="回复时引用此帖"></a></p>
<p>lyingjie <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank">查看公开信息</a> <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;u=89579" target="_blank">查找 lyingjie 发表的更多帖子</a></p>
<p><a href=""><img src="&quot;旧&quot;" alt="旧"></a> 05-12-26, 09:59 <a href="http://www.linuxsir.org/bbs/showpost.php?s=b91078e77de0bd2a626708973b8082ac&amp;p=1355323&amp;postcount=10" target="_blank"><strong>第 10 帖</strong></a> <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank"><strong>lyingjie</strong></a>  <img src="&quot;帅哥&quot;" alt="帅哥"></p>
<p><img src="" alt=""></p>
<p><a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank"><img src="&quot;lyingjie 的头像&quot;" alt="lyingjie 的头像"></a>  </p>
<p>注册会员<br>  注册日期: Aug 2005</p>
<p>  帖子: 284
  精华: 0        还有我如果用Apt安装的话那不能给讲讲如何做呀   <img src="&quot;lyingjie 当前离线&quot;" alt="lyingjie 当前离线">   <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;p=1355323" target="_blank"><img src="&quot;回复时引用此帖&quot;" alt="回复时引用此帖"></a></p>
<p>lyingjie <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank">查看公开信息</a> <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;u=89579" target="_blank">查找 lyingjie 发表的更多帖子</a>
<a href=""><img src="&quot;旧&quot;" alt="旧"></a> 05-12-27, 22:02 <a href="http://www.linuxsir.org/bbs/showpost.php?s=b91078e77de0bd2a626708973b8082ac&amp;p=1356579&amp;postcount=11" target="_blank"><strong>第 11 帖</strong></a> <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=55742" target="_blank"><strong>marvel</strong></a></p>
<p><img src="" alt=""></p>
<p>注册会员<br>  注册日期: Oct 2004</p>
<p>  帖子: 489
  精华: 0        apache配置文件的默认路径应该是/etc/apache/httpd.conf吧</p>
<hr>
<p>Thinkpad T60
酷睿 1.83GHz+512Mb DDR+80Gb+ATI(64Mb)
Debian unstable   <img src="&quot;marvel 当前离线&quot;" alt="marvel 当前离线">   <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;p=1356579" target="_blank"><img src="&quot;回复时引用此帖&quot;" alt="回复时引用此帖"></a></p>
<p>marvel <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=55742" target="_blank">查看公开信息</a> <a href="http://marvel.hit.edu.cn/" target="_blank">访问 marvel 的个人网站</a> <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;u=55742" target="_blank">查找 marvel 发表的更多帖子</a></p>
<p><a href=""><img src="&quot;旧&quot;" alt="旧"></a> 05-12-28, 03:25 <a href="http://www.linuxsir.org/bbs/showpost.php?s=b91078e77de0bd2a626708973b8082ac&amp;p=1356702&amp;postcount=12" target="_blank"><strong>第 12 帖</strong></a> <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=27503" target="_blank"><strong>wjl</strong></a></p>
<p><img src="" alt=""></p>
<p><a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=27503" target="_blank"><img src="&quot;wjl 的头像&quot;" alt="wjl 的头像"></a>  </p>
<p>注册会员<br>  注册日期: Nov 2003</p>
<p>  我的住址: 北京
  帖子: 90</p>
<p>  精华: 0
  good谢谢</p>
<hr>
<p>FreeBSD
RHEL AS</p>
<h2 id="windows-xp">Windows XP</h2>
<p>借我一生,好好爱你   <img src="&quot;wjl 当前离线&quot;" alt="wjl 当前离线">   <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;p=1356702" target="_blank"><img src="&quot;回复时引用此帖&quot;" alt="回复时引用此帖"></a></p>
<p>wjl <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=27503" target="_blank">查看公开信息</a> <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;u=27503" target="_blank">查找 wjl 发表的更多帖子</a>
<a href=""><img src="&quot;旧&quot;" alt="旧"></a> 05-12-28, 10:35 <a href="http://www.linuxsir.org/bbs/showpost.php?s=b91078e77de0bd2a626708973b8082ac&amp;p=1356852&amp;postcount=13" target="_blank"><strong>第 13 帖</strong></a> <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank"><strong>lyingjie</strong></a>  <img src="&quot;帅哥&quot;" alt="帅哥"></p>
<p><img src="" alt=""></p>
<p><a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank"><img src="&quot;lyingjie 的头像&quot;" alt="lyingjie 的头像"></a>  </p>
<p>注册会员<br>  注册日期: Aug 2005</p>
<p>  帖子: 284
  精华: 0        你说的是Apache1.3的位置   <img src="&quot;lyingjie 当前离线&quot;" alt="lyingjie 当前离线">   <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;p=1356852" target="_blank"><img src="&quot;回复时引用此帖&quot;" alt="回复时引用此帖"></a></p>
<p>lyingjie <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank">查看公开信息</a> <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;u=89579" target="_blank">查找 lyingjie 发表的更多帖子</a>
<a href="http://www.linuxsir.org/bbs/newthread.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newthread&amp;f=49" target="_blank"><img src="&quot;发表新主题&quot;" alt="发表新主题"></a>  <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;noquote=1&amp;p=1356852" target="_blank"><img src="&quot;回复&quot;" alt="回复"></a>
<strong>«</strong> <a href="http://www.linuxsir.org/bbs/showthread.php?s=b91078e77de0bd2a626708973b8082ac&amp;t=236915&amp;goto=nextoldest" target="_blank">上一主题</a> | <a href="http://www.linuxsir.org/bbs/showthread.php?s=b91078e77de0bd2a626708973b8082ac&amp;t=236915&amp;goto=nextnewest" target="_blank">下一主题</a> <strong>»</strong>
主题工具<a href=""></a> <img src="&quot;显示可打印版本&quot;" alt="显示可打印版本"> <a href="http://www.linuxsir.org/bbs/printthread.php?s=b91078e77de0bd2a626708973b8082ac&amp;t=236915">显示可打印版本</a> <img src="&quot;邮寄本页给好友&quot;" alt="邮寄本页给好友"> <a href="http://www.linuxsir.org/bbs/sendmessage.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=sendtofriend&amp;t=236915" target="_blank">邮寄本页给好友</a>      <a href="http://www.linuxsir.org/bbs/showthread.php?t=236915#top" target="_blank"><img src="" alt=""></a> 发帖规则 您 [不可以] 发表新主题</p>
<p>您 [不可以] 回复主题
您 [不可以] 上传附件</p>
<p>您 [不可以] 编辑您的帖子
已 [启用] <a href="http://www.linuxsir.org/bbs/misc.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=bbcode" target="_blank">BB 代码</a></p>
<p>已 [启用] <a href="http://www.linuxsir.org/bbs/misc.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=showsmilies" target="_blank">表情符号</a>
已 [启用] <a href="http://www.linuxsir.org/bbs/misc.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=bbcode#imgcode" target="_blank">IMG 代码</a></p>
<p>已 [禁用] HTML 代码 [论坛跳转…]
用户控制面板 悄悄话 收藏夹 会员在线状态 搜索论坛 论坛首页    Linux 综合讨论区 —— LinuxSir.Org     Linux 基础建设讨论专版     Linux shell进阶应用与shell编程     Linux 专业英文精品技术文档专题         Gas中文小组讨论区     Linux 硬件及周边设备     Linux 网络与服务器架设     Linux 系统及网络安全讨论专版     Linux及计算机学科基础理论版  Linux 发行版讨论区 —— LinuxSir.Org     Linux 发行版SuSE专题     Linux 发行版Archlinux讨论区     Linux 发行版Debian专题     Ubuntu Linux 专题讨论     Linux 发行版Slackware专题     Linux 发行版 LFS 讨论区         Olive讨论区 （实验版）     Linux 发行版Mandriva专题     Linux 发行版Redhat/Fedora/CentOS专题     Linux 发行版Gentoo讨论区     Mini Linux 及准系统研究     Linux 发行版红旗专题     LoongSon-龙芯讨论区     Linux 发行版其他专题         Linux发行版 Turbolinux专题         PowerPC Linux 讨论区  Google 产品讨论区 —— LinuxSir.Org     Android  Linux 软件应用讨论区 —— LinuxSir.Org     Linux 输入开发与研究     Linux 软件专题讨论         软件下载讨论区         即时通讯  Linux 高级应用讨论区 —— LinuxSir.Org     Linux 数据库专题讨论     Linux 认证考试学习与经验交流     Linux 内核研究小组     Linux 企业级应用专题讨论  编程开发讨论区 —— LinuxSir.Org     Linux 程序设计专题讨论     Java 程序设计开发讨论     Perl | PHP | Python 脚本程序开发     嵌入式Linux讨论区──实验田版  Unix 技术讨论区 —— LinuxSir.Org     BSD 讨论专题         BSD 新闻安全观察         RelaxBSD 讨论区     Solaris 讨论专题     MacOSX &amp; Darwin 讨论专题  社区中心 —— LinuxSir.Org     LinuxSir 论坛管理         LinuxSir 论坛临时存放区     LinuxSir 文章管理系统和BBS程序研究小组     小企鹅新闻图书馆     LinuxSir.Org 同城行 ── 我的城市
所有时间均为[北京时间]。现在的时间是 21:28。
<strong><a href="http://www.linuxsir.org/" target="_blank">网站首页</a> - <a href="mailto:kevin@linuxsir.org">联系我们</a> - <a href="http://www.linuxsir.org/bbs/showthread.php?t=236915#top" target="_blank">返回顶端</a></strong>
Powered by vBulletin 版本 3.6.8
版权所有 ©2000 - 2012, Jelsoft Enterprises Ltd.
官方中文技术支持: <a href="http://www.vbulletin-china.cn/" target="_blank">vBulletin 中文</a></p>
<p>版权所有 ©2002 - 2011, LinuxSir.Org</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/服务器/">服务器</a></li></span><span class="breadcrumb"><li><a href="/categories/服务器/">服务器</a></li><li><a href="/categories/服务器/集群/">集群</a></li></span></span> | <span class="tags">Tagged <a href="/tags/服务器/" class="label label-primary">服务器</a><a href="/tags/集群/" class="label label-success">集群</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:44"datetime="2014-03-07 09:54:44"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-服务器-集群--Linux下Apache与Tomcat整合的简单方法-LinuxSirOrg/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-服务器-集群--Linux下Apache与Tomcat整合的简单方法-LinuxSirOrg" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>





<ul id="pagination" class="pagination pagination-lg">
  <li><a class="extend prev" href="/page/19/">&laquo;</a></li><li><a class="page-number" href="/">1</a></li><li><a class="page-number" href="/page/2/">2</a></li><li><span class="space">&hellip;</span></li><li><a class="page-number" href="/page/17/">17</a></li><li><a class="page-number" href="/page/18/">18</a></li><li><a class="page-number" href="/page/19/">19</a></li><li class="active"><li><span class="page-number current">20</span></li><li><a class="page-number" href="/page/21/">21</a></li><li><a class="page-number" href="/page/22/">22</a></li><li><a class="page-number" href="/page/23/">23</a></li><li><span class="space">&hellip;</span></li></li><li><a class="page-number" href="/page/164/">164</a></li><li><a class="page-number" href="/page/165/">165</a></li><li><a class="extend next" href="/page/21/">&raquo;</a></li>
  <div class="clearfix"></div>
</ul></div><!--wapper-->
       </div><!-- ID main-col END -->
       <aside id="sidebar" class="alignright col-sx-6 col-sm-4 col-md-3 col-lg-3">
<div id="widget_search" class="widget panel panel-primary">
    <form action="//google.com/search" method="get" accept-charset="utf-8">
  <div class="input-group">
    <input class="form-control" id="searchbox" type="search" name="q" results="0" placeholder="search">
    <span class="input-group-btn">
      <button class="btn btn-default" type="submit">Go!</button>
    </span>
    <input type="hidden" name="q" value="site:itsolife.com">
  </div>
</form>
</div>

<div id="widget_category" class="widget panel panel-primary">
  <div class="panel-heading">category</div>  <div data-src='category' class='ajax_widgets'>正在加载...</div>
</div>

<div id="widget_recent_posts" class="widget panel panel-primary">
  <div class="panel-heading">recent posts</div>  <div data-src='recent_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_tagcloud" class="widget panel panel-primary">
  <div class="panel-heading">tagcloud</div>  <div data-src='tagcloud' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_latest_update_posts" class="widget panel panel-primary">
  <div class="panel-heading">最近更新</div>  <div data-src='latest_update_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_recent_comments" class="widget panel panel-primary">
  <div class="panel-heading">recent comments</div>  

<div class="list-group-item ds-recent-comments" data-num-items="6" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="50"></div>



</div>

</aside>
       <div class="clearfix"></div>
     </div><!-- row END -->
  </div>
  <footer id="footer" class="container">
  <div class="panel panel-info">
  <section id='footer_widget'></section>  <div class="panel-footer">
  <div id="site-info">
    <span class='author'>
  
  &copy; 2014 RobinChia
  
    &nbsp;&nbsp;</span>
  
  <span id='analytics-51la'></span><span id='analytics-google'>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-48559895-1']);
  _gaq.push(['_trackPageview']);
  _js2load.push({src:('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'});
</script></span><span id='analytics-cnzz'>
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_5774006'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s17.cnzz.com/stat.php%3Fid%3D5774006%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
</span><span id='analytics-baidu'>
<script>
var _hmt = _hmt || [];
_js2load.push({src:"//hm.baidu.com/hm.js?1442f50724afc42380b51f097c43082c"});
</script>
</span>  </div>
  <div id="copyright">Blog powered by <a href='http://zespia.tw/hexo/'><strong>hexo</strong></a> Theme <strong><a href='https://github.com/chenall/hexo-theme-chenall'>chenall</a></strong>(Some change in it)<span class="pull-right"> 更新时间: <em>2014-03-15 16:55:36</em></span></div>
</div>
<div class="clearfix"></div>


  </div>
  </footer>
  
        <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>        
        <script src="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/js/bootstrap.min.js"></script>        
                
        <script src="http://cdn.bootcss.com/prettify/r298/prettify.min.js"></script>    <script type="text/javascript">
   var lang=["bsh", "c", "cc", "cpp", "cs", "csh", "cyc", "cv", "htm", "html",
    "java", "js", "m", "mxml", "perl", "pl", "pm", "py", "rb", "sh",
    "xhtml", "xml", "xsl"];
   var pretty_base='';
   $('script').each(function(){
	var c = $(this).attr('src');
	if (!c)
	    return;
	if (c.match(/(\/)?prettify(\.min)?\.js/i))
	{
	    var index = c.lastIndexOf('/');
	    if (index != -1)
		pretty_base = c.substr(0,index + 1);
	    return false;
	}
   })
   $('pre code').each(function(){
	var c = $(this).attr('class')
	if (!c)
	    return;
	c = c.match(/\s?(lang\-\w+)/i);
	if (c && lang.indexOf(c[1]) == -1)
	{
	    lang.push(c[1]);
	    $.getScript(pretty_base + c[1] + '.min.js');
	}
   })

    $(window).load(function(){
       $("pre").addClass("prettyprint");
       prettyPrint();
    })
</script>    
            <script type="text/javascript">
var duoshuoQuery = {short_name:"robinchia"};
_js2load.push({src:'http://static.duoshuo.com/embed.js',charset:'UTF-8'});
</script>
    
            <!--wumii_relatedItems-->
    
        <script src="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js"></script>    <script type="text/javascript">
(function($){
  $('.entry').each(function(i){
    $(this).find('img').each(function(){
      var alt = this.alt;

      if (alt){
        $(this).before('<span class="caption">' + alt + '</span>');
      }

      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="fancybox' + i + '" />');
    });
  });

  $('.fancybox').fancybox();
})(jQuery);
</script>    
        <script src="http://cdn.bootcss.com/mathjax/2.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>
    
<script type="text/javascript">
$('.ajax_widgets').each(function(){var src=$(this).attr('data-src');if(src)$(this).load('/widgets/'+src+'.html');});
$.each(_js2load,function(index,obj){loadjs(obj.src,obj.charset)});
</script>

<div id="scroll2top">
<img src="/scroll2top/arrow.png"/>
</div>
<script src="/scroll2top/scroll2top.min.js"></script>
<div id="winterland">
  <canvas></canvas>
</div>
<script src="/js/winterland.min.js"></script>

  </body>
</html>
