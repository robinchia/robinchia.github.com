
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>The 91 Page | It so life</title>
<meta name="author" content="RobinChia">

<meta name="description" content="It so life">


<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta property="og:site_name" content="It so life"/>

<!--[if IE]><style>.testIE.IE{display:inline;}</style><![endif]-->
<!--[if lte IE 7]><link rel="stylesheet" href="/css/ie7.css" type="text/css"><![endif]-->
<!--[if (lt IE 9)&(gt IE 7)]><style>.testIE.IE8{display:inline;}</style><![endif]-->
<!--[if gt IE 8]><style>.testIE.IE9{display:inline;}</style><![endif]-->

<link href="/favicon.png" rel="icon">
<link rel="alternate" href="/atom.xml" title="It so life Feed" type="application/atom+xml">

<link rel="stylesheet" href="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.0.3/css/font-awesome.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/prettify/r298/prettify.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" type="text/css">
<link rel="stylesheet" href="/css/style.css" type="text/css">
<!--[if lt IE 9]>
   <style>article,aside,dialog,footer,header,section,footer,nav,figure,menu{display:block}</style>
   <script src="http://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
   <script src="http://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
<link href="http://cdn.staticfile.org/respond.js/1.4.2/respond-proxy.html" id="respond-proxy" rel="respond-proxy" />
<link href="/js/respond.proxy.gif" id="respond-redirect" rel="respond-redirect" />
<script src="/js/respond.proxy.js"></script>
   <script src="http://cdn.bootcss.com/selectivizr/1.0.2/selectivizr-min.js"></script>
<![endif]-->
<script type="text/javascript">
function loadjs(c,d){var a=document.createElement("script");a.async=!0;a.type="text/javascript";a.src=c;a.charset=d||"gbk";(document.getElementsByTagName("HEAD")[0]||document.getElementsByTagName("BODY")[0]).appendChild(a)};
var _protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
var _js2load = [];
</script>

</head>
<body>
      <header id="header" class="container"><nav id="main-nav" class="navbar navbar-default navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="/">It so life</a>
    </div>
    <div  class="collapse navbar-collapse">
      <ul  class="nav navbar-nav">
  
        <li><a href="/" title="Home">Home</a></li>      
        <li><a href="/about/" title="About">About</a></li>      
        <li><a href="/archives/" title="Archives">Archives</a></li>      
      <li class='dropdown'>
        <a class='dropdown-toggle' data-toggle='dropdown' href='#'>website<b class='caret'></b></a>
        <ul class='dropdown-menu pure-menu-selected'>
    
          <li><a href="//groups.google.com/forum/#!forum/pongba" title="TopLanguage">TopLanguage</a></li>    
          <li><a href="//itpub.net/" title="ITPub">ITPub</a></li>    
          <li><a href="//blog.jobbole.com/" title="Bole">Bole</a></li>    
          <li><a href="//nosql-database.org/" title="nosql">nosql</a></li>    
          <li><a href="//gitimmersion.googol.im/" title="Git">Git</a></li>    
        </ul>
      </li>
    
      </ul>
      <ul class="nav navbar-nav navbar-right">
      
        <li><a href="/atom.xml">RSS</a></li>
      
      
        <li><a href="https://twitter.com/robinchia">twitter</a></li>
      
      
      
      
        <li><a href="https://github.com/robinchia">github</a></li>
      
      </ul>
    </div>
  </div>
</nav>
<div class="clearfix"></div>
</header>
  <div id='content' class="container">
     <div class="page-header-wrapper">
      <!--[if lt IE 9]><div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong>提示:</strong>您的浏览器版本太低了,建议升级到 <strong><a href="http://windows.microsoft.com/zh-cn/internet-explorer/download-ie" title="IE9">IE9</a></strong> 以上,本站使用<a href="https://www.google.com/intl/zh-CN/chrome/">Chrome浏览器</a>可以获得最好的显示效果.</div><![endif]-->
      <div class="page-header"><h1 align="center"><big>It so life</big> </h1>
        <h5 align="center"><big>love as life</big></h5>
      </div>
     </div>
     <div class="row">
       <div id="main-col" class="alignleft col-sx-12 col-sm-8 col-md-9 col-lg-9">
      <section id='header_widget'></section>
          <div id="wrapper"><article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-安全-学习手册类--快速Python语言入门教学，课程，课件，教材，自学，概念«SEBUG团队论坛/">快速 Python 语言入门教学，课程，课件，教材，自学，概念 « SEBUG团队论坛</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:39.000Z"> <a href="/2014/02/02/2014-02-02-安全-学习手册类--快速Python语言入门教学，课程，课件，教材，自学，概念«SEBUG团队论坛/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-python-sebug-">快速 Python 语言入门教学，课程，课件，教材，自学，概念 « SEBUG团队论坛</h1>
<h1 id="-sebug-http-sebug-net-bbs-"><a href="http://sebug.net/bbs/" target="_blank">SEBUG团队论坛</a></h1>
<p>bbs.sebug.net | SEBUG安全漏洞信息库</p>
<p><a href="http://sebug.net/bbs/register.php" target="_blank">注册</a>或登录(<a href="http://sebug.net/bbs/bb-login.php" target="_blank">- 密码丢失了？</a>)
用户名
密码</p>
<p>记住我
搜索：</p>
<p>当前位置：<a href="http://sebug.net/bbs/" target="_blank">SEBUG团队论坛</a> » <a href="http://sebug.net/bbs/forum.php?id=3" target="_blank">技术讨论</a></p>
<h2 id="-python-">快速 Python 语言入门教学，课程，课件，教材，自学，概念</h2>
<ul>
<li><p>发表于 1 月 之前，作者：admin
标签：</p>
</li>
<li><p><a href="http://sebug.net/bbs/tags.php?tag=python" target="_blank">Python</a></p>
</li>
</ul>
<ol>
<li><a href="http://sebug.net/" target="_blank"><img src="" alt=""></a></li>
</ol>
<p><strong><a href="http://sebug.net/" target="_blank">admin</a></strong>
<a href="http://sebug.net/bbs/profile.php?id=1" target="_blank">管理员</a></p>
<p>为非程序员准备的简洁Python语言教材，欢迎提问，欢迎转帖。</p>
<p>Python 的中文意思是巨蟒，大蟒蛇。</p>
<p>/* 快速 Python 语言入门教学，课程，课件，教材，自学，概念
o 计算机编程主要概念</p>
<ul>
<li>基本编程</li>
<li>定义函数</li>
<li>循环 (loop)
o Python 数据概念</li>
<li>列表 (list)</li>
<li>元组 (tuple)</li>
<li>字典 (dict)</li>
<li>集合 (set)</li>
<li>模块 (module)</li>
<li>类 (class)</li>
<li>字符串的对象性质
o Python 程序员编程习惯
o 参考资料</li>
</ul>
<p>计算机编程主要概念¶</p>
<p>计算机语言编程的主要内容就这些：数字，文字，循环，公式，变量</p>
<p>/* 数字: 1, 2, 3, 5.6, 120, 32.4, 3.1415926, -3, -0.123</p>
<p>/* 文字: 你好，我好，你太牛了，很黄很暴力，这类的文字。一般用双引号(&quot;)或者单引号(&#39;)括起来。术语叫字符串 ，就是一堆字符，串起来。</p>
<p>/* 循环: 循环(loop)就是重复的做一件事。计算机是一个很笨的机器，基本上只会做加，减，乘，除，大于，小于，等于和循环这种简单的工作。编程就是把复杂的问题，拆成简单的单元让它重复。</p>
<p>幸亏有下面讲到的公式，所以很多较复杂的问题已经有了解决方法，我们只是重复的套用别人的解决公式就可以了，不用拆得太细。</p>
<p>Python 语言最大的优势，就是这个语言中包含了大量解决常见问题的公式，你想干的事，基本上都有人帮你干了，你只是需要把他们组织，捆绑起来就可以了。比如下载文件的公式，分析网页内容的公式，压缩文件的公式，处理电子邮件的公式等等。</p>
<p>/<em> 公式: 就像数学公式 (a+b)2= a2 + 2ab + b2 这种。算的时候带入具体数值，比如：(3+4)2 = 32 + 2/</em>3/*4 + 42 = 9+24+16 = 49 。前面的 (a+b)2 就是我们的公式名（当然编程时，我们会用一些比较容易明白的词组做为公式名，比如“和的平方”这种，英语或者拼音都可以），他需要两个参数a，b；后面的 a2 + 2ab + b2 是具体怎么算出来的步骤，这就是我们的公式内容。</p>
<p>在计算机里，公式的术语叫“函数”或者“方法”。我们定义一个函数，就是定义一条公式，用的时候，拿来参数a,b什么的，套一下公式就行了。</p>
<p>为了程序的结构清晰，我们往往会定义很多函数。把复杂的问题分成很多小问题，每个小问题放到一个函数里，然后在解决复杂问题的函数里，使用这些小问题函数解决大问题。更重要的是我们可以大量的使用别人写好的函数来解决自己的问题。</p>
<p>函数的作用是让程序结构清晰，而且可以在不同的地方重复套用。</p>
<p>/* 变量: 就是上面的a，b这种可以代表任何值，可以放进不定值的单词，变量，变量，它代表的量可能会改变。我们用变量来存储我们程序中用到的各种数字，文字，公式。所谓参数，就是定义公式时候用到的变量，就叫参数，换个马甲而已。</p>
<p>换成术语，我们有：
数字 (number) =&gt; 数字
字符串 (string) =&gt; 文字
循环 (loop) =&gt; 循环
函数／方法 (function/method) =&gt; 公式
变量 (variable) =&gt; 变量</p>
<p>到这里，基本上编程就没什么可学得了。剩下的就是掌握各种编程语言特定的函数和循环的书写格式，再掌握了别人已经写好的函数的用法，组合起来就得了。
基本编程¶</p>
<p>最基本的python程序：</p>
<p>print (&quot;世界，你好！&quot;)</p>
<p>存到文件 hello.py 里，然后命令行下输入 python hello.py 就可以看到结果了。</p>
<p>这里就用到了函数和字符串，在屏幕上输出一行：世界，你好！</p>
<p>Python 里函数的用法是：函数名(参数1, 参数2)</p>
<p>这里 print 是函数；在屏幕上打印内容，&quot;世界，你好！&quot;是参数，套 print 这个公式用的。</p>
<p>学会怎么用函数了，再学会定义函数的格式，就差不多了。</p>
<p>Python 里注释符号是&quot;/#&quot;。就是说，在 /# 符号后的那一行文字，都当做解释，不做为程序的命令。</p>
<p>print (&quot;打酱油！&quot;) /# print (&quot;关我屁事&quot;)</p>
<p>只打印出 “打酱油”，剩下的，因为是在 /# 后面，所以程序把他们当做注释语言自动忽略了。
定义函数¶</p>
<p>def a_b_pingfang(a, b):
c = a/<em>/</em>2 + 2/<em>a/</em>b + b/<em>/</em>2
return c</p>
<p>我们定义一个(a+b)2的函数，def 是英语 define 的缩写，意思是定义函数，定义公式。</p>
<p>第 1 行就是说我们要定义一个函数名叫 a_b_pingfang 的函数，用它的时候，需要两个参 数 a 和 b。尾巴上有个冒号，冒号的意思是说：“下面的一段话就是公式定义了，要注意了”。</p>
<p>计算机编程里，/<em> 代表乘法，/代表除法，/</em>/<em> 代表乘方， b/</em>/*2 就是 b 的二次方。</p>
<p>注意： Python 是用 缩进空格 来表示段落的，冒号(:)来表示段落开始。</p>
<p>第 2 行先缩进4个空格，说明下面缩进4格的，都是同一段落，用来具体计算上面定义的公式的。把 a2+2/<em>a/</em>b+b2 的计算结果，放到c里。</p>
<p>c类似于a，b，都是表示一个变量，它可以用来存放数字，文字，甚至函数。这里它存放的是用a，b计算后得到的结果。因为不是在函数名里，所以术语叫做“变量”，用在函数名里，就叫参数了。</p>
<p>“变量”就是用一个单词来代表一个可以变化的量的。单词里可以有字母，数字和下加线(_)，数字不能打头。</p>
<p>第 3 行，把存在c里的结果，传回给函数的使用者。</p>
<p>return 命令的意思，就是立即结束函数的执行，把return后面的值传给调用者，可以传回多个值。</p>
<p>现在可以使用这个公式了，我们把套公式叫调用函数 ：</p>
<p>ping2 = a_b_pingfang(2, 3)</p>
<p>ping2 里存放了 a_b_pingfang(2, 3)得到的结果，也就是上面 return c 这句，把 c 的内容，传给了外面的ping2。</p>
<p>把结果打印出来：</p>
<p>print(ping2)</p>
<p>全部程序就是：</p>
<p>def a_b_pingfang(a, b):
c = a/<em>/</em>2 + 2/<em>a/</em>b + b/<em>/</em>2
return c
ping2 = a_b_pingfang(2, 3)
print(ping2)</p>
<p>存到 test2.py ，跑 python test2.py 就可以看到输出 25。
循环 (loop)¶</p>
<p>当然还有循环，怎么让程序重复的做事？我们有 while(当...), for(对于...) 命令来进行循环控制。</p>
<p>a = 0
while a &lt; 100:
a = a + 1
print a</p>
<p>这个循环说，当 a &lt; 100 的时候，把 a 增加 1，再把它打印出来，然后重复。当 a 等于100了，条件不符合了，就结束了。</p>
<p>我们有 &lt;, &gt;, ==, &lt;=, &gt;=, != 来判断大于，小于，等于，小于等于，大于等于，不等于。</p>
<p>还有 and(并且), or(或者), not(不是) 来进行逻辑运算，所谓逻辑运算，就是测试多个不同判断之间的关系的：</p>
<p>(a == 1) and (b != 2) 来测试这两个判断是否同时成立：a 等于 1 并且 b 不等于 2。 (a == 1) or (b != 2) 来测试这两个判断里是否有至少一个成立：a 等于 1 或者 b 不等于 2。 not a == 1 来测试这个判断是否是错的。错的就是对的，对的就是错的，颠倒黑白：不是 a 等于 1，那就是 a 不等于 1 了，好像有点脱裤子放屁。其实在别的更复杂的判断组合里更有用些。</p>
<p>我们还有 break(中断) 来打断循环，和 continue(继续) 来立刻回到循环开始，也可以用 if(如果) 命令来进行判断：</p>
<p>a = 0
while True:
a = a + 1
if a &gt;= 100:
break
print a</p>
<p>这里 True(正确) 表示永远正确，相对的是 False(错误) 表示永远错误。这一段是说一直执行，因为 while 的条件总是正确，就是说“当符合总是正确的条件的时候，不断重复”，当然是永远正确，永远重复了。下面在 if 处判断如果a大于等于100，如果是，那么执行 if 下的段落，这里我们打断了循环。如果条件不符，就跳过 if 下面的小段落，该干嘛干嘛，具体到这里就是打印 a 然后继续执行循环。</p>
<p>for 循环是利用下面介绍的的列表数据结构对列表进行循环。
Python 数据概念¶</p>
<p>下面具体说到python特异功能，它有几个特殊的存储数据的格式。</p>
<p>/<em> 列表: list
/</em> 元组: tuple
/<em> 字典: dict (dictionary)
/</em> 集合: set</p>
<p>列表 (list)¶</p>
<p>列表：把很多变量存进一个列表里，叫列的意思，就因为他像列车一样，一节一节车厢，每厢放一个变量。格式为 b, c, 1, 3, 5, &#39;葡萄&#39;, &#39;葡萄皮儿&#39;，可以看到，方括号里，可以放具体的数字，文字，也可以放变量，用逗号分隔。</p>
<p>这些内容是在固定位置上，可以通过他们的位置，来提取：</p>
<p>alist = [1, 3, 5, &#39;很傻&#39;, &#39;葡萄&#39;, &#39;葡萄皮儿&#39;, a, var1]
print (alist[0]) /# 打印 1
print (alist[3]) /# 打印 &quot;很傻&quot;</p>
<p>在 python里，次序是从0开始数的，开始是0，然后是1，2，3，4，5，所以上面的列表 alist的第一个内容，可以用alist[0]来提取，第二个用alist[1]来提取。就像年龄一样，一生下来是零岁，一年以后才是一岁，不是中国传统那样，生下来就一岁，那是虚岁。蟒蛇语言它只认准确的东西，不玩儿虚的。</p>
<p>print (alist[4]) /# 打印 &#39;葡萄&#39;</p>
<p>这里，我们可以介绍用 for 循环来访问这个列表里的所有内容：</p>
<p>for me in alist:
print (me)</p>
<p>上面这一段，打印所有alist里的内容。</p>
<p>这个循环是，对于列表 alist ，从 0 位置开始，访问它的每一个位置，把这个位置上的值， 放到 me 里，然后针对不同的 me 值，重复执行下面段落的内容。</p>
<p>in 表示 me 在 alist 里，也可以用来判断：</p>
<p>if &quot;葡萄&quot; in alist:
print &quot;葡萄在alist里！&quot;</p>
<p>列表的内容是可以改变的，我们可以把第4个位置设为&quot;很天真&quot;:</p>
<p>alist[3] = alist[3] + &#39; 很天真&#39;
print (alist[3]) /# 打印 &#39;很傻 很天真&#39;</p>
<p>下面说道的元组的内容就不能改变了。
元组 (tuple)¶</p>
<p>元组：元组就是列表，但是他的内容是不能改变的，用圆括号()来表示。 他的内容只能一开始就设定。但是，元组和列表之间是可以用函数互相转变的，转成列表就可以改变内容，转回元组就不能改了。</p>
<p>元组是用圆括号来表示，所以叫元组嘛。</p>
<p>atuple = (2, 3, &quot;老子&quot;)
alist = list(atuple) /# 变成 [2, 3, &quot;老子&quot;]
alist[0] = 0
tuple2 = tuple(alist) /# 变回 (0, 3, &quot;老子&quot;)</p>
<p>在 python 里，字符串也是一种特殊的元组，也就是内容不可变的字符列表。</p>
<p>txt = &#39;abcdefg&#39;
print(txt[1]) /# 打印 b</p>
<p>字典 (dict)¶</p>
<p>字典：字典就像一般的字典，一个字，一个解释，再一个字，再一个解释。用大括号表示：</p>
<p>adict = {1: &quot;我是解释&quot;,
2: &quot;我是解释2&quot;,
&quot;我是3&quot;: 3,
&quot;我是4&quot;: 4
}</p>
<p>前面的字叫钥匙(key)或者索引，后面的解释，叫&quot;值&quot;。索引不能重复，必须是唯一的。</p>
<p>我们可以看到，前面的字，和后面的解释可以是数字，文字，还可以是函数或者元组。但是前面的字，不能是列表，因为列表内容是可变的，可变的东西都不能做索引。</p>
<p>我们用索引来提取，设定或者增加值，而不是用位置：</p>
<p>adict[1] /# &quot;我是解释&quot;
adict[&quot;我是3&quot;] /# 3
adict[1] = 2 /# 设定新的值
adict[&quot;新索引&quot;] = &quot;没头脑和不高兴&quot; /# 增加一个新索引和值</p>
<p>集合 (set)¶</p>
<p>集合: 集合就是数学上用的集合，把一堆东西放到一起，类似列表，不同的地方是内容不重复，而且也没有次序。</p>
<p>aset = set([1, 2, 3, 2, 4, 6]) /# 去掉重复内容，所以是 1,2,3,4,6</p>
<p>可以看出，建立一个集合的方式，是使用set()函数，函数的参数可以是列表，或者元祖，反正是一串儿的都可以。</p>
<p>集合的用处是利用他内容不可重复的特性，来去掉重复的内容。至于其他的合集，交集也是这个特性的延伸。</p>
<p>集合也是可以变成列表的，利用 list() 函数。</p>
<p>alist = list(aset) /# 内容 [1,2,3,4,6]</p>
<p>模块 (module)¶</p>
<p>Python 里包涵了很多别人写好的函数、方法让我们直接利用。譬如写网络程序的函数，数 学计算的函数，分析电邮文件的函数，加密的函数。我们要做的就是套公式！</p>
<p>这些函数分门别类的放到叫“模块”的东西里。一个模块里，包括很多功能相类的函数。而具体实现上，一个模块，就是一个python的程序文件。</p>
<p>如果模块还需要细分更多层，那么每层就是一个文件目录。里面有很多做为模块的python文件。</p>
<p>要使用模块，我们用“进口”这个命令: import</p>
<p>import time
now = time.clock()
print (now)</p>
<p>这里，我们先进口 time 模块，然后使用 time 模块里的函数 clock() ，得到当前时间，打印出来。</p>
<p>用个英文句点表示模块 time里的clock函数: 模块名.函数名</p>
<p>在 python 里，我们会用到很多别人写的模块，能自己少写点儿源码，尽量少写，懒不是？
类 (class)¶</p>
<p>其实编程来说，类并不是必须的，但是因为很多python提供的模块，里面的函数都是包在类里面的，所以我们需要介绍一下类。</p>
<p>面向对象编程，是现在比较流行的编程方式，是个人都得用“面像对象”的思路来编程，来显得自己跟得上形式。其实面对对象并不是必须的，光棍并不可耻。</p>
<p>类就是种类的意思。</p>
<p>基本上面对对象就是把同类的函数，变量打包放到一个包袱里，这个包袱就叫“类”。挺土气是吧？其实面对对象也并不就一定时髦，也可以俗不可耐，就看你包袱打的怎么样了。</p>
<p>这个 “类”一般上是以具体的东西为模板，譬如物种：人类，猫类；物品：家俱类，电器类。他里面打包的函数，基本上是针对这个类进行操作的，譬如人说话，人吃饭，人的鼻子人的嘴，猫逮耗子，家居磨损。</p>
<p>使用类的时候，我们先具体化他，把种类变成个体。人类变成某人，猫类变成某猫，家俱变成某件家俱。这个具体化的类，就是所谓的“对象(object)”。然后我们就可以使用这个具体人，猫，家居的函数，针对具体的人，物进行操作了，所谓操作对象。
定义类¶</p>
<p>class RenLei:
def <strong>init</strong>(self, mingzi): /# self 是一个固定参数名，代表这个对象自己。
self.mingzi = mingzi /# 把名字存到对象自己的 mingzi 变量上。
def shui2(self): /# 谁函数
return self.mingzi</p>
<p>上面的例子，一开始就要求给这个对象一个名字。</p>
<p>在类的定义里，每一个函数，他的第一个参数，都是规定死的，必须是self。self代表这个对象自己。在对象内部，这个对像本身的变量，函数，都是通过这个self来存取的。</p>
<p>在调用类里的函数时，不用提供 self 这个参数，程序自动提供 self，让我们使用它其他的函数，变量。我们只要提供其他参数即可。</p>
<p><strong>init</strong>() 这个函数是一个特殊的函数，他代表从类具体化到对象的时候，需要套用的公式。</p>
<p>通过类建立对象的时候，程序会自动调用 <strong>init</strong>()函数。所以它叫做初始化函数。建立对象的时候，有什么一开始的要求，都可以通过它来指定，比如要求“脚不大好头发没有麻子”。</p>
<p>当然如果没有初始要求，也可以不定义这个函数，那么程序就不会自动调用它了。
具体化类，建立对象¶</p>
<p>/# 建立对象，提供的函数对应<strong>init</strong>() 函数，self 这个参数程序会自动提供，不用我们提供。
xiaozhang1 = RenLei(&quot;小张&quot;)
mingzi = xiaozhang1.shui2() /# 使用“对象名.函数名()”的格式来调用类里的函数。
print mingzi &lt;-- &quot;小张&quot;</p>
<p>字符串的对象性质¶</p>
<p>Python 里的字符串，列表，元组，字典，它们本身都是面对对象的类，所以带有很多函数可以对自己进行操作，譬如：</p>
<p>a = &quot;脚不大好 头发没有 麻子&quot;.split()</p>
<p>split 是字符串这个类的函数，他可以把字符串在给定位置分割，当我们不给他参数的时候，会在所有空白位置分割，然后返回一个列表，里面是被割裂的字符串。</p>
<p>结果，a 的内容是 [&quot;脚不大好&quot;, &quot;头发没有&quot;, &quot;麻子&quot;]，这是一个有3个元素的列表。</p>
<p>对于字符串，列表，字典之类的操作，请熟读说明手册对他们的说明，python编程，主要就靠字符串，列表和字典了。
Python 程序员编程习惯¶</p>
<p>重中之重: 大量的使用 list 这个列表方式来存储、操作数据。一字长蛇阵是蟒蛇的绝招，多用没错。</p>
<p>写一个 Python 程序，我们一般的步骤是：</p>
<ol>
<li>进口所有会用到到模块 import</li>
<li>定义我们自己的类和函数。对于每个函数里要用到的函数，被调用的函数一般放在调用函数的前面定义。这样我们读程序的时候，如果从上到下，就知道调用的函数，在前面是怎么定义的，有什么功能，需要什么参数，返回什么值。</li>
<li>在文件的最下面，调用上面定义的函数和类，开始工作。</li>
<li>命令行的选项是通过 sys.argv 这个列表得到的。</li>
<li>尽量使用 python提供的内建函数和模块里的函数，所以我们对Python的模块说明手册要很熟悉。</li>
</ol>
<p>Python 运行，是从文件的上面往下走的，看到一条命令执行一条命令，一直到最后一行。当我们定义函数和类的时候，他们只是定义，而没有执行，所以Python 看到他们，先存起来，直到看到定义外的具体命令，才真正的执行。如果这个命令调用上面的函数，那么就把存起来的函数执行一下。</p>
<p>完整例子： 把一个两列的文件input.txt，分割成两个文件col1.txt, col2.txt，一个文件一列。 input.txt 内容:</p>
<p>a1 啊阿
ai1 挨埃哀
ao2 熬鳌翱獒</p>
<p>程序内容：</p>
<p>def split_file(filename): /# 把文件分成两列
col1 = [] /# 存储第一列
col2 = []
fd = open(filename) /# open 函数用来打开文件，返回一个文件对象
text = fd.read() /# fd.read 读入文件fd 的内容。
lines = text.splitlines() /# 把读入的内容分行
for line in lines: /# 循环每一行
part = line.split(None, 1) /# 分割一行。
col1.append(part[0]) /# 把分割的第一部分放到col1后面。
col2.append(part[1])</p>
<p>return col1, col2 /# 返回 col1, col2</p>
<p>def write_list(filename, alist): /# 把文字列表内容写入文件
fd = open(filename, &#39;w&#39;) /# 打开输出文件col1.txt，&#39;w&#39;指定使用写入模式。
for line in alist:
fd.write(line + &#39;\n&#39;)</p>
<p>def main(): /# 主函数，程序进入点，习惯性叫他 main()
filename = &#39;input.txt&#39; /# 把输入文件名 input.txt 放进一个变量
col1, col2 = split_file(filename) /# 调用分割函数，结果存入 col1, col2
write_list(&#39;col1.txt&#39;, col1) /# 调用写入函数
write_list(&#39;col2.txt&#39;, col2)</p>
<p>main() /# 唯一的函数外命令，程序开始执行，调用上面的 main() 函数数。</p>
<p>这里，输入的文件名是写死的 input.txt ，我们可以使用模块 optparse 来通过命令行读取用户提供的文件，会更灵活些，那些就是你研究过 optparse 以后的事了。
参考资料¶</p>
<p>更多的功能，函数，请参考python的官方教学和手册。</p>
<p>先熟悉:</p>
<p>/<em> 内建函数
/</em> 内建数据类型 (字符串，数字，列表，字典，文件对象)
/<em> sys 模块
/</em> re 模块
/<em> os 模块
/</em> optparse 模块</p>
<p>熟悉这些，基本上编程没问题了。</p>
<p>深入 Python是一本经典的参考书，虽然没有涵盖所有python模块的内容，但是对初学者基本够用。而且它是一个自由文件，说俗了就是合法免费的，又有中文翻译版，难得。</p>
<p>也可以参考 Python 绝对简明手册这个中文说明。</p>
<p>如果需要网络编程，还要熟悉网络相关的模块，urllib2，socket，xml.etree.elementtree。</p>
<p>如果想要图形界面，建议使用pygtk或者pyqt图形界面函数库，这时候，也需要熟悉面对对象编程的概念。</p>
<p>对于英文不好的人，建议买一本有Python函数模块介绍的中文书，作为参考书，在编程的时候，边编边翻书。</p>
<p>Python 的中文意思是巨蟒，大蟒蛇。但是这个语言的具体出处是一个叫Monty Python的英 国电视剧。</p>
<p>1 月 前回复 <a href="http://sebug.net/bbs/topic.php?id=35#post-61" target="_blank">/#</a>
<a href="http://sebug.net/bbs/rss.php?topic=35" target="_blank">该帖子的 RSS 链接</a></p>
<h2 id="-">回复</h2>
<p>你必须<a href="http://sebug.net/bbs/bb-login.php" target="_blank">登录</a>才能回复。</p>
<p><a href="http://sebug.net/about/About.html#Privacy" title="Privacy Policy" target="_blank">Privacy Policy</a> | <a href="http://sebug.net/about/About.html" title="AboutUS" target="_blank">AboutUS</a> | <a href="http://sebug.net/bbs/" target="_blank">bbs sebug</a> | <a href="http://sebug.net/paper/" target="_blank">paper</a>
powered by <a href="http://bbpress.org/" target="_blank">bbPress</a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/安全/">安全</a></li></span><span class="breadcrumb"><li><a href="/categories/安全/">安全</a></li><li><a href="/categories/安全/学习手册类/">学习手册类</a></li></span></span> | <span class="tags">Tagged <a href="/tags/学习手册类/" class="label label-primary">学习手册类</a><a href="/tags/安全/" class="label label-success">安全</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:39"datetime="2014-03-07 09:54:39"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-安全-学习手册类--快速Python语言入门教学，课程，课件，教材，自学，概念«SEBUG团队论坛/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-安全-学习手册类--快速Python语言入门教学，课程，课件，教材，自学，概念«SEBUG团队论坛" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-安全-Java--攻击JavaWeb应用7-Server篇1/">攻击JavaWeb应用[7]</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:38.000Z"> <a href="/2014/02/02/2014-02-02-安全-Java--攻击JavaWeb应用7-Server篇1/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-javaweb-7-server-1-">攻击JavaWeb应用[7]-Server篇[1]</h1>
<h3 id="-">分享到</h3>
<ul>
<li><a href="">一键分享</a></li>
<li><a href="">QQ空间</a></li>
<li><a href="">新浪微博</a></li>
<li><a href="">百度云收藏</a></li>
<li><a href="">人人网</a></li>
<li><a href="">腾讯微博</a></li>
<li><a href="">百度相册</a></li>
<li><a href="">开心网</a></li>
<li><a href="">腾讯朋友</a></li>
<li><a href="">百度贴吧</a></li>
<li><a href="">豆瓣网</a></li>
<li><a href="">搜狐微博</a></li>
<li><a href="">百度新首页</a></li>
<li><a href="">QQ好友</a></li>
<li><a href="">和讯微博</a></li>
<li><a href="">更多...</a></li>
</ul>
<p><a href="">百度分享</a></p>
<h1 id="-wooyun-http-drops-wooyun-org-wooyun-"><a href="http://drops.wooyun.org/" title="WooYun知识库" target="_blank">WooYun知识库</a></h1>
<p><a href="http://drops.wooyun.org/login" title="登录" target="_blank">登录</a></p>
<p>像一朵乌云一样成长</p>
<ul>
<li><a href="http://drops.wooyun.org/" title="WooYun知识库" target="_blank">首页</a></li>
<li><a href="http://www.wooyun.org/" target="_blank">WooYun</a></li>
<li><a href="http://zone.wooyun.org/" target="_blank">Zone</a></li>
<li><a href="http://drops.wooyun.org/newsend" target="_blank">投稿</a>
<a href="http://drops.wooyun.org/" title="首页" target="_blank">首页</a> » <a href="http://drops.wooyun.org/category/tips" title="查看 技术分享 中的全部文章" target="_blank">技术分享</a> » 攻击JavaWeb应用[7]-Server篇[1]</li>
</ul>
<h2 id="-javaweb-7-server-1-http-drops-wooyun-org-tips-604-permanent-link-to-javaweb-7-server-1-"><a href="http://drops.wooyun.org/tips/604" title="Permanent Link to 攻击JavaWeb应用[7]-Server篇[1]" target="_blank">攻击JavaWeb应用[7]-Server篇[1]</a></h2>
<p>2人收藏 <a href="">收藏</a></p>
<p>2013/09/22 15:39  | <a href="http://drops.wooyun.org/author/园长" title="由 园长 发布" target="_blank">园长</a>  | <a href="http://drops.wooyun.org/category/tips" title="查看 技术分享 中的全部文章" target="_blank">技术分享</a>  | <a href="">占个座先</a></p>
<h2 id="java-">java应用服务器</h2>
<p>Java应用服务器主要为应用程序提供运行环境，为组件提供服务。Java 的应用服务器很多，从功能上分为两类：JSP 服务器和 Java EE 服务器。</p>
<h3 id="-server-">常见的Server概述</h3>
<p>常见的Java服务器:Tomcat、Weblogic、JBoss、GlassFish、Jetty、Resin、IBM Websphere、Bejy Tiger、Geronimo、Jonas、Jrun、Orion、TongWeb、BES Application Server、ColdFusion、Apusic Application Server、Sun Application Server 、Oracle9i/AS、Sun Java System Application Server。</p>
<p>Myeclipse比较方便的配置各式各样的Server，一般只要简单的选择下Server的目录就行了。 ￼ <img src="" alt="enter image description here"></p>
<p>部署完成后启动进入各个Server的后台：</p>
<p><img src="" alt="enter image description here"> ￼</p>
<h3 id="-webshell-war-">构建WebShell war文件</h3>
<p>1、打开Myeclipse新建Web项目 2、把jsp放到WebRoot目录下 3、导出项目为war文件</p>
<p><img src="" alt="enter image description here"> ￼</p>
<h2 id="tomcat">Tomcat</h2>
<p>Tomcat 服务器是一个免费的开放源代码的Web 应用服务器，属于轻量级应用服务器，在中小型系统和并发访问用户不是很多的场合下被普遍使用，是开发和调试JSP 程序的首选。</p>
<h3 id="tomcat-">Tomcat版本</h3>
<p>Tomcat主流版本:5-6-7，最新版Tomcat8刚发布不久。Tomcat5较之6-7在文件结构上有细微的差异，6-7-8没有大的差异。最新版的Tomcat8主要新增了：Servlet 3.1, JSP 2.3, EL 3.0 and Web Socket 1.0支持。</p>
<p>版本详情说明：<a href="http://tomcat.apache.org/whichversion.html" target="_blank"><a href="http://tomcat.apache.org/whichversion.html">http://tomcat.apache.org/whichversion.html</a></a></p>
<p>结构目录：</p>
<p>Tomcat5：
Bin、common、conf、LICENSE、logs、NOTICE、RELEASE-NOTES、RUNNING.txt、Server、shared、Temp、webapps、work</p>
<p>Tomcat6-8：</p>
<p>Bin、conf、lib、LICENSE、logs、NOTICE、RELEASE-NOTES、RUNNING.txt、temp、webapps、work</p>
<p>关注conf和webapps目录即可。conf目录与非常重要的tomcat配置文件比如登录帐号所在的tomcat-users.xml；域名绑定目录、端口、数据源(部分情况)、SSL所在的server.xml；数据源配置所在的context.xml文件，以及容器初始化调用的web.xml。</p>
<p>源码下载：</p>
<p>Tomcat6：<a href="http://svn.apache.org/repos/asf/tomcat/tc6.0.x/tags/TOMCAT_6_0_18/" target="_blank"><a href="http://svn.apache.org/repos/asf/tomcat/tc6.0.x/tags/TOMCAT_6_0_18/">http://svn.apache.org/repos/asf/tomcat/tc6.0.x/tags/TOMCAT_6_0_18/</a></a></p>
<p>Tomcat7：<a href="http://svn.apache.org/repos/asf/tomcat/tc7.0.x/trunk/" target="_blank"><a href="http://svn.apache.org/repos/asf/tomcat/tc7.0.x/trunk/">http://svn.apache.org/repos/asf/tomcat/tc7.0.x/trunk/</a></a></p>
<h3 id="tomcat-">Tomcat默认配置</h3>
<h3 id="1-tomcat-users-xml">1、tomcat-users.xml</h3>
<p>Tomcat5默认配置了两个角色：tomcat、role1。其中帐号为both、tomcat、role1的默认密码都是tomcat。不过都不具备直接部署应用的权限，默认需要有manager权限才能够直接部署war包，Tomcat5默认需要安装Administration Web Application。Tomcat6默认没有配置任何用户以及角色，没办法用默认帐号登录。</p>
<p>配置详解：<a href="http://tomcat.apache.org/tomcat-7.0-doc/manager-howto.html/#Introduction" target="_blank">http://tomcat.apache.org/tomcat-7.0-doc/manager-howto.html/#Introduction</a></p>
<h3 id="2-context-xml">2、context.xml</h3>
<p>Tomcat的上下文，一般情况下如果用Tomcat的自身的数据源多在这里配置。找到数据源即可用对应的帐号密码去连接数据库。</p>
<Context>     <WatchedResource>WEB-INF/web.xml</WatchedResource>     <Resource name="jdbc/u3" auth="Container" type="javax.sql.DataSource"               maxActive="100" maxIdle="30" maxWait="10000"               username="xxxxx" password="xxxx" driverClassName="com.mysql.jdbc.Driver"               url="jdbc:mysql://192.168.0.xxx:3306/xxx?autoReconnect=true"/> </Context>

<h3 id="3-server-xml">3、server.xml</h3>
<p>Server这个配置文件价值非常高，通常的访问端口、域名绑定和数据源可以在这里找到，如果想知道找到域名对应的目录可以读取这个配置文件。如果有用Https，其配置也在这里面能够找到。</p>
<h3 id="4-web-xml">4、web.xml</h3>
<p>web.xml之前讲MVC的时候有提到过，项目初始化的时候会去调用这个配置文件这个文件一般很少有人动但是不要忽略其重要性，修改web.xml可以做某些YD+BT的事情。</p>
<h3 id="tomcat-webshell">Tomcat获取WebShell</h3>
<h3 id="tomcat-war-webshell">Tomcat后台部署war获取WebShell</h3>
<p>登录tomcat后台：<a href="http://xxx.com/manager/html，一般用" target="_blank">http://xxx.com/manager/html，一般用</a></p>
<p>WAR file to deploy
就行了，</p>
<p>Deploy directory or WAR file located on server
这种很少用。</p>
<p>1&gt;Deploy directory or WAR file located on server</p>
<p>Web应用的URL入口、XML配置文件对应路径、WAR文件或者该Web应用相对于/webapps目录的文件路径，然后单击 按钮，即可发布该Web应用，发布后在Application列表中即可看到该Web应用的信息。这种方式只能发布位于/webapps目录下的Web应用。</p>
<p>2&gt;WAR file to deploy</p>
<p>选择需要发布的WAR文件，然后单击Deploy，即可发布该Web应用，发布后在Application列表中即可看到该Web应用的信息。这种方式可以发布位于任意目录下的Web应用。</p>
<p>其中，第二种方式实际上是把需要发布的WAR文件自动复制到/webapps目录下，所以上述两种方式发布的Web应用都可以通过在浏览器地址栏中输入<a href="http://localhost:8080/Web进行访问。" target="_blank">http://localhost:8080/Web进行访问。</a></p>
<p>￼ <img src="" alt="enter image description here">
Tips: 当访问xxxx.com找不到默认管理地址怎么办? 1:<a href="http://xxxx.com/manager/html" target="_blank">http://xxxx.com/manager/html</a> 查看是否存在 2:ping xxxx.com 获取其IP地址，在访问：<a href="http://111.111.111.111/manager/html" target="_blank">http://111.111.111.111/manager/html</a> 3:遍历server.xml配置读取配置</p>
<h3 id="tomcat-">Tomcat口令爆破</h3>
<p>Tomcat登录比较容易爆破，但是之前说过默认不对其做任何配置的时候爆破是无效的。</p>
<p>Tomcat的认证比较弱，Base64(用户名:密码)编码，请求：” /manager/html/”如果响应码不是401（未经授权：访问由于凭据无效被拒绝。）即登录成功。
conn.setRequestProperty(&quot;Authorization&quot;, &quot;Basic &quot; + new BASE64Encoder().encode((user + &quot;:&quot; + pass).getBytes()));</p>
<h3 id="tomcat-">Tomcat漏洞</h3>
<p>Tomcat5-6-7安全性并不完美，总是被挖出各种稀奇古怪的安全漏洞。在CVE和Tomcat官网也有相应的漏洞信息详情。</p>
<h3 id="-tomcat-">怎样找到Tomcat的历史版本:</h3>
<p><a href="http://archive.apache.org/dist/tomcat/" target="_blank"><a href="http://archive.apache.org/dist/tomcat/">http://archive.apache.org/dist/tomcat/</a></a></p>
<h3 id="tomcat-">Tomcat历史版本漏洞?</h3>
<p>Tomcat官网安全漏洞公布：</p>
<p>Apache Tomcat - Apache Tomcat 5 漏洞： <a href="http://tomcat.apache.org/security-5.html" target="_blank"><a href="http://tomcat.apache.org/security-5.html">http://tomcat.apache.org/security-5.html</a></a></p>
<p>Apache Tomcat - Apache Tomcat 6 漏洞： <a href="http://tomcat.apache.org/security-6.html" target="_blank"><a href="http://tomcat.apache.org/security-6.html">http://tomcat.apache.org/security-6.html</a></a></p>
<p>Apache Tomcat - Apache Tomcat7 漏洞： <a href="http://tomcat.apache.org/security-7.html" target="_blank"><a href="http://tomcat.apache.org/security-7.html">http://tomcat.apache.org/security-7.html</a></a></p>
<p>CVE 通用漏洞与披露: <a href="http://cve.scap.org.cn/cve_list.php?keyword=tomcat&amp;action=search&amp;p=1" target="_blank"><a href="http://cve.scap.org.cn/cve_list.php?keyword=tomcat&amp;action=search&amp;p=1">http://cve.scap.org.cn/cve_list.php?keyword=tomcat&amp;action=search&amp;p=1</a></a></p>
<p>Cvedetails ： <a href="http://www.cvedetails.com/product/887/Apache-Tomcat.html?vendor_id=45" target="_blank"><a href="http://www.cvedetails.com/product/887/Apache-Tomcat.html?vendor_id=45">http://www.cvedetails.com/product/887/Apache-Tomcat.html?vendor_id=45</a></a> <a href="http://www.cvedetails.com/vulnerability-list/vendor_id-45/product_id-887/Apache-Tomcat.html" target="_blank"><a href="http://www.cvedetails.com/vulnerability-list/vendor_id-45/product_id-887/Apache-Tomcat.html">http://www.cvedetails.com/vulnerability-list/vendor_id-45/product_id-887/Apache-Tomcat.html</a></a></p>
<p>Sebug: <a href="http://sebug.net/appdir/Apache+Tomcat" target="_blank"><a href="http://sebug.net/appdir/Apache+Tomcat">http://sebug.net/appdir/Apache+Tomcat</a></a></p>
<h3 id="-tomcat-">怎样发现Tomcat有那些漏洞?</h3>
<p>1、通过默认的报错页面（404、500等）可以获取到Tomcat的具体版本，对照Tomcat漏洞。</p>
<p>2、利用WVS之类的扫描工具可以自动探测出对应的版本及漏洞。</p>
<h3 id="-tomcat-">怎样快速确定是不是Tomcat?</h3>
<p>请求响应为:Server:Apache-Coyote/1.1 就是tomcat了。</p>
<h3 id="tomcat-">Tomcat稀奇古怪的漏洞：</h3>
<p>Tomcat的安全问题被爆过非常多，漏洞统计图：</p>
<p><img src="" alt="enter image description here"></p>
<p>有一些有意思的漏洞，比如：Insecure default password CVE-2009-3548(影响版本: 6.0.0-6.0.20)</p>
<p>The Windows installer defaults to a blank password for the administrative user. If this is not changed during the install process, then by default a user is created with the name admin, roles admin and manager and a blank password.在windows安装版admin默认空密码漏洞，其实是用户安装可能偷懒，没有设置密码…</p>
<p><img src="" alt="enter image description here"></p>
<p>这样的问题在tar.gz和zip包里面根本就不会存在。有些漏洞看似来势汹汹其实鸡肋得不行如：Unexpected file deletion in work directory CVE-2009-2902 都已经有deploy权限了，闹个啥。</p>
<p>Tomcat非常严重的漏洞（打开Tomcat security-5、6、7.html找）：
Important: Session fixation CVE-2013-2067 (6.0.21-6.0.36) Important: Denial of service CVE-2012-3544 (6.0.0-6.0.36) Important: Denial of service CVE-2012-2733 (6.0.0-6.0.35) Important: Bypass of security constraints CVE-2012-3546 (6.0.0-6.0.35) Important: Bypass of CSRF prevention filter CVE-2012-4431 (6.0.30-6.0.35) Important: Denial of service CVE-2012-4534 (6.0.0-6.0.35) Important: Information disclosure CVE-2011-3375 (6.0.30-6.0.33) Important: Authentication bypass and information disclosure CVE-2011-3190 (6.0.0-6.0.33) (………………………………………………….) Important: Directory traversal CVE-2008-2938 (6.0.18) Important: Directory traversal CVE-2007-0450 (6.0.0-6.0.9)</p>
<p>如果英文亚历山大的同学，对应的漏洞信息一般都能够在中文的sebug找到。</p>
<p>Sebug：</p>
<p><img src="" alt="enter image description here"></p>
<p>CVE 通用漏洞与披露：</p>
<p><img src="" alt="enter image description here"></p>
<h2 id="resin">Resin</h2>
<p>Resin是CAUCHO公司的产品，是一个非常流行的application server，对servlet和JSP提供了良好的支持，性能也比较优良，resin自身采用JAVA语言开发。</p>
<p>Resin比较有趣的是默认支持PHP! Resin默认通过Quercus 动态的去解析PHP文件请求。（Resin3也支持，详情：<a href="http://zone.wooyun.org/content/2467" target="_blank"><a href="http://zone.wooyun.org/content/2467">http://zone.wooyun.org/content/2467</a></a>）</p>
<h3 id="resin-">Resin版本</h3>
<p>Resin主流的版本是Resin3和Resin4，在文件结构上并没有多大的变化。Resin的速度和效率非常高，但是不知怎么Resin似乎对Quercus 更新特别多。</p>
<p>4.0.x版本更新详情：<a href="http://www.caucho.com/resin-4.0/changes/changes.xtp" target="_blank"><a href="http://www.caucho.com/resin-4.0/changes/changes.xtp">http://www.caucho.com/resin-4.0/changes/changes.xtp</a></a></p>
<p>3.1.x版本更新详情：<a href="http://www.caucho.com/resin-3.1/changes/changes.xtp" target="_blank"><a href="http://www.caucho.com/resin-3.1/changes/changes.xtp">http://www.caucho.com/resin-3.1/changes/changes.xtp</a></a></p>
<h3 id="resin-">Resin默认配置</h3>
<h3 id="1-resin-conf-resin-xml">1、resin.conf和resin.xml</h3>
<p>Tomcat和Rsin的核心配置文件都在conf目录下，Resin3.1.x 默认是resin.conf而4.0.x默认是resin.xml。resin.conf/resin.xml是Resin最主要配置文件，类似Tomcat的server.xml。</p>
<h3 id="1-">1&gt;数据源:</h3>
<p>第一节的时候有谈到resin数据源就是位于这个文件，搜索database（位于server标签内）即可定位到具体的配置信息。</p>
<h3 id="2-">2&gt;域名绑定</h3>
<p>搜索host即可定位到具体的域名配置，其中的root-directory是域名绑定的对应路径。很容易就能够找到域名绑定的目录了。</p>
<host id="javaweb.org" root-directory=".">       <host-alias-regexp>^([^/]/*).javaweb.org</host-alias-regexp>       <web-app id="/" root-directory="D:/web/xxxx/xxxx"/> </host>

<h3 id="resin-">Resin默认安全策略</h3>
<h3 id="1-">1&gt;管理后台访问权限</h3>
<p>Resin比较BT的是默认仅允许本机访问管理后台，这是因为在resin.conf当中默认配置禁止了外部IP请求后台。</p>
<resin:set var="resin_admin_external" value="false"/>

<p>修改为true外部才能够访问。</p>
<h3 id="2-resin-">2&gt;Resin后台管理密码</h3>
<p>Resin的管理员密码需要手动配置，在resin.conf/resin.xml当中搜索management。即可找到不过需要注意的是Resin的密码默认是加密的，密文是在登录页自行生成。比如admin加密后的密文大概会是：yCGkvrQHY7K8qtlHsgJ6zg== 看起来仅是base64编码不过不只是admin默认的Base64编码是：YWRtaW4= Resin,翻了半天Resin终于在文档里面找到了：<a href="http://www.caucho.com/resin-3.1/doc/resin-security.xtp" target="_blank"><a href="http://www.caucho.com/resin-3.1/doc/resin-security.xtp">http://www.caucho.com/resin-3.1/doc/resin-security.xtp</a></a></p>
<p>￼<img src="" alt="enter image description here"></p>
<p>虽说是MD5+Base64加密但是怎么看都有点不对，下载Resin源码找到加密算法：
package com.caucho.server.security.PasswordDigest</p>
<p><img src="" alt="enter image description here"></p>
<p>这加密已经没法反解了，所以就算找到Resin的密码配置文件应该也没法破解登录密码。事实上Resin3的管理后台并没有其他Server（相对JBOSS和Weblogic）那么丰富。而Resin4的管理后台看上去更加有趣。</p>
<p>Resin4的加密方式和Resin3还不一样改成了SSHA：
admin_user : admin admin_password : {SSHA}XwNZqf8vxNt5BJKIGyKT6WMBGxV5OeIi</p>
<p>详情：<a href="http://www.caucho.com/resin-4.0/admin/security.xtp" target="_blank"><a href="http://www.caucho.com/resin-4.0/admin/security.xtp">http://www.caucho.com/resin-4.0/admin/security.xtp</a></a></p>
<p>Resin3：</p>
<p><img src="" alt="enter image description here"></p>
<p>Resin4：</p>
<p><img src="" alt="enter image description here"></p>
<h3 id="resin-webshell">Resin获取WebShell</h3>
<p>As of Resin 4.0.0, it is now possible to deploy web applications remotely to a shared repository that is distributed across the cluster. This feature allows you to deploy once to any triad server and have the application be updated automatically across the entire cluster. When a new dynamic server joins the cluster, the triad will populate it with these applications as well.</p>
<p>Web Deploy war文件大概是从4.0.0开始支持的，不过想要在Web deploy一个应用也不是一件简单的事情，首先得先进入后台。然后还得以Https方式访问。不过命令行下部署就没那没法麻烦。Resin3得手动配置web-app-deploy。 最简单的但又不爽办法就是想办法把war文件上传到resin-pro-3.1.13webapps目录下，会自动部署（就算Resin已启动也会自动部署，不影响已部署的应用）。</p>
<p>Resin3部署详情：<a href="http://www.caucho.com/resin-3.1/doc/webapp-deploy.xtp" target="_blank"><a href="http://www.caucho.com/resin-3.1/doc/webapp-deploy.xtp">http://www.caucho.com/resin-3.1/doc/webapp-deploy.xtp</a></a></p>
<p>Resin4部署War文件详情：<a href="http://www.caucho.com/resin-4.0/admin/deploy.xtp" target="_blank"><a href="http://www.caucho.com/resin-4.0/admin/deploy.xtp">http://www.caucho.com/resin-4.0/admin/deploy.xtp</a></a></p>
<p>Resin4进入后台后选择Deploy,不过还得用SSL方式请求。Resin要走一个”非加密通道”。</p>
<p>To deploy an application remotely: log into the resin-admin console on any triad server. Make sure you are connecting over SSL, as this feature is not available over a non-encrypted channel. Browse to the &quot;webapp&quot; tab of the resin-admin server and at the bottom of the page, enter the virtual host, URL, and local .war file specifying the web application, then press &quot;Deploy&quot;. The application should now be deployed on the server. In a few moments, all the servers in the cluster will have the webapp.</p>
<p>￼<img src="" alt="enter image description here"></p>
<p>Resin4敢不敢再没节操点？默认HTTPS是没有开的。需要手动去打开:
conf</p>
<p>esin.properties</p>
<p>/# https : 8443</p>
<p>默认8443端口是关闭的，取消这一行的注释才能够使用HTTPS方式访问后台才能够Web Deploy war。</p>
<p><img src="" alt="enter image description here"></p>
<p>部署成功访问: <a href="http://localhost:8080/GetShell/Customize.jsp" target="_blank"><a href="http://localhost:8080/GetShell/Customize.jsp">http://localhost:8080/GetShell/Customize.jsp</a></a> 即可获取WebShell。</p>
<h3 id="resin-">Resin漏洞</h3>
<p>Resin相对Tomcat的安全问题来说少了很多，Cvedetails上的Resin的漏洞统计图：</p>
<p><img src="" alt="enter image description here"></p>
<p>Cvedetails统计详情： <a href="http://www.cvedetails.com/product/993/Caucho-Technology-Resin.html?vendor_id=576" target="_blank"><a href="http://www.cvedetails.com/product/993/Caucho-Technology-Resin.html?vendor_id=576">http://www.cvedetails.com/product/993/Caucho-Technology-Resin.html?vendor_id=576</a></a></p>
<p>Cvedetails漏洞详情： <a href="http://www.cvedetails.com/vulnerability-list/vendor_id-576/product_id-993/Caucho-Technology-Resin.html" target="_blank"><a href="http://www.cvedetails.com/vulnerability-list/vendor_id-576/product_id-993/Caucho-Technology-Resin.html">http://www.cvedetails.com/vulnerability-list/vendor_id-576/product_id-993/Caucho-Technology-Resin.html</a></a></p>
<p>CVE 通用漏洞与披露： <a href="http://cve.scap.org.cn/cve_list.php?keyword=resin&amp;action=search&amp;p=1" target="_blank"><a href="http://cve.scap.org.cn/cve_list.php?keyword=resin&amp;action=search&amp;p=1">http://cve.scap.org.cn/cve_list.php?keyword=resin&amp;action=search&amp;p=1</a></a></p>
<p>Resin3.1.3:</p>
<p><img src="" alt="enter image description here"></p>
<p>Fixed BugList: <a href="http://bugs.caucho.com/changelog_page.php" target="_blank"><a href="http://bugs.caucho.com/changelog_page.php">http://bugs.caucho.com/changelog_page.php</a></a></p>
<h2 id="weblogic">Weblogic</h2>
<p>WebLogic是美国bea公司出品的一个application server确切的说是一个基于Javaee架构的中间件，BEA WebLogic是用于开发、集成、部署和管理大型分布式Web应用、网络应用和数据库应用的Java应用服务器。将Java的动态功能和Java Enterprise标准的安全性引入大型网络应用的开发、集成、部署和管理之中。</p>
<h3 id="weblogic-">Weblogic版本</h3>
<p>Oracle简直就是企业应用软件终结者，收购了Sun那个土鳖、Mysql、BAE Weblogic等。BAE在2008初被收购后把BAE终结在Weblogic 10。明显的差异应该是从10.x开始到最新的12c。这里主要以Weblogic9.2和最新的Weblogic 12c为例。</p>
<h3 id="weblogic-">Weblogic默认配置</h3>
<p>Weblogic默认端口是7001，Weblogic10g-12c默认的管理后台是：<a href="http://localhost:7001/console" target="_blank">http://localhost:7001/console</a></p>
<p>Weblogic10 以下默认后台地址是：<a href="http://192.168.80.1:7001/console/login/LoginForm.jsp" target="_blank">http://192.168.80.1:7001/console/login/LoginForm.jsp</a></p>
<p>管理帐号是在建立Weblogic域的时候设置的。</p>
<p><img src="" alt="enter image description here"></p>
<p>Weblogic控制台：</p>
<p><a href="http://wydrops-wordpress.stor.sinaapp.com/uploads/2013/09/java7-18.png" target="_blank">enter link description here</a></p>
<p>Weblogic10以下默认管理帐号:weblogic密码：weblogic。关于Weblogic10++的故事还得从建域开始，默认安装完Weblogic后需要建立一个域。</p>
<h3 id="weblogic-">WebLogic中的&quot;域&quot;?</h3>
<p>域环境下可以多个 WebLogic Server或者WebLogic Server 群集。域是由单个管理服务器管理的 WebLogic Server实例的集合。 Weblogic10++域默认是安装完成后由用户创建。帐号密码也在创建域的时候设置，所以这里并不存在默认密码。当一个域创建完成后配置文件和Web应用在：Weblogic12user_projectsdomains”域名”。</p>
<h3 id="weblogic-">Weblogic 默认安全策略</h3>
<h3 id="1-weblogic-">1、Weblogic默认密码文件:</h3>
<p>Weblogic 9采用的3DES（三重数据加密算法）加密方式，Weblogic 9默认的管理密码配置文件位于：
weblogic_9weblogic92samplesdomainswl_serverserversexamplesServersecurityoot.properties</p>
<h3 id="boot-properties-">boot.properties：</h3>
<p>/# Generated by Configuration Wizard on Sun Sep 08 15:43:13 GMT 2013 username={3DES}fy709SQ4pCHAFk+lIxiWfw== password={3DES}fy709SQ4pCHAFk+lIxiWfw==</p>
<p>Weblogic 12c采用了AES对称加密方式，但是AES的key并不在这文件里面。默认的管理密码文件存放于：</p>
<p>Weblogic12user_projectsdomainsase_domainserversAdminServersecurityoot.properties</p>
<p>(base_domain是默认的”域名”)。</p>
<h3 id="boot-properties-">boot.properties：</h3>
<p>boot.properties： /# Generated by Configuration Wizard on Tue Jul 23 00:07:09 CST 2013 username={AES}PsGXATVgbLsBrCA8hbaKjjA91yNDCK78Z84fGA/pTJE= password={AES}Z44CPAl39VlytFk1I5HUCEFyFZ1LlmwqAePuJCwrwjI=</p>
<p>怎样解密Weblogic密码?</p>
<p>Weblogic 12c：
Weblogic12user_projectsdomainsase_domainsecuritySerializedSystemIni.dat</p>
<p>Weblogic 9：</p>
<p>weblogic_9weblogic92samplesdomainswl_serversecuritySerializedSystemIni.dat</p>
<p>解密详情：<a href="http://drops.wooyun.org/tips/349" target="_blank"><a href="http://drops.wooyun.org/tips/349">http://drops.wooyun.org/tips/349</a></a> 、<a href="http://www.blogjava.net/midea0978/archive/2006/09/07/68223.html" target="_blank"><a href="http://www.blogjava.net/midea0978/archive/2006/09/07/68223.html">http://www.blogjava.net/midea0978/archive/2006/09/07/68223.html</a></a></p>
<h3 id="2-weblogic-jndi-">2、Weblogic数据源(JNDI)</h3>
<p>Weblogic如果有配置数据源，那么默认数据源配置文件应该在：
Weblogic12user_projectsdomainsase_domainconfigconfig.xml</p>
<p><img src="" alt="enter image description here"></p>
<h3 id="weblogic-webshell-">Weblogic获取Webshell ￼</h3>
<p><img src="" alt="enter image description here"></p>
<p>Weblogic 9 GetShell： <a href="http://drops.wooyun.org/tips/402" target="_blank"><a href="http://drops.wooyun.org/tips/402">http://drops.wooyun.org/tips/402</a></a></p>
<h2 id="websphere">Websphere</h2>
<p>WebSphere 是 IBM 的软件平台。它包含了编写、运行和监视全天候的工业强度的随需应变 Web 应用程序和跨平台、跨产品解决方案所需要的整个中间件基础设施，如服务器、服务和工具。</p>
<h3 id="websphere-">Websphere版本</h3>
<p>Websphere现在主流的版本是6-7-8，老版本的5.x部分老项目还在用。GetShell大致差不多。6、7测试都有“默认用户标识admin登录”，Websphere安装非常麻烦，所以没有像之前测试Resin、Tomcat那么细测。</p>
<h3 id="websphere-">Websphere默认配置</h3>
<p>默认的管理后台地址（注意是HTTPS）： <a href="https://localhost:9043/ibm/console/logon.jsp" target="_blank"><a href="https://localhost:9043/ibm/console/logon.jsp">https://localhost:9043/ibm/console/logon.jsp</a></a></p>
<p>默认管理密码：
1、admin (测试websphere6-7默认可以直接用admin作为用户标识登录，无需密码) 2、websphere/ websphere 3、system/ manager</p>
<p>默认端口：</p>
<p>管理控制台端口 9060 管理控制台安全端口 9043 HTTP传输端口 9080 HTTPS传输端口 9443 引导程序端口 2809 SIP端口 5060 SIP安全端口 5061 SOAP连接器端口 8880 SAS SSL ServerAuth端口 9401 CSIV2 ServerAuth 侦听器端口 9403 CSIV2 MultiAuth 侦听器端口 9402 ORB侦听器端口 9100 高可用性管理通讯端口(DCS) 9353 服务集成端口 7276 服务集成安全端口 7286 服务集成器MQ互操作性端口 5558 服务集成器MQ互操作性安全端口 5578</p>
<p>8.5安装的时候创建密码： ￼</p>
<p><a href="http://wydrops-wordpress.stor.sinaapp.com/uploads/2013/09/java7-21.png" target="_blank">enter link description here</a></p>
<p>Websphere8.5启动信息：</p>
<p><img src="" alt="enter image description here"></p>
<p>Websphere8.5登录页面： <a href="https://localhost:9043/ibm/console/logon.jsp" target="_blank">https://localhost:9043/ibm/console/logon.jsp</a></p>
<p><a href="http://wydrops-wordpress.stor.sinaapp.com/uploads/2013/09/java7-23.png" target="_blank">enter link description here</a></p>
<p>Websphere8.5 WEB控制台：</p>
<p><img src="" alt="enter image description here"></p>
<p>Websphere6-7默认控制台地址也是： <a href="http://localhost:9043/ibm/console，此处用admin登录即可。" target="_blank">http://localhost:9043/ibm/console，此处用admin登录即可。</a></p>
<p><img src="" alt="enter image description here"></p>
<h3 id="websphere-getshell">Websphere GetShell</h3>
<p>本地只安装了8.5测试，Websphere安装的确非常坑非常麻烦。不过Google HACK到了其余两个版本Websphere6和Websphere7。测试发现Websphere GetShell一样很简单，只是比较麻烦，一般情况直接默认配置Next就行了。Websphere7和Websphere8 GetShell基本一模一样。</p>
<h3 id="websphere6-getshell">Websphere6 GetShell</h3>
<p>需要注意的是Websphere6默认支持的Web应用是2.3(web.xml配置的web-app_2_3.dtd)直接上2.5是不行的，请勿霸王硬上弓。其次是在完成部署后记得保存啊亲，不然无法生效。</p>
<p><img src="" alt="enter image description here"></p>
<h3 id="websphere8-5-getshell">Websphere8.5 GetShell</h3>
<p>部署的时候记得写上下文名称哦，不让无法请求到Shell。</p>
<p><img src="" alt="enter image description here"></p>
<p>注意：</p>
<p>如果在Deploy低版本的Websphere的时候可能会提示web.xml错误，这里其实是因为支持的JavaEE版本限制，把war包里面的web.xml改成低版本就行了，如把app2.5改成2.3。
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;!DOCTYPE web-app PUBLIC &quot;-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN&quot; &quot;<a href="http://java.sun.com/dtd/web-app_2_3.dtd&quot;&gt;" target="_blank">http://java.sun.com/dtd/web-app_2_3.dtd&quot;&gt;</a> <web-app>     <welcome-file-list>         <welcome-file>index.jsp</welcome-file>     </welcome-file-list> </web-app></p>
<h2 id="glassfish">GlassFish</h2>
<p>GlassFish是SUN的产品，但是作为一只优秀的土鳖SUN已经被Oracle收购了，GlassFish的性能优越对JavaEE的支持自然最好，最新的Servlet3.1仅GlassFish支持。</p>
<h3 id="glassfish-">GlassFish版本</h3>
<p>GlassFish版本比较低调，最高版本GlassFish4可在官网下载： <a href="http://glassfish.java.net/" target="_blank">http://glassfish.java.net/</a> 。最新4.x版刚发布不久。所以主流版本应当还是v2-3,3应该更多。支持php(v3基于Quercus),jRuby on Rails 和 Phobos等多种语言。</p>
<h3 id="glassfish-">GlassFish 默认配置</h3>
<p>默认Web控制后台： <a href="http://localhost:4848" target="_blank">http://localhost:4848</a></p>
<p>默认管理密码： GlassFish2默认帐号admin密码adminadmin 。</p>
<p>GlassFish3、4 如果管理员不设置帐号本地会自动登录，但是远程访问会提示配置错误。
Configuration Error Secure Admin must be enabled to access the DAS remotely.</p>
<p>默认端口：</p>
<p>使用Admin的端口 4848。 使用HTTP Instance的端口 8080。 使用JMS的端口 7676。 使用IIOP的端口 3700。 使用HTTP_SSL的端口 8181。 使用IIOP_SSL的端口 3820。 使用IIOP_MUTUALAUTH的端口 3920。 使用JMX_ADMIN的端口 8686。 使用OSGI_SHELL的默认端口 6666。 使用JAVA_DEBUGGER的默认端口 9009。</p>
<p>默认数据源：</p>
<p><img src="" alt="enter image description here"></p>
<h3 id="glassfish-getshell-">GlassFish GetShell ￼</h3>
<p><img src="" alt="enter image description here">
版权声明：未经授权禁止转载 <a href="http://drops.wooyun.org/author/园长" title="由 园长 发布" target="_blank">园长</a>@<a href="http://drops.wooyun.org/" target="_blank">乌云知识库</a>
分享到： <a href="&quot;分享到QQ空间&quot;"></a> <a href="&quot;分享到新浪微博&quot;"></a> <a href="&quot;分享到腾讯微博&quot;"></a> <a href="&quot;分享到人人网&quot;"></a> <a href="&quot;分享到网易微博&quot;"></a> <a href="&quot;累计分享2次&quot;">2</a></p>
<h3 id="-">相关日志</h3>
<ul>
<li><a href="http://drops.wooyun.org/tips/163" target="_blank">攻击JavaWeb应用[1]-JavaEE 基础</a></li>
<li><a href="http://drops.wooyun.org/tips/402" target="_blank">Hacking weblogic</a></li>
<li><a href="http://drops.wooyun.org/tips/347" target="_blank">攻击JavaWeb应用[5]-MVC安全</a></li>
<li><a href="http://drops.wooyun.org/tips/85" target="_blank">给CISCO设备中后门的方法–TCL 以及路由安全</a></li>
<li><a href="http://drops.wooyun.org/tips/646" target="_blank">得到内网域管理员的5种常见方法</a></li>
<li><a href="http://drops.wooyun.org/tips/401" target="_blank">sqlmap用户手册[续]</a>
上一篇:<a href="http://drops.wooyun.org/tools/601" target="_blank">跑wordpress用户密码脚本</a></li>
</ul>
<p>下一篇:<a href="http://drops.wooyun.org/papers/384" target="_blank">对某创新路由的安全测试</a></p>
<h3 id="-6-rss-2-0-http-drops-wooyun-org-tips-604-feed-trackback-http-drops-wooyun-org-tips-604-trackback-">楼被抢了 6 层了... <a href="">抢座</a>、<a href="http://drops.wooyun.org/tips/604/feed" target="_blank">Rss 2.0</a>或者 <a href="http://drops.wooyun.org/tips/604/trackback" target="_blank">Trackback</a></h3>
<ul>
<li><img src="" alt=""> 啦绯哥 | 2013/09/22 15:59 | <a href="">/#</a></li>
</ul>
<p>看园长的JAVA攻击文章，犹如品尝美酒，看完后有种想找姑娘的感觉</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">登录以回复</a></p>
<ul>
<li><img src="" alt=""> exploits | 2013/09/22 17:02 | <a href="">/#</a></li>
</ul>
<p>看园长的JAVA攻击文章，犹如品尝美酒，看完后有种想找姑娘的感觉</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">登录以回复</a></p>
<ul>
<li><img src="" alt=""> Shark2013 | 2013/09/22 21:02 | <a href="">/#</a></li>
</ul>
<p>看园长的JAVA攻击文章，犹如品尝美酒，看完后有种想找姑娘的感觉</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">登录以回复</a></p>
<ul>
<li><img src="" alt=""> c2y2 | 2013/09/23 13:51 | <a href="">/#</a></li>
</ul>
<p>看园长的JAVA攻击文章，犹如品尝美酒，看完后有种想找姑娘的感觉</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">登录以回复</a></p>
<ul>
<li><img src="" alt=""> 核攻击 | 2013/09/24 08:46 | <a href="">/#</a></li>
</ul>
<p>看园长的JAVA攻击文章，犹如品尝美酒，看完后有种想找姑娘的感觉</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">登录以回复</a></p>
<ul>
<li><img src="" alt=""> big、face | 2013/09/29 11:38 | <a href="">/#</a></li>
</ul>
<p>看园长的JAVA攻击文章，犹如品尝美酒，看完后有种想找姑娘的感觉</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">登录以回复</a></p>
<h3 id="-">发表评论</h3>
<p><a href="">点击这里取消回复。</a></p>
<p>您必须 <a href="http://drops.wooyun.org/login" target="_blank">登陆</a> 后才能发表评论。</p>
<h3 id="-">订阅更新</h3>
<ul>
<li><a href="http://drops.wooyun.org/feed" title="点击订阅" target="_blank"><img src="" alt=""></a></li>
</ul>
<h3 id="-">分类</h3>
<ul>
<li><a href="http://drops.wooyun.org/category/papers" title="漏洞分析" target="_blank">漏洞分析</a> (40)</li>
<li><a href="http://drops.wooyun.org/category/tips" title="技术分享" target="_blank">技术分享</a> (57)</li>
<li><a href="http://drops.wooyun.org/category/tools" title="工具收集" target="_blank">工具收集</a> (5)</li>
<li><p><a href="http://drops.wooyun.org/category/news" title="业界资讯" target="_blank">业界资讯</a> (3)</p>
<h3 id="-">最新日志</h3>
</li>
<li><p><a href="http://drops.wooyun.org/tips/688" title="Flash CSRF" target="_blank">Flash CSRF</a></p>
</li>
<li><a href="http://drops.wooyun.org/tips/689" title="XSS与字符编码的那些事儿 —科普文" target="_blank">XSS与字符编码的那些事儿 —科普文</a></li>
<li><a href="http://drops.wooyun.org/papers/680" title="Zabbix SQL Injection/RCE – CVE-2013-5743" target="_blank">Zabbix SQL Injection/RCE – CVE-2013-5743</a></li>
<li><a href="http://drops.wooyun.org/papers/679" title="CDN流量放大攻击思路" target="_blank">CDN流量放大攻击思路</a></li>
<li><a href="http://drops.wooyun.org/news/674" title="从丝绸之路到安全运维（Operational Security）与风险控制（Risk Management） 上集" target="_blank">从丝绸之路到安全运维（Operational Security）与风险控制（Risk Management） 上集</a></li>
<li><a href="http://drops.wooyun.org/tips/662" title="攻击JavaWeb应用[8]-后门篇" target="_blank">攻击JavaWeb应用[8]-后门篇</a></li>
<li><a href="http://drops.wooyun.org/papers/660" title="php4fun.sinaapp.com PHP挑战通关攻略" target="_blank">php4fun.sinaapp.com PHP挑战通关攻略</a></li>
<li><a href="http://drops.wooyun.org/papers/653" title="搭建基于Suricata+Barnyard2+Base的IDS前端Snorby" target="_blank">搭建基于Suricata+Barnyard2+Base的IDS前端Snorby</a></li>
<li><a href="http://drops.wooyun.org/tools/655" title="GPU破解神器Hashcat使用简介" target="_blank">GPU破解神器Hashcat使用简介</a></li>
<li><a href="http://drops.wooyun.org/tips/649" title="内网渗透应用 跨vlan渗透的一种思路" target="_blank">内网渗透应用 跨vlan渗透的一种思路</a></li>
</ul>
<h3 id="-">最新评论</h3>
<ul>
<li><img src="" alt=""></li>
</ul>
<p>c2y2 在 <a href="http://drops.wooyun.org/tips/689#comment-1883" target="_blank">XSS与字符编码的那些事儿 ---科普文</a>
谢谢</p>
<ul>
<li><img src="" alt=""></li>
</ul>
<p>Evi1c0de 在 <a href="http://drops.wooyun.org/tips/573#comment-1877" target="_blank">如何用意念获取附近美女的手机号码</a>
连接CMCC跳转到登陆页面 右键源码 修改即可</p>
<ul>
<li><img src="" alt=""></li>
</ul>
<p>牛牛 在 <a href="http://drops.wooyun.org/tips/688#comment-1871" target="_blank">Flash CSRF</a>
支持一下呵呵</p>
<ul>
<li><img src="" alt=""></li>
</ul>
<p>luwikes 在 <a href="http://drops.wooyun.org/papers/178#comment-1870" target="_blank">JBoss安全问题总结</a>
mark</p>
<ul>
<li><img src="" alt=""></li>
</ul>
<p>NgInx 在 <a href="http://drops.wooyun.org/tips/688#comment-1869" target="_blank">Flash CSRF</a>
好吧，基佬，顶你一个，不错。</p>
<ul>
<li><a href="">下一页 »</a>
Powered by <a href="http://wordpress.org/" target="_blank">WordPress</a> | GZai Theme by <a href="http://huaidan.org/" title="GZai Theme produced by 鬼仔" target="_blank">鬼仔</a>
<a href="http://tongji.baidu.com/hm-web/welcome/ico?s=9fc41da6a2322bdd80563c9d5a4bdb1d" target="_blank"><img src="" alt=""></a></li>
</ul>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/安全/">安全</a></li></span><span class="breadcrumb"><li><a href="/categories/安全/">安全</a></li><li><a href="/categories/安全/Java/">Java</a></li></span></span> | <span class="tags">Tagged <a href="/tags/Java/" class="label label-primary">Java</a><a href="/tags/安全/" class="label label-success">安全</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:38"datetime="2014-03-07 09:54:38"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-安全-Java--攻击JavaWeb应用7-Server篇1/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-安全-Java--攻击JavaWeb应用7-Server篇1" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-mac--本教程为在win7系统中安装苹果MountainLion双系统的图文教程/">本教程为在win7系统中安装苹果 Mountain Lion 双系统的图文教程</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:38.000Z"> <a href="/2014/02/02/2014-02-02-mac--本教程为在win7系统中安装苹果MountainLion双系统的图文教程/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-win7-mountain-lion-">本教程为在win7系统中安装苹果 Mountain Lion 双系统的图文教程</h1>
<p><strong>本教程为在win7系统中安装苹果 Mountain Lion 双系统的图文教程， 如果仅是想要安装苹果尝鲜，建议在虚拟机中安装，请参考：</strong><a href="http://diybbs.zol.com.cn/1/34037_629.html" target="_blank"><strong>VMware虚拟机安装MAC OS X Mountain Lion详细图文教程</strong></a>
如果对PC机安装黑苹果有兴趣的朋友，请详细观看本教程，以免带来不必要的麻烦。
<strong>在安装苹果MAC OS X双系统之前，确认BIOS可以开启AHCI(必须)</strong>
<strong>安装苹果MAC OS X双系统步骤：
</strong>A、工具准备
B、制作维护盘
C、分区并写入维护盘镜像MacPE
D、安装windows版变色龙
E、变色龙引导制作完整安装盘
F、变色龙引导完整安装盘安装Lion系统
<strong>A、工具准备</strong></p>
<ol>
<li>Win7下软件准备（A-E下载：<a href="http://bbsdown.zol.com.cn/down.php?aid=585552" target="_blank">Windows下相关软件.rar</a>(大小7138k,下载次数:41830)，F：<a href="http://xiazai.zol.com.cn/detail/42/418614.shtml" target="_blank"><strong>下载地址</strong></a>）
a. Windows版Chameleon
b. HFS+Explorer、JRE
c. TransMac9.1
d. <a href="http://detail.zol.com.cn/hard_drives_index/subcate2_list_1.html" target="_blank">硬盘</a>安装助手
e. DiskGenius
f. JRE</li>
<li>安装盘文件准备（下载地址：<a href="http://bbsdown.zol.com.cn/down.php?aid=585554" target="_blank">安装盘所需文件准备.part1.rar</a>(大小15729k,下载次数:30937) <a href="http://bbsdown.zol.com.cn/down.php?aid=585555" target="_blank">安装盘所需文件准备.part2.rar</a>(大小13237k,下载次数:24621)）
a. MAC OS X 系统安装文件
b. 根目录放置Extra文件夹，其目录结构如下：
Extra/dsdt.aml (非必需, 假如碰到AppleACPIPlatform.kext、IOPCIFamily.kext的错误请尝试加上自己的dsdt)
Extra/org.chameleon.Boot.plist （1105版变色龙起，之前版本请用com.apple.Boot.plist）
Extra/smbios.plist （非必需）
Extra/Extensions/AppleACPIPS2Nub.kext
Extra/Extensions/ApplePS2Controller.kext
Extra/Extensions/FakeSMC.kext
Extra/Extensions/NullCPUPowerManagement.kext
c. App、Utilities.plist、InstallerMenuAdditions.plist和Frameworks &amp; PrivateFrameworks(制作维护盘需要)。
d. Mac OS X 镜像（下载：<a href="http://bbsdown.zol.com.cn/down.php?aid=585553" target="_blank">InstallESD.rar</a>(大小43k,下载次数:6923)）
<strong>B、制作维护盘</strong></li>
<li>安装jre，之后安装HFS+Explorer.exe。</li>
<li>用7-zip提取InstallESD-10.8.dmg至InstallESD-10.8文件夹，之后会在InstallESD-10.8InstallMacOSX.pkg下得到InstallESD.dmg
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657219" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片1"></a></li>
<li>提取InstallESD.dmg。打开HFS+Explorer, 点file-load file system from file…，载入刚才解压得到的InstallESD-10.8InstallMacOSX.pkgInstallESD.dmg，弹出对话框选择 Apple_HFS 后点确定
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657220" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片2"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657221" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片3"></a></li>
<li>提取BaseSystem.dmg、mach_kernel及Packages文件夹，提取到Temp目录，弹出对话框选是。
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657222" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片4"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657223" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片5"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657224" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片6"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657225" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片7"></a></li>
<li>用HFSExplorer载入BaseSystem.dmg，打开菜单Tools-Create disk image...重新打包建立新的可写盘dmg，命名为BaseSystem-Install，保存在Temp文件夹下面
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657226" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片8"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657227" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片9"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657228" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片10"></a></li>
<li>替换Osinstall，放置Extra、mach_kernal、及 Packages 文件夹。打开TransMac9.1，菜单file-open disk image，打开刚才保存的BaseSystem-Install.dmg文件
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657229" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片11"></a>
a. 把Extra文件夹及mach_kernel拖拽复制至TransMac窗口根目录HFS+ Volume文件夹下
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657230" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片12"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657231" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片13"></a>
b. 把OSInstall拖拽至System/Library/PrivateFrameworks/Install.framework/Frameworks/OSInstall.framework/Versions/A/文件夹下替换原文件
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657232" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片14"></a>
c. 删除System/Installation/下的Packages快捷方式并新建一个Packages文件夹，并把刚提取的Packages下的OSInstall.mpkg文件拖拽拷贝至Packages文件夹。我们这里不拷贝整个Packages到System/Installation/下，不然会提示空间不足无法拷贝完。
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657233" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片15"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657234" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片16"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657235" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片17"></a></li>
<li>实际上进行到上一步，就完成了大家常说的懒人版的制作过程。剩下Packages文件夹该怎么办呢，大家常用的方法是先用硬盘助手把镜像写入硬盘，再安装MacDriver后进win系统反复一堆操作之后打开mac盘去拷贝替换这些文件。这里不使用这个方法，我们会给这个dmg添加三个软件：Finder、Chameleon Wizard和invisibliX。这样我们之后增删文件及安装mac版变色龙等操作就不再需要win系统，直接引导维护盘就可以进行之后操作。下面我们多做几步：
a. 将Finder拖拽复制到System／Library／CoreServices目录内(Finder要对应系统版本，这里是10.8)：<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657236" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片18"></a>
b. 将Chameleon Wizard和invisibliX拖拽复制到/Applications/Utilities下
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657237" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片19"></a>
c. 解压 Frameworks &amp; PrivateFrameworks.7z后到Frameworks &amp; PrivateFrameworks文件夹，拖拽复制SystemLibraryFrameworks下的Collaboration.framework和AddressBook.framework到dmg的对应目录，拖拽复制SystemLibraryPrivateFrameworks下的PhoneNumbers.framework和InternetAccounts.framework到dmg的对应目录(Frameworks &amp; PrivateFrameworks同样对应系统版本，这里是10.8)：
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657238" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片20"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657239" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片21"></a>
d. 将InstallerMenuAdditions.plist和Utilities.plist分别拖拽复制到dmg的/System/Installation/CDIS/Mac OS X Installer.app/Contents/Resources/和/System/Installation/CDIS/Mac OS X Utilities.app/Contents/Resources/目录替换原文件(作用是在menubar上添加Finder和软件的菜单，并可以在安装器和实用工具之间来回切换，大家可以参考这两个文件的内容照猫画虎，若用用记事本修改，保存时需用utf-8编码。另外只有少数几个软件可以在安装盘下运行)
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657240" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片22"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657241" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片23"></a>
这样类似PE的dmg维护盘镜像便制作完成，体积不大，可写入U盘或者<a href="http://detail.zol.com.cn/move_disk_index/subcate274_list_1.html" target="_blank">移动硬盘</a>的一个分区，作增改文件维护之用。我们称之为MacPE、维护盘都可以，也可以叫它没有packages的懒人版，且在接下来加入Packages文件夹制作完整安装盘的操作过程也不再依靠Win环境和MacDriver，仅依靠该dmg镜像即可。
<strong>C、分区并写入维护盘镜像MacPE</strong>
说在前面，建议新手或者不细心的朋友再第一次做分区及写镜像操作时在移动硬盘上进行，若你的机器没办法从移动硬盘引导，则建议在进行分区及后续操作之前先用DiskGenius备份硬盘的分区表，之后把分区表保存在本机之外的地方(若你的WinPE是32位就用32位的DiskGenius来备份，64位DiskGenius备份出来的可能用不了)：
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657242" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片24"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657243" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片25"></a>
分区概况：
1.5G - PE维护盘(BaseSystem-Install.dmg)5G - 完整安装盘(BaseSystem-Install.dmg+Packages)10G - Lion系统(若你打算把Lion作为常用系统的话建议分60G以上)
先保证有30G左右的空闲空间，我这里的例子，已有的主分区不超过2个，100M保留空间已占用一个主分区(如果已经有3个主分区，那新压缩的分区都只能是逻辑分区不能转为主分区，或者你无需努力尝试转为主分区，逻辑分区亦可，在逻辑分区上安装后可能需要借助WinPE来修复Win系统的引导及激活Win分区为活动分区，这里不表。注：转换为逻辑分区请不要把win系统盘转为逻辑分区了，如果你实在转不了或者完全没有头绪，建议转主分区这几个过程略过即可)。
a. 桌面，我的<a href="http://detail.zol.com.cn/desktop_pc_index/subcate27_list_1.html" target="_blank">电脑</a>右键选择管理，打开的界面选择磁盘管理。从最后一个分区开始压缩，我们这里先压缩25G左右给安装盘和Lion系统盘，你也可以多压缩一些能多分一个区来给mac系统保存数据。
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657244" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片26"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657245" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片27"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657246" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片28"></a>
b. 在未分配上点右键选 新建简单卷，分配1.5G给维护盘，自动分配一个驱动器号，不格式化。
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657247" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片29"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657248" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片30"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657249" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片31"></a>
在剩余空间分配5G左右给安装盘，剩下的都分给Lion系统，不分配驱动器号，不格式化
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657251" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片32"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657252" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片33"></a>
c. 打开DiskGenius，以我的操作为例，先把E盘转为逻辑分区，然后把在刚才分出来的20G左右分区上点右键选择“转换为主分区”，最后点保存更改(注意：转换为逻辑分区请不要把win系统盘转为逻辑分区了，如果你实在转不了或者完全没有头绪，建议转主分区这几个过程略过即可)。
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657333" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片34"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657254" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片35"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657255" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片36"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657256" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片37"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657257" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片38"></a>
作为示例，这样分出来的分区图貌似不大好看，不过目的达到了。我的建议是如果想重新来过的话，弄掉那100M隐藏分区，硬盘分区的时候前面可以准备两三个主分区，这样扩展分区就排在后面。
d. 以管理员方式运行硬盘安装助手，选择刚才制作的BaseSystem-Install.dmg，勾掉红圈的地方，目标分区选刚分出来的安装分区，点开始后不要做其他操作，等待日志出现Change partition type to AF: Success. All done, have fun!
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657258" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片39"></a>
e. 打开DiskGenius，修改刚才三个盘的分区参数，手动输入AF，确认后点保存更改。
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657259" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片40"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657260" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片41"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657261" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片42"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657262" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片43"></a>
<strong>D、Windows版变色龙安装</strong>
管理员方式运行Chameleon Install 1806 for win下的Chameleon Install.exe，点安装。如果有100M隐藏分区，要先打开磁盘管理给该分区分配一个盘符，然后点安装，安装后再删掉100M分区盘符
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657263" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片44"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657264" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片45"></a>
<strong>E、变色龙引导制作完整安装盘</strong>
安装完变色龙之后重启，选择chameleon选项
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657265" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片46"></a>
选择最后一个苹果图标的选项，底部boot处可以输入一些命令，比如输入-v，可以命令行方式引导方便我们查看可能碰到的问题，若什么都不输则以图形方式引导，之后按回车继续
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657266" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片47"></a>
之后按回车继续
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657267" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片48"></a>
等待一点时间，会引导至如下界面
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657268" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片49"></a>
下拉选择框内选择一种语言之后继续
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657269" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片50"></a>
在menubar上点“实用工具”，选择“磁盘工具”
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657415" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片51"></a>
文件-菜单-打开磁盘映象，找到BaseSystem-Install.dmg并打开
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657416" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片52"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657417" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片53"></a>
先选择之前的5G分区，切换到抹掉标签，格式改为Mac OS扩展(日志式)，然后抹掉
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657418" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片54"></a>
接下来点选恢复标签，Mac OS X Base System设为源磁盘，之前的5G为目的磁盘，确认无误后点恢复按钮，弹出对话框选抹掉
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657419" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片55"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657422" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片56"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657423" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片57"></a>
接下来会把Packages文件夹拷贝至该安装盘分区内
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657424" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片58"></a>
关闭磁盘工具后在menubar上点“实用工具”，选择“Finder…”，menubar上会显示Finder菜单，文件下拉选择“新建Finder窗口”
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657426" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片59"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657427" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片60"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657428" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片61"></a>
菜单，选Finder偏好设置，边栏标签里勾选“电脑”，进入如图所示目录设置显示选项
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657430" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片62"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657431" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片63"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657432" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片64"></a>
勾选项目简介后方便识别刚写入的安装盘，在安装盘上点右键显示简介，把名称更改为Lion 10.7.3 Install方便我们识别
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657433" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片65"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657435" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片66"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657437" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片67"></a>
新建一个Finder窗口，找到最开始提取出来的Packages文件夹，拷贝到Lion 10.7.3 Install/System/Installation路径，覆盖原文件夹
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657438" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片68"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657439" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片69"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657440" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片70"></a>
至此，完整的安装盘已经制作完毕。重启引导进入Lion系统安装过程
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657441" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片71"></a>
<strong>F、变色龙引导完整安装盘安装Lion系统</strong>
与E步骤引导过程一样，这里选择Lion 10.7.3 Install引导系统安装，若要看命令行方式，则在左下角输入-v，方便我们观察引导过程中如果出现失败可以知道大概出在什么问题上
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657442" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片72"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657443" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片73"></a>
进入安装界面后，选择实用工具下的磁盘工具，选择分给Lion的分区，设置如图，然后抹掉，之后关闭磁盘工具
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657444" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片74"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657447" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片75"></a>
安装器中点继续
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657448" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片76"></a>
选择Lion分区，单击安装，然后等待10分钟左右
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657450" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片77"></a>
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657453" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片78"></a>
安装完毕，重启
<a href="http://diybbs.zol.com.cn/tips/show_pic.php?picid=6657455" target="_blank"><img src="&quot;点击查看大图&quot;" alt="Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程图片79"></a>
<strong>论坛火爆热帖推荐：</strong>
<strong><a href="http://diybbs.zol.com.cn/1/34036_894.html" target="_blank">U盘安装Windows8教程</a>
**</strong><a href="http://diybbs.zol.com.cn/1/34036_1212.html" target="_blank">Win8 硬盘安装过程图解</a>
<strong>[</strong>Windows 8 RTM正式版试用<strong>](<a href="http://diybbs.zol.com.cn/1/34036_1214.html" target="_blank">http://diybbs.zol.com.cn/1/34036_1214.html</a>)
[</strong>Windows 8 Enterprise N RTM正式版下载（32位+64位+简体、繁体语言包下载）**](<a href="http://diybbs.zol.com.cn/1/34036_1211.html" target="_blank">http://diybbs.zol.com.cn/1/34036_1211.html</a>)</li>
</ol>
<p>来源： &lt;<a href="http://diybbs.zol.com.cn/1/34037_630.html" target="_blank">【Win7下安装苹果MAC OS X Mountain Lion 双系统详细图文教程】-MAC OS论坛-ZOL中关村在线</a>&gt;</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/mac/">mac</a></li></span></span> | <span class="tags">Tagged <a href="/tags/mac/" class="label label-primary">mac</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:38"datetime="2014-03-07 09:54:38"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-mac--本教程为在win7系统中安装苹果MountainLion双系统的图文教程/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-mac--本教程为在win7系统中安装苹果MountainLion双系统的图文教程" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-mac--《苹果MacOSX10_6雪豹操作系统新功能教程》MacOSX10_6SnowLe/">《苹果Mac OSX 10_6雪豹操作系统+新功能教程》(Mac OS X 10_6 Snow Le</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:38.000Z"> <a href="/2014/02/02/2014-02-02-mac--《苹果MacOSX10_6雪豹操作系统新功能教程》MacOSX10_6SnowLe/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-mac-osx-10_6-mac-os-x-10_6-snow-leopard-new-features-mac-only-_verycd-">《苹果Mac OSX 10_6雪豹操作系统+新功能教程》(Mac OS X 10_6 Snow Leopard +New Features)Mac only[光盘镜像]_VeryCD电驴下载</h1>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/mac/">mac</a></li></span></span> | <span class="tags">Tagged <a href="/tags/mac/" class="label label-primary">mac</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:38"datetime="2014-03-07 09:54:38"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-mac--《苹果MacOSX10_6雪豹操作系统新功能教程》MacOSX10_6SnowLe/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-mac--《苹果MacOSX10_6雪豹操作系统新功能教程》MacOSX10_6SnowLe" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-安全-Java--Struts2框架安全缺陷/">Struts2框架安全缺陷</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:38.000Z"> <a href="/2014/02/02/2014-02-02-安全-Java--Struts2框架安全缺陷/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="struts2-">Struts2框架安全缺陷</h1>
<h1 id="-secinn-http-secinn-appspot-com-home-secinn-"><a href="http://secinn.appspot.com/home" title="Secinn" target="_blank">Secinn</a></h1>
<ul>
<li><a href="http://secinn.appspot.com/home" target="_blank">Home</a></li>
<li><a href="http://secinn.appspot.com/pstzine" target="_blank">Webzine</a></li>
<li><a href="http://secinn.appspot.com/planet?site=cn" target="_blank">Planet(China)</a></li>
<li><a href="http://secinn.appspot.com/planet?site=intl" target="_blank">Planet(Worldwide)</a></li>
<li><a href="http://secinn.appspot.com/about" target="_blank">About</a></li>
</ul>
<p>Webzine<a href="http://secinn.appspot.com/pstzine/read?issue=4" target="_blank">Issue /#4</a><a href="http://secinn.appspot.com/pstzine/read?issue=3" target="_blank">Issue /#3</a><a href="http://secinn.appspot.com/pstzine/read?issue=2" target="_blank">Issue /#2</a><a href="http://secinn.appspot.com/pstzine/read?issue=1" target="_blank">Issue /#1</a><a href="mailto:root@ph4nt0m.org">投稿</a>Search<a href="http://secinn.appspot.com/search?type=internal" target="_blank">站内搜索</a><a href="http://secinn.appspot.com/search?type=internet" target="_blank">搜索全网安全咨询</a>RSS<a href="http://secinn.appspot.com/planet/feed?site=cn" target="_blank">Planet(China) Feed</a><a href="http://secinn.appspot.com/planet/feed?site=intl" target="_blank">Planet(Worldwide) Feed</a><a href="http://secinn.appspot.com/planet/feed?site=all" target="_blank">Planet(All) Feed</a>Links<a href="http://www.ph4nt0m.org/" target="_blank">Ph4nt0m Security Team</a><a href="http://bbs.ph4nt0m.org/" target="_blank">Mail-List</a> ## WebZine</p>
<ul>
<li><a href="http://secinn.appspot.com/pstzine/read?issue=4&amp;articleid=1" target="_blank">Introduction ---------- by root</a></li>
<li><a href="http://secinn.appspot.com/pstzine/read?issue=4&amp;articleid=2" target="_blank">Flashsky访谈 ---------- by flashsky</a></li>
<li><a href="http://secinn.appspot.com/pstzine/read?issue=4&amp;articleid=3" target="_blank">Struts2框架安全缺陷 ---------- by kxlzx</a></li>
<li><a href="http://secinn.appspot.com/pstzine/read?issue=4&amp;articleid=4" target="_blank">重谈IP欺骗技术 ---------- by papaya</a></li>
<li><a href="http://secinn.appspot.com/pstzine/read?issue=4&amp;articleid=5" target="_blank">Fuzz客户端存储对象，寻找client ddos ---------- by woyigui</a></li>
<li><a href="http://secinn.appspot.com/pstzine/read?issue=4&amp;articleid=6" target="_blank">应用软件缺陷利用的一点心得(Webkit篇) ---------- by wushi</a></li>
<li><a href="http://secinn.appspot.com/pstzine/read?issue=4&amp;articleid=7" target="_blank">Bypassing Linux kernel module version check ---------- by wzt</a></li>
<li><a href="http://secinn.appspot.com/pstzine/read?issue=4&amp;articleid=8" target="_blank">ACS - Active Content Signatures ---------- by Eduardo Vela Nava</a></li>
<li><a href="http://secinn.appspot.com/pstzine/read?issue=4&amp;articleid=9" target="_blank">卡巴虚拟机启发式查毒的绕过方法 ---------- by dangdang</a>  <h3 id="struts2-">Struts2框架安全缺陷</h3>
</li>
</ul>
<p>By kxlzx</p>
<h3 id="-">摘要</h3>
<p>本文介绍了java开发流行框架struts2以及webwork的一些安全缺陷，并举例说明框架本身以及开发人员使用 框架时，所产生的种种安全问题，以及作者挖掘框架安全漏洞的一些心得体会。</p>
<h3 id="-">推荐以下人群阅读</h3>
<p>了解java开发 了解框架开发 了解web application安全 “网络安全爱好者”</p>
<h3 id="-">正文</h3>
<p>当前java开发网站，通常不会是纯JSP的，大都使用了java framework。 有了这些framework，让开发人员更加快速的开发出代码，也让代码非常具有可扩展性，那些分层架构的思想， 更是深入人心。这些也大大影响了安全代码审核，曾提出“分层审核代码”的思想，比如在DAO层专门检查 sql注入，在view层检查xss等。这些框架都有自己的层级，本次文章主要讲的是struts这个框架的相关 安全问题，也会有小部分涉及到struts后面的DAO层。 而struts这个框架更新占有市场份额极大的一个框架，它在各个层级中，位于如图所示位置： <img src="" alt=""> 可以看到struts在web应用中，负责处理接收用户数据，调用业务处理，以及展示数据的工作。所以本文把 struts的功能分为controller层和view层，controller层来完成接收用户数据，分发用户请求，而view专门 用于展示数据。 一个单独的struts，是不合逻辑的，因为架构师通常喜欢多种框架集合，让它们各自负责某一层的处理。 研究一个框架的安全问题，不能仅仅站在框架的角度，还应该充分考虑到开发人员是如何使用这些框架的， 他们最喜欢写什么样的代码，这样才能还原一个正常的、完整的web应用场景。 从搜索结果看，互联网中，绝大多数教程推荐struts+hibernate+spring这样的黄金组合，那么，我假设有 一个应用使用了这个组合，以struts为重点，站在攻击者的角度，层层分析struts的设计缺陷。</p>
<h3 id="struts2-">Struts2开发回顾与简单学习</h3>
<p>为了让大家回顾或者学习一下struts2，我们一起来建立一个action、jsp页面，做一个接收用户输入，之后 处理一下，再展示出来给用户的过程，精通struts2的同学可以跳过此步。 -------------------------------------struts回顾start 首先建立action，叫做AaaaAction： public class AaaaAction extends ActionSupport{ private String name; public String getName() { return name; } public void setName(String name) { this.name = name; } public String execute(){ System.out.println(&quot;exe&quot;); return SUCCESS; } public String bbb(){ System.out.println(&quot;bbbbb&quot;); return SUCCESS; } } 请注意execute这个方法，让用户输入action的地址后，默认会访问这个方法。 之后配置struts.xml文件 <action name="aaaaaaa" class="net.inbreak.AaaaAction"> <result name="success">user/aaa.jsp</result> </action> 配置这个文件后，当用户输入 <a href="http://www.inbreak.net/app/aaaaaaa.action">http://www.inbreak.net/app/aaaaaaa.action</a> 的时候，struts会负责让AaaaAction中的execute方法处理用户请求。 处理之后，该方法返回“return SUCCESS;”，struts又负责找到result的name是seccuess所指向的jsp页面。 把该页面解析后，返回给用户。 而用户看到的就是aaa.jsp页面的html代码。 struts2继承了webwork的所有优点，其实等于是webwork的升级，如果开发人员想让用户直接访问action中的 某方法，而不是访问默认的execute方法，只要定义一个方法叫做bbb，并且是public的，用户就可以直接输入 <a href="http://www.inbreak.net/app/aaaaaaa!bbb.action" target="_blank">http://www.inbreak.net/app/aaaaaaa!bbb.action</a> 直接访问了bbb方法。 那request中的参数如果接收呢？struts2中，这个过程被包装了起来，使用非常方便，只要在action中定义 一个属性，叫做public String name；。然后加入getName和setName方法，就可以像正常使用属性一样，接收到 用户传递过来的变量。无论是get请求还是post请求，都可以使用这种方式接收用户输入。 整个过程就如此简单，现在大家对流程有了了解，我们就开始讨论正文，如果还是想了解更多，请自行google。 ----------------------------------struts回顾end</p>
<h3 id="struts2-">Struts2安全缺陷</h3>
<p>可以看到struts2在数据流向方面，有两个重点，一个是进入（in），一个是输出（out）。而我在做漏洞 挖掘的思路，也是跟着这个数据的流程，开始分析的，下面我们就开始让数据进入。 Action属性默认值可以被覆盖缺陷： 在日常的java项目中，我们经常会遇到保存一个新的对象（比如注册一个用户），然后给这个对象赋予一些 用户提交上来的属性值，在这里，只需要定义一个对象类： public class User { private Long id=0l; private String name; private String pass; private Integer type=1; 。。。下面的get和set方法代码略 } 定义后，在action中，添加一个属性 User reguser; 用户注册的页面代码如下： <form XXXXXXX> <input name="reguser.name"> 当用户提交这个form到action中后，struts2会负责自动映射reguser.name的值到reguser的相关属性（name） 中，所以在execute这个方法中，就可以使用reguser.getName()拿到用户提交的reguser.name的值。所以我们 下面的代码就很简单了： public String execute(){ add(user); add方法，更简单了，因为我们项目中集成了hibernate，这个框架自动映射user类中的各个属性，自动组成 insert语句。我们只要在add中调用session.save(user);就可以保存用户到数据库中。 前文提到那么多“简单”两个字，难道这些过程都是安全的而他给我们仅仅带来了方便么？ struts2只负责映射所有对象，他提供了form验证，也只能验证form中属性值的内容，比如email格式等， 并不能约束用户提交其他属性上来，于是这就变成了十分危险的功能。 当User中有个属性type，代表User是否管理员时（1为普通用户，2为管理员），麻烦来了，攻击者在原来的 注册表单中，新加入一个input，叫做 <input name="reguser.type"> 然后输入值是2，把这个值一起交给action。在这个流程中，这个值，当然也会被自动带到数据库中，向下 处理的逻辑中，这个用户，就已经变成管理员了。 当你看到了一个struts2或者webwork的应用，可以尝试使用属性攻击，修改当前表单，里面有所有你猜测到 的属性，一并提交上来，就可能会影响整个逻辑，达到攻击目的。文中仅仅是一个例子，事实上，在数据传递 的过程中，可以任意覆盖数据的默认值，本来就是一个危险的缺陷，而struts2和webwork这两个框架仅仅看到 了它带来的好处，忽略了这方面基于安全性的考虑，仅仅关注了用户提交数据的正确性。对比在没有struts2 这个功能的时候，我们却需要在action中一个一个的把需要的变量，从用户提交的request中解出来，一个一个 处理，不可能出现这种安全问题。现在它包装了这个过程，自以为很方面，却出了严重问题。</p>
<h3 id="action-">Action中的方法被暴力猜解缺陷</h3>
<p>前文提到，有一种方法可以让用户访问action时，不访问默认的execute方法，而是直接访问其他action中 的方法，条件是在action中，写一个public的方法。开发人员如果需要做一个登陆后，展示所有用户列表的 功能，而他的一个“解耦合”的开发习惯，将在这里导致安全缺陷。 定义一个如下的action public class Userlogin extends ActionSupport{ private String uname=&quot;&quot;; private String upwd; private List list; //getter and setter 方法略 public String login(){ if(uname!=null&amp;&amp;upwd!=null&amp;&amp;uname.equals(&quot;kxlzx&quot;)&amp;&amp;upwd.equals(&quot;pass&quot;)) {//if login success return list(); } return false; } public String list(){ list.add(&quot;kxlzx&quot;);list.add(&quot;kxlzx1&quot;);list.add(&quot;kxlzx2&quot;);list.add(&quot;kxlzx3&quot;); return &quot;list&quot;; } } Userlogin中，因为list这个功能（显示所有用户列表），其实是一个通用的功能，很容易被其他地方调用， 所以开发人员把它单独写成了一个方法。 当用户登陆的时候，打开 <a href="http://www.inbreak.net/app/userlogin!login.action" target="_blank">http://www.inbreak.net/app/userlogin!login.action</a> 来到了用户的登陆页面，可以看到，只有用户输入正确的用户名和密码，才能最终调用list()方法，显示结果。 <img src="" alt=""> 但是struts2把所有public的方法都暴露了出去，导致现在用户输入了 <a href="http://www.inbreak.net/app/userlogin!list.action" target="_blank">http://www.inbreak.net/app/userlogin!list.action</a> 用户访问这个链接后，struts2调用list方法，然后返回结果给用户，所以没有登陆，就显示了所有用户信息， 直接绕过了login中的登陆验证。 <img src="" alt=""> 在没有struts2的时候，我们要在servlet的doget或者dopost方法中，写if判断等代码，才能让用户调用其他 servlet中的方法，现在看来其实这也是一种保护措施。而现在struts2为了方便开发，把所有的public方法 统一映射了出去，导致开发把一个经常使用的功能，习惯写成一个public的方法，现在居然成了严重漏洞。</p>
<h3 id="struts2-action-">struts2的action属性设计缺陷</h3>
<p>再回头看看我们在action中的属性定义，你会发现，现在他们都成了漏洞，因为struts2规定属性的get和 set方法，都必须是public的。 那么我们定义了 private String name; public String getName() { return name; } public void setName(String name) { this.name = name; } 这段代码的时候，实际上，是写了两个public的方法。 那这两个表面上没有任何实质含义的方法，会有什么安全隐患呢？ 这需要和前文联系起来，前文提到，我们在struts.xml文件中，定义如下： <action name="user" class="net.inbreak.UserAction"> <result name="success">user/userlist.jsp</result> <result name="addUser">user/addUser.jsp</result> <result name="added">user/added.jsp</result> <result name="false">user/false.jsp</result> </action> 这段代码含义是，UserAction中，任何一个方法执行后，如果返回的是success这个字符串， 就会把 user/userlist.jsp返回给用户。 如果返回是addUser，就会把user/addUser.jsp返回给用户。 现在UserAction是管理用户的页面，在我们的系统中，有普通管理员和超级管理员，他们的区别是普通管理员 可以查看用户，但是不能添加一个用户。 所以，我们在UserAction中，写了 public String addUser(){ if(true){ //事实上这里是个超级管理员的判断，我偷懒了。 return &quot;false&quot;; } return &quot;addUser&quot;; } 这个方法的代码判断了不允许普通管理员访问，但是user/addUser.jsp这个jsp页面中并没有这个判断逻辑。 因为开发认为只有返回addUser的时候，才会来到这个页面，而要返回addUser，则必须通过超级管理员的验证。 那我们能让一个方法返回addUser么？当然可以！ <a href="http://www.inbreak.net/app/user!getUsername.action?username=addUser">http://www.inbreak.net/app/user!getUsername.action?username=addUser</a> 这个链接，struts2会怎么处理呢？ 他会找struts.xml中，对应段路径user，于是找到了对应的处理Action（net.inbreak.UserAction）， 由于路径中有了“!getUsername”，于是就去找这个Action中的getUsername这个方法，很明显，这个方法其实 是username这个属性的get方法，如果你要让Action接收用户提交的username，你就必须要定义这个方法。 那这个方法会返回什么呢？会返回action的字段username的值！哈哈！username用户已经提交给action了， 链接后面写着“?username=addUser”，struts2把这个值赋予了action中的username属性。那这里返回的当然 就是“addUser”！ <img src="" alt=""> 一系列巧合后，导致现在给用户返回了user/addUser.jsp页面，这是一个添加用户的表单页面，并且用户没 有去走验证是否为超级管理员这一步。 现在用户看到了一个添加用户的页面，他有两种攻击思路： 1，直接提交，如果处理用户提交的那个action没有再次判断用户身份，那就提交成功了。 2，如果他判断了用户身份，我们还可以csrf他，因为我们知道了这个action的地址，和它需要的参数！ 由于struts2的action和jsp文件分离，导致开发人员往往会在action的方法中，执行权限判断，而jsp页面中 并没有再次执行这个判断，他以为action判断就够了。而偏偏action的属性，给我们带来了一个可自定义返回 result的方法，导致我们可以绕过action访问jsp页面。</p>
<h3 id="struts2-result-redirect-">Struts2的那些result类型缺陷（redirect）</h3>
<p>刚才我们领教了struts2给我们带来那些属性的好处，现在我们再往后走一步，研究Action方法的返回结果。 其实并不是只由String类型的返回结果，struts2还有其他类型的返回，比如“redirect”类型。 <action name="test" class="net.inbreak.TestAction"> <result name="false">user/false.jsp</result> <result name="redir" type="redirect">${redirecturl}</result> </action> 这段代码，大家唯一可能看不懂的，就是type=&quot;redirect&quot;了。 这是一个url redirect的方式，struts2为了方便大家开发，把“自定义302跳转到其他url”这种方式给包装了 起来。只要如上定义，我们就可以在action中写方法： public String redirect() { return &quot;redir&quot;; } 然后定义属性 private String redirecturl; 当用户打开 <a href="http://www.inbreak.net/app/test!redirect.action?redirecturl=/a.jsp">http://www.inbreak.net/app/test!redirect.action?redirecturl=/a.jsp</a> 的时候，就会302跳转到 <a href="http://www.inbreak.net/app/a.jsp" target="_blank">http://www.inbreak.net/app/a.jsp</a> 这是很常见的url跳转应用，在struts2中，如上配置一下，就可以实现。 相信明眼人都看出来了，很明显这里存在url跳转漏洞，如果用户输入了 <a href="http://www.inbreak.net/app/test!redirect.action?redirecturl=http://www.ph4nt0m.org" target="_blank">http://www.inbreak.net/app/test!redirect.action?redirecturl=http://www.ph4nt0m.org</a> 就会跳转到<a href="http://www.ph4nt0m.org这个钓鱼网站(-_-!)。那么如何防御呢？" target="_blank">http://www.ph4nt0m.org这个钓鱼网站(-_-!)。那么如何防御呢？</a> 要防御url跳转到钓鱼网站，我们肯定需要一个白名单机制，或者根本就让他跳转到本站下。于是有了如下判断： public String redirect() { if(redirecturl.startsWith(&quot;/&quot;)) { return &quot;redir&quot;; } return &quot;false&quot;; } 可能你看出来了，仅仅判断&quot;/&quot;开头，其实是不能杜绝url跳转漏洞的，因为 <a href="http://www.inbreak.net/app/test!redirect.action?redirecturl=//www.ph4nt0m.org" target="_blank">http://www.inbreak.net/app/test!redirect.action?redirecturl=//www.ph4nt0m.org</a> 一样会跳转。而在这里却足够了，因为struts2已经接管了这个过程，只要以“/”开头，统统先给你自动加上 本地域名，抓包后，你会看到 location: <a href="http://www.inbreak.net/app//www.ph4nt0m.org" target="_blank">http://www.inbreak.net/app//www.ph4nt0m.org</a> 实际上是不会有问题的。 struts2也认为这样判断不会有问题了，然而用户输入 <a href="http://www.inbreak.net/app/test!getStr.action?str=redir&amp;redirecturl=http://www.ph4nt0m.org" target="_blank">http://www.inbreak.net/app/test!getStr.action?str=redir&amp;redirecturl=http://www.ph4nt0m.org</a> <img src="" alt=""> 其实前篇已经分析过了，这样就利用action中的str属性，绕过了必须以“/”开头的判断，直接跳转了。 test里有个str属性，可自定义返回，这里自定义了“redir”，所以来到了 <result name="redir" type="redirect">${redirecturl}</result> 而redirecturl的值，也提交给了action，所以跳转了。</p>
<h3 id="struts2-result-ajax-">Struts2的那些result类型缺陷（Ajax）</h3>
<p>在struts2中使用ajax，也是被struts2支持的，它提供了一种返回类型，叫做“stream”。在研究这个 result的使用时，作者看到一本书，叫做《 Struts 2权威指南：基于WebWork核心的MVC开发 》。这本书非常 出名，几乎所有的struts2使用者都推荐使用。 <a href="http://book.csdn.net/bookfiles/479/index.html" target="_blank">http://book.csdn.net/bookfiles/479/index.html</a> 书上介绍ajax可以这么使用： 配置struts.xml <action name="ajaxtest" class="net.inbreak.ajax.TestajaxAction"> <result type="stream"> <param name="contentType">text/html</param> <param name="inputName">input</param> </result> </action> 之后写TestajaxAction： public InputStream input; public String execute() throws Exception{ input = new StringBufferInputStream(&quot;aaaa<td><script>alert(&quot;kxlzx&quot;)</script>aa&quot;); return SUCCESS; } 其实大家都看出来我的意思了，返回了contentType为“text/html”的页面，内容为 aaaa<td><script>alert(&#39;kxlzx&#39;)</script>aa 结果浏览器解析的时候，出现了XSS漏洞。 本来默认的contentType是text/plain，不需要配置，如果用户直接打开，只会看到一个Stream，不会解析 其中的html和js。现在书上介绍说要写成这样，不知道作者是否知道这个教程对大家的影响，结果已经误导了 大批的开发人员。 事实上，这不是struts的问题，是struts“权威”教程的问题。权威的教程，一旦出现安全漏洞，往往会 误导大批的开发人员，不知道大家在挖漏洞的时候，是否注意到了这点，特别是当官方的DEMO出现漏洞， 那绝对是惊天地泣鬼神的悲剧。</p>
<h3 id="struts2-result-">Struts2的那些result类型缺陷（自定的页面）</h3>
<p>有时候，开发人员为了方便，喜欢配置struts.xml如下： <action name="test" class="net.inbreak.TestAction"> <result name="success">user/test.jsp</result> <result name="testpro">user/testproperty.jsp</result> <result name="redir" type="redirect">${redir}</result> <result name="testloadfilepath">${testloadfilepath}</result> <result name="false">user/redirfalse.jsp</result> <result name="input">user/input.jsp</result> </action> 请注意，其中一条result，名称是”testloadfilepath”， ${testloadfilepath}的作用是自定义的jsp页面 地址，接收session或request中传过来的这个变量的值。那么用户提交 <a href="http://www.inbreak.net/app/test.action?testloadfilepath=user/test.jsp">http://www.inbreak.net/app/test.action?testloadfilepath=user/test.jsp</a> 当然就会返回user/test.jsp页面，非常的灵活。虽然并不是所有的开发都会这么做，但是一旦出现这种情况， 会产生什么问题呢？ <a href="http://www.inbreak.net/app/test!getRedir.action?redir=testloadfilepath&amp;testloadfilepath=WEB-INF/classes/hibernate.cfg.xml" target="_blank">http://www.inbreak.net/app/test!getRedir.action?redir=testloadfilepath&amp;testloadfilepath=WEB-INF/classes/hibernate.cfg.xml</a> 不知道大家看懂这段url的含义没有，先调用getRedir，可以自定义返回到testloadfilepath，而testloadfilepath 已经指定了WEB-INF/classes/hibernate.cfg.xml。WEB-INF目录下，都是受web容器保护的东西，默认不允许 直接request相对地址来访问。该目录里面有程序编译后的class文件（可以被直接反编译为java源码）， 有数据库配置文件等敏感文件，现在打开如上url，直接被下载了hibernate.cfg.xml，这里放着数据库用户名 和密码。 <img src="" alt=""> 这样，攻击者就可以下载你的所有源代码，所有服务器上的文件。struts在提供给我们这种方式的时候， 并没有任何官方说明这里有危险，这就是一个不定时炸弹。</p>
<h3 id="struts2-taglib-">Struts2的taglib设计缺陷</h3>
<p>经过几个例子下来，不知道大家注意到没有，从用户输入走到这里，已经走到了输出这一步了。struts2的 那些result的type，其实就是几种输出方式，有jsp、ajax、redirect，经过jsonplugin等插件配置，还可以 支持其他输出方式。甚至支持一些标签库，比如freemarker等标签库。不过我们只谈struts2自带的标签库， 在一个jsp页面的最上方，写上一段代码，就可以使用struts2提供的数据输出和页面数据操作的标签了。 比以往我们在jsp输出“&lt;%=name%&gt;”要方便的多，下面给个例子： test.jsp代码 &lt;%@ taglib prefix=&quot;s&quot; uri=&quot;/struts-tags&quot; %&gt; <s:property value="username"/> 第一行是告诉struts这里要使用struts的标签库，第二行就是一个标签的使用，含义是输出username的值， username会从session、request、page等地方取，这里不关注取数据的次序。</p>
<h3 id="struts2-taglib-struts2-0-escapejavascript-">struts2的taglib设计缺陷（struts2.0不支持escapeJavaScript）</h3>
<p>说到输出，大家都能想到XSS漏洞，那么作为一个流行框架，struts2在这里做了什么控制呢？ struts2.0对部分标签做了默认的htmlescape： 刚才那个标签实际上效果等于 <s:property value="username" escape="true"/> 别以为做了htmlescape就够了，输出在javascript中的时候，还会出现xss漏洞。所以struts在2.1.6这个版本 也支持了javascriptescape： struts2.1.6： <s:property value="pass" escape="true" escapeJavaScript="false"/> 默认开启如上所示，当你要输出到js中的时候，可以使用escapeJavaScript进行转义。 也就是说，一旦你确定这个struts是2.0的，只要开发人员把变量输出到js中，十有八九会出xss问题。</p>
<h3 id="struts2-taglib-">struts2的taglib设计缺陷（没有富文本安全输出标签）</h3>
<p>而包括最高版本2.1.8在内，仍然没有支持富文本安全输出，这是一件悲剧的事情，如果用struts开发一个 大众blog的应用，又支持富文本的文章，开发人员只能把htmlescape和jsescape都去掉，才能保证业务正常 运行，所以导致了XSS漏洞。</p>
<h3 id="struts2-taglib-htmlescape-">struts2的taglib设计缺陷（并不是所有输出标签都做了默认的htmlescape）</h3>
<p>有几个标签是不做htmlescape的，比如 <s:a> <s:text> <s:url> 这其实是一个严重陷阱，因为只要提到struts2，前辈们都会告诉你，放心使用，它默认做了htmlescape。 那是什么原因导致一些标签没有做默认的escape呢？作者翻了下源码，也没有找出具体原因，不知道那些人 是怎么想的。 并且，经过简单的fuzz，发现在特定环境下，那些做了输出转义的标签也会出现问题。 我们知道默认的htmlescape是不转义单引号的，所以，当struts标签库的源码中，出现一些标签属性的输出 时，如果标签属性的周围使用的是单引号，而攻击者又能控制标签属性内容的时候，就会出现xss漏洞。如下： <input name="username" onclick='xss'> 当这个xss的内容可以由攻击者控制，即使对xss的内容作了htmlescape，依然可以被攻击者bypass。 基于这个原理，作者搜索了struts标签库源码，那些“XXX.ftl”文件中搜索“}&#39;”符号，找到N多，测试 其中一个如下： ------------- <s:textfield >标签，在正常使用的时候，他会放到一个<s:form>标签内，最终输出html后，会变成一个输入框。 它有个属性叫“tooltip”，如果这个标签为用户可控制，比如从数据库中读取用户输入，而这个标签所在的 <s:form>开启了： <s:form tooltipConfig="/#{'jsTooltipEnabled':'true'}"> 的时候，用户输入的tooltip的值，会出现以下情况： struts2.0 --&gt; <span dojoType="tooltip" ... caption="kxlzx<script></script>"> caption内容就是tooltip的值，从数据库查出 struts2.1.6&amp;struts2.1.8 --&gt; <img onmouseover="domTT_activate(this, …'StrutsTTClassic');alert('xss');a('','styleClass’…" /> onmouseover生成一个domTT_activate函数调用，参数中其中一个值，是tooltip的内容。这里被bypass了。 ------------ 这些搜出的几个个地方实际上根本没有做任何escape，就直接输出了数据。下面那个即使做了默认的 htmlescape，还是会出问题，除非它默认做了javascriptEscape。struts2默认有地方做javascriptEscape么？ 答案是“没有”。所以，它们全都能被XSS！ <img src="" alt=""> struts2的这些escape，其实是一个很太监的安全方案，安全工程师最恨的就是这种方案，做了安全方案， 还不做完全，留下一堆问题。</p>
<h3 id="struts2-http-parameter-pollution-">struts2的HTTP Parameter Pollution处理缺陷</h3>
<p>webwork和struts2都有这个问题，当用户给web应用提交: <a href="http://www.inbreak.net/app/test!redirect.action?redir=kxlzx&amp;redir=aaad61" target="_blank">http://www.inbreak.net/app/test!redirect.action?redir=kxlzx&amp;redir=aaad61</a> 时，如果我们在action中定义了 private String redir; public String getRedir() { return redir; } public void setRedir(String redir) { this.redir = redir; } Action就会取到redir的值为“kxlzx, aaad61”注意中间是有空格的。 这种数据是由webwork（struts2）把两个参数合并而成的，但是如果我们request.getParameter(&quot;redir&quot;); 拿到的值，却只是第一个（值为kxlzx）。 我们知道struts2提倡使用拦截器做一些事情，他可以在action的execute方法执行之前和之后做一些操作。 那就有一些开发，想当然的在这里防御一下url跳转、SQL注入、XSS等攻击。我们看看他们会怎么做： @Override public String intercept(ActionInvocation arg0) throws Exception { …… String name = request.getParameter(&quot;name&quot;); if(name!=null&amp;&amp;name.indexOf(&quot;&#39;&quot;)&gt;-1){ System.out.println(&quot;find sql injection&quot;); request.getSession().setAttribute(&quot;msg&quot;, &quot;find sql injection&quot;); return &quot;falseuser&quot;; } String redir = request.getParameter(&quot;redir&quot;); if(redir!=null&amp;&amp;!redir.equals(&quot;<a href="http://www.b.com&quot;)){" target="_blank">http://www.b.com&quot;)){</a> System.out.println(&quot;find url redirect&quot;); request.getSession().setAttribute(&quot;msg&quot;, &quot;find url redirect&quot;); return &quot;falseuser&quot;; } return arg0.invoke(); } 在这段代码中，作者仅仅示例了在拦截器中防御sql注入和url跳转漏洞，sql注入的防御规则是检查 “’”单引号，而url跳转漏洞规则是检查必须跳转到”<a href="http://www.b.com”去。作者知道没有完全防御，" target="_blank">http://www.b.com”去。作者知道没有完全防御，</a> 所以大家先不要在这里追究防御方案，仅仅是一个示例。 而开发人员在业务代码如下： String sql = &quot;select book_name,book_content from books&quot;; if (name != null) { sql += &quot; where book_name like &#39;%&quot; + name + &quot;%&#39;&quot;; } 很明显能注入。 public String redirect() { return &quot;redir&quot;; } 也明显存在url跳转漏洞。 但是由于拦截器在action之前执行，所以如果我们输入了 <a href="http://www.inbreak.net/app/test!findUserByName.action?name=a" target="_blank">http://www.inbreak.net/app/test!findUserByName.action?name=a</a>&#39; 拦截器当然就会返回错误“find sql injection”； <img src="" alt=""> 因为执行到了 String name = request.getParameter(&quot;name&quot;); if(name!=null&amp;&amp;name.indexOf(&quot;&#39;&quot;)&gt;-1){ 发现name的值确实有单引号。 但是如果我们输入了 <a href="http://www.inbreak.net/app/test!findUserByName.action" target="_blank">http://www.inbreak.net/app/test!findUserByName.action</a> ?name=aaaaa&amp;name=a&#39; union select name,pass from user where &#39;&#39;&lt;&gt;&#39; <img src="" alt=""> 就直接绕过了拦截器的判断。因为拦截器获取的request.getParameter(&quot;name&quot;)，是第一个参数的值aaaaa， 抛弃了第二个参数的值，但是action中的name的值，却是 “aaaaa, a&#39; union select name,pass from user where &#39;&#39;&lt;&gt;&#39; ”所以被注入了 大多数拦截器都是这样做的防御，包括一些filter等。 这件事情发生在url跳转漏洞时，却不明显，因为攻击者顶多构造一个： <a href="http://www.inbreak.net/app/test!redirect.action?redir=http://www.b.com&amp;redir=www.inbreak.net" target="_blank">http://www.inbreak.net/app/test!redirect.action?redir=http://www.b.com&amp;redir=www.inbreak.net</a> 抓包看看 <img src="" alt=""> 它跳到了<a href="http://www.b.com" target="_blank">http://www.b.com</a>, www.inbreak.net去了。所以IE直接报错，说打不开这个地址。但是我们还有别的 浏览器，总是喜欢给大家友好信息的浏览器，看看chrome给用户什么提示： <img src="" alt=""> Chrome也认为这是一个错误的链接，所以给出了“正确”的链接地址。这不是刚好被钓鱼网站利用么？ struts2的官方漏洞公告和修补后引发的安全缺陷 从有struts2，到现在为止，官方一共发布了4个漏洞，在 <a href="http://struts.apache.org/2.x/docs/security-bulletins.html" target="_blank">http://struts.apache.org/2.x/docs/security-bulletins.html</a> /<em> S2-001 — Remote code exploit on form validation error /</em> S2-002 — Cross site scripting (XSS) vulnerability on <s:url> and <s:a> tags /<em> S2-003 — XWork ParameterInterceptors bypass allows OGNL statement execution /</em> S2-004 — Directory traversal vulnerability while serving static content 从名字上，可以看出漏洞的内容，作者仅仅对其中两个做了源码级别的漏洞修补评估，发现了很多悲剧的事情。 同学们有兴趣可以去研究剩下两个漏洞。</p>
<h3 id="struts2-s2-002-">struts2的官方漏洞公告和修补后引发的安全缺陷（S2-002）</h3>
<p>先看看“S2-002 — Cross site scripting (XSS) vulnerability on <s:url> and tags”这个漏洞。 顾名思义是对<s:url>和<s:url>的xss漏洞修补，但是前文提到，这里有XSS漏洞，难道是在忽悠大家？我们 看看这帮工程师是怎么修补的，来到这个svn地址： <a href="http://svn.apache.org/viewvc/struts/struts2/trunk/core/src/main/java/org/apache/struts2/views/util/UrlHelper.java?r1=614814&amp;r2=615103&amp;diff_format=h" target="_blank">http://svn.apache.org/viewvc/struts/struts2/trunk/core/src/main/java/org/apache/struts2/views/util/UrlHelper.java?r1=614814&amp;r2=615103&amp;diff_format=h</a> 注意这两行： <img src="" alt=""> 看到这两行代码的时候，作者笑了，因为作者仿佛看到了至少两件悲剧的事情，现在把它们写成故事： 第1件悲剧的事情，某年某月某日，一个脚本小子给官方报告漏洞，说在使用<s:url>标签的时候，代码为： <s:url action="%{/#parameters.url}"></s:url> 之后他输入了 <a href="http://www.inbreak.net/app/test!testpro.action?url=" target="_blank">http://www.inbreak.net/app/test!testpro.action?url=</a><script>alert(&#39;hacked by kxlzx&#39;)</script> 并告诉官方这里是一个XSS漏洞，希望官方修补掉。 官方很重视，一个开发就去修补，添加如下判断： if (result.indexOf(&quot;<script>&quot;) &gt;= 0){ result = result.replaceAll(&quot;<script>&quot;, &quot;script&quot;); 并进行了冒烟测试、功能测试、黑盒测试、白盒测试。认为没有问题了，因为提交攻击者给的恶意url后，输出了 scriptalert(&#39;hacked by kxlzx&#39;)</script> 结果并没有在页面执行xss脚本。后来那脚本小子也测试了一下，发现没问题，这事情就过去了，瞒着人民 大众，悄悄的修补了。 第2件悲剧的事情，又过了某人某月某日，某另一个脚本小子又发了漏洞，还是那段代码，但是url改成了： <a href="http://www.inbreak.net/app/test!testpro.action?url=" target="_blank">http://www.inbreak.net/app/test!testpro.action?url=</a>&lt;<script>&gt;alert(&#39;hacked by kxlzx&#39;)</script> 注意，这里是&lt;<script>&gt;，经过了replaceAll函数后，刚好变成了<script>，重新组成了XSS漏洞。 官方这次不得不重新重视起来，决定把if判断，变成了while，不管你有多少&lt;&lt;&lt;&lt;&lt;&lt;<script>&gt;&gt;&gt;&gt;&gt;&gt;，都给你变成 scriptalert(&#39;hacked by kxlzx&#39;)</script> 并进行了冒烟测试、功能测试、黑盒测试、白盒测试。这次还发了公告出来，说这里没问题了，我们很重视 安全漏洞，已经修补了。 作者看到这里，测试新的bypass官方修补代码的url为： <a href="http://www.inbreak.net/app/test!testpro.action?url=" target="_blank">http://www.inbreak.net/app/test!testpro.action?url=</a><script kxlzx=kxlzx>alert(&#39;hacked by kxlzx&#39;)</script> 于是XSS脚本又被执行了，因为这里是<script kxlzx=kxlzx>，不是<script>，所以不符合判断条件，没有被 replaceAll，再次bypas了漏洞修补。。。</p>
<h3 id="struts2-s2-004-">struts2的官方漏洞公告和修补后引发的安全缺陷（S2-004）</h3>
<p>这个漏洞的修补，比上一个更加令人无奈，这是一个/../获取资源文件的漏洞 S2-004 — Directory traversal vulnerability while serving static content 要了解这个漏洞的成因，大家需要先了解一个知识点。 当struts的FilterDispatcher收到url请求如下两个路径下的文件时： <a href="http://www.inbreak.net/app/struts/" target="_blank">http://www.inbreak.net/app/struts/</a> 或 <a href="http://www.inbreak.net/app/static/" target="_blank">http://www.inbreak.net/app/static/</a> 会去取struts核心包的core.src.main.resources.org.apache.struts2下面的静态资源文件，这些资源文件 其实是一些js脚本和一些css文件。前文提到 <img onmouseover="domTT_activate(this, …'StrutsTTClassic');alert('xss');a('','styleClass’…" /> 代码中的domTT_activate，其实就是 <a href="http://www.inbreak.net/app/struts/domTT.js" target="_blank">http://www.inbreak.net/app/struts/domTT.js</a> 文件中的一个函数。 在struts2.0的时候，只要你敢上某几个版本的struts2，攻击者就可以通过 <a href="http://www.inbreak.net/app/struts/..%252f" target="_blank">http://www.inbreak.net/app/struts/..%252f</a> <a href="http://www.inbreak.net/app/struts/..%252f..%252f..%252fWEB-INF/classess/example/Login.class/" target="_blank">http://www.inbreak.net/app/struts/..%252f..%252f..%252fWEB-INF/classess/example/Login.class/</a> 浏览你的web目录，下载web目录下的文件。 先不说漏洞修补，请读者赶紧想想，你公司的开发人员，是否使用了struts2，并且把 “Struts 2.0.0 - Struts 2.0.11.2 ”之间的几个版本包装了或者根本没有包装，直接上了web应用。 如果有这种情况，就可以直接用以上方式攻击，这几天作者找了几个大型门户网站的漏洞，发现他们都存在 这个漏洞，顺便下载了他们的数据库配置文件，同时报告了漏洞。 <img src="" alt=""> Struts官方可能也受到了攻击，于是修补了代码。 作者同样查看了svn修补记录： <a href="http://svn.apache.org/viewvc/struts/struts2/trunk/core/src/main/java/org/apache/struts2/dispatcher/DefaultStaticContentLoader.java?r1=674498&amp;r2=687425&amp;pathrev=687425&amp;diff_format=h" target="_blank">http://svn.apache.org/viewvc/struts/struts2/trunk/core/src/main/java/org/apache/struts2/dispatcher/DefaultStaticContentLoader.java?r1=674498&amp;r2=687425&amp;pathrev=687425&amp;diff_format=h</a> <img src="" alt=""> 可以看到“ if (!name.endsWith(&quot;.class&quot;)) {”这行代码在修补漏洞时，被删除了。 修补前的代码中，为什么以前要过滤.class文件呢？是因为struts提供了一个功能： 如果开发人员想自己使用这个静态文件映射的功能，可以配置web.xml <filter> <filter-name>struts</filter-name> <filter-class> org.apache.struts2.dispatcher.FilterDispatcher </filter-class> <init-param> <param-name>packages</param-name> <param-value>net.inbreak.action</param-value> </init-param> </filter> 如上配置后，当用户输入 <a href="http://www.inbreak.net/app/struts/domTT.js" target="_blank">http://www.inbreak.net/app/struts/domTT.js</a> 的时候，实际上struts会去找net.inbreak.action这个文件夹下的domTT.js文件发给用户，而不再寻找核心包 的那个文件夹了。这个功能开放后，官方为了防止对应包下的class文件被下载后反编译成源码，所以写了行 代码，过滤.class文件。 就因为这行代码的存在，一时间，刚巧又正是struts2流行的时代。互联网大批的文章介绍struts2核心源码， 在介绍到FilterDispatcher的时候，必然会提到，这里会过滤.class文件，如果开发人员使用这个功能， 可以放心，自己的class文件不会被人下载。 后来出了漏洞，攻击者可以用 <a href="http://www.inbreak.net/app/struts/..%252f..%252f..%252fWEB-INF/classess/example/Login.class/" target="_blank">http://www.inbreak.net/app/struts/..%252f..%252f..%252fWEB-INF/classess/example/Login.class/</a> 绕过官方限制，下载class文件。最终的确修补了这个/../的漏洞。然而悲剧的是，因为class文件实际上 还是可以被下载，所以官方修补的同时，去掉了“if (!name.endsWith(&quot;.class&quot;)) { ”这一行代码，可能是 觉得这一行代码太丢人。 曾经的教程，还在互联网上，告诉大家class文件不会被下载，官方也发表声明修补了/../漏洞。但是看到 教程的开发们，却早已把目录映射了静态文件： <param-name>packages</param-name> <param-value>net.inbreak.action</param-value> 如果这个开发的net.inbreak.action包下有个UserLogin.class文件，在struts2有漏洞的版本，会面临 服务器上所有文件被下载的命运。即使开发升级了struts，因为核心代码中的class文件的判断去掉了， 导致这个文件还是可以被 <a href="http://www.inbreak.net/app/struts/UserLogin.class" target="_blank">http://www.inbreak.net/app/struts/UserLogin.class</a> 官方在没有任何通知的前提下，在教程满天飞告诉大家class文件不会被下载的前提下，为了面子悄悄的 取掉了这个判断。这回好了，无论升级否，都不让人消停，万一开发人员头脑发热，配置如下： <param-name>packages</param-name> <param-value>/</param-value> 就出大事了，可以直接下载资源目录下所有文件。 <a href="http://www.inbreak.net/app/struts/hibernate.cfg.xml" target="_blank">http://www.inbreak.net/app/struts/hibernate.cfg.xml</a> <img src="" alt=""></p>
<h3 id="-">总结</h3>
<p>作者挖了struts2的一些漏洞，也挖了一些web其他框架的漏洞（不在本文范围），总结下挖取这些框架漏洞 的方式。 首先，是上不上框架的问题。一旦开发用了这些框架，web应用会直接面临一些漏洞：</p>
<h3 id="1-">1，开放了某功能，导致采用框架的应用默认漏洞</h3>
<p>因为这个框架在未经允许的情况下，悄悄的打开了某些功能，可能是为了方便开发等作用，结果导致了漏洞 的产生。 举个例： 比如DWR这个AJAX框架一旦使用，在某些版本里，输入 <a href="http://www.inbreak.net/app/dwr/" target="_blank">http://www.inbreak.net/app/dwr/</a> 就能看到一个页面，里面是所有ajax方法的映射，甚至一些service方法没有配置，自动映射了出来。 你可以在这个页面给那些映射出来的方法提交参数，调用方法。比如有个getUserpasswdByid的方法，看名称 就知道，传递用户id，返回密码。 <img src="" alt=""> 再举例就是本文中的struts2的../../漏洞。 如果要挖这种漏洞，绝对是0day级别的漏洞，所以大家有必要怀疑每一个实现步骤，这种漏洞其实大部分就 出现在开发环境和正式环境的差异，以及一些奇奇怪怪的功能点上。</p>
<h3 id="2-">2，扩展了某功能，导致安全问题</h3>
<p>我们的web应用，本来是可以自己写代码实现一些功能的，但是这个框架为了方便开发和管理，把开发人员 要写的代码包装了下，只要简单的几行就能实现原本大批代码才能做到的功能。而这些便利，却带来了很多 安全问题。挖漏洞的同时，应该特别注意哪些地方比原来方便了很多，扩展了很多，这些扩展和方便，是否 考虑到了安全因素。 比如本文介绍的struts的result（urlredirect）相关漏洞。</p>
<h3 id="3-demo-">3，DEMO或教程或用户指南误导</h3>
<p>自从框架出现后，为了让人们最快的了解和使用框架，官方出了很对用户手册，demo等功能。而很多大牛们， 也相应的出了教程或者书籍，但是这些教程，DEMO，书籍上的例子，恰恰产生了很多漏洞。甚至开发本来 不按照教程走，不会有漏洞，却被教程误导了。如果黑客看到这些书籍，请立刻把他列到你的扫描器中， 绝对有不少开发会按照教程上去做。 例如本文提到的那个书籍介绍我们使用ajax的事情。</p>
<h3 id="4-">4，原本有安全方案，但是被某功能代码覆盖</h3>
<p>这其实是一件悲剧的事情，告诉我们要注意在日常开发中和漏洞修补中，是否有不明真相的开发人员， 为了实现某个功能，悄悄的把原本的安全方案断章取义的覆盖掉了。挖漏洞的时候，要特别注意安全方案附件 的代码变动，很可能发现非常弱智的逻辑问题。 例如本文提交的class文件的判断。</p>
<h3 id="5-">5，不完善的安全</h3>
<p>一个安全方案的实施，应该是彻头彻尾的，要注意方案的完整性，不能有些地方方案OK，有些地方不能实施。 在挖漏洞的时候，也不要被安全方案吓住，并不是有了方案，听起来牛X，就绝对不会有漏洞的，最起码应该 经过全面fuzz。 例如本文提到的XSS遗漏点，以及富文本的遗漏。</p>
<h3 id="6-">6，版本升级后，没有醒目安全公告</h3>
<p>我们知道所有的架构师都不愿意有事没事升级框架，特别是不稳定的框架版本，因为这个升级可能带来很多 不可预料的问题，所以可能即使看到了安全公告，也没有去升级。如果不懂安全，更不愿意升级框架了。 所以官方必须做到一个漏洞的修补，一个公告的发布，必须带有相关的代码log。告诉大家具体哪里做了改动。 而挖漏洞的同学更应该盯紧这些地方，百般推敲和测试修改的部分，不要被一次公用的测试结果吓到，模糊的 认为漏洞已经修补了。</p>
<h3 id="7-">7，悲剧的方案</h3>
<p>很多时候，我们会看到官方修补漏洞，或者一些安全方案的实施结果。那是不是真的都能达到修补漏洞的 效果呢？ 例如本文的<s:url>标签的xss漏洞，官方都这个漏洞的修补，真是绞尽脑汁，最终还是悲剧了。</p>
<h3 id="8-">8，优秀的方案，悲剧的执行</h3>
<p>RT，不再说明。</p>
<h3 id="9-web-">9，挑战web服务器配置</h3>
<p>这个问题有必要说一说，struts有事没事做个静态映射做什么？其实是目的就是为了框架和应用分离，很 明显那些js文件应该放在项目中的web目录下，但是为什么要做呢？还不是因为struts包发布的时候，还没有 项目，只有框架。 它为了达到即使上了任何项目，也能有办法访问到它提供的那些js的目的，只好被逼无奈做了这个功能，静态 目录映射。无论任何项目，部署后，只要url后面根目录加上/struts，或者/static就可以访问js。后来做了 这个功能感觉良好还不算，居然把功能提供出来，给推荐给开发人员使用。归根结底是因为struts挑战了 web服务器的配置，非要自己做静态映射。要知道人家web服务器做的映射，是经过多少年黑客入侵打磨出来的， struts有吗？ 这种情况突出在单独映射某目录，单独对某目录做权限，做DIR列表等功能，如果你看到一个框架也做了这种 功能，恭喜你！赶快去挖，十有八九存在漏洞！</p>
<h3 id="10-">10，没有安全方案，也没有提醒</h3>
<p>本文其实没有提到一些web漏洞，比如csrf，比如session fix，比如传输加密等，很明显struts是存在漏洞 的，只是作者觉得这些东西没必要这里说，大家都是明眼人，看到form里没有token，百分百csrf嘛！ 想想官方，官方也明明知道上了自己的框架后，会存在这些漏洞，为什么连个提醒都没有呢？本来开发就 不知道，你又藏着掖着。如果框架负责任，发个公告，说如果你用了我的框架，实际上要小心什么什么攻击。。。 呃。。。我明白官方为什么不敢说了。-_-! 这些框架除了那些“只要你用，必然有漏洞”的安全缺陷外，还有不少问题，会出现在开发人员使用框架的 过程中： 1，两个框架都方便，结合起来有漏洞 有个框架叫做Spring security，是基于url的访问权限控制，做的很好。如果你不是管理员，绝对不能 访问admin目录。但是有很多web框架，访问一个action或者访问一个controller，不止一个url可以访问， 在这里做了兼容性处理，多个url指向同一个应用，导致Spring security这种基于url的访问控制，名存实亡。 2，开发人员“正常”使用框架后，可能产生漏洞 这是最最惨的事情，框架绝对不会认领这种类型的漏洞的，他会认为这是开发的问题。然而本文的 “action方法暴力破解、url redirect扩大化”这两个安全缺陷，实际上也是框架存在的意义（方便开发） 带来的后果。官方会修补么？我想它顶多会说，大家不要这样那样而已，绝对不会做什么安全方案的。 要知道这些漏洞是具有struts或者webwork特色的，只有使用了这些框架才会有的。 3，危险功能点 框架带来了一些功能点，比如Tag lib的一些XSS，只要使用，必定有漏洞。 4，框架给开发挖坑 这根本就是陷阱，还是要说/static、/struts，如果开发不配置，顶多下载个js，影响不大，万一开发使用 了这个功能，映射了某个目录，那就掉进坑里去了。 5，一个框架带来的漏洞被另一个框架最大化 本文提到了变量默认值被覆盖后，又因为hibernate不需要写sql语句，而最终被存储进了数据库中。 回想一个问题，如果让我们自己写sql语句实现，难道在添加普通用户的时候，会真的专门写个变量， 接收用户传进来注册管理员的字段么？ 但是这是hibernate得问题么？当然不是，只是因为有了它，导致漏洞更加严重而已。</p>
<h3 id="-">补充</h3>
<p>本文对struts2的种种安全缺陷，就提到这里。个人觉得这是一个挖漏洞的方向，对framework漏洞的挖掘。 可能大家都专注于代码安全，没有太多的去看框架本身是否安全，以及使用了框架后，是否真的安全。 所以很多人忽略这个问题，我相信这不是一个新的开始，也不是一个结束，只是让大家开始更加重视框架安全。 作者也仅仅在本文提到了struts，webwork这两个框架，事实上框架很多，他们真的安全么？有待考证！ 最后写给那些真正打算把技术应用于实践的同学们，框架漏洞扫描器，是可以做出来的，对于难以解决的猜解 问题，可以对网站蜘蛛一下，然后保存那些开发人员喜欢使用的字段名称，关注各个input的名字，action的 名字，目录名字等，生成猜解一个列表。而判断是否用了struts更加简单： 特征1：XXX.action 可能是struts或webwork 特征2：XXX.do 可能是struts或webwork 特征3：XXX!bbb.action 可能是struts或webwork 特征4：XXX/struts/..%252f 必然是struts2 其他细节处，不再一一给出，有待大家发掘。 相关的漏洞修补方式，作者不在此处献丑，请大家根据漏洞原理自行处理。</p>
<h3 id="-">感谢</h3>
<p>---------------------------------------- 感谢axis （<a href="http://hi.baidu.com/aullik5）对本文提出的建议。" target="_blank">http://hi.baidu.com/aullik5）对本文提出的建议。</a> 感谢幻影webzine <a href="http://webzine.ph4nt0m.org/" target="_blank">http://webzine.ph4nt0m.org/</a> 感谢struts所有开发人员种种有趣的代码。 作者DEMO中有敏感数据，恕不能提供，请大家自行搜索strutsdemo搭建环境测试。 Struts2：<a href="http://struts.apache.org/2.x/" target="_blank">http://struts.apache.org/2.x/</a> Struts2 svn：<a href="http://svn.apache.org/viewvc/struts/struts2/trunk/" target="_blank">http://svn.apache.org/viewvc/struts/struts2/trunk/</a>
Powered by: <a href="http://www.ph4nt0m.org/" target="_blank">Ph4nt0m Security</a> © 2009 <a href="http://www.ph4nt0m.org/" target="_blank">Ph4nt0m Security Team</a>.</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/安全/">安全</a></li></span><span class="breadcrumb"><li><a href="/categories/安全/">安全</a></li><li><a href="/categories/安全/Java/">Java</a></li></span></span> | <span class="tags">Tagged <a href="/tags/Java/" class="label label-primary">Java</a><a href="/tags/安全/" class="label label-success">安全</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:38"datetime="2014-03-07 09:54:38"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-安全-Java--Struts2框架安全缺陷/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-安全-Java--Struts2框架安全缺陷" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>





<ul id="pagination" class="pagination pagination-lg">
  <li><a class="extend prev" href="/page/90/">&laquo;</a></li><li><a class="page-number" href="/">1</a></li><li><a class="page-number" href="/page/2/">2</a></li><li><span class="space">&hellip;</span></li><li><a class="page-number" href="/page/88/">88</a></li><li><a class="page-number" href="/page/89/">89</a></li><li><a class="page-number" href="/page/90/">90</a></li><li class="active"><li><span class="page-number current">91</span></li><li><a class="page-number" href="/page/92/">92</a></li><li><a class="page-number" href="/page/93/">93</a></li><li><a class="page-number" href="/page/94/">94</a></li><li><span class="space">&hellip;</span></li></li><li><a class="page-number" href="/page/164/">164</a></li><li><a class="page-number" href="/page/165/">165</a></li><li><a class="extend next" href="/page/92/">&raquo;</a></li>
  <div class="clearfix"></div>
</ul></div><!--wapper-->
       </div><!-- ID main-col END -->
       <aside id="sidebar" class="alignright col-sx-6 col-sm-4 col-md-3 col-lg-3">
<div id="widget_search" class="widget panel panel-primary">
    <form action="//google.com/search" method="get" accept-charset="utf-8">
  <div class="input-group">
    <input class="form-control" id="searchbox" type="search" name="q" results="0" placeholder="search">
    <span class="input-group-btn">
      <button class="btn btn-default" type="submit">Go!</button>
    </span>
    <input type="hidden" name="q" value="site:itsolife.com">
  </div>
</form>
</div>

<div id="widget_category" class="widget panel panel-primary">
  <div class="panel-heading">category</div>  <div data-src='category' class='ajax_widgets'>正在加载...</div>
</div>

<div id="widget_recent_posts" class="widget panel panel-primary">
  <div class="panel-heading">recent posts</div>  <div data-src='recent_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_tagcloud" class="widget panel panel-primary">
  <div class="panel-heading">tagcloud</div>  <div data-src='tagcloud' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_latest_update_posts" class="widget panel panel-primary">
  <div class="panel-heading">最近更新</div>  <div data-src='latest_update_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_recent_comments" class="widget panel panel-primary">
  <div class="panel-heading">recent comments</div>  

<div class="list-group-item ds-recent-comments" data-num-items="6" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="50"></div>



</div>

</aside>
       <div class="clearfix"></div>
     </div><!-- row END -->
  </div>
  <footer id="footer" class="container">
  <div class="panel panel-info">
  <section id='footer_widget'></section>  <div class="panel-footer">
  <div id="site-info">
    <span class='author'>
  
  &copy; 2014 RobinChia
  
    &nbsp;&nbsp;</span>
  
  <span id='analytics-51la'></span><span id='analytics-google'>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-48559895-1']);
  _gaq.push(['_trackPageview']);
  _js2load.push({src:('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'});
</script></span><span id='analytics-cnzz'>
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_5774006'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s17.cnzz.com/stat.php%3Fid%3D5774006%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
</span><span id='analytics-baidu'>
<script>
var _hmt = _hmt || [];
_js2load.push({src:"//hm.baidu.com/hm.js?1442f50724afc42380b51f097c43082c"});
</script>
</span>  </div>
  <div id="copyright">Blog powered by <a href='http://zespia.tw/hexo/'><strong>hexo</strong></a> Theme <strong><a href='https://github.com/chenall/hexo-theme-chenall'>chenall</a></strong>(Some change in it)<span class="pull-right"> 更新时间: <em>2014-03-15 16:01:37</em></span></div>
</div>
<div class="clearfix"></div>


  </div>
  </footer>
  
        <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>        
        <script src="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/js/bootstrap.min.js"></script>        
                
        <script src="http://cdn.bootcss.com/prettify/r298/prettify.min.js"></script>    <script type="text/javascript">
   var lang=["bsh", "c", "cc", "cpp", "cs", "csh", "cyc", "cv", "htm", "html",
    "java", "js", "m", "mxml", "perl", "pl", "pm", "py", "rb", "sh",
    "xhtml", "xml", "xsl"];
   var pretty_base='';
   $('script').each(function(){
	var c = $(this).attr('src');
	if (!c)
	    return;
	if (c.match(/(\/)?prettify(\.min)?\.js/i))
	{
	    var index = c.lastIndexOf('/');
	    if (index != -1)
		pretty_base = c.substr(0,index + 1);
	    return false;
	}
   })
   $('pre code').each(function(){
	var c = $(this).attr('class')
	if (!c)
	    return;
	c = c.match(/\s?(lang\-\w+)/i);
	if (c && lang.indexOf(c[1]) == -1)
	{
	    lang.push(c[1]);
	    $.getScript(pretty_base + c[1] + '.min.js');
	}
   })

    $(window).load(function(){
       $("pre").addClass("prettyprint");
       prettyPrint();
    })
</script>    
            <script type="text/javascript">
var duoshuoQuery = {short_name:"robinchia"};
_js2load.push({src:'http://static.duoshuo.com/embed.js',charset:'UTF-8'});
</script>
    
            <!--wumii_relatedItems-->
    
        <script src="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js"></script>    <script type="text/javascript">
(function($){
  $('.entry').each(function(i){
    $(this).find('img').each(function(){
      var alt = this.alt;

      if (alt){
        $(this).before('<span class="caption">' + alt + '</span>');
      }

      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="fancybox' + i + '" />');
    });
  });

  $('.fancybox').fancybox();
})(jQuery);
</script>    
        <script src="http://cdn.bootcss.com/mathjax/2.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>
    
<script type="text/javascript">
$('.ajax_widgets').each(function(){var src=$(this).attr('data-src');if(src)$(this).load('/widgets/'+src+'.html');});
$.each(_js2load,function(index,obj){loadjs(obj.src,obj.charset)});
</script>

<div id="scroll2top">
<img src="/scroll2top/arrow.png"/>
</div>
<script src="/scroll2top/scroll2top.min.js"></script>
<div id="winterland">
  <canvas></canvas>
</div>
<script src="/js/winterland.min.js"></script>

  </body>
</html>
