
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>The 146 Page | It so life</title>
<meta name="author" content="RobinChia">

<meta name="description" content="It so life">


<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta property="og:site_name" content="It so life"/>

<!--[if IE]><style>.testIE.IE{display:inline;}</style><![endif]-->
<!--[if lte IE 7]><link rel="stylesheet" href="/css/ie7.css" type="text/css"><![endif]-->
<!--[if (lt IE 9)&(gt IE 7)]><style>.testIE.IE8{display:inline;}</style><![endif]-->
<!--[if gt IE 8]><style>.testIE.IE9{display:inline;}</style><![endif]-->

<link href="/favicon.png" rel="icon">
<link rel="alternate" href="/atom.xml" title="It so life Feed" type="application/atom+xml">

<link rel="stylesheet" href="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.0.3/css/font-awesome.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/prettify/r298/prettify.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" type="text/css">
<link rel="stylesheet" href="/css/style.css" type="text/css">
<!--[if lt IE 9]>
   <style>article,aside,dialog,footer,header,section,footer,nav,figure,menu{display:block}</style>
   <script src="http://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
   <script src="http://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
<link href="http://cdn.staticfile.org/respond.js/1.4.2/respond-proxy.html" id="respond-proxy" rel="respond-proxy" />
<link href="/js/respond.proxy.gif" id="respond-redirect" rel="respond-redirect" />
<script src="/js/respond.proxy.js"></script>
   <script src="http://cdn.bootcss.com/selectivizr/1.0.2/selectivizr-min.js"></script>
<![endif]-->
<script type="text/javascript">
function loadjs(c,d){var a=document.createElement("script");a.async=!0;a.type="text/javascript";a.src=c;a.charset=d||"gbk";(document.getElementsByTagName("HEAD")[0]||document.getElementsByTagName("BODY")[0]).appendChild(a)};
var _protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
var _js2load = [];
</script>

</head>
<body>
      <header id="header" class="container"><nav id="main-nav" class="navbar navbar-default navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="/">It so life</a>
    </div>
    <div  class="collapse navbar-collapse">
      <ul  class="nav navbar-nav">
  
        <li><a href="/" title="Home">Home</a></li>      
        <li><a href="/about/" title="About">About</a></li>      
        <li><a href="/archives/" title="Archives">Archives</a></li>      
      <li class='dropdown'>
        <a class='dropdown-toggle' data-toggle='dropdown' href='#'>website<b class='caret'></b></a>
        <ul class='dropdown-menu pure-menu-selected'>
    
          <li><a href="//groups.google.com/forum/#!forum/pongba" title="TopLanguage">TopLanguage</a></li>    
          <li><a href="//itpub.net/" title="ITPub">ITPub</a></li>    
          <li><a href="//blog.jobbole.com/" title="Bole">Bole</a></li>    
          <li><a href="//nosql-database.org/" title="nosql">nosql</a></li>    
          <li><a href="//gitimmersion.googol.im/" title="Git">Git</a></li>    
        </ul>
      </li>
    
      </ul>
      <ul class="nav navbar-nav navbar-right">
      
        <li><a href="/atom.xml">RSS</a></li>
      
      
        <li><a href="https://twitter.com/robinchia">twitter</a></li>
      
      
      
      
        <li><a href="https://github.com/robinchia">github</a></li>
      
      </ul>
    </div>
  </div>
</nav>
<div class="clearfix"></div>
</header>
  <div id='content' class="container">
     <div class="page-header-wrapper">
      <!--[if lt IE 9]><div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong>提示:</strong>您的浏览器版本太低了,建议升级到 <strong><a href="http://windows.microsoft.com/zh-cn/internet-explorer/download-ie" title="IE9">IE9</a></strong> 以上,本站使用<a href="https://www.google.com/intl/zh-CN/chrome/">Chrome浏览器</a>可以获得最好的显示效果.</div><![endif]-->
      <div class="page-header"><h1 align="center"><big>It so life</big> </h1>
        <h5 align="center"><big>love as life</big></h5>
      </div>
     </div>
     <div class="row">
       <div id="main-col" class="alignleft col-sx-12 col-sm-8 col-md-9 col-lg-9">
      <section id='header_widget'></section>
          <div id="wrapper"><article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-框架汇总-ORM-hibernate--Hibernate知识总结/">Hibernate知识总结</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:29.000Z"> <a href="/2014/02/02/2014-02-02-框架汇总-ORM-hibernate--Hibernate知识总结/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="hibernate-">Hibernate知识总结</h1>
<p><a href=""></a></p>
<h1 id="-li-boy-http-libooy-diandian-com-"><a href="http://libooy.diandian.com/" target="_blank">Li-boy 奋斗的蜗牛</a></h1>
<ul>
<li><a href="http://libooy.diandian.com/submit" target="_blank">投稿</a></li>
<li><a href="http://libooy.diandian.com/inbox" target="_blank">私信</a></li>
<li><a href="http://libooy.diandian.com/archive" target="_blank">存档</a></li>
<li><a href="http://libooy.diandian.com/random" target="_blank">随机文章</a></li>
<li><a href="">关于</a>
<img src="" alt="Li-boy 奋斗的蜗牛"></li>
</ul>
<h3 id="-">关于我</h3>
<p>一天进步一点点！！！</p>
<p>26 Mar</p>
<h1 id="hibernate-">Hibernate知识总结</h1>
<p><img src="" alt=""></p>
<hr>
<p><strong>1.Hibernate持久化对象的生命周期 (状态)  </strong></p>
<p>(1) 瞬态（自由态） (2) 持久态 (3) 托管（游离态）</p>
<p><strong>1.1自由态</strong></p>
<p>   持久化对象的自由态，指的是对象在内存中存在，但是在数据库中并</p>
<p>没有数据与其关联。比如Student student = new Student()，这里</p>
<p>的student对象就是一个自由态的持久化对象。</p>
<p><strong>1.2持久态</strong></p>
<p>   持久态指的是持久化对象处于由Hibernate管理的状态，这种状态下</p>
<p>持久化对象的变化将会被同步到数据库中。</p>
<p>session.beginTransaction();</p>
<p>User user = new User();</p>
<p>user.setUserName(&quot;James&quot;);</p>
<p>user.setUserPwd(&quot;123&quot;);</p>
<p>session.save(user);</p>
<p>session.getTransaction().commit();</p>
<p><strong>1.3游离态</strong></p>
<p>处于持久态的对象，在其对应的Session实例关闭后，此时对象迚入</p>
<p>游离态。也就是说Session实例是持久态对象的宿主环境，一旦宿主</p>
<p>环境失效，那么持久态对象迚入游离状态。</p>
<p>session.beginTransaction();</p>
<p>User user = new User();</p>
<p>user.setUserName(&quot;James&quot;);</p>
<p>user.setUserPwd(&quot;123&quot;);</p>
<p>Integer id = (Integer) session.save(user);</p>
<p>user.setUserPwd(&quot;456&quot;);</p>
<p>session.getTransaction().commit();</p>
<p>user.setUserPwd(&quot;789&quot;);</p>
<p><strong>游离态和自由态的区别</strong></p>
<p>区别就在于游离态对象可以再次与Session迚行关联而成为持久态对</p>
<p>象。</p>
<p>session.beginTransaction();</p>
<p>User user = new User();</p>
<p>user.setUserName(&quot;James&quot;);</p>
<p>user.setUserPwd(&quot;123&quot;);</p>
<p>Integer id = (Integer) session.save(user);</p>
<p>user.setUserPwd(&quot;456&quot;);</p>
<p>session.getTransaction().commit();</p>
<p>Session session2 = HibernateUtil.getSessionFactory().getCurrentS</p>
<p>session2.beginTransaction();</p>
<p>user.setUserPwd(&quot;789&quot;);</p>
<p>session2.update(user);</p>
<p>session2.getTransaction().commit();</p>
<p>自由态对象在数据库中没有数据与其对应，但是游离态对象在数据库</p>
<p>中有数据与其对应，只不过当前对象不在Session环境中而已。从对</p>
<p>象的是否有主键值可以做简单的判断。</p>
<p>session.beginTransaction();</p>
<p>User user = new User();</p>
<p>user.setUserName(&quot;James&quot;);</p>
<p>user.setUserPwd(&quot;123&quot;);</p>
<p>System.out.println(user.getId());</p>
<p>Integer id = (Integer) session.save(user);</p>
<p>session.getTransaction().commit();</p>
<p>System.out.println(user.getId());</p>
<p>如果我自己创建一个对象，并且给主键属性赋值，该值还在数据库中</p>
<p>存在，当前对象的状态不也是游离态了？</p>
<p>/* 在Hibernate中根据主键判断对象是自由态还是游离态只是判断的</p>
<p>一个参考点，在Hibernate中还有更复杂的机制来判断一个对象的</p>
<p>状态，比如对象的version等等。</p>
<p>回到自由态</p>
<p>session.beginTransaction();</p>
<p>User user = (User) session.load(User.class, 120);</p>
<p>session.delete(user);</p>
<p>session.getTransaction().commit();</p>
<p>三种状态的转换 :</p>
<p><img src="" alt=""></p>
<p><strong>load和get方法</strong></p>
<p>相同点：</p>
<p>   get和load方法都是利用对象的主键值获取相应的对象，并可以使对</p>
<p>象处于持久状态。</p>
<p>不同点：</p>
<p>   load方法获取对象时不会立即执行查询操作，而是在第一次使用对象</p>
<p>是再去执行查询操作。如果查询的对象在数据库中不存在，load方法</p>
<p>返回值不会为null，在第一次使用时抛出</p>
<p>org.hibernate.ObjectNotFoundException异常。</p>
<p>   使用get方法获取对象时会立即执行查询操作，并且对象在数据库中</p>
<p>不存在时返回null值。</p>
<p><strong>save和persist方法</strong></p>
<p>相同点：</p>
<p>save和persist方法都是将持久化对象保存到数据库中</p>
<p>区别：</p>
<p>sava方法成功执行后，返回持久化对象的ID</p>
<p>persist方法成功执行后，不会返回持久化对象的ID，persist方法是</p>
<p>JPA中推荐使用的方法  </p>
<p><strong>save和update方法</strong></p>
<p>save方法是将自由态的对象迚行保存。</p>
<p>update方法是将游离态的对象迚行保存。</p>
<p>update和saveOrUpdate方法</p>
<p>   如果一个对象是游离态戒持久态，对其执行update方法后会将对象</p>
<p>的修改同步到数据库中，如果该对象是自由态，则执行update方法</p>
<p>是没有作用的。</p>
<p>   在执行saveOrUpdate方法时该方法会自动判断对象的状态，如果为</p>
<p>自由态则执行save操作，如果为游离态戒持久态则执行update操作。</p>
<p><strong>update和merge方法</strong></p>
<p>   如果持久化对象在数据库中存在，使用merge操作时迚行同步操作。</p>
<p>如果对象在数据库不存在，merge对象则迚行保存操作。</p>
<p>   如果对象是游离状态，经过update操作后，对象转换为持久态。但</p>
<p>是经过merge操作后，对象状态依然是游离态。</p>
<p><strong>saveOrUpdate和merge方法</strong></p>
<p>saveOrUpdate方法和merge方法的区别在于如果session中存在两</p>
<p>个主键值相同的对象，迚行saveOrUpdate操作时会有异常抛出。这</p>
<p>时必须使用merge迚行操作。</p>
<p>session.beginTransaction();</p>
<p>User user = new User();</p>
<p>user.setId(3);</p>
<p>user.setUserName(&quot;aaaaaaaa&quot;);</p>
<p>user.setUserPwd(&quot;123123&quot;);</p>
<p>User user2 = (User) session.get(User.class, 3);</p>
<p>session.saveOrUpdate(user);//ERROR</p>
<p>session.getTransaction().commit();</p>
<p>clear方法和flush方法</p>
<p>clear方法是将Session中对象全部清除，当前在Session中的对象由</p>
<p>持久态转换为游离态。flush方法则是将持久态对象的更改同步到数据</p>
<p>库中。</p>
<p>session.beginTransaction();</p>
<p>User user = (User) session.get(User.class, 3);</p>
<p>user.setPassword(&quot;111&quot;);</p>
<p>session.flush();  </p>
<p>session.getTransaction().commit();</p>
<p><strong>2.Hibernate查询</strong></p>
<p><strong>2.1 HQL</strong></p>
<p>   HQL（Hibernate Query Language）提供了丰富灵活的查询方式，</p>
<p>使用HQL进行查询也是Hibernate官方推荐使用的查询方式。</p>
<p>   HQL在语法结构上和SQL语句十分的相同，所以可以很快的上手进行</p>
<p>使用。使用HQL需要用到Hibernate中的Query对象，该对象丏门执</p>
<p>行HQL方式的操作。</p>
<p><strong>1.查询所有</strong></p>
<p>session.beginTransaction();</p>
<p>String hql = &quot;from User&quot;;</p>
<p>Query query = session.createQuery(hql);</p>
<p>List<User> userList = query.list();</p>
<p>for(User user:userList){</p>
<p> System.out.println(user.getUserName());</p>
<p>}</p>
<p>session.getTransaction().commit();</p>
<p><strong>2.where</strong></p>
<p>session.beginTransaction();</p>
<p>String hql = &quot;from User where userName = &#39;James&#39;&quot;;</p>
<p>Query query = session.createQuery(hql);</p>
<p>List<User> userList = query.list();</p>
<p>for(User user:userList){</p>
<p> System.out.println(user.getUserName());</p>
<p>}</p>
<p>session.getTransaction().commit();</p>
<p>在HQL中where语句中使用的是持久化对象的属性名，比如上面示例</p>
<p>中的userName。当然在HQL中也可以使用别名：</p>
<p>String hql = &quot;from User as u where u.userName = &#39;James&#39;&quot;;</p>
<p><strong>3.过滤条件</strong></p>
<p>在where语句中还可以使用各种过滤条件，如：=、&lt;&gt;、&lt;、&gt;、&gt;=</p>
<p>、&lt;=、between、not between、in、not in、is、like、and、or</p>
<p>等。</p>
<p>– from Student where age &gt; 20;</p>
<p>– from Student where age between 20 and 30;</p>
<p>– from Student where name is null;</p>
<p>– from Student where name like ‘小%’;</p>
<p>– from Student where name like ‘小%’ and age &lt; 30</p>
<p><strong>4.获取一个不完整对象</strong></p>
<p><strong>一列：</strong></p>
<p>session.beginTransaction();</p>
<p>String hql = &quot;select userName from User&quot;</p>
<p>Query query = session.createQuery(hql);</p>
<p>List nameList = query.list();</p>
<p>for(Object obj:nameList){</p>
<p> System.out.println(obj);</p>
<p>}</p>
<p>session.getTransaction().commit();</p>
<p><strong>5.两列或多列：</strong></p>
<p>session.beginTransaction();</p>
<p>String hql = &quot;select userName,userPwd from User&quot;;</p>
<p>Query query = session.createQuery(hql);</p>
<p>List nameList = query.list();</p>
<p>for(Object obj:nameList){</p>
<p>Object[] array = (Object[]) obj;</p>
<p>System.out.println(&quot;name:&quot; + array[0]);</p>
<p>System.out.println(&quot;pwd:&quot; + array[1]);</p>
<p>}</p>
<p>session.getTransaction().commit();</p>
<p><strong>6.统计和分组查询</strong></p>
<p>session.beginTransaction();</p>
<p>String hql = &quot;select count(/*),max(id) from User&quot;;</p>
<p>Query query = session.createQuery(hql);</p>
<p>List nameList = query.list();</p>
<p>for(Object obj:nameList){</p>
<p>Object[] array = (Object[]) obj;</p>
<p>System.out.println(&quot;count:&quot; + array[0]);</p>
<p>System.out.println(&quot;max:&quot; + array[1]);</p>
<p>}</p>
<p>session.getTransaction().commit();</p>
<p><strong>7.更多写法…</strong></p>
<p>消除重复： select distinct name from Student;</p>
<p>最大： select max(age) from Student;</p>
<p>行数： select count(age),age from Student group by age;</p>
<p>排序： from Student order by age;</p>
<p><strong>HQL占位符</strong></p>
<p>session.beginTransaction();</p>
<p>String hql = &quot;from User where userName = ?&quot;;</p>
<p>Query query = session.createQuery(hql);</p>
<p>query.setString(0, &quot;James&quot;);</p>
<p>List<User> userList = query.list();</p>
<p>for(User user:userList){</p>
<p> System.out.println(user.getUserName());</p>
<p>}</p>
<p>session.getTransaction().commit();</p>
<p><strong>HQL引用占位符</strong></p>
<p>session.beginTransaction();</p>
<p>String hql = &quot;from User where userName = :name&quot;;</p>
<p>Query query = session.createQuery(hql);</p>
<p>query.setParameter(&quot;name&quot;, &quot;James&quot;);</p>
<p>List<User> userList = query.list();</p>
<p>for(User user:userList){</p>
<p> System.out.println(user.getUserName());</p>
<p>}</p>
<p>session.getTransaction().commit();</p>
<p><strong>HQL分页</strong></p>
<p>session.beginTransaction();</p>
<p>String hql = &quot;from User&quot;;</p>
<p>Query query = session.createQuery(hql);</p>
<p><strong>query.setFirstResult(0);</strong></p>
<p><strong>query.setMaxResults(2);</strong></p>
<p>List<User> userList = query.list();</p>
<p>for(User user:userList){</p>
<p> System.out.println(user.getUserName());</p>
<p>}</p>
<p>session.getTransaction().commit();</p>
<p><strong>3.Criteria查询</strong></p>
<p>   Criteria对象提供了一种面向对象的方式查询数据库。Criteria对象需</p>
<p>要使用Session对象来获得。</p>
<p>一个Criteria对象表示对一个持久化类的查询。</p>
<p><strong>1.查询所有</strong></p>
<p>session.beginTransaction();</p>
<p>Criteria c = session.createCriteria(User.class);</p>
<p>List<User> userList = c.list();</p>
<p>for(User user:userList){</p>
<p> System.out.println(user.getUserName());</p>
<p>}</p>
<p>session.getTransaction().commit();</p>
<p><strong>2.Where</strong></p>
<p>session.beginTransaction();</p>
<p>Criteria c = session.createCriteria(User.class);</p>
<p>c.add(Restrictions.eq(&quot;userName&quot;, &quot;James&quot;));</p>
<p>List<User> userList = c.list();</p>
<p>for(User user:userList){</p>
<p> System.out.println(user.getUserName());</p>
<p>}</p>
<p>session.getTransaction().commit();</p>
<p><strong>3.Restrictions对象</strong></p>
<p><img src="" alt=""></p>
<p><strong>where...and .... 语句</strong></p>
<p>session.beginTransaction();</p>
<p><strong>Criteria c = session.createCriteria(User.class)</strong></p>
<p><strong>c.add(Restrictions.like(&quot;userName&quot;, &quot;J&quot;));</strong></p>
<p><strong>c.add(Restrictions.eq(&quot;id&quot;, 120));</strong></p>
<p>List<User> userList = c.list();</p>
<p>for(User user:userList){</p>
<p> System.out.println(user.getUserName());</p>
<p>}</p>
<p>session.getTransaction().commit();</p>
<p><strong>where...or .... 语句</strong></p>
<p>session.beginTransaction();</p>
<p>Criteria c = session.createCriteria(User.class);</p>
<p><strong>c.add(Restrictions.or(Restrictions.eq(&quot;userName&quot;, &quot;James&quot;),</strong></p>
<p><strong> Restrictions.eq(&quot;userName&quot;, &quot;Alex&quot;)));</strong></p>
<p>List<User> userList = c.list();</p>
<p>for(User user:userList){</p>
<p>System.out.println(user.getUserName());</p>
<p>}</p>
<p>session.getTransaction().commit();</p>
<p><strong>获取唯一的记录</strong></p>
<p>session.beginTransaction();</p>
<p>Criteria c = session.createCriteria(User.class);</p>
<p>c.add(Restrictions.eq(&quot;id&quot;, 120));</p>
<p>User user = (User) c.uniqueResult();</p>
<p>System.out.println(user.getUserName());</p>
<p>session.getTransaction().commit();</p>
<p><strong>分页</strong></p>
<p>session.beginTransaction();</p>
<p>Criteria c = session.createCriteria(User.class);</p>
<p>c.setFirstResult(0);</p>
<p>c.setMaxResults(5);</p>
<p>List<User> userList = c.list();</p>
<p>for(User user:userList){</p>
<p> System.out.println(user.getUserName());</p>
<p>}</p>
<p>session.getTransaction().commit();</p>
<p><strong>分组与统计</strong></p>
<p>session.beginTransaction();</p>
<p>Criteria c = session.createCriteria(User.class);</p>
<p>c.setProjection(Projections.sum(&quot;id&quot;));</p>
<p>Object obj = c.uniqueResult();</p>
<p>System.out.println(obj);</p>
<p>session.getTransaction().commit();</p>
<p>Projections对象</p>
<p><img src="" alt=""></p>
<p><strong>多个统计与分组</strong></p>
<p>session.beginTransaction();</p>
<p>Criteria c = session.createCriteria(User.class);</p>
<p><strong>ProjectionList projectionList = Projections.projectionList();</strong></p>
<p><strong>projectionList.add(Projections.sum(&quot;id&quot;));</strong></p>
<p><strong>projectionList.add(Projections.min(&quot;id&quot;));</strong></p>
<p><strong>c.setProjection(projectionList);</strong></p>
<p>Object[] obj = (Object[]) c.uniqueResult();</p>
<p>System.out.println(&quot;sum:&quot; + obj[0]);</p>
<p>System.out.println(&quot;min:&quot; + obj[1]);</p>
<p>session.getTransaction().commit();</p>
<p><strong>排序</strong></p>
<p>session.beginTransaction();</p>
<p>Criteria c = session.createCriteria(User.class);</p>
<p><strong>c.addOrder(Order.desc(&quot;id&quot;));</strong></p>
<p>List<User> list = c.list();</p>
<p>for(User user : list){</p>
<p> System.out.println(user.getUserName());</p>
<p>}</p>
<p>session.getTransaction().commit();</p>
<p><strong>4.使用原生SQL查询</strong></p>
<p><strong>1.查询出后必须封装才可以用：</strong></p>
<p>session.beginTransaction();</p>
<p>String sql = &quot;select id,username,userpwd from t_user&quot;;</p>
<p>List list = session.createSQLQuery(sql).list();</p>
<p>for(Object item : list){</p>
<p>Object[] rows = (Object[]) item;</p>
<p>System.out.println(&quot;id:&quot; + rows[0] + &quot;username:&quot;  </p>
<ul>
<li>rows[1] + &quot;userpwd:&quot; + rows[2]);</li>
</ul>
<p>}</p>
<p>session.getTransaction().commit();</p>
<p><strong>2.查询出一个集合可以直接用对象操作：</strong></p>
<p>session.beginTransaction();</p>
<p>String sql = &quot;select id,username,userpwd from t_user&quot;;</p>
<p>SQLQuery query = session.createSQLQuery(sql).addEntity(User.class);</p>
<p>List<User> list = query.list();</p>
<p>for(User user : list){</p>
<p> System.out.println(user.getUserName());</p>
<p>}</p>
<p>session.getTransaction().commit();</p>
<p><strong>3.查询出一个对象可以直接用对象操作</strong>：</p>
<p>session.beginTransaction();</p>
<p>String sql = &quot;select id,username,userpwd from t_user where id = 2&quot;;</p>
<p>SQLQuery query = session.createSQLQuery(sql).addEntity(User.class);</p>
<p>User user = (User) query.uniqueResult();</p>
<p>System.out.println(user.getUserName());</p>
<p>session.getTransaction().commit();</p>
<p><a href="http://libooy.diandian.com/?tag=hibernate" title="hibernate" target="_blank">hibernate</a>
<a href="">喜欢</a> <a href="">热度 (4)</a></p>
<p><a href="">分享</a></p>
<p><a href=""></a>
<a href="http://libooy.diandian.com/" target="_blank">返回首页</a></p>
<p><a href=""></a>
<a href="http://libooy.diandian.com/post/2012-03-28/14606048" target="_blank">上一篇</a></p>
<p><a href="http://libooy.diandian.com/post/2012-03-26/18813130" target="_blank">下一篇</a></p>
<h3 id="-"><a href="&quot;关于&quot;">关于</a></h3>
<p>一天进步一点点！！！</p>
<h3 id="-">导航</h3>
<ul>
<li><a href="http://libooy.diandian.com/rss" target="_blank">RSS订阅</a></li>
<li><a href="http://libooy.diandian.com/random" target="_blank">随机文章</a></li>
<li><a href="http://libooy.diandian.com/archive" target="_blank">存档</a></li>
<li><a href="http://libooy.diandian.com/inbox" title="私信" target="_blank">私信</a></li>
<li><p><a href="http://libooy.diandian.com/submit" title="投稿" target="_blank">投稿</a></p>
<h3 id="-">页面</h3>
</li>
<li><p><a href="http://libooy.diandian.com/" target="_blank">首页</a></p>
</li>
<li><p>© <a href="http://libooy.diandian.com/" title="Li-boy 奋斗的蜗牛" target="_blank">Li-boy 奋斗的蜗牛</a></p>
</li>
<li>Powered by <a href="http://www.diandian.com/" title="点点网" target="_blank">点点</a></li>
<li>Themed by <a href="http://www.yiyifly.com/" title="舟遥遥以轻飏,风飘飘而吹衣" target="_blank">吹衣轻飏</a></li>
</ul>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/框架汇总/">框架汇总</a></li></span><span class="breadcrumb"><li><a href="/categories/框架汇总/">框架汇总</a></li><li><a href="/categories/框架汇总/ORM/">ORM</a></li><li><a href="/categories/框架汇总/ORM/hibernate/">hibernate</a></li></span></span> | <span class="tags">Tagged <a href="/tags/ORM/" class="label label-primary">ORM</a><a href="/tags/hibernate/" class="label label-success">hibernate</a><a href="/tags/框架汇总/" class="label label-info">框架汇总</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:29"datetime="2014-03-07 09:54:29"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-框架汇总-ORM-hibernate--Hibernate知识总结/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-框架汇总-ORM-hibernate--Hibernate知识总结" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-框架汇总-Spring--Spring-设计模式-aop-ioc/">Spring</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:29.000Z"> <a href="/2014/02/02/2014-02-02-框架汇总-Spring--Spring-设计模式-aop-ioc/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="spring-aop-ioc">Spring-设计模式-aop-ioc</h1>
<p><a href="http://www.goldendoc.org/" target="_blank">黄金档</a></p>
<p>路漫漫其修远兮，吾将上下而求索……</p>
<ul>
<li><a href="http://www.goldendoc.org/" title="首页" target="_blank">首页</a></li>
<li><a href="http://www.goldendoc.org/hire/" target="_blank">招聘</a></li>
<li><a href="http://www.goldendoc.org/about/" target="_blank">关于</a></li>
</ul>
<h1 id="spring">Spring</h1>
<h2 id="-spring-http-www-goldendoc-org-2010-12-spring_design_pattern-spring-"><a href="http://www.goldendoc.org/2010/12/spring_design_pattern/" title="永久链接：Spring中的设计模式" target="_blank">Spring中的设计模式</a></h2>
<p><a href="http://www.goldendoc.org/2010/12/spring_design_pattern/#comments" target="_blank">2</a></p>
<p>2年前</p>
<p>由<a href="http://www.goldendoc.org/author/jackey/" title="jackey发表的文章 " target="_blank">jackey</a>发布 在<a href="http://www.goldendoc.org/category/spring/" title="Spring (4主题)" target="_blank">Spring</a>
应该说设计模式是我们在写代码时候的一种被承认的较好的模式。好的设计模式就像是给代码造了一个很好的骨架，在这个骨架里，你可以知道心在哪里，肺在哪里，因为大多数人都认识这样的骨架，就有了很好的传播性。这是从易读和易传播来感知设计模式的好处。当然设计模式本身更重要的是设计原则的一种实现，比如开闭原则，依赖倒置原则，这些是在代码的修改和扩展上说事。说到底就是人类和代码发生关系的四种场合：阅读，修改，增加，删除。让每一种场合都比较舒服的话，就需要用设计模式。</p>
<p>下面来简单列举Spring中的设计模式：
<strong>1. 简单工厂</strong>
又叫做静态工厂方法（StaticFactory Method）模式，但不属于23种GOF设计模式之一。
简单工厂模式的实质是由一个工厂类根据传入的参数，动态决定应该创建哪一个产品类。
Spring中的BeanFactory就是简单工厂模式的体现，根据传入一个唯一的标识来获得Bean对象，但是否是在传入参数后创建还是传入参数前创建这个要根据具体情况来定。
<strong>2. 工厂方法（Factory Method）</strong>
定义一个用于创建对象的接口，让子类决定实例化哪一个类。Factory Method使一个类的实例化延迟到其子类。
Spring中的FactoryBean就是典型的工厂方法模式。如下图：
<a href="http://pic.yupoo.com/goldendoc/AFbYXQy8/cgvMF.jpg" target="_blank"><img src="" alt=""></a></p>
<p><strong>3. 单例（Singleton）</strong>
保证一个类仅有一个实例，并提供一个访问它的全局访问点。
Spring中的单例模式完成了后半句话，即提供了全局的访问点BeanFactory。但没有从构造器级别去控制单例，这是因为Spring管理的是是任意的Java对象。
<strong>4. 适配器（Adapter）</strong>
将一个类的接口转换成客户希望的另外一个接口。Adapter模式使得原本由于接口不兼容而不能一起工作的那些类可以一起工作。
Spring中在对于AOP的处理中有Adapter模式的例子，见如下图：
<a href="http://pic.yupoo.com/goldendoc/AFbYXG9r/yaKsE.jpg" target="_blank"><img src="" alt=""></a>
由于Advisor链需要的是MethodInterceptor对象，所以每一个Advisor中的Advice都要适配成对应的MethodInterceptor对象。
<strong>5.包装器（Decorator）</strong>
动态地给一个对象添加一些额外的职责。就增加功能来说，Decorator模式相比生成子类更为灵活。 <em>**</em></p>
<p><a href="http://pic.yupoo.com/goldendoc/AFbYXVzM/iEPst.jpg" target="_blank"><img src="" alt=""></a>
Spring中用到的包装器模式在类名上有两种表现：一种是类名中含有Wrapper，另一种是类名中含有Decorator。基本上都是动态地给一个对象添加一些额外的职责。
<strong>6. 代理（Proxy）</strong>
为其他对象提供一种代理以控制对这个对象的访问。
从结构上来看和Decorator模式类似，但Proxy是控制，更像是一种对功能的限制，而Decorator是增加职责。
<img src="" alt="">
Spring的Proxy模式在aop中有体现，比如JdkDynamicAopProxy和Cglib2AopProxy。
<strong>7.观察者（Observer）</strong>
定义对象间的一种一对多的依赖关系，当一个对象的状态发生改变时，所有依赖于它的对象都得到通知并被自动更新。
<a href="http://pic.yupoo.com/goldendoc/AFbYY79B/QRttX.jpg" target="_blank"><img src="" alt=""></a>
Spring中Observer模式常用的地方是listener的实现。如ApplicationListener。
<strong>8. 策略（Strategy）</strong>
定义一系列的算法，把它们一个个封装起来，并且使它们可相互替换。本模式使得算法可独立于使用它的客户而变化。
Spring中在实例化对象的时候用到Strategy模式，见如下图：
<a href="http://pic.yupoo.com/goldendoc/AFbYYjl6/c2IJb.jpg" target="_blank"><img src="" alt=""></a>
在SimpleInstantiationStrategy中有如下代码说明了策略模式的使用情况：
<a href="http://pic.yupoo.com/goldendoc/AFbYYecL/xJ2n1.jpg" target="_blank"><img src="" alt=""></a>
<strong>9.模板方法（Template Method）</strong>
定义一个操作中的算法的骨架，而将一些步骤延迟到子类中。Template Method使得子类可以不改变一个算法的结构即可重定义该算法的某些特定步骤。
<img src="" alt="">
Template Method模式一般是需要继承的。这里想要探讨另一种对Template Method的理解。Spring中的JdbcTemplate，在用这个类时并不想去继承这个类，因为这个类的方法太多，但是我们还是想用到JdbcTemplate已有的稳定的、公用的数据库连接，那么我们怎么办呢？我们可以把变化的东西抽出来作为一个参数传入JdbcTemplate的方法中。但是变化的东西是一段代码，而且这段代码会用到JdbcTemplate中的变量。怎么办？那我们就用回调对象吧。在这个回调对象中定义一个操纵JdbcTemplate中变量的方法，我们去实现这个方法，就把变化的东西集中到这里了。然后我们再传入这个回调对象到JdbcTemplate，从而完成了调用。这可能是Template Method不需要继承的另一种实现方式吧。</p>
<p>以下是一个具体的例子：
JdbcTemplate中的execute方法：</p>
<p><a href="http://pic.yupoo.com/goldendoc/AFbYXJ1i/Gqxeo.jpg" target="_blank"><img src="" alt=""></a>
JdbcTemplate执行execute方法：
<a href="http://pic.yupoo.com/goldendoc/AFbYYoCZ/coCXA.jpg" target="_blank"><img src="" alt=""></a></p>
<p><a href="http://www.goldendoc.org/tag/%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f/" title="设计模式 (1主题)" target="_blank">设计模式</a></p>
<h2 id="-spring-aop-http-www-goldendoc-org-2010-12-spring_aop-spring-aop-"><a href="http://www.goldendoc.org/2010/12/spring_aop/" title="永久链接：Spring AOP介绍及源码分析" target="_blank">Spring AOP介绍及源码分析</a></h2>
<p><a href="http://www.goldendoc.org/2010/12/spring_aop/#comments" target="_blank">3</a></p>
<p>2年前</p>
<p>由<a href="http://www.goldendoc.org/author/lwei/" title="lwei发表的文章 " target="_blank">lwei</a>发布 在<a href="http://www.goldendoc.org/category/spring/" title="Spring (4主题)" target="_blank">Spring</a>
软件开发经历了从汇编语言到高级语言和从过程化编程到面向对象编程；前者是为了提高开发效率，而后者则使用了归纳法，把具有共性的东西进行归类并使之模块化，达到便于维护和扩展的目的；如果说面向对象编程可以对业务需求进行很好的分解使之模块化；那么面向切面编程AOP（Aspect-Oriented Programming）则可以对系统需求进行很好的模软件开发经历了从汇编语言到高级语言和从过程化编程到面向对象编程；前者是为了提高开发效率，而后者则使用了归纳法，把具有共性的东西进行归类并使之模块化，达到便于维护和扩展的目的；如果说面向对象编程可以对业务需求进行很好的分解使之模块化；那么面向切面编程AOP（Aspect-Oriented Programming）则可以对系统需求进行很好的模块组织，简化系统需求和实现之间的对比关系，是对OOP思想的一种补充；块组织，简化系统需求和实现之间的对比关系，是对OOP思想的一种补充；</p>
<p><strong>一、AOP介绍
</strong></p>
<p>举个例子来说明一下吧！现在系统中有很多的业务方法，如上传产品信息、修改产品信息、发布公司库等；现在需要对这些方法的执行做性能监控，看每个业务方法的执行时间；在不改变原业务代码的基础上，也许我们会这么做：</p>
<p><strong>Offer接口：
</strong></p>
<p><img src="" alt=""></p>
<p><strong>Offer实现：
</strong></p>
<p><img src="" alt=""></p>
<p><strong>Offer代理：
</strong></p>
<p><img src="" alt=""></p>
<p>我们要通过下面的方式来使用：</p>
<p><img src="" alt=""></p>
<p>上面的例子的输出为：</p>
<p><img src="" alt=""></p>
<p>上面的例子中，OfferProxy实现了IOffer，而所有的业务实现均委托给其成员offer；可以想像，这应该就是最简单的AOP的实现了；但这种方式会存在一个问题：如果有非常多的这种业务对象需要性能监控，我们就需要写同样多的XyzProxy来满足需求，这也是非常巨大的工作量。</p>
<p>上面说到了代理，我们先看看代理模式吧！</p>
<p><strong>二、代理模式及实现
</strong></p>
<p>下面是代理模式的类图：</p>
<p><img src="" alt=""></p>
<p>代理模式类图</p>
<p>代理模式中，存在一个称为ProxyObject的代理对象和RealObject的真实对象，它们都实现了相同的接口；在调用的地方持有ProxyObject的实例，当调用request()方法时，ProxyObject可以在执行RealObject.request()前后做一些特定的业务，甚至不调用RealObject.request()方法。</p>
<p>目前实现代理模式的方式有两种：基于JDK的动态代理和基于CGLIB字节码的代理。</p>
<p><strong>2.1 JDK动态代理
</strong></p>
<p>JDK动态代理，顾名思义，是基于JDK的反射(reflect)机制；在JDK中，提供了InvocationHandler这个接口，下面是JDK里面的注释：</p>
<p>InvocationHandler is the interface implemented by the invocation handler of a proxy instance.</p>
<p>Each proxy instance has an associated invocation handler. When a method is invoked on a proxy instance, the method invocation is encoded and dispatched to the invoke method of its invocation handler.</p>
<p>简单翻译，意思是说：该接口由被代理对象的handler所实现；当调用代理对象的方法时，该方法调用将被编码，然后交给代理对象的invoke方法去执行；</p>
<p>是不是有一种豁然开朗的感觉呢？没错，答案就在你心中。</p>
<p>这样，上面的代码就可以改成下面的实现方式：</p>
<p><img src="" alt=""><em>**</em></p>
<p><strong>调用端：
</strong></p>
<p><img src="" alt=""></p>
<p>通过这种方式，你不需要为针对每一个业务写一个代理对象，就可以很轻松地完成你的需求；但也许你已经注意到了，JDK的动态代理，在创建代理对象(上面红色代码部分)时，被代理的对象需要实现接口(即面向接口编程)；</p>
<p>这就是JDK的动态代理，简单吧！下面看看CGLIB代理方式。</p>
<p><strong>2.2 CGLIB代理
</strong></p>
<p>如果目标对象没有实现任何接口，那怎么办呢？不用担心，你可以用CGLIB来实现代理：</p>
<p><img src="" alt=""></p>
<p><strong>调用端：
</strong></p>
<p><img src="" alt=""></p>
<p>使用CGLIB创建的代理对象，其实就是继承了要代理的目标类，然后对目标类中所有非final方法进行覆盖，但在覆盖方法时会添加一些拦截代码(上面CglibProxyFactory类中的intercept方法)。</p>
<p>下面看看Spring中是如何实现AOP的。</p>
<p><strong>三、Spring AOP的实现
</strong></p>
<p><strong>3.1 Spring AOP的几个概念
</strong></p>
<p>Spring AOP中的几个基本概念，每次学习AOP都被这几个概念折腾的很不爽，我们在这里再把这几个概念描述一遍，力争把这几个概念搞清，在每次review这块内容的时候可以很快上手。</p>
<ol>
<li>切面(Aspect)：切面就是一个关注点的模块化，如事务管理、日志管理、权限管理等；</li>
<li>连接点(Joinpoint)：程序执行时的某个特定的点，在Spring中就是一个方法的执行；</li>
<li>通知(Advice)：通知就是在切面的某个连接点上执行的操作，也就是事务管理、日志管理等；</li>
<li>切入点(Pointcut)：切入点就是描述某一类选定的连接点，也就是指定某一类要织入通知的方法；</li>
<li>目标对象(Target)：就是被AOP动态代理的目标对象；</li>
</ol>
<p>用一张图来形象地表达AOP的概念及其关系如下：</p>
<p><img src="" alt=""></p>
<p><strong>3.2 Spring AOP中切入点、通知、切面的实现
</strong></p>
<p>理解了上面的几个概念后，我们分别来看看Spring AOP是如何实现这些概念的；</p>
<ol>
<li>切入点(Pointcut)：它定义了哪些连接点需要被织入横切逻辑；在Java中，连接点对应哪些类(接口)的方法。因此，我们都能猜到，所谓的切入点，就是定义了匹配哪些娄的哪些方法的一些规则，可以是静态的基于类(方法)名的值匹配，也可以是基于正则表达式的模式匹配。来看看Spring AOP Pointcut相关的类图：</li>
</ol>
<p><img src="" alt=""></p>
<p>在Pointcut接口的定义中，也许你已经想到了，ClassFilter是类过滤器，它定义了哪些类名需要拦截；典型的两个实现类为<strong>TypePatternClassFilter</strong>和<strong>TrueClassFilter</strong>(所有类均匹配)；而MethodMatcher为方法匹配器，定义哪些方法需要拦截。</p>
<p>在上面的类图中：</p>
<ul>
<li>StaticMethodMatch与DynamicMethodMatch的区别是后者在运行时会依据方法的参数值进行匹配。</li>
<li>NameMatchMethodPointCut根据指定的mappedNames来匹配方法。</li>
<li>AbstractRegexpMethodPointCut根据正则表达式来匹配方法。</li>
</ul>
<ol>
<li>通知(Advice)：通知定义了具体的横切逻辑。在Spring中，存在两种类型的Advice，即per-class和per-instance的Advice。</li>
</ol>
<p>所谓per-class，即该类型的Advice只提供方法拦截，不会为目标对象保存任何状态或者添加新的特性，它也是我们最常见的Advice。下面是per-class的类图：</p>
<p><img src="" alt=""></p>
<ul>
<li>BeforeAdvice：在连接点前执行的横切逻辑。</li>
<li>AfterReturningAdvice：在连接点执行后，再执行横切逻辑。</li>
<li>AfterAdvice：一般由程序自己实现，当抛出异常后，执行横切逻辑。</li>
<li>AroundAdvice：Spring AOP中并没有提供这个接口，而是采用了AOP Alliance的MethodInteceptor接口；通过看AfterReturningAdvice的源码我们知道，它是不能更改连接点所在方法的返回值的(更改引用)；但使用的MethodInteceptor，所有的事情，都不在话下。</li>
</ul>
<p>在上面的类图中，还有两种类没有介绍，那就是/<em>/</em>/<em>AdviceAdapter和/</em>/<em>/</em>AdviceInteceptor，我们以AfterReturningAdviceInterceptor为例来说明：</p>
<p><img src="" alt=""></p>
<p>该类实现了MethodInterceptor和AfterAdvice接口，同时构造函数中还有一个AfterReturningAdvice实例的参数；这个类存在的作用是为了什么呢？对，没错，Spring AOP把所有的Advice都适配成了MethodInterceptor，统一的好处是方便后面横切逻辑的执行(参看下一节)，适配的工作即由/<em>/</em>/*AdviceAdapter完成；</p>
<p>哈哈，Spring AOP的代码也不过如此嘛：所谓的AfterReturningAdvice，通过适配成MethodInterceptor后，其实就是在invoke方法中，先执行目标对象的方法，再执行的AfterReturningAdvice所定义的横切逻辑。你现在明白它为什么不能修改返回值的引用了吧？</p>
<p>对于per-instance的Advice，目前只有一种实现，就是Introduction，使用的场景比较少，有兴趣的同学可以自己研究一下，呵呵！</p>
<ol>
<li>切面(Aspect)：在Spring中，Advisor就是切面；但与通常的Aspect不同的是，Advisor通常只有一个Pointcut和一个Advice，而Aspect则可以包含多个Pointcut和多个Advice，因此Advisor是一种特殊的Aspect。但，这已经够用了！</li>
</ol>
<p>接下来看下per-class Advisor的类图：</p>
<p><img src="" alt=""></p>
<p>其实没有什么好看的，前面已经说过，Advisor包含一个Pointcut和一个Advisor；在AbstractGenericPointcutAdvisor中，持有一个Advice的引用；下面的几个实现，均是针对前面提到的几种不同的Pointcut的实现。</p>
<p><strong>3.3 Spring AOP实现的基本线索
</strong></p>
<p>我们选择ProxyFactoryBean作为入口点和分析的开始。ProxyFactoryBean是在Spring IoC环境中，创建AOP应用的最底层方法，从中，可以看到一条实现AOP的基本线索。</p>
<p>所有的逻辑从以下的方法开始,我们主要针对单例的代理对象的生成：</p>
<p><img src="" alt=""></p>
<p>下面我们深入到SpringAOP核心代码的内部，看看代理对象的生成机制，拦截器横切逻辑以及织入的实现。</p>
<p><strong>3.4  代理对象的生成
</strong></p>
<p>对于getSingletonInstance()方法返回了什么，这就是代理对象如何产生的逻辑了，然我们须根溯源，看看传说中的proxy到底是如何一步一步的产生的。</p>
<p><img src="" alt=""></p>
<p>ProxyFactoryBean是AdvisedSupport的子类，Spring使用AopProxy接口把AOP代理的实现与框架的其他部分分离开来。在AdvisedSupport中通过这样的方式来得到AopProxy,当然这里需要得到AopProxyFactory的帮助 ，从JDK或者cglib中得到想要的代理对象：</p>
<p><img src="" alt=""></p>
<p>这个DefaultAopProxyFactory是Spring用来生成AopProxy的地方，它包含JDK和Cglib两种实现方式。让我接着往里面看：</p>
<p><img src="" alt=""></p>
<p>可以看到其中的代理对象可以由JDK或者Cglib来生成，JdkDynamicAopProxy类和Cglib2AopProxy都实现的是AopProxy的接口，我们进入JdkDynamicAopProxy实现中看看Proxy是怎样生成的：</p>
<p><img src="" alt=""></p>
<p>用Proxy包装target之后，通过ProxyFactoryBean得到对其方法的调用就被Proxy拦截了， ProxyFactoryBean的getObject()方法得到的实际上是一个Proxy了，target对象已经被封装了。对 ProxyFactoryBean这个工厂bean而言，其生产出来的对象是封装了目标对象的代理对象。</p>
<p><strong>3.5 拦截器的作用
</strong></p>
<p>前面分析了SpringAOP实现中得到Proxy对象的过程，接下来我们去探寻Spring AOP中拦截器链是怎样被调用的，也就是Proxy模式是怎样起作用的。
还记得在JdkDynamicAopProxy中生成Proxy对象的时候，有一句这样的代码吗？</p>
<p><strong>return</strong> Proxy.<em>newProxyInstance</em>(classLoader, proxiedInterfaces, <strong>this</strong>);<em>**</em></p>
<p>这里我们的JdkDynamicAopProxy实现了InvocationHandler这个接口，this参数对应的是InvocationHandler对象,也就是说当 Proxy对象的函数被调用的时候，InvocationHandler的invoke方法会被作为回调函数调用：</p>
<p><img src="" alt=""></p>
<p><img src="" alt=""></p>
<p>上面所说的目标对象方法的调用，是通过AopUtils的方法调用，使用反射机制来对目标对象的方法进行的：</p>
<p><img src="" alt=""></p>
<p>接下来，我们来看具体的ReflectiveMethodInvocation中proceed()方法的实现，也就是拦截器链的实现机制：</p>
<p><img src="" alt=""></p>
<p>从上面的分析我们看到了Spring AOP拦截机制的基本实现，比如Spring怎样得到Proxy，怎样利用JAVA Proxy以及反射机制对用户定义的拦截器链进行处理。</p>
<p><strong>3.6 织入的实现
</strong></p>
<p>在上面调用拦截器的时候，经过一系列的注册，适配的过程以后，拦截器在拦截的时候，会调用到预置好的一个通知适配器，设置通知拦截器，这是一系列Spring设计好为通知服务的类的一个，是最终完成通知拦截和实现的地方，例如对 MethodBeforeAdviceInterceptor的实现是这样的：</p>
<p><img src="" alt=""></p>
<p>可以看到通知适配器将advice适配成Interceptor以后，会调用advice的before方法去执行横切逻辑。这样就成功的完成了before通知的织入。</p>
<p><a href="http://www.goldendoc.org/tag/aop/" title="AOP (1主题)" target="_blank">AOP</a></p>
<h2 id="-spring-ioc-applicationcontext-http-www-goldendoc-org-2010-11-spring_ioc_applicationcontext-2-spring-ioc-applicationcontext-"><a href="http://www.goldendoc.org/2010/11/spring_ioc_applicationcontext-2/" title="永久链接：Spring IoC之ApplicationContext" target="_blank">Spring IoC之ApplicationContext</a></h2>
<p><a href="http://www.goldendoc.org/2010/11/spring_ioc_applicationcontext-2/#comments" target="_blank">0</a></p>
<p>2年前</p>
<p>由<a href="http://www.goldendoc.org/author/iwlh/" title="iwlh发表的文章 " target="_blank">iwlh</a>发布 在<a href="http://www.goldendoc.org/category/spring/" title="Spring (4主题)" target="_blank">Spring</a>
本章主要讲ApplicationContext接口对BeanFactory接口的扩展内容。BeanFactory接口主要围绕着bean和bean相关配置方式，没有关注应用环境的相关配置。ApplicationContext接口从BeanFactory接口派生而来，它与BeanFactory的对比如下图所示：</p>
<p>BeanFactory </p>
<p>ApplicationContext  Bean配置/实例化</p>
<p>Yes </p>
<p>Yes  自动装配BeanPostProcessor</p>
<p>No </p>
<p>Yes  自动装配BeanFactoryPostProcessor</p>
<p>No </p>
<p>Yes  国际化信息（MessageSources）支持</p>
<p>No </p>
<p>Yes  容器内部事件（ApplicationEvent）支持</p>
<p>No </p>
<p>Yes  多配置模块加载</p>
<p>No </p>
<p>Yes </p>
<p><strong>1、统一资源加载
</strong></p>
<p>Spring中提供了org.springframework.core.io.Resource接口作为所有资源的抽象。Spring中默认提供了一些Resource接口的实现类，如图所示：</p>
<p><img src="" alt=""></p>
<p>实现类命名上就可以看出对应的资源，比如ClassPathResource类是从java应用程序的ClassPath中加载相关资源等等。</p>
<p>Spring中使用ResourceLoader来查找和定位Resource资源。ResorceLoader接口类图如下所示：</p>
<p><img src="" alt=""></p>
<p>从上图可以看出，ApplicationContext接口继承自ResourceLoader接口。AbstractApplicationContext抽象类也继承自DefaultResourceLoader类，而且还拥有一个PathMatchingResourcePatternResolver属性字段，需要加载多个Resource时候，委派给PathMatchingResourcePatternResolver类加载即可。</p>
<p>回过来，让我们再看下DefaultResourceLoader中getResource方法的实现代码。</p>
<p><img src="" alt=""></p>
<p>可以看到getResource方法尝试了classPath、url方式加载资源。需要注意的是，该类不能加载相对路径或绝对路径下的资源（例如文件），如果需要加载绝对路径的资源，可以使用FileSystemResourceLoader对象。</p>
<p><strong>2、国际化信息支持
</strong></p>
<p>Java SE中已经有了国际化支持，也就是java.util.Locale和java.util.ResourceBundle。Spring在JavaSE的国际化支持上，进一步抽象了国际化信息的访问接口，提供了org.springframework.context.MessageSource接口，该接口提供一下方法：</p>
<p><img src="" alt=""></p>
<p>ApplicationContext也实现了MessageSource接口。当ApplicationContext初始化时，它会自动在容器中查找名称为”messageSource”的bean。如果找到，对上述方法的调用将被委托给该bean。否则ApplicationContext会在其父类中查找是否含有同名的bean。如果有，就把它作为MessageSource。如果它最终没有找到任何的消息源，一个空的StaticMessageSource将会被实例化，使它能够接受上述方法的调用。messageSource bean的配置实例如下：</p>
<p><img src="" alt=""></p>
<p>Spring提供了三种MessageSource的实现。即StaticMessageSource（提供简单实现，可通过编程方式添加信息条目，多用于测试，不应该用于正式的生产环境）、ResourceBundleMessageSource（基于标准的java.util.ResourceBundle而实现的MessageSource，对父类AbstractMessageSource进行扩展，提供对多个ResourceBundle的缓存以提高查询速度。是最常用的，可用于生产环境下的MessageSource）、ReloadableResourceBundleMessageSource（同样是基于标准的java.util.ResourceBundle而实现的MessageSource，通过cacheSeconds属性可以定期刷新并检查properties资源文件是否发生变化，并且通过ResourceLoader加载properties资源文件。）</p>
<p>另外，MessageSourceAware接口还能用于获取任何已定义的MessageSource引用。任何实现了MessageSourceAware接口的bean将在Spring容器初始化时候与MessageSource一同被注入。</p>
<p>MessageSource与ApplicationContext的类结构图如下所示：</p>
<p><img src="" alt=""></p>
<p><strong>3、Spring容器内部事件发布
</strong></p>
<p>ApplicationContext容器提供了容器内部事件发布功能，是继承自JavaSE标准自定义事件类而实现的。</p>
<p>JavaSE标准自定义事件结构不在此详细描述，一张图很直观的描述清楚：</p>
<p><img src="" alt=""></p>
<p>EventObject，为JavaSE提供的事件类型基类，任何自定义的事件都继承自该类，例如上图中右侧灰色的各个事件。Spring中提供了该接口的子类ApplicationEvent。</p>
<p>EventListener，为JavaSE提供的事件监听者接口，任何自定义的事件监听者都实现了该接口，如上图左侧的各个事件监听者。Spring中提供了该接口的子类ApplicationListener接口。</p>
<p>JavaSE中未提供事件发布者这一角色类， 由各个应用程序自行实现事件发布者这一角色。Spring中提供了ApplicationEventPublisher接口作为事件发布者，并且ApplicationContext实现了这个接口，担当起了事件发布者这一角色。但ApplicationContext在具体实现上有所差异，Spring提供了ApplicationEventMulticaster接口，负责管理ApplicationListener和发布ApplicationEvent。ApplicationContext会把相应的事件相关工作委派给ApplicationEventMulticaster接口实现类来做。类图如下所示：</p>
<p><img src="" alt=""></p>
<p>附上一张事件发布的时序图：</p>
<p><a href="http://pic.yupoo.com/goldendoc/AH0MxsWp/jBIbm.png" target="_blank"><img src="" alt=""></a></p>
<p><strong>4、多配置模块加载
</strong></p>
<p>现在的应用程序，一般都会把配置信息按照某些规则进行分割，将不同类型或关注点的配置项放置在不同的文件中。相对BeanFactory来说，ApplicationContext已经支持了加载多个配置文件。</p>
<p>ApplicationContext加载多个配置文件的方法有：</p>
<p>1) 数组方式</p>
<p>String[] locations = new String[]{ “conf/bean1.xml”,”conf/bean2.xml”, “conf/bean3.xml”};</p>
<p>ApplicationContext container = new FileSystemXmlApplicationContext(locations);</p>
<p>2) 通配符</p>
<p>ApplicationContext container = new FileSystemXmlApplicationContext(“conf//<em>/</em>//*.xml”);</p>
<p>3) ClassPathXmlApplicationContext特性</p>
<p>ApplicationContext ctx = new ClassPathXmlApplicationContext(new String[] {“services.xml”, “daos.xml”}, MessengerService.class);</p>
<p>该方法可以通过MessengerService类在ClassPath中的位置定位配置文件，而不用指定每个配置文件的完整路径名。</p>
<p><a href="http://www.goldendoc.org/tag/applicationcontext/" title="ApplicationContext (1主题)" target="_blank">ApplicationContext</a></p>
<h2 id="-spring-ioc-beanfactory-http-www-goldendoc-org-2010-11-spring-ioc-e4-b9-8bbeanfactory-spring-ioc-beanfactory-"><a href="http://www.goldendoc.org/2010/11/spring-ioc%e4%b9%8bbeanfactory/" title="永久链接：Spring IoC之BeanFactory" target="_blank">Spring IoC之BeanFactory</a></h2>
<p><a href="http://www.goldendoc.org/2010/11/spring-ioc%e4%b9%8bbeanfactory/#comments" target="_blank">0</a></p>
<p>2年前</p>
<p>由<a href="http://www.goldendoc.org/author/khotyn/" title="khotyn发表的文章 " target="_blank">khotyn</a>发布 在<a href="http://www.goldendoc.org/category/spring/" title="Spring (4主题)" target="_blank">Spring</a>
本文的内容为对Spring IoC容器实现的分析。</p>
<p>本文一共分为5个部分：</p>
<ul>
<li>第一部分简要讲述了IoC的概念</li>
<li>第二部分对Spring IoC容器中的主要类及其职责做一些了解</li>
<li>第三部分分析了Spring IoC容器的初始化过程</li>
<li>第四部分分析了从Spring IoC容器中获取Bean的过程</li>
<li>第五部分简要讲述了Spring IoC容器对Bean生命周期的管理。</li>
</ul>
<p>本文假设读者对以下的概念有所了解：IoC（控制反转），DI（依赖注入），Bean，并且读者有使用Spring IoC容器的经验。</p>
<p>约定：本文中所指的IoC容器没有特别说明均为Spring IoC容器</p>
<h3 id="-ioc-"><a href="">一、什么是</a><a href="">IoC</a><a href=""></a></h3>
<p><a href=""></a></p>
<p><a href="">IoC是Inversion of Control的缩写，中文的意思是控制反转，在IoC中，组件不需要去寻找它所依赖的对象，而是由IoC容器来负责将组件所依赖的对象通过Java Bean的Setter方法或者是构造函数等方式注入给组件。IoC的另一个名字是DI，即依赖注入，关于IoC和DI之间的关系以及关于IoC的更多内容，大家可以参考Wiki上的</a><a href="http://www.google.com/url?q=http%3A%2F%2Fzh.wikipedia.org%2Fzh%2F%E6%8E%A7%E5%88%B6%E5%8F%8D%E8%BD%AC&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGHDFZSBvJ9wlCDET_IgqV-4DVCzw">控制反转条目。
</a></p>
<p><a href="http://www.google.com/url?q=http%3A%2F%2Fzh.wikipedia.org%2Fzh%2F%E6%8E%A7%E5%88%B6%E5%8F%8D%E8%BD%AC&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGHDFZSBvJ9wlCDET_IgqV-4DVCzw">
</a></p>
<h3 id="-http-www-google-com-url-q-http-3a-2f-2fzh-wikipedia-org-2fzh-2f-e6-8e-a7-e5-88-b6-e5-8f-8d-e8-bd-ac-sa-d-sntz-1-usg-afqjcnghdfzsbvj9wlcdet_igqv-4dvczw-ioc-"><a href="http://www.google.com/url?q=http%3A%2F%2Fzh.wikipedia.org%2Fzh%2F%E6%8E%A7%E5%88%B6%E5%8F%8D%E8%BD%AC&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGHDFZSBvJ9wlCDET_IgqV-4DVCzw"></a>[二、IoC容器中的类主要类及其职责</h3>
<p>]()</p>
<p><a href="">
我们先来看下IoC容器的一个大概的类图：
</a></p>
<p><a href=""></a><a href="http://www.google.com/url?q=http%3A%2F%2Fpic.yupoo.com%2Fkhotyn%2F816909ab9c75%2Fji8tx5ue.jpg&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNEixIuYlet6oZmgnSPQy-ZxrCs4yA"><img src="" alt=""></a></p>
<p><a href="http://www.google.com/url?q=http%3A%2F%2Fpic.yupoo.com%2Fkhotyn%2F816909ab9c75%2Fji8tx5ue.jpg&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNEixIuYlet6oZmgnSPQy-ZxrCs4yA" target="_blank">点击查看大图</a></p>
<p>这张图中比较简单的展示了IoC容器中的各个类及其指责，我们需要重点把握几个接口的职责：</p>
<ul>
<li>BeanFactory：这个接口是整个IoC容器最底层的接口，定义了一组访问Bean容器的基本方法。一些其他的接口，比如ListableBeanFactory和ConfigurableBeanFactory，都是继承了BeanFactory，并添加了其他的方法来完成某些特别的功能（比如ConfigurableBeanFactory，顾名思义，这个接口的职责是让BeanFactory变得可配置，那么它就定义了一组可以配置BeanFactory的方法）。</li>
<li>AbstractBeanFactory：从名字可以看出，这个类是BeanFactory接口的一个抽象实现类，这个类本身实现的是ConfigurableBeanFactory，对ConfigurableBeanFactory以及BeanFactory中的方法提供了实现，并且提供了一些诸如单例缓存，别名等等功能。</li>
<li>SingletonBeanRegistry：定义了一组操作单例Bean的方法</li>
</ul>
<h3 id="-ioc-"><a href="">三、</a>[IoC容器的初始化</h3>
<p>]()<a href=""></a></p>
<p>[
使用过Spring的人都知道，我们都是在一份Bean配置文件中定义Bean，然后就可以通过BeanFactory的getBean()方法来获取Bean，那么我们就可以大致猜想到IoC容器的初始化工作大概就是将我们编写的Bean配置文件转换成IoC容器内部定义的用于放置Bean定义信息的数据结构，而这个数据结构就是BeanDefinition这个类。下面我们就来了解下这个转换过程是如何进行的。</p>
<p>我们通过实例化ClassPathXmlApplicationContext这个类来一步步来看其初始化的过程，简单地实例化ClassPathXmlApplicationContext的代码如下：</p>
<p><img src="" alt=""></p>
<p>这里我们传入一个beans.xml作为配置文件的路径去实例化一个ClassPathXmlApplicationContext。</p>
<p>首先我们还是来看下整个初始化过程的序列图：
]()</p>
<p><a href=""></a><a href="http://www.google.com/url?q=http%3A%2F%2Fpic.yupoo.com%2Fkhotyn%2F005389ab9c75%2Fogfhmraj.jpg&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHa07fld9fiZq1BzNzeljU3nfHFXQ"><img src="" alt=""></a></p>
<p><a href="http://www.google.com/url?q=http%3A%2F%2Fpic.yupoo.com%2Fkhotyn%2F005389ab9c75%2Fogfhmraj.jpg&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNHa07fld9fiZq1BzNzeljU3nfHFXQ" target="_blank">点击查看大图</a></p>
<p>这个图中涉及到的类或许有点吓人，且慢，下面我会慢慢带你了解整个过程。从序列图里面我们看到初始化过程首先调用了refresh()方法，后面调用到了AbstractXmlApplicationContext的loadBeanDefinitions方法，来看下这个方法的实现：</p>
<p><img src="" alt=""></p>
<p>这个方法将beanFactory（实现了BeanDefinitionRegistry接口，后续将通过这个接口将Bean定义信息注册到BeanFactory中去）传入new了一个XmlBeanDefinitionReader对象，然后将刚刚new出来的beanDefinitionReader传入调用loadBeanDefinitions方法，最终调用了XmlBeanDefinitionReader的loadBeanDefinitions(EncodedResource encodedResource)方法：</p>
<p><img src="" alt=""></p>
<p>这个方法获取了Bean配置文件的输入流，并且调用了doLoadBeanDefinitions方法，在这个方法里面，程序将输入流转换成Document对象，然后调用了下面这个方法：</p>
<p><img src="" alt=""></p>
<p>需要注意这个createReaderContext(resource)方法，创建这个方法的时候XmlBeanDefinitionReader将自己传入，以便在后面可以获取到它的Registry对象。最终DefaultBeanDefinitionDocumentReader将解析BeanDefinition的工作又交给了BeanDefinitionParserDelegate对象：</p>
<p><img src="" alt=""></p>
<p>从上面的方法中，我们可以看到BeanDefinitionParserDelegate对象解析出BeanDefinition后，就由BeanDefinitionRegistry来将BeanDefinition注册到BeanFactory中去了。</p>
<p>至此，整个BeanFactory就初始化完毕了，可能一大堆方法调来调去地早就把大家给调晕了，我们就来总结下初始化过程中设计到的几个主要的类以及它们的职责吧：</p>
<ul>
<li>XmlBeanDefinitionReader：读取定义Bean的XML文件并且将XML文件转成Document对象，交给BeanDefinitionDocuementReader再做解析。它持有一个BeanDefinitionRegistry对象，用于将BeanDefinition注册到BeanFactory中去。</li>
<li>XmlBeanDefinitionDocumentReader：取出Docuement对象内的各个元素并将这些元素交给BeanDefinitionParserDelegate来解析。</li>
<li>BeanDefinitionParserDelegate：用于解析Bean定义信息的代理类，负责一个Bean定义信息（可以看作是一个<bean></bean>标签对）解析成一个BeanDefinition对象。</li>
<li>BeanDefinitionRegister：负责将BeanDefinition注册到BeanFactory中去。</li>
</ul>
<h3 id="-ioc-bean-"><a href="">四、从</a><a href="">IoC容器中获取Bean</a><a href=""></a></h3>
<p><a href="">
用过Spring的人大概都知道，在Spring中，我们是通过调用BeanFactory的getBean()方法来取得我们所需要的Bean的，而getBean()方法的主要逻辑在AbstactBeanFactory的doGetBean()方法中。在Spring中，有单例Bean和原型Bean的区分，在从容器中获取Bean的时候，单例Bean和原型Bean有些不同，当第一次获取单例Bean的时候，整个过程和获取原型Bean几乎是一样的，都需要创建一个Bean，但是当第二次，第三次，……，获取同样的单例Bean的时候，容器就直接从单例缓存中获取Bean了，而不会再去像获取原型Bean一样一而再再而三地创建Bean了。这样我们这一节也主要从两个方面来讲，一个是获取原型Bean，第一次获取单例Bean的逻辑和这个类似，有特别的地方也会在这里顺带提到，二则是将从单例缓存中获取单例Bean的过程，首先我们来看获取原型Bean：
</a></p>
<h3 id="-4-1-bean"><a href=""></a>[4.1、获取原型Bean</h3>
<p>]()</p>
<p>[
正如前面所说，我们来看下AbstractBeanFactory的doGetBean()方法来了解获取原型Bean的整个过程。</p>
<p>在获取Bean的时候，无论这个Bean是单例的还是原型的，Spring都会尝试从单例缓存中获取Bean，但是当拿原型Bean的时候，这里显然是拿不到的，接下来程序就会根据BeanDefinition信息来判断要创建的Bean是不是原型Bean，如果是，则进入下面这段逻辑：</p>
<p><img src="" alt=""></p>
<p>程序在上图的（1）中的位置调用了beforePrototypeCreation方法，告诉容器当前的这个Bean正在创建中，来防止发生重复创建的情况。接下来，程序在（2）处调用了createBean方法来创建这个prototypeBean，最后，在（3）处，程序调用afterProtytypeCreation来告诉容器，这个Bean现在已经不再创建过程中了。</p>
<p>那么，让我们来关注下createBean这个方法里面干了些什么事情：</p>
<p><img src="" alt=""></p>
<p>在做了一堆准备工作后，程序就到了上面的这一段中，从代码中我们可以看出这个方法主要的功能为以下两点：</p>
<ul>
<li>调用resolveBeforeInstantiation方法，让BeanPostProcessor可以有机会给你返回一个代理类而不是原来的类，当后面我们看到Spring AOP代理类的生成的时候，就会看到这个方法的用处了。</li>
<li>调用doCreateBean()方法创建Bean</li>
</ul>
<p>我们再来看下doCreateBean方法：</p>
<p><img src="" alt=""></p>
<p>同样，这个方法里面也有两个主要的功能：</p>
<ul>
<li>一是调用createBeanInstance方法，创建一个Bean实例，在这个方法的内部，会调用BeanUtils的instantiateClass来实例化Bean，并把它包装成一个BeanWrapper</li>
<li>二是调用populateBean方法来将Bean依赖的属性设置进去。
]()</li>
</ul>
<h3 id="-4-2-bean"><a href=""></a>[4.2、创建单例Bean</h3>
<p>]()</p>
<p>[
整个获取原型Bean的过程大概就是这样样子，因为创建单例Bean和这个过程基本上是一样的，但是也有一些稍微不一样的地方，这里也稍微提到一下：</p>
<p><img src="" alt=""></p>
<p>创建单例Bean是通过调用getSingleton来实现的，这个方法传入一个beanName和一个ObjectFactory，这个ObjectFactory的getObject方法里面调用到了我们前面提到的createBean方法，所以我们看下getSingleton这个方法的实现：</p>
<p><img src="" alt=""></p>
<p>这个方法先尝试从singletonObjects中获取单例Bean，如果获取不到，则自己创建，同样，和创建原型Bean一样，在创建开始之前会调用beforeSingletonCreation方法来将beanName放到singletonsCurrentlyInCreation来告诉容器这个Bean已经在创建中了，在创建完成之后，会将BeanName从singletonsCurrentlyInCreation中删除掉。创建的过程是调用了传入的ObjectFactory的getObject方法，和创建原型Bean类似。在创建完成之后，还有一步addSingleton的操作，来讲单例放到单例缓存中去，看一下这个的实现：</p>
<p><img src="" alt=""></p>
<p>方法的逻辑非常简单：把创建出来的单例Bean放到singletonObjects中去，然后从singletonFactories和earlySingletonObjects中删除掉，最后在registeredSingletons里面再加入这个Bean，对于这里面用到的几个容器，我觉得有必要在这里描述一下其作用，要不然读者肯定是晕呼晕呼的：</p>
<ul>
<li>singletonObjects：用于保存BeanName和Bean实例之间的关系</li>
<li>singletonFactories：用于保存BeanName和创建Bean的工厂之间的关系</li>
<li>earlySingletonObjects：也是保存BeanName和Bean实例之间的关系，与singletonObjects的不同之处在于，当一个单例Bean被放到这里面去后，那么当Bean还在创建过程中，就可以通过getBean来拿到了，其目的是用来检测循环引用。</li>
<li>registeredSingletons：用来保存当前所有已注册的Bean
]()</li>
</ul>
<h3 id="-4-3-bean"><a href=""></a>[4.3、从单例缓存中获取单例Bean</h3>
<p>]()</p>
<p>[
单例在Spring的同一个容器内只会被创建一次，后续再获取Bean，就直接从单例缓存中获取了，我们来看下这一段过程，看下doGetBean里面调用的getSingleton方法：</p>
<p><img src="" alt=""></p>
<p>这个方法的逻辑也相对简单，先尝试从singletonObjects里面获取，如果获取不到再从earlySingletonObjects里面获取，如果再获取不到，再尝试从singletonFactories里面获取beanName对应的ObjectFactory，然后调用这个ObjectFactory的getObject来创建Bean，并放到earlySingletonObjects里面去，并且从singletonFacotories里面remove掉这个ObjectFactory。</p>
<h3 id="-ioc-bean-">六、IoC容器对Bean生命周期的管理</h3>
<p>Spring有一套Bean生命周期去管理Bean，值得注意的是，Spring只对非单例的Bean进行生命周期管理。关于Spring中Bean的生命周期，我们来看下一张老图：</p>
<p><img src="" alt=""></p>
<p>在上面这张图里面，我们看到有很多的生命周期方法，那么这些生命周期方法是在哪里调用的呢？在前面获取原型Bean的一节中，我们已经知道，Spring会先调用createBeanInstance方法来创建Bean实例，然后通过populateBean方法来设置Bean的属性，在调用这个方法之后，其实Spring还调用了一个initializeBean的方法，上图中我们看到的生命周期方法基本上都在这个方法里面调用：</p>
<p><img src="" alt=""></p>
<p>在这个方法里面：</p>
<ul>
<li>Spring首先调用了invokeAwareMethods来调用各个Aware方法，包括BeanNameAware，BeanClassLoaderAware和BeanFactoryAware</li>
<li>然后调用了所有BeanPostProcessor的postProcessBeforeInitialization方法</li>
<li>接着调用invokeInitMethods方法，里面包括调用afterPropertiesSet和自定义的init方法</li>
<li>最后调用了所有BeanPostProcessor的postProcessAfterInitialization方法</li>
</ul>
<p>在调用这些方法以后，我们的Bean才算是可以使用啦。至于生命周期的最后两个方法，是在容器销毁的时候来调用的。
]()<a href=""></a></p>
<p><a href=""></a></p>
<p><a href=""></a><a href="http://www.goldendoc.org/tag/beanfactory/" title="BeanFactory (1主题)">BeanFactory</a></p>
<p>*</p>
<ul>
<li><h3 id="-">分类</h3>
</li>
<li><p><a href="http://www.goldendoc.org/category/java-nio/" title="查看 Java NIO下的所有文章" target="_blank">Java NIO <strong>(9)</strong> Java NIO相关内容</a></p>
</li>
<li><a href="http://www.goldendoc.org/category/jms/" title="查看 JMS下的所有文章" target="_blank">JMS <strong>(3)</strong> Java Messaging Service</a></li>
<li><a href="http://www.goldendoc.org/category/juc/" title="查看 JUC下的所有文章" target="_blank">JUC <strong>(4)</strong></a></li>
<li><a href="http://www.goldendoc.org/category/jvm/" title="查看 JVM下的所有文章" target="_blank">JVM <strong>(8)</strong> Java Virtual Machine</a></li>
<li><a href="http://www.goldendoc.org/category/spring/" title="查看 Spring下的所有文章" target="_blank">Spring <strong>(4)</strong></a></li>
<li><a href="http://www.goldendoc.org/category/tomcat/" title="查看 Tomcat下的所有文章" target="_blank">Tomcat <strong>(7)</strong></a></li>
<li><a href="http://www.goldendoc.org/category/translation/" title="查看 翻译下的所有文章" target="_blank">翻译 <strong>(1)</strong></a></li>
<li><h3 id="-">最新评论</h3>
</li>
<li><p><a href="http://www.goldendoc.org/2012/01/optimization-barrier3/#comment-306" title="在 优化屏障（Optimization barrier）第三讲" target="_blank"><img src="" alt="熊猫家族">  熊猫家族 很详细，了解了很多 5个月前</a></p>
</li>
<li><a href="http://www.goldendoc.org/2011/06/juc_concurrenthashmap/#comment-304" title="在 Java并发编程之ConcurrentHashMap" target="_blank"><img src="" alt="聊聊并发（四）深入分析ConcurrentHashMap并发编程网 | 并发编程网">  聊聊并发（四）深入分析ConcurrentHashMap并发编程网 | 并发编程网 [...] Java并发编程之ConcurrentHashMap [...] 6个月前</a></li>
<li><a href="http://www.goldendoc.org/2011/06/juc_concurrenthashmap/#comment-301" title="在 Java并发编程之ConcurrentHashMap" target="_blank"><img src="" alt="Jun">  Jun for (HashEntry p = first; p != e; p = p.next) newFirst = new HashEntry(p.key, p.hash, […] 6个月前</a></li>
<li><a href="http://www.goldendoc.org/2011/06/juc_concurrenthashmap/#comment-294" title="在 Java并发编程之ConcurrentHashMap" target="_blank"><img src="" alt="khotyn">  khotyn 这里是我搞错了，已经纠正过来了，谢谢赵姐夫指正。 7个月前</a></li>
<li><a href="http://www.goldendoc.org/2011/06/juc_concurrenthashmap/#comment-293" title="在 Java并发编程之ConcurrentHashMap" target="_blank"><img src="" alt="老赵">  老赵 这里Segment的数量是不大于concurrentLevel的最大的2的指数 应该是“不小于concurrentLevel”的最小的2的指数吧。 7个月前</a>
<a href="&quot;显示下5个条目&quot;">显示更多</a></li>
<li><h3 id="-">最新文章</h3>
</li>
<li><p><a href="http://www.goldendoc.org/2013/01/parentdelegation/" title="从问题出发看双亲委派" target="_blank">从问题出发看双亲委派 (0)  同事A问了这样一个问题： <em>BootstrapClassLoader为什么能够加载用户自定义的类？</em> 当时我想到的是这样的场景： javaagent设置Boot-Class-Path，或者添加启动参数-Xbootclasspath、-Xbootclasspath/a […] 5个月前</a></p>
</li>
<li><a href="http://www.goldendoc.org/2012/07/somethings_i_ve_learnt_about_programming/" title="我学到的一些关于编程的事儿（翻译）" target="_blank">我学到的一些关于编程的事儿（翻译） (3) 原文地址：Some things I&#39;ve learnt about programming ---- By John Graham-Cumming 我已经从事编程 30 年了，用过的机器包括从现在看来很差的（基于 Z80 和 6502）到最新的，用过的语言包括 […] 11个月前</a></li>
<li><a href="http://www.goldendoc.org/2012/02/classloader-jvm/" title="ClassLoader与JVM" target="_blank">ClassLoader与JVM (0) <strong>一、ClassLoader与HotSpot</strong> 对JVM有所了解的人应该知道，类文件的格式是不能违背JVM规范的，而JVM自然会有解析类文件的工具ClassFileParser。 ClassFileParser由ClassFileStream/*构造，其实 […] 1年前</a></li>
<li><a href="http://www.goldendoc.org/2012/01/optimization-barrier3/" title="优化屏障（Optimization barrier）第三讲" target="_blank">优化屏障（Optimization barrier）第三讲 (1) 上一篇 优化屏障（Optimization barrier）第二讲 1. […] 1年前</a></li>
<li><a href="http://www.goldendoc.org/2012/01/optimization-barrier2/" title="优化屏障（Optimization barrier）第二讲" target="_blank">优化屏障（Optimization barrier）第二讲 (1) 上一篇 优化屏障（Optimization barrier）第一讲 1. gcc编译的大致过程 可以看到，gcc优化主要分两大部分:Tree优化和RTL(Register Transfer Language)优化； 前文所说的指令调度（Instruction […] 1年前</a>
<a href="&quot;显示下5个条目&quot;">显示更多</a></li>
<li><h3 id="-">友情链接</h3>
</li>
<li><p><a href="http://ifeve.com/" target="_blank">并发编程促进并发编程的研究和传播</a>
自豪地使用<a href="http://wordpress.org/" target="_blank">WordPress</a>，Mystique主题来自<a href="http://digitalnature.eu/" target="_blank">digitalnature</a> | <a href="http://www.goldendoc.org/feed/" target="_blank">RSS订阅</a>  <a href="">回到顶部</a></p>
</li>
</ul>
<p><a href=""> </a></p>
<p><a href=""> </a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/框架汇总/">框架汇总</a></li></span><span class="breadcrumb"><li><a href="/categories/框架汇总/">框架汇总</a></li><li><a href="/categories/框架汇总/Spring/">Spring</a></li></span></span> | <span class="tags">Tagged <a href="/tags/Spring/" class="label label-primary">Spring</a><a href="/tags/框架汇总/" class="label label-success">框架汇总</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:29"datetime="2014-03-07 09:54:29"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-框架汇总-Spring--Spring-设计模式-aop-ioc/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-框架汇总-Spring--Spring-设计模式-aop-ioc" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-架构师--大型的支付系统，如支付宝、财付通每天交易额都非常巨大，后系统是如何对账、风控的呢？/">大型的支付系统，如支付宝、财付通每天交易额都非常巨大，后系统是如何对账、风控的呢？</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:29.000Z"> <a href="/2014/02/02/2014-02-02-架构师--大型的支付系统，如支付宝、财付通每天交易额都非常巨大，后系统是如何对账、风控的呢？/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-">大型的支付系统，如支付宝、财付通每天交易额都非常巨大，后系统是如何对账、风控的呢？</h1>
<p><a href="http://www.zhihu.com/question/20091391" target="_blank">大型的支付系统，如支付宝、财付通每天交易额都非常巨大，后系统是如何对账、风控的呢？</a></p>
<p><a href="http://www.zhihu.com/people/tian-shun" target="_blank">天顺</a>，<strong>搞支付的，接受各类支付业务咨询</strong><a href="">收起</a></p>
<p><a href="http://www.zhihu.com/people/liao-yan-48" target="_blank">廖艳</a>、<a href="http://www.zhihu.com/people/morbred" target="_blank">张大维</a>、<a href="http://www.zhihu.com/people/ze-fang-tong-yun" title="泽芳铜芸" target="_blank">泽芳铜芸</a><a href="">等人赞同</a>
谢邀，不过我看到一楼答案50多票赞同后就不想写了。
提问是大型支付系统的风控和对账是如何实现的，答案却是从商户角度谈使用支付公司产品对账的体验。
不过，我今天看到@黄继新 也在其他问题中逆袭了一把，质疑了第一答案。所以我就先放在这里，如果赞同数超过35票，我就把我所做的支付结算系统相关业务经验分享给大家，否则就算啦~
另，暂时没有答案，欢迎折叠。
鉴于已经有30票了，看这样子超过35是没什么太大问题，由于内容众多，我先准备起来了
请大家稍安勿躁
------------------------------------------------------------扯淡的分割线----------------------------------------------------------
先扯淡一下对账，这坑有点大，容我慢慢填。刚刚打了半小时的草稿由于没保存，死机后被系统吃掉了……知乎貌似原来有自动保存功能的……去哪里了……
业务上，为何对账，对账的操作步骤等@詹世波已经说得很多了，我谈谈一些没涉及的。
为了可以更好地解释支付结算系统对账过程，我们先把业务从头到尾串起来描述一下场景，帮助大家理解：
一个可能得不能再可能的场景，请大家深刻理解里面每个角色做了什么，获取了哪些信息：
某日阳光灿烂，支付宝用户小明在淘宝上看中了暖脚器一只，价格100元。犹豫再三后小明使用支付宝网银完成了支付，支付宝显示支付成功，淘宝卖家通知他已发货，最近几日注意查收。
我们来看看这个过程中有几个相关方，分别做了什么。我语文不好，写得饶口，如果看不懂请多看几次：
<strong>小明：</strong>持卡人，消费者，淘宝和支付宝的注册会员，完成了支付动作，自己的银行账户资金减少，交易成功。
<strong>银行：</strong>收单银行，接受来自支付宝的名为“支付宝BBB”的100元订单，并引导持卡人小明支付成功，扣除小明银行卡账户余额后返回给支付宝成功通知，并告诉支付宝这笔交易在银行流水号为“银行CCC”
<strong>支付宝：</strong>支付公司，接收到淘宝发来的订单号为“淘宝AAA”的商户订单号，并形成支付系统唯一流水号：“支付宝BBB”发往银行系统。然后获得银行回复的支付成功信息，顺带银行流水号“银行CCC”
<strong>淘宝：</strong>我们支付公司称淘宝这类电商为商户，是支付系统的客户。淘宝向支付系统发送了一笔交易收单请求，金额为100，订单号为:“淘宝AAA”，支付系统最后反馈给淘宝这笔支付流水号为“支付BBB”
以上流程貌似大家都达到了预期效果，但实际上仍然还有一个问题：
对支付公司（支付宝）而言，虽然银行通知了它支付成功，但资金实际还要T+1后结算到它银行账户，所以目前只是一个信息流，资金流还没过来。
<strong>Tips:</strong>插一句话，对支付系统内部账务来说，由于资金没有能够实时到账，所以此时小明的这笔100元交易资金并没有直接记入到系统资产类科目下的“银行存款”科目中，而是挂在“应收账款”或者“待清算科目”中。大白话就是，这100元虽然答应给我了，我也记下来了，但还没收到，我挂在那里。
对商户（淘宝）而言，虽然支付公司通知了它支付成功，他也发货了，但资金按照合同也是T+1到账。如果不对账确认一下，恐怕也会不安。
倒是对消费者（小明）而言：反正钱付了，你们也显示成功了，等暖脚器呀等暖脚器~
基于支付公司和商户的困惑，我们的支付结算系统需要进行两件事情：一是资金渠道对账，通称对银行帐；二是商户对账，俗称对客户帐。对客户帐又分为对公客户和对私客户，通常对公客户会对对账文件格式、对账周期、系统对接方案有特殊需求，而对私客户也就是我们一般的消费者只需要可以后台查询交易记录和支付历史流水就可以了。
<strong>我们先聊银行资金渠道对账，由于支付公司的资金真正落地在商业银行，所以资金渠道的对账显得尤为重要。</strong>
在一个银行会计日结束后，银行系统会先进行自己内部扎帐，完成无误后进行数据的清分和资金的结算，将支付公司当日应入账的资金结算到支付公司账户中。于此同时，目前多数银行已经支持直接系统对接的方式发送对账文件。
于是，在某日临晨4点，支付宝系统收到来自银行发来的前一会计日对账文件。根据数据格式解析正确后和前日支付宝的所有交易数据进行匹配，理想情况是一一匹配成功无误，然后将这些交易的对账状态勾对为“已对账”。
<strong>Tips:</strong>此时，对账完成的交易，会将该笔资金从“应收账款”或者“待清算账款”科目中移动到“银行存款”科目中，以示该交易真正资金到账。
以上太理想了，都那么理想就不要对账了。所以通常都会出一些差错，那么我总结了一下常见的差错情况：
1.支付时提交到银行后没有反馈，但对账时该交易状态为支付成功
这种情况很正常，因为我们在信息传输过程中，难免会出现掉包和信息不通畅。消费者在银行端完成了支付行为，银行的通知信息却被堵塞了，如此支付公司也不知道结果，商户也不知道结果。如果信息一直没法通知到支付公司这边，那么这条支付结果就只能在日终对账文件中体现了。这时支付公司系统需要对这笔交易进行补单操作，将交易置为成功并完成记账规则，有必要还要通知到商户。
<strong>此时的小明：估计急的跳起来了……付了钱怎么不给说支付成功呢！坑爹！</strong>
<strong>TIPS：</strong>通常银行系统会开放一个支付结果查询接口。支付公司会对提交到银行但没有回复结果的交易进行间隔查询，以确保支付结果信息的实时传达。所以以上情况出现的概率已经很少了。
2.我方支付系统记录银行反馈支付成功，金额为100，银行对账金额不为100
这种情况已经不太常见了，差错不管是长款和短款都不是我们想要的结果。通常双方系统通讯都是可作为纠纷凭证的，如果银行在支付结果返回时确认是100元，对账时金额不一致，可以要求银行进行协调处理。而这笔账在支付系统中通常也会做对应的挂账处理，直到纠纷解决。
3.我方支付系统记录银行反馈支付成功，但对账文件中压根不存在
这种情况也经常见到，因为跨交易会计日的系统时间不同，所以会出现我们认为交易是23点59分完成的，银行认为是第二天凌晨0点1分完成。对于这种情况我们通常会继续挂账，直到再下一日的对账文件送达后进行对账匹配。
如果这笔交易一直没有找到，那么就和第二种情况一样，是一种短款，需要和银行追究。
以上情况针对的是一家银行资金渠道所作的流程，实际情况中，支付公司会在不同银行开立不同银行账户，用以收单结算（成本会降低），所以真实情况极有可能是：
临晨1点，工行对账文件丢过来（支行A）
临晨1点01分，工行又丢一个文件过来（支行B）
临晨1点15分，农行对账文件丢过来
。 。 。
临晨5点，兴业银行文件丢过来
。。。
不管什么时候，中国银行都必须通过我方业务员下载对账文件再上传的方式进行对账，所以系统接收到中行文件一般都是早上9点05分……
对系统来说，每天都要处理大量并发的对账数据，如果在交易高峰时段进行，会引起客户交互的延迟和交易的失败，这是万万行不得的
所以通常支付公司不会用那么傻的方式处理数据，而是在一个会计日结束后，通常也是临晨时段，将前一日交易增量备份到专用对账服务器中，在物理隔绝环境下进行统一的对账行为，杜绝硬件资源的抢占。
以上是银行资金渠道入款的对账，出款基本原理一致，不过出款渠道在实际业务过程中还有一些特别之处，由于大家不是要建设系统，我就不赘述了。
<strong>谈完了资金渠道的对账，我们再来看看对客户帐。</strong>
前面提到了，由于资金落在银行，所以对支付公司来说，对银行帐非常重要。那么同理，由于资金落在支付公司，所以对商户来说，对支付公司账也一样重要。能否提供高品质甚至定制化的服务，是目前支付公司走差异化路线的一个主要竞争点。
就流程而言@詹世波已经说的差不多了，我就不赘述了……
----------------------------------------------------------没经过排版的小知识点---------------------------------------------------
之前说过，银行与支付公司之间的通讯都是可以作为纠纷凭证的。原理是对支付报文的关键信息进行密钥加签+md5处理，以确保往来报文“<strong>不可篡改，不可抵赖</strong>”。
同理，支付公司和商户之间也会有类似机制保证报文的可追溯性，由此我们可以知道，一旦我方支付系统通知商户支付结果，那么我们就要为此承担责任。由此我们再推断一个结论：
<strong>即便某支付订单银行方面出错导致资金未能到账，一旦我们支付系统通知商户该笔交易成功，那么根据协议该结算的资金还是要结算给这个商户。自然，我们回去追究银行的问题，把账款追回。</strong>
----------------------------------------------------------没经过排版的小知识点---------------------------------------------------
一、对支付系统而言，最基本的对账功能是供商户在其后台查询下载某一时间段内的支付数据文件，以供商户自己进行对账。
这个功能应该是个支付公司就有，如果没有就别混了。
二、对大多数支付系统而言，目前已经可以做到对账文件的主动投送功能。
这个功能方便了商户系统和支付系统的对接，商户的结算人员无须登录支付平台后台下载文件进行对账，省去了人工操作的麻烦和风险。
对大型支付系统而言，商户如果跨时间区域很大，反复查询该区域内的数据并下载，会对服务器造成比较大的压力。各位看官别笑，觉得查个数据怎么就有压力了。实际上为了这个查询，我最早就职的一家支付公司重新优化了所有SQL语句，并且因为查询压力过大服务器瘫痪过好几次。
现在比较主流的做法是把商户短期内查询过、或者经常要查询的数据做缓存。实在不行就干脆实时备份，两分钟同步一次数据到专用数据库供商户查询，以避免硬件资源占用。甚至……大多数支付公司都会对查询范围跨度和历史事件进行限制，比如最多只能查一个月跨度内，不超过24个月前的数据……以避免服务嗝屁。
对账这块大致就这样了，再往细的说就说不完了，大家有什么想问的可以单M我或者回复答案。
稍后给大家讲一下风控。
-----------------------------------------------风控的分割线-------------------------------------------
风险控制，在各行各业都尤其重要。
金融即风险，控制好风险，才有利润。
虽然第三方支付严格意义上说并非属于金融行业，但由于涉及资金的清分和结算，业务主体又是资金的收付，所以风险控制一样非常重要。
对支付公司来说，风控主要分为合规政策风控以及交易风控两种。
前者主要针对特定业务开展，特定产品形态进行法规层面的风险规避，通常由公司法务和风控部门一起合作进行。例如，一家公司要开展第三方支付业务，现在要获得由人民银行颁发的“支付业务许可证”。遵守中国对于金融管制的所有条规，帮助人行监控洗钱行为……这些法规合规风险，虽然条条框框，甚至显得文绉绉，但如果没人解读没人公关，业务都会无法开展。
当然，这块也不是本题所关注的重点，提问者关注的，应当是业务进行过程中的交易风控环节。
现在随着各支付公司风险控制意识的加强，风控系统渐渐被重视起来。除了上述提到的合规风控相关功能，风控系统最讲技术含量，最讲业务水平，最考究数据分析的业务就是交易风控环节。
对一笔支付交易而言，在它发生之前、发生过程中及发生过程后，都会被风控系统严密监控，以确保支付及客户资产安全。而所有的所有秘密，都归结到一个词头上：规则。风控系统是一系列规则的集合，任何再智能的风控方案，都绕不开规则二字。
我们先看看，哪些情况是交易风控需要监控处理的：
1.钓鱼网站
什么是钓鱼呢？
用我的说法，就是利用技术手段蒙蔽消费者，当消费者想付款给A的时候，替换掉A的支付页面，将钱付给B，以达成非法占用资金的目的。
还有更低级的，直接就是发小广告，里面带一个类似<a href="http://tiaobao.com/" target="_blank"><a href="http://tiaobao.com">http://tiaobao.com</a></a>的网址，打开后和淘宝页面一摸一样，上当客户直接付款给假冒网站主。
第一种情况风控系统是可以通过规则进行简单判定的，虽然有误杀，但不会多。
通常使用的规则是判断提交订单的IP地址和银行实际支付完成的IP地址是否一致，如果不一致，则判断为钓鱼网站风险交易，进入待确认订单。
但第二种情况，亲爹亲娘了，支付公司真的没办法。当然遇到客户投诉后可能会事后补救，但交易是无法阻止了。
2.盗卡组织利用盗卡进行交易
大家都知道，信用卡信息是不能随便公布给别人的，国内大多信用卡虽然都设置了密码，但银行仍然会开放无磁无密支付接口给到商户进行快速支付之用。
所谓无磁无密，就是不需要磁道信息，不需要密码就可以进行支付的通道。只需要获取到客户的CVV，有效期，卡号三个核心信息，而这三个信息是在卡上直接有的，所以大家不要随便把卡交给别人哦~
碰到类似的这种交易，风控系统就不会像钓鱼网站这样简单判断了。
过去我们所有的历史交易，都会存库，不仅会存支付相关信息，更会利用网页上的控件（对，恶心的activex或者目前用的比较多的flash控件）抓取支付者的硬件信息，存储在数据库中。
当一笔交易信息带着能够搜集到的硬件信息一同提交给风控系统时，风控系统会进行多种规则判定。
例如：当天该卡是否交易超过3次
当天该IP是否交易超过3次
该主机CPU的序列号是否在黑名单之列
等等等等，一批规则跑完后，风控系统会给该交易进行加权评分，标示其风险系数，然后根据评分给出处理结果。
通过硬件信息采集以及历史交易记录回溯，我们可以建立很多交易风控规则来进行监控。所以规则样式的好坏，规则系数的调整，就是非常重要的用以区别风控系统档次高低的标准。
例如，我听说著名的风控厂商RED，有一个“神经网络”机制，灰常牛逼。
其中有一个规则我到现在还记忆犹新：
某人早上八点在加利福尼亚进行了信用卡支付，到了下午一点，他在东亚某小国家发起了信用卡支付申请。系统判断两者距离过长，不是短短5小时内能够到达的，故判定交易无效，支付请求拒绝。
规则非常重要，当然，数据也一样重要。我们不仅需要从自己的历史记录中整合数据，同时还要联合卡组织、银行、风控机构，购买他们的数据和风控服务用来增加自己的风控实力。
SO，风控是一个不断积累数据、分析数据、运营数据、积累数据的循环过程。
好的风控规则和参数，需要经过无数次的规则修改和调整，是一个漫长的过程。
不知道大家做互联网，有没有利用GA做过AB测试，同样的，风控系统也需要反复地做类似AB测试的实验，以保证理论和实际的匹配。
最后给大家说一个小小的概念：
所谓风控，是指风险控制，不是风险杜绝。
风控的目标一定不是把所有风险全部杜绝。
合理的风控，目标一定是：利润最大化，而不是风险最小化
过于严格的风控规则，反而会伤害公司利益（看看销售和风控经常打架就知道了）
不光是交易的风控，我们日常制定规则，法规，公司流程，也一定要秉着这个出发点进行规划。
以上，基本上差不多了，有问题大家随时留言评论我。
谢谢大家原谅我的傲娇，给我点了那么多票赞同，受之有愧。
最近（2013年7月）回头看了一下这个答案，感觉有一些描述不够精确，有一些语言不够精炼，思考着是不是重构一下这个答案……<a href=""></a></p>
<p><a href="http://www.zhihu.com/question/20091391/answer/15591658" target="_blank">2013-07-02</a><a href="">57 条评论</a><a href="">感谢</a><a href="">分享</a><a href="">收藏</a>•<a href="">没有帮助</a>•<a href="">举报</a></p>
<p><a href=""></a></p>
<p><a href=""></a><a href="http://www.zhihu.com/people/yangxi" title="杨希"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/yangxi" title="杨希" target="_blank">杨希</a></p>
<p>顺哥傲娇了……
2012-11-14<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a></p>
<p><a href=""></a><a href="http://www.zhihu.com/people/tian-shun" title="天顺"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/tian-shun" title="天顺" target="_blank">天顺</a>（作者）回复 <a href="http://www.zhihu.com/people/yangxi" title="杨希" target="_blank">杨希</a></p>
<p>啊，哈哈哈
2012-11-14<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a>
<a href=""></a><a href="http://www.zhihu.com/people/huwei-98" title="HuWei"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/huwei-98" title="HuWei" target="_blank">HuWei</a></p>
<p>所以，没有答案，哪来赞同，奇怪~
2012-11-15<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a></p>
<p><a href=""></a><a href="http://www.zhihu.com/people/renxue" title="renxue"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/renxue" title="renxue" target="_blank">renxue</a></p>
<p>我也觉得傲娇了 你写答案是为了得到赞同吗？
2012-11-15<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a>
<a href=""></a><a href="http://www.zhihu.com/people/du-bai-xing" title="度百行"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/du-bai-xing" title="度百行" target="_blank">度百行</a></p>
<p>赞成一下，期待更多专业的回答~
2012-11-15<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a></p>
<p><a href=""></a><a href="http://www.zhihu.com/people/tian-shun" title="天顺"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/tian-shun" title="天顺" target="_blank">天顺</a>（作者）回复 <a href="http://www.zhihu.com/people/renxue" title="renxue" target="_blank">renxue</a></p>
<p>不喜勿入，根据知乎规定，目前这个答案可点“没有帮助”。
如果一个需要写好久的答案实际上没什么人关注，那我觉得没必要花那么多精力分享。我写答案不是为了赞同，但也不希望浪费时间。如果只有一两个人关心，我完全可以通过IM工具随时回答他们问题。
2012-11-15<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>2</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a>
<a href=""></a><a href="http://www.zhihu.com/people/zhanshibo" title="詹世波"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/zhanshibo" title="詹世波" target="_blank">詹世波</a></p>
<p>哈哈，我也希望看到更切题的答案和回复，但一直没有出现，然后我就个人知道和了解的抛砖引玉了一把，希望引出更多的意见和答案，结果来了60多票.....
兄台莫恼哈，其实很多人都想了解支付结算系统相关业务，你就给大家科普一把嘛。
2012-11-15<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a></p>
<p><a href=""></a><a href="http://www.zhihu.com/people/zhanshibo" title="詹世波"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/zhanshibo" title="詹世波" target="_blank">詹世波</a></p>
<p>看了下<a href="http://www.zhihu.com/people/tian-shun" target="_blank">@天顺</a> 的资料，原来是盛付通的啊，哈哈，真正的专业人士啊，欢迎科普
2012-11-15<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a>
<a href=""></a><a href="http://www.zhihu.com/people/tian-shun" title="天顺"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/tian-shun" title="天顺" target="_blank">天顺</a>（作者）回复 <a href="http://www.zhihu.com/people/zhanshibo" title="詹世波" target="_blank">詹世波</a></p>
<p>哈哈，我不恼，分享原本应该就是快乐的，不过我性格如此，说话总是比较刺，您才不要见怪。
2012-11-15<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a></p>
<p><a href=""></a><img src="&quot;知乎用户&quot;" alt=""></p>
<p>知乎用户</p>
<p>自动保存系统只有在草稿状态的时候才有用。所以在改答案的时候，要么就定期保存，要么就先在本地写好了…………【惨痛教训……
2012-11-15<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a>
<a href=""></a><a href="http://www.zhihu.com/people/ban-ma" title="斑马"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/ban-ma" title="斑马" target="_blank">斑马</a></p>
<p><a href="http://www.zhihu.com/people/liu-chu-qiao" target="_blank">@刘楚桥</a>
2012-11-15<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a></p>
<p><a href=""></a><a href="http://www.zhihu.com/people/tian-shun" title="天顺"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/tian-shun" title="天顺" target="_blank">天顺</a>（作者）回复 知乎用户</p>
<p>相当惨痛……
2012-11-15<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a>
<a href=""></a><a href="http://www.zhihu.com/people/san-tian" title="三田"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/san-tian" title="三田" target="_blank">三田</a></p>
<p>想请教一下小明那个场景，如果小明用支付宝网银支付淘宝上的购物的话，我理解应该这样，
消费者：小明
收单机构：支付宝
商户：淘宝
发卡银行：网银银行
卡组织：银联
关于对账还真是门学问呢，看来要学的还真多。多谢。
2012-11-16<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a></p>
<p><a href=""></a><a href="http://www.zhihu.com/people/tian-shun" title="天顺"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/tian-shun" title="天顺" target="_blank">天顺</a>（作者）回复 <a href="http://www.zhihu.com/people/san-tian" title="三田" target="_blank">三田</a></p>
<p>这个过程就把卡组织剔除掉吧，便于沟通。实际上大多数支付公司网银也是直连银行，没有通过银联系统做资金清分。
2012-11-16<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a>
<a href=""></a><a href="http://www.zhihu.com/people/zhanshibo" title="詹世波"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/zhanshibo" title="詹世波" target="_blank">詹世波</a></p>
<p><a href="http://www.zhihu.com/people/tian-shun" target="_blank">@天顺</a> 同学讲下Paypal或信用卡对账吧，我之前搞对账的时候最怕弄的就是这块，到现在都还有点搞不清楚
2012-11-16<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a></p>
<p><a href=""></a><a href="http://www.zhihu.com/people/tian-shun" title="天顺"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/tian-shun" title="天顺" target="_blank">天顺</a>（作者）</p>
<p><a href="http://www.zhihu.com/people/zhanshibo" target="_blank">@詹世波</a> 原本我的博客里把外卡相关的东西全给介绍了，无奈后来服务器没续费，报废了，又没保存……这些玩意写起来要命，关注的人又不多……所以我后来就越来越懒得写了，哈哈
2012-11-16<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a>
<a href=""></a><a href="http://www.zhihu.com/people/shi-wei-89-73" title="时伟"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/shi-wei-89-73" title="时伟" target="_blank">时伟</a></p>
<p>我怎么觉得，最后一句才是重点。。
2012-11-16<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a></p>
<p><a href=""></a><a href="http://www.zhihu.com/people/mi-su" title="米苏"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/mi-su" title="米苏" target="_blank">米苏</a></p>
<p>其实对账文件的收发，勾兑，差错处理基本上来说，已经可以实现系统自动化处理了。对于商户B2C平台、支付平台、自连银行之间由于扎差时间或系统时间不同产生的差异，才是对账处理最麻烦的地方
2012-11-16<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a>
<a href=""></a><a href="http://www.zhihu.com/people/iris-chen" title="Iris Chen"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/iris-chen" title="Iris Chen" target="_blank">Iris Chen</a></p>
<p>对账终于理顺了，等待风控的描述。
2012-11-17<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a></p>
<p><a href=""></a><a href="http://www.zhihu.com/people/he-jian-liang" title="何建亮"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/he-jian-liang" title="何建亮" target="_blank">何建亮</a></p>
<p>why 35?
2012-11-20<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a>
<a href=""></a><a href="http://www.zhihu.com/people/tian-shun" title="天顺"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/tian-shun" title="天顺" target="_blank">天顺</a>（作者）回复 <a href="http://www.zhihu.com/people/he-jian-liang" title="何建亮" target="_blank">何建亮</a></p>
<p>随便说个数字，哈哈~有点人数关注，写了才有意义呀
2012-11-21<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a></p>
<p><a href=""></a><a href="http://www.zhihu.com/people/lu-yao-21" title="璐瑶"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/lu-yao-21" title="璐瑶" target="_blank">璐瑶</a></p>
<p>“通常使用的规则是判断提交订单的IP地址和银行实际支付完成的IP地址是否一致，如果不一致，则判断为钓鱼网站风险交易，进入待确认订单。”
弱弱的问下，提交订单跟完成支付不都是用户行为么，为什么IP不一致会认定为钓鱼网站呢？
2012-11-28<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a>
<a href=""></a><a href="http://www.zhihu.com/people/tian-shun" title="天顺"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/tian-shun" title="天顺" target="_blank">天顺</a>（作者）回复 <a href="http://www.zhihu.com/people/lu-yao-21" title="璐瑶" target="_blank">璐瑶</a></p>
<p>完整支付行为的是用户，而发起订单的是钓鱼网站，两者IP不匹配。
2012-11-28<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a></p>
<p><a href=""></a><a href="http://www.zhihu.com/people/lu-yao-21" title="璐瑶"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/lu-yao-21" title="璐瑶" target="_blank">璐瑶</a>回复 <a href="http://www.zhihu.com/people/tian-shun" title="天顺" target="_blank">天顺</a>（作者）</p>
<p>呵呵，了解了，非常感谢～
2012-11-30<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a>
<a href=""></a><a href="http://www.zhihu.com/people/jixin" title="黄继新"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/jixin" title="黄继新" target="_blank">黄继新</a></p>
<p>恭喜天顺逆袭成功！要相信知乎社区的力量〜
2012-12-05<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a></p>
<p><a href=""></a><a href="http://www.zhihu.com/people/tian-shun" title="天顺"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/tian-shun" title="天顺" target="_blank">天顺</a>（作者）回复 <a href="http://www.zhihu.com/people/jixin" title="黄继新" target="_blank">黄继新</a></p>
<p>感谢继新赐予我力量！
2012-12-05<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a>
<a href=""></a><a href="http://www.zhihu.com/people/tujian" title="柏拉图"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/tujian" title="柏拉图" target="_blank">柏拉图</a></p>
<p>辛苦了。码字哈多。<a href="http://www.zhihu.com/people/tian-shun" target="_blank">@天顺</a> 这个才是在支付公司应该学的东西。
2012-12-05<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a></p>
<p><a href=""></a><a href="http://www.zhihu.com/people/tian-shun" title="天顺"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/tian-shun" title="天顺" target="_blank">天顺</a>（作者）回复 <a href="http://www.zhihu.com/people/tujian" title="柏拉图" target="_blank">柏拉图</a></p>
<p>这只是系统建设层面小小的经验，其实要做支付，还有很多很多……都不知从何说起。
2012-12-05<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a>
<a href=""></a><a href="http://www.zhihu.com/people/jia-peng" title="贾鹏"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/jia-peng" title="贾鹏" target="_blank">贾鹏</a></p>
<p>天顺儿，这篇文章第一部分，有小明、银行、支付宝、淘宝的角色，在“银行”的角色里应该是“发卡行”而不是“收单行”吧，因为支付宝本身就处理收单工作了
2012-12-05<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a></p>
<p><a href=""></a><a href="http://www.zhihu.com/people/tian-shun" title="天顺"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/tian-shun" title="天顺" target="_blank">天顺</a>（作者）回复 <a href="http://www.zhihu.com/people/jia-peng" title="贾鹏" target="_blank">贾鹏</a></p>
<p>线上网银渠道，发卡行就是收单行，不太会有银行作为收单行替其他行收单。外卡除外。
2012-12-05<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a>
<a href=""></a><a href="http://www.zhihu.com/people/jia-peng" title="贾鹏"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/jia-peng" title="贾鹏" target="_blank">贾鹏</a>回复 <a href="http://www.zhihu.com/people/tian-shun" title="天顺" target="_blank">天顺</a>（作者）</p>
<p>哈，在银联在线支付里，就有收单和发卡之分
2012-12-05<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a></p>
<p><a href=""></a><a href="http://www.zhihu.com/people/tian-shun" title="天顺"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/tian-shun" title="天顺" target="_blank">天顺</a>（作者）</p>
<p>不太明白你所说的究竟为何……
2012-12-05<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a>
<a href=""></a><a href="http://www.zhihu.com/people/etsir" title="徐梁君"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/etsir" title="徐梁君" target="_blank">徐梁君</a>回复 <a href="http://www.zhihu.com/people/tian-shun" title="天顺" target="_blank">天顺</a>（作者）</p>
<p><a href="http://www.zhihu.com/people/jia-peng" target="_blank">@贾鹏</a> 第三方支付裏面，其實無所謂發卡、收單角色。如果一定要套用，的確銀行作爲發卡銀行來描述比較準確。<a href="http://www.zhihu.com/people/tian-shun" target="_blank">@天顺</a> 文中的描述有誤。
2012-12-05<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a></p>
<p><a href=""></a><a href="http://www.zhihu.com/people/tian-shun" title="天顺"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/tian-shun" title="天顺" target="_blank">天顺</a>（作者）回复 <a href="http://www.zhihu.com/people/etsir" title="徐梁君" target="_blank">徐梁君</a></p>
<p>对第三方支付公司而言，所有收单银行渠道，即是他的收单行。
对收单行来说，第三方支付公司是收单商户。对第三方支付而言，收单银行即是收单行。
什么情况下需要区分发卡行和收单行？
也就是收单渠道不仅支持本行银行卡收单，同时支持他行卡收单时，会区分发卡行和收单行。
在互联网上，通常对第三方支付而言，无所谓区分发卡行和收单行，原因是事实上互联网支付基本都是本银行卡走本银行渠道，也就是线下POS所称的“本代本”。试问自己发的卡自己收单，又何必计较收单和发卡呢？
线下POS、外卡支付之所以要区分发卡行收单行，是因为其资金渠道特殊性所致。例如：通过银联清分网络，招行的POS机也可以刷工行的卡，然后通过银联进行数据清分，走跨行的资金清算轧张。
但互联网渠道，网银支付，99.99%的第三方支付渠道都是一家一家银行系统对接，对第三方支付的商户来说，第三方支付公司是收单机构；对持卡人来说，他所持信用卡的所在银行是发卡行；对第三方支付公司来说，前面是商户，后面是收单行，仅此而已。
当然，外卡的渠道和国内不同，将来可以单开一个专题去讨论。
2012-12-05<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a>
<a href=""></a><a href="http://www.zhihu.com/people/baiya" title="白鸦"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/baiya" title="白鸦" target="_blank">白鸦</a></p>
<p>画图吧。这事儿文字太难说清楚了
2012-12-06<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a></p>
<p><a href=""></a><a href="http://www.zhihu.com/people/jia-peng" title="贾鹏"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/jia-peng" title="贾鹏" target="_blank">贾鹏</a>回复 <a href="http://www.zhihu.com/people/tian-shun" title="天顺" target="_blank">天顺</a>（作者）</p>
<p>你说的对
2012-12-06<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a>
<a href=""></a><a href="http://www.zhihu.com/people/etsir" title="徐梁君"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/etsir" title="徐梁君" target="_blank">徐梁君</a>回复 <a href="http://www.zhihu.com/people/tian-shun" title="天顺" target="_blank">天顺</a>（作者）</p>
<p>你说的都对，我之前的表述也是同一个意思，但是有一点：第三方模式下，银行对持卡人来说是发卡行，对第三方来说才是收单行。所以要看文中描述时的主语是谁
2012-12-06<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a></p>
<p><a href=""></a><a href="http://www.zhihu.com/people/tian-shun" title="天顺"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/tian-shun" title="天顺" target="_blank">天顺</a>（作者）回复 <a href="http://www.zhihu.com/people/etsir" title="徐梁君" target="_blank">徐梁君</a></p>
<p>在网银支付过程中，持卡人无所谓发卡行和收单行概念，他只需要知道商户需要收钱，钱付给了支付宝即可。收单银行只对第三方支付机构有意义，何况从头至尾，基本都是站在第三方支付的角度看待问题，我觉得兄台无需在这个称呼上继续纠结了。
2012-12-06<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a>
<a href=""></a><a href="http://www.zhihu.com/people/wu-jing-qi" title="吴婧婍"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/wu-jing-qi" title="吴婧婍" target="_blank">吴婧婍</a></p>
<p>对于后来者，这个答案确实和日常工作非常接近，学习了！
2012-12-07<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a></p>
<p><a href=""></a><a href="http://www.zhihu.com/people/tedeyang" title="宝术"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/tedeyang" title="宝术" target="_blank">宝术</a></p>
<p>「银行丢个文件」银行确实只会丢文件
2012-12-27<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a>
<a href=""></a><img src="&quot;知乎用户&quot;" alt=""></p>
<p>知乎用户</p>
<p>那家风控企业应该是ReD（Retail Decisions），但是我看到首先想到的是Red Bend，好容易混淆。
2013-04-19<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a></p>
<p><a href=""></a><a href="http://www.zhihu.com/people/chen-song-53" title="陈嵩"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/chen-song-53" title="陈嵩" target="_blank">陈嵩</a></p>
<p>所以，广义范围内“出纳”
2013-06-22<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a>
<a href=""></a><a href="http://www.zhihu.com/people/eddy07" title="Eddy"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/eddy07" title="Eddy" target="_blank">Eddy</a></p>
<p>咨询个问题：刚看到一些关于三方那个支付机构的法规,三方支付机构必须将资金托管在一个银行，而你在这里写到三方支付公司基本上在每个银行都会有一个账户。那么这个银行账户和托管银行的资金交接是怎么一个过程呢？
2013-06-23<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a></p>
<p><a href=""></a><a href="http://www.zhihu.com/people/lukenothing" title="luke luke"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/lukenothing" title="luke luke" target="_blank">luke luke</a></p>
<p>请问，“支付BBB”与“支付宝BBB”是不是一样的？
2013-06-24<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a>
<a href=""></a><a href="http://www.zhihu.com/people/tian-shun" title="天顺"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/tian-shun" title="天顺" target="_blank">天顺</a>（作者）回复 <a href="http://www.zhihu.com/people/lukenothing" title="luke luke" target="_blank">luke luke</a></p>
<p>恩，一样的。
2013-06-24<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>1</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a></p>
<p><a href=""></a><a href="http://www.zhihu.com/people/tian-shun" title="天顺"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/tian-shun" title="天顺" target="_blank">天顺</a>（作者）回复 <a href="http://www.zhihu.com/people/eddy07" title="Eddy" target="_blank">Eddy</a></p>
<p>私信回了。
2013-06-24<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a>
<a href=""></a><a href="http://www.zhihu.com/people/roy-xie" title="Roy.Xie"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/roy-xie" title="Roy.Xie" target="_blank">Roy.Xie</a>回复 <a href="http://www.zhihu.com/people/tian-shun" title="天顺" target="_blank">天顺</a>（作者）</p>
<p>天顺 老兄厉害，长知识了。听君一席话，胜读10年书。
2013-06-27<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a></p>
<p><a href=""></a><a href="http://www.zhihu.com/people/yituo-xiao-xin" title="一坨小欣"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/yituo-xiao-xin" title="一坨小欣" target="_blank">一坨小欣</a></p>
<p>举手提问：顺哥写的好清晰，但是还有几个小问题请教：
1.既然支付公司会在各家银行都开账户，那客户支付的款项不是可以立刻到账么?为什么是T+1日？（我知道这是个小问题，跟主题没啥子关系，囧。。。）
2.是否有人通过支付系统进行洗钱？现在有把反洗钱纳入风控范畴么？
3.风控预警的效率高不高?会不会有很多误判？（银行从业人员表示，我们的预警量实在是忒多了= =!）
2013-07-08<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a>
<a href=""></a><a href="http://www.zhihu.com/people/tian-shun" title="天顺"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/tian-shun" title="天顺" target="_blank">天顺</a>（作者）回复 <a href="http://www.zhihu.com/people/yituo-xiao-xin" title="一坨小欣" target="_blank">一坨小欣</a></p>
<p>一个一个回答哈。
1.T+1日只是普遍情况，大多数银行的网银收单产品的确就是规定的T+1保证到款。当然据我所知已经有部分银行支持即时到账了，这个问题应该问银行，而不是支付公司。
2.有通过支付公司洗钱的，目前仍然有，甚至不少支付公司（不点名了）很多产品就是明着往灰色地带走的。当然，人民银行要求配合的反洗钱措施都会做的，商户审核也会相对走过场，不会太过分。
3.会有误判，这个避免不了，所以风控才是一门学问啊。
2013-07-08<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a></p>
<p><a href=""></a><a href="http://www.zhihu.com/people/chen-han-66" title="沈晗"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/chen-han-66" title="沈晗" target="_blank">沈晗</a></p>
<p>哥们你现在不搞技术，专心忽悠了吧，这么罗里吧嗦的解释最终细节部分却少的可怜。
2013-07-08<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a>
<a href=""></a><a href="http://www.zhihu.com/people/tian-shun" title="天顺"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/tian-shun" title="天顺" target="_blank">天顺</a>（作者）回复 <a href="http://www.zhihu.com/people/chen-han-66" title="沈晗" target="_blank">沈晗</a></p>
<p>哥们，不知道你现在是搞什么的，相信大家都会鼓励你来一篇细节部分多得令人发指的答案出来，我第一时间帮你点赞！
2013-07-08<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a></p>
<p><a href=""></a><a href="http://www.zhihu.com/people/min-you" title="闵游"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/min-you" title="闵游" target="_blank">闵游</a></p>
<p>作者好用心，还很谦逊，好人一个
2013-07-08<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a>
<a href=""></a><a href="http://www.zhihu.com/people/su-chi-chi" title="苏迟迟"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/su-chi-chi" title="苏迟迟" target="_blank">苏迟迟</a></p>
<p>请问支付宝公司账户上客户的资金，会用于购买短期的定期理财产品么？还是说，只是和银行谈一个比较高的利率，吃利息？
2013-07-08<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a></p>
<p><a href=""></a><a href="http://www.zhihu.com/people/tian-shun" title="天顺"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/tian-shun" title="天顺" target="_blank">天顺</a>（作者）回复 <a href="http://www.zhihu.com/people/su-chi-chi" title="苏迟迟" target="_blank">苏迟迟</a></p>
<p>八仙过海各显神通，呵呵。你说的方式其实都是可以的，主要看合作的商业银行内部如何帮你包装这个事情，单纯吃活期利息岂不亏死了……
2013-07-09<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a>
<a href=""></a><a href="http://www.zhihu.com/people/zhang-hong-wei-95" title="张宏伟"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/zhang-hong-wei-95" title="张宏伟" target="_blank">张宏伟</a></p>
<p>很有帮助
2013-07-09<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a></p>
<p><a href=""></a><a href="http://www.zhihu.com/people/hai-li-35" title="hai li"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/hai-li-35" title="hai li" target="_blank">hai li</a></p>
<p>不错
2013-07-09<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a>
<a href=""></a><a href="http://www.zhihu.com/people/ziming-shen" title="ziming shen"><img src="" alt=""></a></p>
<p><a href="http://www.zhihu.com/people/ziming-shen" title="ziming shen" target="_blank">ziming shen</a></p>
<h2 id="-">合理的风控，目标一定是：利润最大化，而不是风险最小化</h2>
<p>多希望公司那个213的风控能看到。
2013-07-09<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">回复</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">赞</a><em>0</em> 赞<a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">举报</a>
写下你的评论…</p>
<p><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">评论</a><a href="http://www.zhihu.com/question/20091391/answer/15591658#" target="_blank">取消</a>
只有作者关注的人才能在这里评论
知乎是一个真实的问答社区，在这里分享知识、经验和见解，发现更大的世界。
<a href="">使用邮箱注册 »</a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/架构师/">架构师</a></li></span></span> | <span class="tags">Tagged <a href="/tags/架构师/" class="label label-primary">架构师</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:29"datetime="2014-03-07 09:54:29"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-架构师--大型的支付系统，如支付宝、财付通每天交易额都非常巨大，后系统是如何对账、风控的呢？/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-架构师--大型的支付系统，如支付宝、财付通每天交易额都非常巨大，后系统是如何对账、风控的呢？" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-eclipse--Eclipse调优及使用小细节/">Eclipse 调优及使用小细节</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:29.000Z"> <a href="/2014/02/02/2014-02-02-eclipse--Eclipse调优及使用小细节/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="eclipse-">Eclipse 调优及使用小细节</h1>
<h3 id="eclipse-">Eclipse 调优及使用小细节</h3>
<p>下了个eclipse JUNO，界面有了很大改变，感觉更小清新了。不啰嗦了，直接上干货。</p>
<p>eclipse4.2的界面：</p>
<p> <img src="" alt="eclipse调优及使用小细节"></p>
<p>elicpse是我新装的，所以照着以前的内容一起实践了一下</p>
<p><strong>装插件，现在eclipse的插件安装很方便，从网上下载下来直接扔到dropin文件夹就行</strong></p>
<p>├─findbugs</p>
<p>├─jadeclipse</p>
<p>├─m2eclipse</p>
<p>├─site-1.8.7</p>
<p>├─spket-1.6.18</p>
<p>├─tomcat_3.3.0
findbug是很好用的一个代码检查工具</p>
<p>jad是用来反编译的工具
m2eclipse是mvn的一个插件工具</p>
<p>site是svn的插件工具
spket是用来搞extjs</p>
<p>tomcat顾名思义就是tomcat的集成工具
还有一个umlet是用来画uml图的工具</p>
<p><strong>调整内存和启动项</strong>
加大JVM非堆内存</p>
<p>-vmargs -Xms128M -Xmx512M -XX:PermSize=64M -XX:MaxPermSize=128M</p>
<p>A 各个参数的含义</p>
<p>JVM初始分配的内存由-Xms指定，默认是物理内存的1/64；</p>
<p>JVM最大分配的内存由-Xmx指定，默认是物理内存的1/4。默认空余堆内存小于40%时，JVM就会增大堆直到-Xmx的最大限制；空余堆内 存大于70%时，JVM会减少堆直到-Xms的最小限制。因此服务器一般设置-Xms、-Xmx相等以避免在每次GC 后调整堆的大小</p>
<p>JVM使用-XX:PermSize设置非堆内存初始值，默认是物理内存的1/64；由XX:MaxPermSize设置最大非堆内存的大小，默认是物理内存的1/4。</p>
<p>B  Eclipse.ini文件的配置</p>
<p>-vmargs</p>
<p>-Xms128M</p>
<p>-Xmx512M</p>
<p>-XX:PermSize=64M</p>
<p>-XX:MaxPermSize=128M</p>
<p>实际运行的结果可以通过Eclipse中“Help”-“About Eclipse SDK”窗口里面的“Configuration Details”按钮进行查看。
参考： <a href="http://hi.baidu.com/injava/item/9dee73d67f77fd94270ae777" target="_blank"><a href="http://hi.baidu.com/injava/item/9dee73d67f77fd94270ae777">http://hi.baidu.com/injava/item/9dee73d67f77fd94270ae777</a></a></p>
<hr>
<p><strong>取消不需要加载的模块及自动验证的配置文件</strong></p>
<p>一个系统20%的功能往往能够满足80%的需求，MyEclipse也不例外，我们在大多数时候只需要20%的系统功能，所以可以将一些不使用的模 块禁止加载启动。通过Windows - Preferences打开配置窗口，依次选择左侧的General - Startup and Shutdown，这个时候在右侧就显示出了Eclipse启动时加载的模块，可以根据自己的实际情况去除一些模块。</p>
<p>默认情况下MyEclipse在启动的时候会自动验证每个项目的配置文件，这是一个非常耗时的过程，可以在Preferences窗口依次选择 MyEclipse - Validation，然后在右侧的Validator列表中只保留 Manual 项就可以了。如果需要验证的时候只需要选中文件，然后右键选择 MyEclipse - Run Validation就可以了。</p>
<p><strong> eclipse设置自动提示</strong></p>
<p>默认是输入&quot;.&quot;后出现自动提示，用于类成员的自动提示，可是有时候我们希望它能在我们输入类的首字母后就出现自动提示，可以节省大量的输入时间（虽然按alt + /会出现提示，但还是要多按一次按键，太麻烦了）。</p>
<p> 从Window -&gt; preferences -&gt; Java -&gt; Editor -&gt; Content assist -&gt; Auto-Activation下，我们可以在&quot;.&quot;号后面加入我们需要自动提示的首字幕，比如&quot;ahiz&quot;。</p>
<p>然后我们回到Eclipse的开发环境，输入&quot;a&quot;，提示就出现了。但是我们可以发现，这个Auto-Activation下的输入框里最多只能输 入5个字母，也许是Eclipse的开发人员担心我们输入的太多会影响性能，但计算机的性能不用白不用，所以我们要打破这个限制。</p>
<p>在&quot;.&quot;后面随便输入几个字符，比如&quot;abij&quot;，然后回到开发环境，File -&gt; export -&gt; general -&gt; preferences -&gt; 选一个地方保存你的首选项，比如C:\a.epf</p>
<p>用任何文本编辑器打开a.epf，查找字符串“abij”，找到以后，替换成“abcdefghijklmnopqrstuvwxyz”，总之就是 你想怎样就怎样！！然后回到Eclipse，File -&gt; import -&gt; general -&gt; preferences -&gt; 导入刚才的a.epf文件。此时你会发现输入任何字幕都可以得到自动提示了。爽！！！</p>
<p>最后：自动提示弹出的时间最好改成100毫秒以下，这样会比较爽一点，不然你都完事了，自动提示才弹出来:)，不过也要看机器性能。</p>
<p>参考 ：<a href="http://www.whhpaccp.com/hpaccp/studyjava_08243792.html#" target="_blank"><a href="http://www.whhpaccp.com/hpaccp/studyjava_08243792.html/#">http://www.whhpaccp.com/hpaccp/studyjava_08243792.html/#</a></a></p>
<p><strong>设置java的环境变量及其配置</strong></p>
<p>这个内容本来是最开始就应该操作的，这里算是插播一下，位置在 我的电脑-属性-高级-系统变量-</p>
<p>JAVA_HOME ：JAVA的JDK安装的目录C:\Program Files\Java\jdk1.6.0_21</p>
<p>PATH:最前面追加 .;%JAVA_HOME%\bin;</p>
<p><strong>myeclipse启动tomcat console中没有信息提示的情况</strong></p>
<p>这个应该是最开始用eclipse犯的错误，各种system.out，但是tomcat的console一直没有内容，其实你只要检查一下将Console中的“Open Console”切换成“Java Stack Trace Console”试试。</p>
<p>参考：<a href="http://menglimengwai.iteye.com/blog/370043" target="_blank"><a href="http://menglimengwai.iteye.com/blog/370043">http://menglimengwai.iteye.com/blog/370043</a></a></p>
<p><strong>eclipse常用的快捷键</strong>
【ALT+/】此快捷键为用户编辑的好帮手，能为用户提供内容的辅助，不要为记不全方法和属性名称犯愁，当记不全类、方法和属性的名字时，多体验一下【ALT+/】快捷键带来的好处吧。</p>
<p>【Ctrl+O】显示类中方法和属性的大纲，能快速定位类的方法和属性，在查找Bug时非常有用。</p>
<p>【Ctrl+/】快速添加注释，能为光标所在行或所选定行快速添加注释或取消注释，在调试的时候可能总会需要注释一些东西或取消注释，现在好了，不需要每行进行重复的注释。</p>
<p>【Ctrl+D】删除当前行，这也是笔者的最爱之一，不用为删除一行而按那么多次的删除键。</p>
<p>【Ctrl+M】窗口最大化和还原，用户在窗口中进行操作时，总会觉得当前窗口小（尤其在编写代码时），现在好了，试试【Ctrl+M】快捷键。</p>
<p>【Ctrl+K】、【Ctrl++Shift+K】快速向下和向上查找选定的内容，从此不再需要用鼠标单击查找对话框了。</p>
<p>【Ctrl+Shift+T】查找工作空间（Workspace）构建路径中的可找到Java类文件，不要为找不到类而痛苦，而且可以使用“/*”、“？”等通配符。</p>
<p>【Ctrl+Shift+R】和【Ctrl+Shift+T】对应，查找工作空间（Workspace）中的所有文件（包括Java文件），也可以使用通配符。</p>
<p>【Ctrl+Shift+G】查找类、方法和属性的引用。这是一个非常实用的快捷键，例如要修改引用某个方法的代码，可以通过【Ctrl+Shift+G】快捷键迅速定位所有引用此方法的位置。</p>
<p>【Ctrl+Shift+O】快速生成import，当从网上拷贝一段程序后，不知道如何import进所调用的类，试试【Ctrl+Shift+O】快捷键，一定会有惊喜。</p>
<p>【Ctrl+Shift+F】格式化代码，书写格式规范的代码是每一个程序员的必修之课，当看见某段代码极不顺眼时，选定后按【Ctrl+Shift+F】快捷键可以格式化这段代码，如果不选定代码则默认格式化当前文件（Java文件）。</p>
<p>【ALT+Shift+W】查找当前文件所在项目中的路径，可以快速定位浏览器视图的位置，如果想查找某个文件所在的包时，此快捷键非常有用（特别在比较大的项目中）。</p>
<p>【Ctrl+L】定位到当前编辑器的某一行，对非Java文件也有效。</p>
<p>【Alt+←】、【Alt+→】后退历史记录和前进历史记录，在跟踪代码时非常有用，用户可能查找了几个有关联的地方，但可能记不清楚了，可以通过这两个快捷键定位查找的顺序。</p>
<p>【F3】快速定位光标位置的某个类、方法和属性。</p>
<p>【F4】显示类的继承关系，并打开类继承视图。</p>
<p>【Ctrl+Shift+B】：在当前行设置断点或取消设置的断点。</p>
<p>【F11】：调试最后一次执行的程序。</p>
<p>【Ctrl+F11】：运行最后一次执行的程序。</p>
<p>【F5】：跟踪到方法中，当程序执行到某方法时，可以按【F5】键跟踪到方法中。</p>
<p>【F6】：单步执行程序。</p>
<p>【F7】：执行完方法，返回到调用此方法的后一条语句。</p>
<p>【F8】：继续执行，到下一个断点或程序结束。</p>
<p>【Ctrl+C】：复制。</p>
<p>【Ctrl+X】：剪切。</p>
<p>【Ctrl+V】：粘贴。</p>
<p>【Ctrl+S】：保存文件。</p>
<p>【Ctrl+Z】：撤销。</p>
<p>【Ctrl+Y】：重复。</p>
<p>【Ctrl+F】：查找。</p>
<p>【Ctrl+F6】：切换到下一个编辑器。</p>
<p>【Ctrl+Shift+F6】：切换到上一个编辑器。</p>
<p>【Ctrl+F7】：切换到下一个视图。</p>
<p>【Ctrl+Shift+F7】：切换到上一个视图。</p>
<p>【Ctrl+F8】：切换到下一个透视图。</p>
<p>【Ctrl+Shift+F8】：切换到上一个透视图。</p>
<hr>
<ol>
<li><p>edit-&gt;content Assist - &gt; add      Alt+/ 代码关联</p>
</li>
<li><p>Window -&gt; Next Editor -&gt; add    Ctrl+Tab 切换窗口</p>
</li>
<li><p>Run/Debug Toggle Line Breakpoint -&gt; add Ctrl+` 在调试的时候 增删断点</p>
</li>
<li><p>Source-&gt; Surround with try/catch Block -&gt; Ctrl+Shift+v 增加try catch 框框</p>
</li>
<li><p>Source -&gt; Generate Getters and Setters -&gt; Ctrl+Shift+. 增加get set 方法</p>
</li>
</ol>
<hr>
<p>Alt+/ 代码助手完成一些代码的插入(但一般和输入法有冲突,可以修改输入法的热键,也可以暂用Alt+/来代替)</p>
<p>Ctrl+1:光标停在某变量上，按Ctrl+1键，可以提供快速重构方案。选中若干行，按Ctrl+1键可将此段代码放入for、while、if、do或try等代码块中。</p>
<p>双击左括号（小括号、中括号、大括号），将选择括号内的所有内容。</p>
<p>Alt+Enter 显示当前选择资源(工程,or 文件 or文件)的属性</p>
<p>Ctrl+K:将光标停留在变量上，按Ctrl+K键可以查找到下一个同样的变量</p>
<p>Ctrl+Shift+K:和Ctrl+K查找的方向相反</p>
<p>Ctrl+E 快速显示当前Editer的下拉列表(如果当前页面没有显示的用黑体表示)</p>
<p>Ctrl+Shift+E 显示管理当前打开的所有的View的管理器(可以选择关闭,激活等操作)</p>
<p>Ctrl+Q 定位到最后编辑的地方</p>
<p>Ctrl+L 定位在某行 (对于程序超过100的人就有福音了)</p>
<p>Ctrl+M 最大化当前的Edit或View (再按则反之)</p>
<p>Ctrl+/ 注释当前行,再按则取消注释</p>
<p>Ctrl+T 快速显示当前类的继承结构</p>
<p>Ctrl+Shift-T: 打开类型（Open type）。如果你不是有意磨洋工，还是忘记通过源码树（source tree）打开的方式吧。</p>
<p>Ctrl+O:在代码中打开类似大纲视图的小窗口</p>
<p>Ctrl+鼠标停留:可以显示类和方法的源码</p>
<p>Ctrl+H:打开搜索窗口</p>
<p>Ctrl+/(小键盘) 折叠当前类中的所有代码</p>
<p>Ctrl+×(小键盘) 展开当前类中的所有代码</p>
<p>-----------Ctrl+Shift 系列-----------</p>
<p>Ctrl+Shift+F 格式化当前代码</p>
<p>Ctrl+Shift+X 把当前选中的文本全部变味小写</p>
<p>Ctrl+Shift+Y 把当前选中的文本全部变为小写</p>
<p>Ctrl+Shift+O:快速地导入import</p>
<p>Ctrl+Shift+R:打开资源 open Resource</p>
<p>F3:打开声明该引用的文件</p>
<p>F4:打开类型层次结构</p>
<p>F5:单步跳入</p>
<p>F6:单步跳过</p>
<p>F7:单步跳出</p>
<p>F8:继续，如果后面没有断点，程序将运行完</p>
<p>Ctrl+D: 删除当前行</p>
<p>Ctrl+Alt+↓ 复制当前行到下一行(复制增加)</p>
<p>Ctrl+Alt+↑ 复制当前行到上一行(复制增加)</p>
<p>Alt+↓ 当前行和下面一行交互位置(特别实用,可以省去先剪切,再粘贴了)</p>
<p>Alt+↑ 当前行和上面一行交互位置(同上)</p>
<p>Shift+Enter 在当前行的下一行插入空行(这时鼠标可以在当前行的任一位置,不一定是最后)</p>
<p>Ctrl+Shift+Enter 在当前行插入空行(原理同上条)</p>
<p>Alt+← 前一个编辑的页面</p>
<p>Alt+→ 下一个编辑的页面(当然是针对上面那条来说了)</p>
<p>Ctrl+Shift+S:保存全部</p>
<p>Ctrl+W 关闭当前Editer</p>
<p>Ctrl+Shift+F4 关闭所有打开的Editer</p>
<p>Ctrl+Shift+G: 在workspace中搜索引用</p>
<p>Ctrl+Shift+P 定位到对于的匹配符(譬如{}) (从前面定位后面时,光标要在匹配符里面,后面到前面,则反之)</p>
<p>Ctrl+J 正向增量查找(按下Ctrl+J后,你所输入的每个字母编辑器都提供快速匹配定位到某个单词,如果没有,则在stutes line中显示没有找到了,查一个单词时,特别实用,这个功能Idea两年前就有了)</p>
<p>Ctrl+Shift+J 反向增量查找(和上条相同,只不过是从后往前查)
来源： <a href="[http://www.open-open.com/lib/view/open1348033080365.html](http://www.open-open.com/lib/view/open1348033080365.html)">[http://www.open-open.com/lib/view/open1348033080365.html](http://www.open-open.com/lib/view/open1348033080365.html)</a> </p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/eclipse/">eclipse</a></li></span></span> | <span class="tags">Tagged <a href="/tags/eclipse/" class="label label-primary">eclipse</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:29"datetime="2014-03-07 09:54:29"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-eclipse--Eclipse调优及使用小细节/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-eclipse--Eclipse调优及使用小细节" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-架构师--通向架构师的道路（第二十六天）漫谈架构与设计文档的写作技巧/">通向架构师的道路（第二十六天）漫谈架构与设计文档的写作技巧</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:29.000Z"> <a href="/2014/02/02/2014-02-02-架构师--通向架构师的道路（第二十六天）漫谈架构与设计文档的写作技巧/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-">通向架构师的道路（第二十六天）漫谈架构与设计文档的写作技巧</h1>
<p>您还未登录！|<a href="https://passport.csdn.net/account/login" target="_blank">登录</a>|<a href="https://passport.csdn.net/account/register" target="_blank">注册</a>|<a href="https://passport.csdn.net/help/faq" target="_blank">帮助</a></p>
<ul>
<li><a href="http://www.csdn.net/" target="_blank">首页</a></li>
<li><a href="http://news.csdn.net/" target="_blank">业界</a></li>
<li><a href="http://mobile.csdn.net/" target="_blank">移动</a></li>
<li><a href="http://cloud.csdn.net/" target="_blank">云计算</a></li>
<li><a href="http://sd.csdn.net/" target="_blank">研发</a></li>
<li><a href="http://bbs.csdn.net/" target="_blank">论坛</a></li>
<li><a href="http://blog.csdn.net/" target="_blank">博客</a></li>
<li><a href="http://download.csdn.net/" target="_blank">下载</a></li>
<li><h2 id="-"><a href="">更多</a></h2>
</li>
</ul>
<h1 id="-lifetragedy-http-blog-csdn-net-lifetragedy-"><a href="http://blog.csdn.net/lifetragedy" target="_blank">lifetragedy的专栏</a></h1>
<h2 id="-it">吾以吾血荐我中华之IT</h2>
<ul>
<li><a href="http://blog.csdn.net/lifetragedy?viewmode=contents" target="_blank"><img src="" alt="">目录视图</a></li>
<li><a href="http://blog.csdn.net/lifetragedy?viewmode=list" target="_blank"><img src="" alt="">摘要视图</a></li>
<li><a href="http://blog.csdn.net/lifetragedy/rss/list" target="_blank"><img src="" alt="">订阅</a>
<a href="http://blog.csdn.net/blogdevteam/article/details/9819385" target="_blank">《这些年，我们读过的技术经典图书》主题有奖征文</a>        <a href="http://www.csdn.net/article/2013-08-06/2816471" target="_blank">专访李铁军：从医生到金山首席安全专家的转变</a>      <a href="http://blog.csdn.net/adali/article/details/9813651" target="_blank">独一无二的职位：开源社区经理</a>        <a href="http://blog.csdn.net/blogdevteam/article/details/10389969" target="_blank">CSDN博客第三期云计算最佳博主评选</a></li>
</ul>
<h3 id="-"><a href="">通向架构师的道路（第二十六天）漫谈架构与设计文档的写作技巧</a></h3>
<p>分类： <a href="http://blog.csdn.net/lifetragedy/article/category/1175320" target="_blank">架构师之路</a>  2012-12-06 16:19 6424人阅读 <a href="">评论</a>(28) <a href="&quot;收藏&quot;">收藏</a> <a href="&quot;举报&quot;">举报</a>
<a href="http://blog.csdn.net/tag/details.html?tag=%e6%9e%b6%e6%9e%84%e5%b8%88 %e5%85%b7%e5%a4%87 %e6%8a%80%e8%83%bd %e6%88%90%e4%b8%ba %e6%9e%b6%e6%9e%84%e5%b8%88" target="_blank">架构师 具备 技能 成为 架构师</a></p>
<p>目录<a href="&quot;系统根据文章中H1到H6标签自动生成文章目录&quot;">(?)</a><a href="&quot;展开&quot;">[+]</a></p>
<ol>
<li><a href="">前言</a></li>
<li><p><a href="">一Soft Skill与Hard Skill</a></p>
</li>
<li><p><a href="">先来说一下Hard Skill</a></p>
</li>
<li><a href="">什么是Soft Skill</a></li>
<li><a href="">Documentation Skill与Presentation Skill</a></li>
<li><p><a href="">要善于懂得包装</a></p>
</li>
<li><p><a href="">三如何写好一篇文档和提高你的documentation skill</a></p>
</li>
<li><p><a href="">一图胜千言</a></p>
</li>
<li><a href=""></a></li>
<li><p><a href="">画好你的图</a></p>
</li>
<li><p><a href="">架构图的配色与表达手法</a></p>
</li>
<li><a href="">以图绘意</a></li>
<li><p><a href="">依照八股文来绘制设计图</a></p>
</li>
<li><p><a href="">四如何画出准确且漂亮的设计图呢</a></p>
</li>
<li><a href="">五图文混杂的技巧</a><h1 id="-"><a href=""></a>前言：</h1>
</li>
</ol>
<p>这篇是一篇番外篇，没有太多代码与逻辑，完全是一种”软“技巧，但是它对于你如何成为一名合构的架构设计人员很重要。</p>
<p>在此要澄清一点，架构师本身也是”程序员“，不是光动嘴皮子的家伙们，如果你不是一名程序虽出身那你根本谈不上也不可能成为一名架构师。</p>
<p>那么架构师还有哪些是作为一名程序员来说不具备的呢？</p>
<p>其中有一项能力就叫做”文档写作能力“。</p>
<h1 id="-soft-skill-hard-skill"><a href=""></a>一、Soft Skill与Hard Skill</h1>
<p>作为一名架构师除了是一名资深的程序员外，它还必须具有相应的Soft Skill，其中有一名就叫做Documentation Skill。</p>
<h2 id="-1-hard-skill"><a href=""></a>1. 先来说一下Hard Skill</h2>
<p>代码与框架以及产品的灵活使用以及在相应的domain（如Insurance, Banking, CRM, DW。。。）上的经验我们把它称为Hard Skill，没有这些技巧你就成不了一名合格的程序员。</p>
<p>程序员和IT是有区别的，程序员是IT业内的主力军团，但是如果你是在一家网站或者是软件司作需求分析的，哪怕是一个秘书，那你也是一个IT人员，对吧？所以这些东西是一个成为架构师的“硬”条件。</p>
<h2 id="-2-soft-skill"><a href=""></a>2. 什么是Soft Skill</h2>
<p>Soft Skill即指Documentation Skill, Presentation Skill，Communication Skill, 相应的Language Skill（不包括日本语，BS小日本）, Management Skill, Leader Ship, 这些.</p>
<p>当然，还有更多，更多。。。</p>
<h2 id="-2-1-documentation-skill-presentation-skill"><a href=""></a>2.1 Documentation Skill与Presentation Skill</h2>
<p>今天主要讲述的是Documentation Skill与Presentation Skill。</p>
<p>勿要小看这两点，有人说他自己编程编得好，有人说自己的算法写了如何如何精深，那么。。。在现在这个团队合作至上以及处于目前这样的世界经济大环境以客户至上的背景下你所知道的的东西不能向其它人表达清楚，谁会理解你的想法，谁会接受你的理念，谁会选择你公司的产品呢？</p>
<p>举两个例子：</p>
<p>苏步青，他是大数学家，对吧，或许不少人不知道苏步青在文学上的造诣也是很深的。</p>
<p>苏步青曾说过：为什么我喜欢语文，语言，因为我的论文，我的教材需要用语言去表达的，如果不把语言，语文学好我根本无法更精准更明白的去表达我的算法。</p>
<p>著名计算机学者C语言教程的作者谭好强曾经说过：能够把复杂的问题用简单直白的语言和框图去表达出来，就是最好的论文。</p>
<p>再说个实际点的例子，你处于一个投标竞赛中，你的设计或许是很好，可是如何让客户能够理解和接受贵公司的设计方案呢？</p>
<p>那么你需要在平时有意识的去提高或者我们说修练一下你的documentation skill，documentation skill与presentation skill是联系在一起的.</p>
<h2 id="-2-2-"><a href=""></a>2.2 要善于懂得“包装”</h2>
<p>Presentation Skill即”宣传、演示、演讲、推销&quot;的一种技巧，很多人在面对你的同事或者朋友时可能会滔滔而谈，但是在面对你的上司或者是在客户面前，就成了“缩货”了。。。为什么？</p>
<p>其实很多时候在于你演讲的底稿我们一般用PPT或者是WORD准备的不足，呆板、凡味，还有时在于你的设计确实自己也拿捏不准。</p>
<p>因此Hard Skill是你的底气，有了足够硬的Hard Skill你有了50%的胆子再加上一篇好的Document（PPT一类）你的另50%胆子也有了，此时你的Presentation Skill就提升了.</p>
<p>所以很多时候你的Presentation Skill是等于Hard Skill+Documentation Skill的。</p>
<p>有一部片叫《幸德勒的名单》相信不少人看过吧？开头30分钟，靠着不足万元“老本”的幸德勒来到了犹太人聚集地，找到了犹太会计师-以撒.斯坦，他滔滔而谈自己成立公司的计划，如何可以挣钱。然后以撒.斯坦问了他一句：</p>
<p>请让我弄明白一件事，我出人，然后我找”金主“出钱，那你出什么。。。？</p>
<p>幸德勒吸了一口烟，双手合在一起后向外一推 ”presentation, 这是我最擅长的“，这边的presentation也可认为是一种包装.</p>
<p>同样一个中国生产的杯子和美国，如果性能、功能、使用寿命都一样，相信一定是美国货卖得贵，为什么？因为它在有了Hard Skill基础上再次进行了”包装“，这就是”好莱坞式&quot;的促销手法。</p>
<p><strong>要学会“包装”但不是扯蛋和吹牛</strong>，因为架构师拿出来的东西哪怕再漂亮，如果没有内含那也是“滥竽充数”，被人识破后就一钱不值了。但是我们在有好的质量好的技术的基础上善于去“包装”它，相信你会离成功更近一步。</p>
<h1 id="-documentation-skill"><a href=""></a>三、如何写好一篇文档和提高你的documentation skill</h1>
<p>我在前公司有一阵没空，一度让其它几个senior的Team Leader帮助我写文档，要求把设计按照需求能够写清即可。</p>
<p>送上来5篇文章，基本一篇都不能用.</p>
<p>第一次送上来，每篇都是讲一个功能点，要不是冗长的一段没意义的解释，要不就是从官网直接COPY一段话下来，甚至连1,2,3,4都没列出来，至少你要有个Advantage Points 或者说是Benefit和Disadvantage Points的对比吧.</p>
<p>第二次送上来，有了1，2，3，4，但是这下好了，全都标成1,2,3,4了。</p>
<p>要善于利用office编辑器中的“符号列表”，“4角星”代表亮点，“√&quot;代表优点，”小点点“放在段落前用来将功能点说明”分层“，使阅话者更清晰.</p>
<p>这样说吧，你把自己当成一个阅读者了吗？对吧？</p>
<h2 id="-3-1-"><a href=""></a>3.1 一图胜千言</h2>
<p>我们在描述一个审计日志功能模块时我们说用Spring做，如果能够附上下面这样的一张图是不是会更加生动呢？</p>
<p><img src="" alt=""></p>
<p>一个架构文档，从基本的来讲需要有：</p>
<ul>
<li>Logic View（逻辑视图）</li>
<li>Physical View（物理视图）</li>
<li>Network Structure（网络拓卜图）</li>
<li>Workflow/Process Flow（流程图）
你在描述你的流程时你怎么表达你的if else if else，对吧？有个流程图是不是会更好让人懂你所描述的这个流程是一个什么样子的呢？</li>
</ul>
<p>那我画个流程图去。。。画啊画，画完后拿过来一看：
黑线框、框内有几个字，几个带箭头的线连一下。。。不错。。。是画对了，可是你有没有想过，有些业务场景中流程图往往还要表达不同的”业务边界“啊。。。</p>
<p>拿下面的一个图来说，是不是这样的表达比只有黑框框+带箭头的线+几个文字更加易懂啊？
<img src="" alt=""></p>
<h2 id="-"><a href=""></a></h2>
<h2 id="-3-2-"><a href=""></a>3.2 画好你的图</h2>
<h3 id="-3-2-1-"><a href=""></a>3.2.1 架构图的配色与表达手法</h3>
<p>不要认为画图是”美工“的事，你是设计人员，你是架构师，画好一个应用图是你的本职工作，图中需要什么图标可以把你的需求告诉美工，美工再会去处理。</p>
<p>一般来说，我们为了表达一个系统的模块组成，我们通常会用：component view来表达如下面这样的图
这个被称为<strong>”自上而下“的一个平面图，</strong>用于表示”<strong>服务边界</strong>“</p>
<p><img src="" alt="">、</p>
<p>如果你考究的话还可以提供一个”<strong>剖视图</strong>“，如典型的用于表示详细业务组件的”<strong>侧面剖视图</strong>“：
<img src="" alt=""></p>
<p>这种Component View一般都是跟着你的总架构图和网络拓卜图的后面出现的，这三套图我称它为“<strong>炮鸣三声</strong>”（起兵啦。。。）。
<strong>因此这样的图往往会使用“暖色调”，以几何或者立体的色块来展现，带给观看者强烈的视觉冲击</strong>，架构师的功底基本可以集中体现在这三套图中，<strong>这三套图同时也起到了“先声夺人”吸引观众的眼球，注意力的作用</strong>（那边的女孩看过来看过来，我的钞票多。。。嘿嘿嘿）</p>
<p>如下面这样的一个总架构图的表现手法：
<img src="" alt=""></p>
<p>对吧，<strong>暖色调，以几何或者立体的色块来展现</strong></p>
<h3 id="-3-2-2-"><a href=""></a>3.2.2 以图绘意</h3>
<p>我这边提个问题：如何表达一个”<strong>业务规则</strong>“，如何去表达一个”<strong>工作流</strong>“，就是<strong>”业务规则“这四个字我用图怎么表达</strong>。。。<strong>工作流这三个字我用图怎么表达</strong>？大家想一下。</p>
<p>来，看看下面的图：
这个图一看就知道是在表达process或者说是工作流</p>
<p><img src="" alt=""></p>
<p>这个图代表”规则“，规则就是一组if else if if</p>
<p><img src="" alt=""></p>
<p>对吧。。。现在来个更难的，我的业务规则用的是规则引擎，且内核是jboss rulz，嘿嘿，怎么用图标达,来。。。下面给出我的答案：</p>
<p><img src="" alt=""></p>
<p>对吧。。。看到了吗。。。图用来绘意，但图不能乱用，就拿这个”<strong>系统中使用了JBOSS RULZ来作为规则引擎</strong>&quot;这个描述来说，你要画的图其实是建立在你的Hard Skill上的。</p>
<h3 id="-3-2-3-"><a href=""></a>3.2.3 依照“八股文”来绘制设计图</h3>
<p>八股文就是有条理有章矩，不管什么样的文章你按照八股文去写，写出来都是一样的层次，我们考四级英语的“写作”这一本时其实也是有“<strong>章法</strong>”可循的对吧？</p>
<p>那么这个设计图的画法也是有章可循的，也是有它的“<strong>八股文</strong>”样板的。</p>
<p>前面说了，<strong>上手三套图先声夺人，抢人二目，那么在架构设计文档中还会充质着种种模块，子模块，功能设计，功能点描述图。。。如果你也来个一概而论，那就不是先声夺人了，而是“喧宾夺主“了</strong>，呵呵呵。</p>
<p>这种子模块、功能设计或者是功能点描述往往往以点、线为主，以点、线来连成一个面，而面中”娄空“，如下面的样例:</p>
<p><img src="" alt=""></p>
<h1 id="-"><a href=""></a>四、如何画出准确且“漂亮”的设计图呢</h1>
<p>七叔：You are beautiful...啊...you are beautiful...You are so handsome...啊You are so handsome...</p>
<p>周星星：七叔，你不要这样好吧。。。七叔。。。来人啊。。。
我在前一天即第二十五天中用来描述DbUnit的优点时用到了一套图，它们是这样的，大家还记得吧？</p>
<p><img src="" alt="">
右边的文字，没什么稀罕的，都是配色而己，关键在于左边的这个图。。。hoho，很多人问我用的是什么工具画的？</p>
<p>我告诉你们，我不是美工，我其实是在“<strong>拼图</strong>”，如这幅图的制作：
<img src="" alt=""></p>
<p><strong>我是用了以下这5幅小图标，拼制而成的：</strong></p>
<hr>
<p><img src="" alt="">
不是这么简单的，随便画画就成了，都要花功夫的、花心思去制作的。</p>
<ul>
<li>平时自己看到好的可以表达某个意义的图片，存下来，分门别类</li>
<li>看到人家写的好的架构文档，存下来，看看人家是怎么去描述一个功能点的</li>
<li>多搜集一些IT上专用的图标，小图片，logo
IBM的文档是我看到过最恐怖的文档，基本上这里面的架构文档出来都一个腔调，没什么文字，都是图，<strong>连个“登录过程”都用图表达</strong>，<strong>连个“源码check in check out”的管理流程都用图表达</strong>。
保持你的图系一致及风格的一致，你可以用卡通系、商务系任何一个系的图来表达你的设计思想，但是当你的第一幅图用的就是哪个系时，你的文档中所有的图都请用这个系列，而不建议你混杂使用你的图系。</li>
</ul>
<h1 id="-"><a href=""></a>五、图文混杂的技巧</h1>
<p>什么都不多说，上截图，大家自己去感受一下吧<img src="" alt=""></p>
<p>今天就说这么多，希望对大家提高你的设计文档写作水平有所提高吧。</p>
<p>分享到： <a href="&quot;分享到新浪微博&quot;"></a><a href="&quot;分享到腾讯微博&quot;"></a></p>
<ul>
<li>上一篇：<a href="http://blog.csdn.net/lifetragedy/article/details/8251056" target="_blank">通向架构师的道路（第二十五天）SSH的单元测试与dbunit的整合</a></li>
<li>下一篇：<a href="http://blog.csdn.net/lifetragedy/article/details/8286178" target="_blank">最近有一个人在CSDN博客上“炒袭“我的博文一事的说明</a></li>
</ul>
<p>顶 14 踩 1
查看评论<a href=""></a></p>
<p>17楼 <a href="http://blog.csdn.net/it_man" target="_blank">it_man</a> 2013-03-04 14:43发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/it_man" target="_blank"><img src="" alt=""></a>这篇对于架构师来说真的很好很强大. 谢谢,致敬.16楼 <a href="http://blog.csdn.net/lipslive" target="_blank">Slive</a> 2013-01-30 23:04发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/lipslive" target="_blank"><img src="" alt=""></a>从一开始看楼主的文章就知道楼主不见Hard Skill过硬，而且Soft Skill也是相当牛。但在这篇Blog中楼主说的大多是一些技巧点，所以有几点我想问一下楼主，望楼主能指点一下：
1、写文档时，思路总觉得不够清晰，如何理清思路？
2、针对不同对象，如直接领导，大领导，技术支持，客户等，文档展现方式有所不一样，如何把握呢？
3、Logic View（逻辑视图）Physical View（物理视图）Network Structure（网络拓卜图）Workflow/Process Flow（流程图）这几个图，在写文档的过程中，什么时候能套用的上（假设要求写的是设计文档）呢？Re: <a href="http://blog.csdn.net/lifetragedy" target="_blank">lifetragedy</a> 2013-01-31 14:19发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/lifetragedy" target="_blank"><img src="" alt=""></a>回复lipslive：1. 看TOGAF-9规范（国际架构师规范）</p>
<ol>
<li>多看PPT,看到好的，存下来，只有多看多写
我看了近300多篇还觉得不够。</li>
<li>这种文档都是有八股文的，你看到一段需求时可以想想有哪个以前看过的和你现在需要写的有点像，然后把以前看过的找出来，对着看一遍，自己动手再改一改，有时为了写一篇文档，会摘取10几篇，几十篇其它你手上文档的精粹，我这边的摘取不是抄，而是吸别人的风格Re: <a href="http://blog.csdn.net/lipslive" target="_blank">Slive</a> 2013-01-31 15:04发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/lipslive" target="_blank"><img src="" alt=""></a>回复lifetragedy：嗯，看来还是得多思考，多实践。15楼 <a href="http://blog.csdn.net/dangyifei" target="_blank">dangyifei</a> 2013-01-18 17:45发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/dangyifei" target="_blank"><img src="" alt=""></a>受益匪浅14楼 <a href="http://blog.csdn.net/AnBaoFeng1978" target="_blank">新无产阶级</a> 2013-01-06 13:38发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/AnBaoFeng1978" target="_blank"><img src="" alt=""></a>一直在关注楼主的每一期文章分享，受益匪浅。而且楼主的这种Open的心态很值得学习！
我们每一个人接触集群，性能优化之类项目中的核心精华内容的机会不多，有的人可能一辈子都遇不到这些机会，再次对楼主的Open精神表示钦佩！
看了楼主这么多期的文章，接下来，楼主可否就集群的日常维护（升级，单个机器或者Tomcat的性能监控、告警），以及作为一个架构师，在技术架构方面的对比和取舍这几个方面的经验分享一下。我个人对这些方面比较感兴趣，估计也是其他人很想了解的内容。13楼 <a href="http://blog.csdn.net/xiaoH1314" target="_blank">xiaoH1314</a> 2012-12-24 18:23发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/xiaoH1314" target="_blank"><img src="" alt=""></a>博主您好，我将您的”通往构架师的道路“整理了一份文档，由于偶缺积分所以想借您的文章赚点，希望您能理解。<a href="http://download.csdn.net/detail/xiaoh1314/4923727Re" target="_blank">http://download.csdn.net/detail/xiaoh1314/4923727Re</a>: <a href="http://blog.csdn.net/lifetragedy" target="_blank">lifetragedy</a> 2012-12-24 20:40发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/lifetragedy" target="_blank"><img src="" alt=""></a>回复xiaoH1314：不过没事，只要你不改动我文章里的任何字和句就没事Re: <a href="http://blog.csdn.net/lifetragedy" target="_blank">lifetragedy</a> 2012-12-24 20:40发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/lifetragedy" target="_blank"><img src="" alt=""></a>回复xiaoH1314：实际上我的资源里已经有相关的文档下载了。。。Re: <a href="http://blog.csdn.net/woyaowenzi" target="_blank">woyaowenzi</a> 2012-12-25 10:00发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/woyaowenzi" target="_blank"><img src="" alt=""></a>回复lifetragedy：在资源里面没有搜索到你的文章对应的PDF哎。能否给个链接？Re: <a href="http://blog.csdn.net/lifetragedy" target="_blank">lifetragedy</a> 2012-12-25 10:59发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/lifetragedy" target="_blank"><img src="" alt=""></a>回复woyaowenzi：我没有PDF，都是WORD文档，你标明转载和出处就OK了.Re: <a href="http://blog.csdn.net/xiaoH1314" target="_blank">xiaoH1314</a> 2012-12-25 09:04发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/xiaoH1314" target="_blank"><img src="" alt=""></a>回复lifetragedy：没有改过字句，就是您的那个图片太大了，我做了相应的调整。12楼 <a href="http://blog.csdn.net/l271640625" target="_blank">Cold的小小博客</a> 2012-12-20 16:18发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/l271640625" target="_blank"><img src="" alt=""></a>膜拜楼主，好久没更新了11楼 <a href="http://blog.csdn.net/zhimajiejie" target="_blank">宋杰</a> 2012-12-15 16:42发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/zhimajiejie" target="_blank"><img src="" alt=""></a>楼主好强大！！膜拜~~10楼 <a href="http://blog.csdn.net/bruclein1999" target="_blank">bruclein1999</a> 2012-12-12 19:03发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/bruclein1999" target="_blank"><img src="" alt=""></a>受益匪浅9楼 <a href="http://blog.csdn.net/xc222222" target="_blank">xc222222</a> 2012-12-11 13:08发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/xc222222" target="_blank"><img src="" alt=""></a>受益匪浅8楼 <a href="http://blog.csdn.net/ExceptionBaby" target="_blank">ExceptionBaby</a> 2012-12-11 10:47发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/ExceptionBaby" target="_blank"><img src="" alt=""></a>博主可以把你收集的资源分享一下么？Re: <a href="http://blog.csdn.net/lifetragedy" target="_blank">lifetragedy</a> 2012-12-11 11:02发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/lifetragedy" target="_blank"><img src="" alt=""></a>回复ExceptionBaby：那我明确的回答你，不可以。。。每个人资料积累的方式不同，我文中讲的是一些方法论，你可以照着自己去做就行了。
我给你一船鱼，不如给你一张渔网。7楼 <a href="http://blog.csdn.net/ExceptionBaby" target="_blank">ExceptionBaby</a> 2012-12-10 17:28发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/ExceptionBaby" target="_blank"><img src="" alt=""></a>这篇文章确实写的不错。6楼 <a href="http://blog.csdn.net/honsty2010" target="_blank">honsty2010</a> 2012-12-10 14:27发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/honsty2010" target="_blank"><img src="" alt=""></a>前几天做了个某个政府的售前，做技术方案、ppt、demo做了三个多星期。文档确实难写。楼主的根底很深厚。5楼 <a href="http://blog.csdn.net/honsty2010" target="_blank">honsty2010</a> 2012-12-10 14:25发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/honsty2010" target="_blank"><img src="" alt=""></a>谢谢楼主的辛苦写作。4楼 <a href="http://blog.csdn.net/leonzhouwei" target="_blank">leonzhouwei</a> 2012-12-09 23:28发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/leonzhouwei" target="_blank"><img src="" alt=""></a>有一个问题请教一下，对于“模块，子模块，功能设计，功能点描述”的详细设计的文档，博主一般用什么软件来编写呢？我一直是在用EXCEL，觉得很顺手，很好奇你用的是什么。另，一直在关注博主，受益很多，谢谢。Re: <a href="http://blog.csdn.net/lifetragedy" target="_blank">lifetragedy</a> 2012-12-10 00:43发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/lifetragedy" target="_blank"><img src="" alt=""></a>回复leonzhouwei：visio，90%情况下我都用VISIO画图，拿ps截个图镂个头下来而已只是。
有时为了追求书面表达的美观与效果甚至连表格都会用VISIO一线一线画出来。3楼 <a href="http://blog.csdn.net/guojunjian" target="_blank">guojunjian</a> 2012-12-06 20:59发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/guojunjian" target="_blank"><img src="" alt=""></a>确实对现阶段的我帮助很大。2楼 <a href="http://blog.csdn.net/lifetragedy" target="_blank">lifetragedy</a> 2012-12-06 19:33发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/lifetragedy" target="_blank"><img src="" alt=""></a>嘿嘿 Visio+ps1楼 <a href="http://blog.csdn.net/ljdbluesky" target="_blank">ljdbluesky</a> 2012-12-06 17:27发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/ljdbluesky" target="_blank"><img src="" alt=""></a>很不错，另外问您一下，那些图都用什么软件画的，好像visio画不出来吧Re: <a href="http://blog.csdn.net/lifetragedy" target="_blank">lifetragedy</a> 2012-12-06 19:49发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/lifetragedy" target="_blank"><img src="" alt=""></a>回复ljdbluesky：百分之九十情况下我都是只用visio,拿ps截个图镂个头下来而已只是Re: <a href="http://blog.csdn.net/lifetragedy" target="_blank">lifetragedy</a> 2012-12-06 19:33发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/lifetragedy" target="_blank"><img src="" alt=""></a>回复ljdbluesky：Visio+ps
您还没有登录,请<a href="">[登录]</a>或<a href="http://passport.csdn.net/account/register?from=http%3A%2F%2Fblog.csdn.net%2Flifetragedy%2Farticle%2Fdetails%2F8264797" target="_blank">[注册]</a></li>
</ol>
<p>/* 以上用户言论只代表其个人观点，不代表CSDN网站的观点或立场<a href=""></a><a href=""></a>
<a href="&quot;回到顶部&quot;"><img src="" alt="TOP"></a></p>
<p>个人资料</p>
<p><a href="http://my.csdn.net/lifetragedy" target="_blank"><img src="&quot;访问我的空间&quot;" alt=""></a>
<a href="http://my.csdn.net/lifetragedy" target="_blank">lifetragedy</a></p>
<p><a href="&quot;[加关注]&quot;"></a> <a href="&quot;[发私信]&quot;"></a>
<a href="http://medal.blog.csdn.net/allmedal.aspx" target="_blank"><img src="" alt=""></a><a href="http://medal.blog.csdn.net/allmedal.aspx" target="_blank"><img src="" alt=""></a></p>
<ul>
<li>访问：612767次</li>
<li>积分：5919分</li>
<li><p>排名：第728名</p>
</li>
<li><p>原创：56篇</p>
</li>
<li>转载：0篇</li>
<li>译文：0篇</li>
<li>评论：1258条</li>
</ul>
<p>文章搜索</p>
<p><a href=""></a></p>
<p>博客专栏</p>
<p><a href="http://blog.csdn.net/column/details/j2ee-guru.html" target="_blank"><img src="" alt=""></a> <a href="http://blog.csdn.net/column/details/j2ee-guru.html" target="_blank">架构师修练之道</a></p>
<p>文章：36篇</p>
<p>阅读：552037
文章分类</p>
<ul>
<li><a href="http://blog.csdn.net/lifetragedy/article/category/1175320" target="_blank">架构师之路</a>(27)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/category/1302654" target="_blank">随笔</a>(1)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/category/1544093" target="_blank">面经</a>(8)</li>
</ul>
<p>文章存档</p>
<ul>
<li><a href="http://blog.csdn.net/lifetragedy/article/month/2013/08" target="_blank">2013年08月</a>(8)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/month/2013/01" target="_blank">2013年01月</a>(1)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/month/2012/12" target="_blank">2012年12月</a>(3)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/month/2012/11" target="_blank">2012年11月</a>(4)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/month/2012/10" target="_blank">2012年10月</a>(3)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/month/2012/08" target="_blank">2012年08月</a>(5)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/month/2012/07" target="_blank">2012年07月</a>(10)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/month/2012/06" target="_blank">2012年06月</a>(2)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/month/2012/03" target="_blank">2012年03月</a>(1)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/month/2012/01" target="_blank">2012年01月</a>(8)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/month/2011/09" target="_blank">2011年09月</a>(2)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/month/2011/04" target="_blank">2011年04月</a>(2)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/month/2011/02" target="_blank">2011年02月</a>(3)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/month/2007/09" target="_blank">2007年09月</a>(1)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/month/2006/05" target="_blank">2006年05月</a>(1)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/month/2005/01" target="_blank">2005年01月</a>(1)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/month/2003/12" target="_blank">2003年12月</a>(1)</li>
</ul>
<p>展开
阅读排行</p>
<ul>
<li><a href="http://blog.csdn.net/lifetragedy/article/details/7698555" title="通向架构师的道路（第一天）之Apache整合Tomcat" target="_blank">通向架构师的道路（第一天）之Apache整合Tomcat</a>(54603)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/details/7708724" title="通向架构师的道路（第四天）之Tomcat性能调优-让小猫飞奔" target="_blank">通向架构师的道路（第四天）之Tomcat性能调优-让小猫飞奔</a>(33416)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/details/7699236" title="通向架构师的道路（第二天）之apache tomcat https应用" target="_blank">通向架构师的道路（第二天）之apache tomcat https应用</a>(31585)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/details/7712691" title="通向架构师的道路（第五天）之tomcat集群-群猫乱舞" target="_blank">通向架构师的道路（第五天）之tomcat集群-群猫乱舞</a>(31435)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/details/7707455" title="通向架构师的道路（第三天）之apache性能调优" target="_blank">通向架构师的道路（第三天）之apache性能调优</a>(30852)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/details/7734864" title="通向架构师的道路（第六天）之漫谈基于数据库的权限系统的设计" target="_blank">通向架构师的道路（第六天）之漫谈基于数据库的权限系统的设计</a>(26858)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/details/7751059" title="通向架构师的道路（第七天）之漫谈使用ThreadLocal改进你的层次的划分" target="_blank">通向架构师的道路（第七天）之漫谈使用ThreadLocal改进你的层次的划分</a>(24005)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/details/7776907" title="通向架构师的道路（第十天）之Axis2 Web Service(一)" target="_blank">通向架构师的道路（第十天）之Axis2 Web Service(一)</a>(21325)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/details/7763582" title="通向架构师的道路（第八天）之weblogic与apache的整合与调优" target="_blank">通向架构师的道路（第八天）之weblogic与apache的整合与调优</a>(21227)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/details/7205832" title="5天学会jaxws-webservice编程第一天" target="_blank">5天学会jaxws-webservice编程第一天</a>(20850)</li>
</ul>
<p>评论排行</p>
<ul>
<li><a href="http://blog.csdn.net/lifetragedy/article/details/7698555" title="通向架构师的道路（第一天）之Apache整合Tomcat" target="_blank">通向架构师的道路（第一天）之Apache整合Tomcat</a>(142)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/details/8096762" title="通向架构师的道路（第十八天）万能框架Spring(一）" target="_blank">通向架构师的道路（第十八天）万能框架Spring(一）</a>(84)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/details/7751059" title="通向架构师的道路（第七天）之漫谈使用ThreadLocal改进你的层次的划分" target="_blank">通向架构师的道路（第七天）之漫谈使用ThreadLocal改进你的层次的划分</a>(84)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/details/7699236" title="通向架构师的道路（第二天）之apache tomcat https应用" target="_blank">通向架构师的道路（第二天）之apache tomcat https应用</a>(56)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/details/7712691" title="通向架构师的道路（第五天）之tomcat集群-群猫乱舞" target="_blank">通向架构师的道路（第五天）之tomcat集群-群猫乱舞</a>(53)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/details/7205832" title="5天学会jaxws-webservice编程第一天" target="_blank">5天学会jaxws-webservice编程第一天</a>(51)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/details/7776907" title="通向架构师的道路（第十天）之Axis2 Web Service(一)" target="_blank">通向架构师的道路（第十天）之Axis2 Web Service(一)</a>(47)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/details/7844589" title="通向架构师的道路（第十四天）Axis2 Web Service安全之rampart" target="_blank">通向架构师的道路（第十四天）Axis2 Web Service安全之rampart</a>(44)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/details/7708724" title="通向架构师的道路（第四天）之Tomcat性能调优-让小猫飞奔" target="_blank">通向架构师的道路（第四天）之Tomcat性能调优-让小猫飞奔</a>(44)</li>
<li><a href="http://blog.csdn.net/lifetragedy/article/details/8507252" title="通向架构师的道路（第二十七天）IBM网格计算与企业批处理任务架构" target="_blank">通向架构师的道路（第二十七天）IBM网格计算与企业批处理任务架构</a>(41)
推荐文章</li>
</ul>
<p><a href="http://www.csdn.net/company/about.html" target="_blank">公司简介</a>|<a href="http://www.csdn.net/company/recruit.html" target="_blank">招贤纳士</a>|<a href="http://www.csdn.net/company/marketing.html" target="_blank">广告服务</a>|<a href="http://www.csdn.net/company/account.html" target="_blank">银行汇款帐号</a>|<a href="http://www.csdn.net/company/contact.html" target="_blank">联系方式</a>|<a href="http://www.csdn.net/company/statement.html" target="_blank">版权声明</a>|<a href="http://www.csdn.net/company/layer.html" target="_blank">法律顾问</a>|<a href="mailto:webmaster@csdn.net">问题报告</a><a href="http://wpa.qq.com/msgrd?v=3&amp;uin=2355263776&amp;site=qq&amp;menu=yes" target="_blank">QQ客服</a> <a href="http://e.weibo.com/csdnsupport/profile" target="_blank">微博客服</a> <a href="http://bbs.csdn.net/forums/Service" target="_blank">论坛反馈</a> <a href="mailto:webmaster@csdn.net">联系邮箱：webmaster@csdn.net</a> 服务热线：400-600-2320京 ICP 证 070598 号北京创新乐知信息技术有限公司 版权所有世纪乐知(北京)网络技术有限公司 提供技术支持江苏乐知网络技术有限公司 提供商务支持Copyright © 1999-2012, CSDN.NET, All Rights Reserved <a href="http://www.hd315.gov.cn/beian/view.asp?bianhao=010202001032100010" target="_blank"><img src="" alt="GongshangLogo"></a>
<img src="http://counter.csdn.net/pv.aspx?id=24" alt=""></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/架构师/">架构师</a></li></span></span> | <span class="tags">Tagged <a href="/tags/架构师/" class="label label-primary">架构师</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:29"datetime="2014-03-07 09:54:29"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-架构师--通向架构师的道路（第二十六天）漫谈架构与设计文档的写作技巧/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-架构师--通向架构师的道路（第二十六天）漫谈架构与设计文档的写作技巧" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>





<ul id="pagination" class="pagination pagination-lg">
  <li><a class="extend prev" href="/page/145/">&laquo;</a></li><li><a class="page-number" href="/">1</a></li><li><a class="page-number" href="/page/2/">2</a></li><li><span class="space">&hellip;</span></li><li><a class="page-number" href="/page/143/">143</a></li><li><a class="page-number" href="/page/144/">144</a></li><li><a class="page-number" href="/page/145/">145</a></li><li class="active"><li><span class="page-number current">146</span></li><li><a class="page-number" href="/page/147/">147</a></li><li><a class="page-number" href="/page/148/">148</a></li><li><a class="page-number" href="/page/149/">149</a></li><li><span class="space">&hellip;</span></li></li><li><a class="page-number" href="/page/161/">161</a></li><li><a class="page-number" href="/page/162/">162</a></li><li><a class="extend next" href="/page/147/">&raquo;</a></li>
  <div class="clearfix"></div>
</ul></div><!--wapper-->
       </div><!-- ID main-col END -->
       <aside id="sidebar" class="alignright col-sx-6 col-sm-4 col-md-3 col-lg-3">
<div id="widget_search" class="widget panel panel-primary">
    <form action="//google.com/search" method="get" accept-charset="utf-8">
  <div class="input-group">
    <input class="form-control" id="searchbox" type="search" name="q" results="0" placeholder="search">
    <span class="input-group-btn">
      <button class="btn btn-default" type="submit">Go!</button>
    </span>
    <input type="hidden" name="q" value="site:itsolife.com">
  </div>
</form>
</div>

<div id="widget_category" class="widget panel panel-primary">
  <div class="panel-heading">category</div>  <div data-src='category' class='ajax_widgets'>正在加载...</div>
</div>

<div id="widget_recent_posts" class="widget panel panel-primary">
  <div class="panel-heading">recent posts</div>  <div data-src='recent_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_tagcloud" class="widget panel panel-primary">
  <div class="panel-heading">tagcloud</div>  <div data-src='tagcloud' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_latest_update_posts" class="widget panel panel-primary">
  <div class="panel-heading">最近更新</div>  <div data-src='latest_update_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_recent_comments" class="widget panel panel-primary">
  <div class="panel-heading">recent comments</div>  

<div class="list-group-item ds-recent-comments" data-num-items="6" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="50"></div>



</div>

</aside>
       <div class="clearfix"></div>
     </div><!-- row END -->
  </div>
  <footer id="footer" class="container">
  <div class="panel panel-info">
  <section id='footer_widget'></section>  <div class="panel-footer">
  <div id="site-info">
    <span class='author'>
  
  &copy; 2014 RobinChia
  
    &nbsp;&nbsp;</span>
  
  <span id='analytics-51la'></span><span id='analytics-google'>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-48559895-1']);
  _gaq.push(['_trackPageview']);
  _js2load.push({src:('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'});
</script></span><span id='analytics-cnzz'>
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_5774006'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s17.cnzz.com/stat.php%3Fid%3D5774006%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
</span><span id='analytics-baidu'>
<script>
var _hmt = _hmt || [];
_js2load.push({src:"//hm.baidu.com/hm.js?1442f50724afc42380b51f097c43082c"});
</script>
</span>  </div>
  <div id="copyright">Site powered by <a href='http://zespia.tw/hexo/'><strong>hexo</strong></a>  update time: <em>2014-04-07 18:24:58</em></span></div>
</div>
<div class="clearfix"></div>


  </div>
  </footer>
  
        <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>        
        <script src="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/js/bootstrap.min.js"></script>        
                
        <script src="http://cdn.bootcss.com/prettify/r298/prettify.min.js"></script>    <script type="text/javascript">
   var lang=["bsh", "c", "cc", "cpp", "cs", "csh", "cyc", "cv", "htm", "html",
    "java", "js", "m", "mxml", "perl", "pl", "pm", "py", "rb", "sh",
    "xhtml", "xml", "xsl"];
   var pretty_base='';
   $('script').each(function(){
	var c = $(this).attr('src');
	if (!c)
	    return;
	if (c.match(/(\/)?prettify(\.min)?\.js/i))
	{
	    var index = c.lastIndexOf('/');
	    if (index != -1)
		pretty_base = c.substr(0,index + 1);
	    return false;
	}
   })
   $('pre code').each(function(){
	var c = $(this).attr('class')
	if (!c)
	    return;
	c = c.match(/\s?(lang\-\w+)/i);
	if (c && lang.indexOf(c[1]) == -1)
	{
	    lang.push(c[1]);
	    $.getScript(pretty_base + c[1] + '.min.js');
	}
   })

    $(window).load(function(){
       $("pre").addClass("prettyprint");
       prettyPrint();
    })
</script>    
            <script type="text/javascript">
var duoshuoQuery = {short_name:"robinchia"};
_js2load.push({src:'http://static.duoshuo.com/embed.js',charset:'UTF-8'});
</script>
    
            <!--wumii_relatedItems-->
    
        <script src="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js"></script>    <script type="text/javascript">
(function($){
  $('.entry').each(function(i){
    $(this).find('img').each(function(){
      var alt = this.alt;

      if (alt){
        $(this).before('<span class="caption">' + alt + '</span>');
      }

      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="fancybox' + i + '" />');
    });
  });

  $('.fancybox').fancybox();
})(jQuery);
</script>    
        <script src="http://cdn.bootcss.com/mathjax/2.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>
    
<script type="text/javascript">
$('.ajax_widgets').each(function(){var src=$(this).attr('data-src');if(src)$(this).load('/widgets/'+src+'.html');});
$.each(_js2load,function(index,obj){loadjs(obj.src,obj.charset)});
</script>

<div id="scroll2top">
<img src="/scroll2top/arrow.png"/>
</div>
<script src="/scroll2top/scroll2top.min.js"></script>
<div id="winterland">
  <canvas></canvas>
</div>
<script src="/js/winterland.min.js"></script>

  </body>
</html>
