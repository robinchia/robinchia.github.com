
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>The 90 Page | It so life</title>
<meta name="author" content="RobinChia">

<meta name="description" content="It so life">


<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta property="og:site_name" content="It so life"/>

<!--[if IE]><style>.testIE.IE{display:inline;}</style><![endif]-->
<!--[if lte IE 7]><link rel="stylesheet" href="/css/ie7.css" type="text/css"><![endif]-->
<!--[if (lt IE 9)&(gt IE 7)]><style>.testIE.IE8{display:inline;}</style><![endif]-->
<!--[if gt IE 8]><style>.testIE.IE9{display:inline;}</style><![endif]-->

<link href="/favicon.png" rel="icon">
<link rel="alternate" href="/atom.xml" title="It so life Feed" type="application/atom+xml">

<link rel="stylesheet" href="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.0.3/css/font-awesome.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/prettify/r298/prettify.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" type="text/css">
<link rel="stylesheet" href="/css/style.css" type="text/css">
<!--[if lt IE 9]>
   <style>article,aside,dialog,footer,header,section,footer,nav,figure,menu{display:block}</style>
   <script src="http://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
   <script src="http://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
<link href="http://cdn.staticfile.org/respond.js/1.4.2/respond-proxy.html" id="respond-proxy" rel="respond-proxy" />
<link href="/js/respond.proxy.gif" id="respond-redirect" rel="respond-redirect" />
<script src="/js/respond.proxy.js"></script>
   <script src="http://cdn.bootcss.com/selectivizr/1.0.2/selectivizr-min.js"></script>
<![endif]-->
<script type="text/javascript">
function loadjs(c,d){var a=document.createElement("script");a.async=!0;a.type="text/javascript";a.src=c;a.charset=d||"gbk";(document.getElementsByTagName("HEAD")[0]||document.getElementsByTagName("BODY")[0]).appendChild(a)};
var _protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
var _js2load = [];
</script>

</head>
<body>
      <header id="header" class="container"><nav id="main-nav" class="navbar navbar-default navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="/">It so life</a>
    </div>
    <div  class="collapse navbar-collapse">
      <ul  class="nav navbar-nav">
  
        <li><a href="/" title="Home">Home</a></li>      
        <li><a href="/about/" title="About">About</a></li>      
        <li><a href="/archives/" title="Archives">Archives</a></li>      
      <li class='dropdown'>
        <a class='dropdown-toggle' data-toggle='dropdown' href='#'>website<b class='caret'></b></a>
        <ul class='dropdown-menu pure-menu-selected'>
    
          <li><a href="//groups.google.com/forum/#!forum/pongba" title="TopLanguage">TopLanguage</a></li>    
          <li><a href="//itpub.net/" title="ITPub">ITPub</a></li>    
          <li><a href="//blog.jobbole.com/" title="Bole">Bole</a></li>    
          <li><a href="//nosql-database.org/" title="nosql">nosql</a></li>    
          <li><a href="//gitimmersion.googol.im/" title="Git">Git</a></li>    
        </ul>
      </li>
    
      </ul>
      <ul class="nav navbar-nav navbar-right">
      
        <li><a href="/atom.xml">RSS</a></li>
      
      
        <li><a href="https://twitter.com/robinchia">twitter</a></li>
      
      
      
      
        <li><a href="https://github.com/robinchia">github</a></li>
      
      </ul>
    </div>
  </div>
</nav>
<div class="clearfix"></div>
</header>
  <div id='content' class="container">
     <div class="page-header-wrapper">
      <!--[if lt IE 9]><div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong>提示:</strong>您的浏览器版本太低了,建议升级到 <strong><a href="http://windows.microsoft.com/zh-cn/internet-explorer/download-ie" title="IE9">IE9</a></strong> 以上,本站使用<a href="https://www.google.com/intl/zh-CN/chrome/">Chrome浏览器</a>可以获得最好的显示效果.</div><![endif]-->
      <div class="page-header"><h1 align="center"><big>It so life</big> </h1>
        <h5 align="center"><big>love as life</big></h5>
      </div>
     </div>
     <div class="row">
       <div id="main-col" class="alignleft col-sx-12 col-sm-8 col-md-9 col-lg-9">
      <section id='header_widget'></section>
          <div id="wrapper"><article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-CAS--casclient使用指南-老老-ITeye技术网站/">cas client使用指南 </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:39.000Z"> <a href="/2014/02/02/2014-02-02-CAS--casclient使用指南-老老-ITeye技术网站/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="cas-client-iteye-">cas client使用指南 - 老老 - ITeye技术网站</h1>
<p><a href="http://www.iteye.com/" target="_blank">首页</a> <a href="http://www.iteye.com/news" target="_blank">资讯</a> <a href="http://www.iteye.com/magazines" target="_blank">精华</a> <a href="http://www.iteye.com/forums" target="_blank">论坛</a> <a href="http://www.iteye.com/ask" target="_blank">问答</a> <a href="http://www.iteye.com/blogs" target="_blank">博客</a> <a href="http://www.iteye.com/blogs/subjects" target="_blank">专栏</a> <a href="http://www.iteye.com/groups" target="_blank">群组</a> <a href="http://lvyanglin.iteye.com/blog/618081#" target="_blank">更多 ▼</a></p>
<p><a href="http://www.iteye.com/job" target="_blank">招聘</a> <a href="http://www.iteye.com/search" target="_blank">搜索</a></p>
<p><a href="http://lvyanglin.iteye.com/login" title="登录" target="_blank">您还未登录 !</a> <a href="http://lvyanglin.iteye.com/login" target="_blank">登录</a> <a href="http://lvyanglin.iteye.com/signup" target="_blank">注册</a></p>
<h1 id="-http-lvyanglin-iteye-com-"><a href="http://lvyanglin.iteye.com/" target="_blank">老老</a></h1>
<ul>
<li><a href="http://lvyanglin.iteye.com/" target="_blank"><strong>博客</strong></a></li>
<li><a href="http://lvyanglin.iteye.com/weibo" target="_blank">微博</a></li>
<li><a href="http://lvyanglin.iteye.com/album" target="_blank">相册</a></li>
<li><a href="http://lvyanglin.iteye.com/link" target="_blank">收藏</a></li>
<li><a href="http://lvyanglin.iteye.com/blog/guest_book" target="_blank">留言</a></li>
<li><a href="http://lvyanglin.iteye.com/blog/profile" target="_blank">关于我</a></li>
</ul>
<h3 id="-cas-client-"><a href="">cas client使用指南</a> **</h3>
<p><strong>博客分类：</strong></p>
<ul>
<li><a href="http://lvyanglin.iteye.com/category/67638" target="_blank">java</a>
<a href="http://www.iteye.com/blogs/tag/%E4%BC%81%E4%B8%9A%E5%BA%94%E7%94%A8" target="_blank">企业应用</a><a href="http://www.iteye.com/blogs/tag/SSO" target="_blank">SSO</a><a href="http://www.iteye.com/blogs/tag/SQL%20Server" target="_blank">SQL Server</a><a href="http://www.iteye.com/blogs/tag/%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8" target="_blank">应用服务器</a><a href="http://www.iteye.com/blogs/tag/Spring" target="_blank">Spring</a> </li>
</ul>
<p>2008-02-27
JA-SIG（CAS）学习笔记3
关键字: cas sso 统一身份认证 java ja-sig
技术背景知识：
  JA-SIG CAS服务环境搭建，请参考 ：JA-SIG（CAS）学习笔记1 
  JA-SIG CAS业务架构介绍，请参考 ：JA-SIG（CAS）学习笔记2
  HTTPS所涉及的Java安全证书知识，请参考 ：Java  keytool 安全证书学习笔记
CAS技术框架
  CAS  Server
    目前，我们使用的CAS Server 3.1.1的是基于Spring Framework编写的，因此在CAS服务器端的配置管理中，绝大多数是Spring式的Java Bean XML配置。CAS 的服务器提供了一套易于定制的用户认证器接口，用户可以根据自身企业的在线系统的认证方式，来定制自己的认证逻辑。不论是传统的用户名/密码方式，还是基于安全证书的方式；是基于关系数据库的存储，还是采用LDAP服务器，CAS  Server给我们提供了这些常用的验证器模板代码，只要稍作修改，便可灵活使用了。
    对于广大的中国企业用户而言，另一个需要定制的功能莫过于全中文、企业特色的用户身份认证页面了。CAS Server提供了两套系统界面，一套是默认的CAS英文标准页面，另一套则是专门提供给用户来定制修改的。（PS：老外们做事情就是人性化啊~~）那么对CAS Server端的后续学习，我们将围绕着身份认证模块定制和界面定制这两方面展开。
  CAS  Client
    客户端我们使用的是CAS Client 2.1.1。虽然在官方网站上已出现了3.1.0版本的下载，但该版本地代码已经完全重写，使用的package和类名同2.1.1大相径庭了，最关键的是，该版本暂时没有对应的API说明文档。虽然咖啡我对程序版本怀有极大的“喜新厌旧”的心态，但安全起见，还是先2.1.1吧，相信3.1.0的文档耶鲁大学的大牛们已经在整理了，期待中……
CAS Client2.1.1.jar中的代码是相当精炼的，有兴趣的朋友建议阅读一下源码。Jar包中的代码分成三个大部分</p>
<ol>
<li>edu.yale.its.tp.cas.util 包，其中只有一个工具类 SecureURL.java 用来访问HTTPS URL</li>
<li>edu.yale.its.tp.cas.proxy包，用来处理Proxy Authentication代理认证的3个类，其中ProxyTicketReceptor.java是 接收PGT回调的servlet，在下文中我们会提及。</li>
<li>edu.yale.its.tp.cas.client包，其中包含了CAS Filter ，Tag Library等主要的认证客户端工具类，我们在后面会进行重点介绍。
针对CAS Client的学习，我们的重点将放在CAS Filter 和ProxyTicketReceptor 的配置以及在Java SE环境下，直接使用 ServiceTicketValidator进行Ticket认证实现上。
CAS服务器端应用
定制适合你的身份认证程序
通过前面的学习，我们了解了CAS具有一个良好而强大的SSO功能框架。接下来，我们要学习如何将实际企业应用中的身份认证同CAS进行整合。
简单的说，要将现有企业应用中的认证集成到CAS Server中，只要实现一个名为AuthenticationHandler的一个认证处理Java接口就行。以下是该接口的源代码：
Java代码
public interface AuthenticationHandler {<br>//<em>/</em> 
/<em> 该方法决定一个受支持的credentials是否是可用的， 
/</em> 如果可用，该方法返回true，则说明身份认证通过 
/<em>/ 
boolean  authenticate(Credentials credentials)  throws  AuthenticationException;<br>//</em>/<em> 
/</em> 该方法决定一个credentials是否是当前的handle所支持的 
/<em>/ 
boolean  supports(Credentials credentials);<br>} 
public interface AuthenticationHandler {
//</em>/<em>
/</em> 该方法决定一个受支持的credentials是否是可用的，
/<em> 如果可用，该方法返回true，则说明身份认证通过
/</em>/
boolean  authenticate(Credentials credentials)  throws  AuthenticationException;
//<em>/</em>
/<em> 该方法决定一个credentials是否是当前的handle所支持的
/</em>/
boolean  supports(Credentials credentials);
}
这里我们要说明一下Credentials这个CAS的概念。所谓Credentials是由外界提供给CAS来证明自身身份的信息，简单的如一个用户名/密码对就是一个Credentials，或者一个经过某种加密算法生成的密文证书也可以是一个Credentials。在程序的实现上，Credentials被声明为一个可序列化的接口，仅仅起着标识作用，源代码如下：
Java代码
public interface Credentials extends Serializable {<br>// marker interface contains no methods<br>} 
public interface Credentials extends Serializable {
// marker interface contains no methods
}
CAS的API中，已经为我们提供了一个最常用的实现UsernamePasswordCredentials  用户名/密码凭证，代码如下：
Java代码
public class UsernamePasswordCredentials implements Credentials {<br>//<em>/</em> Unique ID for serialization. /<em>/ 
private static final long serialVersionUID = -8343864967200862794L;<br>//</em>/<em> The username. /</em>/ 
private String username;<br>//<em>/</em> The password. /*/ 
private String password;<br>public final String getPassword() {<br>   return this.password;<br>}<br>public final void setPassword(final String password) {<br>   this.password = password;<br>}<br>public final String getUsername() {<br>   return this.username;<br>}<br>public final void setUsername(final String userName) {<br>   this.username = userName;<br>}<br>public String toString() {<br>   return this.username;<br>}<br>public boolean equals(final Object obj) {<br>   if (obj == null || !obj.getClass().equals(this.getClass())) {  <pre><code>   return false;  
</code></pre>   }<br>   final UsernamePasswordCredentials c = (UsernamePasswordCredentials) obj;<br>   return this.username.equals(c.getUsername())  <pre><code>   &amp;&amp; this.password.equals(c.getPassword());  
</code></pre>}<br>public int hashCode() {<br>   return this.username.hashCode() ^ this.password.hashCode();<br>}<br>} 
public class UsernamePasswordCredentials implements Credentials {
//<em>/</em> Unique ID for serialization. /<em>/
private static final long serialVersionUID = -8343864967200862794L;
//</em>/<em> The username. /</em>/
private String username;
//<em>/</em> The password. /*/
private String password;
public final String getPassword() {
   return this.password;
}
public final void setPassword(final String password) {
   this.password = password;
}
public final String getUsername() {
   return this.username;
}
public final void setUsername(final String userName) {
   this.username = userName;
}
public String toString() {
   return this.username;
}
public boolean equals(final Object obj) {
   if (obj == null || !obj.getClass().equals(this.getClass())) {<pre><code>   return false;
</code></pre>   }
   final UsernamePasswordCredentials c = (UsernamePasswordCredentials) obj;
   return this.username.equals(c.getUsername())<pre><code>   &amp;&amp; this.password.equals(c.getPassword());
</code></pre>}
public int hashCode() {
   return this.username.hashCode() ^ this.password.hashCode();
}
}
很简单不是吗？就是存储一个用户名和密码的java bean而已。
 接下来，我们将一个Credentials传给一个AuthenticationHandler进行认证，首先调用boolean  supports(Credentials credentials)方法察看当前传入的Credentials实例，AuthenticationHandler实例现是否支持它？如果支持，再调用boolean  authenticate(Credentials credentials)方法进行认证。由于用户名/密码方式是最常用的认证方法，因此CAS为我们提供了一个现成的基于该方式的抽象认证处理类AbstractUsernamePasswordAuthenticationHandler。通常我们只需要继承该类，并实现其中的    authenticateUsernamePasswordInternal方法即可。下面我们给出一个Demo的实现类，它的校验逻辑很简单——仅校验用户名的字符长度是否与密码的相等（这里密码是一个表示长度的整数），如果相等则认为认证通过，请看代码：
Java代码
public class UsernameLengthAuthnHandler  <pre><code>              extends AbstractUsernamePasswordAuthenticationHandler {  
</code></pre>protected boolean authenticateUsernamePasswordInternal( UsernamePasswordCredentials credentials)  throws AuthenticationException {<br>//<em><br>/</em> 这里我们完全可以用自己的认证逻辑代替，比如将用户名/密码传入一个SQL语句<br>/<em> 向数据库验证是否有对应的用户账号，这不是我们最经常干的事么？<br>/</em> 只需要将下面的程序替换掉就OK了！！So  easy，so  simple！<br>/<br>String username = credentials.getUsername();<br>String password = credentials.getPassword();<br>String correctPassword = Integer.toString(username.length());<br>return correctPassword.equals(password);<br>}<br>} 
public class UsernameLengthAuthnHandler<pre><code>              extends AbstractUsernamePasswordAuthenticationHandler {
</code></pre>protected boolean authenticateUsernamePasswordInternal( UsernamePasswordCredentials credentials)  throws AuthenticationException {
//<em>
/</em> 这里我们完全可以用自己的认证逻辑代替，比如将用户名/密码传入一个SQL语句
/<em> 向数据库验证是否有对应的用户账号，这不是我们最经常干的事么？
/</em> 只需要将下面的程序替换掉就OK了！！So  easy，so  simple！
/
String username = credentials.getUsername();
String password = credentials.getPassword();
String correctPassword = Integer.toString(username.length());
return correctPassword.equals(password);
}
}
介绍到这里，大家应该清楚如何定制自己的AuthenticationHandler类了吧！这里要附带说明的是，在CAS Server的扩展API中已经提供了大量常用认证形式的实现类，它们同CAS Server的war包一同分发：
cas-server-support-generic-3.1.1.jar ——使用Map记录用户认证信息的实现
cas-server-support-jdbc-3.1.1.jar —— 基于Spring JDBC的数据库实现（我们常用的）
cas-server-support-ldap-3.1.1.jar —— 基于LDAP的用户认证实现
更多其他形式的实现各位看官有兴趣的，可以一一阅读源码。
配置你的身份认证程序
完成了定制认证类的代码编写，接下来就是要让CAS Server来调用它了。在CAS的框架中，对程序的配置都是使用Spring Framework的xml文件，这对于熟悉Spring的程序员而言算驾轻就熟了。
配置文件位于应用部署目录的WEB-INF子目录下——deployerConfigContext.xml。在bean id=authenticationManager 的 authenticationHandlers属性中配置我们的AuthenticationHandlers：
引用
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
<beans xmlns="http://www.springframework.org/schema/beans"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:p="http://www.springframework.org/schema/p"
  xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd">
<bean id="authenticationManager"
class="org.jasig.cas.authentication.AuthenticationManagerImpl">
   。。。
   。。。
<property name="authenticationHandlers">
<list>
<bean class="org.jasig.cas.authentication.handler.support.HttpBasedServiceCredentialsAuthenticationHandler" p:httpClient-ref="httpClient" />
   &lt;!—下面就是系统默认的验证器配置，你可以替换它，或者增加一个新的handler --&gt;
<bean     class="org.jasig.cas.authentication.handler.support.SimpleTestUsernamePasswordAuthenticationHandler" />
</list>
</property>
</bean>
。。。
。。。
</beans>
我们发现authenticationHandlers属性是一个list，在这个list中可以配置多个AuthenticationHandlers。这些AuthenticationHandlers形成了一个验证器链，所有提交给CAS的Credentials信息将通过这个验证器链的链式过滤，只要这链中有一个验证器通过了对Credentials的验证，就认为这个Credentials是合法的。这样的设计使得我们可以很轻松的整合不同验证体系的已有应用到同一个CAS上，比如：A验证器负责校验alpha系统提交的Credentials，它是基于LDAP服务器的；B验证器负责校验beta系统提交的Credentials，它是一个传统的RDB用户表认证；C验证器负责校验gamma系统提交的基于RSA证书加密的Credentials。3种完全不同的用户身份认证通过配置就可以统一在同一个CAS服务内，很好很强大，不是吗！！
定制身份验证登录界面
 CAS Server在显示界面层view使用了“主题Theme”的概念。在{project.home}/webapp/WEB-INF/view/jsp/目录下，系统默认提供了两套得UI —— default和simple 。default方案使用了CSS等相对复杂得界面元素，而simple方案提供了最简化的界面表示方式。在整个的CAS Server服务器端，有四个界面是我们必须要实现的：
casConfirmView.jsp —— 确认信息（警告信息）页面
casGenericSuccess.jsp —— 登陆成功提示页面
casLoginView.jsp —— 登录输入页面
casLogoutView.jsp —— SSO登出提示页面
这些都是标准的jsp页面，如何实现他们，完全由您说了算，除了名字不能改。
CAS为view的展示提供了3个级别的定制方式，让我们从最直观简单的开始吧。
1． 采用文件覆盖方式：直接修改default中的页面或者将新写好的四个jsp文件覆盖到default目录中。这种方式最直观和简单，但咖啡建议各位在使用这种方式前将原有目录中的文件备份一下，以备不时之需。
2． 修改UI配置文件，定位UI目录：在CAS Server端/webapp/WEB-INF/classes/ 目录下，有一个名为default_views.properties的属性配置文件，你可以通过修改配置文件中的各个页面文件位置，指向你新UI文件，来达到修改页面展示的目的。
3． 修改配置文件的配置文件，这话看起来有点别扭，其实一点不难理解。在方法2中的default_views.properties文件是一整套的UI页面配置。如果我想保存多套的UI页面配置就可以写多个的properties文件来保存这些配置。在CAS Server端/webapp/WEB-INF/目录下有cas-servlet.xml和cas.properties两个文件，cas-servlet.xml使用了cas.properties文件中的cas.viewResolver.basename属性来定义view属性文件的名字，因此你可以选者直接修改cas-servlet.xml中的viewResolver 下的basenames属性，或者修改cas.properties中的cas.viewResolver.basename属性，指定新的properties文件名，这样可以轻松的替换全套UI。
CAS客户端配置及API应用
CASFilter的配置
对于大部分web应用而言，使用CAS集成统一认证是相对简单的事，只要为需要认证的URL配置edu.yale.its.tp.cas.client.filter.CASFilter认证过滤器。下面我们就针对过滤器的配置进行说明。首先参看一下Filter的基本配置：
引用
<web-app>
...
<filter>
<filter-name>CAS Filter</filter-name>
<filter-class>edu.yale.its.tp.cas.client.filter.CASFilter</filter-class>
<init-param>
  <param-name>edu.yale.its.tp.cas.client.filter.loginUrl</param-name>
  <param-value><a href="https://secure.its.yale.edu/cas/login" target="_blank">https://secure.its.yale.edu/cas/login</a>&lt;;/param-value&gt;
</init-param>
<init-param>
  <param-name>edu.yale.its.tp.cas.client.filter.validateUrl</param-name>
  <param-value><a href="https://secure.its.yale.edu/cas/serviceValidate" target="_blank">https://secure.its.yale.edu/cas/serviceValidate</a>&lt;;/param-value&gt;
</init-param>
<init-param>
  <param-name>edu.yale.its.tp.cas.client.filter.serverName</param-name>
  <param-value>your server name and port (e.g., www.yale.edu:8080)</param-value>
</init-param>
</filter>
<filter-mapping>
<filter-name>CAS Filter</filter-name>
<url-pattern>/requires-cas-authetication//<em></url-pattern>
</filter-mapping>
...
</web-app>
上述配置中的init-param是filter的3个必备的属性，下面这张表则是filter全部属性的详细说明：
ProxyTicketReceptor的配置
大家还记得在前面我们说过的Proxy Authentication中的call back URL吗？ProxyTicketReceptor是部署在client端的一个servlet，提供server端回传PGT和PGTIOU的。它的xml部署如下：
引用
<web-app>
...
<servlet>
<servlet-name>ProxyTicketReceptor</servlet-name>
<servlet-class>edu.yale.its.tp.cas.proxy.ProxyTicketReceptor</servlet-class>
<init-param>
  <param-name>edu.yale.its.tp.cas.proxyUrl</param-name>
  <param-value><a href="https://secure.its.yale.edu/cas/proxy" target="_blank">https://secure.its.yale.edu/cas/proxy</a>&lt;;/param-value&gt;
</init-param>
</servlet>
<servlet-mapping>
<servlet-name>ProxyTicketReceptor</servlet-name>
<url-pattern>/CasProxyServlet</url-pattern>
</servlet-mapping>
...
</webapp>
这里要说明的是它的参数edu.yale.its.tp.cas.proxyUrl。在服务端通过ProxyTicketReceptor将PGT和PGTIOU传给客户端后，ProxyTicketReceptor在进行Proxy Authentication的过程中需要向服务端请求一个ProxyTicket（PT），这个proxyUrl就是服务端的请求入口了。（关于Proxy Authentication的运作原理，参见JA-SIG（CAS）学习笔记2 ）
CAS Client端的API应用1．用户可以通过以下两种方式的任意一种，从JSP或servlet中获取通过认证的用户名：
引用
String username = (String)session.getAttribute(CASFilter.CAS_FILTER_USER);
或者
String username = (String)session.getAttribute(&quot;edu.yale.its.tp.cas.client.filter.user&quot;);
2．获得更完整的受认证用户信息对象CASReceipt Java Bean，可以使用以下语句的任一:
引用
CASReceipt  receipt = (CASReceipt )session.getAttribute(CASFilter.CAS_FILTER_RECEIPT);
或者
CASReceipt  receipt = (CASReceipt )session.getAttribute(&quot;edu.yale.its.tp.cas.client.filter.receipt&quot;);
3．手工编码使用CAS Java Object进行用户验证，使用ServiceTicketValidator或者 ProxyTicketValidator（代理认证模式下），在servlet中对用户身份进行验证。
3-1．ServiceTicketValidator
Java代码
import edu.yale.its.tp.cas.client./</em>;<br>...<br>String user = null;<br>String errorCode = null;<br>String errorMessage = null;<br>String xmlResponse = null;  </li>
</ol>
<p>//<em> instantiate a new ServiceTicketValidator /</em>/ 
ServiceTicketValidator sv = new ServiceTicketValidator();  </p>
<p>//<em> set its parameters /</em>/ 
sv.setCasValidateUrl(&quot;<a href="https://secure.its.yale.edu/cas/serviceValidate" target="_blank">https://secure.its.yale.edu/cas/serviceValidate</a>&quot;);<br>sv.setService(urlOfThisService);<br>sv.setServiceTicket(request.getParameter(&quot;ticket&quot;));   </p>
<p>String urlOfProxyCallbackServlet = &quot;<a href="https://portal.yale.edu/CasProxyServlet" target="_blank">https://portal.yale.edu/CasProxyServlet</a>&quot;;<br>sv.setProxyCallbackUrl(urlOfProxyCallbackServlet);  </p>
<p>//<em> contact CAS and validate /</em>/ 
sv.validate();  </p>
<p>//<em> if we want to look at the raw response, we can use getResponse() /</em>/ 
xmlResponse = sv.getResponse();  </p>
<p>if(sv.isAuthenticationSuccesful()) {<br>  user = sv.getUser();<br>} else {<br>  errorCode = sv.getErrorCode();<br>  errorMessage = sv.getErrorMessage();<br>}<br>  //<em> The user is now authenticated. /</em>/ 
  //<em> If we did set the proxy callback url, we can get proxy tickets with: /</em>/ 
  String urlOfTargetService = &quot;<a href="http://hkg2.its.yale.edu/someApp/portalFeed" target="_blank">http://hkg2.its.yale.edu/someApp/portalFeed</a>&quot;;<br>  String proxyTicket = ProxyTicketReceptor.getProxyTicket( sv.getPgtIou() , urlOfTargetService); 
import edu.yale.its.tp.cas.client./<em>;
...
String user = null;
String errorCode = null;
String errorMessage = null;
String xmlResponse = null;
//</em> instantiate a new ServiceTicketValidator /<em>/
ServiceTicketValidator sv = new ServiceTicketValidator();
//</em> set its parameters /<em>/
sv.setCasValidateUrl(&quot;<a href="https://secure.its.yale.edu/cas/serviceValidate" target="_blank">https://secure.its.yale.edu/cas/serviceValidate</a>&quot;);
sv.setService(urlOfThisService);
sv.setServiceTicket(request.getParameter(&quot;ticket&quot;));
String urlOfProxyCallbackServlet = &quot;<a href="https://portal.yale.edu/CasProxyServlet" target="_blank">https://portal.yale.edu/CasProxyServlet</a>&quot;;
sv.setProxyCallbackUrl(urlOfProxyCallbackServlet);
//</em> contact CAS and validate /<em>/
sv.validate();
//</em> if we want to look at the raw response, we can use getResponse() /<em>/
xmlResponse = sv.getResponse();
if(sv.isAuthenticationSuccesful()) {
  user = sv.getUser();
} else {
  errorCode = sv.getErrorCode();
  errorMessage = sv.getErrorMessage();
}
  //</em> The user is now authenticated. /<em>/
  //</em> If we did set the proxy callback url, we can get proxy tickets with: /<em>/
  String urlOfTargetService = &quot;<a href="http://hkg2.its.yale.edu/someApp/portalFeed" target="_blank">http://hkg2.its.yale.edu/someApp/portalFeed</a>&quot;;
  String proxyTicket = ProxyTicketReceptor.getProxyTicket( sv.getPgtIou() , urlOfTargetService);
3-2．ProxyTicketValidator
Java代码
import edu.yale.its.tp.cas.client./</em>;<br>...<br>String user = null;<br>String errorCode = null;<br>String errorMessage = null;<br>String xmlResponse = null;<br>List proxyList = null;  </p>
<p>//<em> instantiate a new ProxyTicketValidator /</em>/ 
ProxyTicketValidator pv = new ProxyTicketValidator();   </p>
<p>//<em> set its parameters /</em>/ 
pv.setCasValidateUrl(&quot;<a href="https://secure.its.yale.edu/cas/proxyValidate" target="_blank">https://secure.its.yale.edu/cas/proxyValidate</a>&quot;);<br>pv.setService(urlOfThisService);<br>pv.setServiceTicket(request.getParameter(&quot;ticket&quot;));   </p>
<p>String urlOfProxyCallbackServlet = &quot;<a href="https://portal.yale.edu/CasProxyServlet" target="_blank">https://portal.yale.edu/CasProxyServlet</a>&quot;;<br>pv.setProxyCallbackUrl(urlOfProxyCallbackServlet);   </p>
<p>//<em> contact CAS and validate /</em>/ 
pv.validate();  </p>
<p>//<em> if we want to look at the raw response, we can use getResponse() /</em>/ 
xmlResponse = pv.getResponse();   </p>
<p>//<em> read the response /</em>/ 
if(pv.isAuthenticationSuccesful()) {<br>  user = pv.getUser();<br>  proxyList = pv.getProxyList();<br>} else {<br>  errorCode = pv.getErrorCode();<br>  errorMessage = pv.getErrorMessage();<br>  //<em> handle the error /</em>/ 
}<br>//<em> The user is now authenticated. /</em>/<br>//<em> If we did set the proxy callback url, we can get proxy tickets with this method call: /</em>/<br>String urlOfTargetService = &quot;<a href="http://hkg2.its.yale.edu/someApp/portalFeed" target="_blank">http://hkg2.its.yale.edu/someApp/portalFeed</a>&quot;;<br>String proxyTicket = ProxyTicketReceptor.getProxyTicket( pv.getPgtIou() , urlOfTargetService); 
import edu.yale.its.tp.cas.client./<em>;
...
String user = null;
String errorCode = null;
String errorMessage = null;
String xmlResponse = null;
List proxyList = null;
//</em> instantiate a new ProxyTicketValidator /<em>/
ProxyTicketValidator pv = new ProxyTicketValidator();
//</em> set its parameters /<em>/
pv.setCasValidateUrl(&quot;<a href="https://secure.its.yale.edu/cas/proxyValidate" target="_blank">https://secure.its.yale.edu/cas/proxyValidate</a>&quot;);
pv.setService(urlOfThisService);
pv.setServiceTicket(request.getParameter(&quot;ticket&quot;));
String urlOfProxyCallbackServlet = &quot;<a href="https://portal.yale.edu/CasProxyServlet" target="_blank">https://portal.yale.edu/CasProxyServlet</a>&quot;;
pv.setProxyCallbackUrl(urlOfProxyCallbackServlet);
//</em> contact CAS and validate /<em>/
pv.validate();
//</em> if we want to look at the raw response, we can use getResponse() /<em>/
xmlResponse = pv.getResponse();
//</em> read the response /<em>/
if(pv.isAuthenticationSuccesful()) {
  user = pv.getUser();
  proxyList = pv.getProxyList();
} else {
  errorCode = pv.getErrorCode();
  errorMessage = pv.getErrorMessage();
  //</em> handle the error /<em>/
}
//</em> The user is now authenticated. /<em>/
//</em> If we did set the proxy callback url, we can get proxy tickets with this method call: /*/
String urlOfTargetService = &quot;<a href="http://hkg2.its.yale.edu/someApp/portalFeed" target="_blank">http://hkg2.its.yale.edu/someApp/portalFeed</a>&quot;;
String proxyTicket = ProxyTicketReceptor.getProxyTicket( pv.getPgtIou() , urlOfTargetService);
在这里，我们假设上下文环境中的用户已经通过了CAS登录认证，被重定向到当前的servlet下，我们在servlet中获取ticket凭证，servlet的URL对用户身份进行确认。如果上下文参数中无法获取ticket凭证，我们就认为用户尚未登录，那么，该servlet必须负责将用户重定向到CAS的登录页面去。
初战告捷
      到今天为止，我们已经通过JA-SIG学习笔记的1-3部分，对CAS这个开源SSO的框架有了个大体的了解和初步的掌握，希望这些知识能为各位步入CAS殿堂打开一扇的大门。咖啡希望在今后的工作应用中，能同大家一块共同探讨，进一步深入了解CAS。
学无止境。。。。。。
分享到： <a href="&quot;分享到新浪微博&quot;"><img src="" alt=""></a> <a href="&quot;分享到腾讯微博&quot;"><img src="" alt=""></a></p>
<p><a href="http://lvyanglin.iteye.com/blog/622656" title="cas-server-3.3.2  使用举例" target="_blank">cas-server-3.3.2 使用举例</a> | <a href="http://lvyanglin.iteye.com/blog/615166" title="cas 服务器端的配置" target="_blank">cas 服务器端的配置</a></p>
<ul>
<li>2010-03-17 14:56</li>
<li>浏览 770</li>
<li><a href="http://lvyanglin.iteye.com/blog/618081#comments" target="_blank">评论(0)</a></li>
<li>分类:<a href="http://www.iteye.com/blogs/category/language" target="_blank">编程语言</a></li>
<li><a href="http://www.iteye.com/wiki/blog/618081" target="_blank">相关推荐</a></li>
</ul>
<h3 id="-">评论</h3>
<p><a href=""></a></p>
<h3 id="-">发表评论</h3>
<p><a href="http://lvyanglin.iteye.com/login" target="_blank"><img src="" alt=""></a><a href="http://lvyanglin.iteye.com/login" target="_blank">您还没有登录,请您登录后再发表评论</a></p>
<p><a href="http://lvyanglin.iteye.com/" target="_blank"><img src="&quot;lvyanglin的博客: 老老&quot;" alt="lvyanglin的博客"></a></p>
<p>lvyanglin</p>
<ul>
<li>浏览: 11625 次</li>
<li>性别: <img src="&quot;男&quot;" alt="Icon_minigender_1"></li>
<li>来自: 广州</li>
<li><img src="" alt=""><h3 id="-http-lvyanglin-iteye-com-blog-user_visits-">最近访客 <a href="http://lvyanglin.iteye.com/blog/user_visits" target="_blank">更多访客&gt;&gt;</a></h3>
</li>
</ul>
<p><a href="http://shangyue1110.iteye.com/" target="_blank"><img src="&quot;shangyue1110的博客: &quot;" alt="shangyue1110的博客"></a></p>
<p><a href="http://shangyue1110.iteye.com/" title="shangyue1110" target="_blank">shangyue1110</a></p>
<p><a href="http://dylinshi126.iteye.com/" target="_blank"><img src="&quot;dylinshi126的博客: &quot;" alt="dylinshi126的博客"></a></p>
<p><a href="http://dylinshi126.iteye.com/" title="dylinshi126" target="_blank">dylinshi126</a>
<a href="http://dada7020.iteye.com/" target="_blank"><img src="&quot;dada7020的博客: &quot;" alt="dada7020的博客"></a></p>
<p><a href="http://dada7020.iteye.com/" title="dada7020" target="_blank">dada7020</a></p>
<p><a href="http://k175981998.iteye.com/" target="_blank"><img src="&quot;k175981998的博客: &quot;" alt="k175981998的博客"></a></p>
<p><a href="http://k175981998.iteye.com/" title="k175981998" target="_blank">k175981998</a></p>
<h3 id="-">文章分类</h3>
<ul>
<li><a href="http://lvyanglin.iteye.com/" target="_blank">全部博客 (35)</a></li>
<li><a href="http://lvyanglin.iteye.com/category/67638" target="_blank">java (20)</a></li>
<li><a href="http://lvyanglin.iteye.com/category/67639" target="_blank">数据库 (5)</a></li>
<li><a href="http://lvyanglin.iteye.com/category/67640" target="_blank">其他 (5)</a></li>
<li><a href="http://lvyanglin.iteye.com/category/187499" target="_blank">在centsos上安装chrome (1)</a></li>
<li><a href="http://lvyanglin.iteye.com/category/194903" target="_blank">centos 安装 (1)</a></li>
<li><p><a href="http://lvyanglin.iteye.com/category/220785" target="_blank">学习linux (0)</a></p>
<h3 id="-">社区版块</h3>
</li>
<li><p><a href="http://lvyanglin.iteye.com/blog/news" target="_blank">我的资讯</a> (0)</p>
</li>
<li><a href="http://lvyanglin.iteye.com/blog/post" target="_blank">我的论坛</a> (0)</li>
<li><a href="http://lvyanglin.iteye.com/blog/answered_problems" target="_blank">我的问答</a> (1)</li>
</ul>
<h3 id="-">存档分类</h3>
<ul>
<li><a href="http://lvyanglin.iteye.com/blog/monthblog/2011-12" target="_blank">2011-12</a> (2)</li>
<li><a href="http://lvyanglin.iteye.com/blog/monthblog/2011-11" target="_blank">2011-11</a> (1)</li>
<li><a href="http://lvyanglin.iteye.com/blog/monthblog/2011-05" target="_blank">2011-05</a> (2)</li>
<li><p><a href="http://lvyanglin.iteye.com/blog/monthblog_more" target="_blank">更多存档...</a></p>
<h3 id="-">最新评论</h3>
</li>
<li><p><a href="http://403577706.iteye.com/" title="403577706" target="_blank">403577706</a>： sudo apt-get build-dep /#(packag ...
<a href="http://lvyanglin.iteye.com/blog/800337#bc2250038" target="_blank">sudo apt-get -f install</a>
声明：ITeye文章版权属于作者，受法律保护。没有作者书面许可不得转载。若作者同意转载，必须以超链接形式标明文章原始出处和作者。
© 2003-2011 ITeye.com. All rights reserved. [ 京ICP证110151号 京公网安备110105010620 ]
<img src="" alt=""></p>
</li>
</ul>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/CAS/">CAS</a></li></span></span> | <span class="tags">Tagged <a href="/tags/CAS/" class="label label-primary">CAS</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:39"datetime="2014-03-07 09:54:39"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-CAS--casclient使用指南-老老-ITeye技术网站/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-CAS--casclient使用指南-老老-ITeye技术网站" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-CAS--GatewayJasigCommunity/">Gateway   Jasig Community</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:39.000Z"> <a href="/2014/02/02/2014-02-02-CAS--GatewayJasigCommunity/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="gateway-jasig-community">Gateway Jasig Community</h1>
<p><a href="http://www.jasig.org/cas/client-integration/gateway#content" target="_blank">Skip to Content</a></p>
<p><a href="http://www.jasig.org/" title="Home" target="_blank"><img src="" alt="Home"></a></p>
<ul>
<li><a href="http://www.jasig.org/uportal" title="uPortal" target="_blank"><img src="" alt="uPortal logo"></a></li>
<li><a href="http://www.jasig.org/cas" title="CAS" target="_blank"><img src="" alt="CAS logo"></a></li>
<li><a href="http://www.jasig.org/bedework" title="Bedework" target="_blank"><img src="" alt="Bedework logo"></a></li>
<li><a href="http://www.jasig.org/2-3-98" title="2-3-98" target="_blank"><img src="" alt="2-3-98 logo"></a></li>
<li><a href="http://www.jasig.org/portlets" title="uPortal" target="_blank"><img src="" alt="Portlets logo"></a></li>
<li><a href="http://www.jasig.org/umobile" title="uMobile" target="_blank"><img src="" alt="uMobile logo"></a></li>
<li><a href="http://www.jasig.org/jasig-project-incubation" title="Jasig Incubator" target="_blank"><img src="" alt="Jasig Incubator logo"></a></li>
</ul>
<p>Search this site:</p>
<h3 id="primary-links">Primary links</h3>
<ul>
<li><a href="http://www.jasig.org/" title="Jasig Home" target="_blank">Home</a></li>
<li><p><a href="http://www.jasig.org/projects" title="Projects" target="_blank">Projects</a></p>
</li>
<li><p><a href="http://www.jasig.org/umobile" title="Overview" target="_blank">uMobile</a></p>
</li>
<li><p><a href="http://www.jasig.org/umobile" title="uMoible" target="_blank">Overview</a></p>
</li>
<li><p><a href="http://www.jasig.org/node/828" title="uMobile FAQ" target="_blank">uMobile FAQ</a></p>
</li>
<li><a href="http://www.jasig.org/umobile/see-it" title="See It" target="_blank">See It</a></li>
<li><p><a href="http://www.jasig.org/umobile/download" title="Download uMobile" target="_blank">Get It</a></p>
</li>
<li><p><a href="http://www.jasig.org/umobile/about/license" title="License" target="_blank">License</a></p>
</li>
<li><p><a href="http://www.jasig.org/umobile/support" title="Support" target="_blank">Support</a></p>
</li>
<li><p><a href="http://www.jasig.org/umobile/support/documentation" title="Documentation" target="_blank">Documentation</a></p>
</li>
<li><a href="http://www.jasig.org/umobile/support/solutions-providers" title="Solutions Providers" target="_blank">Solutions Providers</a></li>
<li><p><a href="http://www.jasig.org/umobile/community" title="Community" target="_blank">Community</a></p>
</li>
<li><p><a href="http://www.jasig.org/umobile/mailing-lists" title="uMobile Mailing Lists" target="_blank">Mailing Lists</a></p>
</li>
<li><p><a href="http://www.jasig.org/uportal" title="Overview" target="_blank">uPortal</a></p>
</li>
<li><p><a href="http://www.jasig.org/uportal" title="uPortal" target="_blank">Overview</a></p>
</li>
<li><a href="http://www.jasig.org/uportal/see-it" title="See It" target="_blank">See It</a></li>
<li><p><a href="http://www.jasig.org/uportal/download" title="Download uPortal" target="_blank">Get It</a></p>
</li>
<li><p><a href="http://www.jasig.org/uportal/download/all" title="All uPortal Releases" target="_blank">All Releases</a></p>
</li>
<li><a href="http://www.jasig.org/uportal/about/license" title="License" target="_blank">License</a></li>
<li><p><a href="http://www.jasig.org/uportal/support" title="Support" target="_blank">Support</a></p>
</li>
<li><p><a href="http://www.jasig.org/uportal/documentation" title="Documentation" target="_blank">Documentation</a></p>
</li>
<li><a href="http://www.jasig.org/uportal/support/solutions-providers" title="Solutions Providers" target="_blank">Solutions Providers</a></li>
<li><a href="http://www.jasig.org/uportal/documentation/faq" title="uPortal FAQ" target="_blank">uPortal FAQ</a></li>
<li><p><a href="http://www.jasig.org/uportal/community" title="Community" target="_blank">Community</a></p>
</li>
<li><p><a href="http://www.jasig.org/uportal/mailing-lists" title="uPortal Mailing Lists" target="_blank">Mailing lists</a></p>
</li>
<li><a href="http://www.jasig.org/uportal/steering-committee" title="uPortal steering committee" target="_blank">Steering Committee</a></li>
<li><a href="http://www.jasig.org/uportal/deployments" target="_blank">Deployments</a></li>
<li><a href="http://www.jasig.org/uportal/community/uportal-screencasts" title="uPortal Screencasts" target="_blank">Screencasts</a></li>
<li><a href="http://www.jasig.org/uportal/features" title="Features" target="_blank">Features</a></li>
<li><a href="http://www.jasig.org/uportal/benefits" title="Benefits" target="_blank">Benefits</a></li>
<li><a href="http://www.jasig.org/uportal/news" target="_blank">News</a></li>
<li><a href="http://www.jasig.org/uportal/events" target="_blank">Events</a></li>
<li><a href="http://www.jasig.org/uportal/about" title="About" target="_blank">About</a></li>
<li><p><a href="http://www.jasig.org/cas" title="CAS" target="_blank">CAS</a></p>
</li>
<li><p><a href="http://www.jasig.org/cas/community" title="Community" target="_blank">Community</a></p>
</li>
<li><p><a href="http://www.jasig.org/cas/mailing-lists" title="CAS Mailing Lists" target="_blank">Mailing Lists</a></p>
</li>
<li><a href="http://www.jasig.org/cas/deployments" target="_blank">Deployments</a></li>
<li><a href="http://www.jasig.org/cas/documentation" title="Documentation" target="_blank">CAS In Print</a></li>
<li><a href="http://www.jasig.org/cas/integrators" title="CAS Integrators" target="_blank">Integrators</a></li>
<li><a href="http://www.jasig.org/cas/download" title="Download CAS Server" target="_blank">Download</a></li>
<li><a href="http://www.jasig.org/cas/news" target="_blank">News &amp; Events</a></li>
<li><p><a href="http://www.jasig.org/cas/client-integration" title="CAS Client Integration" target="_blank">Client integration</a></p>
</li>
<li><p><a href="http://www.jasig.org/cas/client-integration/faq" title="FAQ" target="_blank">FAQ</a></p>
</li>
<li><a href="&quot;Gateway&quot;">Gateway</a></li>
<li><a href="http://www.jasig.org/cas/client-integration/renew" title="Renew: Opting out of SSO" target="_blank">Renew</a></li>
<li><p><a href="http://www.jasig.org/cas/server-deployment" title="Server Deployment" target="_blank">Server Deployment</a></p>
</li>
<li><p><a href="http://www.jasig.org/cas/server-deployment/faq" title="FAQ" target="_blank">FAQ</a></p>
</li>
<li><p><a href="http://www.jasig.org/cas/developers" title="Developers" target="_blank">Developers</a></p>
</li>
<li><p><a href="http://www.jasig.org/cas/roadmap" title="CAS Roadmap" target="_blank">Roadmap</a></p>
</li>
<li><a href="http://www.jasig.org/cas/source-repository" title="CAS Source Repository" target="_blank">Source Repository</a></li>
<li><a href="http://www.jasig.org/cas/public-api" title="Public APIs" target="_blank">Public APIs</a></li>
<li><a href="http://www.jasig.org/cas/using-maven" title="Building the CAS Project Using Maven" target="_blank">Using Maven</a></li>
<li><a href="http://www.jasig.org/cas/protocol" title="CAS Protocol" target="_blank">Protocol</a></li>
<li><p><a href="http://www.jasig.org/cas/support" title="Support" target="_blank">Support</a></p>
</li>
<li><p><a href="http://www.jasig.org/cas/support/solutions-providers" title="Solutions Providers" target="_blank">Solutions Providers</a></p>
</li>
<li><p><a href="http://www.jasig.org/cas/about" title="About" target="_blank">About</a></p>
</li>
<li><p><a href="http://www.jasig.org/cas/cas1-architecture" title="CAS 1 Architecture" target="_blank">CAS 1 Architecture</a></p>
</li>
<li><a href="http://www.jasig.org/cas/cas2-architecture" title="CAS 2 Architecture" target="_blank">CAS 2 Architecture</a></li>
<li><a href="http://www.jasig.org/cas/proxy-authentication" title="Why do we need proxy authentication?" target="_blank">Proxy Authentication</a></li>
<li><a href="http://www.jasig.org/cas/steering-committee" title="CAS Steering Committee" target="_blank">Steering Committee</a></li>
<li><a href="http://www.jasig.org/cas/license" title="License" target="_blank">License</a></li>
<li><a href="http://www.jasig.org/cas/team" title="The CAS Team" target="_blank">The Team</a></li>
<li><p><a href="http://www.jasig.org/bedework" title="Bedework" target="_blank">Bedework</a></p>
</li>
<li><p><a href="http://www.jasig.org/bedework/overview" title="Bedework Overview" target="_blank">Overview</a></p>
</li>
<li><p><a href="http://www.jasig.org/bedework/features" title="Bedework Features" target="_blank">Features</a></p>
</li>
<li><a href="http://www.jasig.org/bedework/news" title="Bedework News and Events" target="_blank">News &amp; Events</a></li>
<li><a href="http://www.jasig.org/bedework/whosusing" title="Who&#39;s Using Bedework" target="_blank">Who&#39;s Using Bedework</a></li>
<li><a href="http://www.jasig.org/bedework/standards" title="Calendar Standards" target="_blank">Calendar Standards</a></li>
<li><a href="http://www.jasig.org/bedework/publications" title="Bedework Publications" target="_blank">Publications</a></li>
<li><a href="http://www.jasig.org/bedework/support/solutions-providers" title="Solutions Providers" target="_blank">Solutions Providers</a></li>
<li><p><a href="http://www.jasig.org/bedework/download" title="Download Bedework" target="_blank">Download</a></p>
</li>
<li><p><a href="http://www.jasig.org/bedework/license" title="Bedework License" target="_blank">License</a></p>
</li>
<li><a href="http://www.jasig.org/bedework/download/coderepository" title="Bedework Code Repository" target="_blank">Code Repository</a></li>
<li><a href="http://www.jasig.org/bedework/download/archives" title="Bedework Release Archives" target="_blank">Archives</a></li>
<li><a href="http://www.jasig.org/bedework/download/changelog" title="Bedework Change Log" target="_blank">Change Log</a></li>
<li><a href="http://www.jasig.org/bedework/documentation" title="Bedework Documentation" target="_blank">Documentation</a></li>
<li><p><a href="http://www.jasig.org/bedework/community" title="Community" target="_blank">Community</a></p>
</li>
<li><p><a href="http://www.jasig.org/bedework/deployments" title="Bedework Deployments" target="_blank">Deployments</a></p>
</li>
<li><a href="http://www.jasig.org/bedework/steering-committee" title="Bedework Steering Committee" target="_blank">Steering Committee</a></li>
<li><a href="http://www.jasig.org/bedework/development" title="Bedework Development &amp; Roadmap" target="_blank">Development</a></li>
<li><a href="http://www.jasig.org/bedework/contributors" title="Bedework Contributors" target="_blank">Contributors</a></li>
<li><a href="http://www.jasig.org/bedework/mailing-lists" target="_blank">Mailing Lists</a></li>
<li><a href="http://www.jasig.org/bedework/ticketing" title="Bug Database" target="_blank">Bug Database</a></li>
<li><p><a href="http://www.jasig.org/bedework/about" title="About" target="_blank">About</a></p>
</li>
<li><p><a href="http://www.jasig.org/bedework/about/timeline" title="Bedework Timeline" target="_blank">Timeline</a></p>
</li>
<li><a href="http://www.jasig.org/bedework/about/libraries" title="Library usage" target="_blank">Library Usage</a></li>
<li><a href="http://www.jasig.org/bedework/about/bede" title="Bede" target="_blank">Bede</a></li>
<li><a href="http://www.jasig.org/bedework/mailing-lists" title="Contacting Bedework" target="_blank">Contact Us</a></li>
<li><a href="http://www.jasig.org/2-3-98" title="2/3/98 Project" target="_blank">2-3-98 Project</a></li>
<li><p><a href="http://www.jasig.org/portlets" title="Portlets" target="_blank">Portlets</a></p>
</li>
<li><p><a href="http://www.jasig.org/portlets/mailing-lists" title="Portlet Mailing Lists" target="_blank">Mailing lists</a></p>
</li>
<li><a href="http://www.jasig.org/jasig-project-incubation" title="Project Incubation" target="_blank">Project Incubation</a></li>
<li><p><a href="http://www.jasig.org/jasig-community" title="Community" target="_blank">Community</a></p>
</li>
<li><p><a href="http://www.jasig.org/jasig-membership" title="Membership" target="_blank">Membership</a></p>
</li>
<li><p><a href="http://www.jasig.org/jasig-membership-institutional-members" title="Jasig Institutional Members" target="_blank">Institutional members</a></p>
</li>
<li><a href="http://www.jasig.org/jasig-membership-partners" title="Jasig Partners" target="_blank">Partners</a></li>
<li><a href="http://www.jasig.org/jasig-membership-affiliates" title="Jasig Affiliates" target="_blank">Affiliates</a></li>
<li><a href="http://www.jasig.org/jasig-membership-types" title="Membership Comparison" target="_blank">Membership Comparison</a></li>
<li><p><a href="http://www.jasig.org/jasig-support" title="Support" target="_blank">Support</a></p>
</li>
<li><p><a href="http://www.jasig.org/jasig-support/solutions-providers" title="Solution Providers" target="_blank">Solutions Providers</a></p>
</li>
<li><p><a href="http://www.jasig.org/jasig-conferences-events" title="Conferences &amp; Events" target="_blank">Conferences &amp; Events</a></p>
</li>
<li><p><a href="http://www.jasig.org/jasig-conferences-events-archives" title="Archives" target="_blank">Archives</a></p>
</li>
<li><a href="http://www.jasig.org/conf/2010/spring" target="_blank">Videos</a></li>
<li><a href="http://www.jasig.org/jasig-news-events" target="_blank">News</a></li>
<li><a href="http://www.jasig.org/jasig/blogs" title="Jasig Blogs" target="_blank">Blogs</a></li>
<li><p><a href="http://www.jasig.org/jasig-newsletters" title="Jasig Newsletters" target="_blank">Newsletters</a></p>
</li>
<li><p><a href="http://www.jasig.org/jasig-newsletters/july-2010" title="JASIG NEWSLETTER - JULY 2010" target="_blank">201007 - July 2010</a></p>
</li>
<li><a href="http://www.jasig.org/jasig-newsletters/august-2010" title="JASIG NEWSLETTER - AUGUST 2010" target="_blank">201008 - August 2010</a></li>
<li><a href="http://www.jasig.org/jasig-newsletters/september-2010" title="JASIG NEWSLETTER - SEPTEMBER 2010" target="_blank">201009 - September 2010</a></li>
<li><a href="http://www.jasig.org/jasig-newsletters/october-2010" title="JASIG NEWSLETTER - OCTOBER 2010" target="_blank">201010 - October 2010</a></li>
<li><a href="http://www.jasig.org/jasig-newsletters/november-2010" title="JASIG NEWSLETTER - NOVEMBER 2010" target="_blank">201011 - November 2010</a></li>
<li><a href="http://www.jasig.org/jasig-newsletters/december-2010" title="JASIG NEWSLETTER - DECEMBER 2010" target="_blank">201012 - December 2010</a></li>
<li><a href="http://www.jasig.org/jasig-newsletters/jasig-newsletter-janua" title="JASIG NEWSLETTER - JANUARY 2011" target="_blank">201101 - January 2011</a></li>
<li><a href="http://www.jasig.org/jasig-newsletters/march-2011" title="JASIG NEWSLETTER - MARCH 2011" target="_blank">201103 - March 2011</a></li>
<li><a href="http://www.jasig.org/jasig-newsletters/june-2011" title="JASIG NEWSLETTER - JUNE 2011" target="_blank">201106 - June 2011</a></li>
<li><a href="http://www.jasig.org/jasig-newsletters/september-2011" title="JASIG NEWSLETTER - SEPTEMBER 2011" target="_blank">201109 - September 2011</a></li>
<li><a href="http://www.jasig.org/jasig-newsletters/october-2011" title="JASIG NEWSLETTER - OCTOBER 2011" target="_blank">201110 - October 2011</a></li>
<li><a href="http://www.jasig.org/jasig-newsletters/november-2011" title="JASIG NEWSLETTER - NOVEMBER 2011" target="_blank">201111 - November 2011</a></li>
<li><a href="http://www.jasig.org/jasig-newsletters/january-2012" title="JASIG NEWSLETTER - JANUARY 2012" target="_blank">201201 - January 2012</a></li>
<li><a href="http://www.jasig.org/jasig-newsletters/february-2012" title="JASIG NEWSLETTER - FEBRUARY 2012" target="_blank">201202 - February 2012</a></li>
<li><a href="http://www.jasig.org/jasig-newsletters/march-2012" title="JASIG NEWSLETTER - MARCH 2012" target="_blank">201203 - March 2012</a></li>
<li><a href="http://www.jasig.org/jasig-newsletters/april-2012" title="JASIG NEWSLETTER - APRIL 2012" target="_blank">201204 - April 2012</a></li>
<li><a href="http://www.jasig.org/jasig-newsletters/may-2012" title="JASIG NEWSLETTER - MAY 2012" target="_blank">201205 - May 2012</a></li>
<li><p><a href="http://www.jasig.org/mailing-lists" title="Jasig Community Mailing Lists" target="_blank">Mailing Lists</a></p>
</li>
<li><p><a href="http://www.jasig.org/mailing-lists/jasig" title="Jasig Mailing Lists" target="_blank">Jasig</a></p>
</li>
<li><a href="http://www.jasig.org/mailing-lists/gaps" title="Groups &amp; Permissions Mailing Lists" target="_blank">Groups &amp; Permissions</a></li>
<li><a href="http://www.jasig.org/mailing-lists/jira" title="JIRA Notifications Mailing Lists" target="_blank">JIRA</a></li>
<li><a href="http://www.jasig.org/mailing-lists/person-directory" title="Person Directory Mailing Lists" target="_blank">Person Directory</a></li>
<li><p><a href="http://www.jasig.org/jasig/contribute" title="Contribute to Jasig" target="_blank">Contribute</a></p>
</li>
<li><p><a href="http://www.jasig.org/jasig/contribute" target="_blank">How to Contribute to Jasig</a></p>
</li>
<li><a href="http://www.jasig.org/jasig/contribute/donations" title="Donations" target="_blank">Donate</a></li>
<li><a href="http://www.jasig.org/jasig/contribute/sponsorship" title="Sponsorship" target="_blank">Sponsor</a></li>
<li><p><a href="http://www.jasig.org/about" title="About" target="_blank">About</a></p>
</li>
<li><p><a href="http://www.jasig.org/jasig-governance" title="Governance" target="_blank">Governance</a></p>
</li>
<li><a href="http://www.jasig.org/jasig-steering-committees" title="Steering Committees" target="_blank">Steering Committees</a></li>
<li><a href="http://www.jasig.org/about/acknowledgements" title="Acknowledgements" target="_blank">Acknowledgements</a></li>
<li><a href="http://www.jasig.org/why-open-source" title="Why Open Source" target="_blank">Why Open Source</a></li>
<li><a href="http://www.jasig.org/licensing" title="Jasig Licensing Policy" target="_blank">Licensing Policy</a></li>
<li><a href="http://www.jasig.org/jasig-contact-us" title="Contact Us" target="_blank">Contact</a></li>
</ul>
<h3 id="cas">CAS</h3>
<ul>
<li><a href="http://www.jasig.org/cas/community" title="Community" target="_blank">Community</a></li>
<li><a href="http://www.jasig.org/cas/download" title="Download CAS Server" target="_blank">Download</a></li>
<li><a href="http://www.jasig.org/cas/news" target="_blank">News &amp; Events</a></li>
<li><p><a href="http://www.jasig.org/cas/client-integration" title="CAS Client Integration" target="_blank">Client integration</a></p>
</li>
<li><p><a href="http://www.jasig.org/cas/client-integration/faq" title="FAQ" target="_blank">FAQ</a></p>
</li>
<li><a href="&quot;Gateway&quot;">Gateway</a></li>
<li><a href="http://www.jasig.org/cas/client-integration/renew" title="Renew: Opting out of SSO" target="_blank">Renew</a></li>
<li><a href="http://www.jasig.org/cas/server-deployment" title="Server Deployment" target="_blank">Server Deployment</a></li>
<li><a href="http://www.jasig.org/cas/developers" title="Developers" target="_blank">Developers</a></li>
<li><a href="http://www.jasig.org/cas/support" title="Support" target="_blank">Support</a></li>
<li><a href="http://www.jasig.org/cas/about" title="About" target="_blank">About</a></li>
</ul>
<h3 id="join-the-discussion">Join the Discussion</h3>
<ul>
<li><a href="http://www.jasig.org/mailing-lists" target="_blank">All lists</a></li>
<li><a href="http://www.jasig.org/mailing-lists/jasig" target="_blank">Jasig lists</a></li>
<li><a href="http://www.jasig.org/uportal/mailing-lists" target="_blank">uPortal lists</a></li>
<li><a href="http://www.jasig.org/cas/mailing-lists" target="_blank">CAS lists</a></li>
<li><a href="http://www.jasig.org/portlets/mailing-lists" target="_blank">Portlet lists</a></li>
<li><a href="http://www.jasig.org/bedework/mailing-lists" target="_blank">Bedework lists</a></li>
</ul>
<p><a href="http://www.addtoany.com/share_save?linkurl=http%3A%2F%2Fwww.clearinghouse.ja-sig.org%2Fnode%2F&amp;linkname=" target="_blank"><img src="" alt="Share/Save"></a></p>
<p><a href="http://www.jasig.org/" target="_blank">Home</a> » <a href="http://www.jasig.org/projects" target="_blank">Projects</a> » <a href="http://www.jasig.org/cas" target="_blank">CAS</a> » <a href="http://www.jasig.org/cas/client-integration" target="_blank">Client integration</a> » <a href="">Gateway</a></p>
<h1 id="gateway">Gateway</h1>
<p>This page documents the Gateway feature of the CAS protocol and the protocol-implementing CAS Server.</p>
<h3 id="what-is-the-gateway-feature-">What is the Gateway feature?</h3>
<p>CAS Server includes a feature whereby you can set the request parameter &quot;gateway&quot; to &quot;true&quot; on the request for CAS login. If &quot;gateway&quot; is &quot;true&quot;, then CAS will not paint the user login screen. If it can accomplish authentication by single sign on - that is, by detecting the CAS ticket granting cookie - then it will redirect to the URL specified by the &quot;service&quot; parameter with a valid service ticket. If it cannot accomplish single sign on, then it will redirect to the &quot;service&quot; URL without painting any login screen.</p>
<p>This allows your application to detect and take advantage of user single sign on without bothering the user with a login screen in the case where he or she is not yet logged on. This is useful for main pages and is probably a &quot;best practice&quot;, since it allows the user to learn about the service to which he might authenticate before being abruptly presented with the CAS login screen out of context.</p>
<h3 id="what-is-required-of-a-cas-client-to-support-this-feature-">What is required of a CAS Client to support this feature?</h3>
<p>A gateway-supporting CAS client should:</p>
<ol>
<li>provide a mechanism for the application developer/deployer/htaccess writer to elect the gateway behavior</li>
<li><p>when gateway is elected:</p>
</li>
<li><p>set the request parameter &quot;gateway&quot; to be &quot;true&quot; on the CAS login request</p>
</li>
<li>provide a way to indentify the request when it is redirected back from CAS as one that has already been gatewayed (e.g., a special parameter on the URL-encoded &quot;service&quot;, setting a cookie, using already-present session support from your environment, etc.)</li>
<li>receive requests redirected back from CAS. These may have the &quot;ticket&quot; parameter set, in which case validate the ticket, etc. If gatewaying failed to pick up a single sign on session, the request will be for the URL specified as the &quot;service&quot; parameter &quot;bare&quot; - the &quot;ticket&quot; parameter will not be set, and CAS does not set any other parameter to indicate that it had gatewayed. The client needs to recognize the request as having already come through gateway. The client should not redirect already-gatewayed requests back to CAS for more gatewaying, because this will lead to an infinite loop of redirecting back and forth between server and client.</li>
</ol>
<p>CAS is authentication, not authorization. The standard use case for CAS is that the client application wants to consume the authenticated username. Under gateway, when there is no authenticated username because we came back from CAS ticketless, the client should do something like returning &quot;null&quot; when the client application asks for the authenticated username, or fail to set the remote user header, or put null into the session where the application expected to lookup the authenticated user, etc., as applicable to the CAS client implementation.</p>
<p>In the case where one is using CAS for authorization (probably a bad idea in the first place) - users able to authenticate are authorized to access the resource, and users unable to authenticate are not authorized - then GATEWAY should not be used.
© 2009 Jasig. All rights reserved.  |  Design and hosting by <a href="http://www.webchuckweb.com/" target="_blank">WebChuck Web</a>.</p>
<p><img src="" alt=""></p>
<p><a href="http://www.jasig.org/cas/client-integration/gateway#" target="_blank"></a><a href="http://www.jasig.org/cas/client-integration/gateway#"></a></p>
<p><a href="http://www.jasig.org/cas/client-integration/gateway#"></a></p>
<p><a href="http://www.jasig.org/cas/client-integration/gateway#" target="_blank"></a><a href="http://www.jasig.org/cas/client-integration/gateway#"></a></p>
<p><a href="http://www.jasig.org/cas/client-integration/gateway#" target="_blank"></a><a href="http://www.jasig.org/cas/client-integration/gateway#"></a><a href="http://www.jasig.org/cas/client-integration/gateway#" target="_blank"></a><a href="http://www.jasig.org/cas/client-integration/gateway#"></a><a href="http://www.jasig.org/cas/client-integration/gateway#"></a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/CAS/">CAS</a></li></span></span> | <span class="tags">Tagged <a href="/tags/CAS/" class="label label-primary">CAS</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:39"datetime="2014-03-07 09:54:39"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-CAS--GatewayJasigCommunity/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-CAS--GatewayJasigCommunity" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-CAS--UseJavascriptRedirection-CASUserManual-Jas/">Use Javascript Redirection </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:39.000Z"> <a href="/2014/02/02/2014-02-02-CAS--UseJavascriptRedirection-CASUserManual-Jas/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="use-javascript-redirection-cas-user-manual-jasig-wiki">Use Javascript Redirection - CAS User Manual - Jasig Wiki</h1>
<ul>
<li><a href="https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#title-heading" target="_blank">Skip to content</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#breadcrumbs" target="_blank">Skip to breadcrumbs</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#header-menu-bar" target="_blank">Skip to header menu</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#navigation" target="_blank">Skip to action menu</a></li>
<li><p><a href="https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#quick-search-query" target="_blank">Skip to quick search</a>
Quick Search</p>
</li>
<li><p><a href="https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#" target="_blank">Browse</a></p>
</li>
<li><p><a href="https://wiki.jasig.org/pages/listpages.action?key=CASUM" title="Browse pages in the CAS User Manual space ( Type &#39;g&#39; then &#39;s" target="_blank">Pages</a>&quot;)</p>
</li>
<li><a href="https://wiki.jasig.org/pages/viewrecentblogposts.action?key=CASUM" title="Browse blogs in the CAS User Manual space" target="_blank">Blog</a></li>
<li><a href="https://wiki.jasig.org/labels/listlabels-heatmap.action?key=CASUM" title="Browse labels in the CAS User Manual space" target="_blank">Labels</a></li>
<li><a href="https://wiki.jasig.org/spaces/listattachmentsforspace.action?key=CASUM" title="Browse attachments in the CAS User Manual space" target="_blank">Attachments</a></li>
<li><a href="https://wiki.jasig.org/mail/archive/viewmailarchive.action?key=CASUM" title="Browse mail in the CAS User Manual space" target="_blank">Mail</a></li>
<li><a href="https://wiki.jasig.org/spaces/viewspacesummary.action?key=CASUM" title="Browse additional space functions in the CAS User Manual space" target="_blank">Advanced</a></li>
<li><p><a href="https://wiki.jasig.org/spaces/usage/report.action?key=CASUM" target="_blank">Activity</a></p>
</li>
<li><p><a href="http://docs.atlassian.com/confluence/docs-41/whatsnew/iframe" target="_blank">What’s New</a></p>
</li>
<li><a href="https://wiki.jasig.org/spacedirectory/view.action" title="Browse the Confluence space directory" target="_blank">Space Directory</a></li>
<li><a href="https://wiki.jasig.org/dashboard/configurerssfeed.action" title="Create your custom RSS feed." target="_blank">Feed Builder</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#" title="View available keyboard shortcuts ( Type &#39;?" target="_blank">Keyboard Shortcuts</a>&quot;)</li>
<li><a href="https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#" title="Browse gadgets provided by Confluence" target="_blank">Confluence Gadgets</a></li>
<li><a href="https://wiki.jasig.org/login.action?os_destination=%2Fdisplay%2FCASUM%2FUse%2BJavascript%2BRedirection" target="_blank">Log In</a></li>
<li><a href="https://wiki.jasig.org/signup.action" target="_blank">Sign Up</a></li>
</ul>
<ol>
<li><a href="https://wiki.jasig.org/dashboard.action" title="Go to Dashboard ( Type &#39;g&#39; then &#39;d" target="_blank">Dashboard</a>&quot;)</li>
<li><a href="https://wiki.jasig.org/display/CASUM" target="_blank">CAS User Manual</a></li>
<li><strong>…</strong></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Navigation" target="_blank">Navigation</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Advanced+Topics" target="_blank">Advanced Topics</a></li>
<li><a href="">Use Javascript Redirection</a></li>
</ol>
<ul>
<li><p><a href="https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#" target="_blank">Tools</a></p>
</li>
<li><p><a href="https://wiki.jasig.org/pages/viewpageattachments.action?pageId=12157004" title="View Attachments ( Type &#39;t" target="_blank">Attachments (0)</a>&quot;)</p>
</li>
<li><a href="https://wiki.jasig.org/pages/viewpreviousversions.action?pageId=12157004" target="_blank">Page History</a></li>
<li><p><a href="https://wiki.jasig.org/pages/viewinfo.action?pageId=12157004" title="Edit restrictions" target="_blank">Restrictions</a></p>
</li>
<li><p><a href="https://wiki.jasig.org/pages/viewinfo.action?pageId=12157004" target="_blank">Info</a></p>
</li>
<li><a href="https://wiki.jasig.org/pages/viewinfo.action?pageId=12157004" title="Link to this Page ( Type &#39;k" target="_blank">Link to this Page…</a>&quot;)</li>
<li><a href="https://wiki.jasig.org/pages/listpages-dirview.action?key=CASUM&amp;openId=12157004#selectedPageInHierarchy" target="_blank">View in Hierarchy</a></li>
<li><a href="https://wiki.jasig.org/plugins/viewsource/viewpagesrc.action?pageId=12157004" target="_blank">View Source</a></li>
</ul>
<h1 id="-use-javascript-redirection-"><a href="">Use Javascript Redirection</a></h1>
<p><a href="https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#page-metadata-end" target="_blank">Skip to end of metadata</a></p>
<ul>
<li><a href="https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#" title="Page restrictions apply. Click the lock icon to view or edit the restriction." target="_blank">Page restrictions apply</a></li>
<li>Added by <a href="https://wiki.jasig.org/display/~dale77" target="_blank">Dale Ogilvie</a>, last edited by <a href="https://wiki.jasig.org/display/~dale77" target="_blank">Dale Ogilvie</a> on Apr 30, 2008  (<a href="https://wiki.jasig.org/pages/diffpages.action?pageId=12157004&amp;originalId=52495846" target="_blank">view change</a>)</li>
<li><a href="https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#" target="_blank">show comment</a> <a href="https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#" target="_blank">hide comment</a>
<strong>Comment:</strong> Corrected links that should have been relative instead of absolute.
<a href="https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#page-metadata-start" target="_blank">Go to start of metadata</a>   Table of Contents</li>
</ul>
<h3 id="-home-https-wiki-jasig-org-display-casum-home-"><a href="https://wiki.jasig.org/display/CASUM/Home" target="_blank">Home</a></h3>
<h3 id="-overall-architecture-https-wiki-jasig-org-display-casum-overall-architecture-"><a href="https://wiki.jasig.org/display/CASUM/Overall+Architecture" target="_blank">Overall Architecture</a></h3>
<ul>
<li><a href="https://wiki.jasig.org/display/CASUM/Building+and+Deploying" target="_blank">Building and Deploying</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Development" target="_blank">Development</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Introduction" target="_blank">Introduction</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Java+Versions" target="_blank">Java Versions</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Releasing" target="_blank">Releasing</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Spring+Configuration" target="_blank">Spring Configuration</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Technical+Overview" target="_blank">Technical Overview</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Upgrading" target="_blank">Upgrading</a></li>
</ul>
<h3 id="-authentication-https-wiki-jasig-org-display-casum-authentication-"><a href="https://wiki.jasig.org/display/CASUM/Authentication" target="_blank">Authentication</a></h3>
<ul>
<li><a href="https://wiki.jasig.org/display/CASUM/Active+Directory" target="_blank">Active Directory</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Generic" target="_blank">Generic</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/JAAS" target="_blank">JAAS</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/JDBC" target="_blank">JDBC</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/LDAP" target="_blank">LDAP</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Legacy" target="_blank">Legacy</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/RADIUS" target="_blank">RADIUS</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/SPNEGO" target="_blank">SPNEGO</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Trusted" target="_blank">Trusted</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/X.509+Certificates" target="_blank">X.509 Certificates</a></li>
</ul>
<h3 id="-authentication-managers-https-wiki-jasig-org-display-casum-authentication-managers-"><a href="https://wiki.jasig.org/display/CASUM/Authentication+Managers" target="_blank">Authentication Managers</a></h3>
<ul>
<li><a href="https://wiki.jasig.org/display/CASUM/Default+AuthenticationManager" target="_blank">Default AuthenticationManager</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Direct+Mapping+AuthenticationManager" target="_blank">Direct Mapping AuthenticationManager</a></li>
</ul>
<h3 id="-security-policy-https-wiki-jasig-org-display-casum-security-policy-"><a href="https://wiki.jasig.org/display/CASUM/Security+Policy" target="_blank">Security Policy</a></h3>
<ul>
<li><a href="https://wiki.jasig.org/display/CASUM/Ticket+Expiration+Policy" target="_blank">Ticket Expiration Policy</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Remember+Me" target="_blank">Remember Me</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Throttling+Login+Attempts" target="_blank">Throttling Login Attempts</a></li>
</ul>
<h3 id="-ticketregistry-https-wiki-jasig-org-display-casum-ticketregistry-"><a href="https://wiki.jasig.org/display/CASUM/TicketRegistry" target="_blank">TicketRegistry</a></h3>
<ul>
<li><a href="https://wiki.jasig.org/display/CASUM/BerkleyDB" target="_blank">BerkleyDB</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Default" target="_blank">Default</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/EhcacheTicketRegistry" target="_blank">EhcacheTicketRegistry</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/JBOSS+TreeCache" target="_blank">JBOSS TreeCache</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/JDBCTicketRegistry" target="_blank">JDBCTicketRegistry</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/JpaTicketRegistry" target="_blank">JpaTicketRegistry</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/MemcacheTicketRegistry" target="_blank">MemcacheTicketRegistry</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/TicketRegistry+Cleaner" target="_blank">TicketRegistry Cleaner</a></li>
</ul>
<h3 id="-testing-https-wiki-jasig-org-display-casum-testing-"><a href="https://wiki.jasig.org/display/CASUM/Testing" target="_blank">Testing</a></h3>
<ul>
<li><a href="https://wiki.jasig.org/display/CASUM/Apache+JMeter" target="_blank">Apache JMeter</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Java+HttpComponents+Based+Test+Class" target="_blank">Java HttpComponents Based Test Class</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Nagios+plugins" target="_blank">Nagios plugins</a></li>
</ul>
<h3 id="-protocols-https-wiki-jasig-org-display-casum-protocols-"><a href="https://wiki.jasig.org/display/CASUM/Protocols" target="_blank">Protocols</a></h3>
<ul>
<li><a href="https://wiki.jasig.org/display/CASUM/Add+Your+Custom+Protocol" target="_blank">Add Your Custom Protocol</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Applications+that+Require+POST+Responses" target="_blank">Applications that Require POST Responses</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/CAS" target="_blank">CAS</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/OAuth" target="_blank">OAuth</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/OpenID" target="_blank">OpenID</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/RESTful+API" target="_blank">RESTful API</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/SAML+1.1" target="_blank">SAML 1.1</a></li>
<li><a href="https://wiki.jasig.org/pages/viewpage.action?pageId=6063484" target="_blank">SAML 2.0 (Google Accounts Integration)</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Single+Sign+Out" target="_blank">Single Sign Out</a></li>
</ul>
<h3 id="-advanced-topics-https-wiki-jasig-org-display-casum-advanced-topics-"><a href="https://wiki.jasig.org/display/CASUM/Advanced+Topics" target="_blank">Advanced Topics</a></h3>
<ul>
<li><a href="https://wiki.jasig.org/pages/viewpage.action?pageId=13570204" target="_blank">Adding &quot;Public Workstation&quot; vs. &quot;Private Workstation&quot; Timeouts</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Auditing+and+Statistics+Via+Inspektr" target="_blank">Auditing and Statistics Via Inspektr</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Internationalization" target="_blank">Internationalization</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/LDAP+Password+Policy+Enforcement" target="_blank">LDAP Password Policy Enforcement</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Second-Level+CAS+Server" target="_blank">Second-Level CAS Server</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Terracotta" target="_blank">Terracotta</a></li>
<li><a href="">Use Javascript Redirection</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Deployment+Scenarios" target="_blank">Deployment Scenarios</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Acceptable+Use+interface+for+Login+Webflow" target="_blank">Acceptable Use interface for Login Webflow</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Change+Password+Integration+With+Jasig+CAS+3.4.7" target="_blank">Change Password Integration With Jasig CAS 3.4.7</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Localization" target="_blank">Localization</a></li>
</ul>
<h3 id="-tutorials-and-howtos-https-wiki-jasig-org-display-casum-tutorials-and-howtos-"><a href="https://wiki.jasig.org/display/CASUM/Tutorials+and+HOWTOs" target="_blank">Tutorials and HOWTOs</a></h3>
<ul>
<li><a href="https://wiki.jasig.org/display/CASUM/CAS+on+Windows+Quick+Setup+Guide" target="_blank">CAS on Windows Quick Setup Guide</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Clustering+CAS" target="_blank">Clustering CAS</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Demo" target="_blank">Demo</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/HOWTO+Configure+JBoss+for+HTTPS" target="_blank">HOWTO Configure JBoss for HTTPS</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/HOWTO+Configure+Single+Sign+On+Session+Timeout" target="_blank">HOWTO Configure Single Sign On Session Timeout</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/HOWTO+Setup+Dual+Authentication+in+CAS+-+SSL+Client+Auth+and+LDAP" target="_blank">HOWTO Setup Dual Authentication in CAS - SSL Client Auth and LDAP</a></li>
<li><a href="https://wiki.jasig.org/pages/viewpage.action?pageId=10650669" target="_blank">HOWTO Setup LDAP GSSAPI+Kerberos Authentication in CAS</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/HOWTO+Switch+to+Sun+JVM+in+RHEL" target="_blank">HOWTO Switch to Sun JVM in RHEL</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/End-to-end+Windows+Example" target="_blank">End-to-end Windows Example</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/HOWTO+Use+Jasypt+to+encrypt+passwords+in+configuration+files" target="_blank">HOWTO Use Jasypt to encrypt passwords in configuration files</a></li>
<li><a href="https://wiki.jasig.org/pages/viewpage.action?pageId=47874068" target="_blank">HOWTO utilize javax.servlet.http.HttpServletRequest isUserInRole( java.lang.String role )</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Migrating+an+existing+CAS+server+installation" target="_blank">Migrating an existing CAS server installation</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Best+Practice+-+Setting+Up+CAS+Locally+using+the+Maven2+WAR+Overlay+Method" target="_blank">Best Practice - Setting Up CAS Locally using the Maven2 WAR Overlay Method</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Deploying+CAS+3.0.x+in+RHEL+5+with+Sun+Java" target="_blank">Deploying CAS 3.0.x in RHEL 5 with Sun Java</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/HOWTO+CASifying+ASP.NET+WebApp+-+ExampleWebsite" target="_blank">HOWTO CASifying ASP.NET WebApp - ExampleWebsite</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/HOWTO+Configure+CAS+for+LDAP+DIGEST-MD5" target="_blank">HOWTO Configure CAS for LDAP DIGEST-MD5</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/HOWTO+Run+Canoo+Web+Tests" target="_blank">HOWTO Run Canoo Web Tests</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Shibboleth-CAS+Integration" target="_blank">Shibboleth-CAS Integration</a></li>
</ul>
<h3 id="-troubleshooting-https-wiki-jasig-org-display-casum-troubleshooting-"><a href="https://wiki.jasig.org/display/CASUM/Troubleshooting" target="_blank">Troubleshooting</a></h3>
<ul>
<li><a href="https://wiki.jasig.org/display/CASUM/Logging" target="_blank">Logging</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/SSL+Troubleshooting+and+Reference+Guide" target="_blank">SSL Troubleshooting and Reference Guide</a></li>
</ul>
<h3 id="-services-management-https-wiki-jasig-org-display-casum-services-management-"><a href="https://wiki.jasig.org/display/CASUM/Services+Management" target="_blank">Services Management</a></h3>
<ul>
<li><a href="https://wiki.jasig.org/display/CASUM/Adding+a+New+Service" target="_blank">Adding a New Service</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Attributes" target="_blank">Attributes</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Configuring" target="_blank">Configuring</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Deleting" target="_blank">Deleting</a></li>
<li><a href="https://wiki.jasig.org/display/CASUM/Editing" target="_blank">Editing</a></li>
</ul>
<h3 id="-extensions-https-wiki-jasig-org-display-casum-extensions-"><a href="https://wiki.jasig.org/display/CASUM/Extensions" target="_blank">Extensions</a></h3>
<ul>
<li><a href="https://wiki.jasig.org/display/CASUM/ClearPass" target="_blank">ClearPass</a>
When redirecting from the https CAS application back to an http service after authenticating successfully, IE6 presents the user with a security dialog saying &quot;you are about to be redirected to a connection that is not secure, do you really want to do this?&quot;. We can avoid this by using javascript to perform the redirection in the client browser, instead of a server side redirect. This approach works fine for web pages, but does not work for protected image content, which will not execute the returned javascript, so we revert to a serverside redirect for this type of content.</li>
</ul>
<ol>
<li>Create WEB-INF/view/jsp/default/ui/redirect.jsp to perform the redirection using javascript
<a href="https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#" target="_blank">?</a>&lt;%</li>
</ol>
<p>@page</p>
<p>import</p>
<p>=</p>
<p>&quot;org.jasig.cas.authentication.principal.WebApplicationService&quot;</p>
<p>%&gt;</p>
<p>&lt;%</p>
<p>@page</p>
<p>import</p>
<p>=</p>
<p>&quot;org.jasig.cas.web.support.WebUtils&quot;</p>
<p>%&gt;
&lt;%</p>
<p>@page</p>
<p>import</p>
<p>=</p>
<p>&quot;java.net.URL&quot;</p>
<p>%&gt;</p>
<p>&lt;%
WebApplicationService service = (WebApplicationService) request.getAttribute(</p>
<p>&quot;service&quot;</p>
<p>);</p>
<p>String ticket  = (String) request.getAttribute(</p>
<p>&quot;serviceTicketId&quot;</p>
<p>);
String redirectURL = service.getResponse(ticket).getUrl();</p>
<p>boolean</p>
<p>serverSideRedirect =</p>
<p>false</p>
<p>;
// if redirect is for an image, js or css file</p>
<p>URL url =</p>
<p>new</p>
<p>URL(redirectURL);
String path = url.getPath();</p>
<p>int</p>
<p>dotPos = path.lastIndexOf(</p>
<p>&quot;.&quot;</p>
<p>);</p>
<p>// returns -1 if not found
if</p>
<p>( dotPos != -</p>
<p>1</p>
<p>)</p>
<p>{</p>
<p>String ext = path.substring(dotPos).toLowerCase();</p>
<p>serverSideRedirect =</p>
<p>&quot;.gif&quot;</p>
<p>.equals(ext) ||</p>
<p>&quot;.jpg&quot;</p>
<p>.equals(ext) ||</p>
<p>&quot;.png&quot;</p>
<p>.equals(ext) ||</p>
<p>&quot;.js&quot;</p>
<p>.equals(ext) ||</p>
<p>&quot;.css&quot;</p>
<p>.equals(ext);
}</p>
<p>if</p>
<p>( serverSideRedirect )
{</p>
<p>// Serverside redirect using HTTP 302</p>
<p>response.sendRedirect(redirectURL);</p>
<p>}
else</p>
<p>{</p>
<p>// Client side redirect using javascript</p>
<p>%&gt;
&lt;!DOCTYPE html PUBLIC</p>
<p>&quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;</p>
<p>&quot;<a href="http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd" target="_blank"><a href="http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd</a>&quot;</a></p>
<p>&gt;</p>
<html xmlns=

"[http://www.w3.org/1999/xhtml"](http://www.w3.org/1999/xhtml)

>


<head>



<script type=

"text/javascript"

language=

"javascript"

>


<!--



window.location.replace (

"<%=redirectURL%>"

);


-->



</script>


<title>Redirect</title>



</head>


<body></body>

<p></html>
&lt;%</p>
<p>}
%&gt;</p>
<ol>
<li>Make a redirect view available to CAS by adding it to WEB-INF/classes/default_view.properties</li>
</ol>
<p><a href="https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#" target="_blank">?</a>/#/#/# Redirect view (logged in, javascript redirect to service)</p>
<p>redirectView.(</p>
<p>class</p>
<p>)=org.springframework.web.servlet.view.JstlView
redirectView.url=/WEB-INF/view/jsp/</p>
<p>default</p>
<p>/ui/redirect.jsp</p>
<ol>
<li>Modify WEB-INF/login-webflow.xml to make the redirect end state use the new view</li>
</ol>
<p><a href="https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#" target="_blank">?</a>&lt;end-state id=</p>
<p>&quot;redirect&quot;</p>
<p>view=</p>
<p>&quot;redirectView&quot;</p>
<p>/&gt;</p>
<p>Labels:</p>
<p>None</p>
<p><a href="https://wiki.jasig.org/display/CASUM/Use+Javascript+Redirection#" title="Edit Labels ( Type &#39;l" target="_blank">Edit Labels</a>&quot;)
Powered by a free <strong>Atlassian Confluence Open Source Project License</strong> granted to Java Architectures Special Interest Group. <a href="http://www.atlassian.com/c/conf/11461" target="_blank">Evaluate Confluence today</a>.
This Confluence installation runs a Free Gliffy License - <a href="http://www.gliffy.com/products/confluence-plugin/" target="_blank">Evaluate Gliffy</a> for your Wiki!</p>
<ul>
<li>Powered by <a href="http://www.atlassian.com/software/confluence" target="_blank">Atlassian Confluence</a> 4.1.5, the <a href="http://www.atlassian.com/software/confluence/tour/enterprise-wiki.jsp" target="_blank">Enterprise Wiki</a></li>
<li>Printed by Atlassian Confluence 4.1.5, the Enterprise Wiki.</li>
<li>·  <a href="http://jira.atlassian.com/secure/BrowseProject.jspa?id=10470" target="_blank">Report a bug</a></li>
<li>·  <a href="http://www.atlassian.com/about/connected.jsp?s_kwcid=Confluence-stayintouch" target="_blank">Atlassian News</a></li>
</ul>
<p><a href=""></a><a href=""></a><a href=""></a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/CAS/">CAS</a></li></span></span> | <span class="tags">Tagged <a href="/tags/CAS/" class="label label-primary">CAS</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:39"datetime="2014-03-07 09:54:39"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-CAS--UseJavascriptRedirection-CASUserManual-Jas/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-CAS--UseJavascriptRedirection-CASUserManual-Jas" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-安全--黑客经典之恶意SSH登录企图分析/">黑客经典之恶意SSH登录企图分析</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:39.000Z"> <a href="/2014/02/02/2014-02-02-安全--黑客经典之恶意SSH登录企图分析/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-ssh-">黑客经典之恶意SSH登录企图分析</h1>
<p>黑客经典之恶意SSH登录企图分析</p>
<p>原文链接：<a href="http://www.securitycn.net/html/research/service/1395.html" target="_blank">http://www.securitycn.net/html/research/service/1395.html</a></p>
<p>恶意SSH登录企图出现在一些管理者的日志中已经有几年的时间了。本文回顾了使用&quot;蜜罐&quot;（honeypot）对恶意SSH登录企图进行分析的方法，并提出了我们可以从这一活动中学到的东西。接着本文给出了关于如何使自己的系统安全面对这些攻击的建议。</p>
<p>使用honeypots进行研究</p>
<p>新西兰Honeynet（蜜罐网络）联盟是Honeynet联盟的一个成员研究机构，它致力于通过使用蜜罐技术研究黑帽子黑客（black hat hackers，指那些恶意入侵计算机或计算机网络并尽其所能进行破坏的黑客）的行为、策略和工具来提升计算机系统和网络安全。蜜罐的价值在于它们是可以公开接受攻击并被攻入的开放计算机系统，这使得研究者可以分析该系统上的恶意行为。</p>
<p>我们已经在惠灵顿的维多利亚大学建立起这样的系统来研究发生于新西兰大学网络上的恶意行为。该系统是一个高度互联的蜜罐，一个攻击者可以像在网络的任何其他系统上一样与之联系。在攻击者可知的范围内，蜜罐与其他计算机系统应该没有可分辨的差别。然而，所有流入和流出蜜罐的网络流量都通过Honeynet联盟的Roo honeywall严密监控。此外，系统事件也被蜜罐自身通过其日志功能进行记录。</p>
<p>蜜罐上运行的是标准RedHad 9服务器配置版本，带有可以通过公共互联网访问的安全外壳（Secure Shell，简称SSH）服务器。SSH是可以使得一个用户在网上通过加密通道登录到另一台电脑的程序。在过去的配置下遭遇到恶意SSH登录企图后，我们重新编配了我们的蜜罐以使其可以收集更多的数据。我们对SSH服务器打了补丁以同时记录在登录企图中使用的帐户名和密码。该蜜罐在2006年7月11日上线，在22天后的2006年8月1日下线。在这期间，该蜜罐受到了无数次的SSH登录企图攻击。我们进一步观察这些数据以确定攻击者的策略并提出提高 SSH安全水平的建议。</p>
<p>在该蜜罐在6月28日到7月4日运行的另一个配置上，我们增加了可以在系统被攻入后记录攻击者键盘操作的Sebek模块。我们设置了若干具有常用密码的用户帐户。几天后，一个攻击者成功进入了这一系统。在本文中给出了对这一攻击及后续攻击的分析，并提供了对恶意SSH登录企图如何被用于攻入系统的进一步分析。</p>
<p>对SSH登录企图的分析</p>
<p>这一部分分析了7月11日到8月1日我们的蜜罐捕获的数据。该分析完全基于蜜罐的系统日志文件，尤其是&quot;messages&quot;日志。&quot;messages&quot;日志记录了对SSH服务器的验证请求。它记录了日期、时间、登录企图发生的IP地址、请求的结果（失败或成功）以及验证使用的帐户名和密码。下面是两个&quot;messages&quot;的日志示例条目：</p>
<p>Jul 13 09:37:59 basta sshd[22308]: PW-ATTEMPT: fritz</p>
<p>Jul 13 09:37:59 basta sshd[22308]: Failed password for root from 10.0.160.14</p>
<p> port 39529 ssh2</p>
<p>Jul 13 09:38:02 basta sshd[22310]: Illegal user fatacunike from 10.0.160.14</p>
<p>Jul 13 09:38:02 basta sshd[22310]: PW-ATTEMPT: fatacunike</p>
<p>Jul 13 09:38:02 basta sshd[22310]: Failed password for illegal user fatacunike</p>
<p> from 10.0.160.14 port 40444 ssh2</p>
<p>首先，我们分析了用于登录企图的用户名。在取样时间内，系统日志总共记录到2741 个不同的帐户名，包括从常见的姓氏、系统帐户名和常用帐户名到短的字符串。在这些帐户名中，15个使用频率最高的帐户名被列于表1。该表格显示有一个系统上通常存在的帐户（root，mysql）、可能存在的帐户（guest、test）以及常见的姓氏（paul）。随后图1给出了所使用过的有效与无效帐户名的分布。</p>
<p>所使用的无效帐户名远多于有效帐户名并不奇怪，但是我们注意到在蜜罐上存在的所有默认帐户名中96.30%都被攻击利用。</p>
<p><img src="" alt=""></p>
<p>表1 2741次攻击中出现最多的15个帐户名</p>
<p><img src="" alt=""></p>
<p>（Number of Account Names Used in Attack：攻击中使用的帐户名数量；</p>
<p>Number of Account Names on System：系统中的帐户名数量</p>
<p>Existing Account：有效帐户</p>
<p>Invalid Account：无效帐户）</p>
<p>图1 有效与无效帐户名数量</p>
<p>&quot;成功&quot;的恶意SSH登录企图</p>
<p>在上面的部分中，我们分析了对于没有成功的恶意SSH登录企图数据的记录。这些数据可以使我们进一步理解这些攻击者如何操作，但是还有很多问题没有解决，其中之一是这些攻击中是否使用了工具软件。</p>
<p>7月2日，有一名攻击者通过猜测出一个SSH上的有效帐户名/密码成功地侵入了蜜罐。在这一事件中捕获的数据揭示了这些问题的答案。</p>
<p>首先我们观察了该黑客成功入侵蜜罐后进行的操作。确定了有效的帐户名/密码后，该黑客通过SSH登入蜜罐并继而下载了一个SSH扫描工具。在下面一节将更详细地介绍该工具，这里我们先将其总结为一个可以允许其使用者通过猜测密码的尝试识别并入侵其它SSH服务器的工具。这一工具安装后立刻被用来从我们的蜜罐中扫描B类网络。由于Roo honeywall对于向网络外部的连接施加的限制，该SSH扫描工具并未发现任何SSH服务器。</p>
<p>在最初的扫描后，攻击者继续下载并安装一个IRC僵尸（IRC Bot）。IRC僵尸是可以在远程通过IRC聊天通道控制一个被入侵的系统的工具，其中被入侵的系统被设定为可以通过该通道被监听。使用IRC来控制一个被入侵的系统比直接使用SSH要隐蔽得多，因为此时攻击者不再需要直接登入系统。此外，它还使得攻击者可以同时控制多个这样的系统（它们被称为 Zombies，还魂尸)。</p>
<p>IRC通道中的会话表明，Zombies被用于使用类似于被下载到我们的蜜罐上那样的SSH扫描工具扫描B类网络。在几个小时的时间里，有4个B类网络被来自不同IRC僵尸的SSH扫描工具扫描。一次扫描大约需要700秒的时间完成。此外，我们还目睹了一个帐户名/密码列表与160,324个不同的帐户名/密码组合之间的信息交换。这些帐户名与密码的结构与对我们的蜜罐系统进行攻击时使用的那些非常相似，但比它们范围更广。</p>
<p>分析总结</p>
<p>从这些被我们的蜜罐记录的数据中我们可以得到什么？SSH是一种可以通过安全、加密的方式在网络中访问一台电脑的方法，已经被广泛接受。然而，尽管其在安全方面名誉很好，在一台电脑上操作SSH仍然会面临威胁。如我们在本文中所示的那样，密码猜测显然是威胁之一。仅SSH服务器正在运行并可经互联网连接这一事实就吸引了23次来自独立IP的攻击，在22天内我们的蜜罐共受到6,899 次登录企图。这相当于大约平均每天1次攻击、约300次登录尝试。一些攻击者的攻击非常执着，在每次攻击中执行了上百次登录尝试。</p>
<p>扫描工具的数据记录显示有非常强有力的工具被使用。它们十分灵活并且可以使用用户定制的帐户名/密码列表进行攻击。如果一个攻击者想攻击一个特定的域，他们或许可以通过社会工程获取帐户名，然而将这些帐户名于将在攻击中使用的标准密码组合。通过观察一个IRC僵尸通道，我们发现攻击者们将扫描工具与IRC僵尸计数结合来通过Zombies（攻击者通过远程通道控制的被入侵的系统）进行扫描。</p>
<p>与一系列IRC僵尸结合后，一个攻击者只需要525个Zombies就可以在1天内扫描当今公共互联网的整个IP4。如果你有一个可以被公开访问的SSH服务器，你很可能就会成为这些攻击的目标。</p>
<p>安全建议</p>
<p>有很多简单的方法可以防范这些攻击。最显而易见的方式就是关闭在很多系统中被默认安装的daemon服务。如果一个计算机系统被作为桌面电脑，很可能没有必要用通过SSH的远程访问登入该电脑。如果该方式对你不适用，还有很多其他的选择：</p>
<p>·使用大多数Unix和Linux系统中的/etc/hosts.allow和/etc/hosts.deny文件限制对特定主机的daemon访问。</p>
<p>·安装一个防火墙以限制只允许指定的电脑与网络访问SSH服务器。这在来自内部网络一台电脑的管理员必须对该电脑远程操作时尤其适用。</p>
<p>·限制SSH服务器只允许经过验证的特定用户和组登录。</p>
<p>·将SSH服务器监听端口从22调整到其他未被使用的端口。尽管这样做不会阻止攻击者连接到服务器并开始猜测密码，但它会显著降低发现你的SSH daemon的可能性，因为黑客使用的是标准SSH客户端而且假定SSH服务器的攻击工具是运行于标准的22端口上的。</p>
<p>·除了简单的密码外使用其他验证方法。下面有关于这点的更多介绍。如果你无法选择这一方法，确保正在使用的密码或验证短语安全程度高而且是比较复杂的。</p>
<p>SSH提供了另一种可以成功地减少密码猜测攻击的验证方法。这一验证方法是基于密钥的，或者说是所谓的私钥与公钥。公钥被置于服务器端作为访问你的帐户的用户锁。该锁只能被对应的私钥开启。一旦你提供了该私钥，你就可以获得访问权限。由于攻击者无法猜测或生成这一私钥，密码猜测攻击将失败。所有流行的SSH服务器默认状态下都被设置为支持这一验证方法。然而，它们通常在提供的私钥错误时重新回到基于密码的验证过程，这再次为密码猜测攻击提供了方便。为使这一降低风险的策略成功，这些服务器需要被重新设定为只接受基于密钥的验证。</p>
<p>建立使用密钥的SSH十分简单，只需要几分钟的时间。先前Brian Hatch的文章已经谈及了关于个人用户和SSH服务器间安全访问的SSH用户身份。SSH主机密钥保护一文中提供了关于每台服务器所生成的主机密钥的更多信息。如果使用SSH密钥，读者可能希望获得更多SSH于ssh-agent的例子以便更快更容易地通过SSH登录。</p>
<p>在一些例子中，对一个SSH服务器基于密码的验证或访问无法被禁用。在这种情况下，需要采用其他措施。我们已经看到攻击者猜测帐户名并且对现有系统的帐户以及在通常的计算机系统中的帐户了如指掌。如果该攻击者可以猜到系统中存在的一个帐户名——对于我们的蜜罐，在Redhat蜜罐系统中96.30%的默认帐户名被猜到——则该攻击者已经在该电脑的门口踏入了一步。因此，我们建议不要使用很容易被猜到的帐户名，例如那些常见的姓氏。不要使用&quot;Peter&quot;、&quot;Ian&quot;、或&quot;Mark&quot;，而是建立包括有姓和名的组合的帐户名，例如 &quot;seifer_chr&quot;。这可以通过控制帐户名分配的管理员做到。</p>
<p>此外，我们已经看到&quot;root&quot;帐户是在攻击中使用最多的帐户名，因为它通常都存在于计算机系统中。我们建议禁用该帐户的远程访问权限，取而代之的是管理员应该先通过一般用户帐户再使用&quot;su&quot;（超级用户指令）获得该root帐户的权限。</p>
<p>攻击者经常试图猜测在大多数系统上默认存在的长湖，例如ftp和mysql。如果 shell外壳与这些帐户关联，那么只有通过这些帐户才能访问外壳。对于ftp或mysql这样其存在只为运行电脑上某服务的帐户，外壳是不需要的并且应该被禁用，这可以有效地阻止通过SSH使用这些帐户远程登录。</p>
<p>除了使用无法被猜到的帐户名外，使用安全性强的用户密码也是很重要的。我们已经看到在攻击中使用的密码通常与帐户名相同或者是帐户名加上一些数列。我们推测攻击者们选择这些密码因为它们在恶意登录企图中是最&quot;成功&quot;的。这表明至少有些用户将他们的密码设置为这些很容易被猜到的字符串。系统管理员阻止用户选用这样的密码的唯一方法是通过安装各种工具软件（例如passwd+）强制用户使用安全性高的密码。</p>
<p>攻击者们正在使用工具进行密码猜测和登录尝试，例如被记录的扫描工具、QT和 55hb。然而，尽管有这些工具存在，由于SSH服务器端内置的对于失败登录企图的故意延迟以及各种网络延迟，登录尝试的最短平均时间也需要约2秒。尽管这提供了对于暴力攻击的防范，对于安全性差的帐户名和密码只需要少数几次尝试与猜测就可以侵入系统。以上所描述的安全措施应该被安装以保证安全工作的广泛与深入。</p>
<p>未来的工作</p>
<p>我们的分析是基于我们的蜜罐捕获的数据进行的。我们无法确定这些攻击对于网络上可以找到的系统成功的概率有多大。为了确定成功率，我们需要将这些攻击中使用的帐户名/密码组合与在真实系统中存在的帐户名/密码组合进行比较。此外，我们提出了将SSH服务器监听端口改到其他未占用的端口。我们需要建立这样配置的系统以评估其有效性。</p>
<p>关于作者</p>
<p>Christian Seifert是新西兰Honeynet联盟的成员。</p>
<p>致谢</p>
<p>感谢Jamie Riden提供降低密码猜测风险的策略以及对实际SSH密码猜测工具的参考。</p>
<p>本篇文章来源于 中国安全网-安全您的网络 原文链接：<a href="http://www.securitycn.net/html/research/service/1395.html" target="_blank">http://www.securitycn.net/html/research/service/1395.html</a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/安全/">安全</a></li></span></span> | <span class="tags">Tagged <a href="/tags/安全/" class="label label-primary">安全</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:39"datetime="2014-03-07 09:54:39"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-安全--黑客经典之恶意SSH登录企图分析/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-安全--黑客经典之恶意SSH登录企图分析" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-CAS--cas_presentation/">cas_presentation</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:39.000Z"> <a href="/2014/02/02/2014-02-02-CAS--cas_presentation/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="cas_presentation">cas_presentation</h1>
<p><img src="" alt=""> A detailed walk through a CAS authentication
(and how to get your mits on the authenticated user)
●
Welcome! First of all, what is CAS?
●
●
Web single sign on Uses “federated” authentication, where all authentication is done by the CAS server, instead of individual application servers The implementation is an open source protocol, open source Java server, and several open source clients Purdue runs a CAS server, configured to authenticate with Purdue Career Account (<a href="https://www.purdue.edu/apps/account/cas" target="_blank">https://www.purdue.edu/apps/account/cas</a>) As of 4/5/2011, 349 application servers are authorized to check CAS tickets More can be found at:
– –
●
●
●
●
●
<a href="http://www.jasig.org/cas" target="_blank">http://www.jasig.org/cas</a> <a href="https://www.purdue.edu/apps/account/docs/CAS/CAS_information.jsp" target="_blank">https://www.purdue.edu/apps/account/docs/CAS/CAS_information.jsp</a>
Purdue University Identity and Access Management 1
4/7/2011
<img src="" alt=""> A detailed walk through a CAS authentication
(and how to get your mits on the authenticated user)
●
There are three machines in this game
●
a) Browser b) Application server
–
●
Configured with a CAS client to require authentication for certain urls Serves CAS login web page and authenticates users Issues TGT cookie (ticket granting ticket) so user does not have to login every redirect to CAS server Redirects back to application server with ticket=ST-xxx service ticket in url for CAS client to check Validates CAS service tickets for application servers
●
c) CAS server (<a href="http://www.jasig.org/cas" target="_blank">http://www.jasig.org/cas</a>)
– –
–
–
4/7/2011
Purdue University Identity and Access Management
2
<img src="" alt=""> A detailed walk through a CAS authentication
(and how to get your mits on the authenticated user)
Browser
1) initial request 2) redirect to CAS login page with service=url_back_to_sampleapp_page
sampleapp
CAS server
3) request CAS login page 4) html for CAS login page 5) POST login and password 6) set CASTGC cookie and redirect to sampleapp with ticket=ST-xxx 7) back to initial request, with ticket=ST-xxx (the service ticket) 10) sampleapp responds with application page 9)ticket validation response 8) validate ST-xxx service ticket
4/7/2011
Purdue University Identity and Access Management
3
<img src="" alt=""> A detailed walk through a CAS authentication
(and how to get your mits on the authenticated user)
●
Step 1 – initial request
●
“sampleapp” application server is configured with a CAS client to require authentication for certain urls (in this example /test) User with browser accesses /test on sampleapp If browser does not already have session on sampleapp, sampleapp transfers control to the CAS client If the CAS client does not see a ticket parameter in the request, user is redirected back to the CAS login page with service=url_to_return_to, in this example <a href="http://localhost:8080/sampleapp/test" target="_blank">http://localhost:8080/sampleapp/test</a>
●
●
●
4/7/2011
Purdue University Identity and Access Management
4
<img src="" alt=""> A detailed walk through a CAS authentication
(and how to get your mits on the authenticated user)
●
Step 2 – redirect to CAS login page
●
User is redirected back to CAS server for authentication Application server (sampleapp) logs
●
2011­03­29 09:16:46,843 DEBUG  [org.jasig.cas.client.authentication.AuthenticationFilter] ­ <no ticket and no  assertion found> 2011­03­29 09:16:46,843 DEBUG  [org.jasig.cas.client.authentication.AuthenticationFilter] ­ <Constructed service  url: http://localhost:8080/sampleapp/test/> 2011­03­29 09:16:46,844 DEBUG  [org.jasig.cas.client.authentication.AuthenticationFilter] ­ <redirecting to  "https://www.purdue.edu/apps/account/cas­server­uber­webapp­3.4.6/login?service= 2F%2Flocalhost%3A8080%2Fsampleapp%2Ftest%2F"> application server access log: 0:0:0:0:0:0:0:1 ­ ­ [29/Mar/2011:09:16:46 ­0400] &quot;GET /sampleapp/test/ HTTP/1.1&quot;  302 ­
4/7/2011
Purdue University Identity and Access Management
5
<img src="" alt=""> A detailed walk through a CAS authentication
(and how to get your mits on the authenticated user)
●
Step 3 – browser requests CAS login page
●
CAS server checks for its CASTGC cookie (ticket granting ticket), if it&#39;s there, user is already authenticated via CAS, skip to step 6 and redirect back to sampleapp with a service ticket If no CASTGC is present, serve browser the CAS login page CAS server access log:
●
●
0:0:0:0:0:0:0:1 ­ ­ [29/Mar/2011:09:16:47 ­0400] &quot;GET /cas­server­uber­webapp­ 3.4.6/login?service=http%3A%2F%2Flocalhost%3A8080%2Fsampleapp%2Ftest%2F HTTP/1.1&quot;  200 6935
4/7/2011
Purdue University Identity and Access Management
6
<img src="" alt=""> A detailed walk through a CAS authentication
(and how to get your mits on the authenticated user)
●
Step 4 – CAS server sends login page to browser
●
This is nice because application servers do not need to
– – –
maintain their own login page maintain login/password credentials to do the actual authentication even see the password, it&#39;s between the browser and CAS server
4/7/2011
Purdue University Identity and Access Management
7
<img src="" alt=""> A detailed walk through a CAS authentication
(and how to get your mits on the authenticated user)
●
Step 5 – browser POSTs login/password to CAS server
●
CAS server checks login and password, if authentication fails serve another login page to browser Too many unsuccessful authentication attempts in a short period of time will result in a “lockout”, where authentication will always fail for a 15 minute lockout period CAS server access log:
●
●
0:0:0:0:0:0:0:1 ­ ­ [29/Mar/2011:09:16:52 ­0400] &quot;POST /cas­server­uber­webapp­ 3.4.6/login?service=http%3A%2F%2Flocalhost%3A8080%2Fsampleapp%2Ftest%2F HTTP/1.1&quot;  302 ­
4/7/2011
Purdue University Identity and Access Management
8
<img src="" alt=""> A detailed walk through a CAS authentication
(and how to get your mits on the authenticated user)
●
Step 6 – CAS server redirects back to application server
●
A ticket granting ticket TGT-xxx is stored on the CAS server, and set as a CASTGC cookie A service ticket is issued for the application (<a href="http://localhost:8080/sampleapp/test/" target="_blank">http://localhost:8080/sampleapp/test/</a>) and sent as a parameter back to the application server
●
2011­03­29 09:16:52,208 DEBUG  [org.jasig.cas.web.support.CookieRetrievingCookieGenerator] ­ <Added cookie with  name [CASTGC] and value [TGT­1­wKQjkOhweJE6MMTNCqTwv6WojMDBL61GISejnyCfigrMFCumYu­ cas]> 2011­03­29 09:16:52,214 DEBUG [org.jasig.cas.ticket.registry.DefaultTicketRegistry]  ­ <Added ticket [ST­1­bdgbwHIReBonmaudvxJl­cas] to registry.> 2011­03­29 09:16:52,214 INFO [org.jasig.cas.CentralAuthenticationServiceImpl] ­  <Granted service ticket [ST­1­bdgbwHIReBonmaudvxJl­cas] for service  [http://localhost:8080/sampleapp/test/] for user [jott]>
4/7/2011
Purdue University Identity and Access Management
9
<img src="" alt=""> A detailed walk through a CAS authentication
(and how to get your mits on the authenticated user)
●
Step 7 – browser re-requests url from application server, with a CAS service ticket
●
Application server still has not yet established a session, so CAS client takes control CAS client sees a ticket parameter in the url, that can be checked with the CAS server CAS service ticket is only valid one time, and the CAS client needs to use it within 90 seconds or it will expire
●
●
4/7/2011
Purdue University Identity and Access Management
10
<img src="" alt=""> A detailed walk through a CAS authentication
(and how to get your mits on the authenticated user)
●
Step 8 – application server checks CAS service ticket sent by browser in url
●
CAS client preparing to check service ticket:
2011­03­29 09:16:52,231 DEBUG  [org.jasig.cas.client.validation.Cas20ProxyReceivingTicketValidationFilter] ­  <Attempting to validate ticket: ST­1­bdgbwHIReBonmaudvxJl­cas> 2011­03­29 09:16:52,232 DEBUG  [org.jasig.cas.client.validation.Cas20ServiceTicketValidator] ­ <Constructing  validation url: https://www.purdue.edu/apps/account/cas­server­uber­webapp­ 3.4.6/serviceValidate?ticket=ST­1­bdgbwHIReBonmaudvxJl­cas&service=http%3A%2F %2Flocalhost%3A8080%2Fsampleapp%2Ftest%2F>
●
CAS server access log:
127.0.0.1 ­ ­ [29/Mar/2011:09:16:52 ­0400] &quot;GET /cas­server­uber­webapp­ 3.4.6/serviceValidate?ticket=ST­1­bdgbwHIReBonmaudvxJl­cas&amp;service=http%3A%2F %2Flocalhost%3A8080%2Fsampleapp%2Ftest%2F HTTP/1.1&quot; 200 281
4/7/2011
Purdue University Identity and Access Management
11
<img src="" alt=""> A detailed walk through a CAS authentication
(and how to get your mits on the authenticated user)
●
Step 9 – CAS server responds to ticket check
●
CAS server response (notice the NEW attributes!):
2011­03­29 09:16:52,327 DEBUG  [org.jasig.cas.client.validation.Cas20ServiceTicketValidator] ­ <Server response:  <cas:serviceResponse xmlns:cas='http://www.yale.edu/tp/cas'> <cas:authenticationSuccess> <cas:user>jott</cas:user> <cas:attributes> <cas:email>jott@purdue.edu</cas:email> <cas:i2a2characteristics>0,3592,2000</cas:i2a2characteristics> <cas:lastname>Ott</cas:lastname> <cas:firstname>Jeffrey A</cas:firstname> <cas:fullname>Jeffrey A Ott</cas:fullname> <cas:puid>0012345678</cas:puid> </cas:attributes> </cas:authenticationSuccess> </cas:serviceResponse> &gt;
●
You can test this now yourself against the new CAS server version 3.4.6 (which will become production in May 2011):
<a href="https://www.purdue.edu/apps/account/cas­server­uber­webapp­3.4.6/login" target="_blank">https://www.purdue.edu/apps/account/cas­server­uber­webapp­3.4.6/login</a> <a href="https://www.purdue.edu/apps/account/cas­server­uber­webapp­3.4.6/serviceValidate" target="_blank">https://www.purdue.edu/apps/account/cas­server­uber­webapp­3.4.6/serviceValidate</a>
4/7/2011
Purdue University Identity and Access Management
12
<img src="" alt=""> A detailed walk through a CAS authentication
(and how to get your mits on the authenticated user)
●
Step 10 – application server sends requested page
●
Some CAS clients (including the Java CAS client) can be configured to redirect the browser to the same url, but without the ticket parameter Application server access log:
●
0:0:0:0:0:0:0:1 ­ ­ [29/Mar/2011:09:16:52 ­0400] &quot;GET /sampleapp/test/?ticket=ST­1­ bdgbwHIReBonmaudvxJl­cas HTTP/1.1&quot; 302 ­ 0:0:0:0:0:0:0:1 ­ ­ [29/Mar/2011:09:16:52 ­0400] &quot;GET /sampleapp/test/ HTTP/1.1&quot;  200 202
4/7/2011
Purdue University Identity and Access Management
13
<img src="" alt=""> A detailed walk through a CAS authentication
(and how to get your mits on the authenticated user)
●
Java CAS client
●
<a href="https://wiki.jasig.org/display/CASC/CAS+Client+for+Java+3.1" target="_blank">https://wiki.jasig.org/display/CASC/CAS+Client+for+Java+3.1</a> Previous example used version 3.1.10 Looking at one CAS client will help understand how any of them will need configured Next two slides show the web.xml to configure the Java CAS client for the previous example:
●
●
●
4/7/2011
Purdue University Identity and Access Management
14
<img src="" alt=""> A detailed walk through a CAS authentication</p>
<p><filter> <filter­name>CAS Authentication Filter</filter­name> <filter­class>org.jasig.cas.client.authentication.AuthenticationFilter</filter­class> <init­param> <param­name>casServerLoginUrl</param­name> <param­value><a href="https://www.purdue.edu/apps/account/cas­server­uber­webapp­3.4.6/login" target="_blank">https://www.purdue.edu/apps/account/cas­server­uber­webapp­3.4.6/login</a></param­value> </init­param> <init­param> <param­name>serverName</param­name> <param­value><a href="http://localhost:8080" target="_blank">http://localhost:8080</a></param­value> </init­param> </filter> <filter> <filter­name>CAS Validation Filter</filter­name> <filter­class>org.jasig.cas.client.validation.Cas20ProxyReceivingTicketValidationFilter</filter­class> <init­param> <param­name>casServerUrlPrefix</param­name> <param­value><a href="https://www.purdue.edu/apps/account/cas­server­uber­webapp­3.4.6" target="_blank">https://www.purdue.edu/apps/account/cas­server­uber­webapp­3.4.6</a></param­value> </init­param> <init­param> <param­name>serverName</param­name> <param­value><a href="http://localhost:8080" target="_blank">http://localhost:8080</a></param­value> </init­param> <init­param> <param­name>redirectAfterValidation</param­name> <param­value>true</param­value> </init­param> <init­param> <param­name>exceptionOnValidationFailure</param­name> <param­value>false</param­value> </init­param> </filter> 4/7/2011 Purdue University Identity and Access Management 15
(and how to get your mits on the authenticated user)
<img src="" alt=""> A detailed walk through a CAS authentication
(and how to get your mits on the authenticated user)
●
Continued web.xml for Java CAS client configuration:</p>
<p><filter> <filter­name>CAS HttpServletRequest Wrapper Filter</filter­name> <filter­class>org.jasig.cas.client.util.HttpServletRequestWrapperFilter</filter­class> </filter> <filter­mapping> <filter­name>CAS Authentication Filter</filter­name> <url­pattern>/test//<em></url­pattern> </filter­mapping> <filter­mapping> <filter­name>CAS Validation Filter</filter­name> <url­pattern>/test//</em></url­pattern> </filter­mapping> <filter­mapping> <filter­name>CAS HttpServletRequest Wrapper Filter</filter­name> <url­pattern>/test//*</url­pattern> </filter­mapping>
4/7/2011
Purdue University Identity and Access Management
16
<img src="" alt=""> A detailed walk through a CAS authentication
(and how to get your mits on the authenticated user)
●
CAS is not just for web applications
●
Browsers hold CAS state with a cookie (called CASTGC that holds a CAS ticket granting ticket – TGT), but any client, such as a mobile app, can obtain and store a TGT See <a href="https://wiki.jasig.org/display/CASUM/RESTful+API" target="_blank">https://wiki.jasig.org/display/CASUM/RESTful+API</a> Example:
●
●
POST a username and password to <a href="https://CAS_SERVER_URL/v1/tickets" target="_blank">https://CAS_SERVER_URL/v1/tickets</a> (with “Accept: text/plain” as a header) And if the login/password check out, the server sends back 201 Created Location: <a href="https://CAS_SERVER_URL/v1/tickets/{TGT" target="_blank">https://CAS_SERVER_URL/v1/tickets/{TGT</a> id} If authentication fails, the server returns back a 400 code
4/7/2011
Purdue University Identity and Access Management
17
<img src="" alt=""> A detailed walk through a CAS authentication
(and how to get your mits on the authenticated user)
●
Initiatives for later this year:
●
Ability to use Boilerkey for CAS authentication:
–
If Boilerkey is used, CAS server will expose an extra attribute returned by the ticket check that indicates that the authentication was a Boilerkey authentication
<a href="https://www.purdue.edu/apps/account/IAMO/Purdue_CareerAccount_BoilerKey.jsp" target="_blank">https://www.purdue.edu/apps/account/IAMO/Purdue_CareerAccount_BoilerKey.jsp</a>
●
Separate mobile app CAS login page Application server administrators will be able to manage CAS ticket check server lists via web page Check for more at:
–
●
●
<a href="https://www.purdue.edu/apps/account/docs/CAS/CAS_information.jsp" target="_blank">https://www.purdue.edu/apps/account/docs/CAS/CAS_information.jsp</a>
4/7/2011
Purdue University Identity and Access Management
18
<img src="" alt=""> A detailed walk through a CAS authentication
(and how to get your mits on the authenticated user)
●
Thanks for your attention! Questions? Purdue Identity and Access Management can be reached at accounts@purdue.edu Please fill out an evaluation at <a href="http://www.itap.purdue.edu/boilerweb/survey" target="_blank">http://www.itap.purdue.edu/boilerweb/survey</a>
●
●
●
4/7/2011
Purdue University Identity and Access Management
19</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/CAS/">CAS</a></li></span></span> | <span class="tags">Tagged <a href="/tags/CAS/" class="label label-primary">CAS</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:39"datetime="2014-03-07 09:54:39"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-CAS--cas_presentation/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-CAS--cas_presentation" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>





<ul id="pagination" class="pagination pagination-lg">
  <li><a class="extend prev" href="/page/89/">&laquo;</a></li><li><a class="page-number" href="/">1</a></li><li><a class="page-number" href="/page/2/">2</a></li><li><span class="space">&hellip;</span></li><li><a class="page-number" href="/page/87/">87</a></li><li><a class="page-number" href="/page/88/">88</a></li><li><a class="page-number" href="/page/89/">89</a></li><li class="active"><li><span class="page-number current">90</span></li><li><a class="page-number" href="/page/91/">91</a></li><li><a class="page-number" href="/page/92/">92</a></li><li><a class="page-number" href="/page/93/">93</a></li><li><span class="space">&hellip;</span></li></li><li><a class="page-number" href="/page/164/">164</a></li><li><a class="page-number" href="/page/165/">165</a></li><li><a class="extend next" href="/page/91/">&raquo;</a></li>
  <div class="clearfix"></div>
</ul></div><!--wapper-->
       </div><!-- ID main-col END -->
       <aside id="sidebar" class="alignright col-sx-6 col-sm-4 col-md-3 col-lg-3">
<div id="widget_search" class="widget panel panel-primary">
    <form action="//google.com/search" method="get" accept-charset="utf-8">
  <div class="input-group">
    <input class="form-control" id="searchbox" type="search" name="q" results="0" placeholder="search">
    <span class="input-group-btn">
      <button class="btn btn-default" type="submit">Go!</button>
    </span>
    <input type="hidden" name="q" value="site:itsolife.com">
  </div>
</form>
</div>

<div id="widget_category" class="widget panel panel-primary">
  <div class="panel-heading">category</div>  <div data-src='category' class='ajax_widgets'>正在加载...</div>
</div>

<div id="widget_recent_posts" class="widget panel panel-primary">
  <div class="panel-heading">recent posts</div>  <div data-src='recent_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_tagcloud" class="widget panel panel-primary">
  <div class="panel-heading">tagcloud</div>  <div data-src='tagcloud' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_latest_update_posts" class="widget panel panel-primary">
  <div class="panel-heading">最近更新</div>  <div data-src='latest_update_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_recent_comments" class="widget panel panel-primary">
  <div class="panel-heading">recent comments</div>  

<div class="list-group-item ds-recent-comments" data-num-items="6" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="50"></div>



</div>

</aside>
       <div class="clearfix"></div>
     </div><!-- row END -->
  </div>
  <footer id="footer" class="container">
  <div class="panel panel-info">
  <section id='footer_widget'></section>  <div class="panel-footer">
  <div id="site-info">
    <span class='author'>
  
  &copy; 2014 RobinChia
  
    &nbsp;&nbsp;</span>
  
  <span id='analytics-51la'></span><span id='analytics-google'>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-48559895-1']);
  _gaq.push(['_trackPageview']);
  _js2load.push({src:('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'});
</script></span><span id='analytics-cnzz'>
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_5774006'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s17.cnzz.com/stat.php%3Fid%3D5774006%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
</span><span id='analytics-baidu'>
<script>
var _hmt = _hmt || [];
_js2load.push({src:"//hm.baidu.com/hm.js?1442f50724afc42380b51f097c43082c"});
</script>
</span>  </div>
  <div id="copyright">Blog powered by <a href='http://zespia.tw/hexo/'><strong>hexo</strong></a> Theme <strong><a href='https://github.com/chenall/hexo-theme-chenall'>chenall</a></strong>(Some change in it)<span class="pull-right"> 更新时间: <em>2014-03-15 16:47:46</em></span></div>
</div>
<div class="clearfix"></div>


  </div>
  </footer>
  
        <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>        
        <script src="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/js/bootstrap.min.js"></script>        
                
        <script src="http://cdn.bootcss.com/prettify/r298/prettify.min.js"></script>    <script type="text/javascript">
   var lang=["bsh", "c", "cc", "cpp", "cs", "csh", "cyc", "cv", "htm", "html",
    "java", "js", "m", "mxml", "perl", "pl", "pm", "py", "rb", "sh",
    "xhtml", "xml", "xsl"];
   var pretty_base='';
   $('script').each(function(){
	var c = $(this).attr('src');
	if (!c)
	    return;
	if (c.match(/(\/)?prettify(\.min)?\.js/i))
	{
	    var index = c.lastIndexOf('/');
	    if (index != -1)
		pretty_base = c.substr(0,index + 1);
	    return false;
	}
   })
   $('pre code').each(function(){
	var c = $(this).attr('class')
	if (!c)
	    return;
	c = c.match(/\s?(lang\-\w+)/i);
	if (c && lang.indexOf(c[1]) == -1)
	{
	    lang.push(c[1]);
	    $.getScript(pretty_base + c[1] + '.min.js');
	}
   })

    $(window).load(function(){
       $("pre").addClass("prettyprint");
       prettyPrint();
    })
</script>    
            <script type="text/javascript">
var duoshuoQuery = {short_name:"robinchia"};
_js2load.push({src:'http://static.duoshuo.com/embed.js',charset:'UTF-8'});
</script>
    
            <!--wumii_relatedItems-->
    
        <script src="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js"></script>    <script type="text/javascript">
(function($){
  $('.entry').each(function(i){
    $(this).find('img').each(function(){
      var alt = this.alt;

      if (alt){
        $(this).before('<span class="caption">' + alt + '</span>');
      }

      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="fancybox' + i + '" />');
    });
  });

  $('.fancybox').fancybox();
})(jQuery);
</script>    
        <script src="http://cdn.bootcss.com/mathjax/2.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>
    
<script type="text/javascript">
$('.ajax_widgets').each(function(){var src=$(this).attr('data-src');if(src)$(this).load('/widgets/'+src+'.html');});
$.each(_js2load,function(index,obj){loadjs(obj.src,obj.charset)});
</script>

<div id="scroll2top">
<img src="/scroll2top/arrow.png"/>
</div>
<script src="/scroll2top/scroll2top.min.js"></script>
<div id="winterland">
  <canvas></canvas>
</div>
<script src="/js/winterland.min.js"></script>

  </body>
</html>
