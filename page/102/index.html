
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>The 102 Page | It so life</title>
<meta name="author" content="RobinChia">

<meta name="description" content="It so life">


<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta property="og:site_name" content="It so life"/>

<!--[if IE]><style>.testIE.IE{display:inline;}</style><![endif]-->
<!--[if lte IE 7]><link rel="stylesheet" href="/css/ie7.css" type="text/css"><![endif]-->
<!--[if (lt IE 9)&(gt IE 7)]><style>.testIE.IE8{display:inline;}</style><![endif]-->
<!--[if gt IE 8]><style>.testIE.IE9{display:inline;}</style><![endif]-->

<link href="/favicon.png" rel="icon">
<link rel="alternate" href="/atom.xml" title="It so life Feed" type="application/atom+xml">

<link rel="stylesheet" href="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.0.3/css/font-awesome.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/prettify/r298/prettify.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" type="text/css">
<link rel="stylesheet" href="/css/style.css" type="text/css">
<!--[if lt IE 9]>
   <style>article,aside,dialog,footer,header,section,footer,nav,figure,menu{display:block}</style>
   <script src="http://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
   <script src="http://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
<link href="http://cdn.staticfile.org/respond.js/1.4.2/respond-proxy.html" id="respond-proxy" rel="respond-proxy" />
<link href="/js/respond.proxy.gif" id="respond-redirect" rel="respond-redirect" />
<script src="/js/respond.proxy.js"></script>
   <script src="http://cdn.bootcss.com/selectivizr/1.0.2/selectivizr-min.js"></script>
<![endif]-->
<script type="text/javascript">
function loadjs(c,d){var a=document.createElement("script");a.async=!0;a.type="text/javascript";a.src=c;a.charset=d||"gbk";(document.getElementsByTagName("HEAD")[0]||document.getElementsByTagName("BODY")[0]).appendChild(a)};
var _protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
var _js2load = [];
</script>

</head>
<body>
      <header id="header" class="container"><nav id="main-nav" class="navbar navbar-default navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="/">It so life</a>
    </div>
    <div  class="collapse navbar-collapse">
      <ul  class="nav navbar-nav">
  
        <li><a href="/" title="Home">Home</a></li>      
        <li><a href="/about/" title="About">About</a></li>      
        <li><a href="/archives/" title="Archives">Archives</a></li>      
      <li class='dropdown'>
        <a class='dropdown-toggle' data-toggle='dropdown' href='#'>website<b class='caret'></b></a>
        <ul class='dropdown-menu pure-menu-selected'>
    
          <li><a href="//groups.google.com/forum/#!forum/pongba" title="TopLanguage">TopLanguage</a></li>    
          <li><a href="//itpub.net/" title="ITPub">ITPub</a></li>    
          <li><a href="//blog.jobbole.com/" title="Bole">Bole</a></li>    
          <li><a href="//nosql-database.org/" title="nosql">nosql</a></li>    
          <li><a href="//gitimmersion.googol.im/" title="Git">Git</a></li>    
        </ul>
      </li>
    
      </ul>
      <ul class="nav navbar-nav navbar-right">
      
        <li><a href="/atom.xml">RSS</a></li>
      
      
        <li><a href="https://twitter.com/robinchia">twitter</a></li>
      
      
      
      
        <li><a href="https://github.com/robinchia">github</a></li>
      
      </ul>
    </div>
  </div>
</nav>
<div class="clearfix"></div>
</header>
  <div id='content' class="container">
     <div class="page-header-wrapper">
      <!--[if lt IE 9]><div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong>提示:</strong>您的浏览器版本太低了,建议升级到 <strong><a href="http://windows.microsoft.com/zh-cn/internet-explorer/download-ie" title="IE9">IE9</a></strong> 以上,本站使用<a href="https://www.google.com/intl/zh-CN/chrome/">Chrome浏览器</a>可以获得最好的显示效果.</div><![endif]-->
      <div class="page-header"><h1 align="center"><big>It so life</big> </h1>
        <h5 align="center"><big>love as life</big></h5>
      </div>
     </div>
     <div class="row">
       <div id="main-col" class="alignleft col-sx-12 col-sm-8 col-md-9 col-lg-9">
      <section id='header_widget'></section>
          <div id="wrapper"><article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-脚本-VB--VBS打造自己的重启删除工具/">VBS打造自己的重启删除工具</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:37.000Z"> <a href="/2014/02/02/2014-02-02-脚本-VB--VBS打造自己的重启删除工具/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="vbs-">VBS打造自己的重启删除工具</h1>
<p>安装文件(REG),Install.reg,双击导入即可完成安装
1</p>
<p>Windows Registry Editor Version 5.00</p>
<p>2</p>
<p>3</p>
<p>[HKEY_CLASSES_ROOT\/*\shell\重启删除\</p>
<p>command</p>
<p>]</p>
<p>4</p>
<p>@=</p>
<p>&quot;WScript.exe //nologo c:\windows\system32\rerase.vbs \&quot;%1\&quot;&quot;</p>
<p>rerase.vbs，需拷贝至c:\windows\system32\rerase.vbs ，当然也可是其它目录，但是要修改Insatll.reg
01</p>
<p>On Error Resume Next</p>
<p>02</p>
<p>TargetFile = Wscript.Arguments(0)
03</p>
<p>04</p>
<p>Set ObjRUN = Wscript.createObject(</p>
<p>&quot;Wscript.shell&quot;</p>
<p>)
05</p>
<p>Set ObjFSO = CreateObject(</p>
<p>&quot;Scripting.FileSystemObject&quot;</p>
<p>)</p>
<p>06</p>
<p>07</p>
<p>If ObjFSO.FileExists(TargetFile) Then</p>
<p>08</p>
<p>09</p>
<p>Set GetFile = ObjFSO.GetFile(TargetFile)</p>
<p>10</p>
<p>Set InfFile = ObjFSO.CreateTextFile(objFSO.GetParentFolderName(GetFile) &amp; </p>
<p>&quot;\INFFILE.INF&quot;</p>
<p>)
11</p>
<p>12</p>
<p>InfFile.WriteLine(</p>
<p>&quot;[Version]&quot;</p>
<p>)
13</p>
<p>InfFile.WriteLine(</p>
<p>&quot;Signature = &quot;</p>
<p>&quot;$Chicago$&quot;</p>
<p>&quot;&quot;</p>
<p>)</p>
<p>14</p>
<p>InfFile.WriteLine(</p>
<p>&quot;[DestinationDirs]&quot;</p>
<p>)
15</p>
<p>InfFile.WriteLine(</p>
<p>&quot;DefaultDestDir = 01&quot;</p>
<p>)</p>
<p>16</p>
<p>InfFile.WriteLine(</p>
<p>&quot;[DefaultInstall]&quot;</p>
<p>)
17</p>
<p>InfFile.WriteLine(</p>
<p>&quot;DelFiles = DELETELIST&quot;</p>
<p>)</p>
<p>18</p>
<p>InfFile.WriteLine(</p>
<p>&quot;[DELETELIST]&quot;</p>
<p>)
19</p>
<p>InfFile.WriteLine(</p>
<p>&quot;INFFILE.INF&quot;</p>
<p>)</p>
<p>20</p>
<p>InfFile.WriteLine(ObjFSO.GetFileName(GetFile) &amp; </p>
<p>&quot;,,,1&quot;</p>
<p>)
21</p>
<p>InfFile.Close</p>
<p>22</p>
<p>23</p>
<p>ObjRUN.Run </p>
<p>&quot;RUNDLL32.EXE SETUPAPI.DLL,InstallHinfSection DefaultInstall 128 &quot;</p>
<p>&amp; objFSO.GetParentFolderName(GetFile) &amp; </p>
<p>&quot;.\INFFILE.INF&quot;</p>
<p>, 0, TRUE</p>
<p>24</p>
<p>25</p>
<p>WScript.Sleep 200</p>
<p>26</p>
<p>27</p>
<p>If ObjFSO.FileExists(TargetFile) Then</p>
<p>28</p>
<p>Return = Msgbox(</p>
<p>&quot;必须重启才能完成删除操作，你想现在重启吗?&quot;</p>
<p>, vbYesNo + vbInformation + vbDefaultButton2, </p>
<p>&quot;提示&quot;</p>
<p>)
29</p>
<p>IF Return = vbYes Then</p>
<p>30</p>
<p>ObjRUN.Run </p>
<p>&quot;shutdown -r -t 0&quot;
31</p>
<p>End If</p>
<p>32</p>
<p>End If
33</p>
<p>34</p>
<p>Else
35</p>
<p>MsgBox </p>
<p>&quot;文件未找到!&quot;</p>
<p>, 16, </p>
<p>&quot;错误&quot;</p>
<p>36</p>
<p>End If</p>
<p>来源： <a href="[http://my.oschina.net/veterans/blog/27839](http://my.oschina.net/veterans/blog/27839)">[http://my.oschina.net/veterans/blog/27839](http://my.oschina.net/veterans/blog/27839)</a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/脚本/">脚本</a></li></span><span class="breadcrumb"><li><a href="/categories/脚本/">脚本</a></li><li><a href="/categories/脚本/VB/">VB</a></li></span></span> | <span class="tags">Tagged <a href="/tags/VB/" class="label label-primary">VB</a><a href="/tags/脚本/" class="label label-success">脚本</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:37"datetime="2014-03-07 09:54:37"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-脚本-VB--VBS打造自己的重启删除工具/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-脚本-VB--VBS打造自己的重启删除工具" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-脚本-VB--使用WMI修改文件文件夹的NTFS权限/">使用WMI修改文件文件夹的NTFS权限</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:37.000Z"> <a href="/2014/02/02/2014-02-02-脚本-VB--使用WMI修改文件文件夹的NTFS权限/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-wmi-ntfs-">使用WMI修改文件文件夹的NTFS权限</h1>
<h1 id="-wmi-ntfs-">使用WMI修改文件文件夹的NTFS权限</h1>
<p>使用WMI修改文件文件夹的NTFS权限</p>
<p>01</p>
<p>strUser = </p>
<p>&quot;guests&quot;</p>
<p>02</p>
<p>strPath = </p>
<p>&quot;D:\abc.txt&quot;
03</p>
<p>RetVal = AddPermission(strUser,strPath,</p>
<p>&quot;R&quot;</p>
<p>,True)</p>
<p>04</p>
<p>05</p>
<p>&#39;-------------------------------------------------------------------------</p>
<p>06</p>
<p>07</p>
<p>&#39;用于给文件和文件夹添加一条权限设置.返回值: 0-成功,1-账户不存在,2-路径不存在</p>
<p>08</p>
<p>&#39;strUser表示用户名或组名
09</p>
<p>&#39;strPath表示文件夹路径或文件路径</p>
<p>10</p>
<p>&#39;strAccess表示允许权限设置的字符串,字符串中带有相应字母表示允许相应权限: R-读,C-读写,F-完全控制
11</p>
<p>&#39;blInherit表示是否继承父目录权限.True为继承,False为不继承</p>
<p>12</p>
<p>13</p>
<p>Function AddPermission(strUser,strPath,strAccess,blInherit)</p>
<p>14</p>
<p>Set objWMIService = GetObject(</p>
<p>&quot;winmgmts:\.\root\Cimv2&quot;</p>
<p>)
15</p>
<p>Set fso = CreateObject(</p>
<p>&quot;Scripting.FileSystemObject&quot;</p>
<p>)</p>
<p>16</p>
<p>&#39;得到Win32_SID并判断用户/组/内置账户是否存在
17</p>
<p>Set colUsers = objWMIService.ExecQuery(</p>
<p>&quot;SELECT /* FROM Win32_Account WHERE Name=&#39;&quot;</p>
<p>&amp;strUser&amp;</p>
<p>&quot;&#39;&quot;</p>
<p>)</p>
<p>18</p>
<p>If colUsers.count&lt;&gt;0 Then
19</p>
<p>For Each objUser In colUsers</p>
<p>20</p>
<p>strSID = objUser.SID
21</p>
<p>Next</p>
<p>22</p>
<p>Else
23</p>
<p>AddPermission = 1</p>
<p>24</p>
<p>Exit Function
25</p>
<p>End If</p>
<p>26</p>
<p>Set objSID = objWMIService.Get(</p>
<p>&quot;Win32_SID.SID=&#39;&quot;</p>
<p>&amp;strSID&amp;</p>
<p>&quot;&#39;&quot;</p>
<p>)
27</p>
<p>&#39;判断文件/文件夹是否存在</p>
<p>28</p>
<p>pathType = </p>
<p>&quot;&quot;
29</p>
<p>If fso.fileExists(strPath) Then pathType = </p>
<p>&quot;FILE&quot;</p>
<p>30</p>
<p>If fso.folderExists(strPath) Then pathType = </p>
<p>&quot;FOLDER&quot;
31</p>
<p>If pathType = </p>
<p>&quot;&quot;</p>
<p>Then</p>
<p>32</p>
<p>AddPermission = 2
33</p>
<p>Exit Function</p>
<p>34</p>
<p>End If
35</p>
<p>&#39;设置Trustee</p>
<p>36</p>
<p>Set objTrustee = objWMIService.Get(</p>
<p>&quot;Win32_Trustee&quot;</p>
<p>).SpawnInstance_()
37</p>
<p>objTrustee.Domain = objSID.ReferencedDomainName</p>
<p>38</p>
<p>objTrustee.Name = objSID.AccountName
39</p>
<p>objTrustee.SID = objSID.BinaryRepresentation</p>
<p>40</p>
<p>objTrustee.SidLength = objSID.SidLength
41</p>
<p>objTrustee.SIDString = objSID.Sid</p>
<p>42</p>
<p>&#39;设置ACE
43</p>
<p>Set objNewACE = objWMIService.Get(</p>
<p>&quot;Win32_ACE&quot;</p>
<p>).SpawnInstance_()</p>
<p>44</p>
<p>objNewACE.Trustee = objTrustee
45</p>
<p>objNewACE.AceType = 0</p>
<p>46</p>
<p>If InStr(UCase(strAccess),</p>
<p>&quot;R&quot;</p>
<p>) &gt; 0 Then objNewACE.AccessMask = 1179817
47</p>
<p>If InStr(UCase(strAccess),</p>
<p>&quot;C&quot;</p>
<p>) &gt; 0 Then objNewACE.AccessMask = 1245631</p>
<p>48</p>
<p>If InStr(UCase(strAccess),</p>
<p>&quot;F&quot;</p>
<p>) &gt; 0 Then objNewACE.AccessMask = 2032127
49</p>
<p>If pathType = </p>
<p>&quot;FILE&quot;</p>
<p>And blInherit = True Then objNewACE.AceFlags = 16</p>
<p>50</p>
<p>If pathType = </p>
<p>&quot;FILE&quot;</p>
<p>And blInherit = False Then objNewACE.AceFlags = 0
51</p>
<p>If pathType = </p>
<p>&quot;FOLDER&quot;</p>
<p>And blInherit = True Then objNewACE.AceFlags = 19</p>
<p>52</p>
<p>If pathType = </p>
<p>&quot;FOLDER&quot;</p>
<p>And blInherit = False Then objNewACE.AceFlags = 3
53</p>
<p>&#39;设置SD</p>
<p>54</p>
<p>Set objFileSecSetting = objWMIService.Get(</p>
<p>&quot;Win32_LogicalFileSecuritySetting.Path=&#39;&quot;</p>
<p>&amp;strPath&amp;</p>
<p>&quot;&#39;&quot;</p>
<p>)
55</p>
<p>Call objFileSecSetting.GetSecurityDescriptor(objSD)</p>
<p>56</p>
<p>blSE_DACL_AUTO_INHERITED = True
57</p>
<p>If (objSD.ControlFlags And &amp;H400) = 0 Then</p>
<p>58</p>
<p>blSE_DACL_AUTO_INHERITED = False
59</p>
<p>objSD.ControlFlags = (objSD.ControlFlags Or &amp;H400)                &#39;自动继承位置位,如果是刚创建的目录或文件该位是不置位的,需要置位</p>
<p>60</p>
<p>End If
61</p>
<p>If blInherit = True Then</p>
<p>62</p>
<p>objSD.ControlFlags = (objSD.ControlFlags And &amp;HEFFF)        &#39;阻止继承复位
63</p>
<p>Else</p>
<p>64</p>
<p>objSD.ControlFlags = (objSD.ControlFlags Or &amp;H1400)                &#39;阻止继承位置位,自动继承位置位
65</p>
<p>End If</p>
<p>66</p>
<p>objOldDacl = objSD.Dacl
67</p>
<p>ReDim objNewDacl(0)</p>
<p>68</p>
<p>Set objNewDacl(0) = objNewACE
69</p>
<p>If IsArray(objOldDacl) Then                &#39;权限为空时objOldDacl不是集合不可遍历</p>
<p>70</p>
<p>For Each objACE In objOldDacl
71</p>
<p>If (blSE_DACL_AUTO_INHERITED=False And blInherit=True) Or ((objACE.AceFlags And 16)&gt;0 And (blInherit=True) Or (LCase(objACE.Trustee.Name)=LCase(strUser))) Then</p>
<p>72</p>
<p>&#39;Do nothing
73</p>
<p>&#39;当自动继承位置位为0时即使时继承的权限也会显示为非继承,这时所有权限都不设置</p>
<p>74</p>
<p>&#39;当自动继承位置位为0时,在继承父目录权限的情况下不设置继承的权限.账户和需要加权限的账户一样时不设置权限
75</p>
<p>Else</p>
<p>76</p>
<p>Ubd = UBound(objNewDacl)
77</p>
<p>ReDim preserve objNewDacl(Ubd+1)</p>
<p>78</p>
<p>Set objNewDacl(Ubd+1) = objACE
79</p>
<p>End If</p>
<p>80</p>
<p>Next
81</p>
<p>End If</p>
<p>82</p>
<p>objSD.Dacl = objNewDacl
83</p>
<p>&#39;提交设置修改</p>
<p>84</p>
<p>Call objFileSecSetting.SetSecurityDescriptor(objSD)
85</p>
<p>AddPermission = 0</p>
<p>86</p>
<p>Set fso = Nothing
87</p>
<p>End Function</p>
<p>来源： <a href="[http://my.oschina.net/veterans/blog/27840](http://my.oschina.net/veterans/blog/27840)">[http://my.oschina.net/veterans/blog/27840](http://my.oschina.net/veterans/blog/27840)</a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/脚本/">脚本</a></li></span><span class="breadcrumb"><li><a href="/categories/脚本/">脚本</a></li><li><a href="/categories/脚本/VB/">VB</a></li></span></span> | <span class="tags">Tagged <a href="/tags/VB/" class="label label-primary">VB</a><a href="/tags/脚本/" class="label label-success">脚本</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:37"datetime="2014-03-07 09:54:37"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-脚本-VB--使用WMI修改文件文件夹的NTFS权限/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-脚本-VB--使用WMI修改文件文件夹的NTFS权限" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-脚本-batch--批处理计算雯波那契数列/">批处理计算雯波那契数列</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:37.000Z"> <a href="/2014/02/02/2014-02-02-脚本-batch--批处理计算雯波那契数列/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-">批处理计算雯波那契数列</h1>
<h1 id="-">批处理计算雯波那契数列</h1>
<p>01</p>
<p>@</p>
<p>echo</p>
<p>off</p>
<p>02</p>
<p>rem 批处理计算雯波那契数列
03</p>
<p>setlocal enabledelayedexpansion</p>
<p>04</p>
<p>set</p>
<p>a=1
05</p>
<p>set</p>
<p>b=1</p>
<p>06</p>
<p>echo</p>
<p>任意键查看下一项.
07</p>
<p>echo</p>
<p>第1项为：!a!</p>
<p>08</p>
<p>echo</p>
<p>第2项为：!b!
09</p>
<p>:start</p>
<p>10</p>
<p>set</p>
<p>/a tn+=1
11</p>
<p>set</p>
<p>/a n_=!tn!+2</p>
<p>12</p>
<p>for</p>
<p>/l %%a </p>
<p>in</p>
<p>(1,1,1000) </p>
<p>do</p>
<p>(
13</p>
<p>set</p>
<p>ka=!a:~%%a,1!</p>
<p>14</p>
<p>if</p>
<p>not defined ka (
15</p>
<p>set</p>
<p>la=%%a</p>
<p>16</p>
<p>goto :start_a
17</p>
<p>)</p>
<p>18</p>
<p>)
19</p>
<p>:start_a</p>
<p>20</p>
<p>for</p>
<p>/l %%a </p>
<p>in</p>
<p>(1,1,1000) </p>
<p>do</p>
<p>(
21</p>
<p>set</p>
<p>kb=!b:~%%a,1!</p>
<p>22</p>
<p>if</p>
<p>not defined kb (
23</p>
<p>set</p>
<p>lb=%%a</p>
<p>24</p>
<p>goto :start_b
25</p>
<p>)</p>
<p>26</p>
<p>)
27</p>
<p>:start_b</p>
<p>28</p>
<p>if</p>
<p>!la! == !lb! (
29</p>
<p>set</p>
<p>l=!la!</p>
<p>30</p>
<p>set</p>
<p>/a m=!a:~0,1!+!b:~0,1!
31</p>
<p>if</p>
<p>!m! geq 9 (</p>
<p>32</p>
<p>set</p>
<p>n=1
33</p>
<p>) </p>
<p>else</p>
<p>(</p>
<p>34</p>
<p>set</p>
<p>n=0
35</p>
<p>)</p>
<p>36</p>
<p>) </p>
<p>else</p>
<p>(
37</p>
<p>set</p>
<p>n=0</p>
<p>38</p>
<p>)
39</p>
<p>if</p>
<p>!la! gtr !lb! (</p>
<p>40</p>
<p>set</p>
<p>/a l=!la!+!n!
41</p>
<p>) </p>
<p>else</p>
<p>(</p>
<p>42</p>
<p>set</p>
<p>/a l=!lb!+!n!
43</p>
<p>)</p>
<p>44</p>
<p>for</p>
<p>/l %%a </p>
<p>in</p>
<p>(1,1,!l!) </p>
<p>do</p>
<p>(
45</p>
<p>if</p>
<p>!la! geq %%a (</p>
<p>46</p>
<p>set</p>
<p>x=!a:~-%%a,1!
47</p>
<p>) </p>
<p>else</p>
<p>(</p>
<p>48</p>
<p>set</p>
<p>x=0
49</p>
<p>)</p>
<p>50</p>
<p>if</p>
<p>!lb! geq %%a (
51</p>
<p>set</p>
<p>y=!b:~-%%a,1!</p>
<p>52</p>
<p>) </p>
<p>else</p>
<p>(
53</p>
<p>set</p>
<p>y=0</p>
<p>54</p>
<p>)
55</p>
<p>if</p>
<p>defined o (</p>
<p>56</p>
<p>set</p>
<p>/a z=!x!+!y!+!o!
57</p>
<p>set</p>
<p>o=</p>
<p>58</p>
<p>) </p>
<p>else</p>
<p>(
59</p>
<p>set</p>
<p>/a z=!x!+!y!</p>
<p>60</p>
<p>)
61</p>
<p>if</p>
<p>!z! gtr 9 </p>
<p>set</p>
<p>o=1</p>
<p>62</p>
<p>set</p>
<p>/p =!z:~-1,1!<nul>&gt;%temp%\temp.txt
63</p>
<p>set</p>
<p>/p all=&lt;%temp%\temp.txt</p>
<p>64</p>
<p>65</p>
<p>)</p>
<p>66</p>
<p>for</p>
<p>/l %%a </p>
<p>in</p>
<p>(1,1,!l!) </p>
<p>do</p>
<p>set</p>
<p>/p =!all:~-%%a,1!<nul>&gt;%temp%\temp_.txt
67</p>
<p>set</p>
<p>b=!a!</p>
<p>68</p>
<p>set</p>
<p>/p a=&lt;%temp%\temp_.txt
69</p>
<p>del %temp%\temp/*.txt /q</p>
<p>70</p>
<p>if</p>
<p>&quot;!a:~0,1!&quot;</p>
<p>== </p>
<p>&quot;0&quot;</p>
<p>set</p>
<p>a=!a:~1!
71</p>
<p>echo</p>
<p>第!n_!项为：!a!</p>
<p>72</p>
<p>pause&gt;nul
73</p>
<p>goto :start</p>
<p>来源： <a href="[http://my.oschina.net/veterans/blog/27841](http://my.oschina.net/veterans/blog/27841)">[http://my.oschina.net/veterans/blog/27841](http://my.oschina.net/veterans/blog/27841)</a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/脚本/">脚本</a></li></span><span class="breadcrumb"><li><a href="/categories/脚本/">脚本</a></li><li><a href="/categories/脚本/batch/">batch</a></li></span></span> | <span class="tags">Tagged <a href="/tags/batch/" class="label label-primary">batch</a><a href="/tags/脚本/" class="label label-success">脚本</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:37"datetime="2014-03-07 09:54:37"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-脚本-batch--批处理计算雯波那契数列/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-脚本-batch--批处理计算雯波那契数列" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-正则--正则匹配模式/">正则匹配模式</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:37.000Z"> <a href="/2014/02/02/2014-02-02-正则--正则匹配模式/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-">正则匹配模式</h1>
<p>正则匹配模式
匹配模式指得是正则表达式引擎将以何种模式匹配字符串。
模式名称
启用，禁用
缺省启用
说明UNIX_LINES
(?d)启用，(?-d)禁用
是
启用Unix行模式。
在此模式下，只有 &#39;\n&#39;被认为是行结束符。它会影响., ^, 和 $ 的行为。CASE_INSENSITIVE
(?i)启用，(?-i)禁用
否
启用忽略大小写模式。
缺省时，忽略大小写模式只会影响 ASCII字符的匹配。 而Unicode范围的忽略大小写匹配需要通过 UNICODE_CASE 标志与本标志联合使用。
启用此模式会影响匹配性能。COMMENTS
(?x)启用，(?-x)禁用
否
允许空格和注释出现在正则表达式中。
在此模式下，空格被忽略，以/#开始的单行注释被忽略。MULTILINE
(?m)启用，(?-m)禁用
是
启用多行模式。
In multiline mode the expressions ^ and $ match just after or just before, respectively, a line terminator or the end of the input sequence. By default these expressions only match at the beginning and the end of the entire input sequence.DOTALL
(?s)启用，(?-s)禁用
否
让.可以匹配行结束符。
在此模式下，元字符.可以匹配行结束符。缺省不允许如此匹配。UNICODE_CASE
(?u)启用，(?-u)禁用
否
Enables Unicode-aware case folding.
When this flag is specified then case-insensitive matching, when enabled by theCASE_INSENSITIVE flag, is done in a manner consistent with the Unicode Standard. By default, case-insensitive matching assumes that only characters in the US-ASCII charset are being matched. 启用此模式会影响性能。CANON_EQ
(?c)启用，(?-c)禁用
否
Enables canonical equivalence.
When this flag is specified then two characters will be considered to match if, and only if, their full canonical decompositions match. The expression &quot;a\u030A&quot;, for example, will match the string&quot;?&quot; when this flag is specified. By default, matching does not take canonical equivalence into account.
启用此模式会影响性能。</p>
<p>字符子集　　字符子集可以含有别的字符子集，并且可以通过联合操作符（缺省）和交集操作符（&amp;&amp;）实现组合。联合操作符表示某个子集匹配它的子子集所匹配的任意字符。交集操作符表明某个字符子集只匹配它的子子集都匹配的字符。
字符子集所能够有的操作符的优先级如下，从高到低：
转义符\x
成组符 [...]
区间符 a-z
联合符 [a-e][i-u]
交集符 [a-z&amp;&amp;[aeiou]]</p>
<p>注意：在字符子集[]内部的语法根本不同于正则表达式其它部分中的语法。例如，在字符子集内部，正则表达式 . 失去了它原有的含义，而是成了一个匹配.的元字符。
行结束符　　行结束符是一个或两个字符序列，用以表明输入字符序列中一行的结束。下面的字符被认为是行结束符：
一个换行符(&#39;\n&#39;)。
一个回车符加上一个换行符(&quot;\r\n&quot;)。
一个单独的回车符(&#39;\r&#39;)。
代表下一行的字符(&#39;\u0085&#39;)。
行分隔符(&#39;\u2028&#39;)，Unicode中被定义。
一个分段符(&#39;\u2029)，Unicode中被定义。</p>
<p>如果 UNIX_LINES 模式被启用，则只有换行符被认为是行结束符。
如果 MULTILINE 模式被启用，。
分组和引用　　字符分组以它们的左括号的出现顺序来排序。例如在表达式((A)(B(C)))，有四个分组：
((A)(B(C)))
(A)
(B(C))
(C)</p>
<p>第0组永远表示表达式本身。
分组采用这样的命名方式，是因为，在一次匹配过程中，正则表达式会被匹配多次。以前的匹配子序列有可能在将来被使用；或者在匹配结束时，程序有可能需要重新获得所有匹配的子字符序列。
对于正则表达式中的某个分组而言，永远只保留最后匹配的字符序列。如果对某个分组匹配尝试失败，则会保留上次匹配成功的字符序列。例如，对于正则表达式(a(b)?)+而言，字符序列&quot;aba&quot;，将会让分组2匹配的字符序列为&quot;b&quot;。
以(?开始的分组，将不会计入分组数目，也不会被后续匹配所引用。
Unicode支持　　本正则表达式匹配引擎的实现遵循了《Unicode技术报告：Unicode正则表达式指南》，实现了该指南的第二层所需的功能，但是在细微处有一些简单语法修改。
Unicode块(Block)和分类(Category)通过\p和\P通配苻表示。\p{prop}匹配含有prop的输入序列，而\P{prop}匹配不含有prop的输入序列。Unicode块通过前缀In表示，如\p{InMongolian}。Unicode分类通过可选的前缀Is表示，因此\p{L}和\p{IsL}都代表Unicode分类 letters。Unicode块和分类都可以在正则表达式子集外部和内部使用。
目前支持的Unicode块和分类是《Unicode标准，第三版》中所指定的块和分类。 Unicode块名称在《Unicode 字符数据库》的第14章被定义，文件名称叫Blocks-3.txt，但是名称中的空格被去掉了。例如&quot;Basic Latin&quot;成了&quot;BasicLatin&quot;。无论是标准化的还是非标准化的分类，都在该标准的第88页的第4-5表中被全部定义。
与Perl 5正则表达式语法对比 [TBD]
正则表达式参考
字符
正则表达式字符串
匹配的字符串X
字符X，包括 CJK ExtB 区汉字\
反斜杠\0n八进制0n代表的字符(0&lt;=n&lt;=7)\0nn
八进制0nn代表的字符(0&lt;=n&lt;=7)\0mnn
八进制0mnn代表的字符(0&lt;=m&lt;=3,0&lt;=n&lt;=7)\xhh
十六进制 0xhh所代表的字符\uhhhh
十六进制 0xhhhh所代表的字符。注意，目前尚不支持CJK ExtB区汉字。\t
制表符(&#39;\u0009&#39;)\n
换行(&#39;\u000A&#39;)\r
回车(&#39;\u000D&#39;)\a
响铃符(&#39;\u0007&#39;)\e
取消符Escape(&#39;\001B&#39;)\cx
x所代表的控制字符</p>
<p>逻辑操作符
正则表达式字符串
匹配的字符串XY
X后面跟随YX|Y
X或者Y(X)
X作为分组表达式</p>
<p>向后引用
正则表达式字符串
匹配的字符串\n
第n个匹配的分组</p>
<p>边界元字符
边界字符
匹配的字符串^
行首$
行末\b字符边界\B
非字符边界\A
输入流的开始\G
上次匹配的结束处\Z
输入流的结束，或者是最后一个行结束符，参见[url=file:///D:/source/jtextpro/src/dist/jtextpro/docs/regexp.html/#man_line_terminator]行结束符[/url]。\z
输入流的结束</p>
<p>重复指示符
正则表达式字符串
匹配的字符串X?
X重复一次，或者不重复X/*
X重复0次或多次X+
X重复1次或多次X{n}
X重复n次，不多也不少。X{n,}
X至少重复n次X{n,m}
X至少重复n次，至多重复m次。</p>
<p>注：X{n,m}、?、/*、+方式可以联合使用。
字符子集
正则表达式字符串子集
匹配的字符串
组合方式[abc]
字符a,b或c，包括 CJK ExtB 区汉字
简单子集[^abc]
任意非a,b或c的字符。
排除[a-zA-Z]从a到z，或者A到Z，包含a,z,A,Z。
区间[a-d[m-p]]
从a到d，或者m到p，等于[a-dm-p]。
联合[a-z&amp;&amp;[def]]
d,e或者f。
交集[a-z&amp;&amp;[^bc]]
从a到z，除了b和c，等于[ad-z]
扣除[a-z&amp;&amp;[^m-p]]
从a到z，并且不包括从m到p，等于[a-lq-z]
扣除</p>
<p>预定义子集（元字符）
边界字符
匹配的字符串.
任意字符，可能匹配行结束符。\d
数字[0-9]\D非数字[^0-9]\s
空白符[ \t\n\x0B\f\r]\S
非空白符[^\s]\w
单词符，包含有字母和数字[a-zA-Z_0-9]\W
非单词符，不包含有字母和数字。</p>
<p>扩展子集（元字符）
正则表达式字符串
匹配的字符串</p>
<p>扩展中文子集（元字符）
名称
块名称（\p{InXXX}）
简化通配符
标准Unicode块，或者汉字列表任意双字节字符（汉字或全角符号）
\p{InQuqnJiao}
\E
任意由GBK表示的汉字，不包括GB18030扩展部分，
以及CJK ExtB区的汉字。任意单字节字符
\p{InFQuanJiao}
~E
任意单字节字符。任意全角ASCII字符
\p{InQJAscii}
\H
标准HalfwidthandFullwidthForms块任意收录在BIG5码集中的双字节字符
\p{InBig5}
\I
Big5可编码双字节字符匹配未收录在BIG5码集中的双字节字符\p{InFBig5}
~I
非Big5可编码双字节字符匹配任意汉字(不包括符号)
\p{InHanziOrCJKExtB}
\X
任意汉字，包括GB18030扩展部分。匹配任意汉字(不包括符号)
\p{InHanzi}
\M
任意汉字，不包括GB18030扩展部分。匹配非汉字的双字节字符
\p{InFHanzi}
~M
任意非汉字的双字节字符，
包括GB18030扩展部分。地支字符
\p{InDiZhi}
\U
子丑寅卯辰巳午未申酉戌亥匹配收录在GB码集中的双字节字符
\p{InGB}
\g
收录在GB码集中的双字节字符，
不包括GB18030扩展部分。匹配非收录在GB码集中的双字节字符
\p{InFGB}
~g
未收录在GB码集中的双字节字符，
不包括GB18030扩展部分。匹配收录在GBK码集中的双字节字符
\p{InGBK}
\h
收录在GBK码集中的双字节字符，
不包括GB18030扩展部分。匹配非收录在GBK码集中的双字节字符
\p{InFGBK}
~h
未收录在GBK码集中的双字节字符，
不包括GB18030扩展部分。大写希腊字母
\p{InDaXila}
\K
ΑΒΓΔΕΖΗΘΙΚΛΜΝ
ΞΟΠΡΣΤΥΦΧΨΩ日文片假名
\p{InPianJia}
\j
标准Katakana块日文平假名
\p{InPingJia}
\J
标准Hiragana块小写希腊字母
\p{InXiaoXila}
\k
αβγδεζηθικλμν
ξοπρστυφχψω数学符号
\p{InMathe}
\m
±×÷∶∧∨∑∏∪∩∈∷√⊥∥∠⌒⊙
∫∮≡≌≈∽∝≠≮≯≤≥∞∵∴中文数字
\p{InCnDigit}
\i
〇一二三四五六七八九十百千万亿兆吉京大写中文数字
\p{InDaCnDigit}
\N
零壹贰叁肆伍陆柒捌玖拾佰仟萬亿兆吉京全角标点符号
\p{InQJBiaoDian}
\o
、。·ˉˇ¨〃々—～‖…‘’“”〔〕
〈〉《》「」『』〖〗【】！＂＇（），
－．：；＜＝＞？［］｛｜｝｀﹉﹊﹋﹌﹍﹎﹏﹐﹑﹒﹔﹕﹖﹗﹙﹚
﹛﹜﹝﹞︵︶︹︺︿﹀︽︾﹁﹂﹃﹄
︻︼︷︸︱︳︴小写俄文字母
\p{InXiaoEWen}
\l
абвгдеёжзийклмн
опрстуфхцчшщъыьэюя大写俄文字母
\p{InDaEWen}
\R
АБВГДЕЁЖЗИЙКЛМНО
ПРСТУФХЦЧШЩЪЫЬЭЮЯ中文序号
\p{InCnSN}
\q
ⅠⅡⅢⅣⅤⅥⅦⅧⅨⅩⅪⅫ
ⅰⅱⅲⅳⅴⅵⅶⅷⅸⅹ
再加上Unicode标准EnclosedAlphanumerics块天干字符
\p{InTianGan}
\T
甲乙丙丁戊己庚辛壬癸竖排标点符号
\p{InSPBiaoDian}
\V
︵︶︹︺︿﹀︽︾﹁﹂﹃﹄︻︼︷︸︱︳︴拼音字符
\p{InPinyin}
\y
āáǎàēéěèīíǐìōóǒòūúǔùǖǘǚǜüêɑńňɡ
GBK -&gt; 0xA8A1- 0xA8C0
只是Unicode标准LatinExtended-A块的一部分。注音字符
\p{InZhuyin}
\Y
标准Bopomofo块制表字符
\p{InZhiBiao}
\C
标准BoxDrawing块。
经检查发现 textpro 的算法含有部分非标
准Unicode制表符：“∟∣≒≦≧⊿═”。</p>
<p>POSIX字符子集（只适用于ASCII）
正则表达式字符串
匹配的字符串\p{Lower}
小写字母[a-z]\p{Upper}
大写字母[A-Z]\p{ASCII}
所有的ASCII字符[\x00-\x7F]\p{Alpha}
大小写字母[\p{Lower}\p{Upper}]\p{Digit}
数字[0-9]\p{Alnum}
字母数字符，包含大小写字母和数字[\p{Alpha}\p{Digit}]\p{Punct}
标点符号，!&quot;/#$%&amp;&#39;()/*+,-./:;&lt;=&gt;?@[]^_`{|}~之一。\p{Graph}
可显示字符[\p{Alnum}\p{Punct}]\p{Print}
可打印字符[\p{Graph}]\p{Blank}
空格或者制表符[ \t]\p{Cntrl}
控制字符[\x00-\x1F\x7F\p{XDigit}
十六进制数字[0-9a-fA-F]\p{Space}
空白符[ \t\n\x0B\f\r]</p>
<p>Unicode块和分类
块
中文名称（摘自Word XP）
代码区域BasicLatin
基本拉丁语
\u0000-\u007FLatin-1Supplement
拉丁语-1
\u0080-\u00FFLatinExtended-A
拉丁语扩充-A
\u0100-\u017FLatinExtended-Bound
拉丁语扩充-B
\u0180-\u024FIPAExtensions
国际音标扩充
\u0250-\u02AFSpacingModifierLetters
进格的修饰字符
\u02B0-\u02FFCombiningDiacriticalMarks
组合用发音符
\u0300-\u036FGreek
基本希腊语
\u0370-\u03FFCyrillic
西里尔语
\u0400-\u04FFArmenian
\u0530-\u058FHebrew
\u0590-\u05FFArabic
\u0600-\u06FFSyriac
\u0700-\u074FThaana
\u0780-\u07BFDevanagari
\u0900-\u097FBengali
\u0980-\u09FFGurmukhi
\u0A00-\u0A7FGujarati
\u0A80-\u0AFFOriya
\u0B00-\u0B7FTamil
\u0B80-\u0BFFTelugu
\u0C00-\u0C7FKannada
\u0C80-\u0CFFMalayalam
\u0D00-\u0D7FSinhala
\u0D800-\uDFFThai
\u0E00-\u0E7FLao
\u0E80-\u0EFFTibetan
藏语
\u0F00-\u0FFFMyanmar
\u1000-\u109FGeorgian
\u10A0-\u10FFHangulJamo
\u1100-\u11FFEthiopic
\u1200-\u137FCherokee
\u13A0-\u13FFUnifiedCanadianAboriginalSyllabics
\u1400-\u167FOgham
\u1680-\u169FRunic
\u16A0-\u16FFKhmer
\u1780-\u17FFMongolian
蒙古语
\u1800-\u18AFLatinExtendedAdditional
\u1E00-\u1EFFGreekExtended
\u1F00-\u1FFFGeneralPunctuation
广义标点
\u2000-\u206FSuperscriptsandSubscripts
\u2070-\u209FCurrencySymbols
货币符号
\u20A0-\u20CFCombiningMarksforSymbols
\u20D0-\u20FFLetterlikeSymbols
类似字母的符号
\u2100-\u214FNumberForms
数字形式
\u2150-\u218FArrows
箭头
\u2190-\u21FFMathematicalOperators
数学运算符
\u2200-\u22FFMiscellaneousTechnical
零杂技术用符号
\u2300-\u23FFControlPictures
\u2400-\u243FOpticalCharacterRecognition
\u2440-\u245FEnclosedAlphanumerics
带括号的字母数字
\u2460-\u24FFBoxDrawing
制表符
\u2500-\u257FBlockElements
方块图形
\u2580-\u259FGeometricShapes
几何图形
\u25A0-\u25FFMiscellaneousSymbols
零杂丁贝符（示意符等）
\u2600-\u26FFDingbats
\u2700-\u27BFBraillePatterns
\u2800-\u28FFCJKRadicalsSupplement
\u2E80-\u2EFFKangxiRadicals
\u2F00-\u2FDFIdeographicDescriptionCharacters
\u2FF0-\u2FFFCJKSymbolsandPunctuation
CJK符号和标点
\u3000-\u303FHiragana
平假名
\u3040-\u309FKatakana
片假名
\u30A0-\u30FFBopomofo
注音
\u3100-\u312FHangulCompatibilityJamo
\u3130-\u318FKanbun
\u3190-\u319FBopomofoExtended
扩展注音
\u31A0-\u31BFEnclosedCJKLettersandMonths
带括号的CJK字母及月份
\u3200-\u32FFCJKCompatibility
CJK兼容字符
\u3300-\u33FFCJKUnifiedIdeographsExtensionA
CJK统一汉字扩展-A
\u3400-\u4dBFCJKUnifiedIdeographs
CJK统一汉字
\u4E00-\u9fAFYiSyllables
\uA000-\uA48FYiRadicals
\uA490-\uA4CFHangulSyllables
\uAC00-\uD7A3HighSurrogates
\uD800-\uDB7FHighPrivateUseSurrogates
\uDB80-\uDBFFLowSurrogates
\uDC00-\uDFFFPrivateUse
专用区
\uE000-\uF8FFCJKCompatibilityIdeographs
CJK兼容汉字
\uF900-\uFAFFAlphabeticPresentationForms
\uFB00-\uFB4FArabicPresentationForms-A
\uFB50-\uFDFFCombiningHalfMarks
\uFE20-\uFE2FCJKCompatibilityForms
CJK兼容形式
\uFE30-\uFE4FSmallFormVariants
小写变体
\uFE50-\uFE6FArabicPresentationForms-Bound
\uFE70-\ufeFFSpecials
\uFFF0-\uFFFFHalfwidthandFullwidthForms
半形及全形字符
\uFF00-\uFFEF分类
全称
说明Cn
UNASSIGNEDLu
UPPERCASE_LETTERLl
LOWERCASE_LETTERLt
TITLECASE_LETTERLm
MODIFIER_LETTERLo
OTHER_LETTERMn
NON_SPACING_MARKMe
ENCLOSING_MARKMc
COMBINING_SPACING_MARKNd
DECIMAL_DIGIT_NUMBERNl
LETTER_NUMBERNo
OTHER_NUMBERZs
SPACE_SEPARATORZl
LINE_SEPARATORZp
PARAGRAPH_SEPARATORCc
CNTRLCf
FORMATCo
PRIVATE_USECs
SURROGATEPd
DASH_PUNCTUATIONPs
START_PUNCTUATIONPe
END_PUNCTUATIONPc
CONNECTOR_PUNCTUATIONPo
OTHER_PUNCTUATIONSm
MATH_SYMBOLSc
CURRENCY_SYMBOLSk
MODIFIER_SYMBOLSo
OTHER_SYMBOLL
LETTERM
MARKN
NUMBERZ
SEPARATORC
CONTROLP
PUNCTUATIONS
SYMBOLLD
LETTER_OR_DIGITL1
Latin-1all
ALLASCII
ASCIIAlnum
字母数字(0-9,a-z,A-Z)Alpha
字母(a-z,A-Z)Blank
空格和制表符(&#39; &#39;|\t)Cntrl
控制字符，不可打印Digit
数字(0-9)Graph
可打印且可视字母（例如空格&#39; &#39;是可打印的但不是可视字母，而 `a&#39; 两者都是。）Lower
小写字母Print
可打印字母（非控制字符）Punct
标符号（字母、数字、控制、空白符以外的字母），如：!@/#$%}{&lt;&gt;,./?[]等等。Space
空白符(&#39; &#39;,\t,0x09,0x0A,0x0B,0x0C,0x0D,0x20)Upper
大写字母XDigit
十六进制数字(0-9，a-f, A-F)</p>
<p>替换表达式特殊字符
特殊字符介绍
描述\n
换行\b
向前删除一个字符。当这个字符位于替换串之首时，将删除匹配串之前的一个字符。若匹配串位于行首，将使匹配串所在行与前一行相合并。\d
向后删除一个字符。当这个字符位于替换串之末时，将删除匹配串之后的一个字符。若匹配串位于行末，将使匹配串所在行与下一行相合并。\e
插入一个ESC字符\t
插入一个TAB字符\n
n代表查找正则表达式中的子表达式（组）。\1代表第一个子表达式，\2代表第二个子表达式，依次类推。\0代表整个匹配到的字符串。\v
大写下一个字母\U
全部大写以后的字母，直到碰到其它指示符为止。\l
小写下一个字母\L
全部小写以后的字母，直到碰到其它指示符为止。\E
取消所有的字母大小写指示符。</p>
<p>自定义替换表
在查找／替换中使用自定义替换表
有的时候，上述简单的自定义替换功能是不够的。例如，用户可能希望只把出现在括号内的源串替换为目标串。这种文本处理可以通过在查找/替换中使用自定义替换表来解决。
在查找/替换功能中使用自定义替换表的替换函数是\Tn，其中n是0-9的数字， 注意n为0表示第10张替换表。如果略去n，其效果相当于\T1，即使用第一张替换表。例如要把所有放在方括号中的汉字替换为拼音，可以查找“[(\E)]”，替换为“\T{\1}”。即把第一个子表达式的匹配内容按自定义替换表转换。注意，如果\T函数的参数不在替换表的源串中，\T函数的结果与源串相同，即不做任何变换。
有些情况下，用户可能希望只使用替换表的一部分内容。还是以拼音为例，前面给出的替换表中包含了拼音的音调，如果在替换时不希望加上这些音调数字，可以使用“过滤”功能。所谓过滤，其实是用一个正则表达式去分析替换表的目标串，并把其中的某个子表达式取出来。
使用“过滤”时，在“设置自定义替换表”对话框中，点“过滤”按钮，在弹出的对话框中填入一个正则表达式。再以拼音为例，表达式可以写为“(\p{Alpha}+)(\d)”，其中第一对括号中的是不含音调的拼音，第二对括号是音调。在调用\T函数时，JTextPro会在目标串中查找这个正则表达式。但是如何把其中的子表达式取出来呢？\T函数还有一个可选的下标，取第n个子表达式的值就写作\T{...}[n]。所以，把放在方括号中的汉字替换为不带调的拼音，可以查找“[(\E)]”，替换为“\T{\1}[1]”
匹配汉字：
Regex r= new Regex(@&quot;[\u4e00-\u9fa5]+&quot;);
MatchCollection m=r.Match(yourstring);
－－－－－－－－－－－－－－－－－－－－－－－－－
如果需要使用正则表达式匹配Unicode字符的话...
这里是几个主要非英文语系字符范围(google上找到的):
2E80～33FFh：中日韩符号区。收容康熙字典部首、中日韩辅助部首、注音符号、日本假名、韩文音符，中日韩的符号、标点、带圈或带括符文数字、月份，以及日本的假名组合、单位、年号、月份、日期、时间等。
3400～4DFFh：中日韩认同表意文字扩充A区，总计收容6,582个中日韩汉字。
4E00～9FFFh：中日韩认同表意文字区，总计收容20,902个中日韩汉字。
A000～A4FFh：彝族文字区，收容中国南方彝族文字和字根。
AC00～D7FFh：韩文拼音组合字区，收容以韩文音符拼成的文字。
F900～FAFFh：中日韩兼容表意文字区，总计收容302个中日韩汉字。
FB00～FFFDh：文字表现形式区，收容组合拉丁文字、希伯来文、阿拉伯文、中日韩直式标点、小符号、半角符号、全角符号等。
比如需要匹配所有中日韩非符号字符,那么正则表达式应该是^[\u3400-\u9FFF]+$
理论上没错, 可是我到msn.co.ko随便复制了个韩文下来, 发现根本不对, 诡异
来源： &lt;<a href="http://m.blog.csdn.net/blog/MyGameZone/9786825" target="_blank">正则匹配 - CSDN博客</a>&gt;</p>
<p>字符类别
[:alnum:] 字母和数字 
[:alpha:] 字母 
[:ascii:] 字符代码 0 - 127 
[:blank:] 空格或制表符 
[:cntrl:] 控制字符 
[:digit:] 十进制数字 (相同于 \d) 
[:graph:] 可打印字符, 排除空格 
[:lower:] 小写字母 
[:print:] 可打印字符,包括空格 
[:punct:] 可打印字符, 排除文字和数字 
[:space:] 空白空间 (不完全和 \s 相同, 还包括 VT: chr(11) ) 
[:upper:] 大写字母 
[:word:] &quot;字&quot; 字符 (相同于 \w) 
[:xdigit:] 十六进制数
来源： &lt;<a href="http://hi.baidu.com/haijie4975/item/ac94d70a3164d50beafe38bc" target="_blank"> 正则表达式：匹配符号<em>阿杰</em>百度空间</a>&gt;</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/正则/">正则</a></li></span></span> | <span class="tags">Tagged <a href="/tags/正则/" class="label label-primary">正则</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:37"datetime="2014-03-07 09:54:37"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-正则--正则匹配模式/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-正则--正则匹配模式" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-虚拟化_Citrix--什么是CTBS与VPN的区别/">什么是 CTBS 与VPN的区别</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:37.000Z"> <a href="/2014/02/02/2014-02-02-虚拟化_Citrix--什么是CTBS与VPN的区别/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-ctbs-vpn-">什么是 CTBS 与VPN的区别</h1>
<p><a href="http://blog.sina.com.cn/everytingwassimple" target="_blank">简单生活</a></p>
<p><a href="http://blog.sina.com.cn/everytingwassimple[[订阅]](http://blog.sina.com.cn/s/blog_62b551960100fyj6.html#)[[手机订阅]](" target="_blank">http://blog.sina.com.cn/everytingwassimple[[订阅]](http://blog.sina.com.cn/s/blog_62b551960100fyj6.html#)[[手机订阅]](</a>)</p>
<p><a href="http://blog.sina.com.cn/everytingwassimple" target="_blank"><img src="" alt=""></a></p>
<p><a href="http://blog.sina.com.cn/everytingwassimple"></a></p>
<ul>
<li><a href="http://blog.sina.com.cn/everytingwassimple" target="_blank">博客</a></li>
<li><a href="http://photo.blog.sina.com.cn/everytingwassimple" target="_blank">相册</a></li>
<li><a href="http://music.sina.com.cn/m/1656050070" target="_blank">音乐</a></li>
<li><a href="http://you.video.sina.com.cn/everytingwassimple" target="_blank">播客</a></li>
<li><a href="http://profile.blog.sina.com.cn/everytingwassimple" target="_blank">个人中心</a></li>
</ul>
<p><a href="http://blog.sina.com.cn/everytingwassimple" target="_blank">首页</a><a href="http://blog.sina.com.cn/s/articlelist_1656050070_0_1.html" target="_blank">博文</a><a href="http://blog.sina.com.cn/s/favourites_1656050070_1.html" target="_blank">收藏</a><a href="http://profile.blog.sina.com.cn/circle.php?uid=1656050070&amp;page=1&amp;type=3" target="_blank">博客圈</a></p>
<p>字体大小：<a href="http://blog.sina.com.cn/s/" target="_blank">大</a><strong>中</strong><a href="http://blog.sina.com.cn/s/" target="_blank">小</a> 正文</p>
<p><strong>什么是 CTBS  与VPN的区别</strong>(2009-11-20 14:50:49)</p>
<p>标签：<a href="http://uni.sina.com.cn/c.php?t=blog&amp;k=it&amp;ts=bpost&amp;stype=tag" target="_blank">it</a> 
CTBS 是Cray Technology&amp;Best Service的全称。该词广泛的应用于远程接入行业，伴随着企业业务的不断扩大和跨地域性发展，传统的远程办公只能通过对需要远程访问的 PC 或便携式电脑安装客户端程序以及远程访问客户机驱动程序才能实现的方案已逐渐显示出其发展的局限性，因此理想的解决方案是通过便捷的 Web 浏览器的远程访问方案，这种方法需要最少的管理开销，用户随时能即时而容易地访问远程应用程序并操作数据。从而引出了CTBS软件。</p>
<p>CTBS特点：</p>
<p>1．高效利用网络宽带（远程、异地使用问题及远程高效传输的速度问题、快速连接全球各地的分支机构（协同办公、移动商务））</p>
<p>ERP/OA/CRM等应用程序的远程应用全面提速，每个用户只需要28kbps网络带宽；C/S应用程序的B/S模式应用。</p>
<p>2.集中管理，便捷接入</p>
<p>Web方式访问，终端用户免安装应用软件，只要能上网即可快速使用企业的应用系统，简化企业信息化软件的部署、管理，降低IT投入。</p>
<ol>
<li>应用安全</li>
</ol>
<p>在Internet上传输的只是鼠标、键盘的指令和屏幕刷新信息，不传输实际的业务数据，并且通过CTBS远程接入传输的这些信息都是加密的。而传统的VPN</p>
<p>应用，在网络上传输的是实际业务数据，所以CTBS远程接入从原理上就比VPN安全很多。</p>
<p>4.低维护，快速应用</p>
<p>对于企业的IT人员，从过去的需要维护终端用户电脑上的客户端应用软件，改变为只需要维护CTBS远程接入服务器上的客户端应用软件，大大降低了维护成本。</p>
<p>5.低带宽，快速接入</p>
<p>客户端用MODEM就可以轻松实现应用程序的快速访问，网间传输的仅仅是键盘击键、屏幕变化的信息，彻底摈弃过去冗余无效的数据传输模式。</p>
<p>VPN（Virtual Private Network）是指利用密码技术和访问控制技术在公共网络（如Internet）中建立的专用通信网络。在虚拟专用网中，任意两个节点之间的连接并没有传统专用网所需的端到端的物理链路，而是利用某种公众网的资源动态组成，虚拟专用网络对用户端透明，用户好像使用一条专用线路进行通信。</p>
<p>VPN方式数据传输仍然是客户机和服务器的数据传输，所以通过网络要传输大量的数据，对带宽的要求就很高，而当数据量较大时，完全无法保证使用的正常实现，用户最简单的操作也相当缓慢。而且安全也是一项难题，因为应用和数据驻留在客户端桌面系统上，很容易造成资料的流失。这不仅会增加未经授权的访问的危险，也会增加信息丢失或被盗的危险。
而沟通CTBS主要是SBC（Server based Computing）模式，客户端看到的应用程序100%在服务器上运行，网络上并没有大量程序和数据需要传输，传输的只是客户端的显示界面变化的部分；平均每个用户正常工作仅占用28.8K的网络带宽，用户通过普通Modem拨号连接，也能保证正常工作，并发用户多时，使用效果也令人相当满意。使用CTBS后，可对某些用户进行访问限制，将数据牢牢掌控起来。而且采用了工业强度128位的SSL加密技术，网络间传输的也只有屏幕变化等信息，即使有人截取了数据包解密后也不会存在数据被窃取的风险。</p>
<p>以上是一些数据，高手请详细说明，谢谢！CTBS原理！</p>
<p><a href="http://blog.sina.com.cn/s/blog_62b551960100fyj6.html#" target="_blank">分享到新浪微博</a>
已投稿到： <a href="http://blog.sina.com.cn/lm/114/113/day.html" target="_blank">排行榜</a> <a href="http://q.sina.com.cn/blog_groups.php?fid=62b551960100fyj6" target="_blank">圈子</a></p>
<p><a href="">阅读</a>|<a href="http://blog.sina.com.cn/s/blog_62b551960100fyj6.html#comment" target="_blank">评论</a>|<a href="http://blog.sina.com.cn/s/blog_62b551960100fyj6.html#" target="_blank">收藏</a>|<a href="http://blog.sina.com.cn/main_v5/ria/print.html?blog_id=blog_62b551960100fyj6" target="_blank">打印</a>|<a href="">举报</a>
加载中，请稍候...</p>
<p><strong>评论</strong>    <a href="http://blog.sina.com.cn/lm/8/2009/0325/105340.html" target="_blank">重要提示：警惕虚假中奖信息，点击查看详情</a>      <a href="http://sina.allyes.com/main/adfclick?db=sina&amp;bid=181511,226672,231692&amp;cid=0,0,0&amp;sid=220668&amp;advid=3406&amp;camid=32667&amp;show=ignore&amp;url=http://play.sina.com.cn/index.php" target="_blank">新浪开奖汽车手机马上领取</a>**<a href=""></a><a href="http://blog.sina.com.cn/s/blog_62b551960100fyj6.html#post">[发评论]</a></p>
<ul>
<li>评论加载中，请稍候...
<a href=""></a></li>
</ul>
<p><strong>发评论</strong>    <a href="http://profile.blog.sina.com.cn/phone_attentionhelp.php" target="_blank">随时随地抢沙发！</a>    <a href="http://sina.allyes.com/main/adfclick?db=sina&amp;bid=181511,226673,231693&amp;cid=0,0,0&amp;sid=220669&amp;advid=3406&amp;camid=32667&amp;show=ignore&amp;url=http://play.sina.com.cn/index.php" target="_blank">心动开奖分秒有礼物</a></p>
<ul>
<li><p>用户昵称:</p>
</li>
<li><p><a href="http://blog.sina.com.cn/s/blog_62b551960100fyj6.html#" target="_blank"><img src="" alt="">插入表情</a></p>
</li>
<li><p>登录名：</p>
</li>
<li>密码：</li>
<li><a href="http://login.sina.com.cn/getpass.html" target="_blank">找回密码</a></li>
<li><a href="http://login.sina.com.cn/signup/signup.php?entry=blog&amp;srcuid=1656050070" target="_blank">注册</a></li>
<li>昵   称：</li>
<li>匿名评论</li>
</ul>
<p><em>验证码：</em>请点击后输入验证码  <img src="" alt="看不清楚数字吗？点击这里再试试。"><a href="http://blog.sina.com.cn/s/blog_62b551960100fyj6.html#" target="_blank">收听验证码</a></p>
<p><a href="http://blog.sina.com.cn/s/blog_62b551960100fyj6.html#" target="_blank">发评论</a></p>
<p>以上网友发言只代表其个人观点，不代表新浪网的观点或立场。</p>
<p>相关博文</p>
<p>读取中...</p>
<p>推荐博文</p>
<p>读取中...
谁看过这篇博文</p>
<p>读取中...
                    <img src="" alt="">      <img src="" alt=""></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/虚拟化_Citrix/">虚拟化_Citrix</a></li></span></span> | <span class="tags">Tagged <a href="/tags/虚拟化_Citrix/" class="label label-primary">虚拟化_Citrix</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:37"datetime="2014-03-07 09:54:37"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-虚拟化_Citrix--什么是CTBS与VPN的区别/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-虚拟化_Citrix--什么是CTBS与VPN的区别" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>





<ul id="pagination" class="pagination pagination-lg">
  <li><a class="extend prev" href="/page/101/">&laquo;</a></li><li><a class="page-number" href="/">1</a></li><li><a class="page-number" href="/page/2/">2</a></li><li><span class="space">&hellip;</span></li><li><a class="page-number" href="/page/99/">99</a></li><li><a class="page-number" href="/page/100/">100</a></li><li><a class="page-number" href="/page/101/">101</a></li><li class="active"><li><span class="page-number current">102</span></li><li><a class="page-number" href="/page/103/">103</a></li><li><a class="page-number" href="/page/104/">104</a></li><li><a class="page-number" href="/page/105/">105</a></li><li><span class="space">&hellip;</span></li></li><li><a class="page-number" href="/page/164/">164</a></li><li><a class="page-number" href="/page/165/">165</a></li><li><a class="extend next" href="/page/103/">&raquo;</a></li>
  <div class="clearfix"></div>
</ul></div><!--wapper-->
       </div><!-- ID main-col END -->
       <aside id="sidebar" class="alignright col-sx-6 col-sm-4 col-md-3 col-lg-3">
<div id="widget_search" class="widget panel panel-primary">
    <form action="//google.com/search" method="get" accept-charset="utf-8">
  <div class="input-group">
    <input class="form-control" id="searchbox" type="search" name="q" results="0" placeholder="search">
    <span class="input-group-btn">
      <button class="btn btn-default" type="submit">Go!</button>
    </span>
    <input type="hidden" name="q" value="site:itsolife.com">
  </div>
</form>
</div>

<div id="widget_category" class="widget panel panel-primary">
  <div class="panel-heading">category</div>  <div data-src='category' class='ajax_widgets'>正在加载...</div>
</div>

<div id="widget_recent_posts" class="widget panel panel-primary">
  <div class="panel-heading">recent posts</div>  <div data-src='recent_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_tagcloud" class="widget panel panel-primary">
  <div class="panel-heading">tagcloud</div>  <div data-src='tagcloud' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_latest_update_posts" class="widget panel panel-primary">
  <div class="panel-heading">最近更新</div>  <div data-src='latest_update_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_recent_comments" class="widget panel panel-primary">
  <div class="panel-heading">recent comments</div>  

<div class="list-group-item ds-recent-comments" data-num-items="6" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="50"></div>



</div>

</aside>
       <div class="clearfix"></div>
     </div><!-- row END -->
  </div>
  <footer id="footer" class="container">
  <div class="panel panel-info">
  <section id='footer_widget'></section>  <div class="panel-footer">
  <div id="site-info">
    <span class='author'>
  
  &copy; 2014 RobinChia
  
    &nbsp;&nbsp;</span>
  
  <span id='analytics-51la'></span><span id='analytics-google'>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-48559895-1']);
  _gaq.push(['_trackPageview']);
  _js2load.push({src:('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'});
</script></span><span id='analytics-cnzz'>
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_5774006'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s17.cnzz.com/stat.php%3Fid%3D5774006%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
</span><span id='analytics-baidu'>
<script>
var _hmt = _hmt || [];
_js2load.push({src:"//hm.baidu.com/hm.js?1442f50724afc42380b51f097c43082c"});
</script>
</span>  </div>
  <div id="copyright">Blog powered by <a href='http://zespia.tw/hexo/'><strong>hexo</strong></a> Theme <strong><a href='https://github.com/chenall/hexo-theme-chenall'>chenall</a></strong>(Some change in it)<span class="pull-right"> 更新时间: <em>2014-03-15 17:47:11</em></span></div>
</div>
<div class="clearfix"></div>


  </div>
  </footer>
  
        <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>        
        <script src="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/js/bootstrap.min.js"></script>        
                
        <script src="http://cdn.bootcss.com/prettify/r298/prettify.min.js"></script>    <script type="text/javascript">
   var lang=["bsh", "c", "cc", "cpp", "cs", "csh", "cyc", "cv", "htm", "html",
    "java", "js", "m", "mxml", "perl", "pl", "pm", "py", "rb", "sh",
    "xhtml", "xml", "xsl"];
   var pretty_base='';
   $('script').each(function(){
	var c = $(this).attr('src');
	if (!c)
	    return;
	if (c.match(/(\/)?prettify(\.min)?\.js/i))
	{
	    var index = c.lastIndexOf('/');
	    if (index != -1)
		pretty_base = c.substr(0,index + 1);
	    return false;
	}
   })
   $('pre code').each(function(){
	var c = $(this).attr('class')
	if (!c)
	    return;
	c = c.match(/\s?(lang\-\w+)/i);
	if (c && lang.indexOf(c[1]) == -1)
	{
	    lang.push(c[1]);
	    $.getScript(pretty_base + c[1] + '.min.js');
	}
   })

    $(window).load(function(){
       $("pre").addClass("prettyprint");
       prettyPrint();
    })
</script>    
            <script type="text/javascript">
var duoshuoQuery = {short_name:"robinchia"};
_js2load.push({src:'http://static.duoshuo.com/embed.js',charset:'UTF-8'});
</script>
    
            <!--wumii_relatedItems-->
    
        <script src="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js"></script>    <script type="text/javascript">
(function($){
  $('.entry').each(function(i){
    $(this).find('img').each(function(){
      var alt = this.alt;

      if (alt){
        $(this).before('<span class="caption">' + alt + '</span>');
      }

      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="fancybox' + i + '" />');
    });
  });

  $('.fancybox').fancybox();
})(jQuery);
</script>    
        <script src="http://cdn.bootcss.com/mathjax/2.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>
    
<script type="text/javascript">
$('.ajax_widgets').each(function(){var src=$(this).attr('data-src');if(src)$(this).load('/widgets/'+src+'.html');});
$.each(_js2load,function(index,obj){loadjs(obj.src,obj.charset)});
</script>

<div id="scroll2top">
<img src="/scroll2top/arrow.png"/>
</div>
<script src="/scroll2top/scroll2top.min.js"></script>
<div id="winterland">
  <canvas></canvas>
</div>
<script src="/js/winterland.min.js"></script>

  </body>
</html>
