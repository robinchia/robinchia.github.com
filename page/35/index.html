
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>The 35 Page | It so life</title>
<meta name="author" content="RobinChia">

<meta name="description" content="It so life">


<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta property="og:site_name" content="It so life"/>

<!--[if IE]><style>.testIE.IE{display:inline;}</style><![endif]-->
<!--[if lte IE 7]><link rel="stylesheet" href="/css/ie7.css" type="text/css"><![endif]-->
<!--[if (lt IE 9)&(gt IE 7)]><style>.testIE.IE8{display:inline;}</style><![endif]-->
<!--[if gt IE 8]><style>.testIE.IE9{display:inline;}</style><![endif]-->

<link href="/favicon.png" rel="icon">
<link rel="alternate" href="/atom.xml" title="It so life Feed" type="application/atom+xml">

<link rel="stylesheet" href="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.0.3/css/font-awesome.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/prettify/r298/prettify.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" type="text/css">
<link rel="stylesheet" href="/css/style.css" type="text/css">
<!--[if lt IE 9]>
   <style>article,aside,dialog,footer,header,section,footer,nav,figure,menu{display:block}</style>
   <script src="http://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
   <script src="http://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
<link href="http://cdn.staticfile.org/respond.js/1.4.2/respond-proxy.html" id="respond-proxy" rel="respond-proxy" />
<link href="/js/respond.proxy.gif" id="respond-redirect" rel="respond-redirect" />
<script src="/js/respond.proxy.js"></script>
   <script src="http://cdn.bootcss.com/selectivizr/1.0.2/selectivizr-min.js"></script>
<![endif]-->
<script type="text/javascript">
function loadjs(c,d){var a=document.createElement("script");a.async=!0;a.type="text/javascript";a.src=c;a.charset=d||"gbk";(document.getElementsByTagName("HEAD")[0]||document.getElementsByTagName("BODY")[0]).appendChild(a)};
var _protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
var _js2load = [];
</script>

</head>
<body>
      <header id="header" class="container"><nav id="main-nav" class="navbar navbar-default navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="/">It so life</a>
    </div>
    <div  class="collapse navbar-collapse">
      <ul  class="nav navbar-nav">
  
        <li><a href="/" title="Home">Home</a></li>      
        <li><a href="/about/" title="About">About</a></li>      
        <li><a href="/archives/" title="Archives">Archives</a></li>      
      <li class='dropdown'>
        <a class='dropdown-toggle' data-toggle='dropdown' href='#'>website<b class='caret'></b></a>
        <ul class='dropdown-menu pure-menu-selected'>
    
          <li><a href="//groups.google.com/forum/#!forum/pongba" title="TopLanguage">TopLanguage</a></li>    
          <li><a href="//itpub.net/" title="ITPub">ITPub</a></li>    
          <li><a href="//blog.jobbole.com/" title="Bole">Bole</a></li>    
          <li><a href="//nosql-database.org/" title="nosql">nosql</a></li>    
          <li><a href="//gitimmersion.googol.im/" title="Git">Git</a></li>    
        </ul>
      </li>
    
      </ul>
      <ul class="nav navbar-nav navbar-right">
      
        <li><a href="/atom.xml">RSS</a></li>
      
      
        <li><a href="https://twitter.com/robinchia">twitter</a></li>
      
      
      
      
        <li><a href="https://github.com/robinchia">github</a></li>
      
      </ul>
    </div>
  </div>
</nav>
<div class="clearfix"></div>
</header>
  <div id='content' class="container">
     <div class="page-header-wrapper">
      <!--[if lt IE 9]><div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong>提示:</strong>您的浏览器版本太低了,建议升级到 <strong><a href="http://windows.microsoft.com/zh-cn/internet-explorer/download-ie" title="IE9">IE9</a></strong> 以上,本站使用<a href="https://www.google.com/intl/zh-CN/chrome/">Chrome浏览器</a>可以获得最好的显示效果.</div><![endif]-->
      <div class="page-header"><h1 align="center"><big>It so life</big> </h1>
        <h5 align="center"><big>love as life</big></h5>
      </div>
     </div>
     <div class="row">
       <div id="main-col" class="alignleft col-sx-12 col-sm-8 col-md-9 col-lg-9">
      <section id='header_widget'></section>
          <div id="wrapper"><article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-连接池--JavaSocket连接池/">Java Socket连接池</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:43.000Z"> <a href="/2014/02/02/2014-02-02-连接池--JavaSocket连接池/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="java-socket-">Java Socket连接池</h1>
<p>1：SocketAdapter类，此类继承了socket，重载了socket类的close方法，目的是当用户关闭socket的时候，我们并不关闭它只是放在连接池内部。
package com.tarena.socketpool;
import java.net./<em>;
import java.io.IOException;
//</em>/<em>
/</em> <p>socket连接的简单实现</p>
/<em> <p>Description: </p>
/</em> <p>Copyright: Copyright Tarena(c) 2005</p>
/<em> <p>Company: Tarena</p>
/</em> @author chengxing
/<em> @version 1.0
/</em>/
public class ConnectionAdapter extends Socket{
//<em>/</em>
/<em> 连接状态
/</em>/
private boolean status=true;
//<em>/</em>
/<em> 默认的构造函数
/</em>/
public ConnectionAdapter() {
super();
}
public ConnectionAdapter(String host,int port)throws UnknownHostException,IOException{
super(host,port);
}
//<em>/</em>
/<em> 判断此连接是否空闲
/</em> @return boolean 空闲返回ture,否则false
/<em>/
public boolean isFree(){
return status;
}
//</em>/<em>
/</em> 当使用此连接的时候设置状态为false（忙碌）
/<em>/
public void setBusy(){
this.status=false;
}
//</em>/<em>
/</em> 当客户端关闭连接的时候状态设置为true(空闲）
/*/
public void close(){
System.out.println(Close : set the status is free );
status=true;
}
public void destroy(){
//Close socket connection
close();
// System.out.println(Close success );
}
}
第二个类连接管理器。
package com.tarena.socketpool;</p>
<p>import java.lang.reflect./<em>;
import java.util.Properties;
//</em>/<em>
/</em> <p>连接管理器</p>
/<em> <p>Copyright: Copyright Tarena(c) 2005</p>
/</em> <p>Company: Tarena</p>
/<em> @author chengxing
/</em> @version 1.0
/<em>/
public class ConnectionManager {
//测试程序默认的连接池实现类
public static final String PROVIDER_CLASS=com.tarena.socketpool.MyConnectionProvider;
//测试程序的默认ip
public static final String HOST=127.0.0.1;
//测试程序的默认端口号
public static final String PORT=9880;
//</em>/<em>
/</em> 注册钩子程序的静态匿名块
/<em>/
static {
//增加钩子控制资源的释放周期
Runtime runtime = Runtime.getRuntime();
Class c = runtime.getClass();
try {
Method m = c.getMethod(addShutdownHook, new Class[] { Thread.class } );
m.invoke(runtime, new Object[] { new ShutdownThread() });
}
catch (NoSuchMethodException e) {
e.printStackTrace();
// Ignore -- the user might not be running JDK 1.3 or later.
}
catch (Exception e) {
e.printStackTrace();
}
}
//</em>/<em>
/</em> 默认的构造函数
/<em>/
public ConnectionManager() {
}
//</em>/<em>
/</em> 得到并初始化一个连接池
/<em> 连接池的实现类通过系统参数来传递进来，通过命令行-DConnectionProvider=YourImplClass
/</em> 如果没有指定的实现的话，则采用系统默认的实现类
/<em> 通过命令行传入的参数列表如下
/</em> 对方主机名-DHost=192.168.0.200
/<em> 对方端口号　-DPort=9880
/</em> 最小连接数 -DMax_style=&#39;font-size:10px&#39;0
/<em> 最大连结数　-DMin_style=&#39;font-size:14px&#39;0
/</em> 以上的值可以改变，但是参数不能改变，
/<em> 最大连结数和最小连接数可以省略，默认值分别为２０和１０
/</em> @return ConnectionProvider
/*/
public static ConnectionProvider getConnectionProvider()throws Exception{
String provider_class=System.getProperty(ConnectionProvider);
if(provider_class==null)provider_class=PROVIDER_CLASS;</p>
<p>String host=System.getProperty(Host);
if(host==null)host=HOST;</p>
<p>String port=System.getProperty(port);
if(port==null)port=PORT;</p>
<p>String max_size=System.getProperty(Max_size);
String min_size=System.getProperty(Min_size);</p>
<p>Properties pro=new Properties();
pro.setProperty(ConnectionProvider.SERVER_IP,host);
pro.setProperty(ConnectionProvider.SERVER_PORT,port);
if(max_size!=null)pro.setProperty(ConnectionProvider.MAX_SIZE,max_size);
if(min_size!=null)pro.setProperty(ConnectionProvider.MIN_SIZE,min_size);
//通过反射得到实现类
System.out.println(provider_class);
System.out.flush();
Class provider_impl=Class.forName(provider_class);
//由于是单子模式，采用静态方法回调
Method m=provider_impl.getMethod(newInstance,new Class[]{java.util.Properties.class});
ConnectionProvider provider=null;
try{
provider = (ConnectionProvider) m.invoke(provider_impl, new Object[]{pro});
}catch(Exception e){
e.printStackTrace();
}</p>
<p>return provider;
}
//<em>/</em>
/<em>
/</em> <p>一个钩子的线程: 在程序结束的时候调用注销连接池</p>
/<em> <p>Description: </p>
/</em> <p>Copyright: Copyright Tarena(c) 2005</p>
/<em> <p>Company: Tarena</p>
/</em> @author chengxing
/<em> @version 1.0
/</em>/
private static class ShutdownThread extends Thread {
public void run() {
try{
ConnectionProvider provider = ConnectionManager.getConnectionProvider();
if (provider != null) {
provider.destroy();
}
}catch(Exception e){
e.printStackTrace();
}
}
}</p>
<p>}</p>
<p>第三个类，连接池的接口定义
package com.tarena.socketpool;</p>
<p>import java.net./<em>;
import java.util./</em>;
import java.io.IOException;</p>
<p>//<em>/</em>
/<em>
/</em> <p>定义的抽象类，所有的子类必须单子模式去实现，
/<em> 统一方法为public ConnectionProvider newInstance();
/</em> 连接提供器的抽象接口，每一个实现它的子类最好都是JAVABEAN，
/<em> 这样它的方法就可以是被外界控制</p>
/</em> @see JiveBeanInfo
/<em> <p>Copyright: Copyright Tarena(c) 2005</p>
/</em> <p>Company: Tarena</p>
/<em> @author chengxing
/</em> @version 1.0
/*/
public interface
ConnectionProvider {
public static final String SERVER_IP = SERVER_IP_ADDRESS;
public static final String SERVER_PORT = SERVER_IP_PORT;
public static final String MAX_SIZE = MAX_SIZE;
public static final String MIN_SIZE = MIN_SIZE;</p>
<p>//<em>/</em>
/<em>判断连接池内是否有连接
/</em> @return true 有连接返回true,否则返回false
/*/
public boolean isPooled();</p>
<p>//<em>/</em>
/<em> 当此方法被调用的时候提供一个 socket
/</em> @see Socket
/<em> @return Socket a Connection object.
/</em>/
public Socket getConnection() throws java.net.SocketException;</p>
<p>//<em>/</em>
/<em> 连接池初始化
/</em>/
public void init() throws UnknownHostException, IOException;</p>
<p>//<em>/</em>
/<em> 连接池重新启动
/</em>/
public void restart() throws UnknownHostException, IOException;</p>
<p>//<em>/</em>
/<em> 注销连接池
/</em>/
public void destroy();
}
第四个类MyConnectionProvider，自己写的一个连接池的简单实现
package com.tarena.socketpool;</p>
<p>import java.util./<em>;
import java.net./</em>;
import java.net.SocketException;
import java.io.IOException;</p>
<p>//<em>/</em>
/<em>
/</em> <p>这是一个连接管理器的简单实现</p>
/<em> <p>Description: implements the Interface ConnectionProvider</p>
/</em> <p>Copyright: Copyright Tarena(c) 2005</p>
/<em> <p>Company: Tarena</p>
/</em> @author chengxing
/<em> @version 1.0
/</em>/
public class MyConnectionProvider
implements ConnectionProvider {</p>
<p>private Properties pro = null;
private static ConnectionProvider provider = null;
private static Object object_lock = new Object();
private String ip;
private String port;</p>
<p>//<em>/</em>
/<em> 默认的最大连接数
/</em>/
private int max_size = 20;</p>
<p>//<em>/</em>
/<em> 默认的最小连接数
/</em>/
private int min_size = 10;</p>
<p>//<em>/</em>
/<em> Socket connection池数组
/</em>/
private ConnectionAdapter[] socketpool = null;</p>
<p>//<em>/</em>
/<em> 构造对象的时候初始化连接池
/</em> @throws UnknownHostException 未知的主机异常
/<em> @throws IOException
/</em>/
private MyConnectionProvider(Properties pro) throws UnknownHostException,
IOException {
ip = pro.getProperty(SERVER_IP);
port = pro.getProperty(SERVER_PORT);
String max_size_s = pro.getProperty(MAX_SIZE);
String min_size_s = pro.getProperty(MIN_SIZE);
if (max_size_s != null) {
max_size = Integer.parseInt(max_size_s);
}
if (min_size_s != null) {
min_size = Integer.parseInt(min_size_s);
}</p>
<p>init(); //构造对象的时候初始化连接池
}</p>
<p>//<em>/</em>
/<em> 判断是否已经池化
/</em> @return boolean 如果池化返回ture,反之返回false
/*/
public boolean isPooled() {
if (socketpool != null) {
return true;
}
else return false;
}</p>
<p>//<em>/</em>
/<em>返回一个连接
/</em> @return a Connection object.
/*/
public Socket getConnection() {
Socket s = null;
for (int i = 0; i &lt; socketpool.length; i++) {
if (socketpool[i] != null) {
//如果有空闲的连接，返回一个空闲连接，如果没有，继续循环
if (socketpool[i].isFree()) {
s = socketpool[i];
return s;
}
else continue;
}
else { //如果连接为空，证明超过最小连接数，重新生成连接
try {
s = socketpool[i] = new ConnectionAdapter(ip, Integer.parseInt(port));
}
catch (Exception e) {
//never throw
}
}
}
//如果连接仍旧为空的话，则超过了最大连接数
if (s == null) {
try { //生成普通连接，由客户端自行关闭，释放资源，不再由连接池管理
s = new Socket(ip, Integer.parseInt(port));
}
catch (Exception e) { //此异常永远不会抛出
}
}
return s;
}</p>
<p>//<em>/</em>
/<em> 初始化连接池
/</em> @throws UnknownHostException 主机ip找不到
/<em> @throws IOException 此端口号上无server监听
/</em>/
public void init() throws UnknownHostException, IOException {</p>
<p>socketpool = new ConnectionAdapter[max_size];
for (int i = 0; i &lt; min_size; i++) {
socketpool[i] = new ConnectionAdapter(ip, Integer.parseInt(port));
System.out.print( . );
}
System.out.println();
System.out.println(System init success ....);
}</p>
<p>//<em>/</em>
/<em> 重新启动连接池
/</em> @throws UnknownHostException
/<em> @throws IOException
/</em>/
public void restart() throws UnknownHostException, IOException {
destroy();
init();
}</p>
<p>//<em>/</em>
/<em> 注销此连接池
/</em>/
public void destroy() {
for (int i = 0; i &lt; socketpool.length; i++) {
if (socketpool[i] != null) {
ConnectionAdapter adapter = (ConnectionAdapter) socketpool[i];
adapter.destroy();
System.out.print( . );
}
}
System.out.println(\ndestory success ....);
}
//<em>/</em>
/<em> 静态方法，生成此连接池实现的对象
/</em> @param pro Properties 此连接池所需要的所有参数的封装
/<em> @throws UnknownHostException 主机无法找到
/</em> @throws IOException 与服务器无法建立连接
/<em> @return ConnectionProvider 返回父类ConnectionProvider
/</em>/
public static ConnectionProvider newInstance(java.util.Properties pro) throws
UnknownHostException, IOException {
if (provider == null) {
synchronized (object_lock) {
if (provider == null) {
provider = new MyConnectionProvider(pro);
}
}
}
return provider;
}
//<em>/</em>
/<em>设置系统属性 通过封装系统properties对象来封装所需要的不同值
/</em> SERVER_IP，SERVER_PORT，MAX_SIZE,MIN_SIZE等父类定义的不同的参数
/<em> @param pro Properties 传进来的系统属性
/</em>/
public void setProperties(Properties pro) {
this.pro = pro;
}
}</p>
<p>posted on 2008-04-26 16:51 <a href="http://www.cnblogs.com/pony/" target="_blank">马森</a> 阅读(661) <a href="http://www.cnblogs.com/pony/archive/2008/04/26/1172288.html#Post" target="_blank">评论(0)</a> <a href="http://www.cnblogs.com/pony/admin/EditPosts.aspx?postid=1172288" target="_blank">编辑</a> <a href="http://www.cnblogs.com/pony/AddToFavorite.aspx?id=1172288" target="_blank">收藏</a> <a href="http://www.cnblogs.com/pony/archive/2008/04/26/1172288.html#" target="_blank">网摘</a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/连接池/">连接池</a></li></span></span> | <span class="tags">Tagged <a href="/tags/连接池/" class="label label-primary">连接池</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:43"datetime="2014-03-07 09:54:43"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-连接池--JavaSocket连接池/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-连接池--JavaSocket连接池" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-连接池--druid教程/">druid 教程</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:43.000Z"> <a href="/2014/02/02/2014-02-02-连接池--druid教程/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="druid-">druid 教程</h1>
<pre><code> java程序很大一部分要操作数据库，为了提高性能操作数据库的时候，有不得不使用数据库连接池。数据库连接池有很多选择，c3p、dhcp、proxool等，druid作为一名后起之秀，凭借其出色的性能，也逐渐印入了大家的眼帘。接下来本教程就说一下druid的简单使用。
</code></pre><p> 首先从<a href="http://repo1.maven.org/maven2/com/alibaba/druid/" target="_blank"><a href="http://repo1.maven.org/maven2/com/alibaba/druid/">http://repo1.maven.org/maven2/com/alibaba/druid/</a></a> 下载最新的jar包。如果想使用最新的源码编译，可以从<a href="https://github.com/alibaba/druid" target="_blank"><a href="https://github.com/alibaba/druid">https://github.com/alibaba/druid</a></a> 下载源码，然后使用maven命令行，或者导入到eclipse中进行编译。</p>
<h2 id="-1-"><a href=""></a>1 配置</h2>
<p>和dbcp类似，druid的配置项如下</p>
<p>配置 缺省值 说明 name   配置这个属性的意义在于，如果存在多个数据源，监控的时候
可以通过名字来区分开来。如果没有配置，将会生成一个名字，
格式是：&quot;DataSource-&quot; + System.identityHashCode(this) jdbcUrl   连接数据库的url，不同数据库不一样。例如：
mysql : jdbc:mysql://10.20.153.104:3306/druid2 
oracle : jdbc:oracle:thin:@10.20.149.85:1521:ocnauto username   连接数据库的用户名 password   连接数据库的密码。如果你不希望密码直接写在配置文件中，
可以使用ConfigFilter。详细看这里：
<a href="https://github.com/alibaba/druid/wiki/%E4%BD%BF%E7%94%A8ConfigFilter" target="_blank"><a href="https://github.com/alibaba/druid/wiki/%E4%BD%BF%E7%94%A8ConfigFilter">https://github.com/alibaba/druid/wiki/%E4%BD%BF%E7%94%A8ConfigFilter</a></a> driverClassName 根据url自动识别 这一项可配可不配，如果不配置druid会根据url自动识别dbType，
然后选择相应的driverClassName initialSize 0 初始化时建立物理连接的个数。初始化发生在显示调用init方法，
或者第一次getConnection时 maxActive 8 最大连接池数量 maxIdle 8 已经不再使用，配置了也没效果 minIdle   最小连接池数量 maxWait   获取连接时最大等待时间，单位毫秒。配置了maxWait之后，
缺省启用公平锁，并发效率会有所下降，
如果需要可以通过配置useUnfairLock属性为true使用非公平锁。 poolPreparedStatements false 是否缓存preparedStatement，也就是PSCache。
PSCache对支持游标的数据库性能提升巨大，比如说oracle。
在mysql下建议关闭。 maxOpenPreparedStatements -1 要启用PSCache，必须配置大于0，当大于0时，
poolPreparedStatements自动触发修改为true。
在Druid中，不会存在Oracle下PSCache占用内存过多的问题，
可以把这个数值配置大一些，比如说100 validationQuery   用来检测连接是否有效的sql，要求是一个查询语句。
如果validationQuery为null，testOnBorrow、testOnReturn、
testWhileIdle都不会其作用。 testOnBorrow true 申请连接时执行validationQuery检测连接是否有效，
做了这个配置会降低性能。 testOnReturn false 归还连接时执行validationQuery检测连接是否有效，
做了这个配置会降低性能 testWhileIdle false 建议配置为true，不影响性能，并且保证安全性。
申请连接的时候检测，如果空闲时间大于
timeBetweenEvictionRunsMillis，
执行validationQuery检测连接是否有效。 timeBetweenEvictionRunsMillis   有两个含义：
1) Destroy线程会检测连接的间隔时间
 2) testWhileIdle的判断依据，详细看testWhileIdle属性的说明 numTestsPerEvictionRun   不再使用，一个DruidDataSource只支持一个EvictionRun minEvictableIdleTimeMillis     connectionInitSqls   物理连接初始化的时候执行的sql exceptionSorter 根据dbType自动识别 当数据库抛出一些不可恢复的异常时，抛弃连接 filters   属性类型是字符串，通过别名的方式配置扩展插件，
常用的插件有：
监控统计用的filter:stat 
日志用的filter:log4j
 防御sql注入的filter:wall proxyFilters   类型是List<com.alibaba.druid.filter.Filter>，
如果同时配置了filters和proxyFilters，
是组合关系，并非替换关系<strong>表1.1 配置属性</strong></p>
<p>根据常用的配置属性，首先给出一个如下的配置文件，放置于src目录下。</p>
<p><strong>[plain]</strong> <a href="http://blog.csdn.net/yunnysunny/article/details/8657095#" title="view plain" target="_blank">view plain</a><a href="http://blog.csdn.net/yunnysunny/article/details/8657095#" title="copy" target="_blank">copy</a></p>
<ol>
<li>url:jdbc:mysql://localhost:3306/dragoon_v25_masterdb  </li>
<li>driverClassName:com.mysql.jdbc.Driver  </li>
<li>username:root  </li>
<li>password:aaaaaaaa  </li>
<li></li>
<li>filters:stat  </li>
<li></li>
<li>maxActive:20  </li>
<li>initialSize:1  </li>
<li>maxWait:60000  </li>
<li>minIdle:10  </li>
<li>/#maxIdle:15  </li>
<li></li>
<li>timeBetweenEvictionRunsMillis:60000  </li>
<li>minEvictableIdleTimeMillis:300000  </li>
<li></li>
<li>validationQuery:SELECT &#39;x&#39;  </li>
<li>testWhileIdle:true  </li>
<li>testOnBorrow:false  </li>
<li>testOnReturn:false  </li>
<li>/#poolPreparedStatements:true  </li>
<li>maxOpenPreparedStatements:20  </li>
<li></li>
<li>/#对于长时间不使用的连接强制关闭  </li>
<li>removeAbandoned:true  </li>
<li>/#超过30分钟开始关闭空闲连接  </li>
<li>removeAbandonedTimeout:1800  </li>
<li>/#将当前关闭动作记录到日志  </li>
<li>logAbandoned:true  </li>
</ol>
<p><strong>配置文件1.1 </strong></p>
<p>配置项中指定了各个参数后，在连接池内部是这么使用这些参数的。数据库连接池在初始化的时候会创建initialSize个连接，当有数据库操作时，会从池中取出一个连接。如果当前池中正在使用的连接数等于maxActive，则会等待一段时间，等待其他操作释放掉某一个连接，如果这个等待时间超过了maxWait，则会报错；如果当前正在使用的连接数没有达到maxActive，则判断当前是否空闲连接，如果有则直接使用空闲连接，如果没有则新建立一个连接。在连接使用完毕后，不是将其物理连接关闭，而是将其放入池中等待其他操作复用。</p>
<p>同时连接池内部有机制判断，如果当前的总的连接数少于miniIdle，则会建立新的空闲连接，以保证连接数得到miniIdle。如果当前连接池中某个连接在空闲了timeBetweenEvictionRunsMillis时间后任然没有使用，则被物理性的关闭掉。有些数据库连接的时候有超时限制（mysql连接在8小时后断开），或者由于网络中断等原因，连接池的连接会出现失效的情况，这时候设置一个testWhileIdle参数为true，可以保证连接池内部定时检测连接的可用性，不可用的连接会被抛弃或者重建，最大情况的保证从连接池中得到的Connection对象是可用的。当然，为了保证绝对的可用性，你也可以使用testOnBorrow为true（即在获取Connection对象时检测其可用性），不过这样会影响性能。</p>
<h2 id="-2-"><a href=""></a>2 代码编写</h2>
<h3 id="-2-1-spring"><a href=""></a>2.1 使用spring</h3>
<p>首先给出spring配置文件</p>
<p><strong>[html]</strong> <a href="http://blog.csdn.net/yunnysunny/article/details/8657095#" title="view plain" target="_blank">view plain</a><a href="http://blog.csdn.net/yunnysunny/article/details/8657095#" title="copy" target="_blank">copy</a></p>
<ol>
<li>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;  </li>
<li>&lt;beans xmlns=&quot;<a href="http://www.springframework.org/schema/beans" target="_blank">http://www.springframework.org/schema/beans</a>&quot;  </li>
<li>xmlns:xsi=&quot;<a href="http://www.w3.org/2001/XMLSchema-instance" target="_blank">http://www.w3.org/2001/XMLSchema-instance</a>&quot;  </li>
<li>xsi:schemaLocation=&quot;<a href="http://www.springframework.org/schema/mvc" target="_blank">http://www.springframework.org/schema/mvc</a> <a href="http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd" target="_blank">http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd</a>  </li>
<li><a href="http://www.springframework.org/schema/beans" target="_blank">http://www.springframework.org/schema/beans</a> <a href="http://www.springframework.org/schema/beans/spring-beans-3.0.xsd" target="_blank">http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</a>  </li>
<li><a href="http://www.springframework.org/schema/context" target="_blank">http://www.springframework.org/schema/context</a> <a href="http://www.springframework.org/schema/context/spring-context-3.0.xsd&quot;&gt;" target="_blank">http://www.springframework.org/schema/context/spring-context-3.0.xsd&quot;&gt;</a>  </li>
<li><!-- 给web使用的spring文件 -->  </li>
<li>&lt;bean id=&quot;propertyConfigurer&quot;  </li>
<li>class=&quot;org.springframework.beans.factory.config.PropertyPlaceholderConfigurer&quot;&gt;  </li>
<li><property name="locations">  </li>
<li><list>  </li>
<li><value>/WEB-INF/classes/dbconfig.properties</value>  </li>
<li></list>  </li>
<li></property>  </li>
<li></bean>  </li>
<li>&lt;bean id=&quot;dataSource&quot; class=&quot;com.alibaba.druid.pool.DruidDataSource&quot;  </li>
<li>destroy-method=&quot;close&quot;&gt;  </li>
<li><property name="url" value="${url}" />  </li>
<li><property name="username" value="${username}" />  </li>
<li><property name="password" value="${password}" />  </li>
<li><property name="driverClassName" value="${driverClassName}" />  </li>
<li><property name="filters" value="${filters}" />  </li>
<li></li>
<li><property name="maxActive" value="${maxActive}" />  </li>
<li><property name="initialSize" value="${initialSize}" />  </li>
<li><property name="maxWait" value="${maxWait}" />  </li>
<li><property name="minIdle" value="${minIdle}" />  </li>
<li></li>
<li><property name="timeBetweenEvictionRunsMillis" value="${timeBetweenEvictionRunsMillis}" />  </li>
<li><property name="minEvictableIdleTimeMillis" value="${minEvictableIdleTimeMillis}" />  </li>
<li></li>
<li><property name="validationQuery" value="${validationQuery}" />  </li>
<li><property name="testWhileIdle" value="${testWhileIdle}" />  </li>
<li><property name="testOnBorrow" value="${testOnBorrow}" />  </li>
<li><property name="testOnReturn" value="${testOnReturn}" />  </li>
<li>&lt;property name=&quot;maxOpenPreparedStatements&quot;  </li>
<li>value=&quot;${maxOpenPreparedStatements}&quot; /&gt;  </li>
<li><property name="removeAbandoned" value="${removeAbandoned}" /> <!-- 打开removeAbandoned功能 -->  </li>
<li><property name="removeAbandonedTimeout" value="${removeAbandonedTimeout}" /> <!-- 1800秒，也就是30分钟 -->  </li>
<li><property name="logAbandoned" value="${logAbandoned}" /> <!-- 关闭abanded连接时输出错误日志 -->  </li>
<li></bean>  </li>
<li></li>
<li>&lt;bean id=&quot;dataSourceDbcp&quot; class=&quot;org.apache.commons.dbcp.BasicDataSource&quot;  </li>
<li>destroy-method=&quot;close&quot;&gt;  </li>
<li></li>
<li><property name="driverClassName" value="${driverClassName}" />  </li>
<li><property name="url" value="${url}" />  </li>
<li><property name="username" value="${username}" />  </li>
<li><property name="password" value="${password}" />  </li>
<li></li>
<li><property name="maxActive" value="${maxActive}" />  </li>
<li><property name="minIdle" value="${minIdle}" />  </li>
<li><property name="maxWait" value="${maxWait}" />  </li>
<li><property name="defaultAutoCommit" value="true" />  </li>
<li></li>
<li><property name="timeBetweenEvictionRunsMillis" value="${timeBetweenEvictionRunsMillis}" />  </li>
<li><property name="minEvictableIdleTimeMillis" value="${minEvictableIdleTimeMillis}" />  </li>
<li></li>
<li><property name="validationQuery" value="${validationQuery}" />  </li>
<li><property name="testWhileIdle" value="${testWhileIdle}" />  </li>
<li><property name="testOnBorrow" value="${testOnBorrow}" />  </li>
<li><property name="testOnReturn" value="${testOnReturn}" />  </li>
<li>&lt;property name=&quot;maxOpenPreparedStatements&quot;  </li>
<li>value=&quot;${maxOpenPreparedStatements}&quot; /&gt;  </li>
<li><property name="removeAbandoned" value="${removeAbandoned}" />   </li>
<li><property name="removeAbandonedTimeout" value="${removeAbandonedTimeout}" />  </li>
<li><property name="logAbandoned" value="${logAbandoned}" />  </li>
<li></bean>  </li>
<li></li>
<li></li>
<li><!-- jdbcTemplate -->  </li>
<li><bean id="jdbc" class="org.springframework.jdbc.core.JdbcTemplate">  </li>
<li><property name="dataSource">  </li>
<li><ref bean="dataSource" />  </li>
<li></property>  </li>
<li></bean>  </li>
<li></li>
<li>&lt;bean id=&quot;SpringTableOperatorBean&quot; class=&quot;com.whyun.druid.model.TableOperator&quot;  </li>
<li>scope=&quot;prototype&quot;&gt;  </li>
<li><property name="dataSource">  </li>
<li><ref bean="dataSource" />  </li>
<li></property>  </li>
<li></bean>  </li>
<li></li>
<li></beans>  </li>
</ol>
<p><strong>配置文件2.1</strong></p>
<p>其中第一个bean中给出的配置文件/WEB-INF/classes/dbconfig.properties就是第1节中给出的配置文件。我这里还特地给出dbcp的spring配置项，目的就是将两者进行对比，方便大家进行迁移。这里没有使用JdbcTemplate，所以jdbc那个bean没有使用到。下面给出com.whyun.druid.model.TableOperator类的代码。</p>
<p><strong>[java]</strong> <a href="http://blog.csdn.net/yunnysunny/article/details/8657095#" title="view plain" target="_blank">view plain</a><a href="http://blog.csdn.net/yunnysunny/article/details/8657095#" title="copy" target="_blank">copy</a></p>
<ol>
<li>package com.whyun.druid.model;  </li>
<li></li>
<li>import java.sql.Connection;  </li>
<li>import java.sql.PreparedStatement;  </li>
<li>import java.sql.SQLException;  </li>
<li>import java.sql.Statement;  </li>
<li></li>
<li>import javax.sql.DataSource;  </li>
<li></li>
<li>public class TableOperator {  </li>
<li>private DataSource dataSource;  </li>
<li>public void setDataSource(DataSource dataSource) {  </li>
<li>this.dataSource = dataSource;  </li>
<li>}  </li>
<li></li>
<li>private static final int COUNT = 800;      </li>
<li></li>
<li>public TableOperator() {  </li>
<li></li>
<li>}  </li>
<li></li>
<li>public void tearDown() throws Exception {  </li>
<li>try {  </li>
<li>dropTable();  </li>
<li>} catch (SQLException e) {  </li>
<li>e.printStackTrace();  </li>
<li>}         </li>
<li>}  </li>
<li></li>
<li>public void insert() throws Exception {  </li>
<li></li>
<li>StringBuffer ddl = new StringBuffer();  </li>
<li>ddl.append(&quot;INSERT INTO t_big (&quot;);  </li>
<li>for (int i = 0; i &lt; COUNT; ++i) {  </li>
<li>if (i != 0) {  </li>
<li>ddl.append(&quot;, &quot;);  </li>
<li>}  </li>
<li>ddl.append(&quot;F&quot; + i);  </li>
<li>}  </li>
<li>ddl.append(&quot;) VALUES (&quot;);  </li>
<li>for (int i = 0; i &lt; COUNT; ++i) {  </li>
<li>if (i != 0) {  </li>
<li>ddl.append(&quot;, &quot;);  </li>
<li>}  </li>
<li>ddl.append(&quot;?&quot;);  </li>
<li>}  </li>
<li>ddl.append(&quot;)&quot;);  </li>
<li></li>
<li>Connection conn = dataSource.getConnection();  </li>
<li></li>
<li>//        System.out.println(ddl.toString());  </li>
<li></li>
<li>PreparedStatement stmt = conn.prepareStatement(ddl.toString());  </li>
<li></li>
<li>for (int i = 0; i &lt; COUNT; ++i) {  </li>
<li>stmt.setInt(i + 1, i);  </li>
<li>}  </li>
<li>stmt.execute();  </li>
<li>stmt.close();  </li>
<li></li>
<li>conn.close();  </li>
<li>}  </li>
<li></li>
<li>private void dropTable() throws SQLException {  </li>
<li></li>
<li>Connection conn = dataSource.getConnection();  </li>
<li></li>
<li>Statement stmt = conn.createStatement();  </li>
<li>stmt.execute(&quot;DROP TABLE t_big&quot;);  </li>
<li>stmt.close();  </li>
<li></li>
<li>conn.close();  </li>
<li>}  </li>
<li></li>
<li>public void createTable() throws SQLException {  </li>
<li>StringBuffer ddl = new StringBuffer();  </li>
<li>ddl.append(&quot;CREATE TABLE t_big (FID INT AUTO_INCREMENT PRIMARY KEY &quot;);  </li>
<li>for (int i = 0; i &lt; COUNT; ++i) {  </li>
<li>ddl.append(&quot;, &quot;);  </li>
<li>ddl.append(&quot;F&quot; + i);  </li>
<li>ddl.append(&quot; BIGINT NULL&quot;);  </li>
<li>}  </li>
<li>ddl.append(&quot;)&quot;);  </li>
<li></li>
<li>Connection conn = dataSource.getConnection();  </li>
<li></li>
<li>Statement stmt = conn.createStatement();  </li>
<li>stmt.execute(ddl.toString());  </li>
<li>stmt.close();  </li>
<li></li>
<li>conn.close();  </li>
<li>}  </li>
<li>}  </li>
</ol>
<p><strong>代码片段2.1</strong></p>
<p><strong>注意：在使用的时候，通过获取完Connection对象，在使用完之后，要将其close掉，这样其实是将用完的连接放入到连接池中，如果你不close的话，会造成连接泄露。</strong>
然后我们写一个servlet来测试他.</p>
<p><strong>[java]</strong> <a href="http://blog.csdn.net/yunnysunny/article/details/8657095#" title="view plain" target="_blank">view plain</a><a href="http://blog.csdn.net/yunnysunny/article/details/8657095#" title="copy" target="_blank">copy</a></p>
<ol>
<li>package com.whyun.druid.servelt;  </li>
<li></li>
<li>import java.io.IOException;  </li>
<li>import java.io.PrintWriter;  </li>
<li>import java.sql.SQLException;  </li>
<li></li>
<li>import javax.servlet.ServletContext;  </li>
<li>import javax.servlet.ServletException;  </li>
<li>import javax.servlet.http.HttpServlet;  </li>
<li>import javax.servlet.http.HttpServletRequest;  </li>
<li>import javax.servlet.http.HttpServletResponse;  </li>
<li></li>
<li>import org.springframework.web.context.WebApplicationContext;  </li>
<li>import org.springframework.web.context.support.WebApplicationContextUtils;  </li>
<li></li>
<li>import com.whyun.druid.model.TableOperator;  </li>
<li></li>
<li>public class TestServlet extends HttpServlet {  </li>
<li>private TableOperator operator;  </li>
<li></li>
<li></li>
<li>@Override  </li>
<li>public void init() throws ServletException {  </li>
<li></li>
<li>super.init();  </li>
<li>ServletContext servletContext = this.getServletContext();     </li>
<li></li>
<li>WebApplicationContext ctx  </li>
<li>= WebApplicationContextUtils.getWebApplicationContext(servletContext);  </li>
<li>operator = (TableOperator)ctx.getBean(&quot;SpringTableOperatorBean&quot;);  </li>
<li>}  </li>
<li></li>
<li>//<em>/</em> </li>
<li>/* The doGet method of the servlet. <br> </li>
<li>/* </li>
<li>/* This method is called when a form has its tag value method equals to get. </li>
<li>/*  </li>
<li>/* @param request the request send by the client to the server </li>
<li>/* @param response the response send by the server to the client </li>
<li>/* @throws ServletException if an error occurred </li>
<li>/* @throws IOException if an error occurred </li>
<li>/*/  </li>
<li>public void doGet(HttpServletRequest request, HttpServletResponse response)  </li>
<li>throws ServletException, IOException {  </li>
<li></li>
<li>response.setContentType(&quot;text/html&quot;);  </li>
<li>PrintWriter out = response.getWriter();  </li>
<li></li>
<li>boolean createResult = false;  </li>
<li>boolean insertResult = false;  </li>
<li>boolean dropResult = false;  </li>
<li></li>
<li>try {  </li>
<li>operator.createTable();  </li>
<li>createResult = true;  </li>
<li>} catch (SQLException e) {  </li>
<li>e.printStackTrace();  </li>
<li>}  </li>
<li>if (createResult) {  </li>
<li>try {  </li>
<li>operator.insert();  </li>
<li>insertResult = true;  </li>
<li>} catch (Exception e) {  </li>
<li>e.printStackTrace();  </li>
<li>}  </li>
<li>try {  </li>
<li>operator.tearDown();  </li>
<li>dropResult = true;  </li>
<li>} catch (Exception e) {  </li>
<li>e.printStackTrace();  </li>
<li>}  </li>
<li>}  </li>
<li></li>
<li></li>
<li>out.println(&quot;{&#39;createResult&#39;:&quot;+createResult+&quot;,&#39;insertResult&#39;:&quot;  </li>
<li>+insertResult+&quot;,&#39;dropResult&#39;:&quot;+dropResult+&quot;}&quot;);  </li>
<li></li>
<li>out.flush();  </li>
<li>out.close();  </li>
<li>}  </li>
<li></li>
<li>}<br><strong>代码片段2.2</strong></li>
</ol>
<p>这里没有用到struts2或者springmvc，虽然大部分开发者用的是这两种框架。</p>
<h3 id="-2-2-spring"><a href=""></a>2.2 不使用spring</h3>
<p>类似于dbcp，druid也提供了原生态的支持。先看下面这段代码：</p>
<p><strong>[java]</strong> <a href="http://blog.csdn.net/yunnysunny/article/details/8657095#" title="view plain" target="_blank">view plain</a><a href="http://blog.csdn.net/yunnysunny/article/details/8657095#" title="copy" target="_blank">copy</a></p>
<ol>
<li>package com.whyun.util.db;  </li>
<li></li>
<li>import javax.sql.DataSource;  </li>
<li></li>
<li>import org.apache.commons.dbcp.BasicDataSourceFactory;  </li>
<li></li>
<li>import com.alibaba.druid.pool.DruidDataSourceFactory;  </li>
<li>import com.whyun.util.config.MySqlConfigProperty;  </li>
<li>import com.whyun.util.config.MySqlConfigProperty2;  </li>
<li></li>
<li>//<em>/</em> </li>
<li>/* The Class DataSourceUtil. </li>
<li>/*/  </li>
<li>public class DataSourceUtil {  </li>
<li></li>
<li>//<em>/</em> 使用配置文件dbconfig.properties构建Druid数据源. /*/  </li>
<li>public static final int DRUID_MYSQL_SOURCE = 0;  </li>
<li></li>
<li>//<em>/</em> 使用配置文件dbconfig2.properties构建Druid数据源. /*/  </li>
<li>public static final int DRUID_MYSQL_SOURCE2 = 1;  </li>
<li></li>
<li>//<em>/</em> 使用配置文件dbconfig.properties构建Dbcp数据源. /*/  </li>
<li>public static final int DBCP_SOURCE = 4;  </li>
<li></li>
<li>//<em>/</em> </li>
<li>/* 根据类型获取数据源 </li>
<li>/* </li>
<li>/* @param sourceType 数据源类型 </li>
<li>/* @return druid或者dbcp数据源 </li>
<li>/* @throws Exception the exception </li>
<li>/*/  </li>
<li>public static final DataSource getDataSource(int sourceType)  </li>
<li>throws Exception {  </li>
<li>DataSource dataSource = null;  </li>
<li>switch(sourceType) {  </li>
<li>case DRUID_MYSQL_SOURCE:              </li>
<li>dataSource = DruidDataSourceFactory.createDataSource(  </li>
<li>MySqlConfigProperty.getInstance().getProperties());               </li>
<li>break;  </li>
<li>case DRUID_MYSQL_SOURCE2:  </li>
<li>dataSource = DruidDataSourceFactory.createDataSource(  </li>
<li>MySqlConfigProperty2.getInstance().getProperties());  </li>
<li>break;  </li>
<li>case DBCP_SOURCE:  </li>
<li>dataSource = BasicDataSourceFactory.createDataSource(  </li>
<li>MySqlConfigProperty.getInstance().getProperties());  </li>
<li>break;  </li>
<li>}  </li>
<li>return dataSource;  </li>
<li>}  </li>
<li>}  </li>
</ol>
<p><strong>代码片段2.3 手动读取配置文件初始化连接池</strong></p>
<p>第37行中调用了类com.alibaba.druid.pool.DruidDataSourceFactory中createDataSource方法来初始化一个连接池。对比dbcp的使用方法，两者很相似。</p>
<p>下面给出一个多线程的测试程序。运行后可以比较druid和dbcp的性能差别。</p>
<p><strong>[java]</strong> <a href="http://blog.csdn.net/yunnysunny/article/details/8657095#" title="view plain" target="_blank">view plain</a><a href="http://blog.csdn.net/yunnysunny/article/details/8657095#" title="copy" target="_blank">copy</a></p>
<ol>
<li>package com.whyun.druid.test;  </li>
<li></li>
<li>import java.sql.SQLException;  </li>
<li>import java.util.ArrayList;  </li>
<li>import java.util.List;  </li>
<li>import java.util.concurrent.Callable;  </li>
<li>import java.util.concurrent.ExecutorService;  </li>
<li>import java.util.concurrent.Executors;  </li>
<li>import java.util.concurrent.Future;  </li>
<li>import java.util.concurrent.TimeUnit;  </li>
<li></li>
<li>import com.whyun.druid.model.TableOperator;  </li>
<li>import com.whyun.util.db.DataSourceUtil;  </li>
<li></li>
<li>public class MutilThreadTest {  </li>
<li>public static void test(int dbType, int times)  </li>
<li>throws Exception {   </li>
<li>int numOfThreads =Runtime.getRuntime().availableProcessors()/*2;  </li>
<li>ExecutorService executor = Executors.newFixedThreadPool(numOfThreads);    </li>
<li>final TableOperator test = new TableOperator();  </li>
<li>//        int dbType = DataSourceUtil.DRUID_MYSQL_SOURCE;  </li>
<li>//        dbType = DataSourceUtil.DBCP_SOURCE;  </li>
<li>test.setDataSource(DataSourceUtil.getDataSource(dbType));  </li>
<li></li>
<li>boolean createResult = false;  </li>
<li>try {  </li>
<li>test.createTable();  </li>
<li>createResult = true;  </li>
<li>} catch (SQLException e) {  </li>
<li>e.printStackTrace();  </li>
<li>}  </li>
<li>if (createResult) {  </li>
<li>List<Future<Long>&gt; results = new ArrayList<Future<Long>&gt;();     </li>
<li>for (int i = 0; i &lt; times; i++) {    </li>
<li>results.add(executor.submit(new Callable<Long>() {    </li>
<li>@Override    </li>
<li>public Long call() throws Exception {    </li>
<li>long begin = System.currentTimeMillis();  </li>
<li>try {  </li>
<li>test.insert();  </li>
<li>//insertResult = true;  </li>
<li>} catch (Exception e) {  </li>
<li>e.printStackTrace();  </li>
<li>}                             </li>
<li>long end = System.currentTimeMillis();    </li>
<li>return end - begin;    </li>
<li>}    </li>
<li>}));    </li>
<li>}    </li>
<li>executor.shutdown();    </li>
<li>while(!executor.awaitTermination(Long.MAX_VALUE, TimeUnit.DAYS));    </li>
<li></li>
<li>long sum = 0;    </li>
<li>for (Future<Long> result : results) {    </li>
<li>sum += result.get();    </li>
<li>}    </li>
<li></li>
<li></li>
<li>System.out.println(&quot;---------------db type &quot;+dbType+&quot;------------------&quot;);    </li>
<li>System.out.println(&quot;number of threads :&quot; + numOfThreads + &quot; times:&quot; + times);    </li>
<li>System.out.println(&quot;running time: &quot; + sum + &quot;ms&quot;);    </li>
<li>System.out.println(&quot;TPS: &quot; + (double)(100000 /* 1000) / (double)(sum));    </li>
<li>System.out.println();    </li>
<li>try {  </li>
<li>test.tearDown();  </li>
<li>//dropResult = true;  </li>
<li>} catch (Exception e) {  </li>
<li>e.printStackTrace();  </li>
<li>}  </li>
<li>} else {  </li>
<li>System.out.println(&quot;初始化数据库失败&quot;);  </li>
<li>}  </li>
<li></li>
<li>}    </li>
<li></li>
<li>public static void main (String argc[])  </li>
<li>throws Exception {  </li>
<li>test(DataSourceUtil.DBCP_SOURCE,50);  </li>
<li>test(DataSourceUtil.DRUID_MYSQL_SOURCE,50);  </li>
<li></li>
<li>}  </li>
<li>}  </li>
</ol>
<p><strong>代码片段2.4 连接池多线程测试程序</strong></p>
<hr>
<h2 id="-3-"><a href=""></a><strong>3 监控</strong></h2>
<h3 id="-3-1-web-"><a href=""></a><strong>3.1 web监控</strong></h3>
<p>druid提供了sql语句查询时间等信息的监控功能。为了让数据库查询一直运行，下面特地写了一个ajax进行轮询。同时，还要保证在web.xml中配置如下信息</p>
<p><strong>[html]</strong> <a href="http://blog.csdn.net/yunnysunny/article/details/8657095#" title="view plain" target="_blank">view plain</a><a href="http://blog.csdn.net/yunnysunny/article/details/8657095#" title="copy" target="_blank">copy</a></p>
<ol>
<li><servlet>  </li>
<li><servlet-name>DruidStatView</servlet-name>  </li>
<li><servlet-class>com.alibaba.druid.support.http.StatViewServlet</servlet-class>  </li>
<li></servlet>  </li>
<li><servlet-mapping>  </li>
<li><servlet-name>DruidStatView</servlet-name>  </li>
<li><url-pattern>/druid//*</url-pattern>  </li>
<li></servlet-mapping><br><strong>配置文件3.1 在web.xml中添加druid监控</strong></li>
</ol>
<p><em>**</em>同时将ajax代码提供如下</p>
<p><strong>[javascript]</strong> <a href="http://blog.csdn.net/yunnysunny/article/details/8657095#" title="view plain" target="_blank">view plain</a><a href="http://blog.csdn.net/yunnysunny/article/details/8657095#" title="copy" target="_blank">copy</a></p>
<ol>
<li>function showTime() {  </li>
<li>var myDate = new Date();  </li>
<li>var timeStr = &#39;&#39;;  </li>
<li>timeStr += myDate.getFullYear()+&#39;-&#39;; //获取完整的年份(4位,1970-????)  </li>
<li>timeStr += myDate.getMonth()+&#39;-&#39;;      //获取当前月份(0-11,0代表1月)  </li>
<li>timeStr += myDate.getDate() + &#39; &#39;;      //获取当前日(1-31)  </li>
<li>timeStr += myDate.getHours()+&#39;:&#39;;      //获取当前小时数(0-23)  </li>
<li>timeStr += myDate.getMinutes()+&#39;:&#39;;    //获取当前分钟数(0-59)  </li>
<li>timeStr += myDate.getSeconds();    //获取当前秒数(0-59)  </li>
<li>return timeStr  </li>
<li>}  </li>
<li>$(document).ready(function() {  </li>
<li>function loadDBTestMessage() {  </li>
<li>$.get(&#39;servlet/MysqlTestServlet&#39;,function(data) {  </li>
<li>if (typeof(data) != &#39;object&#39;) {  </li>
<li>data = eval(&#39;(&#39; + data + &#39;)&#39;);  </li>
<li>}  </li>
<li>var html = &#39;[&#39;+showTime()+&#39;]&#39;;  </li>
<li>html += &#39;创建：&#39; + data[&#39;createResult&#39;];  </li>
<li>html +=  &#39;插入：&#39; + data[&#39;insertResult&#39;];  </li>
<li>html += &#39;销毁:&#39; + data[&#39;dropResult&#39;];  </li>
<li>html +=   </li>
<li>$(&#39;/#message&#39;).html(html);  </li>
<li>});  </li>
<li>}  </li>
<li></li>
<li>setInterval(function() {  </li>
<li>loadDBTestMessage();  </li>
<li>}, 10000);  </li>
<li>});<br><strong>代码片段3.1 ajax轮询</strong></li>
</ol>
<p>这时打开<a href="http://localhost/druid-web/druid/" target="_blank">http://localhost/druid-web/druid/</a> 地址，会看到监控界面，点击其中的sql标签。</p>
<p><img src="" alt=""></p>
<p><strong>图3.1 监控界面查看sql查询时间</strong></p>
<p><strong>注意：在写配置文件1.1时，要保证filter配置项中含有stat属性，否则这个地方看不到sql语句的监控数据。</strong></p>
<p>表格中各项含义如下</p>
<hr>
<p>名称</p>
<p>解释</p>
<p>备注 ExecuteCount</p>
<p>当前sql已执行次数 ExecTime</p>
<p>当前sql已执行时间 ExecMax</p>
<p>当前sql最大执行时间 Txn</p>
<p>当前运行的事务数量 Error</p>
<p>当前sql执行出错的数目 Update</p>
<p>当前sql更新或者删除操作中已经影响的行数 FetchRow</p>
<p>当前sql操作中已经读取的行数 Running</p>
<p>当前sql正在运行的数目 Concurrent</p>
<p>当前sql最大并发执行数  ExecHisto </p>
<p>当前sql做execute操作的时间分布数组</p>
<p>分为0-1,1-10,10-100,100-1000，&gt;1000，5个时间分布区域，单位为ms ExecRsHisto </p>
<p>当前sql做execute操作和resultSet</p>
<p>打开至关闭的时间总和分布数组</p>
<p>同上 FetchRowHisto</p>
<p>当前sql查询时间分布数组</p>
<p>同上 UpdateHisto </p>
<p>当前sql更新、删除时间分布数组</p>
<p>同上表3.1 监控字段含义</p>
<p>老版本的druid的jar包中不支持通过web界面进行远程监控，从0.2.14开始可以通过配置jmx地址来获取远程运行druid的服务器的监控信息。具体配置方法如下：</p>
<p><strong>[html]</strong> <a href="http://blog.csdn.net/yunnysunny/article/details/8657095#" title="view plain" target="_blank">view plain</a><a href="http://blog.csdn.net/yunnysunny/article/details/8657095#" title="copy" target="_blank">copy</a></p>
<ol>
<li><servlet>  </li>
<li><servlet-name>DruidStatView</servlet-name>  </li>
<li><servlet-class>com.alibaba.druid.support.http.StatViewServlet</servlet-class>  </li>
<li><init-param>  </li>
<li><param-name>jmxUrl</param-name>  </li>
<li><param-value>service:jmx:rmi:///jndi/rmi://localhost:9004/jmxrmi</param-value>  </li>
<li></init-param>  </li>
<li></servlet>  </li>
<li><servlet-mapping>  </li>
<li><servlet-name>DruidStatView</servlet-name>  </li>
<li><url-pattern>/druid//*</url-pattern>  </li>
<li></servlet-mapping><br>配置文件3.2 远程监控web</li>
</ol>
<p>这里连接的配置参数中多了一个jmxUrl，里面配置一个jmx连接地址。jmx连接中也可以指定用户名、密码，在上面的servlet中添加两个init-param，其param-name分别为jmxUsername和jmxPassword，分别对应连接jmx的用户名和密码。对于jmx在服务器端的配置，可以参考3.2节中的介绍。</p>
<h3 id="-3-2-jconsole-"><a href=""></a><strong>3.2 jconsole监控</strong></h3>
<p>同时druid提供了jconsole监控的功能，因为界面做的不是很好，所以官方中没有对其的相关介绍。如果是纯java程序的话，上面提到的web监控就无法使用了，jconsole的作用就体现出来了。不过我在下面做教程的时候，依然使用的是刚才用的web项目。</p>
<p>首先在catalina.bat（或者catalina.sh）中加入java的启动选项，放置于if &quot;%OS%&quot; == &quot;Windows_NT&quot; setlocal这句之后。</p>
<p>set JAVA_OPTS=%JAVA_OPTS% -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=&quot;9004&quot; -Dcom.sun.management.jmxremote.authenticate=&quot;false&quot; -Dcom.sun.management.jmxremote.ssl=&quot;false&quot;</p>
<p>保存完之后，启动startup.bat(或者startup.sh)来运行tomcat（上面设置java启动项的配置，按理来说在eclipse中也能适用，但是笔者在其下没有试验成功）。然后在远程的某台电脑的命令行中运行如下命令</p>
<p>jconsole -pluginpath E:\kuaipan\workspace6\druid-web\WebRoot\WEB-INF\lib\druid-0.2.11.jar</p>
<p>这里的最后一个参数就是你的druid的jar包的路径。</p>
<p><img src="" alt=""></p>
<p><strong>图3.2 jconsole连接界面</strong></p>
<p>在远程进程的输入框里面输入ip:端口号，然后点击连接（上面的配置中没有指定用户名、密码，所以这里不用填写）。打开的界面如下：</p>
<p><img src="" alt=""></p>
<p><strong>图3.3 jconsole 连接成功界面</strong></p>
<p>可以看到和web监控界面类似的数据了。
来源： <a href="[http://blog.csdn.net/yunnysunny/article/details/8657095](http://blog.csdn.net/yunnysunny/article/details/8657095)">[http://blog.csdn.net/yunnysunny/article/details/8657095](http://blog.csdn.net/yunnysunny/article/details/8657095)</a> </p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/连接池/">连接池</a></li></span></span> | <span class="tags">Tagged <a href="/tags/连接池/" class="label label-primary">连接池</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:43"datetime="2014-03-07 09:54:43"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-连接池--druid教程/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-连接池--druid教程" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-代理--Sundy-shome_张凌华-ConfuciusIcan-tchoosethe/">Sundy</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:43.000Z"> <a href="/2014/02/02/2014-02-02-代理--Sundy-shome_张凌华-ConfuciusIcan-tchoosethe/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-goagent-gae-http-mobidever-com-post-2011-08-goagente58f88e4b880e4b8aae59fbae4ba8egaee79a84e7a9bfe8b68ae588a9e599a8-aspx-"><a href="http://mobidever.com/post/2011/08/GOAGENTe58f88e4b880e4b8aae59fbae4ba8eGAEe79a84e7a9bfe8b68ae588a9e599a8.aspx" target="_blank">GOAGENT又一个基于GAE的穿越利器</a></h1>
<p>by <a href="http://mobidever.com/author/sundy.aspx" target="_blank">sundy</a> 8/16/2011 7:26:00 AM</p>
<h3 id="goagent-python-google-appengine-sdk-python-google-appenginge-sdk-">GoAgent是 一个使用Python和Google Appengine SDK编写的代理软件。部署和使用方法非常简单，不需要安装Python或者Google Appenginge SDK ，几分钟即可搞定。</h3>
<h3 id="-">具体步骤如下：</h3>
<h3 id="goagent-">GoAgent『申请与创建』</h3>
<p>首先申请<a href="https://www.google.com/accounts/Login?hl=zh-CN" target="_blank"> </a>注册一个<strong>Google App Engine</strong>账号（<a href="http://appengine.google.com/" target="_blank"><strong>点此注册</strong></a>）。没有<strong>Gmail</strong>账号先注册一个， 用你的<strong>Gmaill</strong>账号登录。</p>
<p>过程详解如下：<strong>下图：</strong></p>
<p><img src="" alt=""></p>
<p>登录之后，自动转向<strong>Application</strong>注册页面，如<strong>下图</strong>：</p>
<p><img src="" alt=""></p>
<p>接下来的页面，<strong>输入你的手机号码</strong>，<strong>如下图：</strong></p>
<p><img src="" alt=""></p>
<p>需要注意的是，<strong>手机号码前面要+86 </strong>格式如：<strong>+86 13888888888</strong>。然后等待收取手机短信，收到短信后（一串数字号码）填入下图表单，点<strong>send</strong>提交.</p>
<p><img src="" alt=""></p>
<p>提交完成之后，<strong>GAE</strong>账号即被激活，然后就可以创建新的应用程序了。转入<strong>“My Applications”</strong>页面，点击<strong>“Create an Application”</strong>新建应用，如<strong>下图</strong>：</p>
<p><img src="" alt=""></p>
<p>一个<strong>Gmail</strong>账户最多可以创建十个<strong>GAE</strong>应用。这里我们只创建一个应用就可以了。进入下一步，填写新应用的必要信息，<strong>如下图</strong>：</p>
<p><img src="" alt=""></p>
<p>在上图中<strong>第一处添加一个应用名称</strong>，如<strong>abc555</strong>验证一下是否可用，如果通过那么<strong>abc555</strong>就是你的<strong>Appid</strong>（记住这个<strong>id</strong>），而abc555 .appspoft.com就是你的应用服务器地址了。<strong>第二个空可随便填</strong>，点击提交按钮，如果能看到下图这个页面，就说明你成功创建了一个新的应用,你也可以点击应用名称，进入控制面板进行管理。</p>
<p><img src="" alt=""></p>
<h3 id="goagent-">GoAgent『部署和使用』</h3>
<h3 id="1-google-appengine-appid">1.申请Google Appengine并创建appid</h3>
<p>2.下载GoAgent  <a href="https://github.com/phus/goagent/zipball/master" target="_blank"><a href="https://github.com/phus/goagent/zipball/master">https://github.com/phus/goagent/zipball/master</a></a> （新版）
3.双击server\upload.bat,输入你的appid和你的Gmail帐号和密码，就会自动上传到服务端
4.把local\proxy.ini中的your_appid 改成你申请到的appid
5.设置浏览器代理为127.0.0.1：8087
6.运行taskbar.exe  好了，现在你可以穿墙了。</p>
<p><img src="" alt=""></p>
<p><strong>上图为第3 步截图</strong>。（输入AppID按回车，再输入gmail帐号按回车，输入密码后再按回车键（注：输入密码时不会显示）就开始自动上传了，多等一会，上传完毕后黑窗口会自动关.</p>
<p><img src="" alt=""></p>
<p><img src="" alt=""></p>
<p><strong>上图为第4步的截图。</strong>把<strong>local\proxy.ini</strong>中的<strong>your_appid</strong> 改成你申请到的<strong>appid</strong> (用windows的记事本也可以）</p>
<p><img src="" alt=""></p>
<p>你也可登录你的GAE账户，在后台管理查看<strong>（上图）</strong></p>
<p><strong>笔者建议用Firefox浏览器，再安装一个Autoproxy 插件，可以在是否使用代理选择上非常方便地切换。安装插件<a href="https://addons.mozilla.org/zh-CN/firefox/addon/autoproxy/" target="_blank"><a href="https://addons.mozilla.org/zh-CN/firefox/addon/autoproxy/">https://addons.mozilla.org/zh-CN/firefox/addon/autoproxy/</a></a> 安装后，因autoproxy插件里没有goagent代理选项，须自建一个，步骤如下：
重启浏览器后，点击浏览器上方的/工具/autoproxy/代理服务器/编辑代理服务器/添加代理/然后新建一个“名称goagent  主机127.0.0.1  端口8087/确定”，然后选择代理服务器/goagent/确定。（下图）</strong></p>
<p><img src="" alt=""></p>
<p><img src="" alt=""></p>
<p><strong>运行taskbar.exe （下图）</strong></p>
<p><img src="" alt=""></p>
<p><strong>启动Firefox浏览器，（autoproxy插件安装后，在浏览器的右上角或右下角有一个“福”字，点击这个字，绿色为全局代理，红色为自动判别模式）。点击<a href="http://www.ip-adress.com/ip_tracer/" target="_blank"><a href="http://www.ip-adress.com/ip_tracer/">http://www.ip-adress.com/ip_tracer/</a></a>，全局模式下看到下图，穿越成功。</strong></p>
<p><img src="" alt=""></p>
<p>GoAgent 现在越来越简单了，太容易搭建了，且速度飞快。（不建议用<strong>IE</strong>浏览器，在<strong>Chrome**</strong>和Firefox<strong>下没有任何问题，但用</strong>IE**时常常翻不出去。）Goagent 打开SSL连接的网站，如果浏览器弹出证书无效警告，可以用这样的方法解决:导入证书：在local文件夹下的ssl文件夹有一个ca.crt证书文件；/# Firefox依次操作：“首选项-&gt;高级-&gt;加密-&gt;查看证书-&gt;证书机构-&gt;导入-&gt;选择 local-&gt;sll-&gt;ca.crt 文件–&gt;确定”，即可导入成功。（Chrome下直接双击ca.crt安装证书）
Currently rated 2.6 by 517 people</p>
<ul>
<li>Currently 2.601584/5 Stars.</li>
<li><a href="&quot;Rate this 1 star out of 5&quot;">1</a></li>
<li><a href="&quot;Rate this 2 stars out of 5&quot;">2</a></li>
<li><a href="&quot;Rate this 3 stars out of 5&quot;">3</a></li>
<li><a href="&quot;Rate this 4 stars out of 5&quot;">4</a></li>
<li><a href="&quot;Rate this 5 stars out of 5&quot;">5</a></li>
</ul>
<p>Tags:</p>
<p><a href="http://mobidever.com/category/Internet-Communion.aspx" target="_blank">Internet Communion</a> | <a href="http://mobidever.com/category/Mobile-amp3b-Wireless.aspx" target="_blank">Mobile &amp; Wireless</a></p>
<p><a href="mailto:?subject=GOAGENT又一个基于GAE的穿越利器&amp;body=Thought you might like this: http://www.lhzhang.org/post/2011/08/GOAGENTe58f88e4b880e4b8aae59fbae4ba8eGAEe79a84e7a9bfe8b68ae588a9e599a8.aspx">E-mail</a> | <a href="http://www.dotnetkicks.com/submit?url=http%3a%2f%2fwww.lhzhang.org%2fpost%2f2011%2f08%2fGOAGENTe58f88e4b880e4b8aae59fbae4ba8eGAEe79a84e7a9bfe8b68ae588a9e599a8.aspx&amp;title=GOAGENT%e5%8f%88%e4%b8%80%e4%b8%aa%e5%9f%ba%e4%ba%8eGAE%e7%9a%84%e7%a9%bf%e8%b6%8a%e5%88%a9%e5%99%a8" target="_blank">Kick it!</a> | <a href="http://www.dzone.com/links/add.html?url=http%3a%2f%2fwww.lhzhang.org%2fpost%2f2011%2f08%2fGOAGENTe58f88e4b880e4b8aae59fbae4ba8eGAEe79a84e7a9bfe8b68ae588a9e599a8.aspx&amp;title=GOAGENT%e5%8f%88%e4%b8%80%e4%b8%aa%e5%9f%ba%e4%ba%8eGAE%e7%9a%84%e7%a9%bf%e8%b6%8a%e5%88%a9%e5%99%a8" target="_blank">DZone it!</a> | <a href="http://del.icio.us/post?url=http%3a%2f%2fwww.lhzhang.org%2fpost%2f2011%2f08%2fGOAGENTe58f88e4b880e4b8aae59fbae4ba8eGAEe79a84e7a9bfe8b68ae588a9e599a8.aspx&amp;title=GOAGENT%e5%8f%88%e4%b8%80%e4%b8%aa%e5%9f%ba%e4%ba%8eGAE%e7%9a%84%e7%a9%bf%e8%b6%8a%e5%88%a9%e5%99%a8" target="_blank">del.icio.us</a><a href="http://www.lhzhang.org/post.aspx?id=b3c84fae-92d8-4ab6-9a11-6e674e7c0359" target="_blank">Permalink</a> | <a href="http://mobidever.com/post/2011/08/GOAGENTe58f88e4b880e4b8aae59fbae4ba8eGAEe79a84e7a9bfe8b68ae588a9e599a8.aspx#comment" target="_blank">Comments (0)</a> | <a href="http://mobidever.com/syndication.axd?post=b3c84fae-92d8-4ab6-9a11-6e674e7c0359" target="_blank">Post RSS<img src="" alt="RSS comment feed"></a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/代理/">代理</a></li></span></span> | <span class="tags">Tagged <a href="/tags/代理/" class="label label-primary">代理</a></span> | <span class="time">recent updated:<time title="2014-03-26 21:07:46"datetime="2014-03-26 21:07:46"> mar. 26 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-代理--Sundy-shome_张凌华-ConfuciusIcan-tchoosethe/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-代理--Sundy-shome_张凌华-ConfuciusIcan-tchoosethe" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-敏捷开发--结对编程（Pairprogramming）/">结对编程（Pair programming）</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:43.000Z"> <a href="/2014/02/02/2014-02-02-敏捷开发--结对编程（Pairprogramming）/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-pair-programming-">结对编程（Pair programming）</h1>
<p>在敏捷软件开发的各种实践中，结对编程（Pair Programming，下文简称Pair）是特别有争议的。Pair有一个特点，那就是还没有进行过任何Pair实践前，你很可能对它已经有了“喜欢” 或者是“讨厌”的印象。如果有人问你，你喜欢持续集成吗？你多半会回答：不是很肯定，需要试试看。但如果有人问你，你喜欢Pair吗？我猜你会马上给予明 确的肯定或否定的回答。喜欢它的人会觉得好处多多而成本低低，不喜欢它的人会觉得讨厌得难以想象。喜欢与不喜欢都可以形成强大的阵营，两边都不乏重量级的 高手。Pair的优点说起来都很明显，比如：快速反馈，更好的设计，甚至更高的效率等等。但据我了解，不喜欢Pair的人基本上都承认Pair有优点，只 是他们通常会提出反对意见，比如：Pair要求两个人协调一致，每个人的作息时间需要同步，如果一个人请假，那另一个人怎么办？等待就太浪费时间了，如果 自己一个人做那就不是Pair了；或者也有很多人感觉到Pair的时候特别累，不像一个人工作那样自主，写一小时程序，上十分钟微博，两个人同一台电脑工 作自由就小多了。</p>
<p>我所在的公司是Pair的实践者，对于喜欢Pair或者不喜欢Pair的各种原因和心态我都有切身的体 会。在实践中，我们并没有完全一成不变地照搬Kent Beck在《Extreme Programming Explained》书中所定义的Pair模式（Driver Observer模式）。因为，Pair毕竟是一种实践方法，可以供我们在软件开发中参考，而不必像对待科学理论一样教条。另外，我认为要让这种实践方法 发挥它的威力，消除人们心中的讨厌甚至是恐惧情绪是首先要解决的问题，甚至我们可以为此修改一些Pair的传统做法。下面我先来大致描述一下我们的实践模 式（<strong>Owner Supporter模式</strong>）：</p>
<p><strong>&lt;阶段1-Pair形成&gt;</strong></p>
<p>Team 在接到一个大的Story后经过讨论并分解任务形成一个个粒度适中的Task。Task的粒度一般在几小时到一两天这种级别，涉及的代码规模大约是几行到 几个类/函数。每一个Task，都有一个Owner作为责任人，这是和传统单兵开发模式相同的。不过，Owner的产生一般不是由ScrumMaster 来分配指定，而是Team成员自发地去协商选择适当的任务。Owner拿到Task以后会从Team中找一个Supporter，形成Pair。这也是一 个自发协商过程，没有强制指定，也没有固定的搭档，这样形成的Pair一般会是配合最默契也最适合相应Task的。</p>
<p><strong>&lt;阶段2-初始讨论&gt;</strong></p>
<p>Pair 形成以后， 一般是由Owner先分析需求，设计测试，并初步分析思考得出初步的设计思路。这时，Supporter可以暂时先不了解需求。然后Owner邀请 Supporter一起，向Supporter介绍需求和自己的设计思路。Supporter这时需要帮助Owner理解需求，设计测试，对设计方案提出 反馈意见，或者提出新的设计。讨论的理想结果是两人达成一致形成最终的设计方案，如果两人分歧严重不能达成一致则需要更多的人参与，比如：可以举行一个小 型的技术讨论会议把讨论扩大到整个Team。</p>
<p><strong>&lt;阶段3-具体实现&gt;</strong></p>
<p>这一阶段是根据讨论得出的设计方案开始编程实现。在经典Pair Programming中，两个人是在同一台电脑前一起工作，并不时地交换；但我们的实践发现这一点是特别容易让人疲倦，感觉不自在，从而抵触Pair的 最大因素。所以，我们在实践过程中，除了少数情况，基本上没有采用全程Pair工作，而是由Owner一个人完成。当然，如果Owner遇到了一些设计中 考虑不完善的地方，他可以随时再和Supporter讨论。</p>
<p><strong>&lt;阶段4-Review&gt;</strong></p>
<p>具 体实现完成以后，Owner又会邀请Supporter来review自己的工作。这个过程一般是借助版本控制工具对比代码改动，Supporter从实 现的角度来审查实现是否符合设计，有没有可以直接观察到的bug和潜在的问题。如果发现问题并讨论确认，Owner再做相应的改动，再Review。最终 Supporter不能review出问题了，Owner提交代码。</p>
<p><strong>&lt;阶段5-维护&gt;</strong></p>
<p>虽 然经过了讨论和review， 但在后续的测试或者上线后仍然会陆续发现问题，这时就涉及到维护工作。维护工作依然是由Owner牵头，分析log，看代码，重现，修正；但 是，Owner也可以随时邀请Supporter参与分析讨论，至少在Owner准备修改原先的代码时应该要告诉Supporter“原先我们某个地方没 有考虑周全，有什么什么问题，我打算怎么怎么改动”。这个过程好像又回到了阶段2，然后阶段3，阶段4 ... 开发中还有一种可能是，原先的Supporter或Owner已经不在Team内了，这时就需要加入一个新人形成Pair，有经验的人应该向自己的新搭档 介绍Task的相关背景。当然，还很有可能碰到根本没有熟悉该模块的人了，这时就必须形成一个新的Pair，把维护作为一项新Task。</p>
<p>上面基本上就是我们的Pair实践模式了。这种模式基本上还是保留了大部分经典Pair模式的要点，主要的区别在于：</p>
<p><strong>1. 把Pair的形成纳入Scrum框架的任务划分过程。</strong>Scrum通常会在Sprint的计划会议中将大的User Story拆分成许多小的Task，每个Task一般对应几小时到一两天的工作量。Task列表出来以后，Team自发协商每个Task形成一个 Pair，整个过程一般没有管理者的直接干预。Story的背景需要Team中的每个人都了解，Task的细节由Pair负责。Pair的效果通常也依赖 于Task的合理划分。</p>
<p><strong>2. 避免全程Pair。</strong>因为，全程Pair在实践和心理上会遇到很多问题，比如：时间同步问题，并行工作问题，不自在感问题。避免全程Pair可以使得 Owner和Supporter的时间安排更加灵活，增加并行性，减少不自在感。大部分不喜欢Pair的人基本上都是尤其不喜欢全程Pair，所以这项改 动对于吸引更多的人采用Pair具有重要的意义。</p>
<p><strong>3. 区分Owner和Supporter的职责。</strong>经典Pair模式中Driver和Observer角色是随时交换的，也就是说对于一个Task来讲两个人的 职责是相同的，这样可以减小每一个人的压力，但又容易造成缺乏责任感。Owner Supporter模式是单兵模式和经典Pair模式之间的一种妥协，试图在责任和压力之间找到一种平衡。Owner是驱动整个过程的主导，并且是主要的 具体实现者；Supporter以辅助为主，在讨论和review的时候可以站在不同的角度帮助Owner。<strong>Supporter并非没有责任，熟悉Task的所有细节是Supporter的责任。</strong>当Owner由于请假或忙于其他事物时，Supporter应该立即可以代替Owner处理Task的实现或维护。如果Supporter做不到完全的backup，这就是Supporter的失职，在整个Team和领导的心中应该有这样的认识。</p>
<p>最后，除了显而易见的“引入反馈，提高质量”等很“官方”的优点外，我从管理者和开发人员的角度分别总结一下Owner Supporter模式的“不为人知”却真正很有价值的优点。</p>
<p><strong>管理者角度：</strong></p>
<p><strong>1. 应对人员变动：</strong>每个模块至少两个人熟悉，这样在有人请假的时候都有backup，不会造成严重的耽误工作进度。如果有人要离职，交接工作通常也会非常轻 松，几乎没有什么需要特别交接的。很多项目都缺乏文档，只有实现的人知道怎么回事，而即使有文档也总有不清楚的地方，所以留住熟悉的人就是留下了活文档。</p>
<p><strong>2. 增加对质量的信心：</strong>相比单兵作战模式，即使是不懂技术的管理者，Pair也可以自然地增加他们对于软件质量的信心，毕竟“三个臭皮匠顶个诸葛亮”。另外， 需要特别提到的是安全性问题。我曾经听说过一个电信计费项目，一个开发人员故意留了一个漏洞，把钱自动打入自己的银行卡，最终为公司带来了麻烦。如果采用 Pair方式，这种情况就不那么容易发生。</p>
<p><strong>3. 增加反馈：</strong>对于同一个事物，不同的人也会有不同的看法，这是很正常的现象。比如，在对问题进行估计时一个人乐观，一个人悲观，这时管理层可以同时参考他们的意见，对问题掌握得更加全面。</p>
<p><strong>4. 代替培训：</strong>相比传统课程或讲座式培训，Pair能让新员工更快地适应项目。Pair方法也和一些公司采用的导师制有明显的区别。导师制更强调师傅带徒弟， 而Pair则不然。在实践中，我们更鼓励基础比较好的新员工多做Owner，老员工作为Supporter支持；只对基础比较差的新员工先从 Supporter做起，然后逐步过渡到Owner。这样做是因为新员工一般积极性比较高，适合承担更多的具体工作，而老员工则应该避免重复劳动，而是以 辅助和指导为主。另外，新员工也可能带来一些新的思想、方法和技能，这些反而是老员工应该学习的。<em>**</em></p>
<p><strong>开发人员角度：</strong></p>
<p><strong>1. 分担压力，增加默契：</strong>Task依然具有明确的责任人，但Supporter可以分担Owner的压力，即使是Team内的技术高手有一个人做backup也是有益的。有人讨论有人支持更容易达到良好的工作效果，而大家相互Support也可以让团队更加默契。</p>
<p><strong>2. 消除经典Pair的不自在感：</strong> Owner Supporter模式与经典Pair的Driver Observer模式相比更少存在不自在感，因为整个过程是Owner主导的，他有更多的自由安排什么时候讨论，什么时候独立工作。</p>
<p><strong>3. 分享知识和技能：</strong>在Pair的过程中Owner和Supporter会自然地相互传播和分享知识和技能，有助于学习提高。</p>
<p><strong>4. 培养组织能力和表达能力：</strong> Owner相当于一个微型团队的leader，在Pair过程中可以锻炼组织能力和表达能力。这个过程可以让一些不善于交流和组织的技术人员逐渐改善交流和组织能力。</p>
<p>Owner Supporter模式在我们的实践中收到了良好的效果，而且成本很低，值得推荐！
来源： <a href="[http://blog.csdn.net/chjttony/article/details/6203522](http://blog.csdn.net/chjttony/article/details/6203522)">[http://blog.csdn.net/chjttony/article/details/6203522](http://blog.csdn.net/chjttony/article/details/6203522)</a> </p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/敏捷开发/">敏捷开发</a></li></span></span> | <span class="tags">Tagged <a href="/tags/敏捷开发/" class="label label-primary">敏捷开发</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:43"datetime="2014-03-07 09:54:43"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-敏捷开发--结对编程（Pairprogramming）/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-敏捷开发--结对编程（Pairprogramming）" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-连接池--基于ApacheDBCP的数据库连接获取类原创-BeanSoft-sJavaBlo/">基于 Apache DBCP 的数据库连接获取类(原创) </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:43.000Z"> <a href="/2014/02/02/2014-02-02-连接池--基于ApacheDBCP的数据库连接获取类原创-BeanSoft-sJavaBlo/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-apache-dbcp-beansoft-s-java-blog-blogjava">基于 Apache DBCP 的数据库连接获取类(原创) - BeanSoft&#39;s Java Blog - BlogJava</h1>
<p><a href="http://www.blogjava.net/beansoft/" target="_blank">BeanSoft&#39;s Java Blog</a></p>
<p>MyEclipse 教程, Java EE 5, JSPWiki, Spring, Struts, Hibernate, JPA, SWT, Swing, AJAX, JavaScript, Netbeans</p>
<h1 id="-">导航</h1>
<ul>
<li><a href="http://www.blogjava.net/" target="_blank">BlogJava</a></li>
<li><a href="http://www.blogjava.net/beansoft/" target="_blank">首页</a></li>
<li><a href="http://www.blogjava.net/beansoft/admin/EditPosts.aspx?opt=1" target="_blank">新随笔</a>
*</li>
<li><a href="http://www.blogjava.net/beansoft/rss" target="_blank">聚合</a><a href="http://www.blogjava.net/beansoft/rss" target="_blank"><img src="" alt=""></a></li>
<li><p><a href="http://www.blogjava.net/beansoft/admin/EditPosts.aspx" target="_blank">管理</a>
公告</p>
</li>
<li><p>Java EE 专家
Java 高清视频
Mail: <a href="mailto:beansoft@126.com">beansoft@126.com</a>
Location: Beijing
<img src="" alt="">
<img src="" alt=""></p>
</li>
</ul>
<h1 id="-">随笔分类</h1>
<ul>
<li><a href="http://www.blogjava.net/beansoft/category/19463.html" target="_blank">AJAX(22)</a> <a href="http://www.blogjava.net/beansoft/category/19463.html/rss" title="Subscribe to AJAX(22)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/21451.html" target="_blank">Database(11)</a> <a href="http://www.blogjava.net/beansoft/category/21451.html/rss" title="Subscribe to Database(11)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/17556.html" target="_blank">Eclipse(30)</a> <a href="http://www.blogjava.net/beansoft/category/17556.html/rss" title="Subscribe to Eclipse(30)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/17516.html" target="_blank">Firefox(3)</a> <a href="http://www.blogjava.net/beansoft/category/17516.html/rss" title="Subscribe to Firefox(3)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/17577.html" target="_blank">Free Software(20)</a> <a href="http://www.blogjava.net/beansoft/category/17577.html/rss" title="Subscribe to Free Software(20)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/24282.html" target="_blank">Game(4)</a> <a href="http://www.blogjava.net/beansoft/category/24282.html/rss" title="Subscribe to Game(4)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/23349.html" target="_blank">Hibernate(8)</a> <a href="http://www.blogjava.net/beansoft/category/23349.html/rss" title="Subscribe to Hibernate(8)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/22785.html" target="_blank">Java Code Share(12)</a> <a href="http://www.blogjava.net/beansoft/category/22785.html/rss" title="Subscribe to Java Code Share(12)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/17555.html" target="_blank">Java EE(32)</a> <a href="http://www.blogjava.net/beansoft/category/17555.html/rss" title="Subscribe to Java EE(32)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/17517.html" target="_blank">Java SE(27)</a> <a href="http://www.blogjava.net/beansoft/category/17517.html/rss" title="Subscribe to Java SE(27)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/26076.html" target="_blank">JavaMail(5)</a> <a href="http://www.blogjava.net/beansoft/category/26076.html/rss" title="Subscribe to JavaMail(5)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/26857.html" target="_blank">JavaScript(1)</a> <a href="http://www.blogjava.net/beansoft/category/26857.html/rss" title="Subscribe to JavaScript(1)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/26074.html" target="_blank">JBoss(3)</a> <a href="http://www.blogjava.net/beansoft/category/26074.html/rss" title="Subscribe to JBoss(3)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/26022.html" target="_blank">JSF(4)</a> <a href="http://www.blogjava.net/beansoft/category/26022.html/rss" title="Subscribe to JSF(4)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/27072.html" target="_blank">JSP(3)</a> <a href="http://www.blogjava.net/beansoft/category/27072.html/rss" title="Subscribe to JSP(3)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/17506.html" target="_blank">JSPWiki(16)</a> <a href="http://www.blogjava.net/beansoft/category/17506.html/rss" title="Subscribe to JSPWiki(16)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/18621.html" target="_blank">Michael Jackson(1)</a> <a href="http://www.blogjava.net/beansoft/category/18621.html/rss" title="Subscribe to Michael Jackson(1)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/17569.html" target="_blank">My Open Source Toys(30)</a> <a href="http://www.blogjava.net/beansoft/category/17569.html/rss" title="Subscribe to My Open Source Toys(30)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/26073.html" target="_blank">MyEclipse(43)</a> <a href="http://www.blogjava.net/beansoft/category/26073.html/rss" title="Subscribe to MyEclipse(43)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/21997.html" target="_blank">NetBeans(15)</a> <a href="http://www.blogjava.net/beansoft/category/21997.html/rss" title="Subscribe to NetBeans(15)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/17575.html" target="_blank">Open Source World(14)</a> <a href="http://www.blogjava.net/beansoft/category/17575.html/rss" title="Subscribe to Open Source World(14)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/26075.html" target="_blank">Oracle(2)</a> <a href="http://www.blogjava.net/beansoft/category/26075.html/rss" title="Subscribe to Oracle(2)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/17585.html" target="_blank">Other(72)</a> <a href="http://www.blogjava.net/beansoft/category/17585.html/rss" title="Subscribe to Other(72)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/17518.html" target="_blank">Portable Java IDE(3)</a> <a href="http://www.blogjava.net/beansoft/category/17518.html/rss" title="Subscribe to Portable Java IDE(3)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/25965.html" target="_blank">ROR(2)</a> <a href="http://www.blogjava.net/beansoft/category/25965.html/rss" title="Subscribe to ROR(2)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/23350.html" target="_blank">Spring(29)</a> <a href="http://www.blogjava.net/beansoft/category/23350.html/rss" title="Subscribe to Spring(29)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/20433.html" target="_blank">Swing, GUI(9)</a> <a href="http://www.blogjava.net/beansoft/category/20433.html/rss" title="Subscribe to Swing, GUI(9)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/20278.html" target="_blank">SWT/JFACE/RCP(24)</a> <a href="http://www.blogjava.net/beansoft/category/20278.html/rss" title="Subscribe to SWT/JFACE/RCP(24)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/26856.html" target="_blank">Tomcat(1)</a> <a href="http://www.blogjava.net/beansoft/category/26856.html/rss" title="Subscribe to Tomcat(1)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/17587.html" target="_blank">Web(42)</a> <a href="http://www.blogjava.net/beansoft/category/17587.html/rss" title="Subscribe to Web(42)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/22027.html" target="_blank">Web Framework(8)</a> <a href="http://www.blogjava.net/beansoft/category/22027.html/rss" title="Subscribe to Web Framework(8)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/17929.html" target="_blank">Weblogic(7)</a> <a href="http://www.blogjava.net/beansoft/category/17929.html/rss" title="Subscribe to Weblogic(7)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/17574.html" target="_blank">What&#39;s Hot(17)</a> <a href="http://www.blogjava.net/beansoft/category/17574.html/rss" title="Subscribe to What&#39;s Hot(17)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/17511.html" target="_blank">战地2 Battle Field 2(2)</a> <a href="http://www.blogjava.net/beansoft/category/17511.html/rss" title="Subscribe to 战地2 Battle Field 2(2)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/beansoft/category/18212.html" target="_blank">老军医悬壶济世(13)</a> <a href="http://www.blogjava.net/beansoft/category/18212.html/rss" title="Subscribe to 老军医悬壶济世(13)" target="_blank">(rss)</a></li>
</ul>
<h3 id="-">最新随笔</h3>
<ul>
<li><a href="http://www.blogjava.net/beansoft/archive/2008/01/11/174610.html" target="_blank">1. 关于MyEclipse 6.0.0 GA开发SSH应用的%%%% Error Creating SessionFactory %%%% java.lang.SecurityException: class &quot;org.apache.commons.collections.SequencedHashMap&quot;&#39;异常的解决方案</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2008/01/10/174248.html" target="_blank">2. 可以在多普达微软 Pocket PC Windows Mobile 5 手机上运行的eswt程序包</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2008/01/08/173714.html" target="_blank">3. BlogJava 备份文章阅读器:增加日期范围增量备份功能</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2008/01/07/173395.html" target="_blank">4. 电子书 《MyEclipse 6 Java 开发中文教程》 第十章 开发 Spring 应用 完工</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2008/01/07/173298.html" target="_blank">5. 如何购买《MyEclipse 6 Java 开发中文教程》DVD光盘（含源代码，视频和软件）及网上答疑</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2008/01/04/172725.html" target="_blank">6. IBM 中文网站的 Spring 系列等资料</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2008/01/02/172266.html" target="_blank">7. Spring 1.2和2.0的简单AOP例子</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/12/27/171006.html" target="_blank">8. Word 文档加入带链接功能的目录的方法</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/12/27/170997.html" target="_blank">9. 电子书 《MyEclipse 6 Java 开发中文教程》 第九章 开发Struts 1.x应用 完工</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/12/21/169400.html" target="_blank">10. 电子书 《MyEclipse 6 Java 开发中文教程》第八章 开发 Web 应用</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/12/19/168742.html" target="_blank">11. 电子书 《MyEclipse 6 Java 开发中文教程》 第七章 Hibernate 开发预览</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/12/18/168600.html" target="_blank">12. MyEclipse 6 实战开发讲解视频入门 11 Struts 文件上传</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/12/14/167733.html" target="_blank">13. 电子书 《MyEclipse 6 Java 开发中文教程》 第五，六章预览</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/12/10/166631.html" target="_blank">14. 原创电子书 《MyEclipse 6 Java 开发中文教程》下载</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/12/03/164796.html" target="_blank">15. 感谢 2007 年 12 月的 &lt;&lt;程序员&gt;&gt; 杂志推荐我的 Blog</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/12/03/164748.html" target="_blank">16. 视频讲解: Eclipse/MyEclipse 如何导入项目源代码</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/12/02/164704.html" target="_blank">17. MyEclipse 6 实战开发讲解视频入门 10 JSP 文件上传下载</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/12/02/164696.html" target="_blank">18. Java SE 6 Update N Early Access 提供下载</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/11/30/164230.html" target="_blank">19. Spring 2.5 标注开发的简单例子</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/11/30/164166.html" target="_blank">20. MyEclipse 6 实战开发讲解视频入门 9 JSF 1.2 入门开发</a></li>
</ul>
<h3 id="-">搜索</h3>
<p>*</p>
<ul>
<li></li>
</ul>
<h3 id="-">积分与排名</h3>
<ul>
<li>积分 - 632502</li>
<li>排名 - 1</li>
</ul>
<h3 id="-http-www-blogjava-net-beansoft-commentsrss-aspx-">最新评论 <a href="http://www.blogjava.net/beansoft/CommentsRSS.aspx" target="_blank"><img src="" alt=""></a></h3>
<ul>
<li><a href="http://www.blogjava.net/beansoft/archive/2008/01/12/173298.html#174772" target="_blank">1. re: 如何购买《MyEclipse 6 Java 开发中文教程》DVD光盘（含源代码，视频和软件）及网上答疑</a></li>
<li>评论内容较长,点击标题查看</li>
<li>--jerryhu</li>
<li><a href="http://www.blogjava.net/beansoft/archive/2008/01/11/173298.html#174727" target="_blank">2. re: 如何购买《MyEclipse 6 Java 开发中文教程》DVD光盘（含源代码，视频和软件）及网上答疑</a></li>
<li>建议增加spring+jdbc介绍另外JPA部分也增加与spring整和的介绍</li>
<li>--建议</li>
<li><a href="http://www.blogjava.net/beansoft/archive/2008/01/11/173395.html#174585" target="_blank">3. re: 电子书 《MyEclipse 6 Java 开发中文教程》 第十章 开发 Spring 应用 完工</a></li>
<li>评论内容较长,点击标题查看</li>
<li>--BeanSoft</li>
<li><a href="http://www.blogjava.net/beansoft/archive/2008/01/11/104339.html#174565" target="_blank">4. re: 老军医讲牙石</a></li>
<li>正在想最近总是牙出血是什么原因呢，原来如此！</li>
<li>--爱上鸟的鱼</li>
<li><a href="http://www.blogjava.net/beansoft/archive/2008/01/11/104339.html#174559" target="_blank">5. re: 老军医讲牙石</a></li>
<li>正在向最近总是牙出血是什么原因呢，原来如此！</li>
<li>--爱上鸟的鱼</li>
<li><a href="http://www.blogjava.net/beansoft/archive/2008/01/11/166631.html#174553" target="_blank">6. re: 原创电子书 《MyEclipse 6 Java 开发中文教程》下载[未登录]</a></li>
<li>评论内容较长,点击标题查看</li>
<li>--什么捷</li>
<li><a href="http://www.blogjava.net/beansoft/archive/2008/01/11/173395.html#174537" target="_blank">7. re: 电子书 《MyEclipse 6 Java 开发中文教程》 第十章 开发 Spring 应用 完工</a></li>
<li>评论内容较长,点击标题查看</li>
<li>--爱上鸟的鱼</li>
<li><a href="http://www.blogjava.net/beansoft/archive/2008/01/11/161502.html#174516" target="_blank">8. re: MyEclipse 6 实战开发讲解视频入门 6 Web 入门开发 - JSP/HTML/JDBC 登录</a></li>
<li>美国就是变态!怎么搞的!下你个东西,也是左搞搞右搞搞!</li>
<li>--pzxy</li>
<li><a href="http://www.blogjava.net/beansoft/archive/2008/01/10/157925.html#174437" target="_blank">9. re: 原创歌曲: Java 就是好呀</a></li>
<li>没发现,老师您这么有喜剧天份</li>
<li>--tott</li>
<li><a href="http://www.blogjava.net/beansoft/archive/2008/01/10/163354.html#174429" target="_blank">10. re: MyEclipse 6 实战开发讲解视频入门 7 Struts 入门开发</a></li>
<li>正好,我急用学struts1.0.thanks</li>
<li>--张晓云</li>
</ul>
<h3 id="-">阅读排行榜</h3>
<ul>
<li><a href="http://www.blogjava.net/beansoft/archive/2006/11/25/83486.html" target="_blank">1. XLoadTree 基于AJAX + XML动态加载的JS树组件的文档翻译- 已完成(原创)(5081)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/08/15/137067.html" target="_blank">2. MyEclipse Hibernate 快速入门中文版(4417)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/06/18/124894.html" target="_blank">3. Sysdeo Eclipse Tomcat 3.2.1 插件中文版下载(4393)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/10/07/150877.html" target="_blank">4. MyEclipse 5.5 开发 Spring + Struts + Hibernate 的详解视频(长1.5小时)(4341)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/05/10/116486.html" target="_blank">5. 《jsf入门》简体中文版.rar 电子书下载(4100)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2006/12/31/91144.html" target="_blank">6. JSP 中 AJAX 的表单提交中文问题的简单解决方案 - GBK 版本(原创)(3942)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/02/01/97294.html" target="_blank">7. JSP 文件下载的相对完整代码(解决中文问题和Weblogic报错)(3807)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/03/27/106733.html" target="_blank">8. 北京市IT公司黑名单(转载)(3707)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/05/08/115878.html" target="_blank">9. AJAX 入门培训 PPT 及示例代码(3651)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/03/18/104577.html" target="_blank">10. Jigloo 开发 SWT 的入门教程(3626)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2006/11/22/82765.html" target="_blank">11. Eclipse 插件精选介绍(原创)(3612)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2006/12/22/89577.html" target="_blank">12. Tomcat 5.5 的 Apache Tomcat Native library(3557)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2006/12/25/89835.html" target="_blank">13. JSP 中 AJAX 的表单提交中文问题的简单解决方案(3536)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/02/05/97940.html" target="_blank">14. MySQL 5 绿色版(BAT版本)(3515)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/10/24/155586.html" target="_blank">15. MyEclipse 6 学习视频集中下载(文档,视频,源代码)(3470)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2006/12/19/88881.html" target="_blank">16. LambdaProbe 中文包下载(99%完成)(3434)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/02/03/97760.html" target="_blank">17. 用开源软件搭建企业内部协作平台, Kill QQ MSN(3391)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/01/08/92320.html" target="_blank">18. 理解并使用 JSPWiki 中的权限控制(3299)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2006/12/13/87494.html" target="_blank">19. 使用 JDK 6 中的 JConsole 监控应用(原创)(3289)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/05/21/118869.html" target="_blank">20. Netbeans 5.5 + JPA + Hibernate 3 + Tomcat 实例有声视频(3173)</a></li>
</ul>
<h3 id="60-">60天内阅读排行</h3>
<ul>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/11/27/163416.html" target="_blank">1. 翻译: MyEclipse Spring 入门教程(含官方视频和AOP例子)(2239)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/11/22/162498.html" target="_blank">2. 翻译: MyEclipse AJAX 调试教程(含官方视频)(2203)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/12/10/166631.html" target="_blank">3. 原创电子书 《MyEclipse 6 Java 开发中文教程》下载(2063)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/11/30/164230.html" target="_blank">4. Spring 2.5 标注开发的简单例子(2030)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/11/13/160288.html" target="_blank">5. 翻译: MyEclipse Hibernate 入门教程(含官方视频)(1966)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/11/23/162700.html" target="_blank">6. 击破谎言: Spring 2.5 并非&quot;完全&quot;支持基于标注的配置(1914)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/11/19/161502.html" target="_blank">7. MyEclipse 6 实战开发讲解视频入门 6 Web 入门开发 - JSP/HTML/JDBC 登录(1668)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/11/26/163354.html" target="_blank">8. MyEclipse 6 实战开发讲解视频入门 7 Struts 入门开发(1644)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/11/30/164166.html" target="_blank">9. MyEclipse 6 实战开发讲解视频入门 9 JSF 1.2 入门开发(1554)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/12/02/164704.html" target="_blank">10. MyEclipse 6 实战开发讲解视频入门 10 JSP 文件上传下载(1424)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/11/29/163907.html" target="_blank">11. MyEclipse 6 实战开发讲解视频入门 8 XFire Web Service 入门开发(1369)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/11/16/160876.html" target="_blank">12. 翻译: MyEclipse Struts 1.x 教程(PDF格式)(1351)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2008/01/02/172266.html" target="_blank">13. Spring 1.2和2.0的简单AOP例子(1253)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/12/19/168742.html" target="_blank">14. 电子书 《MyEclipse 6 Java 开发中文教程》 第七章 Hibernate 开发预览(1174)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/12/14/167733.html" target="_blank">15. 电子书 《MyEclipse 6 Java 开发中文教程》 第五，六章预览(1165)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2008/01/07/173395.html" target="_blank">16. 电子书 《MyEclipse 6 Java 开发中文教程》 第十章 开发 Spring 应用 完工(1101)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/12/18/168600.html" target="_blank">17. MyEclipse 6 实战开发讲解视频入门 11 Struts 文件上传(1099)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/12/27/170997.html" target="_blank">18. 电子书 《MyEclipse 6 Java 开发中文教程》 第九章 开发Struts 1.x应用 完工(961)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/12/03/164748.html" target="_blank">19. 视频讲解: Eclipse/MyEclipse 如何导入项目源代码(900)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/12/03/164796.html" target="_blank">20. 感谢 2007 年 12 月的 &lt;&lt;程序员&gt;&gt; 杂志推荐我的 Blog(736)</a></li>
</ul>
<p><a href="http://www.blogjava.net/beansoft/archive/2007/01/19/94882.html" target="_blank">基于 Apache DBCP 的数据库连接获取类(原创)</a></p>
<p>2005年12月5日星期一</p>
<p>基于 Apache DBCP 的数据库连接获取类, 可以让你在 Tomcat 之外的 J2SE 程序或者其它应用服务器上使用 Apache 的数据库连接池.</p>
<p>TODO: 增加最大连接数和最小连接数的设置功能</p>
<p>配置文件:</p>
<p>ConnectionFactory.properties</p>
<p>/# 2004-12-30
/# 数据库连接工厂的配置文件, 类文件参见 util.ConnectionFactory
/# 调试标志, 为 true 时使用 JDBC 直接连接(使用 url, driver, user, password 四个参数)
/# 为 false 时使用内置数据库连接池(使用参数 jdbc.jndi), 配置文件位于 db.properties 中
debug=false
/# JDBC的连接地址 URL
jdbc.url=jdbc:microsoft:sqlserver://127.0.0.1:1433;DatabaseName=yuelao
/# JDBC 的驱动
jdbc.driver=com.microsoft.jdbc.sqlserver.SQLServerDriver
/# JDBC 的连接用户名
jdbc.user=sa
/# JDBC 的连接密码
jdbc.password=
/#debug 为 false 时, 将根据连接池名获取数据库连接, 适用于程序在服务器运行的时候</p>
<p>.Java 文件:</p>
<p>//<em>
/</em> @(/#)ConnectionFactory.java 1.2 2005-11-25
/<em>
/</em> Copyright 2005 BeanSoft Studio. All rights reserved.
/<em> PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.
/</em>/</p>
<p>package beansoft.util;</p>
<p>import java.io.ByteArrayInputStream;
import java.io.FileOutputStream;
import java.io.FileWriter;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.util.Properties;</p>
<p>import javax.sql.DataSource;
import org.apache.commons.dbcp.BasicDataSource;</p>
<p>import beansoft.jsp.StringUtil;
import beansoft.sql.DatabaseUtil;</p>
<p>//<em>/</em>
/<em> ConnectionFactory provide a factory class that produces all database
/</em> connections from here, and it provides methods for shutdown and restart
/<em> data sources as well as reading and saving configuration parameters from/to file.
/</em>
/<em> 数据库连接工厂类, 所有的数据库连接都从这里产生, 提供关闭和重启数据源的方法, 以及读取和保存
/</em> 配置参数到文件的能力.
/<em>
/</em> 2005-08-19
/<em> Using Apache DBCP as database connection pool provider.
/</em> 使用 Apache DBCP 作为连接池的提供类.
/<em>
/</em> @link <a href="http://jakarta.apache.org/commons/dbcp/" target="_blank"><a href="http://jakarta.apache.org/commons/dbcp/">http://jakarta.apache.org/commons/dbcp/</a></a>
/<em>
/</em> Dependency:
/<em> commons-collections.jar
/</em> commons-pool.jar
/<em> commons-dbcp.jar
/</em> j2ee.jar (for the javax.sql classes)
/<em>
/</em> If you using this class with Tomcat&#39;s web application, then all the above jars
/<em> not need to be added because the Tomcat it self has included these class libs.
/</em> 如果你在 Tomcat 的 Web Application 中调用这个类, 以上的 JAR 都不用单独
/<em> 加入的, 因为 Tomcat 默认已经自带了这些类库.
/</em>
/<em> @author BeanSoft
/</em> @version 1.2
/<em> 2005-11-25
/</em>/
public class ConnectionFactory {</p>
<p>//<em>/</em> Database password /*/
private static String password;</p>
<p>//<em>/</em> Database username /*/
private static String user;</p>
<p>//<em>/</em> JDBC URL /*/
private static String url;</p>
<p>//<em>/</em>
/<em> JDBC driver class name
/</em>/
private static String driver;</p>
<p>//<em>/</em>
/<em> DEBUG flag, default value is true, returns a connection that directly fetched using
/</em> JDBC API; if falg is false, returns a connection returned by the connection pool,
/<em> if u want depoly the application, please make this flag be false.
/</em> 调试标记, 默认值为 true, 则返回直接使用 JDBC 获取的连接; 如果标记为 false,
/<em> 则从连接池中返回器连接, 发布程序时请将这个标志 设置为 false.
/</em>/
private static boolean DEBUG = true;</p>
<p>//<em>/</em> Connection properties value /*/
private static Properties props = new Properties();</p>
<p>//<em>/</em> The data source object, added at 2005-08-19 /*/
private static DataSource dataSource = null;</p>
<p>// Load configuration from resource /ConnectionFactory.properties
static {
loadConfiguration();
}</p>
<p>private ConnectionFactory() {
}</p>
<p>//<em>/</em>
/<em> Factory method: obtain a database connection.
/</em> 工厂方法: 获取一个数据库连接.
/<em>
/</em>
/<em> @return Connection a java.sql.Connection object
/</em>/
public static Connection getConnection() {
try {
Connection conn = null;</p>
<p>// Debug mode, obtain connection directly through JDBC API
if (DEBUG) {</p>
<p>Class.forName(driver);</p>
<p>conn = DriverManager.getConnection(url, user, password);
} else {
// TODO
// // Looking data source through JNDI tree
// DataSource dataSource = (DataSource) getInitialContext()
// .lookup(jndi);
// conn = dataSource.getConnection();
conn = setupDataSource().getConnection();
}</p>
<p>return conn;
} catch (Exception ex) {
System.err.println(&quot;Error: Unable to get a connection: &quot; + ex);
ex.printStackTrace();
}</p>
<p>return null;
}</p>
<p>//<em>/</em>
/<em> Load and parse configuration.
/</em>/
public static void loadConfiguration() {
try {
props.load(new ByteArrayInputStream(readConfigurationString().getBytes()));</p>
<p>// Load DEBUG flag, default to true
DEBUG = Boolean.valueOf(props.getProperty(&quot;debug&quot;, &quot;true&quot;))
.booleanValue();
password = props.getProperty(&quot;jdbc.password&quot;, null);
user = props.getProperty(&quot;jdbc.user&quot;, null);
url = props.getProperty(&quot;jdbc.url&quot;, null);
driver = props.getProperty(&quot;jdbc.driver&quot;);
} catch (Exception e) {
e.printStackTrace();
}
}</p>
<p>//<em>/</em>
/<em> Save the current configuration properties.
/</em>/
public static void saveConfiguration() {
saveConfiguration(getProperties());
}</p>
<p>//<em>/</em>
/<em> Read content string from configuration file. Because Class.getResourceAsStream(String)
/</em> sometimes cache the contents, so here used this method.
/<em> 读取配置文件中的字符串.
/</em> 因为 Class 类的 getResourceAsStream(String) 方法有时候会出现缓存, 因此
/<em> 不得已使用了这种办法.
/</em> @return String, null if failed
/*/
public static String readConfigurationString() {
try {
java.io.FileInputStream fin = new java.io.FileInputStream(
getConfigurationFilePath());
java.io.ByteArrayOutputStream bout = new
java.io.ByteArrayOutputStream();</p>
<p>int data;
while( (data = fin.read()) != -1) {
bout.write(data);
}
bout.close();
fin.close();</p>
<p>return bout.toString();
} catch (Exception ex) {
System.err.println(&quot;Unable to load ConnectionFactory.properties:&quot; +
ex.getMessage());
ex.printStackTrace();
}
return null;
}</p>
<p>//<em>/</em>
/<em> Get the configuration file&#39;s real physical path.
/</em>/
private static String getConfigurationFilePath() {
return StringUtil.getRealFilePath(&quot;/ConnectionFactory.properties&quot;);
}</p>
<p>//<em>/</em>
/<em> Save string content of a java.util.Properties object.
/</em> 保存配置文件中的字符串.
/<em>
/</em> @param props configuration string
/<em> @return operation result
/</em>/
protected static boolean saveConfigurationString(String props) {
if(props == null || props.length() &lt;= 0) return false;
try {
FileWriter out = new FileWriter(getConfigurationFilePath());
out.write(props);
out.close();</p>
<p>return true;
} catch (Exception ex) {
System.err.println(&quot;Unable save configuration string to ConnectionFactory.properties:&quot;</p>
<ul>
<li>ex);
ex.printStackTrace();
}</li>
</ul>
<p>return false;
}</p>
<p>//<em>/</em>
/<em> Returns the current database connection properties.
/</em> @return Properties object
/*/
public static Properties getProperties() {
return props;
}</p>
<p>//<em>/</em>
/<em> Save configuration properties.
/</em>
/<em> @param props Properties
/</em> @return operation result
/*/
public static boolean saveConfiguration(Properties props) {
if(props == null || props.size() &lt;= 0) return false;</p>
<p>try {
FileOutputStream out = new FileOutputStream(getConfigurationFilePath());
props.store(out, &quot;&quot;);
out.close();</p>
<p>return true;
} catch (Exception ex) {
System.err.println(&quot;Unable to save ConnectionFactory.properties:&quot; + ex.getMessage());
ex.printStackTrace();
}</p>
<p>return false;
}</p>
<p>//<em>/</em>
/<em> Create a DataSource instance based on the Apache DBCP.
/</em> 创建基于 Apache DBCP 的 DataSource.
/<em>
/</em> @return a poolable DataSource
/*/
public static DataSource setupDataSource() {
if(dataSource == null) {
BasicDataSource ds = new BasicDataSource();
ds.setDriverClassName(driver);
ds.setUsername(user);
ds.setPassword(password);
ds.setUrl(url);</p>
<p>dataSource = ds;
}</p>
<p>return dataSource;
}</p>
<p>//<em>/</em>
/<em> Display connection status of current data source.
/</em>
/<em> 显示当前数据源的状态.
/</em>/
public static String getDataSourceStats() {
BasicDataSource bds = (BasicDataSource) setupDataSource();
StringBuffer info = new StringBuffer();</p>
<p>info.append(&quot;Active connection numbers: &quot; + bds.getNumActive());
info.append(&quot;\n&quot;);
info.append(&quot;Idle connection numbers: &quot; + bds.getNumIdle());</p>
<p>return info.toString();
}</p>
<p>//<em>/</em>
/<em> Shut down the data source, if want use it again,
/</em> please call setupDataSource().
/*/
public static void shutdownDataSource() {
BasicDataSource bds = (BasicDataSource) setupDataSource();
try {
bds.close();
} catch (SQLException e) {
// TODO auto generated try-catch
e.printStackTrace();
}
}</p>
<p>//<em>/</em>
/<em> Restart the data source.
/</em> 重新启动数据源.
/*/
public static void restartDataSource() {
shutdownDataSource();
setupDataSource();
}</p>
<p>//<em>/</em> Test method /*/
public static void main(String[] args) {
Connection conn = ConnectionFactory.getConnection();
DatabaseUtil dbUtil = new DatabaseUtil();
dbUtil.setConnection(conn);
// try {
// java.sql.ResultSet rs = conn.createStatement().executeQuery(
// &quot;SELECT MAX(ID) FROM items&quot;);
//
// while(rs.next()) {
// System.out.println(rs.getString(1));
// }
//
// rs.close();
//
// } catch (Exception ex) {
// ex.printStackTrace();
// }
System.out.println(dbUtil.getAllCount(&quot;SELECT MAX(ID) FROM items&quot;));</p>
<p>System.out.println(conn);</p>
<p>try {
conn.close();
} catch (Exception ex) {
// ex.printStackTrace();
}</p>
<p>conn = ConnectionFactory.getConnection();</p>
<p>System.out.println(conn);</p>
<p>try {
conn.close();
} catch (Exception ex) {
// ex.printStackTrace();
}</p>
<p>System.exit(0);
}</p>
<p>}
posted on 2007-01-19 11:04 <a href="http://www.blogjava.net/beansoft/" target="_blank">BeanSoft</a> 阅读(2136) <a href="http://www.blogjava.net/beansoft/archive/2007/01/19/94882.html#Post" target="_blank">评论(1)</a>  <a href="http://www.blogjava.net/beansoft/admin/EditPosts.aspx?postid=94882" target="_blank">编辑</a>  <a href="http://www.blogjava.net/beansoft/AddToFavorite.aspx?id=94882" target="_blank">收藏</a> 所属分类: <a href="http://www.blogjava.net/beansoft/category/21451.html" target="_blank">Database</a><img src="" alt=""></p>
<p><a href=""></a><a href=""></a></p>
<p>[Comments</p>
<ul>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/01/19/94882.html#95631" title="permalink: re: 基于 Apache DBCP 的数据库连接获取类(原创)" target="_blank">/#</a> <a href=""></a>re: 基于 Apache DBCP 的数据库连接获取类(原创)<a href=""></a><a href="http://www.blogjava.net/liubowu/" target="_blank">小车马</a>
Posted @ 2007-01-23 23:38
恩，以前也用过，apache的很多东西都非常不错，
楼主，潜力贴论坛（<a href="http://content.uu1001.com/" target="_blank"><a href="http://content.uu1001.com/">http://content.uu1001.com/</a></a>）是我个人的一个设想，如果你对java非常的专注，并且愿意交我这个朋友，可以发邮件给我（lbw070105@gmail.com），希望我们可以一起发展它。  <a href="http://www.blogjava.net/beansoft/archive/2007/01/19/94882.html#post" target="_blank">回复</a>  <a href="http://www.blogjava.net/comment?author=%e5%b0%8f%e8%bd%a6%e9%a9%ac" title="查看该作者发表过的评论" target="_blank">更多评论</a> <a href=""></a>  <a href="">]()
</a>
<a href="">刷新评论列表</a>  </li>
</ul>
<p><a href=""></a> 标题  请输入标题 姓名  请输入你的姓名 主页 请输入验证码 验证码 /*  <img src="" alt=""> 内容(请不要发表任何与政治相关的内容) 请输入评论内容 Remember Me?   <a href="http://www.blogjava.net/login.aspx?ReturnURL=http://www.blogjava.net/beansoft/archive/2007/01/19/94882.html&amp;SourceURL=/beansoft/archive/2007/01/19/94882.html">登录</a>  <a href="http://www.blogjava.net/beansoft/archive/2007/01/19/94882.html?login=1#Post" target="_blank">使用高级评论</a>  <a href="http://www.blogjava.net/RequireRegister.aspx" target="_blank">新用户注册</a>  <a href="http://www.blogjava.net/beansoft/archive/2007/01/19/94882.html#Top" target="_blank">返回页首</a>  <a href="http://www.blogjava.net/beansoft/archive/2007/01/19/94882.html#Post" target="_blank">恢复上次提交</a>       [使用Ctrl+Enter键可以直接提交] 该文被作者在 2007-09-22 12:56 编辑过      相关文章:</p>
<ul>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/10/23/155318.html" target="_blank">基于<em>JDBC_2.0</em>驱动的分页代码实现</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/10/01/150075.html" target="_blank">BeanSoft MySQL Java 开发套装(服务器,管理工具,JDBC驱动,示例代码) 无中文问题</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/09/24/147657.html" target="_blank">SQL中主键和外键的区别?(zz)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/09/22/147366.html" target="_blank">常用 JDBC 驱动名字和 URL 列表</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/09/18/146115.html" target="_blank">如何连接SQL Server数据库(Tomcat 连接池配置) (转载)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/07/11/129652.html" target="_blank">Oracle Sequence 和 java.sql.PreparedStatement 的协同使用</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/07/10/129354.html" target="_blank">学习 SQL 语法的好资料: Transact-SQL 参考</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/07/10/129329.html" target="_blank">Hibernate 如何配置显示生成的 SQL?</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/04/09/109432.html" target="_blank">Mysql 优化的资料(收集转载)</a></li>
<li><a href="http://www.blogjava.net/beansoft/archive/2007/02/05/97940.html" target="_blank">MySQL 5 绿色版(BAT版本)</a></li>
</ul>
<p>Powered by:
<a href="http://www.blogjava.net/" target="_blank">BlogJava</a>
Copyright © BeanSoft</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/连接池/">连接池</a></li></span></span> | <span class="tags">Tagged <a href="/tags/连接池/" class="label label-primary">连接池</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:43"datetime="2014-03-07 09:54:43"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-连接池--基于ApacheDBCP的数据库连接获取类原创-BeanSoft-sJavaBlo/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-连接池--基于ApacheDBCP的数据库连接获取类原创-BeanSoft-sJavaBlo" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>





<ul id="pagination" class="pagination pagination-lg">
  <li><a class="extend prev" href="/page/34/">&laquo;</a></li><li><a class="page-number" href="/">1</a></li><li><a class="page-number" href="/page/2/">2</a></li><li><span class="space">&hellip;</span></li><li><a class="page-number" href="/page/32/">32</a></li><li><a class="page-number" href="/page/33/">33</a></li><li><a class="page-number" href="/page/34/">34</a></li><li class="active"><li><span class="page-number current">35</span></li><li><a class="page-number" href="/page/36/">36</a></li><li><a class="page-number" href="/page/37/">37</a></li><li><a class="page-number" href="/page/38/">38</a></li><li><span class="space">&hellip;</span></li></li><li><a class="page-number" href="/page/161/">161</a></li><li><a class="page-number" href="/page/162/">162</a></li><li><a class="extend next" href="/page/36/">&raquo;</a></li>
  <div class="clearfix"></div>
</ul></div><!--wapper-->
       </div><!-- ID main-col END -->
       <aside id="sidebar" class="alignright col-sx-6 col-sm-4 col-md-3 col-lg-3">
<div id="widget_search" class="widget panel panel-primary">
    <form action="//google.com/search" method="get" accept-charset="utf-8">
  <div class="input-group">
    <input class="form-control" id="searchbox" type="search" name="q" results="0" placeholder="search">
    <span class="input-group-btn">
      <button class="btn btn-default" type="submit">Go!</button>
    </span>
    <input type="hidden" name="q" value="site:itsolife.com">
  </div>
</form>
</div>

<div id="widget_category" class="widget panel panel-primary">
  <div class="panel-heading">category</div>  <div data-src='category' class='ajax_widgets'>正在加载...</div>
</div>

<div id="widget_recent_posts" class="widget panel panel-primary">
  <div class="panel-heading">recent posts</div>  <div data-src='recent_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_tagcloud" class="widget panel panel-primary">
  <div class="panel-heading">tagcloud</div>  <div data-src='tagcloud' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_latest_update_posts" class="widget panel panel-primary">
  <div class="panel-heading">最近更新</div>  <div data-src='latest_update_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_recent_comments" class="widget panel panel-primary">
  <div class="panel-heading">recent comments</div>  

<div class="list-group-item ds-recent-comments" data-num-items="6" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="50"></div>



</div>

</aside>
       <div class="clearfix"></div>
     </div><!-- row END -->
  </div>
  <footer id="footer" class="container">
  <div class="panel panel-info">
  <section id='footer_widget'></section>  <div class="panel-footer">
  <div id="site-info">
    <span class='author'>
  
  &copy; 2014 RobinChia
  
    &nbsp;&nbsp;</span>
  
  <span id='analytics-51la'></span><span id='analytics-google'>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-48559895-1']);
  _gaq.push(['_trackPageview']);
  _js2load.push({src:('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'});
</script></span><span id='analytics-cnzz'>
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_5774006'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s17.cnzz.com/stat.php%3Fid%3D5774006%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
</span><span id='analytics-baidu'>
<script>
var _hmt = _hmt || [];
_js2load.push({src:"//hm.baidu.com/hm.js?1442f50724afc42380b51f097c43082c"});
</script>
</span>  </div>
  <div id="copyright">Site powered by <a href='http://zespia.tw/hexo/'><strong>hexo</strong></a>  update time: <em>2014-04-07 17:30:36</em></span></div>
</div>
<div class="clearfix"></div>


  </div>
  </footer>
  
        <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>        
        <script src="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/js/bootstrap.min.js"></script>        
                
        <script src="http://cdn.bootcss.com/prettify/r298/prettify.min.js"></script>    <script type="text/javascript">
   var lang=["bsh", "c", "cc", "cpp", "cs", "csh", "cyc", "cv", "htm", "html",
    "java", "js", "m", "mxml", "perl", "pl", "pm", "py", "rb", "sh",
    "xhtml", "xml", "xsl"];
   var pretty_base='';
   $('script').each(function(){
	var c = $(this).attr('src');
	if (!c)
	    return;
	if (c.match(/(\/)?prettify(\.min)?\.js/i))
	{
	    var index = c.lastIndexOf('/');
	    if (index != -1)
		pretty_base = c.substr(0,index + 1);
	    return false;
	}
   })
   $('pre code').each(function(){
	var c = $(this).attr('class')
	if (!c)
	    return;
	c = c.match(/\s?(lang\-\w+)/i);
	if (c && lang.indexOf(c[1]) == -1)
	{
	    lang.push(c[1]);
	    $.getScript(pretty_base + c[1] + '.min.js');
	}
   })

    $(window).load(function(){
       $("pre").addClass("prettyprint");
       prettyPrint();
    })
</script>    
            <script type="text/javascript">
var duoshuoQuery = {short_name:"robinchia"};
_js2load.push({src:'http://static.duoshuo.com/embed.js',charset:'UTF-8'});
</script>
    
            <!--wumii_relatedItems-->
    
        <script src="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js"></script>    <script type="text/javascript">
(function($){
  $('.entry').each(function(i){
    $(this).find('img').each(function(){
      var alt = this.alt;

      if (alt){
        $(this).before('<span class="caption">' + alt + '</span>');
      }

      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="fancybox' + i + '" />');
    });
  });

  $('.fancybox').fancybox();
})(jQuery);
</script>    
        <script src="http://cdn.bootcss.com/mathjax/2.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>
    
<script type="text/javascript">
$('.ajax_widgets').each(function(){var src=$(this).attr('data-src');if(src)$(this).load('/widgets/'+src+'.html');});
$.each(_js2load,function(index,obj){loadjs(obj.src,obj.charset)});
</script>

<div id="scroll2top">
<img src="/scroll2top/arrow.png"/>
</div>
<script src="/scroll2top/scroll2top.min.js"></script>
<div id="winterland">
  <canvas></canvas>
</div>
<script src="/js/winterland.min.js"></script>

  </body>
</html>
