
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>The 155 Page | It so life</title>
<meta name="author" content="RobinChia">

<meta name="description" content="It so life">


<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta property="og:site_name" content="It so life"/>

<!--[if IE]><style>.testIE.IE{display:inline;}</style><![endif]-->
<!--[if lte IE 7]><link rel="stylesheet" href="/css/ie7.css" type="text/css"><![endif]-->
<!--[if (lt IE 9)&(gt IE 7)]><style>.testIE.IE8{display:inline;}</style><![endif]-->
<!--[if gt IE 8]><style>.testIE.IE9{display:inline;}</style><![endif]-->

<link href="/favicon.png" rel="icon">
<link rel="alternate" href="/atom.xml" title="It so life Feed" type="application/atom+xml">

<link rel="stylesheet" href="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.0.3/css/font-awesome.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/prettify/r298/prettify.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" type="text/css">
<link rel="stylesheet" href="/css/style.css" type="text/css">
<!--[if lt IE 9]>
   <style>article,aside,dialog,footer,header,section,footer,nav,figure,menu{display:block}</style>
   <script src="http://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
   <script src="http://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
<link href="http://cdn.staticfile.org/respond.js/1.4.2/respond-proxy.html" id="respond-proxy" rel="respond-proxy" />
<link href="/js/respond.proxy.gif" id="respond-redirect" rel="respond-redirect" />
<script src="/js/respond.proxy.js"></script>
   <script src="http://cdn.bootcss.com/selectivizr/1.0.2/selectivizr-min.js"></script>
<![endif]-->
<script type="text/javascript">
function loadjs(c,d){var a=document.createElement("script");a.async=!0;a.type="text/javascript";a.src=c;a.charset=d||"gbk";(document.getElementsByTagName("HEAD")[0]||document.getElementsByTagName("BODY")[0]).appendChild(a)};
var _protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
var _js2load = [];
</script>

</head>
<body>
      <header id="header" class="container"><nav id="main-nav" class="navbar navbar-default navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="/">It so life</a>
    </div>
    <div  class="collapse navbar-collapse">
      <ul  class="nav navbar-nav">
  
        <li><a href="/" title="Home">Home</a></li>      
        <li><a href="/about/" title="About">About</a></li>      
        <li><a href="/archives/" title="Archives">Archives</a></li>      
      <li class='dropdown'>
        <a class='dropdown-toggle' data-toggle='dropdown' href='#'>website<b class='caret'></b></a>
        <ul class='dropdown-menu pure-menu-selected'>
    
          <li><a href="//groups.google.com/forum/#!forum/pongba" title="TopLanguage">TopLanguage</a></li>    
          <li><a href="//itpub.net/" title="ITPub">ITPub</a></li>    
          <li><a href="//blog.jobbole.com/" title="Bole">Bole</a></li>    
          <li><a href="//nosql-database.org/" title="nosql">nosql</a></li>    
          <li><a href="//gitimmersion.googol.im/" title="Git">Git</a></li>    
        </ul>
      </li>
    
      </ul>
      <ul class="nav navbar-nav navbar-right">
      
        <li><a href="/atom.xml">RSS</a></li>
      
      
        <li><a href="https://twitter.com/robinchia">twitter</a></li>
      
      
      
      
        <li><a href="https://github.com/robinchia">github</a></li>
      
      </ul>
    </div>
  </div>
</nav>
<div class="clearfix"></div>
</header>
  <div id='content' class="container">
     <div class="page-header-wrapper">
      <!--[if lt IE 9]><div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong>提示:</strong>您的浏览器版本太低了,建议升级到 <strong><a href="http://windows.microsoft.com/zh-cn/internet-explorer/download-ie" title="IE9">IE9</a></strong> 以上,本站使用<a href="https://www.google.com/intl/zh-CN/chrome/">Chrome浏览器</a>可以获得最好的显示效果.</div><![endif]-->
      <div class="page-header"><h1 align="center"><big>It so life</big> </h1>
        <h5 align="center"><big>love as life</big></h5>
      </div>
     </div>
     <div class="row">
       <div id="main-col" class="alignleft col-sx-12 col-sm-8 col-md-9 col-lg-9">
      <section id='header_widget'></section>
          <div id="wrapper"><article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-JS用法--javascript常用小技巧/">javascript常用小技巧</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:28.000Z"> <a href="/2014/02/02/2014-02-02-JS用法--javascript常用小技巧/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="javascript-">javascript常用小技巧</h1>
<p><a href="http://www.javaeye.com/" target="_blank">首页</a> <a href="http://www.javaeye.com/news" target="_blank">新闻</a> <a href="http://www.javaeye.com/forums" target="_blank">论坛</a> <a href="http://www.javaeye.com/blogs" target="_blank">博客</a> <a href="http://www.javaeye.com/job" target="_blank">招聘</a> <a href="http://hainanhaian.javaeye.com/blog/260844#" target="_blank">更多 ▼</a></p>
<p><a href="http://www.javaeye.com/ask" target="_blank">问答</a> <a href="http://www.javaeye.com/wiki" target="_blank">知识库</a> <a href="http://www.javaeye.com/groups" target="_blank">圈子</a> <a href="http://www.javaeye.com/google_search" target="_blank">搜索</a></p>
<p><a href="http://jywv.javaeye.com/" title="查看我的博客首页" target="_blank">欢迎jywv</a> <a href="http://app.javaeye.com/messages" title="发送站内短信" target="_blank">收件箱</a> <a href="http://app.javaeye.com/" title="我的应用首页" target="_blank">我的应用</a></p>
<p><a href="http://app.javaeye.com/feed" title="我订阅的好友动态消息" target="_blank">我的订阅</a> <a href="http://app.javaeye.com/feed/my" title="我参与的话题更新的消息" target="_blank">我的参与</a> <a href="http://app.javaeye.com/chat" title="用闲聊发表简短的话题" target="_blank">我的闲聊</a> <a href="http://app.javaeye.com/mygroup" title="我加入的圈子最新话题" target="_blank">我的圈子</a> <a href="http://app.javaeye.com/links" title="我收藏的网络资源链接" target="_blank">我的收藏</a> <a href="http://app.javaeye.com/myresume" title="我的个人简历" target="_blank">我的简历</a>
<a href="http://jywv.javaeye.com/admin" title="管理我的博客" target="_blank">我的博客</a> <a href="http://app.javaeye.com/profile" title="修改我的个人设置" target="_blank">设置</a> <a href="http://hainanhaian.javaeye.com/logout" target="_blank">退出</a></p>
<h1 id="-http-hainanhaian-javaeye-com-"><a href="http://hainanhaian.javaeye.com/" target="_blank">新空气</a></h1>
<p>永久域名 <a href="http://hainanhaian.javaeye.com/" target="_blank"><a href="http://hainanhaian.javaeye.com/">http://hainanhaian.javaeye.com/</a></a></p>
<p><a href="http://hainanhaian.javaeye.com/blog/266896" title="Servlet上传文件打水印生成缩略图" target="_blank">Servlet上传文件打水印生成缩略图</a> | <a href="http://hainanhaian.javaeye.com/blog/256008" title="java,jsp获取网页源码内容的三种代码方法" target="_blank">java,jsp获取网页源码内容的三种代码方法</a></p>
<p>2008-11-01</p>
<h3 id="-javascript-http-hainanhaian-javaeye-com-blog-260844-"><a href="http://hainanhaian.javaeye.com/blog/260844" target="_blank">javascript常用小技巧</a></h3>
<p>avascript小技巧
事件源对象
event.srcElement.tagName
event.srcElement.type
捕获释放
event.srcElement.setCapture();
event.srcElement.releaseCapture();
事件按键
event.keyCode
event.shiftKey
event.altKey
event.ctrlKey
事件返回值
event.returnValue
鼠标位置
event.x
event.y
窗体活动元素
document.activeElement
绑定事件
document.captureEvents(Event.KEYDOWN);
访问窗体元素
document.all(&quot;txt&quot;).focus();
document.all(&quot;txt&quot;).select();
窗体命令
document.execCommand
窗体COOKIE
document.cookie
菜单事件
document.oncontextmenu
创建元素
document.createElement(&quot;SPAN&quot;);
根据鼠标获得元素：
document.elementFromPoint(event.x,event.y).tagName==&quot;TD
document.elementFromPoint(event.x,event.y).appendChild(ms)
窗体图片
document.images[索引]
窗体事件绑定
document.onmousedown=scrollwindow;
元素
document.窗体.elements[索引]
对象绑定事件
document.all.xxx.detachEvent(&#39;onclick&#39;,a);
插件数目
navigator.plugins
取变量类型
typeof($js_libpath) == &quot;undefined&quot;
下拉框
下拉框.options[索引]
下拉框.options.length
查找对象
document.getElementsByName(&quot;r1&quot;);
document.getElementById(id);
定时
timer=setInterval(&#39;scrollwindow()&#39;,delay);
clearInterval(timer);
UNCODE编码
escape() ,unescape
父对象
obj.parentElement(dhtml)
obj.parentNode(dom)
交换表的行
TableID.moveRow(2,1)
替换CSS
document.all.csss.href = &quot;a.css&quot;;
并排显示
display:inline
隐藏焦点
hidefocus=true
根据宽度换行
style=&quot;word-break:break-all&quot;
自动刷新</p>
<p><meta HTTP-EQUIV="refresh" CONTENT="8;URL=http://c98.yeah.net">
简单邮件
<a href="mailto:aaa@bbb.com?subject=ccc&body=xxxyyy">
快速转到位置
obj.scrollIntoView(true)
锚
<a name="first">
<a href="/#first">anchors</a>
网页传递参数
location.search();
可编辑
obj.contenteditable=true
执行菜单命令
obj.execCommand
双字节字符
/[^\x00-\xff]/
汉字
/[\u4e00-\u9fa5]/
让英文字符串超出表格宽度自动换行
word-wrap: break-word; word-break: break-all;
透明背景
&lt;爱生活,爱猫扑 src=&quot;1.htm&quot; width=300 height=180 allowtransparency&gt;&lt;/爱生活,爱猫扑&gt;
获得style内容
obj.style.cssText
HTML标签
document.documentElement.innerHTML
第一个style标签
document.styleSheets[0]
style标签里的第一个样式
document.styleSheets[0].rules[0]
防止点击空链接时，页面往往重置到页首端。
<a href="javascript :function()">word</a>
上一网页源
asp:
request.servervariables(&quot;HTTP_REFERER&quot;)
javascript :
document.referrer
释放内存
CollectGarbage();
禁止右键
document.oncontextmenu = function() { return false;}
禁止保存</p>
<p><noscript>&lt;爱生活,爱猫扑 src=&quot;/*.htm&quot;&gt;&lt;/爱生活,爱猫扑&gt;</noscript>
禁止选取&lt;body oncontextmenu=&quot;return false&quot; ondragstart=&quot;return false&quot;
onselectstart =&quot;return false&quot; onselect=&quot;document.selection.empty()&quot;
oncopy=&quot;document.selection.empty()&quot; onbeforecopy=&quot;return
false&quot;onmouseup=&quot;document.selection.empty()&gt;
禁止粘贴</p>
<p><input type=text onpaste="return false">
地址栏图标</p>
<p><link rel="Shortcut Icon" href="favicon.ico">
favicon.ico 名字最好不变16/*16的16色,放虚拟目录根目录下
收藏栏图标</p>
<p><link rel="Bookmark" href="favicon.ico">
查看源码</p>
<p><input type=button value=查看网页源代码 onclick="window.location = 'view-source:'+
'http://www.csdn.net/'">
关闭输入法</p>
<p><input style="ime-mode:disabled">
自动全选</p>
<p><input type=text name=text1 value="123" onfocus="this.select()">
ENTER键可以让光标移到下一个输入框</p>
<p><input onkeydown="if(event.keyCode==13)event.keyCode=9">
文本框的默认值</p>
<p><input type=text value="123" onfocus="alert(this.defaultValue)">
title换行
obj.title = &quot;123 sdfs &quot;
获得时间所代表的微秒
var n1 = new Date(&quot;2004-10-10&quot;.replace(/-/g, &quot;\/&quot;)).getTime()
窗口是否关闭
win.closed
checkbox扁平</p>
<p><input type=checkbox style="position: absolute; clip:rect(5px 15px 15px
5px)"><br>
获取选中内容
document.selection.createRange().duplicate().text
自动完成功能</p>
<p><input type=text autocomplete=on>打开该功能</p>
<p><input type=text autocomplete=off>关闭该功能<br>窗口最大化</p>
<p><body onload="window.resizeTo(window.screen.width -
4,window.screen.height-50);window.moveTo(-4,-4)">
无关闭按钮IE
window.open(&quot;aa.htm&quot;, &quot;meizz&quot;, &quot;fullscreen=7&quot;);
统一编码/解码
alert(decodeURIComponent(encodeURIComponent(&quot;<a href="http://你好.com?as=" target="_blank">http://你好.com?as=</a> hehe&quot;)))
encodeURIComponent对&quot;:&quot;、&quot;/&quot;、&quot;;&quot; 和 &quot;?&quot;也编码
表格行指示</p>
<p><tr onmouseover="this.bgColor='/#f0f0f0'" onmouseout="this.bgColor='/#ffffff'">
//各种尺寸
s += &quot;\r\n网页可见区域宽：&quot;+ document.body.clientWidth;<br>s += &quot;\r\n网页可见区域高：&quot;+ document.body.clientHeight;<br>s += &quot;\r\n网页可见区域高：&quot;+ document.body.offsetWeight +&quot; (包括边线的宽)&quot;;<br>s += &quot;\r\n网页可见区域高：&quot;+ document.body.offsetHeight +&quot; (包括边线的宽)&quot;;<br>s += &quot;\r\n网页正文全文宽：&quot;+ document.body.scrollWidth;<br>s += &quot;\r\n网页正文全文高：&quot;+ document.body.scrollHeight;<br>s += &quot;\r\n网页被卷去的高：&quot;+ document.body.scrollTop;<br>s += &quot;\r\n网页被卷去的左：&quot;+ document.body.scrollLeft;<br>s += &quot;\r\n网页正文部分上：&quot;+ window.screenTop;<br>s += &quot;\r\n网页正文部分左：&quot;+ window.screenLeft;<br>s += &quot;\r\n屏幕分辨率的高：&quot;+ window.screen.height;<br>s += &quot;\r\n屏幕分辨率的宽：&quot;+ window.screen.width;<br>s += &quot;\r\n屏幕可用工作区高度：&quot;+ window.screen.availHeight;<br>s += &quot;\r\n屏幕可用工作区宽度：&quot;+ window.screen.availWidth;<br>//过滤数字</p>
<p><input type=text onkeypress="return
event.keyCode>=48&&event.keyCode<=57||(this.value.indexOf('.')<0?event.keyCode==46:false)"
onpaste="return !clipboardData.getData('text').match(/\D/)" ondragenter="return
false">
//特殊用途</p>
<p><input type=button value=导入收藏夹
onclick="window.external.ImportExportFavorites(true,'http://localhost');"></p>
<p><input type=button value=导出收藏夹
onclick="window.external.ImportExportFavorites(false,'http://localhost');"></p>
<p><input type=button value=整理收藏夹
onclick="window.external.ShowBrowserUI('OrganizeFavorites', null)"></p>
<p><input type=button value=语言设置  
onclick="window.external.ShowBrowserUI('LanguageDialog', null)"></p>
<p><input type=button value=加入收藏夹
onclick="window.external.AddFavorite('http://www.google.com/', 'google')"></p>
<p><input type=button value=加入到频道
onclick="window.external.addChannel('http://www.google.com/')"></p>
<p><input type=button value=加入到频道
onclick="window.external.showBrowserUI('PrivacySettings',null)">
//不缓存</p>
<p><META HTTP-EQUIV="pragma" CONTENT="no-cache"></p>
<p><META HTTP-EQUIV="Cache-Control" CONTENT="no-cache, must-revalidate"></p>
<p><META HTTP-EQUIV="expires" CONTENT="0">
//正则匹配
匹配中文字符的正则表达式： [\u4e00-\u9fa5]
匹配双字节字符(包括汉字在内)：[^\x00-\xff]
匹配空行的正则表达式：\n[\s| ]/<em>\r
匹配HTML标记的正则表达式：/&lt;(./</em>)&gt;./<em>&lt;\/\1&gt;|&lt;(./</em>) \/&gt;/
匹配首尾空格的正则表达式：(^\s/<em>)|(\s/</em>$)（像vbscript那样的trim函数）
匹配Email地址的正则表达式：\w+([-+.]\w+)/<em>@\w+([-.]\w+)/</em>.\w+([-.]\w+)/<em>
匹配网址URL的正则表达式：<a href="http://([\w-]+\.)+[\w-]+(/[\w-" target="_blank">http://([\w-]+\.)+[\w-]+(/[\w-</a> ./?%&amp;=]/</em>)?
以下是例子：
利用正则表达式限制网页表单里的文本框输入内容：
用正则表达式限制只能输入中文：onkeyup=&quot;value=value.replace(/[^\u4E00-\u9FA5]/g,&#39;&#39;)&quot;
onbeforepaste=&quot;clipboardData.setData(&#39;text&#39;,clipboardData.getData(&#39;text&#39;).replace(/[^\u4E00-\u9FA5]/g,&#39;&#39;))&quot;
1.用正则表达式限制只能输入全角字符： onkeyup=&quot;value=value.replace(/[^\uFF00-\uFFFF]/g,&#39;&#39;)&quot;
onbeforepaste=&quot;clipboardData.setData(&#39;text&#39;,clipboardData.getData(&#39;text&#39;).replace(/[^\uFF00-\uFFFF]/g,&#39;&#39;))&quot;
2.用正则表达式限制只能输入数字：onkeyup=&quot;value=value.replace(/[^\d]/g,&#39;&#39;)
&quot;onbeforepaste=&quot;clipboardData.setData(&#39;text&#39;,clipboardData.getData(&#39;text&#39;).replace(/[^\d]/g,&#39;&#39;))&quot;
3.用正则表达式限制只能输入数字和英文：onkeyup=&quot;value=value.replace(/[\W]/g,&#39;&#39;)
&quot;onbeforepaste=&quot;clipboardData.setData(&#39;text&#39;,clipboardData.getData(&#39;text&#39;).replace(/[^\d]/g,&#39;&#39;))&quot;
//消除图像工具栏</p>
<p><IMG SRC="mypicture.jpg" HEIGHT="100px" WIDTH="100px" GALLERYIMG="false">
or</p>
<p><head></p>
<p><meta http-equiv="imagetoolbar" content="no">
</head>
//无提示关闭
function Close()
{
var ua=navigator.userAgent
var ie=navigator.appName==&quot;Microsoft Internet Explorer&quot;?true:false
if(ie)
{
    var IEversion=parseFloat(ua.substring(ua.indexOf(&quot;MSIE
&quot;)+5,ua.indexOf(&quot;;&quot;,ua.indexOf(&quot;MSIE &quot;))))
if(IEversion&lt; 5.5)
{
  var str = &#39;<object id=noTipClose
classid="clsid:ADB880A6-D8FF-11CF-9377-00AA003B7A11">&#39;
    str += &#39;<param name="Command" value="Close"></object>&#39;;
    document.body.insertAdjacentHTML(&quot;beforeEnd&quot;, str);
    document.all.noTipClose.Click();
}
    else
{
    window.opener =null;
    window.close();
    }
  }
else
{
window.close()
  }
}
//取得控件得绝对位置(1)</p>
<p><script language="javascript">
function getoffset(e)
{
var t=e.offsetTop;
var l=e.offsetLeft;
while(e=e.offsetParent)
{
t+=e.offsetTop;
l+=e.offsetLeft;
}
var rec = new Array(1);
rec[0] = t;
rec[1] = l;
return rec
}
</script>
//获得控件的绝对位置(2)
oRect = obj.getBoundingClientRect();
oRect.left
oRect.
//最小化,最大化,关闭</p>
<p><object id=min classid="clsid:ADB880A6-D8FF-11CF-9377-00AA003B7A11"></p>
<p><param name="Command" value="Minimize"></object></p>
<p><object id=max classid="clsid:ADB880A6-D8FF-11CF-9377-00AA003B7A11"></p>
<p><param name="Command" value="Maximize"></object></p>
<p><OBJECT id=close classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11"></p>
<p><PARAM NAME="Command" value="Close"></OBJECT></p>
<p><input type=button value=最小化 onclick=min.Click()></p>
<p><input type=button value=最大化 onclick=max.Click()></p>
<p><input type=button value=关闭 onclick=close.Click()>
//光标停在文字最后</p>
<p><script language="javascript">
function cc()
{
var e = event.srcElement;
var r =e.createTextRange();
r.moveStart(&#39;character&#39;,e.value.length);
r.collapse(true);
r.select();
}
</script></p>
<p><input type=text name=text1 value="123" onfocus="cc()">
//页面进入和退出的特效
进入页面<meta http-equiv="Page-Enter" content="revealTrans(duration=x,
transition=y)">
推出页面<meta http-equiv="Page-Exit" content="revealTrans(duration=x,
transition=y)">
这个是页面被载入和调出时的一些特效。duration表示特效的持续时间，以秒为单位。transition表示使
用哪种特效，取值为1-23:
0 矩形缩小
1 矩形扩大
2 圆形缩小
3 圆形扩大
4 下到上刷新
5 上到下刷新
6 左到右刷新
7 右到左刷新
8 竖百叶窗
9 横百叶窗
10 错位横百叶窗
11 错位竖百叶窗
12 点扩散
13 左右到中间刷新
14 中间到左右刷新
15 中间到上下
16 上下到中间
17 右下到左上
18 右上到左下
19 左上到右下
20 左下到右上
21 横条
22 竖条
23
//网页是否被检索</p>
<p><meta name="ROBOTS" content="属性值">
其中属性值有以下一些:
属性值为&quot;all&quot;: 文件将被检索，且页上链接可被查询；
属性值为&quot;none&quot;: 文件不被检索，而且不查询页上的链接；
属性值为&quot;index&quot;: 文件将被检索；
属性值为&quot;follow&quot;: 查询页上的链接；
属性值为&quot;noindex&quot;: 文件不检索，但可被查询链接；
属性值为&quot;nofollow&quot;:
//打印分页</p>
<p><p style="page-break-after:always">page1</p>  </p>
<p><p style="page-break-after:always">page2</p><br>//设置打印</p>
<p>&lt;object id=&quot;factory&quot; style=&quot;display:none&quot; viewastext
classid=&quot;clsid:1663ed61-23eb-11d2-b92f-008048fdd814&quot;
codebase=&quot;<a href="http://www.meadroid.com/scriptx/ScriptX.cab/#Version=5,60,0,360" target="_blank">http://www.meadroid.com/scriptx/ScriptX.cab/#Version=5,60,0,360</a>&quot;</p>
<blockquote>
<p></object></p>
<p><input type=button value=页面设置 onclick="factory.printing.PageSetup()"></p>
<p><input type=button value=打印预览 onclick="factory.printing.Preview()"></p>
<p><script language=javascript>
function window.onload()
{
  // -- advanced features
  factory.printing.SetMarginMeasure(2) // measure margins in inches
  factory.printing.SetPageRange(false, 1, 3) // need pages from 1 to 3
  factory.printing.printer = &quot;HP DeskJet 870C&quot;
  factory.printing.copies = 2
  factory.printing.collate = true
  factory.printing.paperSize = &quot;A4&quot;
  factory.printing.paperSource = &quot;Manual feed&quot;
  // -- basic features
  factory.printing.header = &quot;居左显示&amp;b居中显示&amp;b居右显示页码，第&amp;p页/共&amp;P页&quot;
  factory.printing.footer = &quot;（自定义页脚）&quot;
  factory.printing.portrait = false
  factory.printing.leftMargin = 0.75
  factory.printing.topMargin = 1.5
  factory.printing.rightMargin = 0.75
  factory.printing.bottomMargin = 1.5
}
function Print(frame) {
factory.printing.Print(true, frame) // print with prompt
}
</script></p>
<p><input type=button value="打印本页" onclick="factory.printing.Print(false)"></p>
<p><input type=button value="页面设置" onclick="factory.printing.PageSetup()"></p>
<p><input type=button value="打印预览" onclick="factory.printing.Preview()"><br>
<a href="http://www.meadroid.com/scriptx/docs/printdoc.htm?static"
target=_blank>具体使用手册，更多信息，点这里</a>
//自带的打印预览
WebBrowser.ExecWB(1,1) 打开
Web.ExecWB(2,1) 关闭现在所有的IE窗口，并打开一个新窗口
Web.ExecWB(4,1) 保存网页
Web.ExecWB(6,1) 打印
Web.ExecWB(7,1) 打印预览
Web.ExecWB(8,1) 打印页面设置
Web.ExecWB(10,1) 查看页面属性
Web.ExecWB(15,1) 好像是撤销，有待确认
Web.ExecWB(17,1) 全选
Web.ExecWB(22,1) 刷新
Web.ExecWB(45,1) 关闭窗体无提示</p>
<p><style media=print>
.Noprint{display:none;}<!--用本样式在打印时隐藏非打印项目-->
.PageNext{page-break-after: always;}<!--控制分页-->
</style></p>
<p><object id="WebBrowser" width=0 height=0
classid="CLSID:8856F961-340A-11D0-A96B-00C04FD705A2"><br></object>  </p>
<p><center class="Noprint" ></p>
<p><input type=button value=打印 onclick=document.all.WebBrowser.ExecWB(6,1)></p>
<p><input type=button value=直接打印 onclick=document.all.WebBrowser.ExecWB(6,6)></p>
<p><input type=button value=页面设置 onclick=document.all.WebBrowser.ExecWB(8,1)>
</p></p>
<p><p> <input type=button value=打印预览 onclick=document.all.WebBrowser.ExecWB(7,1)>
</center>
//去掉打印时的页眉页脚</p>
<p><script language="JavaScript"><br>var HKEY_Root,HKEY_Path,HKEY_Key;
HKEY_Root=&quot;HKEY_CURRENT_USER&quot;;
HKEY_Path=&quot;\Software\Microsoft\Internet Explorer\PageSetup\&quot;;
//设置网页打印的页眉页脚为空
function PageSetup_Null()
{
try
{
      var Wsh=new ActiveXObject(&quot;WScript.Shell&quot;);
HKEY_Key=&quot;header&quot;;
Wsh.RegWrite(HKEY_Root+HKEY_Path+HKEY_Key,&quot;&quot;);
HKEY_Key=&quot;footer&quot;;
Wsh.RegWrite(HKEY_Root+HKEY_Path+HKEY_Key,&quot;&quot;);
}
catch(e){}
}
//设置网页打印的页眉页脚为默认值
function PageSetup_Default()
{<br>try
{
var Wsh=new ActiveXObject(&quot;WScript.Shell&quot;);
HKEY_Key=&quot;header&quot;;
Wsh.RegWrite(HKEY_Root+HKEY_Path+HKEY_Key,&quot;&amp;w&amp;b页码,&amp;p/&amp;P&quot;);
HKEY_Key=&quot;footer&quot;;
Wsh.RegWrite(HKEY_Root+HKEY_Path+HKEY_Key,&quot;&amp;u&amp;b&amp;d&quot;);
}
catch(e){}
}
</script></p>
<p><input type="button" value="清空页码" onclick=PageSetup_Null()></p>
<p><input type="button" value="恢复页码" onclick=PageSetup_Default()>
//浏览器验证
function checkBrowser()
{
  this.ver=navigator.appVersion
  this.dom=document.getElementById?1:0
  this.ie6=(this.ver.indexOf(&quot;MSIE 6&quot;)&gt;-1 &amp;&amp; this.dom)?1:0;
  this.ie5=(this.ver.indexOf(&quot;MSIE 5&quot;)&gt;-1 &amp;&amp; this.dom)?1:0;
  this.ie4=(document.all &amp;&amp; !this.dom)?1:0;
  this.ns5=(this.dom &amp;&amp; parseInt(this.ver) &gt;= 5) ?1:0;
  this.ns4=(document.layers &amp;&amp; !this.dom)?1:0;
  this.mac=(this.ver.indexOf(&#39;Mac&#39;) &gt; -1) ?1:0;
  this.ope=(navigator.userAgent.indexOf(&#39;Opera&#39;)&gt;-1);
  this.ie=(this.ie6 || this.ie5 || this.ie4)
  this.ns=(this.ns4 || this.ns5)
  this.bw=(this.ie6 || this.ie5 || this.ie4 || this.ns5 || this.ns4 || this.mac
|| this.ope)
  this.nbw=(!this.bw)
  return this;
}
//计算内容宽和高</p>
<p><SCRIPT language="javascript"><br>function test(obj)<br>{<br>    var range = obj.createTextRange();<br>    alert(&quot;内容区宽度: &quot; + range.boundingWidth  </p>
<pre><code>                            + &quot;px\r\n内容区高度: &quot; +
</code></pre><p>range.boundingHeight + &quot;px&quot;);  </p>
</blockquote>
<p>}<br></SCRIPT>  </p>
<p><BODY>  </p>
<p><Textarea id="txt" height="150">sdf</textarea><INPUT type="button"
value="计算内容宽度" onClick="test(txt)"><br></BODY>
//无模式的提示框
function modelessAlert(Msg)
{</p>
<p>window.showModelessDialog(&quot;javascript :alert(\&quot;&quot;+escape(Msg)+&quot;\&quot;);window.close();&quot;,&quot;&quot;,&quot;status:no;resizable:no;help:no;dialogHeight:height:30px;dialogHeight:40px;&quot;);
}
//屏蔽按键</p>
<p><html></p>
<p><head></p>
<p><meta http-equiv="Content-Type" content="text/html; charset=gb2312"></p>
<p><noscript><meta http-equiv="refresh"
content="0;url=about:noscript"></noscript></p>
<p><title>屏蔽鼠标右键、Ctrl+N、Shift+F10、Alt+F4、F11、F5刷新、退格键</title>
</head></p>
<p><body></p>
<p><script language="Javascript">&lt;!--
//屏蔽鼠标右键、Ctrl+N、Shift+F10、F11、F5刷新、退格键
//Author: meizz(梅花雨) 2002-6-18
function document.oncontextmenu(){event.returnValue=false;}//屏蔽鼠标右键
function window.onhelp(){return false} //屏蔽F1帮助
function document.onkeydown()
{
if ((window.event.altKey)&amp;&amp;
    ((window.event.keyCode==37)||   //屏蔽 Alt+ 方向键 ←
    (window.event.keyCode==39)))   //屏蔽 Alt+ 方向键 →
{
  alert(&quot;不准你使用ALT+方向键前进或后退网页！&quot;);
  event.returnValue=false;
}
  //<em> 注：这还不是真正地屏蔽 Alt+ 方向键，
  因为 Alt+ 方向键弹出警告框时，按住 Alt 键不放，
  用鼠标点掉警告框，这种屏蔽方法就失效了。以后若
  有哪位高手有真正屏蔽 Alt 键的方法，请告知。/</em>/
if ((event.keyCode==8) ||           //屏蔽退格删除键
    (event.keyCode==116)||           //屏蔽 F5 刷新键
    (event.ctrlKey &amp;&amp; event.keyCode==82)){ //Ctrl + R
  event.keyCode=0;
  event.returnValue=false;
  }
if (event.keyCode==122){event.keyCode=0;event.returnValue=false;} //屏蔽F11
if (event.ctrlKey &amp;&amp; event.keyCode==78) event.returnValue=false;   //屏蔽 Ctrl+n
if (event.shiftKey &amp;&amp; event.keyCode==121)event.returnValue=false; //屏蔽
shift+F10
if (window.event.srcElement.tagName == &quot;A&quot; &amp;&amp; window.event.shiftKey)
    window.event.returnValue = false;         //屏蔽 shift 加鼠标左键新开一网页
if ((window.event.altKey)&amp;&amp;(window.event.keyCode==115))         //屏蔽Alt+F4
{</p>
<p>window.showModelessDialog(&quot;about:blank&quot;,&quot;&quot;,&quot;dialogWidth:1px;dialogheight:1px&quot;);
    return false;
}
}
</script>
屏蔽鼠标右键、Ctrl+N、Shift+F10、Alt+F4、F11、F5刷新、退格键
</body>
</html>
//屏蔽打印</p>
<p><style>
@media print{
/* {display:none}
}
</style>
//移动的图层，拖动
1.<span style='position:absolute;width:200;height:200;background:red'
onmousedown=MouseDown(this) onmousemove=MouseMove()
onmouseup=MouseUp()>meizz</span></p>
<p><script language=javascript>
var Obj;
function MouseDown(obj)
{
Obj=obj;
Obj.setCapture();
Obj.l=event.x-Obj.style.pixelLeft;
Obj.t=event.y-Obj.style.pixelTop;
}
function MouseMove()
{
if(Obj!=null)
{
  Obj.style.left = event.x-Obj.l;
  Obj.style.top = event.y-Obj.t;
}
}
function MouseUp()
{
if(Obj!=null)
{
  Obj.releaseCapture();
  Obj=null;
}
}
</script>
2.</p>
<p><div id="myDiv" src="logo.gif" ondrag="doDrag();"
onmouseover="this.style.cursor='hand'"
style="position:absolute;left=100;top=100;" onmousedown="doMouseDown();">
<a href="/#" onclick="return false"><h1>wlecome</h1></a>
</div></p>
<p><script language="JavaScript" type="text/javascript">
var orgMouseX;
var orgMouseY;
var orgObjX;
var orgObjY;
function doDrag()
{
var myObject=document.all.myDiv;
var x=event.clientX;
var y=event.clientY;
myObject.style.left=x-(orgMouseX-orgObjX);
myObject.style.top=y-(orgMouseY-orgObjY);
}
function doMouseDown()
{
orgMouseX=event.clientX;
orgMouseY=event.clientY;
orgObjX=parseInt(document.all.myDiv.style.left);
orgObjY=parseInt(document.all.myDiv.style.top);
}
</script>
//文档状态改变
&lt;爱生活,爱猫扑 src=&quot;a.html&quot; id=&quot;f&quot; name=&quot;f&quot; scrolling=&quot;no&quot; frameborder=0 marginwidth=0
marginheight=0&gt;&lt;/爱生活,爱猫扑&gt;</p>
<p><script>
var doc=window.frames[&quot;f&quot;].document;
function s(){
if (doc.readyState==&quot;complete&quot;){
document.all.f.style.height=doc.body.scrollHeight
document.all.f.style.width=doc.body.scrollWidth
}
}
doc.onreadystatechange=s
</script>
//刷新后不变的文本框</p>
<p><HTML></p>
<p><HEAD></p>
<p><META NAME="save" CONTENT="history"></p>
<p><STYLE>
  .sHistory {behavior:url(/#default/#savehistory);}
</STYLE>
</HEAD></p>
<p><BODY></p>
<p><INPUT class=sHistory type=text id=oPersistInput>
</BODY>
</HTML>
//访问剪贴板
(1)拖拽访问
event.dataTransfer.setData(&quot;URL&quot;, oImage.src);
sImageURL = event.dataTransfer.getData(&quot;URL&quot;)
(2)普通访问
window.clipboardData.setData(&quot;Text&quot;,oSource.innerText);
window.clipboardData.getData(&quot;Text&quot;);
//操作COOKIE
function SetCookie(sName, sValue)
{
document.cookie = sName + &quot;=&quot; + escape(sValue) + &quot;; &quot;;
}
function GetCookie(sName)
{
var aCookie = document.cookie.split(&quot;; &quot;);
for (var i=0; i &lt; aCookie.length; i++)
{</p>
<p>var aCrumb = aCookie.split(&quot;=&quot;);
if (sName == aCrumb[0])
return unescape(aCrumb[1]);
}
}
function DelCookie(sName)
{
document.cookie = sName + &quot;=&quot; + escape(sValue) + &quot;; expires=Fri, 31 Dec 1999
23:59:59 GMT;&quot;;
}
//setTimeout增加参数</p>
<p><script>
var _st = window.setTimeout;
window.setTimeout = function(fRef, mDelay) {
if(typeof fRef == &#39;function&#39;){
var argu = Array.prototype.slice.call(arguments,2);
var f = (function(){ fRef.apply(null, argu); });
return _st(f, mDelay);
}
return _st(fRef,mDelay);
}
function test(x){
alert(x);
}
window.setTimeout(test,1000,&#39;fason&#39;);
</script>
//自定义的apply,call
Function.prototype.apply = function (obj, argu) {
if (obj) obj.constructor.prototype._caller = this;
var argus = new Array();
for (var i=0;i&lt;argu.length;i++)
argus = &quot;argu[&quot; + i + &quot;]&quot;;
var r;
eval(&quot;r = &quot; + (obj ? (&quot;obj._caller(&quot; + argus.join(&quot;,&quot;) + &quot;);&quot;) : (&quot;this(&quot; +
argus.join(&quot;,&quot;) + &quot;);&quot;)));
return r;
};
Function.prototype.call = function (obj) {
var argu = new Array();
for (var i=1;i&lt;arguments.length;i++)
argu[i-1] = arguments;
return this.apply(obj, argu);
};<br>//下载文件
function DownURL(strRemoteURL,strLocalURL)
{
try
{
var xmlHTTP=new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);
xmlHTTP.open(&quot;Get&quot;,strRemoteURL,false);
xmlHTTP.send();
var adodbStream=new ActiveXObject(&quot;ADODB.Stream&quot;);
adodbStream.Type=1;//1=adTypeBinary
adodbStream.Open();
adodbStream.write(xmlHTTP.responseBody);
adodbStream.SaveToFile(strLocalURL,2);
adodbStream.Close();
adodbStream=null;
xmlHTTP=null;</p>
<p>}
catch(e)
{
window.confirm(&quot;下载URL出错!&quot;);
}
//window.confirm(&quot;下载完成.&quot;);
}
//检验连接是否有效
function getXML(URL)
{
var xmlhttp = new ActiveXObject(&quot;microsoft.xmlhttp&quot;);
xmlhttp.Open(&quot;GET&quot;,URL, false);
try
{
xmlhttp.Send();
}
catch(e){}
finally
{
var result = xmlhttp.responseText;
if(result)
{
  if(xmlhttp.Status==200)
  {
  return(true);
  }
  else
  {
  return(false);
  }
}
else
{
  return(false);
}
}
}
//POST代替FORM</p>
<p><SCRIPT language="VBScript">
Function URLEncoding(vstrIn)
  strReturn = &quot;&quot;
  For i = 1 To Len(vstrIn)
    ThisChr = Mid(vStrIn,i,1)
    If Abs(Asc(ThisChr)) &lt; &amp;HFF Then
        strReturn = strReturn &amp; ThisChr
    Else
        innerCode = Asc(ThisChr)
        If innerCode &lt; 0 Then
          innerCode = innerCode + &amp;H10000
        End If
        Hight8 = (innerCode And &amp;HFF00)\ &amp;HFF
        Low8 = innerCode And &amp;HFF
        strReturn = strReturn &amp; &quot;%&quot; &amp; Hex(Hight8) &amp; &quot;%&quot; &amp; Hex(Low8)
    End If
  Next
  URLEncoding = strReturn
End Function
Function bytes2BSTR(vIn)
  strReturn = &quot;&quot;
  For i = 1 To LenB(vIn)
    ThisCharCode = AscB(MidB(vIn,i,1))
    If ThisCharCode &lt; &amp;H80 Then
        strReturn = strReturn &amp; Chr(ThisCharCode)
    Else
        NextCharCode = AscB(MidB(vIn,i+1,1))
        strReturn = strReturn &amp; Chr(CLng(ThisCharCode) /* &amp;H100 +
CInt(NextCharCode))
        i = i + 1
    End If
  Next
  bytes2BSTR = strReturn
End Function
dim strA,oReq
strA = URLEncoding(&quot;submit1=Submit&amp;text1=中文&quot;)
set oReq = CreateObject(&quot;MSXML2.XMLHTTP&quot;)
oReq.open &quot;POST&quot;,&quot;<a href="http://ServerName/VDir/TstResult.asp&quot;,false" target="_blank">http://ServerName/VDir/TstResult.asp&quot;,false</a>
oReq.setRequestHeader &quot;Content-Length&quot;,Len(strA)
oReq.setRequestHeader &quot;CONTENT-TYPE&quot;,&quot;application/x-www-form-urlencoded&quot;
oReq.send strA
msgbox bytes2BSTR(oReq.responseBody)
</SCRIPT>
//readyState是xmlhttp返回数据的进度，0=载入中,1=未初始化,2=已载入,3=运行中,4=完成
//组件是否安装
isComponentInstalled(&quot;{6B053A4B-A7EC-4D3D-4567-B8FF8A1A5739}&quot;, &quot;componentID&quot;))
//检查网页是否存在
function CheckURL(URL)
{
var xmlhttp = new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);
xmlhttp.Open(&quot;GET&quot;,URL, false);
try
{
  xmlhttp.Send();
  var result = xmlhttp.status;
}
catch(e) {return(false); }
if(result==200)
{
  return true;
}
xmlhttp = null;
return false;
}
//连接数据库</p>
<p><script language="javascript">
//用 JavaScript 写服务器端连接数据库的代码示例
var conn = new ActiveXObject(&quot;ADODB.Connection&quot;);
conn.Open(&quot;Provider=SQLOLEDB.1; Data Source=localhost; User ID=sa; &quot;
  +&quot;Password=; Initial Catalog=pubs&quot;);
var rs = new ActiveXObject(&quot;ADODB.Recordset&quot;);
var sql=&quot;select /* from authors&quot;;
rs.open(sql, conn);
shtml = &quot;<table width='100%' border=1>&quot;;
shtml +=&quot;<tr
bgcolor='/#f4f4f4'><td>au_id</td><td>au_lname</td><td>au_fname</td><td>phone</td><td>address</td><td>
city</td><td>state</td><td>zip</td></tr>&quot;;
while(!rs.EOF)
{
shtml += &quot;<tr><td>&quot; + rs(&quot;au_id&quot;) + &quot;</td><td>&quot; + rs(&quot;au_lname&quot;) + &quot;</td><td>&quot;</p>
<ul>
<li>rs(&quot;au_fname&quot;) + &quot;</td><td>&quot; + rs(&quot;phone&quot;) + &quot;</td><td>&quot; + rs(&quot;address&quot;) +
&quot;</td><td>&quot; + rs(&quot;city&quot;) + &quot;</td><td>&quot; + rs(&quot;state&quot;) + &quot;</td><td>&quot; + rs(&quot;zip&quot;) +
&quot;</td></tr>&quot;;
rs.moveNext;
}
shtml += &quot;</table>&quot;;
document.write(shtml);
rs.close();
rs = null;
conn.close();
conn = null;
</script>
//使用数据岛
<html>
<body>
srno：<input type=text datasrc=/#xmldate DataFLD=srno size="76"><BR>
times：<input type=text datasrc=/#xmldate DataFLD=times size="76"><BR>
<input id="first" TYPE=button value="<<　第一条记录"
onclick="xmldate.recordset.moveFirst()">
<input id="prev" TYPE=button value="<上一条记录"
onclick="xmldate.recordset.movePrevious()"><br><input id="next" TYPE=button value="下一条记录>"
onclick="xmldate.recordset.moveNext()"><br><input id="last" TYPE=button value="最后一条记录>>"
onclick="xmldate.recordset.moveLast()"><br><input id="Add" TYPE=button value="添加新记录" onclick="xmldate.recordset.addNew()">
<XML ID="xmldate">
<infolist>
<info ><srno>20041025-01</srno><times>null</times></info>
<info ><srno>20041101-09</srno><times>2004年10月1日2点22分0秒</times></info>
</infolist>
</XML>
</body>
</html>
//获得参数
<body>
<a href="javascript :location.href=location.href + '?a=1&b=2'">search</a>
<script language="JavaScript">
<!--
var a = location.search.substr(1);
if(a.length>0)
{
var re = /([^&]/*?)\=([^&]/*)/g
var s = a.match(re);
for(var i= 0;i<s.length;i++)
{
alert(s);
alert(s.split("=")[1]);
}
}
//-->
</script>
</body>
//可编辑SELECT
<input type=text name=re_name
style="width:100px;height:21px;font-size:10pt;"><span
style="width:18px;border:0px solid red;"><select name="r00"
style="margin-left:-100px;width:118px; background-color:/#FFEEEE;"
onChange="document.all.re_name.value=this.value;"><pre><code>    &lt;option value=&quot;1&quot;&gt;11111111&lt;option&gt;
    &lt;option value=&quot;2&quot;&gt;222222&lt;/option&gt;
    &lt;option value=&quot;3&quot;&gt;333333&lt;/option&gt;
  &lt;/select&gt;
  &lt;/span&gt;
</code></pre>//设置光标位置
function getCaret(textbox)
{
var control = document.activeElement;
textbox.focus();
var rang = document.selection.createRange();
rang.setEndPoint(&quot;StartToStart&quot;,textbox.createTextRange())
control.focus();
return rang.text.length;
}
function setCaret(textbox,pos)
{
try
{
var r =textbox.createTextRange();
r.moveStart(&#39;character&#39;,pos);
r.collapse(true);
r.select();
}
catch(e)
{}
}
function selectLength(textbox,start,len)
{
try
{
var r =textbox.createTextRange();
r.moveEnd(&#39;character&#39;,len-(textbox.value.length-start));
r.moveStart(&#39;character&#39;,start);</li>
</ul>
<p>r.select();
}
catch(e)
{//alert(e.description)}
}
function insertAtCaret(textbox,text)
{
textbox.focus();
document.selection.createRange().text = text;
}
//页内查找
function findInPage(str)
{
var txt, i, found,n = 0;
if (str == &quot;&quot;)
{
return false;
}
txt = document.body.createTextRange();
for (i = 0; i &lt;= n &amp;&amp; (found = txt.findText(str)) != false; i++)
{
txt.moveStart(&quot;character&quot;, 1);
txt.moveEnd(&quot;textedit&quot;);
}
if (found)
{
txt.moveStart(&quot;character&quot;, -1);
txt.findText(str);
txt.select();
txt.scrollIntoView();
n++;<br>}
else
{
if (n &gt; 0)
{
  n = 0;
  findInPage(str);
}
else
{
  alert(str + &quot;...         您要找的文字不存在。\n \n请试着输入页面中的关键字再次查找！&quot;);
}
}
return false;
}
//书
<a href="http://www.itpub.net/attachment.php?s=&amp;postid=1894598" target="_blank">http://www.itpub.net/attachment.php?s=&amp;postid=1894598</a>
<a href="http://www.wrclub.net/down/listdown.aspx?id=1341" target="_blank">http://www.wrclub.net/down/listdown.aspx?id=1341</a>
//操作EXECL</p>
<p><script language="javascript">
function jStartExcel() {
var xls = new ActiveXObject ( &quot;Excel.Application&quot; );
xls.visible = true;
var newBook = xls.Workbooks.Add;
newBook.Worksheets.Add;
newBook.Worksheets(1).Activate;
xls.ActiveWorkBook.ActiveSheet.PageSetup.Orientation = 2;
xls.ActiveWorkBook.ActiveSheet.PageSetup.PaperSize = 5;
newBook.Worksheets(1).Columns(&quot;A&quot;).columnwidth=50;
newBook.Worksheets(1).Columns(&quot;A&quot;).WrapText = true;
newBook.Worksheets(1).Columns(&quot;B&quot;).columnwidth=50;
newBook.Worksheets(1).Columns(&quot;B&quot;).WrapText = true;
newBook.Worksheets(1).Range(&quot;A1:B1000&quot;).NumberFormat = &quot;0&quot;;
newBook.Worksheets(1).Range(&quot;A1:B1000&quot;).HorizontalAlignment = -4131;
newBook.Worksheets(1).Cells(1,1).Interior.ColorIndex=&quot;15&quot;;
newBook.Worksheets(1).Cells(1,1).value=&quot;First Column, First Cell&quot;;
newBook.Worksheets(1).Cells(2,1).value=&quot;First Column, Second Cell&quot;;
newBook.Worksheets(1).Cells(1,2).value=&quot;Second Column, First Cell&quot;;
newBook.Worksheets(1).Cells(2,2).value=&quot;Second Column, Second Cell&quot;;
newBook.Worksheets(1).Name=&quot;My First WorkSheet&quot;;
}
</script>
//自定义提示条
<a href="/#" title="这是提示">tip</a></p>
<p><script Language="JavaScript">
///<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>默认设置定义./</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>
tPopWait=50;//停留tWait豪秒后显示提示。
tPopShow=5000;//显示tShow豪秒后关闭提示
showPopStep=20;
popOpacity=99;
///<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>内部变量定义/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>
sPop=null;
curShow=null;
tFadeOut=null;
tFadeIn=null;
tFadeWaiting=null;
document.write(&quot;<style type='text/css'id='defaultPopStyle'>&quot;);
document.write(&quot;.cPopText { background-color: /#F8F8F5;color:/#000000; border:
1px /#000000 solid;font-color: font-size: 12px; padding-right: 4px; padding-left:
4px; height: 20px; padding-top: 2px; padding-bottom: 2px; filter:
Alpha(Opacity=0)}&quot;);
document.write(&quot;</style>&quot;);
document.write(&quot;<div id='dypopLayer' style='position:absolute;z-index:1000;'
class='cPopText'></div>&quot;);
function showPopupText(){
var o=event.srcElement;
MouseX=event.x;
MouseY=event.y;
if(o.alt!=null &amp;&amp; o.alt!=&quot;&quot;){o.dypop=o.alt;o.alt=&quot;&quot;};
    if(o.title!=null &amp;&amp; o.title!=&quot;&quot;){o.dypop=o.title;o.title=&quot;&quot;};
if(o.dypop!=sPop) {
sPop=o.dypop;
clearTimeout(curShow);
clearTimeout(tFadeOut);
clearTimeout(tFadeIn);
clearTimeout(tFadeWaiting);
if(sPop==null || sPop==&quot;&quot;) {
dypopLayer.innerHTML=&quot;&quot;;
dypopLayer.style.filter=&quot;Alpha()&quot;;
dypopLayer.filters.Alpha.opacity=0;
}
else {
if(o.dyclass!=null) popStyle=o.dyclass
else popStyle=&quot;cPopText&quot;;
curShow=setTimeout(&quot;showIt()&quot;,tPopWait);
}
}
}
function showIt(){
dypopLayer.className=popStyle;
dypopLayer.innerHTML=sPop;
popWidth=dypopLayer.clientWidth;
popHeight=dypopLayer.clientHeight;
if(MouseX+12+popWidth&gt;document.body.clientWidth) popLeftAdjust=-popWidth-24
else popLeftAdjust=0;
if(MouseY+12+popHeight&gt;document.body.clientHeight) popTopAdjust=-popHeight-24
else popTopAdjust=0;
dypopLayer.style.left=MouseX+12+document.body.scrollLeft+popLeftAdjust;
dypopLayer.style.top=MouseY+12+document.body.scrollTop+popTopAdjust;
dypopLayer.style.filter=&quot;Alpha(Opacity=0)&quot;;
fadeOut();
}
function fadeOut(){
if(dypopLayer.filters.Alpha.opacity<popOpacity) {
dypopLayer.filters.Alpha.opacity+=showPopStep;
tFadeOut=setTimeout("fadeOut()",1);
}
else {
dypopLayer.filters.Alpha.opacity=popOpacity;
tFadeWaiting=setTimeout("fadeIn()",tPopShow);
}
}
function fadeIn(){
if(dypopLayer.filters.Alpha.opacity>0) {
dypopLayer.filters.Alpha.opacity-=1;
tFadeIn=setTimeout(&quot;fadeIn()&quot;,1);
}
}
document.onmouseover=showPopupText;
</script>
//插入文字
document.onclick =function(){
var oSource = window.event.srcElement;
if(oSource.tagName!=&quot;DIV&quot;)
return false;
var sel = document.selection;
if (sel!=null) {
var rng = sel.createRange();
if (rng!=null)
rng.pasteHTML(&quot;<font color=red>插入文字</font>&quot;);
}
}
//netscapte下操作xml
doc = new ActiveXObject(&quot;Msxml2.DOMDocument&quot;);
doc = new ActiveXObject(&quot;Microsoft.XMLDOM&quot;)
-&gt;&gt;
doc = (new DOMParser()).parseFromString(sXML,&#39;text/xml&#39;)
//判断键值</p>
<p><html></p>
<p><meta http-equiv="Content-Type" content="text/html; charset=gb2312"></p>
<p><head></p>
<p><script language="javascript">
var ie =navigator.appName==&quot;Microsoft Internet Explorer&quot;?true:false;</p>
<p>function keyDown(e)
{
if(!ie)
{
var nkey=e.which;
var iekey=&#39;现在是ns浏览器&#39;;
var realkey=String.fromCharCode(e.which);
}
if(ie)
{
var iekey=event.keyCode;
var nkey=&#39;现在是ie浏览器&#39;;
var realkey=String.fromCharCode(event.keyCode);
if(event.keyCode==32){realkey=&#39;\&#39; 空格\&#39;&#39;}
if(event.keyCode==13){realkey=&#39;\&#39; 回车\&#39;&#39;}
if(event.keyCode==27){realkey=&#39;\&#39; Esc\&#39;&#39;}
if(event.keyCode==16){realkey=&#39;\&#39; Shift\&#39;&#39;}
if(event.keyCode==17){realkey=&#39;\&#39; Ctrl\&#39;&#39;}
if(event.keyCode==18){realkey=&#39;\&#39; Alt\&#39;&#39;}
}
alert(&#39;ns浏览器中键值:&#39;+nkey+&#39;\n&#39;+&#39;ie浏览器中键值:&#39;+iekey+&#39;\n&#39;+&#39;实际键为&#39;+realkey);
}
document.onkeydown = keyDown;
</script>
</head></p>
<p><body>
//Javascript Document.</p>
<p><hr></p>
<p><center></p>
<p><h3>请按任意一个键。。。。</h3>
</center>
</body>
</html>
//禁止FSO
1.注销组件
regsvr32 /u scrrun.dll
2.修改PROGID
HKEY_CLASSES_ROOT\Scripting.FileSystemObject
Scripting.FileSystemObject
3.对于使用object的用户，修改HKEY_CLASSES_ROOT\Scripting.
//省略号</p>
<p><DIV STYLE="width: 120px; height: 50px; border: 1px solid blue;
        overflow: hidden; text-overflow:ellipsis"></p>
<p><NOBR>就是比如有一行文字，很长，表格内一行显示不下.</NOBR>
</DIV>
//检测media play版本</p>
<p><IE:clientCaps ID="oClientCaps" style="{behavior:url(/#default/#clientcaps)}" /></p>
<p><SCRIPT>
var flash=&quot;&quot;;
  WMPVersion=
oClientCaps.getComponentVersion(&quot;{22D6F312-B0F6-11D0-94AB-0080C74C7E95}&quot;,&quot;ComponentID&quot;);
  if (WMPVersion != &quot;&quot;) {
  flash = &quot;&quot;;
  var version = WMPVersion.split(&quot;,&quot;);
  var i;
  for (i = 0; i &lt; version.length; i++) {
    if (i != 0)
  flash += &quot;.&quot;;
    flash += version;
  }
  document.write(&quot;您的Windows Media Player 版本是:&quot;+flash+&quot;<p>&quot;);
}
</SCRIPT>
//图象按比例</p>
<p><script language="JavaScript">
<!--
//图片按比例缩放
var flag=false;
function DrawImage(ImgD){
var image=new Image();
var iwidth = 80; //定义允许图片宽度
var iheight = 80; //定义允许图片高度
image.src=ImgD.src;
if(image.width>0 && image.height>0){
flag=true;
if(image.width/image.height>= iwidth/iheight){
if(image.width>iwidth){  
ImgD.width=iwidth;
ImgD.height=(image.height/*iwidth)/image.width;
}else{
ImgD.width=image.width;  
ImgD.height=image.height;
}
ImgD.alt=image.width+"×"+image.height;
}
else{
if(image.height>iheight){  
ImgD.height=iheight;
ImgD.width=(image.width/*iheight)/image.height;  
}else{
ImgD.width=image.width;  
ImgD.height=image.height;
}
ImgD.alt=image.width+"×"+image.height;
}
}
}
//-->
</script>
<img src=".." onload = "DrawImage(this)">
//细线SELECT
<span style="border:1px solid /#000000; position:absolute; overflow:hidden;" ></p>
<p><select style="margin:-2px;"></p>
<p><option>1111</option></p>
<p><option>11111111111111</option></p>
<p><option>111111111</option>
</select></span>
//Import
function Import() {
for( var i=0; i&lt;arguments.length; i++ ) {
var file = arguments;
if ( file.match(/.js$/i))
  document.write(&#39;<script type=\"text/javascript\" src=\"' + file + '\"></sc' +
'ript>&#39;);
else
  document.write(&#39;<style type=\"text/css\">@import \&quot;&#39; + file + &#39;\&quot;
;</style>&#39;);
}
};
//js枚举
function getComputerName()
{
var objWMIService = GetObject(&quot;Winmgmts:root\cimv2&quot;);
for(e = new Enumerator(objWMIService) ; !e.atEnd() ; e.moveNext())
{
  var getComputer = e.item();
  return getComputer.Name;
}
}
//条件编译</p>
<p><script language=javascript>
//<em>@cc_on @/</em>/
//<em>@if (@_win32 &amp;&amp; @_jscript_version&gt;5)
function window.confirm(str)
{
  execScript(&quot;n = msgbox(&#39;&quot;+ str +&quot;&#39;, 257)&quot;, &quot;vbscript&quot;);
  return(n == 1);
}
@end @/</em>/
</script>
//取得innerText</p>
<p><SCRIPT LANGUAGE="JavaScript">
&lt;!--
var xmlDoc = new ActiveXObject(&quot;Msxml2.DOMDocument.4.0&quot;);
var currNode;
xmlDoc.async = false;
xmlDoc.async = false;
xmlDoc.loadXML(&quot;<TABLENAME>     你好你阿三   爱猫扑.爱生活   司法等四<br></TABLENAME>&quot;);
currNode = xmlDoc.documentElement;</p>
<p>var s = currNode.xml;
var r = /\&lt;([^>\s]/<em>?)[^>]/</em>?>([^\&lt;]/*?)\&lt;\/\1>/
var b = s.replace(r,&quot;$2&quot;);
alert(b);
//--&gt;
</SCRIPT>
//mergeAttributes 复制所有读/写标签属性到指定元素。</p>
<p><SCRIPT>
function fnMerge(){
oSource.children[1].mergeAttributes(oSource.children[0]);
}
</SCRIPT></p>
<p><SPAN ID=oSource></p>
<p><DIV
ID="oDiv"
ATTRIBUTE1="true"
ATTRIBUTE2="true"
onclick="alert('click');"
onmouseover="this.style.color='/#0000FF';"
onmouseout="this.style.color='/#000000';"
>
This is a sample <B>DIV</B> element.
</DIV></p>
<p><DIV ID="oDiv2">
This is another sample <B>DIV</B> element.
</DIV>
</SPAN></p>
<INPUT
TYPE="button"
VALUE="Merge Attributes"
onclick="fnMerge()"
>

<ul>
<li>16:38</li>
<li>浏览 (76)</li>
<li><a href="http://hainanhaian.javaeye.com/blog/260844#comments" target="_blank">评论</a> (0)</li>
<li>分类: <a href="http://hainanhaian.javaeye.com/category/42379" target="_blank">web</a></li>
<li><a href="http://app.javaeye.com/links?user_favorite%5Btitle%5D=javascript%E5%B8%B8%E7%94%A8%E5%B0%8F%E6%8A%80%E5%B7%A7&amp;user_favorite%5Burl%5D=http%3A%2F%2Fhainanhaian.javaeye.com%2Fblog%2F260844" target="_blank">收藏</a></li>
<li><a href="http://www.javaeye.com/wiki/topic/260844" target="_blank">相关推荐</a><h3 id="-">评论</h3>
</li>
</ul>
<p><a href=""></a></p>
<h3 id="-">发表评论</h3>
<p>(快捷键 Alt+S / Ctrl+Enter)</p>
<p><a href="http://hainanhaian.javaeye.com/" target="_blank"><img src="&quot;hainanhaian的博客: 新空气&quot;" alt="hainanhaian的博客"></a></p>
<p>hainanhaian</p>
<ul>
<li>浏览: 6481 次</li>
<li>性别: <img src="&quot;男&quot;" alt="Icon_minigender_1"></li>
<li>来自: 南京</li>
<li><img src="" alt=""></li>
<li><a href="http://hainanhaian.javaeye.com/blog/profile" target="_blank">详细资料</a> <a href="http://hainanhaian.javaeye.com/blog/guest_book" target="_blank">留言簿</a></li>
<li><a href="http://app.javaeye.com/messages/new?message%5Breceiver_name%5D=hainanhaian" title="发送站内短信" target="_blank">发短消息</a> <a href="http://app.javaeye.com/feed?subscription%5Bsubscribed_user_name%5D=hainanhaian" target="_blank">订阅</a></li>
</ul>
<h3 id="-">搜索本博客</h3>
<h3 id="-http-hainanhaian-javaeye-com-blog-user_visits-">最近访客 <a href="http://hainanhaian.javaeye.com/blog/user_visits" target="_blank">&gt;&gt;更多访客</a></h3>
<p><a href="http://jywv.javaeye.com/" target="_blank"><img src="&quot;jywv的博客: jywv&quot;" alt="jywv的博客"></a></p>
<p><a href="http://jywv.javaeye.com/" target="_blank">jywv</a></p>
<p><a href="http://shjavaer.javaeye.com/" target="_blank"><img src="&quot;shjavaer的博客: &quot;" alt="shjavaer的博客"></a></p>
<p><a href="http://shjavaer.javaeye.com/" target="_blank">shjavaer</a>
<a href="http://angus---yeah-net.javaeye.com/" target="_blank"><img src="&quot;那份安静的博客: &quot;" alt="那份安静的博客"></a></p>
<p><a href="http://angus---yeah-net.javaeye.com/" target="_blank">那份安静</a></p>
<p><a href="http://migrator.javaeye.com/" target="_blank"><img src="&quot;Migrator的博客: &quot;" alt="Migrator的博客"></a></p>
<p><a href="http://migrator.javaeye.com/" target="_blank">Migrator</a></p>
<h3 id="-">博客分类</h3>
<ul>
<li><a href="http://hainanhaian.javaeye.com/" target="_blank">全部博客 (19)</a></li>
<li><a href="http://hainanhaian.javaeye.com/category/42202" target="_blank">java (8)</a></li>
<li><a href="http://hainanhaian.javaeye.com/category/42318" target="_blank">E (4)</a></li>
<li><a href="http://hainanhaian.javaeye.com/category/42379" target="_blank">web (5)</a></li>
<li><p><a href="http://hainanhaian.javaeye.com/category/42440" target="_blank">arithmetic (1)</a></p>
<h3 id="-">其他分类</h3>
</li>
<li><p><a href="http://hainanhaian.javaeye.com/blog/favorite" target="_blank">我的收藏</a> (42)</p>
</li>
<li><a href="http://hainanhaian.javaeye.com/blog/forum" target="_blank">我的论坛帖子</a> (10)</li>
<li><a href="http://hainanhaian.javaeye.com/blog/article" target="_blank">我的精华良好贴</a> (0)</li>
</ul>
<h3 id="-">最近加入圈子</h3>
<ul>
<li><a href="http://css.group.javaeye.com/" target="_blank">CSS探讨</a></li>
<li><a href="http://english.group.javaeye.com/" target="_blank">英语学习</a></li>
<li><p><a href="http://wfp.group.javaeye.com/" target="_blank">函数式编程の道</a></p>
<h3 id="-">链接</h3>
</li>
<li><p><a href="http://www.newairbbs.cn/" target="_blank">新空气bbs</a></p>
</li>
</ul>
<h3 id="-">存档</h3>
<ul>
<li><a href="http://hainanhaian.javaeye.com/blog/monthblog/2009-01" target="_blank">2009-01</a> (1)</li>
<li><a href="http://hainanhaian.javaeye.com/blog/monthblog/2008-11" target="_blank">2008-11</a> (3)</li>
<li><a href="http://hainanhaian.javaeye.com/blog/monthblog/2008-10" target="_blank">2008-10</a> (11)</li>
<li><p><a href="http://hainanhaian.javaeye.com/blog/monthblog_more" target="_blank">更多存档...</a></p>
<h3 id="-">最新评论</h3>
</li>
<li><p><a href="http://hainanhaian.javaeye.com/blog/248515#comments" title="Javascript中最常用的55个经典技巧" target="_blank">Javascript中最常用的55个 ...</a>
经典可以谈得上，但是建议“常用”换成“鲜为人知”、“实用”
-- by <a href="http://walkman.javaeye.com/" target="_blank">walkman</a></p>
</li>
<li><a href="http://hainanhaian.javaeye.com/blog/248219#comments" title="程序员谈如何掌握计算机专业英语" target="_blank">程序员谈如何掌握计算机专 ...</a>
dayang2001911 写道我现在正在读《design patterns》深 ...
-- by <a href="http://hainanhaian.javaeye.com/" target="_blank">hainanhaian</a></li>
<li><a href="http://hainanhaian.javaeye.com/blog/248219#comments" title="程序员谈如何掌握计算机专业英语" target="_blank">程序员谈如何掌握计算机专 ...</a>
我现在正在读《design patterns》深入浅出版的，影印版，英语通俗易懂， ...
-- by <a href="http://dayang2001911.javaeye.com/" target="_blank">dayang2001911</a></li>
</ul>
<h3 id="-">评论排行榜</h3>
<ul>
<li><a href="http://hainanhaian.javaeye.com/blog/256008" title="java,jsp获取网页源码内容的三种代码方法" target="_blank">java,jsp获取网页源码内容的三种代码方法</a></li>
<li><a href="http://hainanhaian.javaeye.com/blog/318576" title="ANT十五大最佳实践" target="_blank">ANT十五大最佳实践</a></li>
<li><a href="http://hainanhaian.javaeye.com/blog/266896" title="Servlet上传文件打水印生成缩略图" target="_blank">Servlet上传文件打水印生成缩略图</a></li>
<li><a href="http://hainanhaian.javaeye.com/blog/274092" title="JAVA 如何创建\删除\修改\复制目录及文件" target="_blank">JAVA 如何创建\删除\修改\复制目录及文 ...</a></li>
<li><a href="http://hainanhaian.javaeye.com/blog/260844" title="javascript常用小技巧" target="_blank">javascript常用小技巧</a></li>
<li><a href="http://hainanhaian.javaeye.com/rss" target="_blank"><img src="" alt="Rss"></a></li>
<li><a href="http://fusion.google.com/add?feedurl=http://hainanhaian.javaeye.com/rss" target="_blank"><img src="" alt="Rss_google"></a></li>
<li><a href="http://www.zhuaxia.com/add_channel.php?url=http://hainanhaian.javaeye.com/rss" target="_blank"><img src="" alt="Rss_zhuaxia"></a></li>
<li><a href="http://www.xianguo.com/subscribe.php?url=http://hainanhaian.javaeye.com/rss" target="_blank"><img src="" alt="Rss_xianguo"></a></li>
<li><a href="http://www.google.com/search?hl=zh-CN&amp;q=RSS" target="_blank">[什么是RSS?]</a>
声明：JavaEye文章版权属于作者，受法律保护。没有作者书面许可不得转载。若作者同意转载，必须以超链接形式标明文章原始出处和作者。
© 2003-2009 JavaEye.com. All rights reserved. 上海炯耐计算机软件有限公司 [ 沪ICP备05023328号 ]
<a href="http://hainanhaian.javaeye.com/blog/260844#" target="_blank">说点啥吧 <img src="" alt="Chat"></a></li>
</ul>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/JS用法/">JS用法</a></li></span></span> | <span class="tags">Tagged <a href="/tags/JS用法/" class="label label-primary">JS用法</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:28"datetime="2014-03-07 09:54:28"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-JS用法--javascript常用小技巧/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-JS用法--javascript常用小技巧" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-JS用法--一个javascriptvoid0引发的异常-Tech-JavaEye论坛/">一个javascriptvoid(0)引发的异常 </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:28.000Z"> <a href="/2014/02/02/2014-02-02-JS用法--一个javascriptvoid0引发的异常-Tech-JavaEye论坛/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-javascriptvoid-0-tech-javaeye-">一个javascriptvoid(0)引发的异常 - Tech - JavaEye论坛</h1>
<p><a href="http://www.javaeye.com/login" title="登录" target="_blank">您还未登录 !</a> <a href="http://www.javaeye.com/all" target="_blank">我的应用</a> <a href="http://www.javaeye.com/login" target="_blank">登录</a> <a href="http://www.javaeye.com/signup" target="_blank">注册</a></p>
<p><a href="http://www.javaeye.com/" target="_blank"><img src="&quot;JavaEye-最棒的软件开发交流社区&quot;" alt="JavaEye-最棒的软件开发交流社区"></a></p>
<p><img src="" alt=""></p>
<p><a href="http://www.javaeye.com/forums" target="_blank">论坛首页</a> → <a href="http://www.javaeye.com/forums/board/Tech" target="_blank">综合技术版</a> →</p>
<h1 id="-javascript-void-0-">一个javascript:void(0)引发的异常</h1>
<p><a href="http://www.javaeye.com/forums/board/Tech" target="_blank">全部</a> <a href="http://www.javaeye.com/forums/tag/Database" target="_blank">Database</a> <a href="http://www.javaeye.com/forums/tag/Haskell" target="_blank">Haskell</a> <a href="http://www.javaeye.com/forums/tag/Erlang" target="_blank">Erlang</a> <a href="http://www.javaeye.com/forums/tag/FP" target="_blank">FP</a> <a href="http://www.javaeye.com/forums/tag/Linux" target="_blank">Linux</a> <a href="http://www.javaeye.com/forums/tag/algorithm" target="_blank">数据结构和算法</a>
浏览 567 次 锁定老贴子 <a href="http://www.javaeye.com/topic/290261" target="_blank">主题：一个javascript:void(0)引发的异常</a></p>
<p>精华帖 (0) :: 良好帖 (0) :: 新手帖 (0) :: 隐藏帖 (0) 作者 正文 * classicbride</p>
<ul>
<li>等级: 初级会员</li>
<li><a href="http://classicbride.javaeye.com/" target="_blank"><img src="&quot;classicbride的博客: classicbride&quot;" alt="classicbride的博客"></a></li>
<li>文章: 41</li>
<li>积分: 30</li>
<li>来自: 北京</li>
<li><img src="" alt="">
发表时间：2008-12-10</li>
</ul>
<p>相关文章: <a href="http://www.javaeye.com/topic/290261#" title="关闭" target="_blank"> </a></p>
<ul>
<li><a href="http://www.javaeye.com/topic/214030" title="Broken pipe　/  socket write error异常" target="_blank">Broken pipe　/ socket write error异常</a></li>
<li><a href="http://www.javaeye.com/topic/31800" title="ClientAbortException原因探究" target="_blank">ClientAbortException原因探究</a></li>
<li><a href="http://www.javaeye.com/topic/10392" title="确实冤枉好同志了" target="_blank">确实冤枉好同志了</a>
推荐圈子: <a href="http://jsfgroup.group.javaeye.com/" target="_blank">JSF</a>
<a href="http://www.javaeye.com/wiki/topic/290261" target="_blank">更多相关推荐</a>  当用户登陆时，需要用户输入验证码，在服务器端生成一张内存图像，写入response流中...
当用户点击“看不清楚，换成图片”时，利用javascript重新请求服务器端，生成新的图像... 到了这里万事大吉一切正常，在firefox下，IE7下都没有问题，但是在IE6下问题来了，无法刷新验证码，后台报错：
ClientAbortException:  java.net.SocketException: Connection reset by peer: socket write error
at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:319)
at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:288)
at org.apache.catalina.connector.CoyoteOutputStream.flush(CoyoteOutputStream.java:98)
at javax.imageio.stream.FileCacheImageOutputStream.flushBefore(FileCacheImageOutputStream.java:212)
at javax.imageio.stream.ImageInputStreamImpl.flush(ImageInputStreamImpl.java:801)
at com.sun.imageio.plugins.jpeg.JPEGImageWriter.write(JPEGImageWriter.java:1002)
google半天，说法很多，有说是因为服务器端数据没有写完时，客户端就停止了引发的... 但一直找不到问题的根本原因，继续google，终于找到原因，首先看看偶的代码
<img id="codeImage" src="validateCode.action" border="0" /> <a id="getValidateCode" href="javascript:void(0);">重新获得验证码</a>
function flashValidateCode(){ var randomStr = random(); $(&quot;/#codeImage&quot;).get(0).src = &quot;validateCode.action?randomStr=&quot; + randomStr; } function random(){ return Math.round(Math.random() /* 10000); }
当用户有点击重新获取验证码时，我监听一个onclick事件，请求服务器生成新的图像，而我又写了href=&quot;javascript:void(0);&quot;
对了，问题就出在javascript:void(0)，<a></a>本身是一个超链接，它一个接受到了void(0)，就认为请求处理完毕了，垃圾IE6就停止了对服务器端的响应，就造成了上述的问题，所以将代码改成：
<img id="codeImage" src="validateCode.action" border="0" /> <a id="getValidateCode" href="/#">重新获得验证码</a>
就o了~ 吼吼~ 这个小问题折磨我很久，日~！！ 
声明：JavaEye文章版权属于作者，受法律保护。没有作者书面许可不得转载。</li>
</ul>
<p>推荐链接</p>
<ul>
<li><a href="http://www.javaeye.com/clicks/111" target="_blank"><img src="&quot;taobao，赢在淘宝&quot;" alt="taobao，赢在淘宝"></a> <a href="http://www.javaeye.com/topic/290261#" target="_blank">返回顶楼</a> <a href="http://classicbride.javaeye.com/" title="浏览作者的博客" target="_blank"> </a> <a href="http://classicbride.javaeye.com/blog/profile" title="浏览作者资料" target="_blank"> </a> <a href="http://app.javaeye.com/messages/new?message%5Breceiver_name%5D=classicbride" title="发送站内短信" target="_blank"> </a> <a href="http://classicbride.javaeye.com/blog/guest_book" title="给作者留言" target="_blank"> </a> 最后修改：2008-12-10</li>
</ul>
<p><a href="http://www.javaeye.com/forums" target="_blank">论坛首页</a> → <a href="http://www.javaeye.com/forums/board/Tech" target="_blank">综合技术版</a>
跳转论坛:Java编程和Java企业应用 Web前端技术：AJAX和RIA 移动编程和手机应用开发 C/C++编程 Ruby编程 Python编程 PHP编程 Flash编程 Microsoft .Net 综合技术 软件开发和项目管理 行业应用 入门讨论 招聘求职 海阔天空</p>
<ul>
<li><a href="http://www.javaeye.com/" target="_blank">首页</a></li>
<li><a href="http://www.javaeye.com/news" target="_blank">新闻</a></li>
<li><a href="http://www.javaeye.com/forums" target="_blank">论坛</a></li>
<li><a href="http://www.javaeye.com/ask" target="_blank">问答</a></li>
<li><a href="http://www.javaeye.com/wiki" target="_blank">知识库</a></li>
<li><a href="http://www.javaeye.com/blogs" target="_blank">博客</a></li>
<li><a href="http://www.javaeye.com/groups" target="_blank">圈子</a></li>
<li><a href="http://www.javaeye.com/hunters" target="_blank">猎头</a></li>
<li><a href="http://www.javaeye.com/job" target="_blank">招聘</a></li>
<li><a href="http://www.javaeye.com/index/service" target="_blank">服务</a></li>
<li><a href="http://www.javaeye.com/google_search" target="_blank">搜索</a></li>
<li><a href="http://java.javaeye.com/" target="_blank">Java</a></li>
<li><a href="http://webapp.javaeye.com/" target="_blank">Web</a></li>
<li><a href="http://ruby.javaeye.com/" target="_blank">Ruby</a></li>
<li><a href="http://python.javaeye.com/" target="_blank">Python</a></li>
<li><a href="http://agile.javaeye.com/" target="_blank">敏捷</a></li>
<li><a href="http://mysql.javaeye.com/" target="_blank">MySQL</a></li>
<li><a href="http://primeton.javaeye.com/" target="_blank">普元</a></li>
<li><a href="http://dorado.javaeye.com/" target="_blank">Dorado</a></li>
<li><a href="http://kingdee.javaeye.com/" target="_blank">金蝶中间件</a></li>
<li><a href="http://book.javaeye.com/" target="_blank">图书</a></li>
<li><a href="http://www.javaeye.com/index/service" target="_blank">广告服务</a></li>
<li><a href="http://webmaster.javaeye.com/" target="_blank">JavaEye黑板报</a></li>
<li><a href="http://www.javaeye.com/index/aboutus" target="_blank">关于我们</a></li>
<li><a href="http://www.javaeye.com/index/contactus" target="_blank">联系我们</a></li>
<li><a href="http://www.javaeye.com/index/friend_links" target="_blank">友情链接</a></li>
</ul>
<p>© 2003-2009 JavaEye.com. All rights reserved. [ 沪ICP备05023328号 ]</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/JS用法/">JS用法</a></li></span></span> | <span class="tags">Tagged <a href="/tags/JS用法/" class="label label-primary">JS用法</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:28"datetime="2014-03-07 09:54:28"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-JS用法--一个javascriptvoid0引发的异常-Tech-JavaEye论坛/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-JS用法--一个javascriptvoid0引发的异常-Tech-JavaEye论坛" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-lucene--Lucene学习总结之一：全文检索的基本原理/">Lucene学习总结之一：全文检索的基本原理</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:28.000Z"> <a href="/2014/02/02/2014-02-02-lucene--Lucene学习总结之一：全文检索的基本原理/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="lucene-">Lucene学习总结之一：全文检索的基本原理</h1>
<h2 id="-">一、总论</h2>
<p>根据<a href="http://lucene.apache.org/java/docs/index.html" target="_blank"><a href="http://lucene.apache.org/java/docs/index.html">http://lucene.apache.org/java/docs/index.html</a></a>定义：</p>
<p><strong>Lucene**</strong>是一个高效的，基于Java<strong>**的全文检索库。</strong></p>
<p>所以在了解Lucene之前要费一番工夫了解一下全文检索。</p>
<p>那么什么叫做全文检索呢？这要从我们生活中的数据说起。</p>
<p>我们生活中的数据总体分为两种：<strong>结构化数据</strong>和<strong>非结构化数据</strong>。</p>
<ul>
<li><strong>结构化数据：</strong>指具有固定格式或有限长度的数据，如数据库，元数据等。</li>
<li><strong>非结构化数据：</strong>指不定长或无固定格式的数据，如邮件，word文档等。</li>
</ul>
<p>当然有的地方还会提到第三种，半结构化数据，如XML，HTML等，当根据需要可按结构化数据来处理，也可抽取出纯文本按非结构化数据来处理。</p>
<p><strong>非结构化数据又一种叫法叫全文数据。</strong></p>
<hr>
<p>按照数据的分类，搜索也分为两种：</p>
<ul>
<li><strong>对结构化数据的搜索</strong>：如对数据库的搜索，用SQL语句。再如对元数据的搜索，如利用windows搜索对文件名，类型，修改时间进行搜索等。</li>
<li><strong>对非结构化数据的搜索</strong>：如利用windows的搜索也可以搜索文件内容，Linux下的grep命令，再如用Google和百度可以搜索大量内容数据。</li>
</ul>
<p>对非结构化数据也即对全文数据的搜索主要有两种方法：</p>
<p>一种是<strong>顺序扫描法**</strong>(Serial Scanning)：**所谓顺序扫描，比如要找内容包含某一个字符串的文件，就是一个文档一个文档的看，对于每一个文档，从头看到尾，如果此文档包含此字符串，则此文档为我们要找的文件，接着看下一个文件，直到扫描完所有的文件。如利用windows的搜索也可以搜索文件内容，只是相当的慢。如果你有一个80G硬盘，如果想在上面找到一个内容包含某字符串的文件，不花他几个小时，怕是做不到。Linux下的grep命令也是这一种方式。大家可能觉得这种方法比较原始，但对于小数据量的文件，这种方法还是最直接，最方便的。但是对于大量的文件，这种方法就很慢了。</p>
<p>有人可能会说，对非结构化数据顺序扫描很慢，对结构化数据的搜索却相对较快（由于结构化数据有一定的结构可以采取一定的搜索算法加快速度），那么把我们的非结构化数据想办法弄得有一定结构不就行了吗？</p>
<p>这种想法很天然，却构成了全文检索的基本思路，也即将非结构化数据中的一部分信息提取出来，重新组织，使其变得有一定结构，然后对此有一定结构的数据进行搜索，从而达到搜索相对较快的目的。</p>
<p>这部分从非结构化数据中提取出的然后重新组织的信息，我们称之<strong>索引</strong>。</p>
<p>这种说法比较抽象，举几个例子就很容易明白，比如字典，字典的拼音表和部首检字表就相当于字典的索引，对每一个字的解释是非结构化的，如果字典没有音节表和部首检字表，在茫茫辞海中找一个字只能顺序扫描。然而字的某些信息可以提取出来进行结构化处理，比如读音，就比较结构化，分声母和韵母，分别只有几种可以一一列举，于是将读音拿出来按一定的顺序排列，每一项读音都指向此字的详细解释的页数。我们搜索时按结构化的拼音搜到读音，然后按其指向的页数，便可找到我们的非结构化数据——也即对字的解释。</p>
<hr>
<p><strong>这种先建立索引，再对索引进行搜索的过程就叫全文检索(Full-text Search)**</strong>。**</p>
<hr>
<p>下面这幅图来自《Lucene in action》，但却不仅仅描述了Lucene的检索过程，而是描述了全文检索的一般过程。</p>
<p><a href="http://images.cnblogs.com/cnblogs_com/forfuture1978/WindowsLiveWriter/185c4e9316f3_147FA/image_2.png" target="_blank"><img src="&quot;image&quot;" alt="image"></a></p>
<p>全文检索大体分两个过程，<strong>索引创建**</strong>(Indexing)<strong>和</strong>搜索索引<strong>**(Search)</strong>。</p>
<ul>
<li>索引创建：将现实世界中所有的结构化和非结构化数据提取信息，创建索引的过程。</li>
<li>搜索索引：就是得到用户的查询请求，搜索创建的索引，然后返回结果的过程。</li>
</ul>
<p>于是全文检索就存在三个重要问题：</p>
<p><strong>1.**</strong>索引里面究竟存些什么？(Index)**</p>
<p><strong>2.**</strong>如何创建索引？(Indexing)**</p>
<p><strong>3.**</strong>如何对索引进行搜索？(Search)**</p>
<p>下面我们顺序对每个个问题进行研究。</p>
<h2 id="-">二、索引里面究竟存些什么</h2>
<p>索引里面究竟需要存些什么呢？</p>
<p>首先我们来看为什么顺序扫描的速度慢：</p>
<p>其实是由于我们想要搜索的信息和非结构化数据中所存储的信息不一致造成的。</p>
<p>非结构化数据中所存储的信息是每个文件包含哪些字符串，也即已知文件，欲求字符串相对容易，也即是从文件到字符串的映射。而我们想搜索的信息是哪些文件包含此字符串，也即已知字符串，欲求文件，也即从字符串到文件的映射。两者恰恰相反。于是如果索引总能够保存从字符串到文件的映射，则会大大提高搜索速度。</p>
<p>由于从字符串到文件的映射是文件到字符串映射的反向过程，于是保存这种信息的索引称为<strong>反向索引</strong>。</p>
<p>反向索引的所保存的信息一般如下：</p>
<p>假设我的文档集合里面有100篇文档，为了方便表示，我们为文档编号从1到100，得到下面的结构</p>
<p><a href="http://images.cnblogs.com/cnblogs_com/forfuture1978/WindowsLiveWriter/185c4e9316f3_147FA/inverted%20index_2.jpg" target="_blank"><img src="&quot;inverted index&quot;" alt="inverted index"></a></p>
<p>左边保存的是一系列字符串，称为<strong>词典</strong>。</p>
<p>每个字符串都指向包含此字符串的文档(Document)链表，此文档链表称为<strong>倒排表</strong>(Posting List)。</p>
<p>有了索引，便使保存的信息和要搜索的信息一致，可以大大加快搜索的速度。</p>
<p>比如说，我们要寻找既包含字符串“lucene”又包含字符串“solr”的文档，我们只需要以下几步：</p>
<ol>
<li><p>取出包含字符串“lucene”的文档链表。</p>
</li>
<li><p>取出包含字符串“solr”的文档链表。</p>
</li>
<li><p>通过合并链表，找出既包含“lucene”又包含“solr”的文件。</p>
</li>
</ol>
<p><a href="http://images.cnblogs.com/cnblogs_com/forfuture1978/WindowsLiveWriter/185c4e9316f3_147FA/inverted%20index%20merge_2.jpg" target="_blank"><img src="&quot;inverted index merge&quot;" alt="inverted index merge"></a></p>
<p>看到这个地方，有人可能会说，全文检索的确加快了搜索的速度，但是多了索引的过程，两者加起来不一定比顺序扫描快多少。的确，加上索引的过程，全文检索不一定比顺序扫描快，尤其是在数据量小的时候更是如此。而对一个很大量的数据创建索引也是一个很慢的过程。</p>
<p>然而两者还是有区别的，顺序扫描是每次都要扫描，而创建索引的过程仅仅需要一次，以后便是一劳永逸的了，每次搜索，创建索引的过程不必经过，仅仅搜索创建好的索引就可以了。</p>
<p><strong>这也是全文搜索相对于顺序扫描的优势之一：一次索引，多次使用。</strong></p>
<h2 id="-">三、如何创建索引</h2>
<p>全文检索的索引创建过程一般有以下几步：</p>
<h3 id="-document-"><strong>第一步：一些要索引的原文档(Document)。</strong></h3>
<p>为了方便说明索引创建过程，这里特意用两个文件为例：</p>
<p>文件一：Students should be allowed to go out with their friends, but not allowed to drink beer.</p>
<p>文件二：My friend Jerry went to school to see his students but found them drunk which is not allowed.</p>
<h3 id="-tokenizer-"><strong>第二步：将原文档传给分次组件(Tokenizer)。</strong></h3>
<p><strong>分词组件(Tokenizer)会做以下几件事情(**</strong>此过程称为Tokenize)<strong>**：</strong></p>
<p><strong>1.**</strong>将文档分成一个一个单独的单词。**</p>
<p><strong>2.**</strong>去除标点符号。**</p>
<p><strong>3.**</strong>去除停词(Stop word)<strong>**。</strong></p>
<p>所谓停词(Stop word)就是一种语言中最普通的一些单词，由于没有特别的意义，因而大多数情况下不能成为搜索的关键词，因而创建索引时，这种词会被去掉而减少索引的大小。</p>
<p>英语中挺词(Stop word)如：“the”,“a”，“this”等。</p>
<p>对于每一种语言的分词组件(Tokenizer)，都有一个停词(stop word)集合。</p>
<hr>
<p><strong>经过分词(Tokenizer)**</strong>后得到的结果称为词元(Token)<strong>**。</strong></p>
<p>在我们的例子中，便得到以下词元(Token)：</p>
<p>“Students”，“allowed”，“go”，“their”，“friends”，“allowed”，“drink”，“beer”，“My”，“friend”，“Jerry”，“went”，“school”，“see”，“his”，“students”，“found”，“them”，“drunk”，“allowed”。</p>
<h3 id="-token-linguistic-processor-"><strong>第三步：将得到的词元(Token)传给语言处理组件(Linguistic Processor)。</strong></h3>
<p>语言处理组件(linguistic processor)主要是对得到的词元(Token)做一些同语言相关的处理。</p>
<p><strong>对于英语，语言处理组件(Linguistic Processor)**</strong>一般做以下几点：**</p>
<p><strong>1.**</strong>变为小写(Lowercase)<strong>**。</strong></p>
<p><strong>2.**</strong>将单词缩减为词根形式，如“cars<strong><strong>”到“car</strong></strong>”等。这种操作称为：stemming<strong>**。</strong></p>
<p><strong>3.**</strong>将单词转变为词根形式，如“drove<strong><strong>”到“drive</strong></strong>”等。这种操作称为：lemmatization<strong>**。</strong></p>
<p><strong>Stemming 和 lemmatization的异同：</strong></p>
<ul>
<li>相同之处：Stemming和lemmatization都要使词汇成为词根形式。</li>
<li><p>两者的方式不同：</p>
</li>
<li><p>Stemming采用的是“缩减”的方式：“cars”到“car”，“driving”到“drive”。</p>
</li>
<li>Lemmatization采用的是“转变”的方式：“drove”到“drove”，“driving”到“drive”。</li>
<li><p>两者的算法不同：</p>
</li>
<li><p>Stemming主要是采取某种固定的算法来做这种缩减，如去除“s”，去除“ing”加“e”，将“ational”变为“ate”，将“tional”变为“tion”。</p>
</li>
<li>Lemmatization主要是采用保存某种字典的方式做这种转变。比如字典中有“driving”到“drive”，“drove”到“drive”，“am, is, are”到“be”的映射，做转变时，只要查字典就可以了。</li>
<li>Stemming和lemmatization不是互斥关系，是有交集的，有的词利用这两种方式都能达到相同的转换。</li>
</ul>
<hr>
<p><strong>语言处理组件(linguistic processor)的结果称为词(Term)**</strong>。**</p>
<p>在我们的例子中，经过语言处理，得到的词(Term)如下：</p>
<p>“student”，“allow”，“go”，“their”，“friend”，“allow”，“drink”，“beer”，“my”，“friend”，“jerry”，“go”，“school”，“see”，“his”，“student”，“find”，“them”，“drink”，“allow”。</p>
<p>也正是因为有语言处理的步骤，才能使搜索drove，而drive也能被搜索出来。</p>
<h3 id="-term-indexer-"><strong>第四步：将得到的词(Term)传给索引组件(Indexer)。</strong></h3>
<p><strong>索引**</strong>组件(Indexer)主要做以下几件事情：**</p>
<p><strong>1. 利用得到的词(Term)创建一个字典。</strong></p>
<p>在我们的例子中字典如下：
Term Document ID student 1 allow 1 go 1 their 1 friend 1 allow 1 drink 1 beer 1 my 2 friend 2 jerry 2 go 2 school 2 see 2 his 2 student 2 find 2 them 2 drink 2 allow 2</p>
<p><strong>2.**</strong>对字典按字母顺序进行排序。**</p>
<p>Term Document ID allow 1 allow 1 allow 2 beer 1 drink 1 drink 2 find 2 friend 1 friend 2 go 1 go 2 his 2 jerry 2 my 2 school 2 see 2 student 1 student 2 their 1 them 2</p>
<hr>
<p><strong>3.**</strong>合并相同的词(Term)<strong><strong>成为文档倒排(Posting List)</strong></strong>链表。**</p>
<p><a href="http://images.cnblogs.com/cnblogs_com/forfuture1978/WindowsLiveWriter/185c4e9316f3_147FA/postinglist_2.jpg" target="_blank"><img src="&quot;postinglist&quot;" alt="postinglist"></a></p>
<p>在此表中，有几个定义：</p>
<ul>
<li>Document Frequency 即文档频次，表示总共有多少文件包含此词(Term)。</li>
<li>Frequency 即词频率，表示此文件中包含了几个此词(Term)。</li>
</ul>
<p>所以对词(Term) “allow”来讲，总共有两篇文档包含此词(Term)，从而词(Term)后面的文档链表总共有两项，第一项表示包含“allow”的第一篇文档，即1号文档，此文档中，“allow”出现了2次，第二项表示包含“allow”的第二个文档，是2号文档，此文档中，“allow”出现了1次。</p>
<p>到此为止，索引已经创建好了，我们可以通过它很快的找到我们想要的文档。</p>
<p>而且在此过程中，我们惊喜地发现，搜索“drive”，“driving”，“drove”，“driven”也能够被搜到。因为在我们的索引中，“driving”，“drove”，“driven”都会经过语言处理而变成“drive”，在搜索时，如果您输入“driving”，输入的查询语句同样经过我们这里的一到三步，从而变为查询“drive”，从而可以搜索到想要的文档。</p>
<h2 id="-">三、如何对索引进行搜索？</h2>
<p>到这里似乎我们可以宣布“我们找到想要的文档了”。</p>
<p>然而事情并没有结束，找到了仅仅是全文检索的一个方面。不是吗？如果仅仅只有一个或十个文档包含我们查询的字符串，我们的确找到了。然而如果结果有一千个，甚至成千上万个呢？那个又是您最想要的文件呢？</p>
<p>打开Google吧，比如说您想在微软找份工作，于是您输入“Microsoft job”，您却发现总共有22600000个结果返回。好大的数字呀，突然发现找不到是一个问题，找到的太多也是一个问题。在如此多的结果中，如何将最相关的放在最前面呢？</p>
<p><a href="&quot;clip_image002[4]&quot;">![clip_image002[4]</a>](<a href="http://images.cnblogs.com/cnblogs_com/forfuture1978/WindowsLiveWriter/185c4e9316f3_147FA/clip_image0024.jpg" target="_blank">http://images.cnblogs.com/cnblogs_com/forfuture1978/WindowsLiveWriter/185c4e9316f3_147FA/clip_image0024.jpg</a>)</p>
<p>当然Google做的很不错，您一下就找到了jobs at Microsoft。想象一下，如果前几个全部是“Microsoft does a good job at software industry…”将是多么可怕的事情呀。</p>
<p>如何像Google一样，在成千上万的搜索结果中，找到和查询语句最相关的呢？</p>
<p>如何判断搜索出的文档和查询语句的相关性呢？</p>
<p>这要回到我们第三个问题：如何对索引进行搜索？</p>
<p>搜索主要分为以下几步：</p>
<h3 id="-"><strong>第一步：用户输入查询语句。</strong></h3>
<p>查询语句同我们普通的语言一样，也是有一定语法的。</p>
<p>不同的查询语句有不同的语法，如SQL语句就有一定的语法。</p>
<p>查询语句的语法根据全文检索系统的实现而不同。最基本的有比如：AND, OR, NOT等。</p>
<p>举个例子，用户输入语句：lucene AND learned NOT hadoop。</p>
<p>说明用户想找一个包含lucene和learned然而不包括hadoop的文档。</p>
<h3 id="-"><strong>第二步：对查询语句进行词法分析，语法分析，及语言处理。</strong></h3>
<p>由于查询语句有语法，因而也要进行语法分析，语法分析及语言处理。</p>
<p><strong>1. 词法分析主要用来识别单词和关键字。</strong></p>
<p>如上述例子中，经过词法分析，得到单词有lucene，learned，hadoop, 关键字有AND, NOT。</p>
<p>如果在词法分析中发现不合法的关键字，则会出现错误。如lucene AMD learned，其中由于AND拼错，导致AMD作为一个普通的单词参与查询。</p>
<p><strong>2. 语法分析主要是根据查询语句的语法规则来形成一棵语法树。</strong></p>
<p>如果发现查询语句不满足语法规则，则会报错。如lucene NOT AND learned，则会出错。</p>
<p>如上述例子，lucene AND learned NOT hadoop形成的语法树如下：</p>
<p><a href="http://images.cnblogs.com/cnblogs_com/forfuture1978/WindowsLiveWriter/185c4e9316f3_147FA/%E8%AF%AD%E6%B3%95%E6%A0%91_2.jpg" target="_blank"><img src="&quot;语法树&quot;" alt="语法树"></a></p>
<p><strong>3. 语言处理同索引过程中的语言处理几乎相同。</strong></p>
<p>如learned变成learn等。</p>
<p>经过第二步，我们得到一棵经过语言处理的语法树。</p>
<p><a href="http://images.cnblogs.com/cnblogs_com/forfuture1978/WindowsLiveWriter/185c4e9316f3_147FA/%E8%AF%AD%E6%B3%95%E6%A0%911_2.jpg" target="_blank"><img src="&quot;语法树1&quot;" alt="语法树1"></a></p>
<h3 id="-"><strong>第三步：搜索索引，得到符合语法树的文档。</strong></h3>
<p>此步骤有分几小步：</p>
<ol>
<li>首先，在反向索引表中，分别找出包含lucene，learn，hadoop的文档链表。<em>**</em></li>
<li>其次，对包含lucene，learn的链表进行合并操作，得到既包含lucene又包含learn的文档链表。<em>**</em></li>
<li>然后，将此链表与hadoop的文档链表进行差操作，去除包含hadoop的文档，从而得到既包含lucene又包含learn而且不包含hadoop的文档链表。<em>**</em></li>
<li>此文档链表就是我们要找的文档。</li>
</ol>
<h3 id="-"><strong>第四步：根据得到的文档和查询语句的相关性，对结果进行排序。</strong></h3>
<p>虽然在上一步，我们得到了想要的文档，然而对于查询结果应该按照与查询语句的相关性进行排序，越相关者越靠前。</p>
<p>如何计算文档和查询语句的相关性呢？</p>
<p>不如我们把查询语句看作一片短小的文档，对文档与文档之间的相关性(relevance)进行打分(scoring)，分数高的相关性好，就应该排在前面。</p>
<p>那么又怎么对文档之间的关系进行打分呢？</p>
<p><strong>这可不是一件容易的事情，首先我们看一看判断人之间的关系吧。</strong></p>
<p><strong>首先</strong>看一个人，往往有很多<strong>要素</strong>，如性格，信仰，爱好，衣着，高矮，胖瘦等等。</p>
<p><strong>其次</strong>对于人与人之间的关系，<strong>不同的要素重要性不同</strong>，性格，信仰，爱好可能重要些，衣着，高矮，胖瘦可能就不那么重要了，所以具有相同或相似性格，信仰，爱好的人比较容易成为好的朋友，然而衣着，高矮，胖瘦不同的人，也可以成为好的朋友。</p>
<p>因而判断人与人之间的关系，<strong>首先要找出哪些要素对人与人之间的关系最重要</strong>，比如性格，信仰，爱好。<strong>其次要判断两个人的这些要素之间的关系</strong>，比如一个人性格开朗，另一个人性格外向，一个人信仰佛教，另一个信仰上帝，一个人爱好打篮球，另一个爱好踢足球。我们发现，两个人在性格方面都很积极，信仰方面都很善良，爱好方面都爱运动，因而两个人关系应该会很好。</p>
<p><strong>我们再来看看公司之间的关系吧。</strong></p>
<p><strong>首先</strong>看一个公司，有很多人组成，如总经理，经理，首席技术官，普通员工，保安，门卫等。</p>
<p><strong>其次对于公司与公司之间的关系，不同的人重要性不同</strong>，总经理，经理，首席技术官可能更重要一些，普通员工，保安，门卫可能较不重要一点。所以如果两个公司总经理，经理，首席技术官之间关系比较好，两个公司容易有比较好的关系。然而一位普通员工就算与另一家公司的一位普通员工有血海深仇，怕也难影响两个公司之间的关系。</p>
<p>因而判断公司与公司之间的关系，<strong>首先要找出哪些人对公司与公司之间的关系最重要</strong>，比如总经理，经理，首席技术官。<strong>其次要判断这些人之间的关系</strong>，不如两家公司的总经理曾经是同学，经理是老乡，首席技术官曾是创业伙伴。我们发现，两家公司无论总经理，经理，首席技术官，关系都很好，因而两家公司关系应该会很好。</p>
<p>分析了两种关系，下面看一下<strong>如何判断文档之间的关系</strong>了。</p>
<p><strong>首先，一个文档有很多词(Term)组成</strong>，如search, lucene, full-text, this, a, what等。</p>
<p><strong>其次对于文档之间的关系，不同的Term重要性不同</strong>，比如对于本篇文档，search, Lucene, full-text就相对重要一些，this, a , what可能相对不重要一些。所以如果两篇文档都包含search, Lucene，fulltext，这两篇文档的相关性好一些，然而就算一篇文档包含this, a, what，另一篇文档不包含this, a, what，也不能影响两篇文档的相关性。</p>
<p>因而判断文档之间的关系，首先找出哪些词(Term)对文档之间的关系最重要，如search, Lucene, fulltext。然后判断这些词(Term)之间的关系。</p>
<p><strong>找出词(Term)**</strong>对文档的重要性的过程称为计算词的权重(Term weight)<strong>**的过程。</strong></p>
<p>计算词的权重(term weight)有两个参数，第一个是词(Term)，第二个是文档(Document)。</p>
<p>词的权重(Term weight)表示此词(Term)在此文档中的重要程度，越重要的词(Term)有越大的权重(Term weight)，因而在计算文档之间的相关性中将发挥更大的作用。</p>
<p><strong>判断词(Term)**</strong>之间的关系从而得到文档相关性的过程应用一种叫做向量空间模型的算法(Vector Space Model)<strong>**。</strong></p>
<hr>
<p>下面仔细分析一下这两个过程：</p>
<h3 id="-1-term-weight-"><strong>1. 计算权重(Term weight)的过程。</strong></h3>
<p>影响一个词(Term)在一篇文档中的重要性主要有两个因素：</p>
<ul>
<li>Term Frequency (tf)：即此Term在此文档中出现了多少次。tf 越大说明越重要。</li>
<li>Document Frequency (df)：即有多少文档包含次Term。df 越大说明越不重要。</li>
</ul>
<p>容易理解吗？词(Term)在文档中出现的次数越多，说明此词(Term)对该文档越重要，如“搜索”这个词，在本文档中出现的次数很多，说明本文档主要就是讲这方面的事的。然而在一篇英语文档中，this出现的次数更多，就说明越重要吗？不是的，这是由第二个因素进行调整，第二个因素说明，有越多的文档包含此词(Term), 说明此词(Term)太普通，不足以区分这些文档，因而重要性越低。</p>
<p>这也如我们程序员所学的技术，对于程序员本身来说，这项技术掌握越深越好（掌握越深说明花时间看的越多，tf越大），找工作时越有竞争力。然而对于所有程序员来说，这项技术懂得的人越少越好（懂得的人少df小），找工作越有竞争力。人的价值在于不可替代性就是这个道理。</p>
<p>道理明白了，我们来看看公式：</p>
<p><a href="http://images.cnblogs.com/cnblogs_com/forfuture1978/WindowsLiveWriter/185c4e9316f3_147FA/image_6.png" target="_blank"><img src="&quot;image&quot;" alt="image"></a></p>
<p><a href="http://images.cnblogs.com/cnblogs_com/forfuture1978/WindowsLiveWriter/185c4e9316f3_147FA/image_4.png" target="_blank"><img src="&quot;image&quot;" alt="image"></a></p>
<p>这仅仅只term weight计算公式的简单典型实现。实现全文检索系统的人会有自己的实现，Lucene就与此稍有不同。</p>
<h3 id="-2-term-vsm-"><strong>2. 判断Term之间的关系从而得到文档相关性的过程，也即向量空间模型的算法(VSM)。</strong></h3>
<p>我们把文档看作一系列词(Term)，每一个词(Term)都有一个权重(Term weight)，不同的词(Term)根据自己在文档中的权重来影响文档相关性的打分计算。</p>
<p>于是我们把所有此文档中词(term)的权重(term weight) 看作一个向量。</p>
<p>Document = {term1, term2, …… ,term N}</p>
<p>Document Vector = {weight1, weight2, …… ,weight N}</p>
<p>同样我们把查询语句看作一个简单的文档，也用向量来表示。</p>
<p>Query = {term1, term 2, …… , term N}</p>
<p>Query Vector = {weight1, weight2, …… , weight N}</p>
<p>我们把所有搜索出的文档向量及查询向量放到一个N维空间中，每个词(term)是一维。</p>
<p>如图：</p>
<p><a href="http://images.cnblogs.com/cnblogs_com/forfuture1978/WindowsLiveWriter/185c4e9316f3_147FA/vsm_2.jpg" target="_blank"><img src="&quot;vsm&quot;" alt="vsm"></a></p>
<p>我们认为两个向量之间的夹角越小，相关性越大。</p>
<p>所以我们计算夹角的余弦值作为相关性的打分，夹角越小，余弦值越大，打分越高，相关性越大。</p>
<p>有人可能会问，查询语句一般是很短的，包含的词(Term)是很少的，因而查询向量的维数很小，而文档很长，包含词(Term)很多，文档向量维数很大。你的图中两者维数怎么都是N呢？</p>
<p>在这里，既然要放到相同的向量空间，自然维数是相同的，不同时，取二者的并集，如果不含某个词(Term)时，则权重(Term Weight)为0。</p>
<p>相关性打分公式如下：</p>
<p><a href="http://images.cnblogs.com/cnblogs_com/forfuture1978/WindowsLiveWriter/185c4e9316f3_147FA/image11.png" target="_blank"><img src="&quot;image&quot;" alt="image"></a></p>
<p>举个例子，查询语句有11个Term，共有三篇文档搜索出来。其中各自的权重(Term weight)，如下表格。
t1</p>
<p>t2</p>
<p>t3</p>
<p>t4</p>
<p>t5</p>
<p>t6</p>
<p>t7</p>
<p>t8</p>
<p>t9</p>
<p>t10</p>
<p>t11 D1</p>
<p>0</p>
<p>0</p>
<p>.477</p>
<p>0</p>
<p>.477</p>
<p>.176</p>
<p>0</p>
<p>0</p>
<p>0</p>
<p>.176</p>
<p>0 D2</p>
<p>0</p>
<p>.176</p>
<p>0</p>
<p>.477</p>
<p>0</p>
<p>0</p>
<p>0</p>
<p>0</p>
<p>.954</p>
<p>0</p>
<p>.176 D3</p>
<p>0</p>
<p>.176</p>
<p>0</p>
<p>0</p>
<p>0</p>
<p>.176</p>
<p>0</p>
<p>0</p>
<p>0</p>
<p>.176</p>
<p>.176 Q</p>
<p>0</p>
<p>0</p>
<p>0</p>
<p>0</p>
<p>0</p>
<p>.176</p>
<p>0</p>
<p>0</p>
<p>.477</p>
<p>0</p>
<p>.176</p>
<p>于是计算，三篇文档同查询语句的相关性打分分别为：</p>
<p><a href="http://images.cnblogs.com/cnblogs_com/forfuture1978/WindowsLiveWriter/185c4e9316f3_147FA/image17.png" target="_blank"><img src="&quot;image&quot;" alt="image"></a></p>
<p><a href="http://images.cnblogs.com/cnblogs_com/forfuture1978/WindowsLiveWriter/185c4e9316f3_147FA/image20.png" target="_blank"><img src="&quot;image&quot;" alt="image"></a></p>
<p><a href="http://images.cnblogs.com/cnblogs_com/forfuture1978/WindowsLiveWriter/185c4e9316f3_147FA/image23.png" target="_blank"><img src="&quot;image&quot;" alt="image"></a></p>
<p>于是文档二相关性最高，先返回，其次是文档一，最后是文档三。</p>
<p>到此为止，我们可以找到我们最想要的文档了。</p>
<p>说了这么多，其实还没有进入到Lucene，而仅仅是信息检索技术(Information retrieval)中的基本理论，然而当我们看过Lucene后我们会发现，Lucene是对这种基本理论的一种基本的的实践。所以在以后分析Lucene的文章中，会常常看到以上理论在Lucene中的应用。</p>
<p>在进入Lucene之前，对上述索引创建和搜索过程所一个总结，如图：</p>
<p>此图参照<a href="http://www.lucene.com.cn/about.htm" target="_blank"><a href="http://www.lucene.com.cn/about.htm">http://www.lucene.com.cn/about.htm</a></a>中文章《开放源代码的全文检索引擎Lucene》</p>
<p><a href="http://images.cnblogs.com/cnblogs_com/forfuture1978/WindowsLiveWriter/185c4e9316f3_147FA/clip_image016_2.jpg" target="_blank"><img src="&quot;clip_image016&quot;" alt="clip_image016"></a></p>
<p><strong>1. 索引过程：</strong></p>
<p><strong>1)**</strong>有一系列被索引文件**</p>
<p><strong>2)**</strong>被索引文件经过语法分析和语言处理形成一系列词(Term)<strong>**。</strong></p>
<p><strong>3)**</strong>经过索引创建形成词典和反向索引表。**</p>
<p><strong>4)**</strong>通过索引存储将索引写入硬盘。**</p>
<p><strong>2. 搜索过程：</strong></p>
<p><strong>a)**</strong>用户输入查询语句。**</p>
<p><strong>b)**</strong>对查询语句经过语法分析和语言分析得到一系列词(Term)<strong>**。</strong></p>
<p><strong>c)**</strong>通过语法分析得到一个查询树。**</p>
<p><strong>d)**</strong>通过索引存储将索引读入到内存。**</p>
<p><strong>e)**</strong>利用查询树搜索索引，从而得到每个词(Term)<strong>**的文档链表，对文档链表进行交，差，并得到结果文档。</strong></p>
<p><strong>f)**</strong>将搜索到的结果文档对查询的相关性进行排序。**</p>
<p><strong>g)**</strong>返回查询结果给用户。**</p>
<p>下面我们可以进入Lucene的世界了。</p>
<p>另：</p>
<p>CSDN中此文章链接为<a href="http://blog.csdn.net/forfuture1978/archive/2009/10/22/4711308.aspx" target="_blank"><a href="http://blog.csdn.net/forfuture1978/archive/2009/10/22/4711308.aspx">http://blog.csdn.net/forfuture1978/archive/2009/10/22/4711308.aspx</a></a></p>
<p>Javaeye中此文章链接为<a href="http://forfuture1978.javaeye.com/blog/546771" target="_blank"><a href="http://forfuture1978.javaeye.com/blog/546771">http://forfuture1978.javaeye.com/blog/546771</a></a></p>
<h3 id="-">评论</h3>
<p><a href="http://www.cnblogs.com/forfuture1978/archive/2009/12/14/1623594.html#1766929" target="_blank">/#1楼</a><a href=""></a>2010-02-23 08:36<a href="http://www.cnblogs.com/liuc/">Framework</a> <a href="http://space.cnblogs.com/msg/send/Framework" title="发送站内短消息"></a></p>
<p>有深度</p>
<p><a href="">支持(0)</a><a href="">反对(0)</a>
<a href="http://pic.cnitblog.com/face/u102545.png" target="_blank">http://pic.cnitblog.com/face/u102545.png</a>
<a href="http://www.cnblogs.com/forfuture1978/archive/2009/12/14/1623594.html#1874521" target="_blank">/#2楼</a><a href=""></a>2010-07-19 14:43<a href="http://www.cnblogs.com/a-peng/">a-peng</a> <a href="http://space.cnblogs.com/msg/send/a-peng" title="发送站内短消息"></a></p>
<p>谢谢楼主这么好的文章，有两个地方有点不明白。</p>
<ol>
<li>计算权重的公式
w = tf /<em> log(n / df)
log没有底数不知道要怎么计算
比如
n = 8 即8个文档
df = 2 即包含该词的文档有2个
tf = 5 即该词在该文档中出现5次
w = 5 /</em> log4
log没有底数，结果出不来。</li>
<li>举个例子，查询语句有11个Term，共有三篇文档搜索出来。其中各自的权重(Term weight)，如下表格。
表格中最后一行，查询语句中词的权重不知是如何计算出来的，是D1+D2+D3吗，不像，为什么像D2，D3中都是176而Q中确是0呢?</li>
</ol>
<p><a href="">支持(0)</a><a href="">反对(0)</a>
<a href="http://www.cnblogs.com/forfuture1978/archive/2009/12/14/1623594.html#1874557" target="_blank">/#3楼</a><a href=""></a>2010-07-19 15:12<a href="http://www.cnblogs.com/a-peng/">a-peng</a> <a href="http://space.cnblogs.com/msg/send/a-peng" title="发送站内短消息"></a></p>
<p>t2与t11
的数据是一样的都是0, 176, 176可是Q在t2与t11的结果确完全不一样，很困惑。</p>
<p><a href="">支持(0)</a><a href="">反对(0)</a>
<a href="http://www.cnblogs.com/forfuture1978/archive/2009/12/14/1623594.html#2218247" target="_blank">/#4楼</a><a href=""></a>2011-10-12 16:51<a href="http://home.cnblogs.com/u/340163/">林伟健</a> <a href="http://space.cnblogs.com/msg/send/%e6%9e%97%e4%bc%9f%e5%81%a5" title="发送站内短消息"></a></p>
<p><strong>Q的权重怎么来？</strong></p>
<p><a href="">支持(0)</a><a href="">反对(0)</a>
<a href="http://www.cnblogs.com/forfuture1978/archive/2009/12/14/1623594.html#2218466" target="_blank">/#5楼</a><a href=""></a>[楼主] 2011-10-12 22:33<a href="http://www.cnblogs.com/forfuture1978/">觉先</a> <a href="http://space.cnblogs.com/msg/send/%e8%a7%89%e5%85%88" title="发送站内短消息"></a></p>
<p><a href="http://www.cnblogs.com/forfuture1978/archive/2009/12/14/1623594.html#1874557" title="查看引用原文" target="_blank">引用</a>a-peng：
t2与t11
的数据是一样的都是0, 176, 176可是Q在t2与t11的结果确完全不一样，很困惑。
不好意思，可能是笔误了。不是查询语句中有11个Term，而是整个向量空间有11个Term。
为0的可以认为此D或者Q不包含此Term。
在这个例子中，Query包含三个Term (t6, t9, t11)，
D1 (t3, t5, t6, t10),
D2 (t2, t4, t9, t11)
D3 (t2, t6, t10, t11)
log的底数可以不同的系统根据自己想选取的平滑程度选取。
在这个例子中，底数是10.
n = 3
如果tf = 1(此文章中此Term出现了1次), df=2(两篇文章包含此Term)，
则1 /<em> log(3/2) = 0.176
如果tf = 1, df = 1, 则 1 /</em> log3 = 0.477
如果tf = 2, df = 1, 则 2 /* log3 = 0.954</p>
<p><a href="">支持(1)</a><a href="">反对(0)</a>
<a href="http://pic.cnitblog.com/face/u103165.jpg" target="_blank">http://pic.cnitblog.com/face/u103165.jpg</a>
<a href="http://www.cnblogs.com/forfuture1978/archive/2009/12/14/1623594.html#2309807" target="_blank">/#6楼</a><a href=""></a>2012-02-16 10:49<a href="http://home.cnblogs.com/u/330198/">珍帅久久</a> <a href="http://space.cnblogs.com/msg/send/%e7%8f%8d%e5%b8%85%e4%b9%85%e4%b9%85" title="发送站内短消息"></a></p>
<p>很有深度，但又通俗易懂，不可多得的好文章啊。</p>
<p><a href="">支持(0)</a><a href="">反对(0)</a>
<a href="http://www.cnblogs.com/forfuture1978/archive/2009/12/14/1623594.html#2324373" target="_blank">/#7楼</a><a href=""></a>2012-03-06 21:32<a href="http://home.cnblogs.com/u/279684/">waceunmn</a> <a href="http://space.cnblogs.com/msg/send/waceunmn" title="发送站内短消息"></a></p>
<p>不错的内容啊</p>
<p><a href="">支持(0)</a><a href="">反对(0)</a>
<a href="http://www.cnblogs.com/forfuture1978/archive/2009/12/14/1623594.html#2380300" target="_blank">/#8楼</a><a href=""></a>2012-05-18 22:52<a href="http://www.cnblogs.com/scncpb/">scncpb</a> <a href="http://space.cnblogs.com/msg/send/scncpb" title="发送站内短消息"></a></p>
<p>谢谢，讲的真详细，把具体的过程讲的极其清楚。。</p>
<p><a href="">支持(0)</a><a href="">反对(0)</a>
<a href="http://www.cnblogs.com/forfuture1978/archive/2009/12/14/1623594.html#2410964" target="_blank">/#9楼</a><a href=""></a>2012-06-29 17:32<a href="http://www.cnblogs.com/pyt5208/">潘奕涛</a> <a href="http://space.cnblogs.com/msg/send/%e6%bd%98%e5%a5%95%e6%b6%9b" title="发送站内短消息"></a></p>
<p>很好很强大</p>
<p><a href="">支持(0)</a><a href="">反对(0)</a>
<a href="http://pic.cnitblog.com/face/u16379.jpg" target="_blank">http://pic.cnitblog.com/face/u16379.jpg</a>
<a href="http://www.cnblogs.com/forfuture1978/archive/2009/12/14/1623594.html#2469601" target="_blank">/#10楼</a><a href=""></a>2012-09-11 13:50<a href="http://www.cnblogs.com/jiuyi/">久依</a> <a href="http://space.cnblogs.com/msg/send/%e4%b9%85%e4%be%9d" title="发送站内短消息"></a></p>
<p>内容非常详细，就是我的数据不怎么好嘿嘿！</p>
<p><a href="">支持(0)</a><a href="">反对(0)</a>
<a href="http://www.cnblogs.com/forfuture1978/archive/2009/12/14/1623594.html#2470199" target="_blank">/#11楼</a><a href=""></a>2012-09-11 22:16<a href="http://www.cnblogs.com/androidapp/">心有多大，舞台就有多大</a> <a href="http://space.cnblogs.com/msg/send/%e5%bf%83%e6%9c%89%e5%a4%9a%e5%a4%a7%ef%bc%8c%e8%88%9e%e5%8f%b0%e5%b0%b1%e6%9c%89%e5%a4%9a%e5%a4%a7" title="发送站内短消息"></a></p>
<p>非常好，草率的看完了</p>
<p><a href="">支持(0)</a><a href="">反对(0)</a>
<a href="http://www.cnblogs.com/forfuture1978/archive/2009/12/14/1623594.html#2567509" target="_blank">/#12楼</a><a href=""></a>2012-11-30 16:53<a href="http://home.cnblogs.com/u/72579/">流民无产者</a> <a href="http://space.cnblogs.com/msg/send/%e6%b5%81%e6%b0%91%e6%97%a0%e4%ba%a7%e8%80%85" title="发送站内短消息"></a></p>
<p>非常好的文章，谢谢博主的分享。
刚开始也没看懂Query的weight如何计算的，后来看了回复就明白了。
只是还有一点不明白的地方，希望博主解答。
tf和df的计算：tf表示的term在一个doc里的权重值。但是df对于一次查询是个常量值，不知道计算有何意义。我觉得df的值对于查询的doc排序没有影响。</p>
<p><a href="">支持(0)</a><a href="">反对(0)</a>
<a href="http://www.cnblogs.com/forfuture1978/archive/2009/12/14/1623594.html#2577177" target="_blank">/#13楼</a><a href=""></a>2012-12-13 18:29<a href="http://www.cnblogs.com/ttltry-air/">coodoing</a> <a href="http://space.cnblogs.com/msg/send/coodoing" title="发送站内短消息"></a></p>
<p>很详细 受用</p>
<p><a href="">支持(0)</a><a href="">反对(0)</a>
<a href="http://pic.cnitblog.com/face/u74734.png?id=23111117" target="_blank">http://pic.cnitblog.com/face/u74734.png?id=23111117</a>
<a href="http://www.cnblogs.com/forfuture1978/archive/2009/12/14/1623594.html#2610299" target="_blank">/#14楼</a><a href=""></a>2013-01-29 20:04<a href="http://www.cnblogs.com/hemingwang0902/">星情</a> <a href="http://space.cnblogs.com/msg/send/%e6%98%9f%e6%83%85" title="发送站内短消息"></a></p>
<p>总结得很全面且有深度</p>
<p><a href="">支持(0)</a><a href="">反对(0)</a>
<a href="http://pic.cnitblog.com/face/u70745.jpg?id=22103524" target="_blank">http://pic.cnitblog.com/face/u70745.jpg?id=22103524</a>
<a href="http://www.cnblogs.com/forfuture1978/archive/2009/12/14/1623594.html#2657314" target="_blank">/#15楼</a><a href=""></a>2013-04-14 21:02<a href="http://www.cnblogs.com/liubaoshun/">IoT小菜</a> <a href="http://space.cnblogs.com/msg/send/IoT%e5%b0%8f%e8%8f%9c" title="发送站内短消息"></a></p>
<p><a href="http://www.cnblogs.com/forfuture1978/archive/2009/12/14/1623594.html#1874521" title="查看所回复的评论" target="_blank">@</a>a-peng
计算机里面权重默认是2</p>
<p><a href="">支持(0)</a><a href="">反对(0)</a>
<a href="http://pic.cnitblog.com/face/456333/20130617210829.png" target="_blank">http://pic.cnitblog.com/face/456333/20130617210829.png</a>
<a href="http://www.cnblogs.com/forfuture1978/archive/2009/12/14/1623594.html#2666068" target="_blank">/#16楼</a><a href=""></a>26660682013/4/25 11:27:402013-04-25 11:27<a href="http://www.cnblogs.com/echofool/">Echofool</a> <a href="http://space.cnblogs.com/msg/send/Echofool" title="发送站内短消息"></a></p>
<p>这么好的文章，为什么没人评论呢？感谢楼主分享。受用了</p>
<p><a href="">支持(0)</a><a href="">反对(0)</a>
来源： &lt;<a href="http://www.cnblogs.com/forfuture1978/archive/2009/12/14/1623594.html" target="_blank">Lucene学习总结之一：全文检索的基本原理 - 觉先 - 博客园</a>&gt; <a href=""></a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/lucene/">lucene</a></li></span></span> | <span class="tags">Tagged <a href="/tags/lucene/" class="label label-primary">lucene</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:28"datetime="2014-03-07 09:54:28"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-lucene--Lucene学习总结之一：全文检索的基本原理/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-lucene--Lucene学习总结之一：全文检索的基本原理" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-JS用法--Javascript中最常用的55个经典技巧/">Javascript中最常用的55个经典技巧</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:28.000Z"> <a href="/2014/02/02/2014-02-02-JS用法--Javascript中最常用的55个经典技巧/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="javascript-55-">Javascript中最常用的55个经典技巧</h1>
<p><a href="http://www.javaeye.com/" target="_blank">首页</a> <a href="http://www.javaeye.com/news" target="_blank">新闻</a> <a href="http://www.javaeye.com/forums" target="_blank">论坛</a> <a href="http://www.javaeye.com/blogs" target="_blank">博客</a> <a href="http://www.javaeye.com/job" target="_blank">招聘</a> <a href="http://hainanhaian.javaeye.com/blog/248515#" target="_blank">更多 ▼</a></p>
<p><a href="http://www.javaeye.com/ask" target="_blank">问答</a> <a href="http://www.javaeye.com/wiki" target="_blank">知识库</a> <a href="http://www.javaeye.com/groups" target="_blank">圈子</a> <a href="http://www.javaeye.com/google_search" target="_blank">搜索</a></p>
<p><a href="http://jywv.javaeye.com/" title="查看我的博客首页" target="_blank">欢迎jywv</a> <a href="http://app.javaeye.com/messages" title="发送站内短信" target="_blank">收件箱</a> <a href="http://app.javaeye.com/" title="我的应用首页" target="_blank">我的应用</a></p>
<p><a href="http://app.javaeye.com/feed" title="我订阅的好友动态消息" target="_blank">我的订阅</a> <a href="http://app.javaeye.com/feed/my" title="我参与的话题更新的消息" target="_blank">我的参与</a> <a href="http://app.javaeye.com/chat" title="用闲聊发表简短的话题" target="_blank">我的闲聊</a> <a href="http://app.javaeye.com/mygroup" title="我加入的圈子最新话题" target="_blank">我的圈子</a> <a href="http://app.javaeye.com/links" title="我收藏的网络资源链接" target="_blank">我的收藏</a> <a href="http://app.javaeye.com/myresume" title="我的个人简历" target="_blank">我的简历</a>
<a href="http://jywv.javaeye.com/admin" title="管理我的博客" target="_blank">我的博客</a> <a href="http://app.javaeye.com/profile" title="修改我的个人设置" target="_blank">设置</a> <a href="http://hainanhaian.javaeye.com/logout" target="_blank">退出</a></p>
<h1 id="-http-hainanhaian-javaeye-com-"><a href="http://hainanhaian.javaeye.com/" target="_blank">新空气</a></h1>
<p>永久域名 <a href="http://hainanhaian.javaeye.com/" target="_blank"><a href="http://hainanhaian.javaeye.com/">http://hainanhaian.javaeye.com/</a></a></p>
<p><a href="http://hainanhaian.javaeye.com/blog/248542" title="Javascript网页打印大全" target="_blank">Javascript网页打印大全</a> | <a href="http://hainanhaian.javaeye.com/blog/248221" title="编程术语英汉对照大全 " target="_blank">编程术语英汉对照大全</a></p>
<p>2008-10-02</p>
<h3 id="-javascript-55-http-hainanhaian-javaeye-com-blog-248515-"><a href="http://hainanhaian.javaeye.com/blog/248515" target="_blank">Javascript中最常用的55个经典技巧</a></h3>
<ol>
<li>oncontextmenu=&quot;window.event.returnValue=false&quot; 将彻底屏蔽鼠标右键
<table border oncontextmenu=return(false)><td>no</table> 可用于Table</li>
<li><body onselectstart="return false"> 取消选取、防止复制</li>
<li>onpaste=&quot;return false&quot; 不准粘贴</li>
<li>oncopy=&quot;return false;&quot; oncut=&quot;return false;&quot; 防止复制</li>
<li><link rel="Shortcut Icon" href="favicon.ico"> IE地址栏前换成自己的图标</li>
<li><link rel="Bookmark" href="favicon.ico"> 可以在收藏夹中显示出你的图标</li>
<li><input style="ime-mode:disabled"> 关闭输入法</li>
<li>永远都会带着框架<script language="JavaScript"><!--
if (window == top)top.location.href = "frames.htm"; //frames.htm为框架网页
// --></script></li>
<li>防止被人frame<SCRIPT LANGUAGE=JAVASCRIPT><!--
if (top.location != self.location)top.location=self.location;
// --></SCRIPT></li>
<li>网页将不能被另存为<noscript>&lt;/<em>/</em>/<em> src=&quot;//</em>.html&gt;&quot;;&lt;//<em>/</em>/*&gt;</noscript></li>
<li><input type=button value="/查看网页源代码
onclick="window.location = "view-source:"+ "http://www.pconline.com.cn"">
12.删除时确认
<a href=""javascript :if(confirm("确实要删除吗?"))location="boos.asp?&areyou=删除&page=1"">删除</a></li>
<li>取得控件的绝对位置
//Javascript<script language="Javascript">
function getIE(e){
var t=e.offsetTop;
var l=e.offsetLeft;
while(e=e.offsetParent){
t+=e.offsetTop;
l+=e.offsetLeft;
}
alert("top="+t+"/nleft="+l);
}
</script>
//VBScript
<script language="VBScript"><!--
function getIE()
dim t,l,a,b
set a=document.all.img1
t=document.all.img1.offsetTop
l=document.all.img1.offsetLeft
while a.tagName<>"BODY"
set a = a.offsetParent
t=t+a.offsetTop
l=l+a.offsetLeft
wend
msgbox "top="&t&chr(13)&"left="&l,64,"得到控件的位置"
end function
--></script></li>
<li>光标是停在文本框文字的最后
<script language="javascript">
function cc()
{
var e = event.srcElement;
var r =e.createTextRange();
r.moveStart(&quot;character&quot;,e.value.length);
r.collapse(true);
r.select();
}
</script><input type=text name=text1 value="123" onfocus="cc()"></li>
<li>判断上一页的来源
javascript :
document.referrer</li>
<li>最小化、最大化、关闭窗口
<object id=hh1 classid="clsid:ADB880A6-D8FF-11CF-9377-00AA003B7A11">
<param name="Command" value="Minimize"></object>
<object id=hh2 classid="clsid:ADB880A6-D8FF-11CF-9377-00AA003B7A11">
<param name="Command" value="Maximize"></object>
<OBJECT id=hh3 classid="clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11">
<PARAM NAME="Command" value="/Close"></OBJECT>
<input type=button value="/最小化 onclick=hh1.Click()>
<input type=button value="/blog/最大化 onclick=hh2.Click()>
<input type=button value=关闭 onclick=hh3.Click()>
本例适用于IE
17.屏蔽功能键Shift,Alt,Ctrl<script>
function look(){
if(event.shiftKey)
alert("禁止按Shift键!"); //可以换成ALT　CTRL
}
document.onkeydown=look;
</script></li>
<li>网页不会被缓存
<META HTTP-EQUIV="pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-cache, must-revalidate">
<META HTTP-EQUIV="expires" CONTENT="Wed, 26 Feb 1997 08:21:57 GMT">
或者<META HTTP-EQUIV="expires" CONTENT="0">
19.怎样让表单没有凹凸感？
<input type=text style="""border:1 solid /#000000">
或
<input type=text style="border-left:none; border-right:none; border-top:none; border-bottom:
1 solid /#000000"></textarea>
20.<div><span>&amp;<layer>的区别？
<div>(division)用来定义大段的页面元素，会产生转行
<span>用来定义同一行内的元素，跟<div>的唯一区别是不产生转行
<layer>是ns的标记，ie不支持，相当于<div>
21.让弹出窗口总是在最上面:
<body onblur="this.focus();">
22.不要滚动条?
让竖条没有:
<body style="overflow:scroll;overflow-y:hidden">
</body>
让横条没有:
<body style="overflow:scroll;overflow-x:hidden">
</body>
两个都去掉？更简单了
<body scroll="no">
</body>
23.怎样去掉图片链接点击后，图片周围的虚线？
<a href="/#" onFocus="this.blur()"><img src="/logo.jpg" border=0></a>
24.电子邮件处理提交表单
<form name="form1" method="post" action=mailto:/*/*/*/*@/*/*/*.com
enctype="text/plain">
<input type=submit>
</form>
25.在打开的子窗口刷新父窗口的代码里如何写？
window.opener.location.reload()
26.如何设定打开页面的大小
<body onload="top.resizeTo(300,200);">
打开页面的位置<body onload="top.moveBy(300,200);">
27.在页面中如何加入不是满铺的背景图片,拉动页面时背景图不动<STYLE>
body
{background-image:url(/logo.gif); background-repeat:no-repeat;
background-position:center;background-attachment: fixed}
</STYLE></li>
<li>检查一段字符串是否全由数字组成<script language="Javascript"><!--
function checkNum(str){return str.match(//D/)==null}
alert(checkNum("1232142141"))
alert(checkNum("123214214a1"))
// --></script></li>
<li>获得一个窗口的大小
document.body.clientWidth; document.body.clientHeight</li>
<li>怎么判断是否是字符
if (/[^/x00-/xff]/g.test(s)) alert(&quot;含有汉字&quot;);
else alert(&quot;全是字符&quot;);
31.TEXTAREA自适应文字行数的多少<textarea rows=1 name=s1 cols=27 onpropertychange
="this.style.posHeight=this.scrollHeight">
</textarea></li>
<li>日期减去天数等于第二个日期<script language=Javascript>
function cc(dd,dadd)
{
//可以加上错误处理
var a = new Date(dd)
a = a.valueOf()
a = a - dadd /* 24 /* 60 /* 60 /* 1000
a = new Date(a)
alert(a.getFullYear() + "年" + (a.getMonth() + 1) + "月" + a.getDate() + "日")
}
cc("12/23/2002",2)
</script></li>
<li>选择了哪一个Radio
<HTML><script language="vbscript">
function checkme()
for each ob in radio1
if ob.checked then
window.alert ob.value
next
end function
</script><BODY>
<INPUT name="radio1" type="radio" value="/style" checked>Style
<INPUT name="radio1" type="radio" value="/blog/barcode">Barcode
<INPUT type="button" value="check" onclick="checkme()">
</BODY></HTML>
34.脚本永不出错
<SCRIPT LANGUAGE="JavaScript">
<!-- Hide
function killErrors() {
return true;
}
window.onerror = killErrors;
// -->
</SCRIPT>
35.ENTER键可以让光标移到下一个输入框<input onkeydown="if(event.keyCode==13)event.keyCode=9"></li>
<li>检测某个网站的链接速度：
把如下代码加入<body>区域中:<script language=Javascript>
tim=1
setInterval("tim++",100)
b=1
var autourl=new Array()
autourl[1]=1000){this.resized=true;this.style.width=1000;}" align=absMiddle border=0>www.njcatv.net"
autourl[2]="javacool.3322.net"
autourl[3]=1000){this.resized=true;this.style.width=1000;}" align=absMiddle border=0>www.sina.com.cn"
autourl[4]="www.nuaa.edu.cn"
autourl[5]=1000){this.resized=true;this.style.width=1000;}" align=absMiddle border=0>www.cctv.com"
function butt(){
/*/*/*("<form name=autof>")
for(var i=1;i<autourl.length;i++)
/*/*/*("<input type=text name=txt"+i+" size=10 value="/测试中……> =》<input type=text
name=url"+i+" size=40> =》<input type=button value="/blog/GO
onclick=window.open(this.form.url"+i+".value)><br>")
/*/*/*("<input type=submit value=刷新></form>")
}
butt()
function auto(url){
document.forms[0]["url"+b].value=url
if(tim>200)
{document.forms[0]["txt"+b].value="/链接超时"}
else
{document.forms[0]["txt"+b].value="/blog/时间"+tim/10+"秒"}
b++
}
function run(){for(var i=1;i<autourl.length;i++)/*/*/*("<img src=http://"+autourl+"/"+Math.random()+" width=1 height=1
onerror=auto("http://"+autourl+"")>")}
run()</script></li>
<li>各种样式的光标
auto ：标准光标
default ：标准箭头
hand ：手形光标
wait ：等待光标
text ：I形光标
vertical-text ：水平I形光标
no-drop ：不可拖动光标
not-allowed ：无效光标
help ：?帮助光标
all-scroll ：三角方向标
move ：移动标
crosshair ：十字标
e-resize
n-resize
nw-resize
w-resize
s-resize
se-resize
sw-resize
38.页面进入和退出的特效
进入页面<meta http-equiv="Page-Enter" content="revealTrans(duration=x, transition=y)">
推出页面<meta http-equiv="Page-Exit" content="revealTrans(duration=x, transition=y)"> 
这个是页面被载入和调出时的一些特效。duration表示特效的持续时间，以秒为单位。transition表示使用哪种特效，取值为1-23:
0 矩形缩小
1 矩形扩大
2 圆形缩小
3 圆形扩大
4 下到上刷新
5 上到下刷新
6 左到右刷新
7 右到左刷新
8 竖百叶窗
9 横百叶窗
10 错位横百叶窗
11 错位竖百叶窗
12 点扩散
13 左右到中间刷新
14 中间到左右刷新
15 中间到上下
16 上下到中间
17 右下到左上
18 右上到左下
19 左上到右下
20 左下到右上
21 横条
22 竖条
23 以上22种随机选择一种
39.在规定时间内跳转
<META http-equiv=V="REFRESH" content="5;URL=http://www.51js.com">
40.网页是否被检索
<meta name="ROBOTS" content="属性值">
其中属性值有以下一些:
属性值为&quot;all&quot;: 文件将被检索，且页上链接可被查询；
属性值为&quot;none&quot;: 文件不被检索，而且不查询页上的链接；
属性值为&quot;index&quot;: 文件将被检索；
属性值为&quot;follow&quot;: 查询页上的链接；
属性值为&quot;noindex&quot;: 文件不检索，但可被查询链接；
属性值为&quot;nofollow&quot;: 文件不被检索，但可查询页上的链接。
41、email地址的分割
把如下代码加入<body>区域中
<a href="mailto:webmaster@sina.com">webmaster@sina.com</a>
42、流动边框效果的表格
把如下代码加入<body>区域中
<SCRIPT>
l=Array(6,7,8,9,&#39;a&#39;,&#39;b&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;,&#39;e&#39;,&#39;f&#39;)
Nx=5;Ny=35
t=&quot;<table border=0 cellspacing=0 cellpadding=0 height="+((Nx+2)/*16)+"><tr>&quot;
for(x=Nx;x<Nx+Ny;x++)
t+="<td width=16 id=a_mo"+x+">　</td>"
t+="</tr><tr><td width=10 id=a_mo"+(Nx-1)+">　</td><td colspan="+(Ny-2)+" rowspan="+(Nx)+">　</td><td width=16 id=a_mo"+(Nx+Ny)+"></td></tr>"
for(x=2;x<=Nx;x++)
t+="<tr><td width=16 id=a_mo"+(Nx-x)+">　</td><td width=16 id=a_mo"+(Ny+Nx+x-1)+">　</td></tr>"
t+="<tr>"
for(x=Ny;x>0;x--)
t+=&quot;<td width=16 id=a_mo"+(x+Nx/*2+Ny-1)+">　</td>&quot;
/<em>/</em>/<em>(t+&quot;</tr></table>&quot;)
var N=Nx/</em>2+Ny/*2
function f1(y){
for(i=0;i<N;i++){
c=(i+y)%20;if(c>10)c=20-c
document.all[&quot;a_mo&quot;+(i)].bgColor=&quot;&quot;&quot;&quot;/#0000&quot;+l[c]+l[c]+&quot;&#39;&quot;}
y++
setTimeout(&#39;f1(&#39;+y+&#39;)&#39;,&#39;1&#39;)}
f1(1)
</SCRIPT>
43、JavaScript主页弹出窗口技巧
窗口中间弹出
<script>
window.open(&quot;<a href="http://www.cctv.com&quot;,&quot;&quot;,&quot;width=400,height=240,top=&quot;+(screen.availHeight-240)/2+&quot;,left=&quot;+(screen.availWidth-400)/2" target="_blank">http://www.cctv.com&quot;,&quot;&quot;,&quot;width=400,height=240,top=&quot;+(screen.availHeight-240)/2+&quot;,left=&quot;+(screen.availWidth-400)/2</a>);<h1 id="-script-"></script></h1>
<html>
<head>
<script language="LiveScript">
function WinOpen() {
msg=open(&quot;&quot;,&quot;DisplayWindow&quot;,&quot;toolbar=no,directories=no,menubar=no&quot;);
msg./<em>/</em>/<em>(&quot;<HEAD><TITLE>哈 罗!</TITLE></HEAD>&quot;);
msg./</em>/<em>/</em>(&quot;<CENTER><H1>酷 毙 了!</H1><h2>这 是<B>JavaScript</B>所 开 的 视 窗!</h2></CENTER>&quot;);
}
</script>
</head>
<body>
<form>
<input type="button" name="Button1" value="Push me" onclick="WinOpen()">
</form>
</body><h1 id="-html-"></html></h1>
一、在下面的代码中，你只要单击打开一个窗口，即可链接到赛迪网。而当你想关闭时，只要单击一下即可关闭刚才打开的窗口。
代码如下：
<SCRIPT language="JavaScript">
&lt;！--
function openclk() {
another=open(&#39;1000){this.resized=true;this.style.width=1000;}&quot; align=absMiddle border=0&gt;<a href="http://www.ccidnet.com&#39;，&#39;NewWindow" target="_blank">http://www.ccidnet.com&#39;，&#39;NewWindow</a>&#39;);
}
function closeclk() {
another.close();
}
//--&gt;
</SCRIPT>
<FORM>
<INPUT TYPE="BUTTON" NAME="open" value="/打开一个窗口" onClick="openclk()">
<BR>
<INPUT TYPE="BUTTON" NAME="close" value="/blog/关闭这个窗口" onClick="closeclk()">
</FORM>
二、上面的代码也太静了，为何不来点动感呢？如果能给页面来个降落效果那该多好啊！
代码如下：
<script>
function drop(n) {
if(self.moveBy){
self.moveBy (0，-900);
for(i = n; i &gt; 0; i--){
self.moveBy(0，3);
}
for(j = 8; j &gt; 0; j--){
self.moveBy(0，j);
self.moveBy(j，0);
self.moveBy(0，-j);
self.moveBy(-j，0);
}
}
}
</script>
<body onLoad="drop(300)">
三、讨厌很多网站总是按照默认窗口打开，如果你能随心所欲控制打开的窗口那该多好。
代码如下:
<SCRIPT LANGUAGE="JavaScript">
&lt;！-- Begin
function popupPage(l， t， w， h) {
var windowprops = &quot;location=no，scrollbars=no，menubars=no，toolbars=no，resizable=yes&quot; +
&quot;，left=&quot; + l + &quot;，top=&quot; + t + &quot;，width=&quot; + w + &quot;，height=&quot; + h;
var URL = &quot;<a href="http://www.80cn.com" target="_blank">http://www.80cn.com</a>&quot;;
popup = window.open(URL，&quot;MenuPopup&quot;，windowprops);
}
// End --&gt;
</script><table>
<tr>
<td>
<form name=popupform>
<pre>
打开页面的参数<br>
离开左边的距离: <input type=text name=left size=2 maxlength=4> pixels
离开右边的距离: <input type=text name=top size=2 maxlength=4> pixels
窗口的宽度: <input type=text name=width size=2 maxlength=4> pixels
窗口的高度: <input type=text name=height size=2 maxlength=4> pixels
</pre>
<center>
<input type=button value="打开这个窗口！" onClick="popupPage(this.form.left.value， this.form.top.value， this.form.width.value，
this.form.height.value)">
</center>
</form>
</td>
</tr>
</table>你只要在相对应的对话框中输入一个数值即可，将要打开的页面的窗口控制得很好。
44、页面的打开移动
把如下代码加入<body>区域中
<SCRIPT LANGUAGE="JavaScript">
<!-- Begin
for (t = 2; t > 0; t--) {
for (x = 20; x > 0; x--) {
for (y = 10; y > 0; y--) {
parent.moveBy(0,-x);
}
}
for (x = 20; x > 0; x--) {
for (y = 10; y > 0; y--) {
parent.moveBy(0,x);
}
}
for (x = 20; x > 0; x--) {
for (y = 10; y > 0; y--) {
parent.moveBy(x,0);
}
}
for (x = 20; x > 0; x--) {
for (y = 10; y > 0; y--) {
parent.moveBy(-x,0);
 }
}
}
//-->
//   End --&gt;
</script>
45、显示个人客户端机器的日期和时间
<script language="LiveScript">
<!-- Hiding
today = new Date()
/*/*/*("现 在 时 间 是： ",today.getHours(),":",today.getMinutes())
/*/*/*("<br>今 天 日 期 为： ", today.getMonth()+1,"/",today.getDate(),"/",today.getYear());
// end hiding contents -->
</script>
46、自动的为你每次产生最後修改的日期了：
<html>
<body>
This is a simple HTML- page.
<br>
Last changes:
<script language="LiveScript">
<!--   hide script from old browsers
 /*/*/*(document.lastModified)
// end hiding contents -->
</script>
</body>
</html>
47、不能为空和邮件地址的约束：
<html>
<head>
<script language="JavaScript">
<!-- Hide
function test1(form) {
if (form.text1.value == "")
 alert("您 没 写 上 任 何 东 西， 请 再 输 入 一 次 !")
else {
alert("嗨 "+form.text1.value+"! 您 已 输 入 完 成 !");
}
}
function test2(form) {
if (form.text2.value == "" ||
   form.text2.value.indexOf('@', 0) == -1)
     alert("这 不 是 正 确 的 e-mail address! 请 再 输 入 一 次 !");
else alert("您 已 输 入 完 成 !");
}
// -->
</script>
</head>
<body>
<form name="first">
Enter your name:<br>
<input type="text" name="text1">
<input type="button" name="button1" value="输 入 测 试" onClick="test1(this.form)">
<P>
Enter your e-mail address:<br>
<input type="text" name="text2">
<input type="button" name="button2" value="输 入 测 试" onClick="test2(this.form)">
</body>
48、跑马灯
<html>
<head>
<script language="JavaScript">
<!-- Hide
var scrtxt="怎麽样 ! 很酷吧 ! 您也可以试试."+"Here goes your message the visitors to your
page will "+"look at for hours in pure fascination...";
var lentxt=scrtxt.length;
var width=100;
var pos=1-width;
function scroll() {
pos++;
var scroller="";
if (pos==lentxt) {
 pos=1-width;
}
if (pos<0) {
 for (var i=1; i<=Math.abs(pos); i++) {
   scroller=scroller+" ";}
 scroller=scroller+scrtxt.substring(0,width-i+1);
}
else {
 scroller=scroller+scrtxt.substring(pos,width+pos);
}
window.status = scroller;
setTimeout("scroll()",150);
}
//-->
</script>
</head>
<body onLoad="scroll();return true;">
这里可显示您的网页 !
</body>
</html>
49、在网页中用按钮来控制前页，后页和主页的显示。
<html>
<body>
<FORM NAME="buttonbar">
  <INPUT TYPE="button" VALUE="Back" onClick="history.back()">
  <INPUT TYPE="button" VALUE="JS- Home" onClick="location='script.html'">
  <INPUT TYPE="button" VALUE="Next" onCLick="history.forward()">
</FORM>
</body>
</html>
50、查看某网址的源代码
把如下代码加入<body>区域中
<SCRIPT>
function add()
{
var ress=document.forms[0].luxiaoqing.value
window.location=&quot;view-source:&quot;+ress;
}
</SCRIPT>
输入要查看源代码的URL地址:
<FORM><input type="text" name="luxiaoqing" size=40 value="http://"></FORM>
<FORM><br>
<INPUT type="button" value="查看源代码" onClick=add()>
</FORM>
51、title显示日期
把如下代码加入<body>区域中:
<script language="JavaScript1.2">
<!--hide
var isnMonth = new
Array("1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月");
var isnDay = new
Array("星期日","星期一","星期二","星期三","星期四","星期五","星期六","星期日");
today = new Date () ;
Year=today.getYear();
Date=today.getDate();
if (document.all)
document.title="今天是: "+Year+"年"+isnMonth[today.getMonth()]+Date+"日"+isnDay[today.getDay()]
//--hide-->
</script>
52、显示所有链接
把如下代码加入<body>区域中
<script language="JavaScript1.2">
<!--
function extractlinks(){
var links=document.all.tags("A")
var total=links.length
var win2=window.open("","","menubar,scrollbars,toolbar")
win2./*/*/*("<font size='2'>一共有"+total+"个连接</font><br>")
for (i=0;i<total;i++){
win2./*/*/*("<font size='2'>"+links[i].outerHTML+"</font><br>")
}
}
//-->
</script>
<input type="button" onClick="extractlinks()" value="显示所有的连接">
53、回车键换行
把如下代码加入<body>区域中
<script type="text/javascript"><br>function handleEnter (field, event) {
var keyCode = event.keyCode ? event.keyCode : event.which ?
event.which : event.charCode;
if (keyCode == 13) {
var i;
for (i = 0; i &lt; field.form.elements.length; i++)
 if (field == field.form.elements[i])
  break;
i = (i + 1) % field.form.elements.length;
field.form.elements[i].focus();
return false;
}
else
return true;
}<br></script>
<form>
<input type="text" onkeypress="return handleEnter(this, event)"><br>
<input type="text" onkeypress="return handleEnter(this, event)"><br>
<textarea>回车换行
54、确认后提交
把如下代码加入<body>区域中
<SCRIPT LANGUAGE="JavaScript">
<!--
function msg(){
if (confirm("你确认要提交嘛！"))
document.lnman.submit()
}
//-->
</SCRIPT>
<form name="lnman" method="post" action="">
<p>
 <input type="text" name="textfield" value="确认后提交">
</p>
<p>
 <input type="button" name="Submit" value="提交" onclick="msg();">
</p>
</form>
55、改变表格的内容
把如下代码加入<body>区域中
<script /*/*/*script>
var arr=new Array()
arr[0]=&quot;一一一一一&quot;;
arr[1]=&quot;二二二二二&quot;;
arr[2]=&quot;三三三三三&quot;;
</script>
<select onchange="zz.cells[this.selectedIndex].innerHTML=arr[this.selectedIndex]">
<option value=a>改变第一格</option>
<option value=a>改变第二格</option>
<option value=a>改变第三格</option>
</select>
<table id=zz border=1>
<tr height=20>
 <td width=150>第一格</td>
<td width=150>第二格</td>
<td width=150>第三格</td>
</tr>
</table>
</li>
</ol>
<ul>
<li>10:39</li>
<li>浏览 (317)</li>
<li><a href="http://hainanhaian.javaeye.com/blog/248515#comments" target="_blank">评论</a> (1)</li>
<li>分类: <a href="http://hainanhaian.javaeye.com/category/42379" target="_blank">web</a></li>
<li><a href="http://app.javaeye.com/links?user_favorite%5Btitle%5D=Javascript%E4%B8%AD%E6%9C%80%E5%B8%B8%E7%94%A8%E7%9A%8455%E4%B8%AA%E7%BB%8F%E5%85%B8%E6%8A%80%E5%B7%A7&amp;user_favorite%5Burl%5D=http%3A%2F%2Fhainanhaian.javaeye.com%2Fblog%2F248515" target="_blank">收藏</a></li>
<li><a href="http://www.javaeye.com/wiki/topic/248515" target="_blank">相关推荐</a><h3 id="-">评论</h3>
</li>
</ul>
<p><a href=""></a></p>
<p>1 楼 <a href="http://walkman.javaeye.com/" target="_blank">walkman</a> 2008-10-06   <a href="http://hainanhaian.javaeye.com/blog/248515#" target="_blank">引用</a></p>
<p>经典可以谈得上，但是建议“常用”换成“鲜为人知”、“实用”</p>
<h3 id="-">发表评论</h3>
<p>(快捷键 Alt+S / Ctrl+Enter)</p>
<p><a href="http://hainanhaian.javaeye.com/" target="_blank"><img src="&quot;hainanhaian的博客: 新空气&quot;" alt="hainanhaian的博客"></a></p>
<p>hainanhaian</p>
<ul>
<li>浏览: 6479 次</li>
<li>性别: <img src="&quot;男&quot;" alt="Icon_minigender_1"></li>
<li>来自: 南京</li>
<li><img src="" alt=""></li>
<li><a href="http://hainanhaian.javaeye.com/blog/profile" target="_blank">详细资料</a> <a href="http://hainanhaian.javaeye.com/blog/guest_book" target="_blank">留言簿</a></li>
<li><a href="http://app.javaeye.com/messages/new?message%5Breceiver_name%5D=hainanhaian" title="发送站内短信" target="_blank">发短消息</a> <a href="http://app.javaeye.com/feed?subscription%5Bsubscribed_user_name%5D=hainanhaian" target="_blank">订阅</a></li>
</ul>
<h3 id="-">搜索本博客</h3>
<h3 id="-http-hainanhaian-javaeye-com-blog-user_visits-">最近访客 <a href="http://hainanhaian.javaeye.com/blog/user_visits" target="_blank">&gt;&gt;更多访客</a></h3>
<p><a href="http://jywv.javaeye.com/" target="_blank"><img src="&quot;jywv的博客: jywv&quot;" alt="jywv的博客"></a></p>
<p><a href="http://jywv.javaeye.com/" target="_blank">jywv</a></p>
<p><a href="http://shjavaer.javaeye.com/" target="_blank"><img src="&quot;shjavaer的博客: &quot;" alt="shjavaer的博客"></a></p>
<p><a href="http://shjavaer.javaeye.com/" target="_blank">shjavaer</a>
<a href="http://angus---yeah-net.javaeye.com/" target="_blank"><img src="&quot;那份安静的博客: &quot;" alt="那份安静的博客"></a></p>
<p><a href="http://angus---yeah-net.javaeye.com/" target="_blank">那份安静</a></p>
<p><a href="http://migrator.javaeye.com/" target="_blank"><img src="&quot;Migrator的博客: &quot;" alt="Migrator的博客"></a></p>
<p><a href="http://migrator.javaeye.com/" target="_blank">Migrator</a></p>
<h3 id="-">博客分类</h3>
<ul>
<li><a href="http://hainanhaian.javaeye.com/" target="_blank">全部博客 (19)</a></li>
<li><a href="http://hainanhaian.javaeye.com/category/42202" target="_blank">java (8)</a></li>
<li><a href="http://hainanhaian.javaeye.com/category/42318" target="_blank">E (4)</a></li>
<li><a href="http://hainanhaian.javaeye.com/category/42379" target="_blank">web (5)</a></li>
<li><p><a href="http://hainanhaian.javaeye.com/category/42440" target="_blank">arithmetic (1)</a></p>
<h3 id="-">其他分类</h3>
</li>
<li><p><a href="http://hainanhaian.javaeye.com/blog/favorite" target="_blank">我的收藏</a> (42)</p>
</li>
<li><a href="http://hainanhaian.javaeye.com/blog/forum" target="_blank">我的论坛帖子</a> (10)</li>
<li><a href="http://hainanhaian.javaeye.com/blog/article" target="_blank">我的精华良好贴</a> (0)</li>
</ul>
<h3 id="-">最近加入圈子</h3>
<ul>
<li><a href="http://css.group.javaeye.com/" target="_blank">CSS探讨</a></li>
<li><a href="http://english.group.javaeye.com/" target="_blank">英语学习</a></li>
<li><p><a href="http://wfp.group.javaeye.com/" target="_blank">函数式编程の道</a></p>
<h3 id="-">链接</h3>
</li>
<li><p><a href="http://www.newairbbs.cn/" target="_blank">新空气bbs</a></p>
</li>
</ul>
<h3 id="-">存档</h3>
<ul>
<li><a href="http://hainanhaian.javaeye.com/blog/monthblog/2009-01" target="_blank">2009-01</a> (1)</li>
<li><a href="http://hainanhaian.javaeye.com/blog/monthblog/2008-11" target="_blank">2008-11</a> (3)</li>
<li><a href="http://hainanhaian.javaeye.com/blog/monthblog/2008-10" target="_blank">2008-10</a> (11)</li>
<li><p><a href="http://hainanhaian.javaeye.com/blog/monthblog_more" target="_blank">更多存档...</a></p>
<h3 id="-">最新评论</h3>
</li>
<li><p><a href="http://hainanhaian.javaeye.com/blog/248515#comments" title="Javascript中最常用的55个经典技巧" target="_blank">Javascript中最常用的55个 ...</a>
经典可以谈得上，但是建议“常用”换成“鲜为人知”、“实用”
-- by <a href="http://walkman.javaeye.com/" target="_blank">walkman</a></p>
</li>
<li><a href="http://hainanhaian.javaeye.com/blog/248219#comments" title="程序员谈如何掌握计算机专业英语" target="_blank">程序员谈如何掌握计算机专 ...</a>
dayang2001911 写道我现在正在读《design patterns》深 ...
-- by <a href="http://hainanhaian.javaeye.com/" target="_blank">hainanhaian</a></li>
<li><a href="http://hainanhaian.javaeye.com/blog/248219#comments" title="程序员谈如何掌握计算机专业英语" target="_blank">程序员谈如何掌握计算机专 ...</a>
我现在正在读《design patterns》深入浅出版的，影印版，英语通俗易懂， ...
-- by <a href="http://dayang2001911.javaeye.com/" target="_blank">dayang2001911</a></li>
</ul>
<h3 id="-">评论排行榜</h3>
<ul>
<li><a href="http://hainanhaian.javaeye.com/blog/256008" title="java,jsp获取网页源码内容的三种代码方法" target="_blank">java,jsp获取网页源码内容的三种代码方法</a></li>
<li><a href="http://hainanhaian.javaeye.com/blog/318576" title="ANT十五大最佳实践" target="_blank">ANT十五大最佳实践</a></li>
<li><a href="http://hainanhaian.javaeye.com/blog/266896" title="Servlet上传文件打水印生成缩略图" target="_blank">Servlet上传文件打水印生成缩略图</a></li>
<li><a href="http://hainanhaian.javaeye.com/blog/274092" title="JAVA 如何创建\删除\修改\复制目录及文件" target="_blank">JAVA 如何创建\删除\修改\复制目录及文 ...</a></li>
<li><a href="http://hainanhaian.javaeye.com/blog/260844" title="javascript常用小技巧" target="_blank">javascript常用小技巧</a></li>
<li><a href="http://hainanhaian.javaeye.com/rss" target="_blank"><img src="" alt="Rss"></a></li>
<li><a href="http://fusion.google.com/add?feedurl=http://hainanhaian.javaeye.com/rss" target="_blank"><img src="" alt="Rss_google"></a></li>
<li><a href="http://www.zhuaxia.com/add_channel.php?url=http://hainanhaian.javaeye.com/rss" target="_blank"><img src="" alt="Rss_zhuaxia"></a></li>
<li><a href="http://www.xianguo.com/subscribe.php?url=http://hainanhaian.javaeye.com/rss" target="_blank"><img src="" alt="Rss_xianguo"></a></li>
<li><a href="http://www.google.com/search?hl=zh-CN&amp;q=RSS" target="_blank">[什么是RSS?]</a>
声明：JavaEye文章版权属于作者，受法律保护。没有作者书面许可不得转载。若作者同意转载，必须以超链接形式标明文章原始出处和作者。
© 2003-2009 JavaEye.com. All rights reserved. 上海炯耐计算机软件有限公司 [ 沪ICP备05023328号 ]
<a href="http://hainanhaian.javaeye.com/blog/248515#" target="_blank">说点啥吧 <img src="" alt="Chat"></a></li>
</ul>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/JS用法/">JS用法</a></li></span></span> | <span class="tags">Tagged <a href="/tags/JS用法/" class="label label-primary">JS用法</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:28"datetime="2014-03-07 09:54:28"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-JS用法--Javascript中最常用的55个经典技巧/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-JS用法--Javascript中最常用的55个经典技巧" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-JS用法--Ajax缓存解决办法/">Ajax缓存解决办法 </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:27.000Z"> <a href="/2014/02/02/2014-02-02-JS用法--Ajax缓存解决办法/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="ajax-">Ajax缓存解决办法</h1>
<h3 id="-http-www-cnblogs-com-quange-"><a href="http://www.cnblogs.com/quange/" target="_blank">全哥</a></h3>
<h6 id="-">不断学习,努力超越自己.</h6>
<p>转载一篇文章,在做聊天室的过程中困惑我很久的一个问题.呵呵,太感谢作者了.原文如下:</p>
<p>项目有时要用一些Ajax的效果，因为比较简单，也就没有去用什么Ajax.net之类的东西，手写代码也就实现了。、</p>
<p>第二天，有人向我报告错误；说是只有第一次读取的值正常，后面的值都不正常；我调试了一下 ，确实有这样的问题，查出是因为AJAX缓存的问题：解决办法有如下几种:</p>
<p><strong>      1、</strong>在服务端加 header(&quot;Cache-Control: no-cache, must-revalidate&quot;);(如php中)</p>
<p><strong>2、</strong>在ajax发送请求前加上 anyAjaxObj.setRequestHeader(&quot;If-Modified-Since&quot;,&quot;0&quot;);</p>
<p><strong>3、</strong>在ajax发送请求前加上 anyAjaxObj.setRequestHeader(&quot;Cache-Control&quot;,&quot;no-cache&quot;);</p>
<p><strong>4、</strong>在 Ajax 的 URL 参数后加上 &quot;?fresh=&quot; + Math.random(); //当然这里参数 fresh 可以任意取了</p>
<p><strong>5、</strong>第五种方法和第四种类似，在 URL 参数后加上 &quot;?timestamp=&quot; + new Date().getTime();</p>
<p><strong>6、</strong>用POST替代GET：不推荐</p>
<p>1、加个随机数
      xmlHttp.open(&quot;GET&quot;, &quot;ajax.asp?now=&quot; + new Date().getTime(), true);
2、在要异步获取的asp页面中写一段禁止缓存的代码：
      Response.Buffer =True
      Response.ExpiresAbsolute =Now() - 1
      Response.Expires=0
      Response.CacheControl=&quot;no-cache&quot;</p>
<p>3、在ajax发送请求前加上xmlHTTP.setRequestHeader(&quot;If-Modified-Since&quot;,&quot;0&quot;);可以禁止缓存
      xmlHTTP.open(&quot;get&quot;, URL, true);
      xmlHTTP.onreadystatechange = callHTML;
      xmlHTTP.setRequestHeader(&quot;If-Modified-Since&quot;,&quot;0&quot;);
      xmlHTTP.send();</p>
<p>另一个作者写到:
AJAX的缓存是由浏览器维持的，对于发向服务器的某个url，ajax仅在第一次请求时与服务器交互信息，之后的请求中，ajax不再向服务器提交请求，而是直接从缓存中提取数据。
有些情况下，我们需要每一次都从服务器得到更新后数据。思路是让每次请求的url都不同，而又不影响正常应用：在url之后加入随机内容。
e.g.
url=url+&quot;&amp;&quot;+Math.random();
Key points:
1.每次请求的url都不一样（ajax的缓存便不起作用）</p>
<h2 id="2-">2.不影响正常应用（最基本的）</h2>
<p>方法二：（未经证实）
在JSP中禁止缓存
response.addHeader(&quot;Cache-Control&quot;, &quot;no-cache&quot;);
response.addHeader(&quot;Expires&quot;, &quot;Thu, 01 Jan 1970 00:00:01 GMT&quot;);
HTTP:</p>
<p><META HTTP-EQUIV="pragma" CONTENT="no-cache"></p>
<p><META HTTP-EQUIV="Cache-Control" CONTENT="no-cache, must-revalidate"></p>
<p><META HTTP-EQUIV="expires" CONTENT="Wed, 26 Feb 1997 08:21:57 GMT"></p>
<META HTTP-EQUIV="expires" CONTENT="0">

<p>另一个作者写到:</p>
<p>我们都知道，ajax能提高页面载入的速度的主要原因是通过ajax减少了重复数据的载入，真正做到按需获取，既然如此，我们在写ajax程序的时候不妨送佛送到西，在客户端再做一次缓存,进一步提高数据载入速度。那就是在载入数据的同时将数据缓存在浏览器内存中，一旦数据被载入，只要页面未刷新，该数据就永远的缓存在内存中，当用户再次查看该数据时，则不需要从服务器上去获取数据，极大的降低了服务器的负载和提高了用户的体验。</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/JS用法/">JS用法</a></li></span></span> | <span class="tags">Tagged <a href="/tags/JS用法/" class="label label-primary">JS用法</a></span> | <span class="time">recent updated:<time title="2014-04-07 17:07:51"datetime="2014-04-07 17:07:51"> abr. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-JS用法--Ajax缓存解决办法/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-JS用法--Ajax缓存解决办法" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>





<ul id="pagination" class="pagination pagination-lg">
  <li><a class="extend prev" href="/page/154/">&laquo;</a></li><li><a class="page-number" href="/">1</a></li><li><a class="page-number" href="/page/2/">2</a></li><li><span class="space">&hellip;</span></li><li><a class="page-number" href="/page/152/">152</a></li><li><a class="page-number" href="/page/153/">153</a></li><li><a class="page-number" href="/page/154/">154</a></li><li class="active"><li><span class="page-number current">155</span></li><li><a class="page-number" href="/page/156/">156</a></li><li><a class="page-number" href="/page/157/">157</a></li><li><a class="page-number" href="/page/158/">158</a></li><li><span class="space">&hellip;</span></li></li><li><a class="page-number" href="/page/161/">161</a></li><li><a class="page-number" href="/page/162/">162</a></li><li><a class="extend next" href="/page/156/">&raquo;</a></li>
  <div class="clearfix"></div>
</ul></div><!--wapper-->
       </div><!-- ID main-col END -->
       <aside id="sidebar" class="alignright col-sx-6 col-sm-4 col-md-3 col-lg-3">
<div id="widget_search" class="widget panel panel-primary">
    <form action="//google.com/search" method="get" accept-charset="utf-8">
  <div class="input-group">
    <input class="form-control" id="searchbox" type="search" name="q" results="0" placeholder="search">
    <span class="input-group-btn">
      <button class="btn btn-default" type="submit">Go!</button>
    </span>
    <input type="hidden" name="q" value="site:itsolife.com">
  </div>
</form>
</div>

<div id="widget_category" class="widget panel panel-primary">
  <div class="panel-heading">category</div>  <div data-src='category' class='ajax_widgets'>正在加载...</div>
</div>

<div id="widget_recent_posts" class="widget panel panel-primary">
  <div class="panel-heading">recent posts</div>  <div data-src='recent_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_tagcloud" class="widget panel panel-primary">
  <div class="panel-heading">tagcloud</div>  <div data-src='tagcloud' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_latest_update_posts" class="widget panel panel-primary">
  <div class="panel-heading">最近更新</div>  <div data-src='latest_update_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_recent_comments" class="widget panel panel-primary">
  <div class="panel-heading">recent comments</div>  

<div class="list-group-item ds-recent-comments" data-num-items="6" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="50"></div>



</div>

</aside>
       <div class="clearfix"></div>
     </div><!-- row END -->
  </div>
  <footer id="footer" class="container">
  <div class="panel panel-info">
  <section id='footer_widget'></section>  <div class="panel-footer">
  <div id="site-info">
    <span class='author'>
  
  &copy; 2014 RobinChia
  
    &nbsp;&nbsp;</span>
  
  <span id='analytics-51la'></span><span id='analytics-google'>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-48559895-1']);
  _gaq.push(['_trackPageview']);
  _js2load.push({src:('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'});
</script></span><span id='analytics-cnzz'>
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_5774006'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s17.cnzz.com/stat.php%3Fid%3D5774006%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
</span><span id='analytics-baidu'>
<script>
var _hmt = _hmt || [];
_js2load.push({src:"//hm.baidu.com/hm.js?1442f50724afc42380b51f097c43082c"});
</script>
</span>  </div>
  <div id="copyright">Site powered by <a href='http://zespia.tw/hexo/'><strong>hexo</strong></a>  update time: <em>2014-04-07 19:25:40</em></span></div>
</div>
<div class="clearfix"></div>


  </div>
  </footer>
  
        <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>        
        <script src="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/js/bootstrap.min.js"></script>        
                
        <script src="http://cdn.bootcss.com/prettify/r298/prettify.min.js"></script>    <script type="text/javascript">
   var lang=["bsh", "c", "cc", "cpp", "cs", "csh", "cyc", "cv", "htm", "html",
    "java", "js", "m", "mxml", "perl", "pl", "pm", "py", "rb", "sh",
    "xhtml", "xml", "xsl"];
   var pretty_base='';
   $('script').each(function(){
	var c = $(this).attr('src');
	if (!c)
	    return;
	if (c.match(/(\/)?prettify(\.min)?\.js/i))
	{
	    var index = c.lastIndexOf('/');
	    if (index != -1)
		pretty_base = c.substr(0,index + 1);
	    return false;
	}
   })
   $('pre code').each(function(){
	var c = $(this).attr('class')
	if (!c)
	    return;
	c = c.match(/\s?(lang\-\w+)/i);
	if (c && lang.indexOf(c[1]) == -1)
	{
	    lang.push(c[1]);
	    $.getScript(pretty_base + c[1] + '.min.js');
	}
   })

    $(window).load(function(){
       $("pre").addClass("prettyprint");
       prettyPrint();
    })
</script>    
            <script type="text/javascript">
var duoshuoQuery = {short_name:"robinchia"};
_js2load.push({src:'http://static.duoshuo.com/embed.js',charset:'UTF-8'});
</script>
    
            <!--wumii_relatedItems-->
    
        <script src="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js"></script>    <script type="text/javascript">
(function($){
  $('.entry').each(function(i){
    $(this).find('img').each(function(){
      var alt = this.alt;

      if (alt){
        $(this).before('<span class="caption">' + alt + '</span>');
      }

      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="fancybox' + i + '" />');
    });
  });

  $('.fancybox').fancybox();
})(jQuery);
</script>    
        <script src="http://cdn.bootcss.com/mathjax/2.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>
    
<script type="text/javascript">
$('.ajax_widgets').each(function(){var src=$(this).attr('data-src');if(src)$(this).load('/widgets/'+src+'.html');});
$.each(_js2load,function(index,obj){loadjs(obj.src,obj.charset)});
</script>

<div id="scroll2top">
<img src="/scroll2top/arrow.png"/>
</div>
<script src="/scroll2top/scroll2top.min.js"></script>
<div id="winterland">
  <canvas></canvas>
</div>
<script src="/js/winterland.min.js"></script>

  </body>
</html>
