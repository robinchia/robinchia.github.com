
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>The 37 Page | It so life</title>
<meta name="author" content="RobinChia">

<meta name="description" content="It so life">


<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta property="og:site_name" content="It so life"/>

<!--[if IE]><style>.testIE.IE{display:inline;}</style><![endif]-->
<!--[if lte IE 7]><link rel="stylesheet" href="/css/ie7.css" type="text/css"><![endif]-->
<!--[if (lt IE 9)&(gt IE 7)]><style>.testIE.IE8{display:inline;}</style><![endif]-->
<!--[if gt IE 8]><style>.testIE.IE9{display:inline;}</style><![endif]-->

<link href="/favicon.png" rel="icon">
<link rel="alternate" href="/atom.xml" title="It so life Feed" type="application/atom+xml">

<link rel="stylesheet" href="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.0.3/css/font-awesome.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/prettify/r298/prettify.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" type="text/css">
<link rel="stylesheet" href="/css/style.css" type="text/css">
<!--[if lt IE 9]>
   <style>article,aside,dialog,footer,header,section,footer,nav,figure,menu{display:block}</style>
   <script src="http://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
   <script src="http://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
<link href="http://cdn.staticfile.org/respond.js/1.4.2/respond-proxy.html" id="respond-proxy" rel="respond-proxy" />
<link href="/js/respond.proxy.gif" id="respond-redirect" rel="respond-redirect" />
<script src="/js/respond.proxy.js"></script>
   <script src="http://cdn.bootcss.com/selectivizr/1.0.2/selectivizr-min.js"></script>
<![endif]-->
<script type="text/javascript">
function loadjs(c,d){var a=document.createElement("script");a.async=!0;a.type="text/javascript";a.src=c;a.charset=d||"gbk";(document.getElementsByTagName("HEAD")[0]||document.getElementsByTagName("BODY")[0]).appendChild(a)};
var _protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
var _js2load = [];
</script>

</head>
<body>
      <header id="header" class="container"><nav id="main-nav" class="navbar navbar-default navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="/">It so life</a>
    </div>
    <div  class="collapse navbar-collapse">
      <ul  class="nav navbar-nav">
  
        <li><a href="/" title="Home">Home</a></li>      
        <li><a href="/about/" title="About">About</a></li>      
        <li><a href="/archives/" title="Archives">Archives</a></li>      
      <li class='dropdown'>
        <a class='dropdown-toggle' data-toggle='dropdown' href='#'>website<b class='caret'></b></a>
        <ul class='dropdown-menu pure-menu-selected'>
    
          <li><a href="//groups.google.com/forum/#!forum/pongba" title="TopLanguage">TopLanguage</a></li>    
          <li><a href="//itpub.net/" title="ITPub">ITPub</a></li>    
          <li><a href="//blog.jobbole.com/" title="Bole">Bole</a></li>    
          <li><a href="//nosql-database.org/" title="nosql">nosql</a></li>    
          <li><a href="//gitimmersion.googol.im/" title="Git">Git</a></li>    
        </ul>
      </li>
    
      </ul>
      <ul class="nav navbar-nav navbar-right">
      
        <li><a href="/atom.xml">RSS</a></li>
      
      
        <li><a href="https://twitter.com/robinchia">twitter</a></li>
      
      
      
      
        <li><a href="https://github.com/robinchia">github</a></li>
      
      </ul>
    </div>
  </div>
</nav>
<div class="clearfix"></div>
</header>
  <div id='content' class="container">
     <div class="page-header-wrapper">
      <!--[if lt IE 9]><div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong>提示:</strong>您的浏览器版本太低了,建议升级到 <strong><a href="http://windows.microsoft.com/zh-cn/internet-explorer/download-ie" title="IE9">IE9</a></strong> 以上,本站使用<a href="https://www.google.com/intl/zh-CN/chrome/">Chrome浏览器</a>可以获得最好的显示效果.</div><![endif]-->
      <div class="page-header"><h1 align="center"><big>It so life</big> </h1>
        <h5 align="center"><big>love as life</big></h5>
      </div>
     </div>
     <div class="row">
       <div id="main-col" class="alignleft col-sx-12 col-sm-8 col-md-9 col-lg-9">
      <section id='header_widget'></section>
          <div id="wrapper"><article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-JavaJ2EE-Java_总结类--我的重构哪里不规范？-软件测试/">我的重构哪里不规范？ </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:43.000Z"> <a href="/2014/02/02/2014-02-02-JavaJ2EE-Java_总结类--我的重构哪里不规范？-软件测试/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-">我的重构哪里不规范？ - 软件测试</h1>
<p><a href="http://www.javaeye.com/login" title="登录" target="_blank">您还未登录 !</a><a href="http://www.javaeye.com/all" target="_blank">我的应用</a><a href="http://www.javaeye.com/login" target="_blank">登录</a><a href="http://www.javaeye.com/signup" target="_blank">注册</a></p>
<p><a href="http://www.javaeye.com/" target="_blank"><img src="&quot;JavaEye-最棒的软件开发交流社区&quot;" alt="JavaEye-最棒的软件开发交流社区"></a></p>
<p><a href="http://www.javaeye.com/forums" target="_blank">论坛首页</a> →<a href="http://www.javaeye.com/forums/board/develop" target="_blank">软件开发和项目管理版</a> →<a href="http://www.javaeye.com/forums/tag/test" target="_blank">软件测试</a> →</p>
<h1 id="-">我的重构哪里不规范？</h1>
<p><a href="http://www.javaeye.com/forums/board/develop" target="_blank">全部</a><a href="http://www.javaeye.com/forums/tag/project-manage" target="_blank">项目管理</a><a href="http://www.javaeye.com/forums/tag/agile" target="_blank">敏捷开发</a><a href="http://www.javaeye.com/forums/tag/test" target="_blank">软件测试</a><a href="http://www.javaeye.com/forums/tag/configuration" target="_blank">配置管理</a><a href="http://www.javaeye.com/forums/tag/UseCase" target="_blank">UseCase</a><a href="http://www.javaeye.com/forums/tag/UML" target="_blank">UML</a><a href="http://www.javaeye.com/forums/tag/unitest" target="_blank">单元测试</a><a href="http://www.javaeye.com/forums/tag/XP" target="_blank">XP</a><a href="http://www.javaeye.com/forums/tag/TDD" target="_blank">TDD</a><a href="http://www.javaeye.com/forums/tag/UP" target="_blank">UP</a><a href="http://www.javaeye.com/forums/tag/CMM" target="_blank">CMM</a>
« 上一页 1 <a href="http://www.javaeye.com/topic/90347?page=2" target="_blank">2</a> <a href="http://www.javaeye.com/topic/90347?page=3" target="_blank">3</a> <a href="http://www.javaeye.com/topic/90347?page=4" target="_blank">4</a> <a href="http://www.javaeye.com/topic/90347?page=5" target="_blank">5</a> <a href="http://www.javaeye.com/topic/90347?page=2" target="_blank">下一页 »</a></p>
<p>浏览 17393 次 锁定老贴子 <a href="">主题：我的重构哪里不规范？</a></p>
<p>精华帖 (3) :: 良好帖 (0) :: 新手帖 (0) :: 隐藏帖 (1) 作者 正文 * ojava</p>
<ul>
<li>等级: 初级会员</li>
<li><a href="http://ojava.javaeye.com/" target="_blank"><img src="&quot;ojava的博客: ojava&quot;" alt="ojava的博客"></a></li>
<li>文章: 7</li>
<li>积分: 33</li>
<li>来自: 烟台</li>
<li><img src="" alt="">
  发表时间：2007-06-15  </li>
</ul>
<p><a href="http://www.javaeye.com/topic/90347#" target="_blank">&lt;</a><a href="http://www.javaeye.com/topic/90347#" target="_blank">&gt;</a>猎头职位:   <a href="http://www.javaeye.com/jobs/712" target="_blank">北京:  Java搜索工程师</a></p>
<p>相关文章: <a href="http://www.javaeye.com/topic/90347#" title="关闭" target="_blank"> </a></p>
<ul>
<li><a href="http://www.javaeye.com/topic/416297" title="你们的项目经常重构代码吗？" target="_blank">你们的项目经常重构代码吗？</a></li>
<li><a href="http://www.javaeye.com/topic/460125" title="重构的几大重要特点" target="_blank">重构的几大重要特点</a></li>
<li><a href="http://www.javaeye.com/topic/6426" title="讨论：重构的前提是不是 TDD" target="_blank">讨论：重构的前提是不是 TDD</a>
推荐圈子: <a href="http://mars.group.javaeye.com/" target="_blank">火星常驻JE办事处</a>
<a href="http://www.javaeye.com/wiki/topic/90347" target="_blank">更多相关推荐</a>
在项目中，由于没有经过大脑思考，结果产生了流水账形式的代码。
流水账代码：就是根据是详细设计书把整个业务的流程顺序完成到一个类的一个方法中，
而没有根据功能划分成若干个小的方法。
这种流水账式的代码非常不容易测试，因为详细设计中已经将设计细化到对字符串如何操作了，
所以从这样的设计书的高度看业务，简直就是乱七八糟！
所幸，还有重构这个工具，就重构，发现很多的局部变量，因为在多处改变值，而且后续还要使用，
所以只能把这种变量，提到类变量的高度，好多啊。
这样一来，
1。如果要用junit测试，还需要再给相应的提出来的变量加上set,get方法。
2。因为重构出来的方法都是private的，所以测试的时候还要用反射的方法。
上面这两种情况可以避免吗？这是一个问题。
还有一个对自己的警告：小心费力不讨好！
声明：JavaEye文章版权属于作者，受法律保护。没有作者书面许可不得转载。</li>
</ul>
<p>推荐链接</p>
<ul>
<li><a href="http://www.javaeye.com/clicks/373" target="_blank"><img src="&quot;adobe&quot;" alt="adobe"></a> <a href="http://www.javaeye.com/topic/90347#" target="_blank">返回顶楼</a> <a href="http://ojava.javaeye.com/" title="浏览作者的博客" target="_blank"> </a><a href="http://ojava.javaeye.com/blog/profile" title="浏览作者资料" target="_blank"> </a><a href="http://app.javaeye.com/messages/new?message%5Breceiver_name%5D=ojava" title="发送站内短信" target="_blank"> </a><a href="http://ojava.javaeye.com/blog/guest_book" title="给作者留言" target="_blank"> </a><a href="http://app.javaeye.com/feed?subscription%5Bsubscribed_user_name%5D=ojava" title="关注作者" target="_blank"> </a> * Xiaohanne</li>
<li>等级: <img src="&quot;四星会员&quot;" alt="四星会员"></li>
<li><a href="http://xiaohanne.javaeye.com/" target="_blank"><img src="&quot;Xiaohanne的博客: Xiaohanne&quot;" alt="Xiaohanne的博客"></a></li>
<li>文章: 183</li>
<li>积分: 389</li>
<li><img src="" alt="">
  发表时间：2007-06-15  </li>
</ul>
<p>面向接口不要面向实现，谢谢 <a href="http://www.javaeye.com/topic/90347#" target="_blank">返回顶楼</a> <a href="http://xiaohanne.javaeye.com/" title="浏览作者的博客" target="_blank"> </a><a href="http://xiaohanne.javaeye.com/blog/profile" title="浏览作者资料" target="_blank"> </a><a href="http://app.javaeye.com/messages/new?message%5Breceiver_name%5D=Xiaohanne" title="发送站内短信" target="_blank"> </a><a href="http://xiaohanne.javaeye.com/blog/guest_book" title="给作者留言" target="_blank"> </a><a href="http://app.javaeye.com/feed?subscription%5Bsubscribed_user_name%5D=Xiaohanne" title="关注作者" target="_blank"> </a><a href="http://www.javaeye.com/topic/90347#312955" title="Xiaohanne回帖:我的重构哪里不规范？" target="_blank">回帖地址</a></p>
<p><a href="http://www.javaeye.com/topic/90347#" title="好" target="_blank">0</a> <a href="http://www.javaeye.com/topic/90347#" title="差" target="_blank">0</a> 请登录后投票 * 抛出异常的爱</p>
<ul>
<li>等级: <img src="&quot;五钻会员&quot;" alt="五钻会员"></li>
<li><a href="http://loveexception.javaeye.com/" target="_blank"><img src="&quot;抛出异常的爱的博客: 设计可以拯救国家&quot;" alt="抛出异常的爱的博客"></a></li>
<li>文章: 12050</li>
<li>积分: 2782</li>
<li>来自: 北京</li>
<li><a href="http://www.javaeye.com/topic/743366" title="我正在看《纪念coding之路.祝福所有的coder都可以实现自己的梦想》" target="_blank"><img src="" alt=""></a>
  发表时间：2007-06-15  </li>
</ul>
<p><strong>ojava 写道：</strong>
在项目中，由于没有经过大脑思考，结果产生了流水账形式的代码。
流水账代码：就是根据是详细设计书把整个业务的流程顺序完成到一个类的一个方法中，
而没有根据功能划分成若干个小的方法。
这种新式的代码非常不容易测试，因为详细设计中已经将设计细化到对字符串如何操作了，
所以从这样的设计书的高度看业务，简直就是乱七八糟！
所幸，还有重构这个工具，就重构，发现很多的局部变量，因为在多处改变值，而且后续还要使用，
所以只能把这种变量，提到类变量的高度，好多啊。
这样一来，
1。如果要用junit测试，还需要再给相应的提出来的变量加上set,get方法。
2。因为重构出来的方法都是private的，所以测试的时候还要用反射的方法。
上面这两种情况可以避免吗？这是一个问题。
还有一个对自己的警告：小心费力不讨好！
无设计，无定义（对每个类与方法），无规则，的重构。。。叶公好龙 <a href="http://www.javaeye.com/topic/90347#" target="_blank">返回顶楼</a> <a href="http://loveexception.javaeye.com/" title="浏览作者的博客" target="_blank"> </a><a href="http://loveexception.javaeye.com/blog/profile" title="浏览作者资料" target="_blank"> </a><a href="http://app.javaeye.com/messages/new?message%5Breceiver_name%5D=%E6%8A%9B%E5%87%BA%E5%BC%82%E5%B8%B8%E7%9A%84%E7%88%B1" title="发送站内短信" target="_blank"> </a><a href="http://loveexception.javaeye.com/blog/guest_book" title="给作者留言" target="_blank"> </a><a href="http://app.javaeye.com/feed?subscription%5Bsubscribed_user_name%5D=%E6%8A%9B%E5%87%BA%E5%BC%82%E5%B8%B8%E7%9A%84%E7%88%B1" title="关注作者" target="_blank"> </a><a href="http://www.javaeye.com/topic/90347#312962" title="抛出异常的爱回帖:我的重构哪里不规范？" target="_blank">回帖地址</a></p>
<p><a href="http://www.javaeye.com/topic/90347#" title="好" target="_blank">0</a> <a href="http://www.javaeye.com/topic/90347#" title="差" target="_blank">0</a> 请登录后投票 * ojava</p>
<ul>
<li>等级: 初级会员</li>
<li><a href="http://ojava.javaeye.com/" target="_blank"><img src="&quot;ojava的博客: ojava&quot;" alt="ojava的博客"></a></li>
<li>文章: 7</li>
<li>积分: 33</li>
<li>来自: 烟台</li>
<li><img src="" alt="">
  发表时间：2007-06-15  </li>
</ul>
<p>无设计，无定义（对每个类与方法），无规则，的重构。。。叶公好龙
这句话，一针见血！！！
刚学习测试，准备在项目中实践，结果发现自己的代码根本没有办法测试，因为这个巨大的方法太大，看不清要实现的业务是什么！
头脑中就是因为缺少测试的思想，才导致出现这样的问题，果然没有思想是不行的，亡羊补牢，现在晚了吗？ <a href="http://www.javaeye.com/topic/90347#" target="_blank">返回顶楼</a> <a href="http://ojava.javaeye.com/" title="浏览作者的博客" target="_blank"> </a><a href="http://ojava.javaeye.com/blog/profile" title="浏览作者资料" target="_blank"> </a><a href="http://app.javaeye.com/messages/new?message%5Breceiver_name%5D=ojava" title="发送站内短信" target="_blank"> </a><a href="http://ojava.javaeye.com/blog/guest_book" title="给作者留言" target="_blank"> </a><a href="http://app.javaeye.com/feed?subscription%5Bsubscribed_user_name%5D=ojava" title="关注作者" target="_blank"> </a><a href="http://www.javaeye.com/topic/90347#312971" title="ojava回帖:我的重构哪里不规范？" target="_blank">回帖地址</a></p>
<p><a href="http://www.javaeye.com/topic/90347#" title="好" target="_blank">0</a> <a href="http://www.javaeye.com/topic/90347#" title="差" target="_blank">0</a> 请登录后投票 * gigix</p>
<ul>
<li>等级: <img src="&quot;资深会员&quot;" alt="资深会员">资深会员</li>
<li><a href="http://gigix.javaeye.com/" target="_blank"><img src="&quot;gigix的博客: 透明之眼&quot;" alt="gigix的博客"></a></li>
<li>文章: 4810</li>
<li>积分: 2991</li>
<li>来自: 北京</li>
<li><img src="" alt="">
  发表时间：2007-06-15  </li>
</ul>
<p>First of all you should have tests for you original method.
During your refactoring those test should always pass.
So you don&#39;t have to test new (and quite possible private) methods/fields you extract out. <a href="http://www.javaeye.com/topic/90347#" target="_blank">返回顶楼</a> <a href="http://gigix.javaeye.com/" title="浏览作者的博客" target="_blank"> </a><a href="http://gigix.javaeye.com/blog/profile" title="浏览作者资料" target="_blank"> </a><a href="http://app.javaeye.com/messages/new?message%5Breceiver_name%5D=gigix" title="发送站内短信" target="_blank"> </a><a href="http://gigix.javaeye.com/blog/guest_book" title="给作者留言" target="_blank"> </a><a href="http://app.javaeye.com/feed?subscription%5Bsubscribed_user_name%5D=gigix" title="关注作者" target="_blank"> </a><a href="http://www.javaeye.com/topic/90347#312973" title="gigix回帖:我的重构哪里不规范？" target="_blank">回帖地址</a></p>
<p><a href="http://www.javaeye.com/topic/90347#" title="好" target="_blank">0</a> <a href="http://www.javaeye.com/topic/90347#" title="差" target="_blank">1</a> 请登录后投票 * 抛出异常的爱</p>
<ul>
<li>等级: <img src="&quot;五钻会员&quot;" alt="五钻会员"></li>
<li><a href="http://loveexception.javaeye.com/" target="_blank"><img src="&quot;抛出异常的爱的博客: 设计可以拯救国家&quot;" alt="抛出异常的爱的博客"></a></li>
<li>文章: 12050</li>
<li>积分: 2782</li>
<li>来自: 北京</li>
<li><a href="http://www.javaeye.com/topic/743366" title="我正在看《纪念coding之路.祝福所有的coder都可以实现自己的梦想》" target="_blank"><img src="" alt=""></a>
  发表时间：2007-06-15  </li>
</ul>
<p>gigix 写道</p>
<p>First of all you should have tests for you original method.
During your refactoring those test should always pass.
So you don&#39;t have to test new (and quite possible private) methods/fields you extract out.
是的，不用再加测试了，先写着，
不过对于拿不准的，写出来出错看不出来，找不到错的
还是要写中间测试帮助编码
PS:如果要测试中间的private方法，可以写在主函数中一个
public XXX (){ return 你要测试的方法 ；}
PS：天啊。。。变的够快。。。认不出来了 <a href="http://www.javaeye.com/topic/90347#" target="_blank">返回顶楼</a> <a href="http://loveexception.javaeye.com/" title="浏览作者的博客" target="_blank"> </a><a href="http://loveexception.javaeye.com/blog/profile" title="浏览作者资料" target="_blank"> </a><a href="http://app.javaeye.com/messages/new?message%5Breceiver_name%5D=%E6%8A%9B%E5%87%BA%E5%BC%82%E5%B8%B8%E7%9A%84%E7%88%B1" title="发送站内短信" target="_blank"> </a><a href="http://loveexception.javaeye.com/blog/guest_book" title="给作者留言" target="_blank"> </a><a href="http://app.javaeye.com/feed?subscription%5Bsubscribed_user_name%5D=%E6%8A%9B%E5%87%BA%E5%BC%82%E5%B8%B8%E7%9A%84%E7%88%B1" title="关注作者" target="_blank"> </a><a href="http://www.javaeye.com/topic/90347#312979" title="抛出异常的爱回帖:我的重构哪里不规范？" target="_blank">回帖地址</a></p>
<p><a href="http://www.javaeye.com/topic/90347#" title="好" target="_blank">0</a> <a href="http://www.javaeye.com/topic/90347#" title="差" target="_blank">0</a> 请登录后投票 * gigix</p>
<ul>
<li>等级: <img src="&quot;资深会员&quot;" alt="资深会员">资深会员</li>
<li><a href="http://gigix.javaeye.com/" target="_blank"><img src="&quot;gigix的博客: 透明之眼&quot;" alt="gigix的博客"></a></li>
<li>文章: 4810</li>
<li>积分: 2991</li>
<li>来自: 北京</li>
<li><img src="" alt="">
  发表时间：2007-06-15  </li>
</ul>
<p>抛出异常的爱 写道</p>
<p>不过对于拿不准的，写出来出错看不出来，找不到错的
还是要写中间测试帮助编码
nope...
if you make any mistake during refactoring and break any test,
and if you can&#39;t fix it immediately,
you should revert to previous successful step immediately.
(that&#39;s why you should check in as frequently as you can.) <a href="http://www.javaeye.com/topic/90347#" target="_blank">返回顶楼</a> <a href="http://gigix.javaeye.com/" title="浏览作者的博客" target="_blank"> </a><a href="http://gigix.javaeye.com/blog/profile" title="浏览作者资料" target="_blank"> </a><a href="http://app.javaeye.com/messages/new?message%5Breceiver_name%5D=gigix" title="发送站内短信" target="_blank"> </a><a href="http://gigix.javaeye.com/blog/guest_book" title="给作者留言" target="_blank"> </a><a href="http://app.javaeye.com/feed?subscription%5Bsubscribed_user_name%5D=gigix" title="关注作者" target="_blank"> </a><a href="http://www.javaeye.com/topic/90347#313053" title="gigix回帖:我的重构哪里不规范？" target="_blank">回帖地址</a></p>
<p><a href="http://www.javaeye.com/topic/90347#" title="好" target="_blank">0</a> <a href="http://www.javaeye.com/topic/90347#" title="差" target="_blank">0</a> 请登录后投票 * 抛出异常的爱</p>
<ul>
<li>等级: <img src="&quot;五钻会员&quot;" alt="五钻会员"></li>
<li><a href="http://loveexception.javaeye.com/" target="_blank"><img src="&quot;抛出异常的爱的博客: 设计可以拯救国家&quot;" alt="抛出异常的爱的博客"></a></li>
<li>文章: 12050</li>
<li>积分: 2782</li>
<li>来自: 北京</li>
<li><a href="http://www.javaeye.com/topic/743366" title="我正在看《纪念coding之路.祝福所有的coder都可以实现自己的梦想》" target="_blank"><img src="" alt=""></a>
  发表时间：2007-06-15  </li>
</ul>
<p>gigix 写道</p>
<p>抛出异常的爱 写道</p>
<p>不过对于拿不准的，写出来出错看不出来，找不到错的
还是要写中间测试帮助编码
nope...
if you make any mistake during refactoring and break any test,
and if you can&#39;t fix it immediately,
you should revert to previous successful step immediately.
(that&#39;s why you should check in as frequently as you can.)
那么不动老的代码。。。
写新方法，新的测试，
所有需要的方法都写完了（小步前进？）
再一次把老的代码删去
用新的代码顶上？ <a href="http://www.javaeye.com/topic/90347#" target="_blank">返回顶楼</a> <a href="http://loveexception.javaeye.com/" title="浏览作者的博客" target="_blank"> </a><a href="http://loveexception.javaeye.com/blog/profile" title="浏览作者资料" target="_blank"> </a><a href="http://app.javaeye.com/messages/new?message%5Breceiver_name%5D=%E6%8A%9B%E5%87%BA%E5%BC%82%E5%B8%B8%E7%9A%84%E7%88%B1" title="发送站内短信" target="_blank"> </a><a href="http://loveexception.javaeye.com/blog/guest_book" title="给作者留言" target="_blank"> </a><a href="http://app.javaeye.com/feed?subscription%5Bsubscribed_user_name%5D=%E6%8A%9B%E5%87%BA%E5%BC%82%E5%B8%B8%E7%9A%84%E7%88%B1" title="关注作者" target="_blank"> </a><a href="http://www.javaeye.com/topic/90347#313088" title="抛出异常的爱回帖:我的重构哪里不规范？" target="_blank">回帖地址</a></p>
<p><a href="http://www.javaeye.com/topic/90347#" title="好" target="_blank">0</a> <a href="http://www.javaeye.com/topic/90347#" title="差" target="_blank">0</a> 请登录后投票 * gigix</p>
<ul>
<li>等级: <img src="&quot;资深会员&quot;" alt="资深会员">资深会员</li>
<li><a href="http://gigix.javaeye.com/" target="_blank"><img src="&quot;gigix的博客: 透明之眼&quot;" alt="gigix的博客"></a></li>
<li>文章: 4810</li>
<li>积分: 2991</li>
<li>来自: 北京</li>
<li><img src="" alt="">
  发表时间：2007-06-15  </li>
</ul>
<p>抛出异常的爱 写道</p>
<p>gigix 写道</p>
<p>抛出异常的爱 写道</p>
<p>不过对于拿不准的，写出来出错看不出来，找不到错的
还是要写中间测试帮助编码
nope...
if you make any mistake during refactoring and break any test,
and if you can&#39;t fix it immediately,
you should revert to previous successful step immediately.
(that&#39;s why you should check in as frequently as you can.)
那么不动老的代码。。。
写新方法，新的测试，
所有需要的方法都写完了
再一次把老的代码删去
用新的代码顶上？
please man...
what is &quot;refactoring&quot;?
answer: to improve the internal structure of code, WITHOUT CHANGING ITS EXTERNAL BEHAVIOR
when you refactoring, you move forward by SMALL STEPS. you remove the bad smells little by little, and always keep all tests passing. <a href="http://www.javaeye.com/topic/90347#" target="_blank">返回顶楼</a> <a href="http://gigix.javaeye.com/" title="浏览作者的博客" target="_blank"> </a><a href="http://gigix.javaeye.com/blog/profile" title="浏览作者资料" target="_blank"> </a><a href="http://app.javaeye.com/messages/new?message%5Breceiver_name%5D=gigix" title="发送站内短信" target="_blank"> </a><a href="http://gigix.javaeye.com/blog/guest_book" title="给作者留言" target="_blank"> </a><a href="http://app.javaeye.com/feed?subscription%5Bsubscribed_user_name%5D=gigix" title="关注作者" target="_blank"> </a><a href="http://www.javaeye.com/topic/90347#313092" title="gigix回帖:我的重构哪里不规范？" target="_blank">回帖地址</a></p>
<p><a href="http://www.javaeye.com/topic/90347#" title="好" target="_blank">0</a> <a href="http://www.javaeye.com/topic/90347#" title="差" target="_blank">0</a> 请登录后投票 * ojava</p>
<ul>
<li>等级: 初级会员</li>
<li><a href="http://ojava.javaeye.com/" target="_blank"><img src="&quot;ojava的博客: ojava&quot;" alt="ojava的博客"></a></li>
<li>文章: 7</li>
<li>积分: 33</li>
<li>来自: 烟台</li>
<li><img src="" alt="">
  发表时间：2007-06-15  </li>
</ul>
<p>公司新加代码规范条目：所定义的方法尽量不要超过100行。
某一方面来说，可以避免这种流水账式的代码吧！
并且强制我们进行Xiaohanne所说的面向接口不要面向实现的编程。 <a href="http://www.javaeye.com/topic/90347#" target="_blank">返回顶楼</a> <a href="http://ojava.javaeye.com/" title="浏览作者的博客" target="_blank"> </a><a href="http://ojava.javaeye.com/blog/profile" title="浏览作者资料" target="_blank"> </a><a href="http://app.javaeye.com/messages/new?message%5Breceiver_name%5D=ojava" title="发送站内短信" target="_blank"> </a><a href="http://ojava.javaeye.com/blog/guest_book" title="给作者留言" target="_blank"> </a><a href="http://app.javaeye.com/feed?subscription%5Bsubscribed_user_name%5D=ojava" title="关注作者" target="_blank"> </a><a href="http://www.javaeye.com/topic/90347#313239" title="ojava回帖:我的重构哪里不规范？" target="_blank">回帖地址</a></p>
<p><a href="http://www.javaeye.com/topic/90347#" title="好" target="_blank">0</a> <a href="http://www.javaeye.com/topic/90347#" title="差" target="_blank">0</a> 请登录后投票</p>
<p>« 上一页 1 <a href="http://www.javaeye.com/topic/90347?page=2" target="_blank">2</a> <a href="http://www.javaeye.com/topic/90347?page=3" target="_blank">3</a> <a href="http://www.javaeye.com/topic/90347?page=4" target="_blank">4</a> <a href="http://www.javaeye.com/topic/90347?page=5" target="_blank">5</a> <a href="http://www.javaeye.com/topic/90347?page=2" target="_blank">下一页 »</a>
<a href="http://www.javaeye.com/forums" target="_blank">论坛首页</a> →<a href="http://www.javaeye.com/forums/board/develop" target="_blank">软件开发和项目管理版</a>→ <a href="http://www.javaeye.com/forums/tag/test" target="_blank">软件测试</a>
跳转论坛:Java编程和Java企业应用Web前端技术 移动编程和手机应用开发C/C++编程Ruby编程Python编程 PHP编程Flash编程和RIA Microsoft .Net综合技术软件开发和项目管理行业应用 入门讨论招聘求职海阔天空</p>
<ul>
<li><a href="http://www.javaeye.com/" target="_blank">首页</a></li>
<li><a href="http://www.javaeye.com/news" target="_blank">新闻</a></li>
<li><a href="http://www.javaeye.com/forums" target="_blank">论坛</a></li>
<li><a href="http://www.javaeye.com/ask" target="_blank">问答</a></li>
<li><a href="http://www.javaeye.com/wiki" target="_blank">专栏</a></li>
<li><a href="http://www.javaeye.com/blogs" target="_blank">博客</a></li>
<li><a href="http://www.javaeye.com/groups" target="_blank">圈子</a></li>
<li><a href="http://www.javaeye.com/job" target="_blank">招聘</a></li>
<li><a href="http://www.javaeye.com/index/service" target="_blank">服务</a></li>
<li><a href="http://www.javaeye.com/search" target="_blank">搜索</a></li>
<li><a href="http://java.javaeye.com/" target="_blank">Java</a></li>
<li><a href="http://webapp.javaeye.com/" target="_blank">Web</a></li>
<li><a href="http://ruby.javaeye.com/" target="_blank">Ruby</a></li>
<li><a href="http://python.javaeye.com/" target="_blank">Python</a></li>
<li><a href="http://agile.javaeye.com/" target="_blank">敏捷</a></li>
<li><a href="http://mysql.javaeye.com/" target="_blank">MySQL</a></li>
<li><a href="http://runqian.javaeye.com/" target="_blank">润亁报表</a></li>
<li><a href="http://book.javaeye.com/" target="_blank">图书</a></li>
<li><a href="http://www.javaeye.com/index/service" target="_blank">广告服务</a></li>
<li><a href="http://webmaster.javaeye.com/" target="_blank">JavaEye黑板报</a></li>
<li><a href="http://www.javaeye.com/index/aboutus" target="_blank">关于我们</a></li>
<li><a href="http://www.javaeye.com/index/contactus" target="_blank">联系我们</a></li>
<li><a href="http://www.javaeye.com/index/friend_links" target="_blank">友情链接</a></li>
</ul>
<p>© 2003-2010 JavaEye.com. 上海炯耐计算机软件有限公司版权所有 [ <a href="http://www.miibeian.gov.cn/" target="_blank">沪ICP备05023328号</a> ]  <img src="" alt=""></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/Java&J2EE/">Java&J2EE</a></li></span><span class="breadcrumb"><li><a href="/categories/Java&J2EE/">Java&J2EE</a></li><li><a href="/categories/Java&J2EE/Java_总结类/">Java_总结类</a></li></span></span> | <span class="tags">Tagged <a href="/tags/Java&J2EE/" class="label label-primary">Java&J2EE</a><a href="/tags/Java_总结类/" class="label label-success">Java_总结类</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:43"datetime="2014-03-07 09:54:43"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-JavaJ2EE-Java_总结类--我的重构哪里不规范？-软件测试/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-JavaJ2EE-Java_总结类--我的重构哪里不规范？-软件测试" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-JavaJ2EE-Java_总结类--对遗留系统组织重构项目-透明思考CSDN/">对遗留系统组织重构项目 </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:43.000Z"> <a href="/2014/02/02/2014-02-02-JavaJ2EE-Java_总结类--对遗留系统组织重构项目-透明思考CSDN/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-csdn">对遗留系统组织重构项目 - 透明思考@CSDN</h1>
<h1 id="-http-blog-csdn-net-gigix-http-blog-csdn-net-gigix-"><a href="http://blog.csdn.net/gigix" target="_blank"><a href="http://blog.csdn.net/gigix">http://blog.csdn.net/gigix</a></a></h1>
<h2 id="-">思考着的程序员，程序员的思考</h2>
<ul>
<li><a href="http://hi.csdn.net/space-notice.html" target="_blank">条新通知</a></li>
<li><a href="http://passport.csdn.net/UserLogin.aspx" target="_blank">登录</a></li>
<li><a href="http://passport.csdn.net/CSDNUserRegister.aspx" target="_blank">注册</a></li>
<li><a href="http://hi.csdn.net/" target="_blank">欢迎</a></li>
<li><a href="http://writeblog.csdn.net/Signout.aspx" target="_blank">退出</a></li>
<li><a href="http://blog.csdn.net/" target="_blank">我的博客</a></li>
<li><a href="http://writeblog.csdn.net/configure.aspx" target="_blank">配置</a></li>
<li><a href="http://writeblog.csdn.net/PostEdit.aspx" target="_blank">写文章</a></li>
<li><a href="http://writeblog.csdn.net/PostList.aspx" target="_blank">文章管理</a></li>
<li><a href="http://blog.csdn.net/" target="_blank">博客首页</a></li>
</ul>
<p>*</p>
<ul>
<li><p>全站 当前博客
*</p>
</li>
<li><p><a href="http://hi.csdn.net/gigix" target="_blank">空间</a></p>
</li>
<li><a href="http://blog.csdn.net/gigix" target="_blank">博客</a></li>
<li><a href="http://hi.csdn.net/!s/friend/list/gigix" target="_blank">好友</a></li>
<li><a href="http://hi.csdn.net/!s/album/list/gigix" target="_blank">相册</a></li>
<li><a href="http://hi.csdn.net/!s/wall/to/gigix" target="_blank">留言</a></li>
</ul>
<p>用户操作<a href="http://hi.csdn.net/!s/wall/to/gigix" target="_blank">[留言]</a>  <a href="http://hi.csdn.net/!s/msg/to/gigix" target="_blank">[发消息]</a>  <a href="http://hi.csdn.net/!s/friend/add/gigix" target="_blank">[加为好友]</a> 订阅我的博客<a href="http://feeds.feedsky.com/csdn.net/gigix" target="_blank"><img src="" alt="XML聚合"></a>   <a href="http://feeds.feedsky.com/csdn.net/gigix" target="_blank"><img src="" alt="FeedSky"></a><a href="http://www.xianguo.com/subscribe.php?url=http://feeds.feedsky.com/csdn.net/gigix" target="_blank"><img src="" alt="订阅到鲜果"></a><a href="http://fusion.google.com/add?feedurl=http://feeds.feedsky.com/csdn.net/gigix" target="_blank"><img src="" alt="订阅到Google"></a><a href="http://www.zhuaxia.com/add_channel.php?url=http://feeds.feedsky.com/csdn.net/gigix" target="_blank"><img src="" alt="订阅到抓虾"></a><a href="http://writeblog.csdn.net/configure.aspx" target="_blank">[编辑]</a>gigix的公告<a href="http://writeblog.csdn.net/EditCategories.aspx?catID=1" target="_blank">[编辑]</a>文章分类* <a href="http://blog.csdn.net/gigix/category/9134.aspx/rss" target="_blank"><img src="" alt="(RSS)"></a><a href="http://blog.csdn.net/gigix/category/9134.aspx" target="_blank">《软件工艺》</a></p>
<ul>
<li><a href="http://blog.csdn.net/gigix/category/9135.aspx/rss" target="_blank"><img src="" alt="(RSS)"></a><a href="http://blog.csdn.net/gigix/category/9135.aspx" target="_blank">技术文章</a></li>
<li><a href="http://blog.csdn.net/gigix/category/9136.aspx/rss" target="_blank"><img src="" alt="(RSS)"></a><a href="http://blog.csdn.net/gigix/category/9136.aspx" target="_blank">人物访谈</a></li>
<li><a href="http://blog.csdn.net/gigix/category/9137.aspx/rss" target="_blank"><img src="" alt="(RSS)"></a><a href="http://blog.csdn.net/gigix/category/9137.aspx" target="_blank">散文随笔</a></li>
<li><a href="http://blog.csdn.net/gigix/category/9138.aspx/rss" target="_blank"><img src="" alt="(RSS)"></a><a href="http://blog.csdn.net/gigix/category/9138.aspx" target="_blank">剃刀书评</a></li>
<li><a href="http://blog.csdn.net/gigix/category/9139.aspx/rss" target="_blank"><img src="" alt="(RSS)"></a><a href="http://blog.csdn.net/gigix/category/9139.aspx" target="_blank">新闻评论</a><a href="http://writeblog.csdn.net/EditLinks.aspx" target="_blank">[编辑]</a>测试<a href="http://www.almaer.com/blog/archives/000639.html" target="_blank">Arrays.asList(&quot;Rod&quot;, &quot;Jane&quot;, &quot;Freddy&quot;);</a><a href="http://www.almaer.com/blog/mt-tb.cgi/639" target="_blank">(RSS)</a>存档* <a href="http://blog.csdn.net/gigix/archive/2010/03.aspx" target="_blank">2010年03月(1)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2008/04.aspx" target="_blank">2008年04月(1)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2008/03.aspx" target="_blank">2008年03月(2)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2008/02.aspx" target="_blank">2008年02月(1)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2007/12.aspx" target="_blank">2007年12月(3)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2007/11.aspx" target="_blank">2007年11月(4)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2007/10.aspx" target="_blank">2007年10月(4)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2007/09.aspx" target="_blank">2007年09月(1)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2007/08.aspx" target="_blank">2007年08月(1)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2007/07.aspx" target="_blank">2007年07月(1)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2007/06.aspx" target="_blank">2007年06月(3)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2007/05.aspx" target="_blank">2007年05月(1)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2007/04.aspx" target="_blank">2007年04月(2)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2007/03.aspx" target="_blank">2007年03月(6)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2007/02.aspx" target="_blank">2007年02月(4)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2007/01.aspx" target="_blank">2007年01月(2)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2006/10.aspx" target="_blank">2006年10月(1)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2006/09.aspx" target="_blank">2006年09月(2)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2006/08.aspx" target="_blank">2006年08月(1)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2006/07.aspx" target="_blank">2006年07月(5)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2006/06.aspx" target="_blank">2006年06月(10)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2006/05.aspx" target="_blank">2006年05月(1)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2006/04.aspx" target="_blank">2006年04月(2)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2006/03.aspx" target="_blank">2006年03月(12)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2006/02.aspx" target="_blank">2006年02月(9)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2006/01.aspx" target="_blank">2006年01月(1)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2005/11.aspx" target="_blank">2005年11月(4)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2005/09.aspx" target="_blank">2005年09月(7)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2005/08.aspx" target="_blank">2005年08月(5)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2005/06.aspx" target="_blank">2005年06月(1)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2005/02.aspx" target="_blank">2005年02月(2)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2005/01.aspx" target="_blank">2005年01月(2)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2004/08.aspx" target="_blank">2004年08月(1)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2004/07.aspx" target="_blank">2004年07月(2)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2004/06.aspx" target="_blank">2004年06月(1)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2004/05.aspx" target="_blank">2004年05月(1)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2004/04.aspx" target="_blank">2004年04月(1)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2004/03.aspx" target="_blank">2004年03月(4)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2004/02.aspx" target="_blank">2004年02月(3)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2003/12.aspx" target="_blank">2003年12月(7)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2003/11.aspx" target="_blank">2003年11月(8)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2003/10.aspx" target="_blank">2003年10月(2)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2003/09.aspx" target="_blank">2003年09月(9)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2003/08.aspx" target="_blank">2003年08月(9)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2003/07.aspx" target="_blank">2003年07月(7)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2003/06.aspx" target="_blank">2003年06月(14)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2003/05.aspx" target="_blank">2003年05月(15)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2003/04.aspx" target="_blank">2003年04月(1)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2003/03.aspx" target="_blank">2003年03月(3)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2003/02.aspx" target="_blank">2003年02月(5)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2003/01.aspx" target="_blank">2003年01月(2)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2002/12.aspx" target="_blank">2002年12月(2)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2002/11.aspx" target="_blank">2002年11月(3)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2002/10.aspx" target="_blank">2002年10月(3)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2002/09.aspx" target="_blank">2002年09月(1)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2002/08.aspx" target="_blank">2002年08月(1)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2002/07.aspx" target="_blank">2002年07月(3)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2002/06.aspx" target="_blank">2002年06月(2)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2002/05.aspx" target="_blank">2002年05月(3)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2002/04.aspx" target="_blank">2002年04月(41)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2002/03.aspx" target="_blank">2002年03月(102)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2002/02.aspx" target="_blank">2002年02月(1)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2001/11.aspx" target="_blank">2001年11月(1)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2001/10.aspx" target="_blank">2001年10月(4)</a></li>
<li><a href="http://blog.csdn.net/gigix/archive/2001/08.aspx" target="_blank">2001年08月(1)</a><h3 id="-http-forum-csdn-net-slist-blogsupport-http-blog-csdn-net-blogdevteam-">公告： <a href="http://forum.csdn.net/SList/blogSupport" target="_blank">[意见反馈]</a><a href="http://blog.csdn.net/blogdevteam" target="_blank">[官方博客]</a></h3>
</li>
</ul>
<h1 id="-"><img src="" alt="原创">  对遗留系统组织重构项目 <a href="&quot;收藏到我的网摘中，并分享给我的朋友&quot;">收藏</a></h1>
<p>很多IT组织都面临一个难题：老系统的维护、升级越来越难做。特别是那些价值高、生命周期长、规模大的核心业务系统，越到后来，要修复一个缺陷或者新增一个功能就需要越大的工作量。这是为什么呢？</p>
<p>软 件的质量体现在两方面：商业方面的质量，以及技术方面的质量。从商业的角度看来，“成功的软件”意味着它所创造的价值超出在它身上付出的代价。从技术的角 度看来，“成功的软件”意味着所有测试都通过、代码结构良好、并且容易理解和维护。很多商业上非常成功的软件系统忽视了技术方面的质量，所以尽管它们仍然 在为IT组织创造价值，但对它们的维护和升级越来越困难。最终技术质量的欠缺会反过来阻碍软件系统创造更大的商业价值。</p>
<p>为了保留并最大化软件资产的价值，适应新的需求变更，老系统总会面对维护和升级。当维护和升级的困难达到一定程度时，很多IT组织就会决定投入一整块资源和时间来改善这些老系统的技术质量，以便将来的维护升级能顺利进行。这样的做法通常被称为“重构项目”。</p>
<p>根据我们的经验，很多重构项目在目标管理、任务划分和质量保证等方面存在比较严重的问题，这些问题导致重构项目不能充分发挥价值。</p>
<h3 id="-">目标管理</h3>
<p>很多重构项目缺乏清晰的、可测试的目标。以ThoughtWorks参 与过的一个重构项目为例，该项目最初的目标只有“提高代码可维护性”等感性的描述，缺乏量化指标。目标不清晰的直接结果是，进行重构的程序员难以明确每一 步的重构工作应该做到什么程度，导致系统各个部分的优化程度不一致，一些部分在经过重构之后仍然质量低下，而且难以确定完成重构的时间。</p>
<p>和 新功能开发一样，重构也同样应该是可验收的，并且验收过程应该尽可能自动化。除了确保其功能性行为仍然保持原样不变之外，重构工作的验收条件还包括单元测 试覆盖率、代码复杂度、编码规范等指标。这些指标的报告应该自动化地生成，及时地展现给所有项目成员，为此我们需要一个持续集成环境来自动、频繁地验证所 有重构工作。</p>
<p>在ThoughtWorks参与的重构项目中，我们采用CruiseControl作为持续集成工具。每次开发者往代码库中签入（check in）代码时，就会触发CruiseControl对项目进行构建，构建的内容包括编译、连接（对于后台部分）、单元测试、测试覆盖率统计、代码复杂度统计、编码规范检查、部署到测试环境、功能测试等。</p>
<p>很多遗留还缺乏有效的项目自动化（automation）机制，使得持续集成环境无法发挥出它最大的价值。在建立持续集成环境的过程中，还应该对项目自动化机制进行改进，确保所有构建工作都能自动完成。于是完整的构建不仅在持续集成服务器上频繁运行，还在每个开发者的工作机器上更加频繁地运行。</p>
<h3 id="-">任务划分</h3>
<p>很多重构项目并没有明确的、细粒度的任务划分，实际进行重构的程序员得到的任务往往是类似“对安全模块进行重构”这样粗粒度、模块级的任务，而项目经理得到的反馈也是类似“可能需要两个月”这样粗略的估计，因此重构项目的进度往往难以控制。</p>
<p>和别的任何开发任务一样，重构任务（以及其他“技术债”类型的任务）也应该符合INVEST的标准：彼此独立（Independent），可讨论（Negotiatable），有价值（Valuable），可估算工作量（Estimatable），足够小（Small），可测试（Testable）。尤其是，它们的工作量应该得到估算，它们应该按照业务价值排列优先级。因为归根到底，重构（以及其他任何开发任务）都归结为“花在代码上的成本”与“对业务创造的价值”之间的权衡。</p>
<p>我们建议按照软件功能模块划分任务，而不区分是新功能开发还是重构。在实际工作中我们发现，对于同样的功能模块，新开发和重构的工作量差别不大。这也意味着重构工作可以被安排在日常开发工作中进行，并统一管理进度。</p>
<h3 id="-">质量保证</h3>
<p>在过去的咨询项目中，我们曾经不止一次见到这样的项目：在缺乏测试覆盖的情况下，程序员们修改旧系统中的代码，试图提高其可读性和可维护性。这些项目往往自称“重构项目”，但实际上它们并不是重构，因为它们缺乏必要的质量保证机制。</p>
<p>按 照定义，重构是对软件内部结构的一种调整，目的是在不改变“软件之可观察行为”的前提下，提高其可理解性，降低其修改成本。如果没有一套可靠的测试机制， 重构就无从谈起，因为你根本就无从知道自己做的调整是否改变了“软件之可观察行为”，甚至可能已经搞得系统不能运行还一无所知。</p>
<p>对 这种没有测试的系统进行重构，就像是编织一张网：先针对一小块功能编写验收测试，在这张“粗网”的保护下再逐渐给代码添加单元测试，有了粗细两层网的保护 再深入重构。随着重构的开展，这张频繁自动化运行的安全网也渐渐铺开。从不断提升的测试覆盖率和不断降低的代码复杂度，我们就能清晰地看到重构的进展情 况。</p>
<p><img src="" alt=""></p>
<p>有 时由于代码质量低劣，程序员们在试图重构时会遇到困难：那些最需要重构的代码也是最难进行单元测试的。通常这是因为模块之间的依赖过于复杂、建立依赖的方 式不佳，而导致无法将这些模块纳入测试。此时需要首先建立验收测试套件，然后用必要的解耦手段调整依赖关系，然后才能对这些模块进行单元测试，之后才能对 它们进行重构。</p>
<h2 id="thoughtworks-">ThoughtWorks能做什么？</h2>
<p>在重构项目的组织、管理、质量保证和实施技术等方面，ThoughtWorks具有无可比拟的能力和经验。我们曾为一些生命周期长至数年、规模大至上百万行代码的遗留系统进行过重构项目，并取得了良好的效果。</p>
<p>我们的咨询师可以和公司中的开发者共同工作，共同解决发现并解决问题。在这个过程中，ThoughtWorks的咨询师会迅速把更佳的工作方式和理念告诉作为客户的开发者，以便在将来没有ThoughtWorks咨询师的情况下，客户也可以坚持那些方发实践，并把它传播给更多的人。</p>
<p>发表于 @ 2008年02月25日　13:30:00 | <a href="http://blog.csdn.net/gigix/archive/2008/02/25/2118896.aspx#FeedBack" title="评论" target="_blank">评论( loading...  )</a>| <a href="http://writeblog.csdn.net/PostEdit.aspx?entryId=2118896" title="编辑" target="_blank">编辑</a>| <a href="mailto:webmaster@csdn.net?subject=Article Report!!!&amp;body=Author:gigixURL:http://blog.csdn.net/ArticleContent.aspx?UserName=gigix&amp;Entryid=2118896">举报</a>| <a href="&quot;收藏到我的网摘中，并分享给我的朋友&quot;">收藏</a></p>
<h3 id="-itechtag-http-blog-csdn-net-gigix-archive-2007-12-17-1943106-aspx-announcement-fluorida-0-0-1-http-blog-csdn-net-gigix-archive-2008-03-06-2154907-aspx-"><a href="http://blog.csdn.net/gigix/archive/2007/12/17/1943106.aspx" target="_blank">旧一篇:用一朵云重建软件开发者的声望——讲述iTechTag网站的故事</a> | <a href="http://blog.csdn.net/gigix/archive/2008/03/06/2154907.aspx" target="_blank">新一篇:Announcement: Fluorida 0.0.1</a></h3>
<p><a href="http://blog.csdn.net/" target="_blank">查看最新精华文章 请访问博客首页</a>相关文章<a href=""></a></p>
<ul>
<li><p>发表评论</p>
</li>
<li><p>表 情：</p>
</li>
<li><p><a href="http://blog.csdn.net/gigix/archive/2008/02/25/2118896.aspx#" target="_blank"><img src="&quot;顶&quot;" alt="顶"></a> <a href="http://blog.csdn.net/gigix/archive/2008/02/25/2118896.aspx#" target="_blank"><img src="&quot;砸&quot;" alt="砸"></a> <a href="http://blog.csdn.net/gigix/archive/2008/02/25/2118896.aspx#" target="_blank"><img src="&quot;棒&quot;" alt="棒"></a> <a href="http://blog.csdn.net/gigix/archive/2008/02/25/2118896.aspx#" target="_blank"><img src="&quot;大笑&quot;" alt="大笑"></a> <a href="http://blog.csdn.net/gigix/archive/2008/02/25/2118896.aspx#" target="_blank"><img src="&quot;愤怒&quot;" alt="愤怒"></a> <a href="http://blog.csdn.net/gigix/archive/2008/02/25/2118896.aspx#" target="_blank"><img src="&quot;大哭&quot;" alt="大哭"></a> <a href="http://blog.csdn.net/gigix/archive/2008/02/25/2118896.aspx#" target="_blank"><img src="&quot;疑问&quot;" alt="疑问"></a> <a href="http://blog.csdn.net/gigix/archive/2008/02/25/2118896.aspx#" target="_blank"><img src="&quot;汗&quot;" alt="汗"></a> <a href="http://blog.csdn.net/gigix/archive/2008/02/25/2118896.aspx#" target="_blank"><img src="&quot;呕吐&quot;" alt="呕吐"></a> <a href="http://blog.csdn.net/gigix/archive/2008/02/25/2118896.aspx#" target="_blank"><img src="&quot;送花&quot;" alt="送花"></a></p>
</li>
<li><p>评论内容：
*</p>
</li>
<li>用 户 名：</li>
<li><p><a href="">登录</a> <a href="http://passport.csdn.net/CSDNUserRegister.aspx" target="_blank">注册</a> 匿名评论</p>
</li>
<li><p>验 证 码：</p>
</li>
<li><a href=""><img src="" alt="验证码"></a> <a href="">重新获得验证码</a></li>
</ul>
<p><em>
</em></p>
<h3 id="-">热门招聘职位<img src="" alt=""></h3>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/Java&J2EE/">Java&J2EE</a></li></span><span class="breadcrumb"><li><a href="/categories/Java&J2EE/">Java&J2EE</a></li><li><a href="/categories/Java&J2EE/Java_总结类/">Java_总结类</a></li></span></span> | <span class="tags">Tagged <a href="/tags/Java&J2EE/" class="label label-primary">Java&J2EE</a><a href="/tags/Java_总结类/" class="label label-success">Java_总结类</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:43"datetime="2014-03-07 09:54:43"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-JavaJ2EE-Java_总结类--对遗留系统组织重构项目-透明思考CSDN/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-JavaJ2EE-Java_总结类--对遗留系统组织重构项目-透明思考CSDN" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-JavaJ2EE-Java_总结类--华山论session和cookie机制/">华山论session和cookie机制</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:43.000Z"> <a href="/2014/02/02/2014-02-02-JavaJ2EE-Java_总结类--华山论session和cookie机制/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-session-cookie-">华山论session和cookie机制</h1>
<p>会话（Session）跟踪是Web程序中常用的技术，用来跟踪用户的整个会话。常用的会话跟踪技术是Cookie与Session。Cookie通过在客户端记录信息确定用户身份，Session通过在服务器端记录信息确定用户身份。</p>
<p><strong>一．cookie和session机制之间的区别和联系</strong></p>
<pre><code> 具体来说cookie机制采用的是在客户端保持状态的方案。它是在用户端的会话状态的存贮机制，他需要用户打开客户端的cookie支持。cookie的作用就是为了解决HTTP协议无状态的缺陷所作的努力.而session机制采用的是一种在客户端与服务器之间保持状态的解决方案。同时我们也看到，由于采用服务器端保持状态的方案在客户端也需要保存一个标识，所以session机制可能需要借助于cookie机制来达到保存标识的目的。而session提供了方便管理全局变量的方式
  session是针对每一个用户的，变量的值保存在服务器上，用一个sessionID来区分是哪个用户session变量,这个值是通过用户的浏览器在访问的时候返回给服务器，当客户禁用cookie时，这个值也可能设置为由get来返回给服务器。就安全性来说：当你访问一个使用session 的站点，同时在自己机子上建立一个cookie，建议在服务器端的SESSION机制更安全些.因为它不会任意读取客户存储的信息。
    正统的cookie分发是通过扩展HTTP协议来实现的，服务器通过在HTTP的响应头中加上一行特殊的指示以提示浏览器按照指示生成相应的cookie。从网络服务器观点看所有HTTP请求都独立于先前请求。就是说每一个HTTP响应完全依赖于相应请求中包含的信息。状态管理机制克服了HTTP的一些限制并允许网络客户端及服务器端维护请求间的关系。在这种关系维持的期间叫做会话(session)。
    Cookies是服务器在本地机器上存储的小段文本并随每一个请求发送至同一个服务器。IETF RFC 2965 HTTP State Management Mechanism 是通用cookie规范。网络服务器用HTTP头向客户端发送cookies，在客户终端，浏览器解析这些cookies并将它们保存为一个本地文件，它会自动将同一服务器的任何请求缚上这些cookies
</code></pre><p><strong>二.理解session机制</strong>
           session机制是一种服务器端的机制，服务器使用一种类似于散列表的结构（也可能就是使用散列表）来保存信息。当程序需要为某个客户端的请求创建一个session的时候，服务器首先检查这个客户端的请求里是否已包含了一个session标识—— 称为 session id，如果已包含一个session id则说明以前已经为此客户端创建过session，服务器就按照session id把这个 session检索出来使用（如果检索不到，可能会新建一个），如果客户端请求不包含session id，则为此客户端创建一个session并且生成一个与此session相关联的session id，session id的值应该是一个既不会重复，又不容易被找到规律以仿造的字符串，这个 session id将被在本次响应中返回给客户端保存。
保存这个session id的方式可以采用cookie，这样在交互过程中浏览器可以自动的按照规则把这个标识发挥给服务器。一般这个cookie的名字都是类似于SEEESIONID，而。比如weblogic对于web应用程序生成的cookie，JSESSIONID= ByOK3vjFD75aPnrF7C2HmdnV6QZcEbzWoWiBYEnLerjQ99zWpBng!-145788764，它的名字就是 JSESSIONID。由于cookie可以被人为的禁止，必须有其他机制以便在cookie被禁止时仍然能够把session id传递回服务器。经常被使用的一种技术叫做URL重写，就是把session id直接附加在URL路径的后面，附加方式也有两种，一种是作为URL路径的附加信息，表现形式为<a href="http://...../xxx;jsessionid=" target="_blank">http://...../xxx;jsessionid=</a> ByOK3vjFD75aPnrF7C2HmdnV6QZcEbzWoWiBYEnLerjQ99zWpBng!-145788764
另一种是作为查询字符串附加在URL后面，表现形式为<a href="http://...../xxx?jsessionid=ByOK3vjFD75aPnrF7C2HmdnV6QZcEbzWoWiBYEnLerjQ99zWpBng!-145788764" target="_blank">http://...../xxx?jsessionid=ByOK3vjFD75aPnrF7C2HmdnV6QZcEbzWoWiBYEnLerjQ99zWpBng!-145788764</a>
这两种方式对于用户来说是没有区别的，只是服务器在解析的时候处理的方式不同，采用第一种方式也有利于把session id的信息和正常程序参数区分开来。为了在整个交互过程中始终保持状态，就必须在每个客户端可能请求的路径后面都包含这个session id。
      另一种技术叫做表单隐藏字段。就是服务器会自动修改表单，添加一个隐藏字段，以便在表单提交时能够把session id传递回服务器。这种技术现在已较少应用，笔者接触过的很古老的iPlanet6(SunONE应用服务器的前身)就使用了这种技术。实际上这种技术可以简单的用对action应用URL重写来代替。
       在谈论session机制的时候，常常听到这样一种误解“只要关闭浏览器，session就消失了”。其实可以想象一下会员卡的例子，除非顾客主动对店家提出销卡，否则店家绝对不会轻易删除顾客的资料。对session来说也是一样的，除非程序通知服务器删除一个session，否则服务器会一直保留，程序一般都是在用户做log off的时候发个指令去删除session。然而浏览器从来不会主动在关闭之前通知服务器它将要关闭，因此服务器根本不会有机会知道浏览器已经关闭，之所以会有这种错觉，是大部分session机制都使用会话cookie来保存session id，而关闭浏览器后这个 session id就消失了，再次连接服务器时也就无法找到原来的session。如果服务器设置的cookie被保存到硬盘上，或者使用某种手段改写浏览器发出的HTTP请求头，把原来的session id发送给服务器，则再次打开浏览器仍然能够找到原来的session。
         恰恰是由于关闭浏览器不会导致session被删除，迫使服务器为seesion设置了一个失效时间，当距离客户端上一次使用session的时间超过这个失效时间时，服务器就可以认为客户端已经停止了活动，才会把session删除以节省存储空间。</p>
<p><strong> 由JSESSIONID谈cookie与SESSION的区别和联系</strong></p>
<pre><code>       在一些投票之类的场合，我们往往因为公平的原则要求每人只能投一票，在一些WEB开发中也有类似的情况，这时候我们通常会使用COOKIE来实现，例如如下的代码：
</code></pre><p><strong>[html]</strong> <a href="http://blog.csdn.net/#" title="view plain" target="_blank">view plain</a><a href="http://blog.csdn.net/#" title="copy" target="_blank">copy</a><a href="http://blog.csdn.net/#" title="print" target="_blank">print</a><a href="http://blog.csdn.net/#" title="?" target="_blank">?</a></p>
<ol>
<li>&lt; % cookie[]cookies = request.getCookies();  </li>
<li>if (cookies.lenght == 0 || cookies == null)  </li>
<li>doStuffForNewbie();  </li>
<li>//没有访问过   </li>
<li>}else  </li>
<li>{  </li>
<li>doStuffForReturnVisitor(); //已经访问过了  </li>
<li>}% &gt;  </li>
</ol>
<p>这是很浅显易懂的道理，检测COOKIE的存在，如果存在说明已经运行过写入COOKIE的代码了，然而运行以上的代码后，无论何时结果都是执行doStuffForReturnVisitor()，通过控制面板-Internet选项-设置-察看文件却始终看不到生成的cookie文件，奇怪，代码明明没有问题，不过既然有cookie，那就显示出来看看。
<strong>[html]</strong> <a href="http://blog.csdn.net/#" title="view plain" target="_blank">view plain</a><a href="http://blog.csdn.net/#" title="copy" target="_blank">copy</a><a href="http://blog.csdn.net/#" title="print" target="_blank">print</a><a href="http://blog.csdn.net/#" title="?" target="_blank">?</a></p>
<ol>
<li>cookie[]cookies = request.getCookies();  </li>
<li>if (cookies.lenght == 0 || cookies == null)  </li>
<li>out.println(&quot;Has not visited this website&quot;);  </li>
<li>}else{  </li>
<li>for (int i = 0; i &lt; cookie.length; i++){  </li>
<li>out.println(&quot;cookie name:&quot; + cookies[i].getName() + &quot;cookie value:&quot; +  </li>
<li>cookie[i].getValue());}}  </li>
</ol>
<p>运行结果:
cookie name:JSESSIONID cookie value:KWJHUG6JJM65HS2K6 为什么会有cookie呢,大家都知道，http是无状态的协议，客户每次读取web页面时，服务器都打开新的会话，而且服务器也不会自动维护客户的上下文信息，那么要怎么才能实现网上商店中的购物车呢，session就是一种保存上下文信息的机制，它是针对每一个用户的，变量的值保存在服务器端，通过SessionID来区分不同的客户,session是以cookie或URL重写为基础的，默认使用cookie来实现，系统会创造一个名为JSESSIONID的输出cookie，我们叫做session cookie,以区别persistent cookies,也就是我们通常所说的cookie,注意session cookie是存储于浏览器内存中的，并不是写到硬盘上的，这也就是我们刚才看到的JSESSIONID，我们通常情是看不到JSESSIONID的，但是当我们把浏览器的cookie禁止后，web服务器会采用URL重写的方式传递Sessionid，我们就可以在地址栏看到sessionid=KWJHUG6JJM65HS2K6之类的字符串。
明白了原理，我们就可以很容易的分辨出persistent cookies和session cookie的区别了，网上那些关于两者安全性的讨论也就一目了然了，session cookie针对某一次会话而言，会话结束session cookie也就随着消失了，而persistent cookie只是存在于客户端硬盘上的一段文本（通常是加密的），而且可能会遭到cookie欺骗以及针对cookie的跨站脚本攻击，自然不如session cookie安全了。
            通常session cookie是不能跨窗口使用的，当你新开了一个浏览器窗口进入相同页面时，系统会赋予你一个新的sessionid，这样我们信息共享的目的就达不到了，此时我们可以先把sessionid保存在persistent cookie中，然后在新窗口中读出来，就可以得到上一个窗口SessionID了，这样通过session cookie和persistent cookie的结合我们就实现了跨窗口的session tracking（会话跟踪）。
            在一些web开发的书中，往往只是简单的把Session和cookie作为两种并列的http传送信息的方式，session cookies位于服务器端，persistent cookie位于客户端，可是session又是以cookie为基础的，明白的两者之间的联系和区别，我们就不难选择合适的技术来开发web service了。</p>
<p>推荐：<a href="http://blog.csdn.net/csh624366188/article/details/7428222" target="_blank">Java程序员从笨鸟到菜鸟之（二十四）Xml基础详解和DTD验证</a>
来源： <a href="[http://blog.csdn.net/csh624366188/article/details/7425770](http://blog.csdn.net/csh624366188/article/details/7425770)">[http://blog.csdn.net/csh624366188/article/details/7425770](http://blog.csdn.net/csh624366188/article/details/7425770)</a> </p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/Java&J2EE/">Java&J2EE</a></li></span><span class="breadcrumb"><li><a href="/categories/Java&J2EE/">Java&J2EE</a></li><li><a href="/categories/Java&J2EE/Java_总结类/">Java_总结类</a></li></span></span> | <span class="tags">Tagged <a href="/tags/Java&J2EE/" class="label label-primary">Java&J2EE</a><a href="/tags/Java_总结类/" class="label label-success">Java_总结类</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:43"datetime="2014-03-07 09:54:43"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-JavaJ2EE-Java_总结类--华山论session和cookie机制/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-JavaJ2EE-Java_总结类--华山论session和cookie机制" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-JavaJ2EE-Java_总结类--使用MemoryAnalyzertoolMAT分析内存泄漏（二）/">使用Memory Analyzer tool(MAT)分析内存泄漏（二）</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:43.000Z"> <a href="/2014/02/02/2014-02-02-JavaJ2EE-Java_总结类--使用MemoryAnalyzertoolMAT分析内存泄漏（二）/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-memory-analyzer-tool-mat-">使用Memory Analyzer tool(MAT)分析内存泄漏（二）</h1>
<h1 id="-http-www-blogjava-net-rosen-"><a href="http://www.blogjava.net/rosen/" target="_blank"><strong>成都心情</strong></a></h1>
<p>关注 ODBMS noSQL RDBMS 还是把标题换回来</p>
<p>  <a href="http://www.blogjava.net/" target="_blank">BlogJava</a> :: <a href="http://www.blogjava.net/rosen/" target="_blank">首页</a> ::  :: <a href="http://www.blogjava.net/rosen/contact.aspx?id=1" target="_blank">联系</a> :: <a href="http://www.blogjava.net/rosen/rss" target="_blank">聚合</a> <a href="http://www.blogjava.net/rosen/rss" target="_blank"><img src="" alt=""></a> :: <a href="http://www.blogjava.net/rosen/admin/EditPosts.aspx" target="_blank">管理</a> :: <img src="" alt="">   87 随笔 :: 2 文章 :: 436 评论 :: 1 Trackbacks</p>
<h3 id="-">公告</h3>
<p><a href="http://www.51.la/?298319" target="_blank"><img src="" alt="&#0;0;0;0;6211;&#0;0;0;0;8981;&#0;0;0;0;5566;&#0;0;0;0;514D;&#0;0;0;0;8D39;&#0;0;0;0;7EDF;&#0;0;0;0;8BA1;"></a>
<a href="http://creativecommons.org/licenses/by-sa/2.5/cn/" target="_blank"><img src="" alt="Creative Commons License"></a>
本作品采用<a href="http://creativecommons.org/licenses/by-sa/2.5/cn/" target="_blank">知识共享署名-相同方式共享 2.5 中国大陆许可协议</a>进行许可。 <a href="http://www2.clustrmaps.com/counter/maps.php?url=http://www.blogjava.net/rosen" target="_blank"><img src="&quot;Locations of visitors to this page&quot;" alt="Locations of visitors to this page"></a></p>
<h3 id="-4-">留言簿(4)</h3>
<ul>
<li><a href="http://www.blogjava.net/rosen/Contact.aspx?id=1" target="_blank">给我留言</a></li>
<li><a href="http://www.blogjava.net/rosen/default.aspx?opt=msg" target="_blank">查看公开留言</a></li>
<li><a href="http://www.blogjava.net/rosen/admin/MyMessages.aspx" target="_blank">查看私人留言</a></li>
</ul>
<h3 id="-88-">随笔分类(88)</h3>
<ul>
<li><a href="http://www.blogjava.net/rosen/category/2689.html" target="_blank">Java EE 服务器端(14)</a> <a href="http://www.blogjava.net/rosen/category/2689.html/rss" title="Subscribe to Java EE 服务器端(14)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/rosen/category/2686.html" target="_blank">Java EE 表现层及容器(12)</a> <a href="http://www.blogjava.net/rosen/category/2686.html/rss" title="Subscribe to Java EE 表现层及容器(12)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/rosen/category/5482.html" target="_blank">Java ME(1)</a> <a href="http://www.blogjava.net/rosen/category/5482.html/rss" title="Subscribe to Java ME(1)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/rosen/category/2690.html" target="_blank">Java 基础(10)</a> <a href="http://www.blogjava.net/rosen/category/2690.html/rss" title="Subscribe to Java 基础(10)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/rosen/category/7219.html" target="_blank">MatLab(1)</a> <a href="http://www.blogjava.net/rosen/category/7219.html/rss" title="Subscribe to MatLab(1)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/rosen/category/2688.html" target="_blank">O/R Mapping(13)</a> <a href="http://www.blogjava.net/rosen/category/2688.html/rss" title="Subscribe to O/R Mapping(13)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/rosen/category/13739.html" target="_blank">Versant db4o 中文项目(11)</a> <a href="http://www.blogjava.net/rosen/category/13739.html/rss" title="Subscribe to Versant db4o 中文项目(11)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/rosen/category/2685.html" target="_blank">五花八门(8)</a> <a href="http://www.blogjava.net/rosen/category/2685.html/rss" title="Subscribe to 五花八门(8)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/rosen/category/2684.html" target="_blank">工作流(10)</a> <a href="http://www.blogjava.net/rosen/category/2684.html/rss" title="Subscribe to 工作流(10)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/rosen/category/2682.html" target="_blank">数据库(2)</a> <a href="http://www.blogjava.net/rosen/category/2682.html/rss" title="Subscribe to 数据库(2)" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/rosen/category/2683.html" target="_blank">模式与策略(6)</a> <a href="http://www.blogjava.net/rosen/category/2683.html/rss" title="Subscribe to 模式与策略(6)" target="_blank">(rss)</a></li>
</ul>
<h3 id="-88-">随笔档案(88)</h3>
<ul>
<li><a href="http://www.blogjava.net/rosen/archive/2010/06.html" target="_blank">2010年6月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2010/05.html" target="_blank">2010年5月 (3)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2010/03.html" target="_blank">2010年3月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2010/01.html" target="_blank">2010年1月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2009/10.html" target="_blank">2009年10月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2009/09.html" target="_blank">2009年9月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2009/07.html" target="_blank">2009年7月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2009/06.html" target="_blank">2009年6月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2009/03.html" target="_blank">2009年3月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2009/02.html" target="_blank">2009年2月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2008/12.html" target="_blank">2008年12月 (2)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2008/09.html" target="_blank">2008年9月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2008/08.html" target="_blank">2008年8月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2008/07.html" target="_blank">2008年7月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2008/06.html" target="_blank">2008年6月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2008/04.html" target="_blank">2008年4月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2008/03.html" target="_blank">2008年3月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2008/01.html" target="_blank">2008年1月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2007/12.html" target="_blank">2007年12月 (2)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2007/10.html" target="_blank">2007年10月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2007/09.html" target="_blank">2007年9月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2007/08.html" target="_blank">2007年8月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2007/06.html" target="_blank">2007年6月 (2)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2007/05.html" target="_blank">2007年5月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2007/04.html" target="_blank">2007年4月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2007/02.html" target="_blank">2007年2月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2007/01.html" target="_blank">2007年1月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2006/12.html" target="_blank">2006年12月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2006/11.html" target="_blank">2006年11月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2006/10.html" target="_blank">2006年10月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2006/09.html" target="_blank">2006年9月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2006/08.html" target="_blank">2006年8月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2006/07.html" target="_blank">2006年7月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2006/06.html" target="_blank">2006年6月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2006/05.html" target="_blank">2006年5月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2006/04.html" target="_blank">2006年4月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2006/03.html" target="_blank">2006年3月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2006/02.html" target="_blank">2006年2月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2006/01.html" target="_blank">2006年1月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2005/12.html" target="_blank">2005年12月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2005/11.html" target="_blank">2005年11月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2005/10.html" target="_blank">2005年10月 (1)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2005/09.html" target="_blank">2005年9月 (2)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2005/08.html" target="_blank">2005年8月 (39)</a></li>
</ul>
<h3 id="-2-">文章分类(2)</h3>
<ul>
<li><a href="http://www.blogjava.net/rosen/category/3474.html" target="_blank">我的收藏(2)</a> <a href="http://www.blogjava.net/rosen/category/3474.html/rss" title="Subscribe to 我的收藏(2)" target="_blank">(rss)</a></li>
</ul>
<h3 id="-">友情链接</h3>
<ul>
<li><a href="http://www.blogjava.net/openssl/" target="_blank">david.turing</a> <a href="http://www.blogjava.net/openssl/Rss.aspx" title="Subscribe to david.turing" target="_blank">(rss)</a></li>
<li><a href="http://blog.csdn.net/wyingquan" target="_blank">wyingquan的专栏</a> <a href="http://blog.csdn.net/wyingquan/Rss.aspx" title="Subscribe to wyingquan的专栏" target="_blank">(rss)</a></li>
<li><a href="http://yfeng.cn/" target="_blank">俺的猪窝~！@</a></li>
<li><a href="http://spaces.msn.com/members/Deodar/" target="_blank">喜马拉雅的雪杉</a> <a href="http://spaces.msn.com/members/Deodar/feed.rss" title="Subscribe to 喜马拉雅的雪杉" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/mmwy" target="_blank">无聊人士</a> <a href="http://www.blogjava.net/mmwy/Rss.aspx" title="Subscribe to 无聊人士" target="_blank">(rss)</a></li>
<li><a href="http://www.blogjava.net/juleven" target="_blank">竹十一</a> <a href="http://www.blogjava.net/juleven/rss" title="Subscribe to 竹十一" target="_blank">(rss)</a></li>
<li><a href="http://www.cnblogs.com/xd125" target="_blank">老刘忙不忙</a> <a href="http://www.cnblogs.com/xd125/rss" title="Subscribe to 老刘忙不忙" target="_blank">(rss)</a></li>
<li><a href="http://blogger.org.cn/blog/blog.asp?name=hongrui" target="_blank">邢红瑞的blog</a> <a href="http://blogger.org.cn/blog/rss2.asp?name=hongrui" title="Subscribe to 邢红瑞的blog" target="_blank">(rss)</a></li>
</ul>
<h3 id="-">积分与排名</h3>
<ul>
<li>积分 - 243427</li>
<li>排名 - 45</li>
</ul>
<h3 id="-http-www-blogjava-net-rosen-commentsrss-aspx-">最新评论 <a href="http://www.blogjava.net/rosen/CommentsRSS.aspx" target="_blank"><img src="" alt=""></a></h3>
<ul>
<li><a href="http://www.blogjava.net/rosen/archive/2010/06/14/323522.html#323567" target="_blank">1. re: 使用Memory Analyzer tool(MAT)分析内存泄漏（二）</a></li>
<li>@Jet
@滴水
@BeanSoft
感谢各位的关注！非常感谢。</li>
<li>--Rosen</li>
<li><a href="http://www.blogjava.net/rosen/archive/2010/06/14/323522.html#323561" target="_blank">2. re: 使用Memory Analyzer tool(MAT)分析内存泄漏（二）</a></li>
<li>经典文章!</li>
<li>--BeanSoft</li>
<li><a href="http://www.blogjava.net/rosen/archive/2010/06/14/323522.html#323559" target="_blank">3. re: 使用Memory Analyzer tool(MAT)分析内存泄漏（二）</a></li>
<li>很棒，几种分类测试让人更加深刻的理解了JVM的内存分配机制。</li>
<li>--滴水</li>
<li><a href="http://www.blogjava.net/rosen/archive/2010/06/13/323522.html#323527" target="_blank">4. re: 使用Memory Analyzer tool(MAT)分析内存泄漏（二）[未登录]</a></li>
<li>好文章啊，支持一直写下去~~</li>
<li>--Jet</li>
<li><a href="http://www.blogjava.net/rosen/archive/2010/05/25/321575.html#321837" target="_blank">5. re: 使用Memory Analyzer tool(MAT)分析内存泄漏（一）</a></li>
<li>很精辟，感谢博主，你的前途一定会有。</li>
<li>--liucr</li>
</ul>
<h3 id="-">阅读排行榜</h3>
<ul>
<li><a href="http://www.blogjava.net/rosen/archive/2005/08/12/9955.html" target="_blank">1. Java 中的位运算(13441)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2007/06/04/121994.html" target="_blank">2. CentOS 5 Apache,Java,Tomcat,PostgreSQL...安装笔记（不断更新中）(10024)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2005/08/12/9937.html" target="_blank">3. Hibernate、iBATIS 与 BLOB(7417)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2005/08/12/9880.html" target="_blank">4. OSWorkflow 探索(7122)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2005/12/17/24348.html" target="_blank">5. BIRT 总览（翻译）(6576)</a></li>
</ul>
<h3 id="-">评论排行榜</h3>
<ul>
<li><a href="http://www.blogjava.net/rosen/archive/2008/03/21/187814.html" target="_blank">1. 德国申根商务签证攻略（成都版）(36)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2005/08/12/9880.html" target="_blank">2. OSWorkflow 探索(29)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2008/07/25/217210.html" target="_blank">3. 北漂找工作经历(26)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2006/06/15/53094.html" target="_blank">4. 开源面向对象数据库 db4o 之旅: 初识 db4o“db4o 之旅（一）”(21)</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2008/09/02/226348.html" target="_blank">5. 致《点击Tree中的一行打开/关闭节点》一文作者(17)</a>
<a href="http://www.blogjava.net/rosen/archive/2010/06/13/323522.html" target="_blank">使用Memory Analyzer tool(MAT)分析内存泄漏（二）</a></li>
</ul>
<p><strong>前言的前言</strong>
写blog就是好，在大前提下可以想说什么写什么，不像投稿那么字字斟酌。上周末回了趟成都办事，所以本文来迟了。K117从达州经由达成线往成都方向走的时候，发现铁路边有条河，尽管我现在也不知道其名字，但已被其深深的陶醉。河很宽且水流平缓，河边山丘森林密布，民房星星点点的分布在河边，河里偶尔些小船。当时我就在想，在这里生活是多么的惬意，夏天还可以下去畅游一番，闲来无事也可垂钓。唉，越来越讨厌北漂了。
<strong>前言</strong>
在<a href="http://www.blogjava.net/rosen/archive/2010/05/21/321575.html" target="_blank">使用Memory Analyzer tool(MAT)分析内存泄漏（一）</a>中，我介绍了内存泄漏的前因后果。在本文中，将介绍MAT如何根据heap dump分析泄漏根源。由于测试范例可能过于简单，很容易找出问题，但我期待借此举一反三。
一开始不得不说说ClassLoader，本质上，它的工作就是把磁盘上的类文件读入内存，然后调用java.lang.ClassLoader.defineClass方法告诉系统把内存镜像处理成合法的字节码。Java提供了抽象类ClassLoader，所有用户自定义类装载器都实例化自ClassLoader的子类。system class loader在没有指定装载器的情况下默认装载用户类，在Sun Java 1.5中既sun.misc.Launcher$AppClassLoader。更详细的内容请参看下面的资料。
<strong>准备heap dump</strong>
请看下面的Pilot类，没啥特殊的。
//<em>/</em>
 /<em> Pilot class
 /</em> @author rosen jiang
 /*/
package org.rosenjiang.bo;
public class Pilot{</p>
<pre><code>String name;
int age;

public Pilot(String a, int b){
    name = a;
    age = b;
}
</code></pre><p>}
然后再看OOMHeapTest类，它是如何撑破heap dump的。
//<em>/</em>
 /<em> OOMHeapTest class
 /</em> @author rosen jiang
 /*/
package org.rosenjiang.test;
import java.util.Date;
import java.util.HashMap;
import java.util.Map;
import org.rosenjiang.bo.Pilot;
public class OOMHeapTest {
    public static void main(String[] args){
        oom();
    }</p>
<pre><code>private static void oom(){
    Map&lt;String, Pilot&gt; map = new HashMap&lt;String, Pilot&gt;();
    Object[] array = new Object[1000000];
    for(int i=0; i&lt;1000000; i++){
        String d = new Date().toString();
        Pilot p = new Pilot(d, i);
        map.put(i+&quot;rosen jiang&quot;, p);
        array[i]=p;
    }
}
</code></pre><p>}
是的，上面构造了很多的Pilot类实例，向数组和map中放。由于是Strong Ref，GC自然不会回收这些对象，一直放在heap中直到溢出。当然在运行前，先要在Eclipse中配置VM参数-XX:+HeapDumpOnOutOfMemoryError。好了，一会儿功夫内存溢出，控制台打出如下信息。
java.lang.OutOfMemoryError: Java heap space
Dumping heap to java_pid3600.hprof <img src="" alt="">
Heap dump file created [78233961 bytes in 1.995 secs]
Exception in thread &quot;main&quot; java.lang.OutOfMemoryError: Java heap space
<img src="" alt=""><img src="" alt=""><img src="" alt=""><img src="" alt=""><img src="" alt="">
<img src="" alt=""><img src="" alt=""><img src="" alt="">
<img src="" alt=""><img src="" alt="">
java_pid3600.hprof既是heap dump，可以在OOMHeapTest类所在的工程根目录下找到。
<strong>MAT安装</strong>
话分两头说，有了heap dump还得安装MAT。可以在<a href="http://www.eclipse.org/mat/downloads.php选择合适的方式安装。安装完成后切换到Memory" target="_blank">http://www.eclipse.org/mat/downloads.php选择合适的方式安装。安装完成后切换到Memory</a> Analyzer视图。在Eclipse的左上角有Open Heap Dump按钮，按照刚才说的路径找到java_pid3600.hprof文件并打开。解析hprof文件会花些时间，然后会弹出向导，直接Finish即可。稍后会看到下图所示的界面。
<img src="" alt="">
MAT工具分析了heap dump后在界面上非常直观的展示了一个饼图，该图深色区域被怀疑有内存泄漏，可以发现整个heap才64M内存，深色区域就占了99.5%。接下来是一个简短的描述，告诉我们main线程占用了大量内存，并且明确指出system class loader加载的&quot;java.lang.Thread&quot;实例有内存聚集，并建议用关键字&quot;java.lang.Thread&quot;进行检查。所以，MAT通过简单的两句话就说明了问题所在，就算使用者没什么处理内存问题的经验。在下面还有一个&quot;Details&quot;链接，在点开之前不妨考虑一个问题：为何对象实例会聚集在内存中，为何存活（而未被GC）？是的——Strong Ref，那么再走近一些吧。
<img src="" alt="">
点击了&quot;Details&quot;链接之后，除了在上一页看到的描述外，还有Shortest Paths To the Accumulation Point和Accumulated Objects部分，这里说明了从GC root到聚集点的最短路径，以及完整的reference chain。观察Accumulated Objects部分，java.util.HashMap和java.lang.Object[1000000]实例的retained heap(size)最大，在上一篇文章中我们知道retained heap代表从该类实例沿着reference chain往下所能收集到的其他类实例的shallow heap(size)总和，所以明显类实例都聚集在HashMap和Object数组中了。这里我们发现一个有趣的现象，既Object数组的shallow heap和retained heap竟然一样，通过<a href="http://www.yourkit.com/docs/90/help/sizes.jsp" target="_blank">Shallow and retained sizes</a>一文可知，数组的shallow heap和一般对象（非数组）不同，依赖于数组的长度和里面的元素的类型，对数组求shallow heap，也就是求数组集合内所有对象的shallow heap之和。好，再来看org.rosenjiang.bo.Pilot对象实例的shallow heap为何是16，因为对象头是8字节，成员变量int是4字节、String引用是4字节，故总共16字节。
<img src="" alt="">
接着往下看，来到了Accumulated Objects by Class区域，顾名思义，这里能找到被聚集的对象实例的类名。org.rosenjiang.bo.Pilot类上头条了，被实例化了290,325次，再返回去看程序，我承认是故意这么干的。还有很多有用的报告可用来协助分析问题，只是本文中的例子太简单，也用不上。以后如有用到，一定撰文详细叙述。
<strong>又是perm gen</strong>
我们在上一篇文章中知道，perm gen是个异类，里面存储了类和方法数据（与class loader有关）以及interned strings（字符串驻留）。在heap dump中没有包含太多的perm gen信息。那么我们就用这些少量的信息来解决问题吧。
看下面的代码，利用interned strings把perm gen撑破了。
//<em>/</em>
 /<em> OOMPermTest class
 /</em> @author rosen jiang
 /*/
package org.rosenjiang.test;
public class OOMPermTest {
    public static void main(String[] args){
        oom();
    }</p>
<pre><code>private static void oom(){
    Object[] array = new Object[10000000];
    for(int i=0; i&lt;10000000; i++){
        String d = String.valueOf(i).intern();
        array[i]=d;
    }
}
</code></pre><p>}
控制台打印如下的信息，然后把java_pid1824.hprof文件导入到MAT。其实在MAT里，看到的状况应该和“OutOfMemoryError: Java heap space”差不多（用了数组），因为heap dump并没有包含interned strings方面的任何信息。只是在这里需要强调，使用intern()方法的时候应该多加注意。
java.lang.OutOfMemoryError: PermGen space
Dumping heap to java_pid1824.hprof <img src="" alt="">
Heap dump file created [121273334 bytes in 2.845 secs]
Exception in thread &quot;main&quot; java.lang.OutOfMemoryError: PermGen space
<img src="" alt=""><img src="" alt=""><img src="" alt=""><img src="" alt=""><img src="" alt="">
<img src="" alt=""><img src="" alt=""><img src="" alt="">
<img src="" alt=""><img src="" alt="">
倒是在思考如何把class loader撑破废了些心思。经过尝试，发现使用ASM来动态生成类才能达到目的。ASM(<a href="http://asm.objectweb.org)的主要作用是处理已编译类(compiled" target="_blank">http://asm.objectweb.org)的主要作用是处理已编译类(compiled</a> class)，能对已编译类进行生成、转换、分析（功能之一是实现动态代理），而且它运行起来足够的快和小巧，文档也全面，实属居家必备之良品。ASM提供了core API和tree API，前者是基于事件的方式，后者是基于对象的方式，类似于XML的SAX、DOM解析，但是使用tree API性能会有损失。既然下面要用到ASM，这里不得不啰嗦下已编译类的结构，包括：
    1、修饰符（例如public、private）、类名、父类名、接口和annotation部分。
    2、类成员变量声明，包括每个成员的修饰符、名字、类型和annotation。
    3、方法和构造函数描述，包括修饰符、名字、返回和传入参数类型，以及annotation。当然还包括这些方法或构造函数的具体Java字节码。
    4、常量池(constant pool)部分，constant pool是一个包含类中出现的数字、字符串、类型常量的数组。
<img src="" alt="">
已编译类和原来的类源码区别在于，已编译类只包含类本身，内部类不会在已编译类中出现，而是生成另外一个已编译类文件；其二，已编译类中没有注释；其三，已编译类没有package和import部分。
这里还得说说已编译类对Java类型的描述，对于原始类型由单个大写字母表示，Z代表boolean、C代表char、B代表byte、S代表short、I代表int、F代表float、J代表long、D代表double；而对类类型的描述使用内部名(internal name)外加前缀L和后面的分号共同表示来表示，所谓内部名就是带全包路径的表示法，例如String的内部名是java/lang/String；对于数组类型，使用单方括号加上数据元素类型的方式描述。最后对于方法的描述，用圆括号来表示，如果返回是void用V表示，具体参考下图。
<img src="" alt=""><img src="" alt="">
下面的代码中会使用ASM core API，注意接口ClassVisitor是核心，FieldVisitor、MethodVisitor都是辅助接口。ClassVisitor应该按照这样的方式来调用：visit visitSource? visitOuterClass? ( visitAnnotation | visitAttribute )/<em>( visitInnerClass | visitField | visitMethod )/</em> visitEnd。就是说visit方法必须首先调用，再调用最多一次的visitSource，再调用最多一次的visitOuterClass方法，接下来再多次调用visitAnnotation和visitAttribute方法，最后是多次调用visitInnerClass、visitField和visitMethod方法。调用完后再调用visitEnd方法作为结尾。
注意ClassWriter类，该类实现了ClassVisitor接口，通过toByteArray方法可以把已编译类直接构建成二进制形式。由于我们要动态生成子类，所以这里只对ClassWriter感兴趣。首先是抽象类原型：
//<em>/</em>
 /<em> @author rosen jiang
 /</em> MyAbsClass class
 /<em>/
package org.rosenjiang.test;
public abstract class MyAbsClass {
    int LESS = -1;
    int EQUAL = 0;
    int GREATER = 1;
    abstract int absTo(Object o);
}
其次是自定义类加载器，实在没法，ClassLoader的defineClass方法都是protected的，要加载字节数组形式（因为toByteArray了）的类只有继承一下自己再实现。
//</em>/<em>
 /</em> @author rosen jiang
 /<em> MyClassLoader class
 /</em>/
package org.rosenjiang.test;
public class MyClassLoader extends ClassLoader {
    public Class defineClass(String name, byte[] b) {
        return defineClass(name, b, 0, b.length);
    }
}
最后是测试类。
//<em>/</em>
 /<em> @author rosen jiang
 /</em> OOMPermTest class
 /<em>/
package org.rosenjiang.test;
import java.util.ArrayList;
import java.util.List;
import org.objectweb.asm.ClassWriter;
import org.objectweb.asm.Opcodes;
public class OOMPermTest {
    public static void main(String[] args) {
        OOMPermTest o = new OOMPermTest();
        o.oom();
    }
    private void oom() {
        try {
            ClassWriter cw = new ClassWriter(0);
            cw.visit(Opcodes.V1_5, Opcodes.ACC_PUBLIC + Opcodes.ACC_ABSTRACT,
            &quot;org/rosenjiang/test/MyAbsClass&quot;, null, &quot;java/lang/Object&quot;,
            new String[] {});
            cw.visitField(Opcodes.ACC_PUBLIC + Opcodes.ACC_FINAL + Opcodes.ACC_STATIC, &quot;LESS&quot;, &quot;I&quot;,
            null, new Integer(-1)).visitEnd();
            cw.visitField(Opcodes.ACC_PUBLIC + Opcodes.ACC_FINAL + Opcodes.ACC_STATIC, &quot;EQUAL&quot;, &quot;I&quot;,
            null, new Integer(0)).visitEnd();
            cw.visitField(Opcodes.ACC_PUBLIC + Opcodes.ACC_FINAL + Opcodes.ACC_STATIC, &quot;GREATER&quot;, &quot;I&quot;,
            null, new Integer(1)).visitEnd();
            cw.visitMethod(Opcodes.ACC_PUBLIC + Opcodes.ACC_ABSTRACT, &quot;absTo&quot;,
            &quot;(Ljava/lang/Object;)I&quot;, null, null).visitEnd();
            cw.visitEnd();
            byte[] b = cw.toByteArray();
            List<ClassLoader> classLoaders = new ArrayList<ClassLoader>();
            while (true) {
                MyClassLoader classLoader = new MyClassLoader();
                classLoader.defineClass(&quot;org.rosenjiang.test.MyAbsClass&quot;, b);
                classLoaders.add(classLoader);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
不一会儿，控制台就报错了。
java.lang.OutOfMemoryError: PermGen space
Dumping heap to java_pid3023.hprof <img src="" alt="">
Heap dump file created [92593641 bytes in 2.405 secs]
Exception in thread &quot;main&quot; java.lang.OutOfMemoryError: PermGen space
<img src="" alt=""><img src="" alt="">
<img src="" alt="">
打开java_pid3023.hprof文件，注意看下图的Classes: 88.1k和Class Loader: 87.7k部分，从这点可看出class loader加载了大量的类。
<img src="" alt="">
更进一步分析，点击上图中红框线圈起来的按钮，选择Java Basics——Class Loader Explorer功能。打开后能看到下图所示的界面，第一列是class loader名字；第二列是class loader已定义类(defined classes)的个数，这里要说一下已定义类和已加载类(loaded classes)了，当需要加载类的时候，相应的class loader会首先把请求委派给父class loader，只有当父class loader加载失败后，该class loader才会自己定义并加载类，这就是Java自己的“双亲委派加载链”结构；第三列是class loader所加载的类的实例数目。
<img src="" alt="">
在Class Loader Explorer这里，能发现class loader是否加载了过多的类。另外，还有Duplicate Classes功能，也能协助分析重复加载的类，在此就不再截图了，可以肯定的是MyAbsClass被重复加载了N多次。
<strong>最后</strong>
其实MAT工具非常的强大，上面故弄玄虚的范例代码根本用不上MAT的其他分析功能，所以就不再描述了。其实对于OOM不只我列举的两种溢出错误，还有多种其他错误，但我想说的是，对于perm gen，如果实在找不出问题所在，建议使用JVM的-verbose参数，该参数会在后台打印出日志，可以用来查看哪个class loader加载了什么类，例：“[Loaded org.rosenjiang.test.MyAbsClass from org.rosenjiang.test.MyClassLoader]”。
全文完。
<em>*参考资料</em></em>
<a href="http://dev.eclipse.org/blogs/memoryanalyzer/" target="_blank">memoryanalyzer Blog</a>
<a href="http://kenwublog.com/structure-of-java-class-loader" target="_blank">java类加载器体系结构</a>
<a href="http://mindprod.com/jgloss/classloader.html" target="_blank">ClassLoader</a></p>
<p><a href="http://www.yourkit.com/docs/90/help/gc_roots.jsp" target="_blank"><strong>请注意！引用、转贴本文应注明原作者：Rosen Jiang 以及出处：</strong></a><a href="http://www.blogjava.net/rosen/archive/2010/06/archive/2010/05/archive/2010/rosen/archive/2010/rosen/archive/2009/10/archive/2009/09/archive/2009/07/archive/2009/06/archive/2009/04/archive/2009/03/archive/2009/02/archive/2008/12/archive/2008/rosen" target="_blank"><strong><a href="http://www.blogjava.net/rosen">http://www.blogjava.net/rosen</a></strong></a>
posted on 2010-06-13 16:13 <a href="http://www.blogjava.net/rosen/" target="_blank">Rosen</a> 阅读(1184) <a href="http://www.blogjava.net/rosen/archive/2010/06/13/323522.html#Post" target="_blank">评论(4)</a>  <a href="http://www.blogjava.net/rosen/admin/EditPosts.aspx?postid=323522" target="_blank">编辑</a>  <a href="http://www.blogjava.net/rosen/AddToFavorite.aspx?id=323522" target="_blank">收藏</a> 所属分类: <a href="http://www.blogjava.net/rosen/category/2690.html" target="_blank">Java 基础</a><img src="" alt=""></p>
<p><a href=""></a><a href=""></a></p>
<p>[</p>
<h3 id="-">评论</h3>
<p><a href="http://www.blogjava.net/rosen/archive/2010/06/13/323522.html#323527" title="permalink: re: 使用Memory Analyzer tool(MAT)分析内存泄漏（二）[未登录]" target="_blank">/#</a> <a href=""></a>re: 使用Memory Analyzer tool(MAT)分析内存泄漏（二）[未登录] 2010-06-13 16:31 <a href="">Jet</a></p>
<p>好文章啊，支持一直写下去~~  <a href="http://www.blogjava.net/rosen/archive/2010/06/13/323522.html#post" target="_blank">回复</a>  <a href="http://www.blogjava.net/comment?author=Jet" title="查看该作者发表过的评论" target="_blank">更多评论</a>
<a href=""></a>  <a href="">]()</a>
<a href="http://www.blogjava.net/rosen/archive/2010/06/13/323522.html#323559" title="permalink: re: 使用Memory Analyzer tool(MAT)分析内存泄漏（二）" target="_blank">/#</a> <a href=""></a>re: 使用Memory Analyzer tool(MAT)分析内存泄漏（二） 2010-06-14 14:11 <a href="">滴水</a></p>
<p>很棒，几种分类测试让人更加深刻的理解了JVM的内存分配机制。  <a href="http://www.blogjava.net/rosen/archive/2010/06/13/323522.html#post" target="_blank">回复</a>  <a href="http://www.blogjava.net/comment?author=%e6%bb%b4%e6%b0%b4" title="查看该作者发表过的评论" target="_blank">更多评论</a>
<a href=""></a>  <a href=""></a>
<a href="http://www.blogjava.net/rosen/archive/2010/06/13/323522.html#323561" title="permalink: re: 使用Memory Analyzer tool(MAT)分析内存泄漏（二）" target="_blank">/#</a> <a href=""></a>re: 使用Memory Analyzer tool(MAT)分析内存泄漏（二） 2010-06-14 14:50 <a href="http://www.blogjava.net/beansoft/">BeanSoft</a></p>
<p>经典文章!  <a href="http://www.blogjava.net/rosen/archive/2010/06/13/323522.html#post" target="_blank">回复</a>  <a href="http://www.blogjava.net/comment?author=BeanSoft" title="查看该作者发表过的评论" target="_blank">更多评论</a>
<a href=""></a>  <a href=""></a>
<a href="http://www.blogjava.net/rosen/archive/2010/06/13/323522.html#323567" title="permalink: re: 使用Memory Analyzer tool(MAT)分析内存泄漏（二）" target="_blank">/#</a> <a href=""></a>re: 使用Memory Analyzer tool(MAT)分析内存泄漏（二）<a href=""></a> 2010-06-14 18:12 <a href="http://www.blogjava.net/rosen/" target="_blank">Rosen</a></p>
<p>@Jet
@滴水
@BeanSoft
感谢各位的关注！非常感谢。  <a href="http://www.blogjava.net/rosen/archive/2010/06/13/323522.html#post" target="_blank">回复</a>  <a href="http://www.blogjava.net/comment?author=Rosen" title="查看该作者发表过的评论" target="_blank">更多评论</a>
<a href=""></a>  <a href=""></a>
<a href="http://www.blogjava.net/RequireRegister.aspx" target="_blank">新用户注册</a>  <a href="">刷新评论列表</a>  </p>
<p><a href=""></a> 推荐链接：
<a href="http://a4.yeshj.com/rd/35698/" target="_blank">众里寻你千百度，百度期待您的加盟</a>
<a href="http://a4.yeshj.com/rd/35449/" target="_blank">软件研发团队管理年会(7.10-7.11)</a>
<a href="http://www.cnblogs.com/cmt/archive/2010/06/08/1753881.html" target="_blank">博客园2010T恤正式发布</a></p>
<p>IT新闻：
· <a href="http://news.cnblogs.com/n/66449/" target="_blank">富士通东芝同意合并手机业务 10月建合资公司</a>
· <a href="http://news.cnblogs.com/n/66448/" target="_blank">微软拼音输入法15周年</a>
· <a href="http://news.cnblogs.com/n/66447/" target="_blank">苹果设备占美国移动上网流量58.8%</a>
· <a href="http://news.cnblogs.com/n/66446/" target="_blank">微软改变Office营销策略：允许厂商捆绑</a>
· <a href="http://news.cnblogs.com/n/66445/" target="_blank">木马来袭：Linux IRC服务器软件发现后门</a>    <a href="http://www.cnblogs.com/" target="_blank">博客园首页</a>  <a href="http://a4.yeshj.com/rd/34138/" target="_blank">学英语</a>  <a href="http://news.cnblogs.com/" target="_blank">IT新闻</a>  <a href="http://kb.cnblogs.com/" target="_blank">知识库</a>  <a href="http://job.cnblogs.com/cate-java_programmer/" target="_blank">Java程序员招聘</a> 标题  请输入标题 姓名  请输入你的姓名 主页 请输入验证码 验证码 /*  <img src="" alt=""> 内容(请不要发表任何与政治相关的内容) 请输入评论内容 Remember Me?   <a href="http://www.blogjava.net/login.aspx?ReturnURL=http://www.blogjava.net/rosen/archive/2010/06/13/323522.html&amp;SourceURL=/rosen/archive/2010/06/13/323522.html" target="_blank">登录</a>       [使用Ctrl+Enter键可以直接提交]   <a href="http://a4.yeshj.com/rd/34138/" target="_blank">每天10分钟，轻松学英语</a>  推荐职位：
· <a href="http://job.cnblogs.com/offer/7699/" target="_blank">Web前端研发工程师 (百度)</a>
· <a href="http://job.cnblogs.com/offer/7697/" target="_blank">数据挖掘工程师(百度)</a>
· <a href="http://job.cnblogs.com/offer/7696/" target="_blank">PHP研发工程师(百度)</a>
· <a href="http://job.cnblogs.com/Offer/7582/" target="_blank">急聘进销存软件开发经理(北京拜思腾信息)</a>
· <a href="http://job.cnblogs.com/offer/7378/" target="_blank">高级.NET开发工程师(盛大网络)</a>
· <a href="http://job.cnblogs.com/offer/7515/" target="_blank">Coolite VS2008 开发工程师 (深圳创新通软)</a>
· <a href="http://job.cnblogs.com/offer/7479/" target="_blank">分布式系统开发高级工程师(深圳创新科)</a>
· <a href="http://job.cnblogs.com/offer/7474/" target="_blank">Linux开发工程师(深圳创新科)</a></p>
<p>博客园首页随笔：
· <a href="http://www.cnblogs.com/81/archive/2010/06/17/1759596.html" target="_blank">WinForm下PictureBox和Panel控件的On_Paint事件有何区别</a>
· <a href="http://www.cnblogs.com/Sunmoonfire/archive/2010/06/17/1759506.html" target="_blank">ChartPart 图表显示</a>
· <a href="http://www.cnblogs.com/yangtongnet/archive/2010/06/17/1759569.html" target="_blank">随手写个Repeater分页控件，奉上自己源码，欢迎大虾挑刺</a>
· <a href="http://www.cnblogs.com/wynsdie/archive/2010/06/17/1759551.html" target="_blank">浅谈AnkhSvn</a>
· <a href="http://www.cnblogs.com/TerryBlog/archive/2010/06/17/1759542.html" target="_blank">Android小项目之--前台界面与用户交互的对接 进度条与拖动条（附源码）</a>
知识库：
· <a href="http://kb.cnblogs.com/page/66268/" target="_blank">关于Page Fault的一些整理</a>
· <a href="http://kb.cnblogs.com/page/65995/" target="_blank">我在南大的七年</a>
· <a href="http://kb.cnblogs.com/page/65966/" target="_blank">编写跨浏览器兼容的 CSS 代码的金科玉律</a>
· <a href="http://kb.cnblogs.com/page/65875/" target="_blank">程序员应知——首先检查自己的问题</a>
· <a href="http://kb.cnblogs.com/page/65843/" target="_blank">程序员的语言“艳遇史”（五）——办公室秘书Smalltalk</a>  网站导航:</p>
<p><a href="http://www.cnblogs.com/" target="_blank">博客园</a>   <a href="http://news.cnblogs.com/" target="_blank">IT新闻</a>   <a href="http://home.cnblogs.com/" target="_blank">个人主页</a>   <a href="http://www.cnweblog.com/" target="_blank">博客生活</a>   <a href="http://www.cnitblog.com/" target="_blank">IT博客网</a>   <a href="http://www.cppblog.com/" target="_blank">C++博客</a>   <a href="http://space.cnblogs.com/" target="_blank">博客园社区</a> <a href="http://www.blogjava.net/rosen/archive/2010/06/13/323522.html?opt=admin" target="_blank">管理</a> 相关文章:</p>
<ul>
<li><a href="http://www.blogjava.net/rosen/archive/2010/06/13/323522.html" target="_blank">使用Memory Analyzer tool(MAT)分析内存泄漏（二）</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2010/05/21/321575.html" target="_blank">使用Memory Analyzer tool(MAT)分析内存泄漏（一）</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2007/10/26/156286.html" target="_blank">VSS Plugin配置FAQ（翻译）</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2005/10/25/16729.html" target="_blank">Jakarta-ORO 分解 IP 地址</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2005/08/12/9974.html" target="_blank">利用反射从 XML 构造 VO</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2005/08/12/9956.html" target="_blank">Java 短路运算符和非短路运算符</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2005/08/12/9955.html" target="_blank">Java 中的位运算</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2005/08/12/9954.html" target="_blank">Java 工具，你用了吗？（翻译）</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2005/08/12/9951.html" target="_blank">循证克隆</a></li>
<li><a href="http://www.blogjava.net/rosen/archive/2005/08/12/9945.html" target="_blank">在 Eclipse 中使用 JUnit（翻译）</a>  </li>
</ul>
<p>Powered by:
<a href="http://www.blogjava.net/" target="_blank">BlogJava</a>
Copyright © Rosen</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/Java&J2EE/">Java&J2EE</a></li></span><span class="breadcrumb"><li><a href="/categories/Java&J2EE/">Java&J2EE</a></li><li><a href="/categories/Java&J2EE/Java_总结类/">Java_总结类</a></li></span></span> | <span class="tags">Tagged <a href="/tags/Java&J2EE/" class="label label-primary">Java&J2EE</a><a href="/tags/Java_总结类/" class="label label-success">Java_总结类</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:43"datetime="2014-03-07 09:54:43"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-JavaJ2EE-Java_总结类--使用MemoryAnalyzertoolMAT分析内存泄漏（二）/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-JavaJ2EE-Java_总结类--使用MemoryAnalyzertoolMAT分析内存泄漏（二）" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-JavaJ2EE-Java_总结类--为什么要使用集合框架？--ITeye技术网站/">为什么要使用集合框架？ </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:43.000Z"> <a href="/2014/02/02/2014-02-02-JavaJ2EE-Java_总结类--为什么要使用集合框架？--ITeye技术网站/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-iteye-">为什么要使用集合框架？ - - ITeye技术网站</h1>
<p><a href="http://www.iteye.com/" target="_blank">首页</a> <a href="http://www.iteye.com/news" target="_blank">新闻</a> <a href="http://www.iteye.com/forums" target="_blank">论坛</a> <a href="http://www.iteye.com/ask" target="_blank">问答</a> <a href="http://www.iteye.com/blogs" target="_blank">博客</a> <a href="http://www.iteye.com/job" target="_blank">招聘</a> <a href="http://java-mzd.iteye.com/blog/1002387#" target="_blank">更多 ▼</a></p>
<p><a href="http://www.iteye.com/wiki" target="_blank">专栏</a>  <a href="http://www.iteye.com/groups" target="_blank">群组</a> <a href="http://www.iteye.com/search" target="_blank">搜索</a></p>
<p><a href="http://java-mzd.iteye.com/login" title="登录" target="_blank">您还未登录 !</a> <a href="http://www.iteye.com/all" target="_blank">我的应用</a> <a href="http://java-mzd.iteye.com/login" target="_blank">登录</a> <a href="http://java-mzd.iteye.com/signup" target="_blank">注册</a></p>
<h1 id="-java-mzd-http-java-mzd-iteye-com-"><a href="http://java-mzd.iteye.com/" target="_blank">java-mzd</a></h1>
<p>永久域名 <a href="http://java-mzd.iteye.com/" target="_blank"><a href="http://java-mzd.iteye.com">http://java-mzd.iteye.com</a></a></p>
<p><a href="http://java-mzd.iteye.com/blog/1002387#" target="_blank">13顶</a>
<a href="http://java-mzd.iteye.com/blog/1002387#" target="_blank">5踩</a></p>
<p><a href="http://java-mzd.iteye.com/blog/1004784" title="淘宝武汉*面试归来" target="_blank">淘宝武汉/*面试归来</a> | <a href="http://java-mzd.iteye.com/blog/945822" title="湖南大学生软件联盟官网建设" target="_blank">湖南大学生软件联盟官网建设</a></p>
<p>2011-04-14</p>
<h3 id="-"><a href="">为什么要使用集合框架？</a></h3>
<p><strong>文章分类:<a href="http://www.iteye.com/blogs/category/java" target="_blank">Java编程</a></strong>
  题序：<strong>很多时候，我们专心研究一个东西的时候，往往忘记了我们最初的目的是什么。</strong></p>
<pre><code>    曾经研究过那么久的Java集合框架，为了搞清里面的细节，甚至都跑去重新买了一本数据结构，终于知道了线性表，知道了树，知道了查找表。也自己动手实现了ArrayList，LinkedList，HashMap等。

    今天在公交车上，突然想到“**我们为什么要使用****Java****集合框架呢？**”竟然一时语塞，半天想不起来，也说不出个所以然呢。顿时悲从中来啊。还是决定再次好好复习一把，现总结如下：
</code></pre><p><strong>    PS.还是那句老话，如果这些问题您都能轻松解答，没必要再浪费时间看下去了。</strong></p>
<ul>
<li><strong>Question one：我们为什么要使用集合框架？</strong></li>
<li><strong>Question two:关于ArrayList 和Vector  （HashMap和HashTable）PS</strong></li>
<li><strong>Question three：总体把握，集合框架的继承图</strong></li>
<li><strong>Question four：set 于map的关系（见李兴华书）</strong></li>
<li><strong>Question five：关于set（底层实现，关于TreeSet，关于排序，关于比较对象相等）</strong></li>
<li><strong>Question six： 已经存在了那么多的动态结构，为什么需要hash表？</strong></li>
<li><strong>Question seven：TreeMap 底层实现</strong></li>
</ul>
<p>Question One：我们为什么使用集合框架？</p>
<p>  大家还记得我们为什么要使用数组嘛？</p>
<p>  当我们需要保持一组一样（类型相同）的元素的时候，我们应该使用一个容器来保存，数组就是这样一个容器。</p>
<p>  那么，数组的缺点是什么呢？</p>
<p>  数组一旦定义，长度将不能再变化。</p>
<p>  然而在我们的开发实践中，经常需要保存一些变长的数据集合，于是，我们需要一些能够<strong>动态增长长度的容器</strong>来保存我们的数据。</p>
<p>  而我们需要对数据的保存的逻辑可能各种各样，于是就有了各种各样的数据结构。<strong>我们将数据结构在**</strong>Java中实现，于是就有了我们的集合框架。**</p>
<p>Question Two: List和Vector，HashMap和 HashTable 的区别在哪里呢？</p>
<p>前者都是在JDK1.2后推出的，在前者中，因为采用异步处理方式，性能更高。</p>
<p>（其实就是删掉了后者中操作数据{add ,remove等}时的线程同步锁，这样，效率更高了，但是却不再是线程安全的了，要线程安全，必须用户在程序中使用时自己控制。）</p>
<p>Question Three：集合框架继承图</p>
<p>本来想自己画个简图的，结果悲催的Rational Rose一直在抽风，也没时间去弄那个了。就网上Down了一个，暂且用着吧</p>
<pre><code>                                   ![]()
</code></pre><p>从这个图中，我们可以发现：Collection 接口包括List和Set两个子接口（其实还有Queue和Sorted两个子接口）</p>
<p>另外，也验证了我们前面说的，Array和Collection都是用来保存数据的容器。</p>
<p>Question Four：Set 和 Map 有什么关系？</p>
<p>从Question Three的继承图中，我们很明显的发现：Map虽然不像Set那样属 于 Collection，但是Set和Map的继承图是如此的相似。那么，他们之间到底有什么样的 关系呢？</p>
<p>从逻辑上来说：首先，如果我们只考察Map中的key，那么显然，这个key的集合就是一 个set：不能重复，无序。（Map中有keyset()的方法，能直接得到key的set）另外一 个层面，如果我们 将Map中的key何value当做一个整体，那么，显然，这个时候 的Map其实就是一个Set（在Map的实现中，都是通过一个内部类来将key和value当做 一个整体entity），</p>
<p>从代码角度本身角度来看，无论是HashSet还是TreeSet其实使用的都是对应 的Tree来实现的，我们用一个默认的Object，这样就可以存了。</p>
<p>而事实上Set的底层实现中，我们也可以发现，都是用对应的Map来实现的，只是，在每次存key-value 对的时候，都默认给了一个Object 类作为Value的默认值，</p>
<p>Question five：关于set（底层实现，关于TreeSet，关于排序，关于比较对象相等）</p>
<p>我们知道，Set是无序的，同时又是不能重复的，那么，这种不能重复性，是如何保证的呢？ 其实这个问题问的还是不到位，Question Four已经说了，底层是由Map实现的，那么都是由Map来实现的。</p>
<p><strong>为了唯一性，重点是能识别相同的元素（如何判断相等）<em>**</em></strong></p>
<p>在Java中，=号，表示内存地址相等，即是指向堆内存的同一引用，那么此时，显然两个元素是相等的。</p>
<p>当不是指向堆内存的同一引用时。<strong>我们就需要重写Object类的equals()**</strong>方法了**。在此，我们判断，如果我们需要比较的各个属性相等的话，那么则可认为这两个对象相等（关于属性相等的比较与此类似）</p>
<p>Question six： 已经存在了那么多的动态结构，为什么需要Hash表？</p>
<p>其实这个问题其实问的不恰当，应该是，有了诸如顺序表和有序表这样的静态表，诸如二叉排序树 平衡二叉树这样的动态表,为什么还需要Hash表呢?</p>
<p>因为记录在表中的<strong>位置</strong>和它的<strong>关键字</strong>之间<strong>不存在</strong>一个确定的关系。<strong>查找的过程</strong>为<strong>给定值</strong>依次和关键字集合中各个<strong>关键字</strong>进行<strong>比较</strong>。<strong>查找的效率</strong>取决于和给定值<strong>进行比较</strong>的关键字<strong>个数</strong>。</p>
<p>Question Seven: TreeMap 底层实现</p>
<p>TreeMap 底层由红黑树（Red-Black tree）实现。因为此部分内容包括算法分析，具体代码实现以及性能分析，内容比较多，所以本部分内容稍后专门用一个日志来推出。（形式类似HashMap那篇日志）</p>
<ul>
<li><a href=""><img src="&quot;点击查看原始大小图片&quot;" alt=""></a></li>
<li><p>大小: 4.4 KB</p>
</li>
<li><p><a href="http://java-mzd.iteye.com/blog/1002387#" target="_blank">查看图片附件</a>
<a href="http://java-mzd.iteye.com/blog/1002387#"><strong>13</strong>
顶</a><a href="http://java-mzd.iteye.com/blog/1002387#"><strong>5</strong>
踩</a></p>
</li>
</ul>
<p><a href="http://java-mzd.iteye.com/blog/1004784" title="淘宝武汉*面试归来" target="_blank">淘宝武汉/*面试归来</a> | <a href="http://java-mzd.iteye.com/blog/945822" title="湖南大学生软件联盟官网建设" target="_blank">湖南大学生软件联盟官网建设</a></p>
<ul>
<li>05:05</li>
<li>浏览 (3292)</li>
<li><a href="http://java-mzd.iteye.com/blog/1002387#comments" target="_blank">评论</a> (7)</li>
<li><a href="http://www.iteye.com/wiki/topic/1002387" target="_blank">相关推荐</a></li>
</ul>
<h3 id="-">评论</h3>
<p><a href=""></a></p>
<p>7 楼 <a href="http://scholers.iteye.com/" target="_blank">scholers</a> 2011-05-09   <a href="http://java-mzd.iteye.com/blog/1002387#" target="_blank">引用</a></p>
<p>重写了equals,那么必须要重写hashcode
否则在set,map中会出错，
这个也是一个规定！
6 楼 <a href="http://hastune.iteye.com/" target="_blank">hastune</a> 2011-04-22   <a href="http://java-mzd.iteye.com/blog/1002387#" target="_blank">引用</a></p>
<p>s929498110 写道</p>
<p>真的啊
打开JDK下面的src里面的源码看看、 一切就豁然开朗了
这些集合都有自己的实现机制、 了解了实现机制，他们的优缺点就一目了然了
没必要从别人对这些东西的看法理解中寻找属于自己的看法理解
源码看起来很容易的、 主要是其中有的算法需要琢磨琢磨
个人觉得需要琢磨的是怎么用好这些就行。算法的话，大可不必了。
源码有些地方也不太简单。原作者的一些思路还是可以琢磨一下吧。
如果需要自己写个容器的话，还是得想想算法吧。</p>
<p>5 楼 <a href="http://s929498110.iteye.com/" target="_blank">s929498110</a> 2011-04-22   <a href="http://java-mzd.iteye.com/blog/1002387#" target="_blank">引用</a></p>
<p>真的啊
打开JDK下面的src里面的源码看看、 一切就豁然开朗了
这些集合都有自己的实现机制、 了解了实现机制，他们的优缺点就一目了然了
没必要从别人对这些东西的看法理解中寻找属于自己的看法理解
源码看起来很容易的、 主要是其中有的算法需要琢磨琢磨
4 楼 <a href="http://yaoohfox.iteye.com/" target="_blank">yaoohfox</a> 2011-04-21   <a href="http://java-mzd.iteye.com/blog/1002387#" target="_blank">引用</a></p>
<p>写的不错。</p>
<p>3 楼 <a href="http://duriun-yahoo-cn.iteye.com/" target="_blank">Durian</a> 2011-04-19   <a href="http://java-mzd.iteye.com/blog/1002387#" target="_blank">引用</a></p>
<p>看文章，lz不是计算机专业
2 楼 <a href="http://java-mzd.iteye.com/" target="_blank">java_mzd</a> 2011-04-14   <a href="http://java-mzd.iteye.com/blog/1002387#" target="_blank">引用</a></p>
<p>悲剧了 写道</p>
<p>看来楼主没用好集合框架，看看源代码就知道了，及时它部提供，我们自己也要写，他提供了那就正好用他提供的，不用自己山寨写了
  呵呵，我水平不高，不会用。
也就明白明白道理，研究研究源码，自己写一写，检验自己懂不懂罢了。
高人面前，不敢称懂。</p>
<p>1 楼 <a href="http://feisuwoniu.iteye.com/" target="_blank">悲剧了</a> 2011-04-14   <a href="http://java-mzd.iteye.com/blog/1002387#" target="_blank">引用</a></p>
<p>看来楼主没用好集合框架，看看源代码就知道了，及时它部提供，我们自己也要写，他提供了那就正好用他提供的，不用自己山寨写了</p>
<h3 id="-">发表评论</h3>
<h3 id="-">表情图标</h3>
<p><img src="" alt=""><img src="" alt=""><img src="" alt=""><img src="" alt=""><img src="" alt=""><img src="" alt=""><img src="" alt=""><img src="" alt=""><img src="" alt=""><img src="" alt=""><img src="" alt=""><img src="" alt=""><img src="" alt=""><img src="" alt=""><img src="" alt=""><img src="" alt=""><img src="" alt=""><img src="" alt=""><img src="" alt=""><img src="" alt=""></p>
<p>字体颜色: 标准深红红色橙色棕色黄色绿色橄榄青色蓝色深蓝靛蓝紫色灰色白色黑色 字体大小: 标准1 (xx-small)2 (x-small)3 (small)4 (medium)5 (large)6 (x-large)7 (xx-large) 对齐: 标准居左居中居右</p>
<p>提示：选择您需要装饰的文字, 按上列按钮即可添加上相应的标签</p>
<p>您还没有登录，请<a href="http://java-mzd.iteye.com/login" target="_blank">登录</a>后发表评论(快捷键 Alt+S / Ctrl+Enter)</p>
<p><a href="http://java-mzd.iteye.com/" target="_blank"><img src="&quot;java_mzd的博客: &quot;" alt="java_mzd的博客"></a></p>
<p>java_mzd</p>
<ul>
<li>浏览: 70748 次</li>
<li>性别: <img src="&quot;男&quot;" alt="Icon_minigender_1"></li>
<li>来自: 长沙</li>
<li><img src="" alt=""></li>
<li><a href="http://java-mzd.iteye.com/blog/profile" target="_blank">详细资料</a> <a href="http://java-mzd.iteye.com/blog/guest_book" target="_blank">留言簿</a></li>
</ul>
<h3 id="-">搜索本博客</h3>
<h3 id="-http-java-mzd-iteye-com-blog-user_visits-">最近访客 <a href="http://java-mzd.iteye.com/blog/user_visits" target="_blank">&gt;&gt;更多访客</a></h3>
<p><a href="http://zhxing.iteye.com/" target="_blank"><img src="&quot;zhxing的博客: ヾ孤星随缘ツ  http://t.sina.com.cn/samzhxing&quot;" alt="zhxing的博客"></a></p>
<p><a href="http://zhxing.iteye.com/" target="_blank">zhxing</a></p>
<p><a href="http://java-suddy.iteye.com/" target="_blank"><img src="&quot;java_suddy的博客: “平凡”的思想&quot;" alt="java_suddy的博客"></a></p>
<p><a href="http://java-suddy.iteye.com/" target="_blank">java_suddy</a>
<a href="http://liuxinglanyue.iteye.com/" target="_blank"><img src="&quot;liuxinglanyue的博客: liuxinglanyue&quot;" alt="liuxinglanyue的博客"></a></p>
<p><a href="http://liuxinglanyue.iteye.com/" target="_blank">liuxinglanyue</a></p>
<p><a href="http://libo-591.iteye.com/" target="_blank"><img src="&quot;libo_591的博客: 让更多的人站在巨人的肩膀上&quot;" alt="libo_591的博客"></a></p>
<p><a href="http://libo-591.iteye.com/" target="_blank">libo_591</a></p>
<h3 id="-">博客分类</h3>
<ul>
<li><a href="http://java-mzd.iteye.com/" target="_blank">全部博客 (43)</a></li>
<li><a href="http://java-mzd.iteye.com/category/133623" target="_blank">数据结构----------JAVA类集 (5)</a></li>
<li><p><a href="http://java-mzd.iteye.com/category/153171" target="_blank">TCP/IP (7)</a></p>
<h3 id="-http-java-mzd-iteye-com-blog-guest_book-">我的留言簿 <a href="http://java-mzd.iteye.com/blog/guest_book" target="_blank">&gt;&gt;更多留言</a></h3>
</li>
<li><p>楼主 你工作多久了。。。。
-- by <a href="http://java-mzd.iteye.com/blog/guest_book#39913" target="_blank">fanmingxing</a></p>
</li>
<li>写的不错，学习，谢谢！
-- by <a href="http://java-mzd.iteye.com/blog/guest_book#39693" target="_blank">chenge2k</a></li>
<li>看了LZ的文章，发现工作快两年的我，就像是一块浮起来的木头，真的很惭愧！也不怪我拿 ...
-- by <a href="http://java-mzd.iteye.com/blog/guest_book#39618" target="_blank">GoTiger</a></li>
</ul>
<h3 id="-">其他分类</h3>
<ul>
<li><a href="http://java-mzd.iteye.com/blog/favorite" target="_blank">我的收藏</a> (23)</li>
<li><a href="http://java-mzd.iteye.com/blog/code_favorite" target="_blank">我的代码</a> (0)</li>
<li><a href="http://java-mzd.iteye.com/blog/topic" target="_blank">我的论坛主题帖</a> (3)</li>
<li><a href="http://java-mzd.iteye.com/blog/post" target="_blank">我的所有论坛帖</a> (37)</li>
<li><p><a href="http://java-mzd.iteye.com/blog/article" target="_blank">我的精华良好帖</a> (0)</p>
<h3 id="-">最近加入群组</h3>
</li>
<li><p><a href="http://android.group.iteye.com/" target="_blank">Android</a></p>
</li>
</ul>
<h3 id="-">存档</h3>
<ul>
<li><a href="http://java-mzd.iteye.com/blog/monthblog/2011-05" target="_blank">2011-05</a> (2)</li>
<li><a href="http://java-mzd.iteye.com/blog/monthblog/2011-04" target="_blank">2011-04</a> (7)</li>
<li><a href="http://java-mzd.iteye.com/blog/monthblog/2011-03" target="_blank">2011-03</a> (2)</li>
<li><p><a href="http://java-mzd.iteye.com/blog/monthblog_more" target="_blank">更多存档...</a></p>
<h3 id="-">评论排行榜</h3>
</li>
<li><p><a href="http://java-mzd.iteye.com/blog/1050043" title="腾讯、淘宝、金山网络，实习生我该何去何从" target="_blank">腾讯、淘宝、金山网络，实习生我该何去何从</a></p>
</li>
<li><a href="http://java-mzd.iteye.com/blog/1050926" title="淘宝、金山网络，百感交集" target="_blank">淘宝、金山网络，百感交集</a></li>
<li><a href="http://java-mzd.iteye.com/blog/1007577" title="TCP/IP传输层，你懂多少？" target="_blank">TCP/IP传输层，你懂多少？</a></li>
<li><a href="http://java-mzd.iteye.com/blog/1004784" title="淘宝武汉*面试归来" target="_blank">淘宝武汉/*面试归来</a></li>
<li><p><a href="http://java-mzd.iteye.com/blog/862787" title="开源软件？自由软件？免费软件？你了解多少？" target="_blank">开源软件？自由软件？免费软件？你了解多少 ...</a></p>
</li>
<li><p><a href="http://java-mzd.iteye.com/rss" target="_blank"><img src="" alt="Rss"></a></p>
</li>
<li><a href="http://fusion.google.com/add?feedurl=http://java-mzd.iteye.com/rss" target="_blank"><img src="" alt="Rss_google"></a>
声明：ITeye文章版权属于作者，受法律保护。没有作者书面许可不得转载。若作者同意转载，必须以超链接形式标明文章原始出处和作者。
© 2003-2011 ITeye.com. All rights reserved. [ 京ICP证110151号 ]
<img src="" alt=""></li>
</ul>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/Java&J2EE/">Java&J2EE</a></li></span><span class="breadcrumb"><li><a href="/categories/Java&J2EE/">Java&J2EE</a></li><li><a href="/categories/Java&J2EE/Java_总结类/">Java_总结类</a></li></span></span> | <span class="tags">Tagged <a href="/tags/Java&J2EE/" class="label label-primary">Java&J2EE</a><a href="/tags/Java_总结类/" class="label label-success">Java_总结类</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:43"datetime="2014-03-07 09:54:43"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-JavaJ2EE-Java_总结类--为什么要使用集合框架？--ITeye技术网站/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-JavaJ2EE-Java_总结类--为什么要使用集合框架？--ITeye技术网站" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>





<ul id="pagination" class="pagination pagination-lg">
  <li><a class="extend prev" href="/page/36/">&laquo;</a></li><li><a class="page-number" href="/">1</a></li><li><a class="page-number" href="/page/2/">2</a></li><li><span class="space">&hellip;</span></li><li><a class="page-number" href="/page/34/">34</a></li><li><a class="page-number" href="/page/35/">35</a></li><li><a class="page-number" href="/page/36/">36</a></li><li class="active"><li><span class="page-number current">37</span></li><li><a class="page-number" href="/page/38/">38</a></li><li><a class="page-number" href="/page/39/">39</a></li><li><a class="page-number" href="/page/40/">40</a></li><li><span class="space">&hellip;</span></li></li><li><a class="page-number" href="/page/164/">164</a></li><li><a class="page-number" href="/page/165/">165</a></li><li><a class="extend next" href="/page/38/">&raquo;</a></li>
  <div class="clearfix"></div>
</ul></div><!--wapper-->
       </div><!-- ID main-col END -->
       <aside id="sidebar" class="alignright col-sx-6 col-sm-4 col-md-3 col-lg-3">
<div id="widget_search" class="widget panel panel-primary">
    <form action="//google.com/search" method="get" accept-charset="utf-8">
  <div class="input-group">
    <input class="form-control" id="searchbox" type="search" name="q" results="0" placeholder="search">
    <span class="input-group-btn">
      <button class="btn btn-default" type="submit">Go!</button>
    </span>
    <input type="hidden" name="q" value="site:itsolife.com">
  </div>
</form>
</div>

<div id="widget_category" class="widget panel panel-primary">
  <div class="panel-heading">category</div>  <div data-src='category' class='ajax_widgets'>正在加载...</div>
</div>

<div id="widget_recent_posts" class="widget panel panel-primary">
  <div class="panel-heading">recent posts</div>  <div data-src='recent_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_tagcloud" class="widget panel panel-primary">
  <div class="panel-heading">tagcloud</div>  <div data-src='tagcloud' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_latest_update_posts" class="widget panel panel-primary">
  <div class="panel-heading">最近更新</div>  <div data-src='latest_update_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_recent_comments" class="widget panel panel-primary">
  <div class="panel-heading">recent comments</div>  

<div class="list-group-item ds-recent-comments" data-num-items="6" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="50"></div>



</div>

</aside>
       <div class="clearfix"></div>
     </div><!-- row END -->
  </div>
  <footer id="footer" class="container">
  <div class="panel panel-info">
  <section id='footer_widget'></section>  <div class="panel-footer">
  <div id="site-info">
    <span class='author'>
  
  &copy; 2014 RobinChia
  
    &nbsp;&nbsp;</span>
  
  <span id='analytics-51la'></span><span id='analytics-google'>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-48559895-1']);
  _gaq.push(['_trackPageview']);
  _js2load.push({src:('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'});
</script></span><span id='analytics-cnzz'>
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_5774006'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s17.cnzz.com/stat.php%3Fid%3D5774006%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
</span><span id='analytics-baidu'>
<script>
var _hmt = _hmt || [];
_js2load.push({src:"//hm.baidu.com/hm.js?1442f50724afc42380b51f097c43082c"});
</script>
</span>  </div>
  <div id="copyright">Blog powered by <a href='http://zespia.tw/hexo/'><strong>hexo</strong></a> Theme <strong><a href='https://github.com/chenall/hexo-theme-chenall'>chenall</a></strong>(Some change in it)<span class="pull-right"> 更新时间: <em>2014-03-26 21:21:32</em></span></div>
</div>
<div class="clearfix"></div>


  </div>
  </footer>
  
        <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>        
        <script src="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/js/bootstrap.min.js"></script>        
                
        <script src="http://cdn.bootcss.com/prettify/r298/prettify.min.js"></script>    <script type="text/javascript">
   var lang=["bsh", "c", "cc", "cpp", "cs", "csh", "cyc", "cv", "htm", "html",
    "java", "js", "m", "mxml", "perl", "pl", "pm", "py", "rb", "sh",
    "xhtml", "xml", "xsl"];
   var pretty_base='';
   $('script').each(function(){
	var c = $(this).attr('src');
	if (!c)
	    return;
	if (c.match(/(\/)?prettify(\.min)?\.js/i))
	{
	    var index = c.lastIndexOf('/');
	    if (index != -1)
		pretty_base = c.substr(0,index + 1);
	    return false;
	}
   })
   $('pre code').each(function(){
	var c = $(this).attr('class')
	if (!c)
	    return;
	c = c.match(/\s?(lang\-\w+)/i);
	if (c && lang.indexOf(c[1]) == -1)
	{
	    lang.push(c[1]);
	    $.getScript(pretty_base + c[1] + '.min.js');
	}
   })

    $(window).load(function(){
       $("pre").addClass("prettyprint");
       prettyPrint();
    })
</script>    
            <script type="text/javascript">
var duoshuoQuery = {short_name:"robinchia"};
_js2load.push({src:'http://static.duoshuo.com/embed.js',charset:'UTF-8'});
</script>
    
            <!--wumii_relatedItems-->
    
        <script src="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js"></script>    <script type="text/javascript">
(function($){
  $('.entry').each(function(i){
    $(this).find('img').each(function(){
      var alt = this.alt;

      if (alt){
        $(this).before('<span class="caption">' + alt + '</span>');
      }

      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="fancybox' + i + '" />');
    });
  });

  $('.fancybox').fancybox();
})(jQuery);
</script>    
        <script src="http://cdn.bootcss.com/mathjax/2.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>
    
<script type="text/javascript">
$('.ajax_widgets').each(function(){var src=$(this).attr('data-src');if(src)$(this).load('/widgets/'+src+'.html');});
$.each(_js2load,function(index,obj){loadjs(obj.src,obj.charset)});
</script>

<div id="scroll2top">
<img src="/scroll2top/arrow.png"/>
</div>
<script src="/scroll2top/scroll2top.min.js"></script>
<div id="winterland">
  <canvas></canvas>
</div>
<script src="/js/winterland.min.js"></script>

  </body>
</html>
