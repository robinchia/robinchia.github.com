
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>The 30 Page | It so life</title>
<meta name="author" content="RobinChia">

<meta name="description" content="It so life">


<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta property="og:site_name" content="It so life"/>

<!--[if IE]><style>.testIE.IE{display:inline;}</style><![endif]-->
<!--[if lte IE 7]><link rel="stylesheet" href="/css/ie7.css" type="text/css"><![endif]-->
<!--[if (lt IE 9)&(gt IE 7)]><style>.testIE.IE8{display:inline;}</style><![endif]-->
<!--[if gt IE 8]><style>.testIE.IE9{display:inline;}</style><![endif]-->

<link href="/favicon.png" rel="icon">
<link rel="alternate" href="/atom.xml" title="It so life Feed" type="application/atom+xml">

<link rel="stylesheet" href="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.0.3/css/font-awesome.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/prettify/r298/prettify.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" type="text/css">
<link rel="stylesheet" href="/css/style.css" type="text/css">
<!--[if lt IE 9]>
   <style>article,aside,dialog,footer,header,section,footer,nav,figure,menu{display:block}</style>
   <script src="http://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
   <script src="http://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
<link href="http://cdn.staticfile.org/respond.js/1.4.2/respond-proxy.html" id="respond-proxy" rel="respond-proxy" />
<link href="/js/respond.proxy.gif" id="respond-redirect" rel="respond-redirect" />
<script src="/js/respond.proxy.js"></script>
   <script src="http://cdn.bootcss.com/selectivizr/1.0.2/selectivizr-min.js"></script>
<![endif]-->
<script type="text/javascript">
function loadjs(c,d){var a=document.createElement("script");a.async=!0;a.type="text/javascript";a.src=c;a.charset=d||"gbk";(document.getElementsByTagName("HEAD")[0]||document.getElementsByTagName("BODY")[0]).appendChild(a)};
var _protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
var _js2load = [];
</script>

</head>
<body>
      <header id="header" class="container"><nav id="main-nav" class="navbar navbar-default navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="/">It so life</a>
    </div>
    <div  class="collapse navbar-collapse">
      <ul  class="nav navbar-nav">
  
        <li><a href="/" title="Home">Home</a></li>      
        <li><a href="/about/" title="About">About</a></li>      
        <li><a href="/archives/" title="Archives">Archives</a></li>      
      <li class='dropdown'>
        <a class='dropdown-toggle' data-toggle='dropdown' href='#'>website<b class='caret'></b></a>
        <ul class='dropdown-menu pure-menu-selected'>
    
          <li><a href="//groups.google.com/forum/#!forum/pongba" title="TopLanguage">TopLanguage</a></li>    
          <li><a href="//itpub.net/" title="ITPub">ITPub</a></li>    
          <li><a href="//blog.jobbole.com/" title="Bole">Bole</a></li>    
          <li><a href="//nosql-database.org/" title="nosql">nosql</a></li>    
          <li><a href="//gitimmersion.googol.im/" title="Git">Git</a></li>    
        </ul>
      </li>
    
      </ul>
      <ul class="nav navbar-nav navbar-right">
      
        <li><a href="/atom.xml">RSS</a></li>
      
      
        <li><a href="https://twitter.com/robinchia">twitter</a></li>
      
      
      
      
        <li><a href="https://github.com/robinchia">github</a></li>
      
      </ul>
    </div>
  </div>
</nav>
<div class="clearfix"></div>
</header>
  <div id='content' class="container">
     <div class="page-header-wrapper">
      <!--[if lt IE 9]><div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong>提示:</strong>您的浏览器版本太低了,建议升级到 <strong><a href="http://windows.microsoft.com/zh-cn/internet-explorer/download-ie" title="IE9">IE9</a></strong> 以上,本站使用<a href="https://www.google.com/intl/zh-CN/chrome/">Chrome浏览器</a>可以获得最好的显示效果.</div><![endif]-->
      <div class="page-header"><h1 align="center"><big>It so life</big> </h1>
        <h5 align="center"><big>love as life</big></h5>
      </div>
     </div>
     <div class="row">
       <div id="main-col" class="alignleft col-sx-12 col-sm-8 col-md-9 col-lg-9">
      <section id='header_widget'></section>
          <div id="wrapper"><article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-服务器-集群--apachetomcat整合LINUX/">apache+tomcat整合(LINUX) </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:44.000Z"> <a href="/2014/02/02/2014-02-02-服务器-集群--apachetomcat整合LINUX/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="apache-tomcat-linux-linux-linux-">apache+tomcat整合(LINUX) - 技术文档 - 网络技术 Linux时代 - 开源、自由、共享 - 中国最大的Linux技术社区</h1>
<p>·<a href="http://www.chinaunix.net/" target="_blank">ChinaUnix首页</a> ·<a href="http://bbs.chinaunix.net/" target="_blank">论坛</a> ·<a href="http://blog.chinaunix.net/" target="_blank">博客</a>   <img src="" alt=""> <img src="" alt=""> <a href="http://linux.chinaunix.net/" target="_blank">Linux首页</a> | <a href="http://linux.chinaunix.net/news/" target="_blank">Linux新闻</a> | <a href="http://linux.chinaunix.net/bbs" target="_blank"><strong>Linux论坛</strong></a> | <a href="http://linux.chinaunix.net/techdoc/" target="_blank">Linux文档</a> | <a href="http://download.chinaunix.net/disc/linux/" target="_blank">Linux下载</a> | <a href="http://blog.chinaunix.net/techart.php?frmid=6" target="_blank">Linux博客</a> | <a href="http://search.chinaunix.net/" target="_blank">Linux搜索</a> | <a href="http://linux.chinaunix.net/bbs/index.php?gid=68" target="_blank">开源项目孵化平台</a> | <a href="http://linux.chinaunix.net/ebook/" target="_blank">《开源时代》</a> <img src="" alt=""> <a href="http://linux.chinaunix.net/techdoc/beginner/" target="_blank">新手入门</a> |  <a href="http://linux.chinaunix.net/techdoc/install/" target="_blank">安装启动</a> |  <a href="http://linux.chinaunix.net/techdoc/system/" target="_blank">管理员指南</a> | <a href="http://man.chinaunix.net/" target="_blank">开发手册</a> | <a href="http://linux.chinaunix.net/techdoc/desktop/" target="_blank">桌面应用</a> | <a href="http://linux.chinaunix.net/techdoc/develop/" target="_blank">程序开发</a> | <a href="http://linux.chinaunix.net/techdoc/database/" target="_blank">数据库</a> |  <a href="http://linux.chinaunix.net/techdoc/net/" target="_blank">网络技术</a>| <a href="http://linux.chinaunix.net/topics/2007-01-25/15/index.shtml" target="_blank">CentOS</a> | <a href="http://linux.chinaunix.net/search2.php?key=fedora&amp;id=0" target="_blank">Fedora</a> |  <a href="http://linux.chinaunix.net/search2.php?key=mysql&amp;id=0" target="_blank">MySQL</a> |  <a href="http://linux.chinaunix.net/search2.php?key=apache&amp;id=0" target="_blank">Apache</a> |  <a href="http://linux.chinaunix.net/search2.php?key=ubuntu&amp;id=0" target="_blank">Ubuntu</a> |  <a href="http://linux.chinaunix.net/topics/2008-07-10/18/index.shtml" target="_blank">Gentoo</a>| <strong><a href="http://linux.chinaunix.net/topics/2008-07-30/19/index.shtml" target="_blank">OSCON08</a></strong>    <a href="http://linux.chinaunix.net/" target="_blank">Linux时代</a> &gt;&gt; <a href="http://linux.chinaunix.net/techdoc/" target="_blank">技术文档</a> &gt;&gt; <a href="http://linux.chinaunix.net/techdoc/net/" target="_blank">网络技术</a>  apache+tomcat整合(LINUX)  来源: ChinaUnix博客 　日期： 2007.12.28 13:38　(共有条评论) <a href="http://linux.chinaunix.net/bbs/thread-975323-1-1.html" target="_blank">我要评论</a>   这里介绍两类方法：
    这里假设你已安装并且配置好了JDK
                           一：用apt-get 安装
apt-get install apache2 tomcat5.5 libapache2-mod-jk
设置Tomcat管理员帐号
Tomcat的用户帐号信息都保存在tomcat-users.xml的文件中，运行
sudo gedit /usr/share/tomcat6/conf/tomcat-users.xml在的标签前添加一行
保存并关闭。重新运行tomcat即可输入该用户名和密码，登录Tomcat的管理页面。
确认一下在apache2的启动模块中是否有jk.load
/#sudo ls /etc/apache2/mods-enabled/
/#sudo vi /etc/libapache2-mod-jk/workers.properties
workers.tomcat_home=/usr/share/tomcat6
workers.java_home=/usr/lib/jvm/java-6-sun
/#sudo vi /usr/share/doc/libapache2-mod-jk/httpd_example_apache2.conf
复制里面的内容到apache2.conf
最后重启apache tomcat上传jsp文件到usr/share/tomcat6/webapps/ROOT
                               二:手动下载安装
1.安装jdk
2.安装tomcat
3.编译安装apache2
4.停止以上两个启动的服务:tomcat,apache
5.编译安装jk-connector
6.编辑配置文件
7.看结果吧
详细流程：
1.安装jdk
1.1
下载jdk包，可以是rpm包或者tar包，解压缩到某目录，然后
ln -s /usr/local/src/jdk-1.6./<em> /usr/local/java
1.2
设置环境变量
vi /etc/profile
export JAVA_HOME=/usr/local/java/
export PATH=$PATH:$JAVA_HOME/bin
export CLASSPATH=.:$CLASSPATH:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar
export JRE_HOME=$JAVA_HOME/jre
1.3
启用环境变量
source /etc/profile
1.4
检验成功否
java -version 或 javac -v
2.安装tomcat
tar zxvf /mnt/hgfs/Untitled-1/apache-tomcat-5.5.12.tar.gz -C /usr/local/src/
ln -s /usr/local/src/apache-tomcat-5.5.12 /usr/local/tomcat
/usr/local/tomcat/bin/startup.sh
在浏览器中输入<a href="http://IP地址:8080" target="_blank">http://IP地址:8080</a>
可以看到大花猫了。
3.编译安装apache2
tar zxvf /mnt/hgfs/Untitled-1/httpd-2.2.4.tar.gz  -C /usr/local/src/
cd /usr/local/src/httpd-2.2.4
在进行编译之前要确保系统中没有apr或者apr-util的rpm包或者deb包。下面一下子编译安装了apr，apr-util，httpd
cd srclib/apr &amp;&amp; ./configure --prefix=/usr/local/apr &amp;&amp; make &amp;&amp; make install &amp;&amp; cd ../apr-util &amp;&amp; ./configure --prefix=/usr/local/apr-util --with-apr=/usr/local/apr &amp;&amp; make &amp;&amp; make install &amp;&amp; cd ../.. &amp;&amp; ./configure --prefix=/usr/local/httpd --with-apr=/usr/local/apr --with-apr-util=/usr/local/apr-util --enable-so &amp;&amp; make &amp;&amp; make install
下面编辑httpd.conf文件中ServerName字段的注释符，可以换成你的IP地址，或者什么都不换。
下面启动apache看看效果
/usr/local/httpd/bin/apachectl -k start
看到了It Works就对了。
4.停止以上两个启动的服务:tomcat,apache。
/usr/local/tomcat/bin/shutdown.sh
/usr/local/httpd/bin/apachectl stop
5.编译安装jk-connector
tar zxvf /mnt/hgfs/Untitled-1/tomcat-connectors-1.2.21-src.tar.gz -C /usr/local/src/
cd /usr/local/src/tomcat-connectors-1.2.21-src/native/
编译安装jk-connector，带上apxs的地址，会在安装的时候自动把mod_jk.so放到/usr/local/httpd/modules里面
./configure --with-apxs=/usr/local/httpd/bin/apxs &amp;&amp; make &amp;&amp; make install
ls /usr/local/httpd/modules
看到mod_jk.so表示成功
6.编辑配置文件
6.1编辑/usr/local/httpd/conf/mod_jk.conf
/# 指出mod_jk模块工作所需要的工作文件workers.properties的位置
JkWorkersFile /usr/local/httpd/conf/workers.properties
/# Where to put jk logs
JkLogFile /var/log/apache2/mod_jk.log
/# Set the jk log level [debug/error/info]
JkLogLevel info
/# Select the log format
JkLogStampFormat &quot;[%a %b %d %H:%M:%S %Y]&quot;
/# JkOptions indicate to send SSL KEY SIZE,
JkOptions  +ForwardKeySize +ForwardURICompat -ForwardDirectories
/# JkRequestLogFormat set the request format
JkRequestLogFormat &quot;%w %V %T&quot;
/# 将所有servlet 和jsp请求通过ajp13的协议送给Tomcat，让Tomcat来处理
JkMount /servlet//</em>  worker1
JkMount //*.jsp worker1
6.2编辑/usr/local/httpd/conf/workers.properties
/# Defining a worker named worker1 and of type ajp13
worker.list=worker1
/# Set properties for worker1
worker.worker1.type=ajp13<br>worker.worker1.host=localhost<br>worker.worker1.port=8009
worker.worker1.lbfactor=50<br>worker.worker1.cachesize=10<br>worker.worker1.cache_timeout=600<br>worker.worker1.socket_keepalive=1<br>worker.worker1.socket_timeout=300
6.3编辑httpd.conf文件
加入如下：
LoadModule jk_module modules/mod_jk.so
Include /usr/local/httpd/conf/mod_jk.conf
修改htdoc的默认地址为/usr/local/tomcat/webapps
修改htdoc的参数，也就是给原来htdoc的目录参数给webapps
修改DirectoryIndex index.html index.htm index.jsp
7.看结果吧
<a href="http://IP地址" target="_blank">http://IP地址</a>
可以看到一只大花猫。ok，成功了。
如何修改tomcat单独启动时候的端口为80？</p>
<p>里面的Connector port=&quot;8080&quot;改为Connector port=&quot;80&quot;</p>
<p><strong>本文来自ChinaUnix博客，如果查看原文请点：</strong><a href="http://blog.chinaunix.net/u1/51404/showart_452032.html" target="_blank"><a href="http://blog.chinaunix.net/u1/51404/showart_452032.html">http://blog.chinaunix.net/u1/51404/showart_452032.html</a></a> <a href="http://linux.chinaunix.net/bbs/thread-975323-1-1.html" target="_blank">发表评论</a> <a href="http://linux.chinaunix.net/bbs/thread-975323-1-1.html" target="_blank">查看评论</a>(共有条评论) <a href="http://linux.chinaunix.net/bbs/forum-4-1.html" target="_blank">我要提问</a>     最新资讯<a href="http://linux.chinaunix.net/news" target="_blank">更多&gt;&gt;</a>  · <a href="http://linux.chinaunix.net/news/2010/12/10/1175490.shtml" title="金山卫士开源计划首周源码下载突破两万" target="_blank">金山卫士开源计划首周源码下载..</a>
· <a href="http://linux.chinaunix.net/news/2010/12/10/1175491.shtml" title="谷歌劝说诺基亚采用Android操作系统" target="_blank">谷歌劝说诺基亚采用Android操作..</a>
· <a href="http://linux.chinaunix.net/news/2010/12/10/1175492.shtml" title="11月份Linux市场占有率升至5%" target="_blank">11月份Linux市场占有率升至5%</a>
· <a href="http://linux.chinaunix.net/news/2010/12/10/1175493.shtml" title="Apache 基金会确认退出 JCP 执行委员会" target="_blank">Apache 基金会确认退出 JCP 执..</a>
· <a href="http://linux.chinaunix.net/news/2010/12/07/1175306.shtml" title="Chrome 10 新功能探秘：新增GPU混合加速功能" target="_blank">Chrome 10 新功能探秘：新增GP..</a>
· <a href="http://linux.chinaunix.net/news/2010/12/07/1175307.shtml" title="金山宣布开源其安全软件" target="_blank">金山宣布开源其安全软件</a>
· <a href="http://linux.chinaunix.net/news/2010/12/07/1175308.shtml" title="开源FTP服务器ProFTPD发现后门" target="_blank">开源FTP服务器ProFTPD发现后门</a>
· <a href="http://linux.chinaunix.net/news/2010/12/07/1175309.shtml" title="女黑客在开源会议上抱受骚扰" target="_blank">女黑客在开源会议上抱受骚扰</a>
· <a href="http://linux.chinaunix.net/news/2010/12/07/1175310.shtml" title="21款值得关注的Linux游戏" target="_blank">21款值得关注的Linux游戏</a>
· <a href="http://linux.chinaunix.net/news/2010/12/07/1175311.shtml" title="马化腾：腾讯半年后彻底转型，开放和分享" target="_blank">马化腾：腾讯半年后彻底转型，..</a> 论坛热点<a href="http://linux.chinaunix.net/bbs" target="_blank">更多&gt;&gt;</a>  · <a href="http://linux.chinaunix.net/bbs/thread-1177273-1-1.html" title="Linux系统移植从零开始！参与讨论即有机会获得图书一本！" target="_blank">Linux系统移植从零开始！参与..</a>
· <a href="http://linux.chinaunix.net/bbs/thread-1177271-1-1.html" title="学习linux的意义在哪里" target="_blank">学习linux的意义在哪里</a>
· <a href="http://linux.chinaunix.net/bbs/thread-1177409-1-1.html" title="使用netfilter在哪能获取到原始以太包" target="_blank">使用netfilter在哪能获取到原..</a>
· <a href="http://linux.chinaunix.net/bbs/thread-1177298-1-1.html" title="哥纠结了" target="_blank">哥纠结了</a>
· <a href="http://linux.chinaunix.net/bbs/thread-1177227-1-1.html" title="一个在线读开源代码的工具，希望版主能保留几天，谢谢！" target="_blank">一个在线读开源代码的工具，..</a>
· <a href="http://linux.chinaunix.net/bbs/thread-1177374-1-1.html" title="为什么我的目录下没有.cshrc文件？" target="_blank">为什么我的目录下没有.cshrc..</a>
· <a href="http://linux.chinaunix.net/bbs/thread-1177344-1-1.html" title="初学linux从哪里开始" target="_blank">初学linux从哪里开始</a>
· <a href="http://linux.chinaunix.net/bbs/thread-1177382-1-1.html" title="linux 系统无法上网" target="_blank">linux 系统无法上网</a>
· <a href="http://linux.chinaunix.net/bbs/thread-1177380-1-1.html" title="新手安装UCenter 时总是出错。望高手指点" target="_blank">新手安装UCenter 时总是出错..</a>
· <a href="http://linux.chinaunix.net/bbs/thread-1177274-1-1.html" title="cacti添加主机显示的状态都是unknow，不能进行资源绘图" target="_blank">cacti添加主机显示的状态都是..</a> 文档更新<a href="http://linux.chinaunix.net/techdoc" target="_blank">更多&gt;&gt;</a>  · <a href="http://linux.chinaunix.net/techdoc/beginner/2010/11/17/1174196.shtml" title="菜鸟入门三星ARM11嵌入式系统，是否困难？" target="_blank">菜鸟入门三星ARM11嵌入式系统，是..</a>
· <a href="http://linux.chinaunix.net/techdoc/beginner/2010/09/16/1171153.shtml" title="寻redhat 5.3 的中文手册 for ia64" target="_blank">寻redhat 5.3 的中文手册 for ia64</a>
· <a href="http://linux.chinaunix.net/techdoc/beginner/2010/09/06/1170624.shtml" title="请问redhat 5.3 企业版的用户手册去哪里下载？" target="_blank">请问redhat 5.3 企业版的用户手册..</a>
· <a href="http://linux.chinaunix.net/techdoc/beginner/2010/08/18/1169548.shtml" title="LINUX与UNIX SHELL编程指南(中文)" target="_blank">LINUX与UNIX SHELL编程指南(中文)</a>
· <a href="http://linux.chinaunix.net/techdoc/beginner/2010/03/24/1160550.shtml" title="一些基本用户管理以及基本安装方法" target="_blank">一些基本用户管理以及基本安装方法</a>
· <a href="http://linux.chinaunix.net/techdoc/beginner/2010/03/23/1160525.shtml" title="菜鸟学习linux笔记与练习-----第二天。一些基本命令以及初级网络配置" target="_blank">菜鸟学习linux笔记与练习-----第..</a>
· <a href="http://linux.chinaunix.net/techdoc/beginner/2010/03/23/1160523.shtml" title="菜鸟学习linux笔记与练习-----第一天。一些初级命令以及基本用户管理" target="_blank">菜鸟学习linux笔记与练习-----第..</a>
· <a href="http://linux.chinaunix.net/techdoc/beginner/2010/03/22/1160427.shtml" title="服务器配置：Squid配置详解" target="_blank">服务器配置：Squid配置详解</a>
· <a href="http://linux.chinaunix.net/techdoc/install/2010/01/29/1156159.shtml" title="linux下u盘使用" target="_blank">linux下u盘使用</a>
· <a href="http://linux.chinaunix.net/techdoc/install/2010/01/29/1156155.shtml" title="ubuntu dynamips 绑定网卡到虚拟机" target="_blank">ubuntu dynamips 绑定网卡到虚拟机</a>    <a href="http://www.chinaunix.net/about/index.shtml" target="_blank">关于我们</a> | <a href="http://www.chinaunix.net/about/connect.html" target="_blank">联系方式</a> | <a href="http://www.chinaunix.net/about/service.html" target="_blank">广告合作</a> | <a href="http://www.chinaunix.net/about/hr.html" target="_blank">诚聘英才</a> | <a href="http://www.chinaunix.net/about/channel.html" target="_blank">网站地图</a> | <a href="http://www.chinaunix.net/about/friend.html" target="_blank">友情链接</a> | <a href="http://linux.chinaunix.net/bbs/register.php" target="_blank">免费注册</a>  Copyright © 2001-2009 ChinaUnix.net All Rights Reserved</p>
<p>感谢所有关心和支持过ChinaUnix的朋友们</p>
<p><a href="http://www.it168.com/images/icp.jpg" target="_blank">京ICP证:060528号</a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/服务器/">服务器</a></li></span><span class="breadcrumb"><li><a href="/categories/服务器/">服务器</a></li><li><a href="/categories/服务器/集群/">集群</a></li></span></span> | <span class="tags">Tagged <a href="/tags/服务器/" class="label label-primary">服务器</a><a href="/tags/集群/" class="label label-success">集群</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:44"datetime="2014-03-07 09:54:44"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-服务器-集群--apachetomcat整合LINUX/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-服务器-集群--apachetomcat整合LINUX" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-服务器-集群--Linux下Apache与Tomcat整合的简单方法-LinuxSirOrg/">Linux下Apache与Tomcat整合的简单方法 </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:44.000Z"> <a href="/2014/02/02/2014-02-02-服务器-集群--Linux下Apache与Tomcat整合的简单方法-LinuxSirOrg/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="linux-apache-tomcat-linuxsir-org">Linux下Apache与Tomcat整合的简单方法 - LinuxSir.Org</h1>
<p><a href=""></a> <a href="http://www.linuxsir.org/bbs/index.php?s=b91078e77de0bd2a626708973b8082ac"><img src="&quot;LinuxSir.Org&quot;" alt="LinuxSir.Org"></a>   用户名  密码   记住信息</p>
<p>| <a href="http://www.linuxsir.org/" target="_blank">网站首页</a> |   <a href="http://www.linuxsir.org/bbs/faq.php?s=b91078e77de0bd2a626708973b8082ac" target="_blank">论坛帮助</a> |
欢迎来到<strong>LinuxSir.Org</strong>! 您还未登录，请登录后查看论坛，或者点击论坛上方的注册链接注册新账号。
<a href="http://www.linuxsir.org/bbs/showthread.php?t=236915#" target="_blank"><img src="&quot;返回&quot;" alt="返回"></a>   <a href="http://www.linuxsir.org/bbs/index.php?s=b91078e77de0bd2a626708973b8082ac" target="_blank">LinuxSir.Org</a> &gt; <a href="http://www.linuxsir.org/bbs/forumdisplay.php?s=b91078e77de0bd2a626708973b8082ac&amp;f=39" target="_blank">Linux 发行版讨论区 —— LinuxSir.Org</a> &gt; <a href="http://www.linuxsir.org/bbs/forumdisplay.php?s=b91078e77de0bd2a626708973b8082ac&amp;f=49" target="_blank">Linux 发行版Debian专题</a> &gt; Linux下Apache与Tomcat整合的简单方法
转到页面...  <a href=""></a>  <a href="http://www.linuxsir.org/bbs/newthread.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newthread&amp;f=49"><img src="&quot;发表新主题&quot;" alt="发表新主题"></a>  <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;noquote=1&amp;p=1354073" target="_blank"><img src="&quot;回复&quot;" alt="回复"></a>     <a href="http://www.linuxsir.org/bbs/showthread.php?t=236915&amp;nojs=1#goto_threadtools" target="_blank">主题工具</a>  <img src="" alt=""></p>
<p><a href=""><img src="&quot;旧&quot;" alt="旧"></a> 05-12-23, 20:51 <a href="http://www.linuxsir.org/bbs/showpost.php?s=b91078e77de0bd2a626708973b8082ac&amp;p=1354073&amp;postcount=1" target="_blank"><strong>第 1 帖</strong></a> <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=45616" target="_blank"><strong>Kilin</strong></a></p>
<p><img src="" alt=""></p>
<p><a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=45616" target="_blank"><img src="&quot;Kilin 的头像&quot;" alt="Kilin 的头像"></a>  </p>
<p>注册会员<br>  注册日期: Jun 2004</p>
<p>  帖子: 321
  <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;goodnees=1&amp;u=45616" target="_blank">精华</a>: 1        <strong>标题: Linux下Apache与Tomcat整合的简单方法</strong>
1、准备，下载需要的文件。这里假定你已经正确安装配置好了JDK。
到Apache官方网站下载所需要的文件：
httpd-2.2.0.tar.gz
apache-tomcat-5.5.12.tar.gz
jakarta-tomcat-connectors-1.2.15-src.tar.gz
其中httpd和jakarta-tomcat-connectors为源码包，apache-tomcat为二进制包。
2、安装Apache。
代码: /# tar xzvf httpd-2.2.0.tar.gz /# cd httpd-2.2.0 /# ./configure --prefix=/usr/local/apache2 --enable-so /# make /# make install3、安装Tomcat。
代码: /# cp apache-tomcat-5.5.12.tar.gz /usr/local/ /# cd /usr/local /# tar xzvf apache-tomcat-5.5.12.tar.gz /# ln -s apache-tomcat-5.5.12 tomcat4、编译生成mod_jk。
代码: /# tar xzvf jakarta-tomcat-connectors-1.2.15-src.tar.gz /# cd jakarta-tomcat-connectors-1.2.15-src/jk/native /# ./configure --with-apxs=/usr/local/apache2/bin/apxs /# make /# cp ./apache-2.0/mod_jk.so /usr/local/apache2/modules/5、配置。
在/usr/local/apache2/conf/下面建立两个配置文件mod_jk.conf和workers.properties。
/# vi mod_jk.conf
添加以下内容：
代码: /# 指出mod_jk模块工作所需要的工作文件workers.properties的位置 JkWorkersFile /usr/local/apache2/conf/workers.properties /# Where to put jk logs JkLogFile /usr/local/apache2/logs/mod_jk.log /# Set the jk log level [debug/error/info] JkLogLevel info /# Select the log format JkLogStampFormat &quot;[%a %b %d %H:%M:%S %Y]&quot; /# JkOptions indicate to send SSL KEY SIZE, JkOptions +ForwardKeySize +ForwardURICompat -ForwardDirectories /# JkRequestLogFormat set the request format JkRequestLogFormat &quot;%w %V %T&quot; /# 将所有servlet 和jsp请求通过ajp13的协议送给Tomcat，让Tomcat来处理 JkMount /servlet//<em> worker1 JkMount //</em>.jsp worker1/# vi workers.properties
添加以下内容：
代码: /# Defining a worker named worker1 and of type ajp13 worker.list=worker1 /# Set properties for worker1 worker.worker1.type=ajp13 worker.worker1.host=localhost worker.worker1.port=8009 worker.worker1.lbfactor=50 worker.worker1.cachesize=10 worker.worker1.cache_timeout=600 worker.worker1.socket_keepalive=1 worker.worker1.socket_timeout=300再配置httpd.conf，作以下修改：
将Listen 80 修改为 Listen 127.0.0.1:80
将ServerName 修改为 ServerName LocalHost:80
在DirectoryIndex中添加 index.jsp
我的网页放在/var/wwwroot下，所以要修改DocumentRoot
代码: DocumentRoot &quot;/var/wwwroot&quot; <Directory "/var/wwwroot"> Options Includes FollowSymLinks AllowOverride None Order deny,allow Allow from all XBitHack on </Directory> <Directory "/var/wwwroot/WEB-INF"> Order deny,allow Deny from all </Directory>增加关于加载mod_jk的语句：
代码: LoadModule jk_module modules/mod_jk.so Include /usr/local/apache2/conf/mod_jk.conf最后编辑Tomcat的配置文件server.xml，在HOST段中加入：
代码: <Context path="" docBase="/var/wwwroot" debug="0" reloadable="true" crossContext="true"/>在/var/wwwroot下建立一个index.jsp，启动Apache和Tomcat，用浏览器访问<a href="http://localhost/，应该可以看到正确的页面了。" target="_blank">http://localhost/，应该可以看到正确的页面了。</a></p>
<hr>
<p>Only the strong survive.
Blog:<a href="http://www.ylxiong.cn/" target="_blank">http://www.ylxiong.cn/</a>
Linux 2.6</p>
<p><em>此帖于 05-12-23 20:55 被 Kilin 编辑.</em>   <img src="&quot;Kilin 当前离线&quot;" alt="Kilin 当前离线">   <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;p=1354073" target="_blank"><img src="&quot;回复时引用此帖&quot;" alt="回复时引用此帖"></a></p>
<p>Kilin <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=45616" target="_blank">查看公开信息</a> <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;u=45616" target="_blank">查找 Kilin 发表的更多帖子</a></p>
<p><a href=""><img src="&quot;旧&quot;" alt="旧"></a> 05-12-24, 19:59 <a href="http://www.linuxsir.org/bbs/showpost.php?s=b91078e77de0bd2a626708973b8082ac&amp;p=1354576&amp;postcount=2" target="_blank"><strong>第 2 帖</strong></a> <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank"><strong>lyingjie</strong></a>  <img src="&quot;帅哥&quot;" alt="帅哥"></p>
<p><img src="" alt=""></p>
<p><a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank"><img src="&quot;lyingjie 的头像&quot;" alt="lyingjie 的头像"></a>  </p>
<p>注册会员<br>  注册日期: Aug 2005</p>
<p>  帖子: 284
  精华: 0        问一下老兄，Apache2不能用apt进行安装吗</p>
<hr>
<p>Debian Linux学习基地
<a href="http://www.debian.ha.cn" target="_blank">http://www.debian.ha.cn</a>   <img src="&quot;lyingjie 当前离线&quot;" alt="lyingjie 当前离线">   <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;p=1354576" target="_blank"><img src="&quot;回复时引用此帖&quot;" alt="回复时引用此帖"></a></p>
<p>lyingjie <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank">查看公开信息</a> <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;u=89579" target="_blank">查找 lyingjie 发表的更多帖子</a>
<a href=""><img src="&quot;旧&quot;" alt="旧"></a> 05-12-24, 20:58 <a href="http://www.linuxsir.org/bbs/showpost.php?s=b91078e77de0bd2a626708973b8082ac&amp;p=1354612&amp;postcount=3" target="_blank"><strong>第 3 帖</strong></a> <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank"><strong>lyingjie</strong></a>  <img src="&quot;帅哥&quot;" alt="帅哥"></p>
<p><img src="" alt=""></p>
<p><a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank"><img src="&quot;lyingjie 的头像&quot;" alt="lyingjie 的头像"></a>  </p>
<p>注册会员<br>  注册日期: Aug 2005</p>
<p>  帖子: 284
  精华: 0        我用apt安装时进入apache2目录后没有conf这个子目录   <img src="&quot;lyingjie 当前离线&quot;" alt="lyingjie 当前离线">   <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;p=1354612" target="_blank"><img src="&quot;回复时引用此帖&quot;" alt="回复时引用此帖"></a></p>
<p>lyingjie <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank">查看公开信息</a> <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;u=89579" target="_blank">查找 lyingjie 发表的更多帖子</a></p>
<p><a href=""><img src="&quot;旧&quot;" alt="旧"></a> 05-12-24, 21:35 <a href="http://www.linuxsir.org/bbs/showpost.php?s=b91078e77de0bd2a626708973b8082ac&amp;p=1354644&amp;postcount=4" target="_blank"><strong>第 4 帖</strong></a> <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=45616" target="_blank"><strong>Kilin</strong></a></p>
<p><img src="" alt=""></p>
<p><a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=45616" target="_blank"><img src="&quot;Kilin 的头像&quot;" alt="Kilin 的头像"></a>  </p>
<p>注册会员<br>  注册日期: Jun 2004</p>
<p>  帖子: 321
  <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;goodnees=1&amp;u=45616" target="_blank">精华</a>: 1        可以吧 应该在/etc/local/etc/目录下吧.......
或者在/etc/local/share/etc/下
如果做服务器用的话 建议安装基本系统 然后再自己安装需要的Server端软件。   <img src="&quot;Kilin 当前离线&quot;" alt="Kilin 当前离线">   <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;p=1354644" target="_blank"><img src="&quot;回复时引用此帖&quot;" alt="回复时引用此帖"></a></p>
<p>Kilin <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=45616" target="_blank">查看公开信息</a> <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;u=45616" target="_blank">查找 Kilin 发表的更多帖子</a>
<a href=""><img src="&quot;旧&quot;" alt="旧"></a> 05-12-25, 11:35 <a href="http://www.linuxsir.org/bbs/showpost.php?s=b91078e77de0bd2a626708973b8082ac&amp;p=1354810&amp;postcount=5" target="_blank"><strong>第 5 帖</strong></a> <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank"><strong>lyingjie</strong></a>  <img src="&quot;帅哥&quot;" alt="帅哥"></p>
<p><img src="" alt=""></p>
<p><a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank"><img src="&quot;lyingjie 的头像&quot;" alt="lyingjie 的头像"></a>  </p>
<p>注册会员<br>  注册日期: Aug 2005</p>
<p>  帖子: 284
  精华: 0        谢了我在试试   <img src="&quot;lyingjie 当前离线&quot;" alt="lyingjie 当前离线">   <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;p=1354810" target="_blank"><img src="&quot;回复时引用此帖&quot;" alt="回复时引用此帖"></a></p>
<p>lyingjie <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank">查看公开信息</a> <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;u=89579" target="_blank">查找 lyingjie 发表的更多帖子</a></p>
<p><a href=""><img src="&quot;旧&quot;" alt="旧"></a> 05-12-25, 11:58 <a href="http://www.linuxsir.org/bbs/showpost.php?s=b91078e77de0bd2a626708973b8082ac&amp;p=1354826&amp;postcount=6" target="_blank"><strong>第 6 帖</strong></a> <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=45616" target="_blank"><strong>Kilin</strong></a></p>
<p><img src="" alt=""></p>
<p><a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=45616" target="_blank"><img src="&quot;Kilin 的头像&quot;" alt="Kilin 的头像"></a>  </p>
<p>注册会员<br>  注册日期: Jun 2004</p>
<p>  帖子: 321
  <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;goodnees=1&amp;u=45616" target="_blank">精华</a>: 1        汗.....昨天喝高了 把路径打得一塌糊涂.....
应该是/etc
或者是/usr/etc
或者是/usr/local/etc
猜的~   <img src="&quot;Kilin 当前离线&quot;" alt="Kilin 当前离线">   <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;p=1354826" target="_blank"><img src="&quot;回复时引用此帖&quot;" alt="回复时引用此帖"></a></p>
<p>Kilin <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=45616" target="_blank">查看公开信息</a> <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;u=45616" target="_blank">查找 Kilin 发表的更多帖子</a>
<a href=""><img src="&quot;旧&quot;" alt="旧"></a> 05-12-25, 14:24 <a href="http://www.linuxsir.org/bbs/showpost.php?s=b91078e77de0bd2a626708973b8082ac&amp;p=1354897&amp;postcount=7" target="_blank"><strong>第 7 帖</strong></a> <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank"><strong>lyingjie</strong></a>  <img src="&quot;帅哥&quot;" alt="帅哥"></p>
<p><img src="" alt=""></p>
<p><a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank"><img src="&quot;lyingjie 的头像&quot;" alt="lyingjie 的头像"></a>  </p>
<p>注册会员<br>  注册日期: Aug 2005</p>
<p>  帖子: 284
  精华: 0        好的，那在问你一个问题我现在按照你所讲的我已经配成了JSP可以为什么我打开静态页是打不开呀？
提示你无权查看该页   <img src="&quot;lyingjie 当前离线&quot;" alt="lyingjie 当前离线">   <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;p=1354897" target="_blank"><img src="&quot;回复时引用此帖&quot;" alt="回复时引用此帖"></a></p>
<p>lyingjie <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank">查看公开信息</a> <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;u=89579" target="_blank">查找 lyingjie 发表的更多帖子</a></p>
<p><a href=""><img src="&quot;旧&quot;" alt="旧"></a> 05-12-25, 17:38 <a href="http://www.linuxsir.org/bbs/showpost.php?s=b91078e77de0bd2a626708973b8082ac&amp;p=1354988&amp;postcount=8" target="_blank"><strong>第 8 帖</strong></a> <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=45616" target="_blank"><strong>Kilin</strong></a></p>
<p><img src="" alt=""></p>
<p><a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=45616" target="_blank"><img src="&quot;Kilin 的头像&quot;" alt="Kilin 的头像"></a>  </p>
<p>注册会员<br>  注册日期: Jun 2004</p>
<p>  帖子: 321
  <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;goodnees=1&amp;u=45616" target="_blank">精华</a>: 1        httpd.conf里的权限设置.....   <img src="&quot;Kilin 当前离线&quot;" alt="Kilin 当前离线">   <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;p=1354988" target="_blank"><img src="&quot;回复时引用此帖&quot;" alt="回复时引用此帖"></a></p>
<p>Kilin <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=45616" target="_blank">查看公开信息</a> <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;u=45616" target="_blank">查找 Kilin 发表的更多帖子</a>
<a href=""><img src="&quot;旧&quot;" alt="旧"></a> 05-12-25, 17:43 <a href="http://www.linuxsir.org/bbs/showpost.php?s=b91078e77de0bd2a626708973b8082ac&amp;p=1354995&amp;postcount=9" target="_blank"><strong>第 9 帖</strong></a> <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank"><strong>lyingjie</strong></a>  <img src="&quot;帅哥&quot;" alt="帅哥"></p>
<p><img src="" alt=""></p>
<p><a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank"><img src="&quot;lyingjie 的头像&quot;" alt="lyingjie 的头像"></a>  </p>
<p>注册会员<br>  注册日期: Aug 2005</p>
<p>  帖子: 284
  精华: 0        能不能说的在明白点呀，我以前做LAMP时有时也会出现这样子的问题   <img src="&quot;lyingjie 当前离线&quot;" alt="lyingjie 当前离线">   <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;p=1354995" target="_blank"><img src="&quot;回复时引用此帖&quot;" alt="回复时引用此帖"></a></p>
<p>lyingjie <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank">查看公开信息</a> <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;u=89579" target="_blank">查找 lyingjie 发表的更多帖子</a></p>
<p><a href=""><img src="&quot;旧&quot;" alt="旧"></a> 05-12-26, 09:59 <a href="http://www.linuxsir.org/bbs/showpost.php?s=b91078e77de0bd2a626708973b8082ac&amp;p=1355323&amp;postcount=10" target="_blank"><strong>第 10 帖</strong></a> <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank"><strong>lyingjie</strong></a>  <img src="&quot;帅哥&quot;" alt="帅哥"></p>
<p><img src="" alt=""></p>
<p><a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank"><img src="&quot;lyingjie 的头像&quot;" alt="lyingjie 的头像"></a>  </p>
<p>注册会员<br>  注册日期: Aug 2005</p>
<p>  帖子: 284
  精华: 0        还有我如果用Apt安装的话那不能给讲讲如何做呀   <img src="&quot;lyingjie 当前离线&quot;" alt="lyingjie 当前离线">   <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;p=1355323" target="_blank"><img src="&quot;回复时引用此帖&quot;" alt="回复时引用此帖"></a></p>
<p>lyingjie <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank">查看公开信息</a> <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;u=89579" target="_blank">查找 lyingjie 发表的更多帖子</a>
<a href=""><img src="&quot;旧&quot;" alt="旧"></a> 05-12-27, 22:02 <a href="http://www.linuxsir.org/bbs/showpost.php?s=b91078e77de0bd2a626708973b8082ac&amp;p=1356579&amp;postcount=11" target="_blank"><strong>第 11 帖</strong></a> <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=55742" target="_blank"><strong>marvel</strong></a></p>
<p><img src="" alt=""></p>
<p>注册会员<br>  注册日期: Oct 2004</p>
<p>  帖子: 489
  精华: 0        apache配置文件的默认路径应该是/etc/apache/httpd.conf吧</p>
<hr>
<p>Thinkpad T60
酷睿 1.83GHz+512Mb DDR+80Gb+ATI(64Mb)
Debian unstable   <img src="&quot;marvel 当前离线&quot;" alt="marvel 当前离线">   <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;p=1356579" target="_blank"><img src="&quot;回复时引用此帖&quot;" alt="回复时引用此帖"></a></p>
<p>marvel <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=55742" target="_blank">查看公开信息</a> <a href="http://marvel.hit.edu.cn/" target="_blank">访问 marvel 的个人网站</a> <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;u=55742" target="_blank">查找 marvel 发表的更多帖子</a></p>
<p><a href=""><img src="&quot;旧&quot;" alt="旧"></a> 05-12-28, 03:25 <a href="http://www.linuxsir.org/bbs/showpost.php?s=b91078e77de0bd2a626708973b8082ac&amp;p=1356702&amp;postcount=12" target="_blank"><strong>第 12 帖</strong></a> <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=27503" target="_blank"><strong>wjl</strong></a></p>
<p><img src="" alt=""></p>
<p><a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=27503" target="_blank"><img src="&quot;wjl 的头像&quot;" alt="wjl 的头像"></a>  </p>
<p>注册会员<br>  注册日期: Nov 2003</p>
<p>  我的住址: 北京
  帖子: 90</p>
<p>  精华: 0
  good谢谢</p>
<hr>
<p>FreeBSD
RHEL AS</p>
<h2 id="windows-xp">Windows XP</h2>
<p>借我一生,好好爱你   <img src="&quot;wjl 当前离线&quot;" alt="wjl 当前离线">   <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;p=1356702" target="_blank"><img src="&quot;回复时引用此帖&quot;" alt="回复时引用此帖"></a></p>
<p>wjl <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=27503" target="_blank">查看公开信息</a> <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;u=27503" target="_blank">查找 wjl 发表的更多帖子</a>
<a href=""><img src="&quot;旧&quot;" alt="旧"></a> 05-12-28, 10:35 <a href="http://www.linuxsir.org/bbs/showpost.php?s=b91078e77de0bd2a626708973b8082ac&amp;p=1356852&amp;postcount=13" target="_blank"><strong>第 13 帖</strong></a> <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank"><strong>lyingjie</strong></a>  <img src="&quot;帅哥&quot;" alt="帅哥"></p>
<p><img src="" alt=""></p>
<p><a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank"><img src="&quot;lyingjie 的头像&quot;" alt="lyingjie 的头像"></a>  </p>
<p>注册会员<br>  注册日期: Aug 2005</p>
<p>  帖子: 284
  精华: 0        你说的是Apache1.3的位置   <img src="&quot;lyingjie 当前离线&quot;" alt="lyingjie 当前离线">   <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;p=1356852" target="_blank"><img src="&quot;回复时引用此帖&quot;" alt="回复时引用此帖"></a></p>
<p>lyingjie <a href="http://www.linuxsir.org/bbs/member.php?s=b91078e77de0bd2a626708973b8082ac&amp;u=89579" target="_blank">查看公开信息</a> <a href="http://www.linuxsir.org/bbs/search.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=finduser&amp;u=89579" target="_blank">查找 lyingjie 发表的更多帖子</a>
<a href="http://www.linuxsir.org/bbs/newthread.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newthread&amp;f=49" target="_blank"><img src="&quot;发表新主题&quot;" alt="发表新主题"></a>  <a href="http://www.linuxsir.org/bbs/newreply.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=newreply&amp;noquote=1&amp;p=1356852" target="_blank"><img src="&quot;回复&quot;" alt="回复"></a>
<strong>«</strong> <a href="http://www.linuxsir.org/bbs/showthread.php?s=b91078e77de0bd2a626708973b8082ac&amp;t=236915&amp;goto=nextoldest" target="_blank">上一主题</a> | <a href="http://www.linuxsir.org/bbs/showthread.php?s=b91078e77de0bd2a626708973b8082ac&amp;t=236915&amp;goto=nextnewest" target="_blank">下一主题</a> <strong>»</strong>
主题工具<a href=""></a> <img src="&quot;显示可打印版本&quot;" alt="显示可打印版本"> <a href="http://www.linuxsir.org/bbs/printthread.php?s=b91078e77de0bd2a626708973b8082ac&amp;t=236915">显示可打印版本</a> <img src="&quot;邮寄本页给好友&quot;" alt="邮寄本页给好友"> <a href="http://www.linuxsir.org/bbs/sendmessage.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=sendtofriend&amp;t=236915" target="_blank">邮寄本页给好友</a>      <a href="http://www.linuxsir.org/bbs/showthread.php?t=236915#top" target="_blank"><img src="" alt=""></a> 发帖规则 您 [不可以] 发表新主题</p>
<p>您 [不可以] 回复主题
您 [不可以] 上传附件</p>
<p>您 [不可以] 编辑您的帖子
已 [启用] <a href="http://www.linuxsir.org/bbs/misc.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=bbcode" target="_blank">BB 代码</a></p>
<p>已 [启用] <a href="http://www.linuxsir.org/bbs/misc.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=showsmilies" target="_blank">表情符号</a>
已 [启用] <a href="http://www.linuxsir.org/bbs/misc.php?s=b91078e77de0bd2a626708973b8082ac&amp;do=bbcode#imgcode" target="_blank">IMG 代码</a></p>
<p>已 [禁用] HTML 代码 [论坛跳转…]
用户控制面板 悄悄话 收藏夹 会员在线状态 搜索论坛 论坛首页    Linux 综合讨论区 —— LinuxSir.Org     Linux 基础建设讨论专版     Linux shell进阶应用与shell编程     Linux 专业英文精品技术文档专题         Gas中文小组讨论区     Linux 硬件及周边设备     Linux 网络与服务器架设     Linux 系统及网络安全讨论专版     Linux及计算机学科基础理论版  Linux 发行版讨论区 —— LinuxSir.Org     Linux 发行版SuSE专题     Linux 发行版Archlinux讨论区     Linux 发行版Debian专题     Ubuntu Linux 专题讨论     Linux 发行版Slackware专题     Linux 发行版 LFS 讨论区         Olive讨论区 （实验版）     Linux 发行版Mandriva专题     Linux 发行版Redhat/Fedora/CentOS专题     Linux 发行版Gentoo讨论区     Mini Linux 及准系统研究     Linux 发行版红旗专题     LoongSon-龙芯讨论区     Linux 发行版其他专题         Linux发行版 Turbolinux专题         PowerPC Linux 讨论区  Google 产品讨论区 —— LinuxSir.Org     Android  Linux 软件应用讨论区 —— LinuxSir.Org     Linux 输入开发与研究     Linux 软件专题讨论         软件下载讨论区         即时通讯  Linux 高级应用讨论区 —— LinuxSir.Org     Linux 数据库专题讨论     Linux 认证考试学习与经验交流     Linux 内核研究小组     Linux 企业级应用专题讨论  编程开发讨论区 —— LinuxSir.Org     Linux 程序设计专题讨论     Java 程序设计开发讨论     Perl | PHP | Python 脚本程序开发     嵌入式Linux讨论区──实验田版  Unix 技术讨论区 —— LinuxSir.Org     BSD 讨论专题         BSD 新闻安全观察         RelaxBSD 讨论区     Solaris 讨论专题     MacOSX &amp; Darwin 讨论专题  社区中心 —— LinuxSir.Org     LinuxSir 论坛管理         LinuxSir 论坛临时存放区     LinuxSir 文章管理系统和BBS程序研究小组     小企鹅新闻图书馆     LinuxSir.Org 同城行 ── 我的城市
所有时间均为[北京时间]。现在的时间是 21:28。
<strong><a href="http://www.linuxsir.org/" target="_blank">网站首页</a> - <a href="mailto:kevin@linuxsir.org">联系我们</a> - <a href="http://www.linuxsir.org/bbs/showthread.php?t=236915#top" target="_blank">返回顶端</a></strong>
Powered by vBulletin 版本 3.6.8
版权所有 ©2000 - 2012, Jelsoft Enterprises Ltd.
官方中文技术支持: <a href="http://www.vbulletin-china.cn/" target="_blank">vBulletin 中文</a></p>
<p>版权所有 ©2002 - 2011, LinuxSir.Org</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/服务器/">服务器</a></li></span><span class="breadcrumb"><li><a href="/categories/服务器/">服务器</a></li><li><a href="/categories/服务器/集群/">集群</a></li></span></span> | <span class="tags">Tagged <a href="/tags/服务器/" class="label label-primary">服务器</a><a href="/tags/集群/" class="label label-success">集群</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:44"datetime="2014-03-07 09:54:44"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-服务器-集群--Linux下Apache与Tomcat整合的简单方法-LinuxSirOrg/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-服务器-集群--Linux下Apache与Tomcat整合的简单方法-LinuxSirOrg" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-服务器-集群--LINUX下使用apachetomcat构建WEB集群系统/">最新分享_分享_百度空间</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:44.000Z"> <a href="/2014/02/02/2014-02-02-服务器-集群--LINUX下使用apachetomcat构建WEB集群系统/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-_-_-">最新分享<em>分享</em>百度空间</h1>
<p><a href="http://hi.baidu.com/index.htm" target="_blank"><img src="" alt="百度空间Logo"></a></p>
<ul>
<li><p><a href="http://apps.hi.baidu.com/" target="_blank">应用</a>
<a href="http://hi.baidu.com/reg/new" target="_blank">注册</a>用户名:   密码:</p>
</li>
<li><p><a href="http://apps.hi.baidu.com/hoho" target="_blank">HOHO</a></p>
</li>
<li><a href="http://apps.hi.baidu.com/share" target="_blank">分享</a></li>
<li><a href="http://apps.hi.baidu.com/vote" target="_blank">投票</a></li>
<li><a href="http://apps.hi.baidu.com/test" target="_blank">测试</a></li>
<li><a href="http://apps.hi.baidu.com/gift" target="_blank">礼物</a></li>
</ul>
<h3 id="-http-hi-baidu-com-ihome-square-"><a href="http://hi.baidu.com//ihome/square" target="_blank">交友中心</a></h3>
<ul>
<li><a href="http://apps.hi.baidu.com/dashan" target="_blank">搭讪</a></li>
<li><a href="http://apps.hi.baidu.com/duiwei" target="_blank">对味测试</a></li>
<li><a href="http://apps.hi.baidu.com/suliao" target="_blank">闪电速聊</a></li>
<li><p><a href="http://hi.baidu.com//ihome/square" target="_blank">找朋友</a></p>
<h3 id="-http-apps-hi-baidu-com-apps-"><a href="http://apps.hi.baidu.com/apps" target="_blank">应用大厅</a></h3>
</li>
<li><p><a href="http://apps.hi.baidu.com/kaixinbuluo" target="_blank">开心部落</a></p>
</li>
<li><a href="http://apps.hi.baidu.com/rongcar" target="_blank">汽车工厂</a></li>
<li><p><a href="http://apps.hi.baidu.com/paopaoyu" target="_blank">泡泡鱼</a></p>
</li>
<li><p><a href="http://youxi.baidu.com/prom.xhtml?code=G-%D7%8E%81%B2%29%FF%8AR%BC%8B%EE%85%1C%E5" target="_blank">网页游戏</a></p>
</li>
</ul>
<h2 id="-">分享</h2>
<ul>
<li><a href="http://apps.hi.baidu.com/share/" target="_blank">热门分享</a></li>
<li><a href="http://apps.hi.baidu.com/share/latest/?type=video" target="_blank">最新分享</a></li>
<li><a href="http://apps.hi.baidu.com/share/detail/14955683#" target="_blank">好友的分享</a></li>
<li><a href="http://apps.hi.baidu.com/share/detail/14955683#" target="_blank">我的分享</a>
<a href="http://apps.hi.baidu.com/share/detail/14955683#" target="_blank">如何分享?</a> <a href="http://tieba.baidu.com/f?kw=%B0%D9%B6%C8%BF%D5%BC%E4" target="_blank">问题反馈</a></li>
</ul>
<p><a href=""></a></p>
<p><a href="http://hi.baidu.com/sys/checkuser/lpwok/3" target="_blank"><img src="" alt=""></a></p>
<p>   <a href="http://apps.hi.baidu.com/share/user/68db6c70776f6bd905" target="_blank">lpwok的分享</a></p>
<p>分享</p>
<p><a href="http://apps.hi.baidu.com/share/detail/14959808#content" target="_blank"></a>  <a href="http://apps.hi.baidu.com/share/detail/14797932#content"></a>
LINUX下使用apache+tomcat构建WEB集群系统</p>
<p><strong>一、集群的基本知识</strong>
        集群技术是目前非 常流行的提高系统服务能力与高可靠性（ HA- High Availability ）的手段，通过把多个独立的服务器组成一个集群可以实现失效无缝转移。也就是说当有某一台集群中的服务器当机后，其上的用户状态数据可以无缝迁移到集群中 的其他服务器上。这样，正在使用应用的客户可以完全感觉不到影响，大大提供了系统的可靠性。</p>
<p>集群有很多种类和层次，例如：操作系统集群（如 Linux 、 Solaris 等），数据库集群（如 DB2 、 Oracle 等），应用服务器集群（如 GlassFish 、 WebLogic 等） ,Web 集群（如 Tomcat 等）。本教程将向读者介绍由 Tomcat 搭建的 Web 集群。</p>
<p>不管是由什么技术搭建的集群，其基本组成由下图所示：
<img src="" alt="">
图 1-1</p>
<p>从图中可以看出，每个集群都需要一个负载均衡器，其负责根据一定的算法将外界发送到集群的请求尽量均匀地分配到集群中的每个服务器，使得集群中所有 服务器的负载尽量平衡。对外界的客户端而言其并不知道具体访问了集群中的哪台服务器，多台服务器从逻辑上对外界而言可以看作一台&quot;大&quot;服务器。这样，当集 群的服务能力不能满足当前的需要时，可以非常方便地再向集群中添加新的服务器来满足需要。可以看出，使用了集群之后，系统具有非常好的可扩展性。</p>
<p>当不幸集群中有某台服务器突然当机时，其用户状态数据可以迁移到其他服务器上，不影响在线用户的使用。这样，通过使用集群技术可以方便地实现系统的高可靠性。</p>
<p>本教程中将介绍的使用 Tomcat 搭建的 Web 集群结构如图 1-2 所示：</p>
<p><img src="" alt="">
图 1-2</p>
<p>从图中可以看出集群的负载均衡器由开源的 Apache 服务器担任，集群中的 Web 服务器由两个 Tomcat 服务器分别担任，后台的数据库服务器由一个 MySQL 服务器担任。</p>
<p>提示：本教程中介绍的是 Web 集群，因此数据库服务器只有一个，并没有搭建集群。在需要的情况下，多台数据库服务器也可以组成集群以提高服务能力与可靠性。</p>
<p><strong>二、安装JDK</strong></p>
<p><strong>三、安装TOMCAT</strong></p>
<ol>
<li>下载tomcat，可以通过下面的命令下载：</li>
</ol>
<p>/#wget <a href="http://apache.mirror.phpchina.com/tomcat/tomcat-6/v6.0.18/bin/apache-tomcat-6.0.18.tar.gz" target="_blank">http://apache.mirror.phpchina.com/tomcat/tomcat-6/v6.0.18/bin/apache-tomcat-6.0.18.tar.gz</a></p>
<ol>
<li>解压启动测试：</li>
</ol>
<p>/#tar -zxvf apache-tomcat-6.0.18.tar.gz
/#./apache-tomcat-6.0.18/bin/startup.sh</p>
<p>在浏览器中输入：<a href=""><a href="http://localhost:8080">http://localhost:8080</a></a>,看是否启动正常，若正常进行第三步。</p>
<ol>
<li>下面通过一个简单的&quot; Test.jsp &quot;程序进一步验证 Tomcat 是否安装成功，新建名称为&quot; Test.jsp &quot;的 Jsp 源文件并在其中输入如下代码。</li>
</ol>
<p>&lt;%@ page contentType=&quot;text/html;charset=GBK&quot;%&gt;</p>
<p><html></p>
<p><head></p>
<p><title> Tomcat<em> </em>测试 </title>
</head></p>
<p><body></p>
<p><font color = "red" size = "20" >
&lt;% out.print( &quot;<em> </em>恭喜您，成功的安装并启动了 Tomcat<em> </em>！！！ &quot; ); %&gt;
</font>
</body>
</html></p>
<ol>
<li>重启（命令如下），然后输入：<a href=""><a href="http://localhost:8080/Test.jsp">http://localhost:8080/Test.jsp</a></a> 看是否正常。</li>
</ol>
<p>/#./apache-tomcat-6.0.18/bin/shutdown.sh
/#./apache-tomcat-6.0.18/bin/startup.sh</p>
<p><strong>四：TOMCAT集群的搭建</strong></p>
<ol>
<li>安装两个或以上tomcat</li>
</ol>
<p>/#./apache-tomcat-6.0.18/bin/shutdown.sh
/#mv apache-tomcat-6.0.18 /usr/local/TC6_A
/#cd /usr/local
/#cp -a TC6_A TC6_B</p>
<p>提示：进行上述步骤操作的原因是，本案例中集群的各个 Tomcat 服务器实例运行在同一个物理服务器上，因此集群中有几个 Tomcat 实例一般就需要几个 Tomcat 的安装。另外，由于集群中的各个 Tomcat 实例位于同一个物理服务器上的一个操作系统下，因此各个实例占用的各种网络端口不能相同，否则集群中的多个 Tomcat 实例不能同时正常启动，下面的步骤将介绍如何修改 Tomcat 实例需要使用的各个网络端口。</p>
<ol>
<li>修改 Tomcat 实例需要使用的各个网络端口</li>
</ol>
<ul>
<li>找到 server.xml 配置文件中的&quot; Server &quot;配置项目，并进行修改。
<Server port="8005" shutdown="SHUTDOWN">
<Server port="10005" shutdown="SHUTDOWN"><Server port="20005" shutdown="SHUTDOWN">

</li>
</ul>
<p>说明：第一行为两个 Tomcat 修改前的情况，第二行为 TC6_A Tomcat 修改后的情况，第三行为 TC6_B Tomcat 修改后的情况。</p>
<ul>
<li><p>找到 server.xml 配置文件中的相应&quot; Connector &quot;配置项目，并进行修改。</p>
</li>
<li><p>修改前内容如下：</p>
</li>
</ul>
<p><!-- Define an AJP 1.3 Connector on port 8009 --></p>
<p><Connector port = "8009" protocol = "AJP/1.3" redirectPort = "8443" /></p>
<ul>
<li>TC6_A 中修改后内容如下：</li>
</ul>
<p><!-- Define an AJP 1.3 Connector on port 8009 --></p>
<p><Connector port = " 10009 " protocol = "AJP/1.3" redirectPort = " 10043 " /></p>
<ul>
<li>TC6_B 中修改后内容如下：</li>
</ul>
<p><!-- Define an AJP 1.3 Connector on port 8009 --></p>
<Connector port = " 20009 " protocol = "AJP/1.3" redirectPort = " 20043 " />

<p>提示：此步骤目的是修改 AJP Connector 端口。</p>
<ul>
<li><p>找到 server.xml 配置文件中的另一个相应&quot; Connector &quot;配置项目，并进行修改。</p>
</li>
<li><p>修改前内容如下：</p>
</li>
</ul>
<p><Connector port = "8080" protocol = "HTTP/1.1" connectionTimeout = "20000"
redirectPort = "8443" /></p>
<ul>
<li>TC6_A 中修改后内容如下：</li>
</ul>
<p><Connector port = "10001" protocol = "HTTP/1.1" connectionTimeout = "20000"
redirectPort = "10043" /></p>
<ul>
<li>TC6_B 中修改后内容如下：</li>
</ul>
<Connector port = "20001" protocol = "HTTP/1.1" connectionTimeout = "20000"
redirectPort = "20043" />

<p>提示：此步骤目的是修改 HTTP Connector 端口，其中的&quot; 10001 &quot;与&quot; 20001 &quot;是未来通过浏览器访问集群中各个 Tomcat 实例的 HTTP 端口。</p>
<ul>
<li><p>通过修改 Engine 配置选项，配置集群中每个 Tomcat 实例的名称。</p>
</li>
<li><p>修改前内容如下：</p>
</li>
</ul>
<p>&lt;!-- You should set jvmRoute to support load-balancing via AJP ie :</p>
<p><Engine name = "Standalone" defaultHost = "localhost" jvmRoute = "jvm1"></p>
<p><Engine name = "Catalina" defaultHost = "localhost">
--&gt;</p>
<ul>
<li>TC6_A 中修改后内容如下：</li>
</ul>
<p><Engine name = "Standalone" defaultHost = "localhost" jvmRoute = " Tomcat1"></p>
<ul>
<li>TC6_B 中修改后内容如下：</li>
</ul>
<Engine name = "Standalone" defaultHost = "localhost" jvmRoute = " Tomcat2">

<p>提示：请读者注意在修改过程中要注释掉原来 name 为 Catalina 的 Engine 配置项目，将 name 为 Standalone 的 Engine 配置项目的注释去掉并修改 jvmRoute 属性。</p>
<ul>
<li><p>修改配置文件中的 Cluster 配置项目，对集群的各项参数进行设置。</p>
</li>
<li><p>修改前内容如下：</p>
</li>
</ul>
<Cluster className="org.apache.catalina.ha.tcp.SimpleTcpCluster" />
<em> TC6_A 中修改后内容如下：

<Cluster className = "org.apache.catalina.ha.tcp.SimpleTcpCluster" channelSendOptions = "8">
<Manager className = "org.apache.catalina.ha.session.DeltaManager"
expireSessionsOnShutdown = "false"
notifyListenersOnReplication = "true" />
<Channel className = "org.apache.catalina.tribes.group.GroupChannel" >
<Membership className = "org.apache.catalina.tribes.membership.McastService"
address = "228.0.0.4"
port = "45564"
frequency = "500"
dropTime = "3000"/>
<Receiver className = "org.apache.catalina.tribes.transport.nio.NioReceiver"
address = "auto"
port = "4000"
autoBind = "100"
selectorTimeout = "5000"
maxThreads = "6" />
<Sender className = "org.apache.catalina.tribes.transport.ReplicationTransmitter" >
<Transport className = "org.apache.catalina.tribes.transport.nio.PooledParallelSender" />
</Sender>
<Interceptor
className = "org.apache.catalina.tribes.group.interceptors.TcpFailureDetector" />
<Interceptor className="org.apache.catalina.tribes.group.interceptors.MessageDispatch15Interceptor" />
</Channel>
<Valve className = "org.apache.catalina.ha.tcp.ReplicationValve" filter="" />
<Valve className = "org.apache.catalina.ha.session.JvmRouteBinderValve" />
<Deployer className = "org.apache.catalina.ha.deploy.FarmWarDeployer"
tempDir = "/tmp/war-temp/"
deployDir = "/tmp/war-deploy/"
watchDir = "/tmp/war-listen/"
watchEnabled = "false"/>
<ClusterListener className = "org.apache.catalina.ha.session.JvmRouteSessionIDBinderListener" />
<ClusterListener className = "org.apache.catalina.ha.session.ClusterSessionListener" />
</Cluster>
</em> TC6_B 中修改后内容如下：

<Cluster
className = "org.apache.catalina.ha.tcp.SimpleTcpCluster"
channelSendOptions = "8"
>
<Manager className = "org.apache.catalina.ha.session.DeltaManager"
expireSessionsOnShutdown = "false"
notifyListenersOnReplication = "true" />
<Channel className = "org.apache.catalina.tribes.group.GroupChannel">
<Membership className = "org.apache.catalina.tribes.membership.McastService"
address = "228.0.0.4"
port = "45564"
frequency = "500"
dropTime = "3000" />
<Receiver className = "org.apache.catalina.tribes.transport.nio.NioReceiver"
address = "auto"
port = "4000"
autoBind = "100"
selectorTimeout = "5000"
maxThreads = "6" />
<Sender className = "org.apache.catalina.tribes.transport.ReplicationTransmitter">
<Transport className = "org.apache.catalina.tribes.transport.nio.PooledParallelSender" />
</Sender>
<Interceptor className = "org.apache.catalina.tribes.group.interceptors.TcpFailureDetector" />
<Interceptor className="org.apache.catalina.tribes.group.interceptors.MessageDispatch15Interceptor" />
</Channel>
<Valve className = "org.apache.catalina.ha.tcp.ReplicationValve"
filter = ""/>
<Valve className = "org.apache.catalina.ha.session.JvmRouteBinderValve" />
<Deployer className = "org.apache.catalina.ha.deploy.FarmWarDeployer"
tempDir = "/tmp/war-temp/"
deployDir = "/tmp/war-deploy/"
watchDir = "/tmp/war-listen/"
watchEnabled = "false" />
<ClusterListener className = "org.apache.catalina.ha.session.JvmRouteSessionIDBinderListener" />
<ClusterListener className = "org.apache.catalina.ha.session.ClusterSessionListener" />
</Cluster>

<p>提示：上述配置内容主要是对集群中各个 Tomcat 实例间进行通信的方式、端口以及 Session 共享算法的设置。本教程由于篇幅所限，不能一一详细介绍，有兴趣的读者可以参看 Tomcat 的官方文档，其中有非常详细的说明。</p>
<p>3、测试搭建，分别启动两个tomcat，看是否正常，若正常进行第四步。
<a href=""><a href="http://localhost:10001">http://localhost:10001</a></a>
<a href=""><a href="http://localhost:20001">http://localhost:20001</a></a></p>
<p>4、简单的 JSP 来进一步测试对&quot; TC6_A &quot;和&quot; TC6_B &quot;的设置是否成功,分别建立两个文件：Hello.jsp。
&lt;%@ page contentType=&quot;text/html;charset=GBK&quot;%&gt;</p>
<p><html></p>
<p><head></p>
<p><title>Tomcat 测试 </title>
</head></p>
<p><body></p>
<p><font color="red" size="20">
&lt;!— 使用 out 内建对象打印一条消息到输出页面 --&gt;
&lt;% out.print( &quot;Tomcat 集群测试 A ！！！ &quot; ); %&gt;
</font>
</body>
</html>
TC6_B的改一行输出：
&lt;% out.print( &quot;Tomcat 集群测试 B ！！！ &quot; ); %&gt;</p>
<p>如果能顺利地在浏览器中见到上述两个页面，则说明集群中的两个 Tomcat 实例工作完全正常。下面就可以为集群安装、设置 Apache 负载均衡器了。</p>
<p><strong>五、Apache负载均衡器的安装与配置</strong></p>
<ol>
<li>下载安装</li>
</ol>
<p>/# wget <a href="http://www.apache.org/dist/httpd/httpd-2.2.9.tar.gz" target="_blank">http://www.apache.org/dist/httpd/httpd-2.2.9.tar.gz</a>
/# tar -zxvf httpd-2.2.9.tar.gz
/# cd httpd-2.2.9
/# ./configure --prefix=/usr/local/httpd --enable-mods-shared=&#39;proxy proxy_ajp proxy_balancer&#39;
/# make
/# make install</p>
<ol>
<li>配置Apache 为 Tomcat 集群的负载均衡器</li>
</ol>
<p>ProxyRequests Off
ProxyPass / balancer://myCluster/</p>
<Proxy balancer://myCluster/>
BalancerMember ajp://localhost:10009 route=Tomcat1
BalancerMember ajp://localhost:20009 route=Tomcat2
</Proxy>

<p>说明：其中&quot; myCluster &quot;是集群的名称，&quot; ajp://localhost:10009 route=Tomcat1 &quot; 对应 Tomcat 集群中的 TC6_A 实例，&quot; ajp://localhost:20009 route=Tomcat2 &quot; 对应 Tomcat 集群中的 TC6_B 实例。经过上述配置后， Apache 就可以成为前面搭建的 Tomcat 集群的负载均衡器了。</p>
<p><strong>六、感受成果</strong></p>
<ol>
<li>重启apache httpd后，访问：<a href=""><a href="http://localhost/Hello.jsp">http://localhost/Hello.jsp</a></a>。</li>
<li><p>由 于 Apache 作为 Tomcat 集群的负载均衡器，使用的是轮换算法，其均匀地将请求发送到集群中的各个 Tomcat 实例。因此，从1的测试中可以看出，是轮换访问两个不同 Tomcat 实例中的 Hello.jsp 页面的。当然，看到轮换的情况也就说明 Apache 负载均衡器正常工作了。
<strong>七、补充重要细节</strong></p>
<p> 1、在应用时候，工程的web.xml里面要加上这么一个属性，实现Session共享：
……<em><distributable/></em></p>
</li>
</ol>
<p><em></web-app>
</em></p>
<pre><code>文件中的“ *&lt;distributable/&gt;*”项，是由于本案例将部署到集群中的多个服务器上。如果在配置文件中没 有此项，则应用在集群中不能实现分布式 Session 共享，也就是说当机后用户状态数据（存放在 Session 中的）无法无缝迁移到 Tomcat 集群中的其他服务器上。此项非常重要，请读者多加留心。

然后在依次启动TC6_A,TC6_B,你会在TC6_A的日志里面看到他们的通信日志，不然就是没有成功。

2、Tomcat6 集群要求负载均衡器工作在“ sticky session ”模式下，否则集群可能工作不正常。
</code></pre><p>对“ <strong><em>ProxyPass</em></strong>”项目进行如下修改。</p>
<ul>
<li>修改前</li>
</ul>
<p><strong><em>ProxyPass / balancer://myCluster/</em></strong></p>
<ul>
<li>修改后</li>
</ul>
<p><strong><em>ProxyPass / balancer://myCluster/ lbmethod=byrequests stickysession=JSESSIONID nofailover=Off</em></strong></p>
<p>提示： 修改后添加的“ stickysession=JSESSIONID ”项就是让 Apache 负载均衡器工作在“ sticky session ”模式下。所谓“ sticky session ”模式就是对于使用到同一个 Session 的请求绑定到集群中的特定服务器上，而不是轮换访问各个服务器，这样 Session 就不会工作不正常了。当然，对于使用不同 Session 的请求，还是进行负载均衡轮换的。</p>
<p>本文参照：<a href="http://www.unix-center.net" target="_blank">http://www.unix-center.net</a>
为了您的安全，请只打开来源可靠的网址</p>
<p><a href="http://hi.baidu.com/iammonster/blog/item/84710cdbb1b9f660d1164e60.html" target="_blank">打开网站</a>    <a href="http://apps.hi.baidu.com/share/detail/14955683#" target="_blank">取消</a></p>
<p> 来自: <a href="http://hi.baidu.com/iammonster/blog/item/84710cdbb1b9f660d1164e60.html" target="_blank"><a href="http://hi.baidu.com/iammonster/blog/item/84710cdbb1b9f660d1164e60.html">http://hi.baidu.com/iammonster/blog/item/84710cdbb1b9f660d1164e60.html</a></a></p>
<p><a href=""></a></p>
<p><a href="http://apps.hi.baidu.com/share/detail/14959808#content" target="_blank"></a>  <a href="http://apps.hi.baidu.com/share/detail/14797932#content"></a>
来自: <a href="http://hi.baidu.com/sys/checkuser/iammonster007/3" target="_blank"><img src="" alt=""></a> <a href="http://hi.baidu.com/sys/checkuser/iammonster007/3" target="_blank">iammonster007</a> 第一分享: <a href="http://hi.baidu.com/sys/checkuser/lpwok/3" target="_blank"><img src="" alt=""></a> <a href="http://hi.baidu.com/sys/checkuser/lpwok/3" target="_blank">lpwok</a>  时间: 2010-07-20 16:58 评论: 1条 投票: 1次 本贴分享: 5 累计分享: 6</p>
<h3 id="-1-">共有1人发表观点</h3>
<ul>
<li><p>色妹Q:2372819618
...或者输入其他标签词：
lpwok的 博客 相关分享:</p>
</li>
<li><p><a href="http://apps.hi.baidu.com/share/detail/6723926" title="经典智力挑战游戏——【密室逃脱】全集！！！" target="_blank">经典智力挑战游戏——【密室逃脱】全集！！...</a></p>
</li>
<li><a href="http://apps.hi.baidu.com/share/detail/2863700" title="Ubuntu Linux下Apache的配置文件" target="_blank">Ubuntu Linux下Apache的配置文件</a></li>
<li><a href="http://apps.hi.baidu.com/share/detail/2863689" title="ubuntu中tar.gz/tar.bz2/rar等压缩包软件安装教程" target="_blank">ubuntu中tar.gz/tar.bz2/rar等压缩包软件安...</a></li>
<li><a href="http://apps.hi.baidu.com/share/detail/2327312" title="SEO工具大集合" target="_blank">SEO工具大集合</a></li>
</ul>
<h3 id="-1-">评论(1)</h3>
<p><a href="http://hi.baidu.com/sys/checkuser/784633420/3" target="_blank"><img src="" alt=""></a></p>
<p>2011年12月21日 16:48 <a href="http://hi.baidu.com/sys/checkuser/784633420/3" target="_blank">784633420</a></p>
<p>非常准确</p>
<p><a href="http://help.baidu.com/question?prod_en=space" target="_blank">帮助中心</a> | <a href="http://tieba.baidu.com/f?kw=%B0%D9%B6%C8%BF%D5%BC%E4&amp;fr=wwwt" target="_blank">空间客服</a> | <a href="http://tousu.baidu.com/hi/add" target="_blank">投诉中心</a> | <a href="http://www.baidu.com/search/hi_contract.html" target="_blank">空间协议</a></p>
<p>©2012 Baidu</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/服务器/">服务器</a></li></span><span class="breadcrumb"><li><a href="/categories/服务器/">服务器</a></li><li><a href="/categories/服务器/集群/">集群</a></li></span></span> | <span class="tags">Tagged <a href="/tags/服务器/" class="label label-primary">服务器</a><a href="/tags/集群/" class="label label-success">集群</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:44"datetime="2014-03-07 09:54:44"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-服务器-集群--LINUX下使用apachetomcat构建WEB集群系统/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-服务器-集群--LINUX下使用apachetomcat构建WEB集群系统" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-Nutz--Nutz的数据库事务/">Nutz的 数据库事务</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:44.000Z"> <a href="/2014/02/02/2014-02-02-Nutz--Nutz的数据库事务/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="nutz-">Nutz的 数据库事务</h1>
<p>1.数据库事务
 数据库的事务是作为单个逻辑工作单元执行的一系列操作。一个逻辑工作单元必须有四个属性，称为原子性、一致性、隔离性和持久性 (ACID) 属性，只有这样才能成为一个事务。一般来讲，隔离性是通过锁机制来实现，而其他三个特性通过日志机制实现。
 当一个数据库的某些数据由多个客户端并发访问操作的时候，可能会出现一系列的问题：(1)脏读(dirty read),(2)不可重复读(unrepeatable read),(3)幻象读(phantom read),(4)丢失更新</p>
<p>2.使用Nutz来处理事务
 在nutz中使用一个类org.nutz.trans.Trans来处理事务，使用方式如下：
Java代码  <a href="&quot;收藏这段代码&quot;"><img src="" alt="收藏代码"></a></p>
<ol>
<li>//TODO 选择事务级别   </li>
<li>int level=Connection.TRANSACTION_SERIALIZABLE;  </li>
<li>Trans.exec(level, new Atom(){  </li>
<li>@Override  </li>
<li>public void run() {  </li>
<li>//TODO 事务内的操作逻辑  </li>
<li>}     </li>
<li>});  </li>
</ol>
<p>  当然你也可是使用如下默认方式：</p>
<p>Java代码  <a href="&quot;收藏这段代码&quot;"><img src="" alt="收藏代码"></a></p>
<ol>
<li>Trans.exec(new Atom(){  </li>
<li>@Override  </li>
<li>public void run() {  </li>
<li>//TODO   </li>
<li>}  </li>
<li><p>});  </p>
<p>在这种情况下，level默认是Connection.TRANSACTION_READ_COMMITTED
注：如果你使用jdbc来直接操作事务，当然你可以在某一个位置设置保存点，如果事务失败，可以回滚到那个点，在nutz中整个事务要么成功，要么失败，全部回滚。如果你希望使用savepoint改怎么办呢，你可以这么用：</p>
</li>
</ol>
<p>Java代码  <a href="&quot;收藏这段代码&quot;"><img src="" alt="收藏代码"></a></p>
<ol>
<li>Dao dao=null;  </li>
<li>dao.run(new ConnCallback(){  </li>
<li>@Override  </li>
<li>public void invoke(Connection conn) throws Exception {  </li>
<li>// TODO 在这里面使用Connection来操作     </li>
<li>}     </li>
<li>});  </li>
</ol>
<p>3.ThreadLocal
 Nutz在实现Trans这个类的时候用到了ThreadLcoal（方便了使用者存储变量到当前线程。）,用来存储用户的每一次事务动作。具体实现请参见源代码类org.nutz.trans.Trans。 </p>
<p>来源： <a href="[http://amosleaf.iteye.com/blog/548337](http://amosleaf.iteye.com/blog/548337)">[http://amosleaf.iteye.com/blog/548337](http://amosleaf.iteye.com/blog/548337)</a></p>
<p>4、事务的嵌套</p>
<h2 id="-">设置事务的级别</h2>
<p>在 JDBC 的 java.sql.Connection 接口中定义的 setTransactionIsolation 函数可以设置事务的级别Nutz.Dao 也提供另外一个静态函数，允许你设置事务的级别:</p>
<p><strong>Trans.exec 的函数声明</strong>
public static void exec(int level, Atom... atoms);</p>
<p>这里的第一个参数 level 和 java.sql.Connection 接口中的 setTransactionIsolation 规定的 level 是一样的。下面是在 java.sql.Connection 里面关于 level 参数的 JDoc 说明：</p>
<p>它可以是下列常量中的任意一个值：</p>
<ul>
<li>Connection.TRANSACTION_READ_UNCOMMITTED</li>
<li>Connection.TRANSACTION_READ_COMMITTED</li>
<li>Connection.TRANSACTION_REPEATABLE_READ</li>
<li>Connection.TRANSACTION_SERIALIZABLE</li>
</ul>
<p><strong>注意： </strong>不能使用常量 Connection.TRANSACTION_NONE，因为它的意思是“不支持事务”</p>
<p>关于 level 参数的更多说明，请参看<a href="http://java.sun.com/javase/6/docs/api/java/sql/Connection.html#setTransactionIsolation(int" target="_blank">java.sql.Connection 的文档</a>)</p>
<p>不同的数据库，对于 JDBC 事务级别的规范，支持的力度不同。请参看相应数据库的文档，已 确定你设置的数据库事务级别是否被支持。</p>
<p><a href="http://code.google.com/p/nutz/wiki/dao_transaction#Top" target="_blank">/#Top</a></p>
<h2 id="-"><a href=""></a>事务的嵌套</h2>
<p>Nutz 的事务模板可以嵌套吗？ 答案是肯定的。事实上，Nutz 支持事务模板的无限层级嵌套。</p>
<p>这里，如果每一层嵌套，指定的事务级别有所不同，不同的数据库，可能引发不可预知的错误。所以，嵌套的事务模板的事务，将以最顶层的事务为级别为标准。就是说，如果最顶层的事务级别为 &#39;TRANSACTION_READ_COMMITTED&#39;，那么下面所包含的所有事务，无论你指定什么样的事务级别，都是 &#39;TRANSACTION_READ_COMMITTED&#39;， 这一点，由抽象类 Transaction 来保证。其 setLevel 当被设置了一个大于 0 的整数以后，将不再 接受任何其他的值。</p>
<p>你可以通过继承 Transaction 来修改这个默认的行为，当然，这个行为修改一般是没有必要的。</p>
<p>另外，你还可能需要知道，通过 Trans.setup 方法，能让整个虚拟机的 Nutz 事务操作都使用你的 Transaction 实现</p>
<p>下面我给出两个例子:</p>
<p><strong>最外层模板决定了整个事务的级别:</strong>
Trans.exec(Connection.TRANSACTION_READ_COMMITTED, new Atom(){
        public void run(){
                dao.update(xxx);
                dao.update(bbb);
                // 在下层模板，虽然你指定了新的事务级别，但是这里的事务级别还是
                // &#39;TRANSACTION_READ_COMMITTED&#39;。在一个事务中，级别一旦设定就不可更改
                Trans.exec(Connection.TRANSACTION_SERIALIZABLE, new Atom(){
                        public void run(){
                                dao.update(CCC);
                                dao.update(EEE);
                        }
                });
        }
});</p>
<p><strong>让整个函数都是事务的:</strong></p>
<p>public void updatePet(final Pet pet){
        Trans.exec(new Atom(){
                public void run(){
                        dao.update(pet);
                        dao.update(pet.getMaster());
                }
        });
}
// 在另外一个函数里，可以这么使用
public void updateDogAndCat(final Pet dog, final Pet cat){
        Trans.exec(new Atom(){
                public void run(){
                        updatePet(dog);
                        updatePet(cat);
                }
        });
}</p>
<p>来源： <a href="[http://code.google.com/p/nutz/wiki/dao_transaction](http://code.google.com/p/nutz/wiki/dao_transaction)">[http://code.google.com/p/nutz/wiki/dao_transaction](http://code.google.com/p/nutz/wiki/dao_transaction)</a>
以上需要注意的几个细节,文档还没提及: <strong>1. 数据库连接池的AutoCommit属性</strong> 对于我见到的大部分连接池和数据库驱动,默认情况下AutoCommit=true,应该是为了性能 这就导致如果用户不自行设置的话,Trans的大部分操作都是不可回滚的.故,如果使用Trans,那么务必设置AutoCommit</p>
<p><strong>2. 多个数据源的事务</strong> 大部分情况下,用户都不是使用XA驱动,故,多数据源的事务提交,在最后的提交阶段出错的话,已经执行commit操作的数据源,是不可能回滚的</p>
<p><strong>3. 子线程的事务</strong> 考虑下面的代码:
Trans.exec(new Atom(){   public void run() {       dao.insert(pet);       new MySuperPowerThread().start();       dao.count(Pet.class);   }});</p>
<p>那么MySuperPowerThread的代码并不是在事务模板中执行的,因为这里的事务不会被子线程继承</p>
<p><strong>4. 返回值问题(更新了)</strong> 使用Molecule
Molecule<object> mc = new Molecule<object>() {    public void run() {        dao.insert(pet);        setObj(dao.count(Pet.class));    }};Trans.exec(mc);System.out.println(mc.getObj());</p>
<p>来源： <a href="[http://wendal.net/324.html](http://wendal.net/324.html)">[http://wendal.net/324.html](http://wendal.net/324.html)</a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/Nutz/">Nutz</a></li></span></span> | <span class="tags">Tagged <a href="/tags/Nutz/" class="label label-primary">Nutz</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:44"datetime="2014-03-07 09:54:44"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-Nutz--Nutz的数据库事务/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-Nutz--Nutz的数据库事务" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-TCPIP--HTTPS是如何保证连接安全：每位Web开发者都应知道的-博客-伯乐在线/">HTTPS是如何保证连接安全：每位Web开发者都应知道的 </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:44.000Z"> <a href="/2014/02/02/2014-02-02-TCPIP--HTTPS是如何保证连接安全：每位Web开发者都应知道的-博客-伯乐在线/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="https-web-">HTTPS是如何保证连接安全：每位Web开发者都应知道的 - 博客 - 伯乐在线</h1>
<p><strong>本文由 <a href="http://blog.jobbole.com/" target="_blank">伯乐在线</a> - <a href="http://blog.jobbole.com/author/jobbole/" target="_blank">伯乐在线读者</a> 翻译自 <a href="http://blog.hartleybrody.com/https-certificates/" target="_blank">hartley brody</a>。转载请参见文章末尾处的要求。</strong></p>
<p>【感谢<a href="http://weibo.com/aimujie0" target="_blank">@埃姆杰</a> 的热心翻译。如果其他朋友也有不错的原创或译文，可以尝试<a href="http://blog.jobbole.com/tougao/" target="_blank">推荐给伯乐在线</a>。】</p>
<p>“HTTPS协议的工作原理是什么？”这是我在数天前工作项目中需要解决的问题。</p>
<p>作为一名Web开发者，我当然知道 HTTPS 协议是保障用户敏感数据的好办法，但并不知道这种协议的内在工作机制。</p>
<p>它怎么保护数据？有人监听线路的情况下，服务器与客户端之间如何建立安全的连接？安全证书又是什么，为什么还要花钱买呢？</p>
<p><strong>一系列通道</strong></p>
<p>在深入讲解原理细节之前，让我们首先简单了解下HTTPS所防范的的问题，以及安全连接为何如此重要吧。</p>
<p>在你访问自己喜欢的站点时，从你的电脑发送的请求会在各个不同的网络之间传递——这些网络很有可能是用来偷听，甚至篡改你的信息。</p>
<p><img src="" alt=""></p>
<p>局域网中，信息从你的电脑传输到其他电脑，传输到接入点，到ISP的路由器、交换机，最后到达骨干网线路。这样的一个过程中，有许多不同的组织在传送着你的请求。这时，如果不怀好意的用户侵入这条线路之中的任何一个系统中时，他们将很有可能看到线路中传送的内容。</p>
<p>而一般情况下，Web请求和相应都经由普通的HTTP协议明文传送。HTTP协议默认不使用加密协议，都是由于这些原因：</p>
<ul>
<li>加密消耗了很多计算资源。</li>
<li>加密占用了更多的传输带宽。</li>
<li>加密后缓存机制会失效。</li>
</ul>
<p>不过，Web开发者会时不时遇到在连接中传送密码、信用卡号等敏感信息的情况。所以，有必要为这些页面做好防嗅探的准备措施。</p>
<p><strong>传输层安全协议（TLS）</strong></p>
<p>虽然下面讲解的内容和密码学有关，但是这里只是一个简单的介绍，不熟悉相关知识也应该看得懂。在实践中，是密码学算法确保了通信过程的安全，同时也抵御了潜在的信息黑手——干扰通信和监听的人。</p>
<p>SSL协议的继任者——TLS协议，常被用来实现安全HTTP连接（HTTPS）协议。在OSI网络模型中，TLS协议比HTTP协议的工作更加底层。确切来说，就是TLS的那部分连接发生在HTTP的连接之前。</p>
<p>TLS是一种混合的加密机制。它具有多种范式，接下来所看到的是对于这两种范式（用于共享秘密信息和身份认证（确保声称的身份和实际身份一致）的公钥算法和用于加密请求与回应机密信息的对称式算法）的说明：</p>
<p><strong>公钥加密机制</strong></p>
<p>使用公钥加密机制，双方各自拥有一份公钥和一份私钥，公钥和私钥通过数学演算联系在一起。公钥用于将明文转化为密文（变成了一堆乱码），私钥用来解密这一堆乱码般的信息。</p>
<p>一旦信息被公钥加密，它将只能由相应的私钥解密。两者缺一不可，而且也不能反过来使用。公钥可以自由传播，无需担心系统安全性降低；但私钥应妥善保管，不可将其泄露给未经授权解密的信息的用户，这就是公钥和私钥这两个名称的由来。</p>
<p>公钥机制相当酷的地方在于，通信双方可以在最初不安全的通道上建立起安全可靠的通信连接。</p>
<p>客户端和服务器都可以使用各自的私钥，只要共享了一部分公开信息，也就是共用了同一个公钥的情况下，就可以建立起相应的会话。</p>
<p>这意味着即使有人坐在客户端或者服务器前查看连接过程，他们也不会知道客户端或者服务的的私钥，也不会知道会话所共享的密码。</p>
<p>这得靠什么实现？靠数学！</p>
<p><strong>Diffie-Hellman</strong></p>
<p>这种密钥交换最常使用是Diffie-Hellman的密钥交换法。这项过程允许服务器和客户端双方商定共同的保密信息，而不需要在传输过程中交换这个信息。这样一来，即使嗅探者查看每个数据包，也不能确定连接上传输的共享密码是什么。</p>
<p>在最初的DH式密钥交换发生之后所生成的共享信息，可以在会话接下来的通信中使用更简洁的对称式加密法，我们之后就会看到对称式加密法的说明。</p>
<p><strong>一点点数学</strong></p>
<p>公钥算法的特点就是很容易由算子计算出结果，而基本上不可能作逆向运算。这也就是使用了两个质数的所要达到的目的。</p>
<p>现在假设Alice和Bob分别是参与DH式密钥交换过程的两方，他们一开始会商议确定一个小质数（一般是2,3,5这样的小数字）和一个大质数（有300位以上）作为加密的原始信息。小质数和大质数都可以直接传输，不必担心交换过程中的不安全。</p>
<p>需要明白的是，Alice和Bob各自都持有着自己的私钥（100多位的数），而且也永远不应该共享自己的私钥。不光是两人之间，也包括其他不相关的人都不应该拥有这两组私钥。网络中传输的是他们的私钥、小质数和大质数混合运算得到的结果。更确切来说，就是：</p>
<ul>
<li>Alice的结果 = （小质数Alice的密码）% 大质数</li>
<li>Bob的结果 = （小质数Bob的密码）% 大质数</li>
<li>（“%” 符号表示取模运算，即取得除法运算的余数）</li>
</ul>
<p>所以Alice使用大质数和小质数加上自己的私钥运算，就会得出结果，而Bob做同样的计算，也能得到相同的结果。当他们接收到对方的运算结果时，他们可以由数学计算导出会话中所要传输的信息，也就是说：</p>
<p>Alice计算的是</p>
<ul>
<li>（Bob的结果Alice的密码）% 大质数</li>
</ul>
<p>而Bob则计算</p>
<ul>
<li>（Alice的结果Bob的密码）% 大质数</li>
</ul>
<p>Alice和Bob得出来的数字相同，这个数字也就是会话中所要共享的密码。请注意，双方都没有向对方传输各自的私钥，而连接过程中也没有明文传递保密信息。这一点真是太棒了！</p>
<p>对数学不好的人而言，维基百科上有一张混合颜料的图可以用来说明情况：
<img src="" alt=""></p>
<p>请注意图中一开始的颜色（黄色）最后都会有Alice和Bob的颜色参与计算。这就是双方会得到同样结果的原因。对于观看中间过程的人来说，唯一在连接中发送的半合成信息是毫无意义的。</p>
<p><strong>对称式加密机制</strong></p>
<p>每次会话中只需要产生一次公钥交换的过程。在接受了同一个共享保密信息以后，服务器和客户端之间会使用更为高效的对称式加密机制进行通信，省去了来回交换的额外花销。</p>
<p>在接受了之前的共享保密信息之后，还会使用一套密码机制（一般是一组加密算法），使用共享的密码安全地通信，加密解密各自的信息。而窃听者只会看到一堆乱码在传来传去。</p>
<p><strong>身份认证</strong></p>
<p>DH式密钥交换允许双方创建私有的，共有的密码，但通信双方怎么确保是真正想要对话的人呢？这里就涉及到了身份认证的问题。</p>
<p>假设我拿起电话，跟我的朋友进行DH式密钥交换，在电话已经被干扰的情况，实际上是在跟其他人交换信息。在使用共享密码了以后，我仍然可以安全地与“朋友”交换信息，没有人可以解密我们的通信信息，但是“朋友”并不真的是我的朋友，这可是十分不安全的！</p>
<p>要解决身份认证问题，需要有配套的公钥基本设施，来核实用户的真实身份。这些设施用来创建，管理，发布，收回数字证书。而数字证书正是你需要为站点使用HTTPS协议付费的恼人事项。</p>
<p>但是，什么是数字证书，数字证书又是如何保证信息更加安全的呢？</p>
<p><strong>证书</strong></p>
<p>从更高的层次来讲，数字证书是将机器上的公钥和身份信息绑在一起的数字签名。数字签名担保某份公钥属于某个特定的组织和机构。</p>
<p>证书将域名（身份信息）和特定公钥关联起来。这就避免了窃听者将自己的服务器伪装成用户将要连接的服务器，并进行攻击的行为。</p>
<p>在上面打电话的例子中，攻击者可以尝试展示自己的公钥，装作是你的“朋友”，但是证书上面的签名信息便显示出：这份证书不是来自我信任的人的。</p>
<p>要受到一般<a href="http://blog.jobbole.com/12749/" title="浏览器" target="_blank">浏览器</a>的信任，证书本身还应当受到CA的信任。CA公司对认证会进行人工核查，确定申请主体满足以下两个条件：</p>
<ol>
<li>在公共记录中存在着这个人/这家公司。</li>
<li>需要签名的证书上标明的域名的确由申请主体实际控制。</li>
</ol>
<p>当CA查证，得出申请人属实，并且的确拥有这个域名的结果，CA便会为证书颁发签证，盖上“已核准”的戳记，表明网站的公钥属于这个网站，而且可以信任。</p>
<p>你的浏览器中会内置一系列受信任的CA列表。如果服务器返回的是未经过受信任CA签证的证书，浏览器会弹出大大的警告，这就在系统中多了一层安全措施，如果不然，任何人都可以四处签售伪造的证书。
<img src="" alt=""></p>
<p>这样一来，即使攻击者将自己的公钥拿出来，生成这份密钥，声称自己的伪造服务器就是“facebook.com”，浏览器也会因为检查到“未经受信任CA签名的证书”而弹出提示。</p>
<p><strong>一些关于证书的其他事项</strong></p>
<p><strong>增强式认证</strong></p>
<p>在常规的X.509 证书之外，增强式认证证书提供了更强力的认证。</p>
<p>要授予增强式认证证书，CA会对域名持有着做更加深入的查验（通常需要提供护照和水电费账单等信息）。</p>
<p>这种类型的证书，浏览器中大锁图标的显示位置背景也会变成绿色。</p>
<p><strong>在同一台服务器上运行的多个网站</strong></p>
<p>在HTTP协议连接开始之前进行的TLS协议握手流程，很有可能存在着多个网站存放在同一个服务器，使用相同IP地址的情况。</p>
<p>虚拟主机的Web路由是由Web服务器分发，但是TCP握手的过程，却是发生在连接之前。整个系统的单张证书会被发送到服务器的所有请求之中，这种流程会在共享主机的环境中发生问题。</p>
<p>如果你正在使用Web主机上提供的服务，他们会在你使用HTTPS协议之前要求使用独立的IP地址。不然主体提供商就需要每次在服务器上有新站点的时候，取得新证书（并且向CA重新申请认证）。
<img src="&quot;3 votes, average: 5.00 out of 5&quot;" alt="3 votes, average: 5.00 out of 5"><img src="&quot;3 votes, average: 5.00 out of 5&quot;" alt="3 votes, average: 5.00 out of 5"><img src="&quot;3 votes, average: 5.00 out of 5&quot;" alt="3 votes, average: 5.00 out of 5"><img src="&quot;3 votes, average: 5.00 out of 5&quot;" alt="3 votes, average: 5.00 out of 5"><img src="&quot;3 votes, average: 5.00 out of 5&quot;" alt="3 votes, average: 5.00 out of 5"> (<strong>*3</strong> 个评分，平均: <strong>5.00*</strong>)</p>
<p><img src="&quot;Loading ...&quot;" alt="Loading ..."> Loading ...
原文链接： <a href="http://blog.hartleybrody.com/https-certificates/" target="_blank">hartley brody</a>   翻译： <a href="http://blog.jobbole.com/" target="_blank">伯乐在线</a> - <a href="http://blog.jobbole.com/author/jobbole/" target="_blank">伯乐在线读者</a>
译文链接： <a href="http://blog.jobbole.com/45530/" target="_blank"><a href="http://blog.jobbole.com/45530/">http://blog.jobbole.com/45530/</a></a>
[ <strong>转载必须在正文中标注并保留原文链接、译文链接和译者等信息。</strong>]</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/TCPIP/">TCPIP</a></li></span></span> | <span class="tags">Tagged <a href="/tags/TCPIP/" class="label label-primary">TCPIP</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:44"datetime="2014-03-07 09:54:44"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-TCPIP--HTTPS是如何保证连接安全：每位Web开发者都应知道的-博客-伯乐在线/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-TCPIP--HTTPS是如何保证连接安全：每位Web开发者都应知道的-博客-伯乐在线" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>





<ul id="pagination" class="pagination pagination-lg">
  <li><a class="extend prev" href="/page/29/">&laquo;</a></li><li><a class="page-number" href="/">1</a></li><li><a class="page-number" href="/page/2/">2</a></li><li><span class="space">&hellip;</span></li><li><a class="page-number" href="/page/27/">27</a></li><li><a class="page-number" href="/page/28/">28</a></li><li><a class="page-number" href="/page/29/">29</a></li><li class="active"><li><span class="page-number current">30</span></li><li><a class="page-number" href="/page/31/">31</a></li><li><a class="page-number" href="/page/32/">32</a></li><li><a class="page-number" href="/page/33/">33</a></li><li><span class="space">&hellip;</span></li></li><li><a class="page-number" href="/page/161/">161</a></li><li><a class="page-number" href="/page/162/">162</a></li><li><a class="extend next" href="/page/31/">&raquo;</a></li>
  <div class="clearfix"></div>
</ul></div><!--wapper-->
       </div><!-- ID main-col END -->
       <aside id="sidebar" class="alignright col-sx-6 col-sm-4 col-md-3 col-lg-3">
<div id="widget_search" class="widget panel panel-primary">
    <form action="//google.com/search" method="get" accept-charset="utf-8">
  <div class="input-group">
    <input class="form-control" id="searchbox" type="search" name="q" results="0" placeholder="search">
    <span class="input-group-btn">
      <button class="btn btn-default" type="submit">Go!</button>
    </span>
    <input type="hidden" name="q" value="site:itsolife.com">
  </div>
</form>
</div>

<div id="widget_category" class="widget panel panel-primary">
  <div class="panel-heading">category</div>  <div data-src='category' class='ajax_widgets'>正在加载...</div>
</div>

<div id="widget_recent_posts" class="widget panel panel-primary">
  <div class="panel-heading">recent posts</div>  <div data-src='recent_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_tagcloud" class="widget panel panel-primary">
  <div class="panel-heading">tagcloud</div>  <div data-src='tagcloud' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_latest_update_posts" class="widget panel panel-primary">
  <div class="panel-heading">最近更新</div>  <div data-src='latest_update_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_recent_comments" class="widget panel panel-primary">
  <div class="panel-heading">recent comments</div>  

<div class="list-group-item ds-recent-comments" data-num-items="6" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="50"></div>



</div>

</aside>
       <div class="clearfix"></div>
     </div><!-- row END -->
  </div>
  <footer id="footer" class="container">
  <div class="panel panel-info">
  <section id='footer_widget'></section>  <div class="panel-footer">
  <div id="site-info">
    <span class='author'>
  
  &copy; 2014 RobinChia
  
    &nbsp;&nbsp;</span>
  
  <span id='analytics-51la'></span><span id='analytics-google'>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-48559895-1']);
  _gaq.push(['_trackPageview']);
  _js2load.push({src:('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'});
</script></span><span id='analytics-cnzz'>
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_5774006'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s17.cnzz.com/stat.php%3Fid%3D5774006%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
</span><span id='analytics-baidu'>
<script>
var _hmt = _hmt || [];
_js2load.push({src:"//hm.baidu.com/hm.js?1442f50724afc42380b51f097c43082c"});
</script>
</span>  </div>
  <div id="copyright">Site powered by <a href='http://zespia.tw/hexo/'><strong>hexo</strong></a>  update time: <em>2014-04-07 18:24:57</em></span></div>
</div>
<div class="clearfix"></div>


  </div>
  </footer>
  
        <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>        
        <script src="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/js/bootstrap.min.js"></script>        
                
        <script src="http://cdn.bootcss.com/prettify/r298/prettify.min.js"></script>    <script type="text/javascript">
   var lang=["bsh", "c", "cc", "cpp", "cs", "csh", "cyc", "cv", "htm", "html",
    "java", "js", "m", "mxml", "perl", "pl", "pm", "py", "rb", "sh",
    "xhtml", "xml", "xsl"];
   var pretty_base='';
   $('script').each(function(){
	var c = $(this).attr('src');
	if (!c)
	    return;
	if (c.match(/(\/)?prettify(\.min)?\.js/i))
	{
	    var index = c.lastIndexOf('/');
	    if (index != -1)
		pretty_base = c.substr(0,index + 1);
	    return false;
	}
   })
   $('pre code').each(function(){
	var c = $(this).attr('class')
	if (!c)
	    return;
	c = c.match(/\s?(lang\-\w+)/i);
	if (c && lang.indexOf(c[1]) == -1)
	{
	    lang.push(c[1]);
	    $.getScript(pretty_base + c[1] + '.min.js');
	}
   })

    $(window).load(function(){
       $("pre").addClass("prettyprint");
       prettyPrint();
    })
</script>    
            <script type="text/javascript">
var duoshuoQuery = {short_name:"robinchia"};
_js2load.push({src:'http://static.duoshuo.com/embed.js',charset:'UTF-8'});
</script>
    
            <!--wumii_relatedItems-->
    
        <script src="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js"></script>    <script type="text/javascript">
(function($){
  $('.entry').each(function(i){
    $(this).find('img').each(function(){
      var alt = this.alt;

      if (alt){
        $(this).before('<span class="caption">' + alt + '</span>');
      }

      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="fancybox' + i + '" />');
    });
  });

  $('.fancybox').fancybox();
})(jQuery);
</script>    
        <script src="http://cdn.bootcss.com/mathjax/2.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>
    
<script type="text/javascript">
$('.ajax_widgets').each(function(){var src=$(this).attr('data-src');if(src)$(this).load('/widgets/'+src+'.html');});
$.each(_js2load,function(index,obj){loadjs(obj.src,obj.charset)});
</script>

<div id="scroll2top">
<img src="/scroll2top/arrow.png"/>
</div>
<script src="/scroll2top/scroll2top.min.js"></script>
<div id="winterland">
  <canvas></canvas>
</div>
<script src="/js/winterland.min.js"></script>

  </body>
</html>
