
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>The 86 Page | It so life</title>
<meta name="author" content="RobinChia">

<meta name="description" content="It so life">


<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta property="og:site_name" content="It so life"/>

<!--[if IE]><style>.testIE.IE{display:inline;}</style><![endif]-->
<!--[if lte IE 7]><link rel="stylesheet" href="/css/ie7.css" type="text/css"><![endif]-->
<!--[if (lt IE 9)&(gt IE 7)]><style>.testIE.IE8{display:inline;}</style><![endif]-->
<!--[if gt IE 8]><style>.testIE.IE9{display:inline;}</style><![endif]-->

<link href="/favicon.png" rel="icon">
<link rel="alternate" href="/atom.xml" title="It so life Feed" type="application/atom+xml">

<link rel="stylesheet" href="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.0.3/css/font-awesome.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/prettify/r298/prettify.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" type="text/css">
<link rel="stylesheet" href="/css/style.css" type="text/css">
<!--[if lt IE 9]>
   <style>article,aside,dialog,footer,header,section,footer,nav,figure,menu{display:block}</style>
   <script src="http://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
   <script src="http://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
<link href="http://cdn.staticfile.org/respond.js/1.4.2/respond-proxy.html" id="respond-proxy" rel="respond-proxy" />
<link href="/js/respond.proxy.gif" id="respond-redirect" rel="respond-redirect" />
<script src="/js/respond.proxy.js"></script>
   <script src="http://cdn.bootcss.com/selectivizr/1.0.2/selectivizr-min.js"></script>
<![endif]-->
<script type="text/javascript">
function loadjs(c,d){var a=document.createElement("script");a.async=!0;a.type="text/javascript";a.src=c;a.charset=d||"gbk";(document.getElementsByTagName("HEAD")[0]||document.getElementsByTagName("BODY")[0]).appendChild(a)};
var _protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
var _js2load = [];
</script>

</head>
<body>
      <header id="header" class="container"><nav id="main-nav" class="navbar navbar-default navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="/">It so life</a>
    </div>
    <div  class="collapse navbar-collapse">
      <ul  class="nav navbar-nav">
  
        <li><a href="/" title="Home">Home</a></li>      
        <li><a href="/about/" title="About">About</a></li>      
        <li><a href="/archives/" title="Archives">Archives</a></li>      
      <li class='dropdown'>
        <a class='dropdown-toggle' data-toggle='dropdown' href='#'>website<b class='caret'></b></a>
        <ul class='dropdown-menu pure-menu-selected'>
    
          <li><a href="//groups.google.com/forum/#!forum/pongba" title="TopLanguage">TopLanguage</a></li>    
          <li><a href="//itpub.net/" title="ITPub">ITPub</a></li>    
          <li><a href="//blog.jobbole.com/" title="Bole">Bole</a></li>    
          <li><a href="//nosql-database.org/" title="nosql">nosql</a></li>    
          <li><a href="//gitimmersion.googol.im/" title="Git">Git</a></li>    
        </ul>
      </li>
    
      </ul>
      <ul class="nav navbar-nav navbar-right">
      
        <li><a href="/atom.xml">RSS</a></li>
      
      
        <li><a href="https://twitter.com/robinchia">twitter</a></li>
      
      
      
      
        <li><a href="https://github.com/robinchia">github</a></li>
      
      </ul>
    </div>
  </div>
</nav>
<div class="clearfix"></div>
</header>
  <div id='content' class="container">
     <div class="page-header-wrapper">
      <!--[if lt IE 9]><div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong>提示:</strong>您的浏览器版本太低了,建议升级到 <strong><a href="http://windows.microsoft.com/zh-cn/internet-explorer/download-ie" title="IE9">IE9</a></strong> 以上,本站使用<a href="https://www.google.com/intl/zh-CN/chrome/">Chrome浏览器</a>可以获得最好的显示效果.</div><![endif]-->
      <div class="page-header"><h1 align="center"><big>It so life</big> </h1>
        <h5 align="center"><big>love as life</big></h5>
      </div>
     </div>
     <div class="row">
       <div id="main-col" class="alignleft col-sx-12 col-sm-8 col-md-9 col-lg-9">
      <section id='header_widget'></section>
          <div id="wrapper"><article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-CAS-spring-cas--23-X509Authentication/">23. X.509 Authentication</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:39.000Z"> <a href="/2014/02/02/2014-02-02-CAS-spring-cas--23-X509Authentication/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="23-x-509-authentication">23. X.509 Authentication</h1>
<ol>
<li>X.509 Authentication<a href="http://static.springsource.org/spring-security/site/docs/3.1.x/reference/cas.html" target="_blank">Prev</a> Part V. Additional Topics <a href="http://static.springsource.org/spring-security/site/docs/3.1.x/reference/runas.html" target="_blank">Next</a></li>
</ol>
<h1 id="-x-509-authentication"><a href=""></a>X.509 Authentication</h1>
<h2 id="-23-1-overview"><a href=""></a>23.1 Overview</h2>
<p>The most common use of X.509 certificate authentication is in verifying the identity of a server when using SSL, most commonly when using HTTPS from a browser. The browser will automatically check that the certificate presented by a server has been issued (ie digitally signed) by one of a list of trusted certificate authorities which it maintains.</p>
<p>You can also use SSL with “mutual authentication”; the server will then request a valid certificate from the client as part of the SSL handshake. The server will authenticate the client by checking that its certificate is signed by an acceptable authority. If a valid certificate has been provided, it can be obtained through the servlet API in an application. Spring Security X.509 module extracts the certificate using a filter. It maps the certificate to an application user and loads that user&#39;s set of granted authorities for use with the standard Spring Security infrastructure.</p>
<p>You should be familiar with using certificates and setting up client authentication for your servlet container before attempting to use it with Spring Security. Most of the work is in creating and installing suitable certificates and keys. For example, if you&#39;re using Tomcat then read the instructions here</p>
<p><a href="http://tomcat.apache.org/tomcat-6.0-doc/ssl-howto.html" target="_blank"><a href="http://tomcat.apache.org/tomcat-6.0-doc/ssl-howto.html">http://tomcat.apache.org/tomcat-6.0-doc/ssl-howto.html</a></a>
. It&#39;s important that you get this working before trying it out with Spring Security</p>
<h2 id="-23-2-adding-x-509-authentication-to-your-web-application"><a href=""></a>23.2 Adding X.509 Authentication to Your Web Application</h2>
<p>Enabling X.509 client authentication is very straightforward. Just add the</p>
<p><x509/>
element to your http security namespace configuration.</p>
<http> ... <x509 subject-principal-regex="CN=(./*?)," user-service-ref="userService"/>; ... </http>

<p>The element has two optional attributes:</p>
<ul>
<li>subject-principal-regex
. The regular expression used to extract a username from the certificate&#39;s subject name. The default value is shown above. This is the username which will be passed to the</li>
</ul>
<p>UserDetailsService
to load the authorities for the user.</p>
<ul>
<li>user-service-ref
. This is the bean Id of the</li>
</ul>
<p>UserDetailsService
to be used with X.509. It isn&#39;t needed if there is only one defined in your application context.</p>
<p>The</p>
<p>subject-principal-regex
should contain a single group. For example the default expression &quot;CN=(./*?),&quot; matches the common name field. So if the subject name in the certificate is &quot;CN=Jimi Hendrix, OU=...&quot;, this will give a user name of &quot;Jimi Hendrix&quot;. The matches are case insensitive. So &quot;emailAddress=(.?),&quot; will match &quot;EMAILADDRESS=jimi@hendrix.org,CN=...&quot; giving a user name &quot;jimi@hendrix.org&quot;. If the client presents a certificate and a valid username is successfully extracted, then there should be a valid</p>
<p>Authentication
object in the security context. If no certificate is found, or no corresponding user could be found then the security context will remain empty. This means that you can easily use X.509 authentication with other options such as a form-based login.</p>
<h2 id="-23-3-setting-up-ssl-in-tomcat"><a href=""></a>23.3 Setting up SSL in Tomcat</h2>
<p>There are some pre-generated certificates in the</p>
<p>samples/certificate
directory in the Spring Security project. You can use these to enable SSL for testing if you don&#39;t want to generate your own. The file</p>
<p>server.jks
contains the server certificate, private key and the issuing certificate authority certificate. There are also some client certificate files for the users from the sample applications. You can install these in your browser to enable SSL client authentication.</p>
<p>To run tomcat with SSL support, drop the</p>
<p>server.jks
file into the tomcat</p>
<p>conf
directory and add the following connector to the</p>
<p>server.xml
file</p>
<Connector port="8443" protocol="HTTP/1.1" SSLEnabled="true" scheme="https" secure="true" clientAuth="true" sslProtocol="TLS" keystoreFile="${catalina.home}/conf/server.jks" keystoreType="JKS" keystorePass="password" truststoreFile="${catalina.home}/conf/server.jks" truststoreType="JKS" truststorePass="password" />

<p>*
clientAuth</p>
<ul>
<li>can also be set to *
want</li>
<li>if you still want SSL connections to succeed even if the client doesn&#39;t provide a certificate. Clients which don&#39;t present a certificate won&#39;t be able to access any objects secured by Spring Security unless you use a non-X.509 authentication mechanism, such as form authentication.
<a href="http://static.springsource.org/spring-security/site/docs/3.1.x/reference/cas.html" target="_blank">Prev</a> <a href="http://static.springsource.org/spring-security/site/docs/3.1.x/reference/advanced-topics.html" target="_blank">Up</a> <a href="http://static.springsource.org/spring-security/site/docs/3.1.x/reference/runas.html" target="_blank">Next</a>22. CAS Authentication <a href="http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity.html" target="_blank">Home</a> 24. Run-As Authentication Replacement    <img src="" alt=""></li>
</ul>
<p><a href=""><img src="" alt=""></a></p>
<p><a href="http://www.springsource.com/?cid=70180000000wIe4AAE" target="_blank"><img src="" alt=""></a>
allSpringSourceGrailsHypericGemstoneRabbitMQ <img src="&quot;Search Documentation&quot;" alt=""></p>
<p><img src="&quot;click to toggle&quot;" alt="">
<a href="http://www.springsource.com/spring-framework-consulting" target="_blank"><img src="" alt=""></a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/CAS/">CAS</a></li></span><span class="breadcrumb"><li><a href="/categories/CAS/">CAS</a></li><li><a href="/categories/CAS/spring-cas/">spring-cas</a></li></span></span> | <span class="tags">Tagged <a href="/tags/CAS/" class="label label-primary">CAS</a><a href="/tags/spring-cas/" class="label label-success">spring-cas</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:39"datetime="2014-03-07 09:54:39"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-CAS-spring-cas--23-X509Authentication/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-CAS-spring-cas--23-X509Authentication" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-CAS-withoutcasloginscreen--UsingCASwithouttheCASloginscreen-CentralA/">Using CAS without the CAS login screen </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:39.000Z"> <a href="/2014/02/02/2014-02-02-CAS-withoutcasloginscreen--UsingCASwithouttheCASloginscreen-CentralA/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="using-cas-without-the-cas-login-screen-central-authentication-service-jasig-wiki">Using CAS without the CAS login screen - Central Authentication Service - Jasig Wiki</h1>
<ul>
<li><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+CAS+login+screen#title-heading" target="_blank">Skip to content</a></li>
<li><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+CAS+login+screen#breadcrumbs" target="_blank">Skip to breadcrumbs</a></li>
<li><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+CAS+login+screen#header-menu-bar" target="_blank">Skip to header menu</a></li>
<li><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+CAS+login+screen#navigation" target="_blank">Skip to action menu</a></li>
<li><p><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+CAS+login+screen#quick-search-query" target="_blank">Skip to quick search</a>
Quick Search</p>
</li>
<li><p><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+CAS+login+screen#" target="_blank">Browse</a></p>
</li>
<li><p><a href="https://wiki.jasig.org/pages/listpages.action?key=CAS" title="Browse pages in the Central Authentication Service space ( Type &#39;g&#39; then &#39;s" target="_blank">Pages</a>&quot;)</p>
</li>
<li><a href="https://wiki.jasig.org/pages/viewrecentblogposts.action?key=CAS" title="Browse blogs in the Central Authentication Service space" target="_blank">Blog</a></li>
<li><a href="https://wiki.jasig.org/labels/listlabels-heatmap.action?key=CAS" title="Browse labels in the Central Authentication Service space" target="_blank">Labels</a></li>
<li><a href="https://wiki.jasig.org/spaces/listattachmentsforspace.action?key=CAS" title="Browse attachments in the Central Authentication Service space" target="_blank">Attachments</a></li>
<li><a href="https://wiki.jasig.org/mail/archive/viewmailarchive.action?key=CAS" title="Browse mail in the Central Authentication Service space" target="_blank">Mail</a></li>
<li><a href="https://wiki.jasig.org/spaces/viewspacesummary.action?key=CAS" title="Browse additional space functions in the Central Authentication Service space" target="_blank">Advanced</a></li>
<li><p><a href="https://wiki.jasig.org/spaces/usage/report.action?key=CAS" target="_blank">Activity</a></p>
</li>
<li><p><a href="http://docs.atlassian.com/confluence/docs-41/whatsnew/iframe" target="_blank">What’s New</a></p>
</li>
<li><a href="https://wiki.jasig.org/spacedirectory/view.action" title="Browse the Confluence space directory" target="_blank">Space Directory</a></li>
<li><a href="https://wiki.jasig.org/dashboard/configurerssfeed.action" title="Create your custom RSS feed." target="_blank">Feed Builder</a></li>
<li><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+CAS+login+screen#" title="View available keyboard shortcuts ( Type &#39;?" target="_blank">Keyboard Shortcuts</a>&quot;)</li>
<li><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+CAS+login+screen#" title="Browse gadgets provided by Confluence" target="_blank">Confluence Gadgets</a></li>
<li><a href="https://wiki.jasig.org/login.action?os_destination=%2Fdisplay%2FCAS%2FUsing%2BCAS%2Bwithout%2Bthe%2BCAS%2Blogin%2Bscreen" target="_blank">Log In</a></li>
<li><a href="https://wiki.jasig.org/signup.action" target="_blank">Sign Up</a></li>
</ul>
<ol>
<li><a href="https://wiki.jasig.org/dashboard.action" title="Go to Dashboard ( Type &#39;g&#39; then &#39;d" target="_blank">Dashboard</a>&quot;)</li>
<li><a href="https://wiki.jasig.org/display/CAS" target="_blank">Central Authentication Service</a></li>
<li><strong>…</strong></li>
<li><a href="https://wiki.jasig.org/display/CAS/CASifying+Applications" target="_blank">CASifying Applications</a></li>
<li><a href="">Using CAS without the CAS login screen</a></li>
</ol>
<ul>
<li><p><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+CAS+login+screen#" target="_blank">Tools</a></p>
</li>
<li><p><a href="https://wiki.jasig.org/pages/viewpageattachments.action?pageId=5225" title="View Attachments ( Type &#39;t" target="_blank">Attachments (0)</a>&quot;)</p>
</li>
<li><a href="https://wiki.jasig.org/pages/viewpreviousversions.action?pageId=5225" target="_blank">Page History</a></li>
<li><p><a href="https://wiki.jasig.org/pages/viewinfo.action?pageId=5225" title="Edit restrictions" target="_blank">Restrictions</a></p>
</li>
<li><p><a href="https://wiki.jasig.org/pages/viewinfo.action?pageId=5225" target="_blank">Info</a></p>
</li>
<li><a href="https://wiki.jasig.org/pages/viewinfo.action?pageId=5225" title="Link to this Page ( Type &#39;k" target="_blank">Link to this Page…</a>&quot;)</li>
<li><a href="https://wiki.jasig.org/pages/listpages-dirview.action?key=CAS&amp;openId=5225#selectedPageInHierarchy" target="_blank">View in Hierarchy</a></li>
<li><a href="https://wiki.jasig.org/plugins/viewsource/viewpagesrc.action?pageId=5225" target="_blank">View Source</a></li>
</ul>
<h1 id="-https-wiki-jasig-org-display-cas-using-cas-without-the-cas-login-screen-"><a href="https://wiki.jasig.org/display/CAS" target="_blank"><img src="" alt=""></a>  <a href="">Using CAS without the CAS login screen</a></h1>
<p><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+CAS+login+screen#page-metadata-end" target="_blank">Skip to end of metadata</a></p>
<ul>
<li><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+CAS+login+screen#" title="Page restrictions apply. Click the lock icon to view or edit the restriction." target="_blank">Page restrictions apply</a></li>
<li>Added by <a href="https://wiki.jasig.org/display/~awp9" target="_blank">Andrew Petro</a>, last edited by <a href="https://wiki.jasig.org/display/~brummermann" target="_blank">Hendrik Brummermann</a> on Jul 26, 2011  (<a href="https://wiki.jasig.org/pages/diffpages.action?pageId=5225&amp;originalId=52495191" target="_blank">view change</a>)</li>
<li><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+CAS+login+screen#" target="_blank">show comment</a> <a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+CAS+login+screen#" target="_blank">hide comment</a>
<strong>Comment:</strong> Corrected links that should have been relative instead of absolute.
<a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+CAS+login+screen#page-metadata-start" target="_blank">Go to start of metadata</a></li>
</ul>
<p>This page is for documenting how to use CAS without using the CAS login screen.</p>
<h2 id="why-not-to-do-this">Why not to do this</h2>
<p>One of the advantages CAS brings to the table is a single authentication user experience across all applications using CAS. The user doesn&#39;t have to wonder whether he should be giving his password to any particular application, because no applications other than CAS receive the password.</p>
<p>Implementing this hack results in applications other than CAS having access to actual usernames and passwords. This is a bad thing. It reduces the security value CAS is trying to give you.</p>
<h2 id="existing-features">Existing features</h2>
<p>The CAS gateway feature allows your application to attempt to use CAS single sign on to authenticate the user without interrupting the user experience to display a CAS login screen. If no SSO session already exists, CAS simply redirects back to your service without displaying the login screen.</p>
<h2 id="alternative-approaches">Alternative approaches</h2>
<p>An alternative to your application rendering its own login screen is to get CAS Server to render the login screen you would have wanted to render. <a href="https://wiki.jasig.org/display/CAS/Columbia" target="_blank">WIND</a> goes this route. This is on the feature list for CAS 3.</p>
<p>A relatively easy option (for portals, at least) is to proxy the HTML of the CAS login page and display it inline in the portal page.  The proxied form should still submit to CAS itself.  You can tweak the CAS jsps to use different CSS styles depending on the User Agent or Remote Host, to provide a modified (e.g. smaller) login screen.</p>
<h2 id="using-cas-without-the-login-screen">Using CAS without the login screen</h2>
<p>Suppose you really do want your service to be handling the user&#39;s username and password.</p>
<p>First, produce your custom form. When your custom form submits, the recipient of the submit needs to do the following:</p>
<h3 id="validate-the-username-and-password">Validate the username and password</h3>
<p>Somehow, you need to figure out whether this username and password are correct.</p>
<p>One thing to do would be to generate an HTTP request for CAS login, parse out a valid login ticket, then issue a request for CAS login posting the login ticket, username, and password. Parse the response. If it indicates a success, the username and password are valid. Otherwise not.</p>
<p>Another thing to do would be to go directly against whatever it is that CAS is using to validate usernames and passwords.</p>
<p>If the username and password didn&#39;t match, redisplay your form. If they did match, then either 1) you&#39;re done because all you wanted to do was authenticate the user, or 2) now you need to establish the CAS SSO session in the web browser and obtain a Service ticket.</p>
<h3 id="establish-the-sso-session-and-possibly-get-a-proxy-ticket">Establish the SSO session and possibly get a Proxy Ticket</h3>
<p>Again, get a login ticket and the jsessionid. Then, generate a redirect to the browser placing the sesisonid, login ticket, the username, and the password on the CAS login URL to which you&#39;re redirecting:
<a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+CAS+login+screen#" target="_blank">?</a>https:</p>
<p>//cas.example.com/cas/login;jsessionid=XXXXXXXX?username=XXXXXXX&amp;password=XXXXXXX&amp;lt=XXXXXX</p>
<p>Specify the service to be your application where you want to receive the service ticket.</p>
<p>CAS will set the Single Sign On cookie so the user will have a CAS SSO session established.</p>
<p>Since the username, password, and login ticket are good, CAS will redirect back to your service with the service ticket. Grab the service ticket and validate it in the normal way (presumably using a CAS client). This is your opportunity to obtain a Proxy Ticket.</p>
<p>Note: This only works as long as the user has not visited the CAS webpage before. Otherwise he or she got a different sessionid cookie which has priority over the sessionid in the url.</p>
<h2 id="experience-reports">Experience Reports</h2>
<p><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen" target="_blank">Here is an experience report</a> on how an UI-less mode for CAS has been achieved using javascript only on the client side. Passwords are only handed over to the SSL secured CAS service, not to a third party.
Labels:</p>
<p>None</p>
<p><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+CAS+login+screen#" title="Edit Labels ( Type &#39;l" target="_blank">Edit Labels</a>&quot;)
Powered by a free <strong>Atlassian Confluence Open Source Project License</strong> granted to Java Architectures Special Interest Group. <a href="http://www.atlassian.com/c/conf/11461" target="_blank">Evaluate Confluence today</a>.
This Confluence installation runs a Free Gliffy License - <a href="http://www.gliffy.com/products/confluence-plugin/" target="_blank">Evaluate Gliffy</a> for your Wiki!</p>
<ul>
<li>Powered by <a href="http://www.atlassian.com/software/confluence" target="_blank">Atlassian Confluence</a> 4.1.5, the <a href="http://www.atlassian.com/software/confluence/tour/enterprise-wiki.jsp" target="_blank">Enterprise Wiki</a></li>
<li>Printed by Atlassian Confluence 4.1.5, the Enterprise Wiki.</li>
<li>·  <a href="http://jira.atlassian.com/secure/BrowseProject.jspa?id=10470" target="_blank">Report a bug</a></li>
<li>·  <a href="http://www.atlassian.com/about/connected.jsp?s_kwcid=Confluence-stayintouch" target="_blank">Atlassian News</a></li>
</ul>
<p><a href=""></a><a href=""></a><a href=""></a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/CAS/">CAS</a></li></span><span class="breadcrumb"><li><a href="/categories/CAS/">CAS</a></li><li><a href="/categories/CAS/without+cas+login+screen/">without+cas+login+screen</a></li></span></span> | <span class="tags">Tagged <a href="/tags/CAS/" class="label label-primary">CAS</a><a href="/tags/without+cas+login+screen/" class="label label-success">without+cas+login+screen</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:39"datetime="2014-03-07 09:54:39"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-CAS-withoutcasloginscreen--UsingCASwithouttheCASloginscreen-CentralA/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-CAS-withoutcasloginscreen--UsingCASwithouttheCASloginscreen-CentralA" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-CAS-withoutcasloginscreen--UsingCASwithouttheLoginScreen-CentralAuthe/">Using CAS without the Login Screen </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:39.000Z"> <a href="/2014/02/02/2014-02-02-CAS-withoutcasloginscreen--UsingCASwithouttheLoginScreen-CentralAuthe/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="using-cas-without-the-login-screen-central-authentication-service-jasig-wiki">Using CAS without the Login Screen - Central Authentication Service - Jasig Wiki</h1>
<ul>
<li><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen#title-heading" target="_blank">Skip to content</a></li>
<li><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen#breadcrumbs" target="_blank">Skip to breadcrumbs</a></li>
<li><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen#header-menu-bar" target="_blank">Skip to header menu</a></li>
<li><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen#navigation" target="_blank">Skip to action menu</a></li>
<li><p><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen#quick-search-query" target="_blank">Skip to quick search</a>
Quick Search</p>
</li>
<li><p><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen#" target="_blank">Browse</a></p>
</li>
<li><p><a href="https://wiki.jasig.org/pages/listpages.action?key=CAS" title="Browse pages in the Central Authentication Service space ( Type &#39;g&#39; then &#39;s" target="_blank">Pages</a>&quot;)</p>
</li>
<li><a href="https://wiki.jasig.org/pages/viewrecentblogposts.action?key=CAS" title="Browse blogs in the Central Authentication Service space" target="_blank">Blog</a></li>
<li><a href="https://wiki.jasig.org/labels/listlabels-heatmap.action?key=CAS" title="Browse labels in the Central Authentication Service space" target="_blank">Labels</a></li>
<li><a href="https://wiki.jasig.org/spaces/listattachmentsforspace.action?key=CAS" title="Browse attachments in the Central Authentication Service space" target="_blank">Attachments</a></li>
<li><a href="https://wiki.jasig.org/mail/archive/viewmailarchive.action?key=CAS" title="Browse mail in the Central Authentication Service space" target="_blank">Mail</a></li>
<li><a href="https://wiki.jasig.org/spaces/viewspacesummary.action?key=CAS" title="Browse additional space functions in the Central Authentication Service space" target="_blank">Advanced</a></li>
<li><p><a href="https://wiki.jasig.org/spaces/usage/report.action?key=CAS" target="_blank">Activity</a></p>
</li>
<li><p><a href="http://docs.atlassian.com/confluence/docs-41/whatsnew/iframe" target="_blank">What’s New</a></p>
</li>
<li><a href="https://wiki.jasig.org/spacedirectory/view.action" title="Browse the Confluence space directory" target="_blank">Space Directory</a></li>
<li><a href="https://wiki.jasig.org/dashboard/configurerssfeed.action" title="Create your custom RSS feed." target="_blank">Feed Builder</a></li>
<li><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen#" title="View available keyboard shortcuts ( Type &#39;?" target="_blank">Keyboard Shortcuts</a>&quot;)</li>
<li><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen#" title="Browse gadgets provided by Confluence" target="_blank">Confluence Gadgets</a></li>
<li><a href="https://wiki.jasig.org/login.action?os_destination=%2Fdisplay%2FCAS%2FUsing%2BCAS%2Bwithout%2Bthe%2BLogin%2BScreen" target="_blank">Log In</a></li>
<li><a href="https://wiki.jasig.org/signup.action" target="_blank">Sign Up</a></li>
</ul>
<ol>
<li><a href="https://wiki.jasig.org/dashboard.action" title="Go to Dashboard ( Type &#39;g&#39; then &#39;d" target="_blank">Dashboard</a>&quot;)</li>
<li><a href="https://wiki.jasig.org/display/CAS" target="_blank">Central Authentication Service</a></li>
<li><strong>…</strong></li>
<li><a href="https://wiki.jasig.org/display/CAS/Home" target="_blank">Home</a></li>
<li><a href="">Using CAS without the Login Screen</a></li>
</ol>
<ul>
<li><p><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen#" target="_blank">Tools</a></p>
</li>
<li><p><a href="https://wiki.jasig.org/pages/viewpageattachments.action?pageId=3604523" title="View Attachments ( Type &#39;t" target="_blank">Attachments (0)</a>&quot;)</p>
</li>
<li><a href="https://wiki.jasig.org/pages/viewpreviousversions.action?pageId=3604523" target="_blank">Page History</a></li>
<li><p><a href="https://wiki.jasig.org/pages/viewinfo.action?pageId=3604523" title="Edit restrictions" target="_blank">Restrictions</a></p>
</li>
<li><p><a href="https://wiki.jasig.org/pages/viewinfo.action?pageId=3604523" target="_blank">Info</a></p>
</li>
<li><a href="https://wiki.jasig.org/pages/viewinfo.action?pageId=3604523" title="Link to this Page ( Type &#39;k" target="_blank">Link to this Page…</a>&quot;)</li>
<li><a href="https://wiki.jasig.org/pages/listpages-dirview.action?key=CAS&amp;openId=3604523#selectedPageInHierarchy" target="_blank">View in Hierarchy</a></li>
<li><a href="https://wiki.jasig.org/plugins/viewsource/viewpagesrc.action?pageId=3604523" target="_blank">View Source</a></li>
</ul>
<h1 id="-https-wiki-jasig-org-display-cas-using-cas-without-the-login-screen-"><a href="https://wiki.jasig.org/display/CAS" target="_blank"><img src="" alt=""></a>  <a href="">Using CAS without the Login Screen</a></h1>
<p><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen#page-metadata-end" target="_blank">Skip to end of metadata</a></p>
<ul>
<li><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen#" title="Page restrictions apply. Click the lock icon to view or edit the restriction." target="_blank">Page restrictions apply</a></li>
<li>Added by <a href="https://wiki.jasig.org/display/~jacomac" target="_blank">Konrad Wulf</a>, last edited by <a href="https://wiki.jasig.org/display/~newacct" target="_blank">newacct</a> on Aug 28, 2010  (<a href="https://wiki.jasig.org/pages/diffpages.action?pageId=3604523&amp;originalId=52495897" target="_blank">view change</a>)</li>
<li><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen#" target="_blank">show comment</a> <a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen#" target="_blank">hide comment</a>
<strong>Comment:</strong> Corrected links that should have been relative instead of absolute.
<a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen#page-metadata-start" target="_blank">Go to start of metadata</a></li>
</ul>
<h2 id="motivation">Motivation</h2>
<p>We wanted to be more flexible in the use of the login UI, so e.g. wanted to embed it in several places as a small panel. Moreover, we wanted to understand CAS as a pure service, not having to maintain layout information twice. Also, we wanted to support both, login postings from another site and direct login at the CAS server as a fallback.</p>
<h2 id="proposed-solutions-that-do-not-work">Proposed Solutions that do not work</h2>
<p>There have been two proposals, which we haven&#39;t found to be suitable:</p>
<ul>
<li>AJAX: Ajax requests are sandboxed and that sandbox is even more strict than the two-dot rule applied to cookies: It really has to be exactly the same server name in order to work</li>
<li><p>IFrames: In this <a href="http://tp.its.yale.edu/pipermail/cas-dev/2006-October/001451.html" target="_blank">posting to the cas-dev mailing list</a>, it has been suggested to use an iFrame to embed a login panel on a remote site. This has two limitations:</p>
</li>
<li><p>How to get rid of the Frame after login? in the default view a successful login would lead to redirect only in that frame. If you use target=&quot;parent&quot; in the from tag, how do you display errors then?</p>
</li>
<li><p>You would have limited layout possibilities.</p>
<p>So for our requirements, none of the proposed solutions were adequate.</p>
</li>
</ul>
<h2 id="our-solution">Our Solution</h2>
<p>We decided to use Javascript triggered redirects, which allows us to use this mechanism also on static html pages (e.g. CMS based contents). While loading we request a login ticket, then the login form displays and then it submits to the CAS login URL. If Errors are present at CAS we redirect to the referring page, adding a parameter &quot;error_message&quot; to that request.</p>
<h3 id="client-side">Client side</h3>
<p>Here is the static remote login form we use:
<a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen#" target="_blank">?</a>&lt;!DOCTYPE html PUBLIC</p>
<p>&quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;</p>
<p>&quot;<a href="http://www.w3.org/TR/html4/loose.dtd" target="_blank"><a href="http://www.w3.org/TR/html4/loose.dtd">http://www.w3.org/TR/html4/loose.dtd</a>&quot;</a></p>
<p>&gt;</p>
<html>
<head>

<meta http-equiv=

"Content-Type"

content=

"text/html; charset=ISO-8859-1"

>
<title>Test remote Login using JS</title>

<script type=

"text/javascript"

>
function prepareLoginForm() {



$(

&#39;myLoginForm&#39;

).action = casLoginURL;


$(

&quot;lt&quot;

).value = loginTicket;

}


function checkForLoginTicket() {


var loginTicketProvided =

false

;



var query   =

&#39;&#39;

;


casLoginURL =

&#39;<a href="https://pcdt057:8443/cas/login&#39;" target="_blank"><a href="https://pcdt057:8443/cas/login">https://pcdt057:8443/cas/login</a>&#39;</a>

;



thisPageURL =

&#39;<a href="https://pcdt057:8443/cas/test-remote-login-js+error.html&#39;" target="_blank"><a href="https://pcdt057:8443/cas/test-remote-login-js+error.html">https://pcdt057:8443/cas/test-remote-login-js+error.html</a>&#39;</a>

;


casLoginURL +=

&#39;?login-at=&#39;

+ encodeURIComponent (thisPageURL);




query   = window.location.search;



query   = query.substr (

1

);





var param   =

new

Array();



//var value = new Array();


var temp    =

new

Array();



param   = query.split (

&#39;&amp;&#39;

);




i =

0

;


while

(param[i]) {



temp        = param[i].split (

&#39;=&#39;

);


if

(temp[

0

] ==

&#39;lt&#39;

) {



loginTicket = temp[

1

];


loginTicketProvided =

true

;



}


if

(temp[

0

] ==

&#39;error_message&#39;

) {



error = temp[

1

];


}



i++;


}



if

(!loginTicketProvided) {


location.href = casLoginURL +

&#39;&amp;get-lt=true&#39;

;



}
}


function $(id) {



return

document.getElementById(id);
}

var loginTicket;
var error;

var casLoginURL;
var thisPageURL;


checkForLoginTicket();

onload = prepareLoginForm;
</script>

</head>
<body>

<h2>Test remote Login using JS</h2>
<form id=

"myLoginForm"

action=

""

method=

"post"

>

<input type=

"hidden"

value=

"submit"

name=

"_eventId"

/>
<table>

<tr>


<td id=

"txt_error"

colspan=

"2"

>




<script type=

"text/javascript"

language=

"javascript"

>



<!--


if

( error ) {



error = decodeURIComponent (error);


document.write (error);



}


//-->



</script>




</td>
</tr>

<tr>


<td>Benutzer:</td>



<td><input type=

"text"

value=

"konrad"

name=

"username"

></td>
</tr>

<tr>


<td>Password:</td>



<td><input type=

"text"

value=

"konrad"

name=

"password"

></td>
</tr>

<tr>


<td>Login Ticket:</td>



<td><input type=

"text"

name=

"lt"

id=

"lt"

value=

""

></td>
</tr>

<tr>


<td>Service:</td>



<td><input type=

"text"

name=

"service"

value=

"[http://quiz.jacomac.de"](http://quiz.jacomac.de/)

></td>
</tr>

<tr>


<td align=

"right"

colspan=

"2"

><input type=

"submit"

/></td>

</tr>
</table>

</form>
</body>

</html>

<h3 id="cas-side">CAS side</h3>
<p>Adapting only the views and introducing if-else statements there meant having logic that belongs to the controllers in the view. Therefore we decided to inject our add-on into the spring web flow. Here are the changes we have made to login-webflow.xml (changes highlighted in blue):
<a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen#" target="_blank">?</a>&lt;?xml version=</p>
<p>&quot;1.0&quot;</p>
<p>encoding=</p>
<p>&quot;UTF-8&quot;</p>
<p>?&gt;</p>
<flow xmlns=

"[http://www.springframework.org/schema/webflow"](http://www.springframework.org/schema/webflow)


xmlns:xsi=

"[http://www.w3.org/2001/XMLSchema-instance"](http://www.w3.org/2001/XMLSchema-instance)



xsi:schemaLocation="


http:

//www.springframework.org/schema/webflow



http:

//www.springframework.org/schema/webflow/spring-webflow-1.0.xsd">

<start-state idref="provideLoginTicketToRemoteRequestor" />

<action-state id="provideLoginTicketToRemoteRequestor">
<action bean="provideLoginTicketToRemoteRequestorAction" />
<transition on="loginTicketRequested" to="viewRedirectToRequestor" />
<transition on="continue" to="automaticCookiePathSetter" />
</action-state>

<view-state id="viewRedirectToRequestor" view="bmRedirectToRequestorView">
<transition on="submit" to="bindAndValidate" />
</view-state>
<a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen#" target="_blank">?</a><action-state id=

"automaticCookiePathSetter"

>



<action bean=

"automaticCookiePathSetterAction"

/>


<transition on=

"success"



to=

"ticketGrantingTicketExistsCheckAction"

/>


</action-state>




<action-state id=

"ticketGrantingTicketExistsCheckAction"

>



<action bean=

"ticketGrantingTicketExistsAction"

/>


<transition on=

"ticketGrantingTicketExists"



to=

"hasServiceCheck"

/>


<transition on=

"noTicketGrantingTicketExists"



to=

"gatewayRequestCheck"

/>


</action-state>




<action-state id=

"gatewayRequestCheck"

>



<action bean=

"gatewayRequestCheckAction"

/>


<transition on=

"gateway"

to=

"redirect"

/>



<transition on=

"authenticationRequired"

to=

"viewLoginForm"

/>


</action-state>




<action-state id=

"hasServiceCheck"

>



<action bean=

"hasServiceCheckAction"

/>


<transition on=

"authenticatedButNoService"



to=

"viewGenericLoginSuccess"

/>


<transition on=

"hasService"

to=

"renewRequestCheck"

/>



</action-state>




<action-state id=

"renewRequestCheck"

>


<action bean=

"renewRequestCheckAction"

/>



<transition on=

"authenticationRequired"

to=

"viewLoginForm"

/>


<transition on=

"generateServiceTicket"



to=

"generateServiceTicket"

/>


</action-state>




<!--



<action-state id=

"startAuthenticate"

>


<action bean=

"x509Check"

/>



<transition on=

"success"

to=

"sendTicketGrantingTicket"

/>


<transition on=

"error"

to=

"viewLoginForm"

/>



</action-state>


-->



<view-state id=

"viewLoginForm"

view=

"casLoginView"

>


<transition on=

"submit"

to=

"bindAndValidate"

/>



</view-state>




<action-state id=

"bindAndValidate"

>


<action bean=

"authenticationViaFormAction"

/>



<transition on=

"success"

to=

"submit"

/>


<transition on=

"error"

to=

"viewLoginForm"

/>



</action-state>




<action-state id=

"submit"

>


<action bean=

"authenticationViaFormAction"

method=

"submit"

/>



<transition on=

"warn"

to=

"warn"

/>


<transition on=

"success"

to=

"sendTicketGrantingTicket"

/>



<transition on=

"error"

to=

"viewLoginForm"

/>

<transition on="errorForRemoteRequestor" to="viewRedirectToRequestor" />
<a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen#" target="_blank">?</a></action-state>




<action-state id=

"sendTicketGrantingTicket"

>



<action bean=

"sendTicketGrantingTicketAction"

/>


<transition on=

"success"

to=

"serviceCheck"

/>



</action-state>




<action-state id=

"serviceCheck"

>


<action bean=

"hasServiceCheckAction"

/>



<transition on=

"authenticatedButNoService"


to=

"viewGenericLoginSuccess"

/>



<transition on=

"hasService"

to=

"generateServiceTicket"

/>


</action-state>




<action-state id=

"generateServiceTicket"

>



<action bean=

"generateServiceTicketAction"

/>


<transition on=

"success"

to=

"warn"

/>



<transition on=

"error"

to=

"viewLoginForm"

/>


<transition on=

"gateway"

to=

"redirect"

/>



</action-state>




<!--


The

"warn"

action makes the determination of whether to redirect directly to the requested



service or display the

"confirmation"

page to go back to the server.


-->



<action-state id=

"warn"

>


<action bean=

"warnAction"

/>



<transition on=

"redirect"

to=

"redirect"

/>


<transition on=

"warn"

to=

"showWarningView"

/>



</action-state>




<!--


the

"viewGenericLogin"

is the end state

for

when a user attempts to login without coming directly from a service.



They have only initialized their single-sign on session.


-->



<end-state id=

"viewGenericLoginSuccess"


view=

"casLoginGenericSuccessView"

/>






<!--


The

"showWarningView"

end state is the end state

for

when the user has requested privacy settings (to be

"warned"

) to be turned on.  It delegates to a



view defines in default_views.properties that display the

"Please click here to go to the service."

message.


-->



<end-state id=

"showWarningView"

view=

"casLoginConfirmView"

/>




<!--


The

"redirect"

end state allows CAS to properly end the workflow

while

still redirecting



the user back to the service required.


-->



<end-state id=

"redirect"


view=

"externalRedirect:${externalContext.requestParameterMap['service']}${requestScope.ticket == null ? '' : (externalContext.requestParameterMap['service'].indexOf('?') != -1 ? '&amp;' : '?') + 'ticket=' + requestScope.ticket}"

/>




<global-transitions>



<transition to=

"viewServiceErrorView"


on-exception=

"org.jasig.cas.services.UnauthorizedServiceException"

/>



</global-transitions>
</flow>

<h2 id="problems-encountered-and-suggested-solutions">Problems encountered and suggested solutions</h2>
<p>The solution works well, but it has a very dirty edge: introducing a new event in the submit method that allows us to distinguish between a login posting from the CAS Site and another site. Here we had to redeclare the <em>submit</em> method in <em>org.jasig.cas.web.flow.AuthenticationViaFormAction</em> (changes marked in blue):
<a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen#" target="_blank">?</a>[...]        </p>
<p>try</p>
<p>{</p>
<p>final</p>
<p>String ticketGrantingTicketId =</p>
<p>this</p>
<p>.centralAuthenticationService</p>
<p>.createTicketGrantingTicket(credentials);</p>
<p>ContextUtils.addAttribute(context,</p>
<p>AbstractLoginAction.REQUEST_ATTRIBUTE_TICKET_GRANTING_TICKET,</p>
<p>ticketGrantingTicketId);</p>
<p>setWarningCookie(response, warn);</p>
<p>return</p>
<p>success();</p>
<p>}</p>
<p>catch</p>
<p>(</p>
<p>final</p>
<p>TicketException e) {</p>
<p>populateErrorsInstance(context, e);</p>
<pre><code>        // START: ChangesBusinessMart: check, whether the posting has been sent from a remote server
        String myServerName = request.getLocalName();
        String referrer = request.getParameter(&quot;login-at&quot;);
        if (referrer != null &amp;&amp; referrer.indexOf(myServerName) == -1) {
            return result(&quot;errorForRemoteRequestor&quot;);
        }
</code></pre><p><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen#" target="_blank">?</a>return</p>
<p>error();</p>
<p>}
[...]</p>
<p> This could have been avoided by</p>
<ol>
<li>making this submit method overridable (non-final) to add new events in a derived class. Or</li>
<li>to make such a distinction of events in the standard CAS distribution.</li>
</ol>
<p>Maybe this can be accomplished somehow in future versions of CAS?</p>
<h2 id="listing-of-the-other-files-mentioned-in-this-solution">Listing of the other files mentioned in this solution</h2>
<p>provideLoginTicketToRemoteRequestorAction -&gt; introduces a new parameter get-lt to signal that a new login ticket shall be issued to the HTTP Referer:
<a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen#" target="_blank">?</a>package</p>
<p>de.businessmart.sso.cas.flow;</p>
<p>import</p>
<p>javax.servlet.http.HttpServletRequest;</p>
<p>import</p>
<p>javax.servlet.http.HttpServletResponse;</p>
<p>import</p>
<p>org.jasig.cas.web.flow.util.ContextUtils;
import</p>
<p>org.springframework.beans.factory.InitializingBean;</p>
<p>import</p>
<p>org.springframework.webflow.action.AbstractAction;
import</p>
<p>org.springframework.webflow.core.collection.MutableAttributeMap;</p>
<p>import</p>
<p>org.springframework.webflow.execution.Event;
import</p>
<p>org.springframework.webflow.execution.RequestContext;</p>
<p>import</p>
<p>de.businessmart.sso.cas.CasUtility;</p>
<p>//<em>/</em></p>
<p>/* Opens up the CAS web flow to allow external retrieval of a login ticket.</p>
<p>/* @author konrad.wulf</p>
<p>/*</p>
<p>/*/</p>
<p>public</p>
<p>class</p>
<p>ProvideLoginTicketToRemoteRequestorAction</p>
<p>extends</p>
<p>AbstractAction
{</p>
<p>@Override</p>
<p>protected</p>
<p>Event doExecute(RequestContext context)</p>
<p>throws</p>
<p>Exception</p>
<p>{</p>
<p>final</p>
<p>HttpServletRequest request = ContextUtils.getHttpServletRequest(context);</p>
<p>if</p>
<p>(request.getParameter(</p>
<p>&quot;get-lt&quot;</p>
<p>) !=</p>
<p>null</p>
<p>&amp;&amp; request.getParameter(</p>
<p>&quot;get-lt&quot;</p>
<p>).equalsIgnoreCase(</p>
<p>&quot;true&quot;</p>
<p>)) {</p>
<p>return</p>
<p>result(</p>
<p>&quot;loginTicketRequested&quot;</p>
<p>);</p>
<p>}</p>
<p>return</p>
<p>result(</p>
<p>&quot;continue&quot;</p>
<p>);</p>
<p>}</p>
<p>}</p>
<p>viewRedirectToRequestor actually does the redirects to the referrer:</p>
<p><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen#" target="_blank">?</a>&lt;%</p>
<p>@page</p>
<p>import</p>
<p>=</p>
<p>&quot;de.businessmart.sso.cas.CasUtility&quot;</p>
<p>%&gt;</p>
<p>&lt;%@ taglib prefix=</p>
<p>&quot;c&quot;</p>
<p>uri=</p>
<p>&quot;<a href="http://java.sun.com/jsp/jstl/core" target="_blank"><a href="http://java.sun.com/jsp/jstl/core">http://java.sun.com/jsp/jstl/core</a>&quot;</a></p>
<p>%&gt;
&lt;%@ taglib prefix=</p>
<p>&quot;spring&quot;</p>
<p>uri=</p>
<p>&quot;<a href="http://www.springframework.org/tags" target="_blank"><a href="http://www.springframework.org/tags">http://www.springframework.org/tags</a>&quot;</a></p>
<p>%&gt;</p>
<p>&lt;% String separator =</p>
<p>&quot;&quot;</p>
<p>;
String referrer = request.getHeader(</p>
<p>&quot;Referer&quot;</p>
<p>);</p>
<p>referrer = CasUtility.resetUrl(referrer);
if</p>
<p>(referrer !=</p>
<p>null</p>
<p>&amp;&amp; referrer.length() &gt;</p>
<p>0</p>
<p>) {</p>
<p>separator =(referrer.indexOf(</p>
<p>&quot;?&quot;</p>
<p>) &gt; -</p>
<p>1</p>
<p>)?</p>
<p>&quot;&amp;&quot;</p>
<p>:</p>
<p>&quot;?&quot;</p>
<p>; %&gt;</p>
<html>



<head>


<script>



var redirectURL =

&quot;&lt;%= referrer + separator %&gt;lt=${flowExecutionKey}&quot;

;


<spring:hasBindErrors name=

"credentials"

>



redirectURL +=

&#39;&amp;error_message=&#39;

+ encodeURIComponent (

&#39;<c:forEach var="error" items="${errors.allErrors}"><spring:message code="${error.code}" text="${error.defaultMessage}" /></c:forEach>&#39;

);


</spring:hasBindErrors>



window.location.href = redirectURL;


</script>



</head>


<body></body>

<p></html>&lt;%
}</p>
<p>else
{</p>
<p>out.print(</p>
<p>&quot;You better know what to do here.&quot;</p>
<p>);
} %&gt;</p>
<p>And for completeness, here is the CasUtility that removes obsolete parameters from the query string:
<a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen#" target="_blank">?</a>package</p>
<p>de.businessmart.sso.cas;</p>
<p>public</p>
<p>class</p>
<p>CasUtility {</p>
<p>//<em>/</em></p>
<p>/* Removes the previously attached GET parameters &quot;lt&quot; and &quot;error_message&quot; to be able to send new ones.</p>
<p>/* @param casUrl</p>
<p>/* @return</p>
<p>/*/</p>
<p>public</p>
<p>static</p>
<p>String resetUrl ( String casUrl) {</p>
<p>String cleanedUrl;</p>
<p>String[] paramsToBeRemoved =</p>
<p>new</p>
<p>String[]{</p>
<p>&quot;lt&quot;</p>
<p>,</p>
<p>&quot;error_message&quot;</p>
<p>,</p>
<p>&quot;get-lt&quot;</p>
<p>};</p>
<p>cleanedUrl = removeHttpGetParameters(casUrl, paramsToBeRemoved);</p>
<p>return</p>
<p>cleanedUrl;</p>
<p>}</p>
<p>//<em>/</em></p>
<p>/* Removes selected HTTP GET parameters from a given URL</p>
<p>/* @param casUrl</p>
<p>/* @param paramsToBeRemoved</p>
<p>/* @return</p>
<p>/*/</p>
<p>public</p>
<p>static</p>
<p>String removeHttpGetParameters (String casUrl, String[] paramsToBeRemoved) {</p>
<p>String cleanedUrl = casUrl;</p>
<p>if</p>
<p>(casUrl !=</p>
<p>null</p>
<p>)</p>
<p>{</p>
<p>// check if there is any query string at all</p>
<p>if</p>
<p>(casUrl.indexOf(</p>
<p>&quot;?&quot;</p>
<p>) == -</p>
<p>1</p>
<p>)</p>
<p>{</p>
<p>return</p>
<p>casUrl;</p>
<p>}</p>
<p>else</p>
<p>{</p>
<p>// determine the start and end position of the parameters to be removed</p>
<p>int</p>
<p>startPosition, endPosition;</p>
<p>boolean</p>
<p>containsOneOfTheUnwantedParams =</p>
<p>false</p>
<p>;</p>
<p>for</p>
<p>(String paramToBeErased : paramsToBeRemoved)</p>
<p>{</p>
<p>startPosition = -</p>
<p>1</p>
<p>;</p>
<p>endPosition = -</p>
<p>1</p>
<p>;</p>
<p>if</p>
<p>(cleanedUrl.indexOf(</p>
<p>&quot;?&quot;</p>
<ul>
<li>paramToBeErased +</li>
</ul>
<p>&quot;=&quot;</p>
<p>) &gt; -</p>
<p>1</p>
<p>)</p>
<p>{</p>
<p>startPosition = cleanedUrl.indexOf(</p>
<p>&quot;?&quot;</p>
<ul>
<li>paramToBeErased +</li>
</ul>
<p>&quot;=&quot;</p>
<p>) +</p>
<p>1</p>
<p>;</p>
<p>}</p>
<p>else</p>
<p>if</p>
<p>(cleanedUrl.indexOf(</p>
<p>&quot;&amp;&quot;</p>
<ul>
<li>paramToBeErased +</li>
</ul>
<p>&quot;=&quot;</p>
<p>) &gt; -</p>
<p>1</p>
<p>)</p>
<p>{</p>
<p>startPosition = cleanedUrl.indexOf(</p>
<p>&quot;&amp;&quot;</p>
<ul>
<li>paramToBeErased +</li>
</ul>
<p>&quot;=&quot;</p>
<p>) +</p>
<p>1</p>
<p>;</p>
<p>}</p>
<p>if</p>
<p>(startPosition &gt; -</p>
<p>1</p>
<p>)</p>
<p>{</p>
<p>int</p>
<p>temp = cleanedUrl.indexOf(</p>
<p>&quot;&amp;&quot;</p>
<p>, startPosition);</p>
<p>endPosition = (temp &gt; -</p>
<p>1</p>
<p>) ? temp +</p>
<p>1</p>
<p>: cleanedUrl</p>
<p>.length();</p>
<p>// remove that parameter, leaving the rest untouched</p>
<p>cleanedUrl = cleanedUrl.substring(</p>
<p>0</p>
<p>, startPosition)</p>
<ul>
<li>cleanedUrl.substring(endPosition);</li>
</ul>
<p>containsOneOfTheUnwantedParams =</p>
<p>true</p>
<p>;</p>
<p>}</p>
<p>}</p>
<p>// wenn nur noch das Fragezeichen vom query string übrig oder am schluss ein &quot;&amp;&quot;, dann auch dieses entfernen</p>
<p>if</p>
<p>(cleanedUrl.endsWith(</p>
<p>&quot;?&quot;</p>
<p>) || cleanedUrl.endsWith(</p>
<p>&quot;&amp;&quot;</p>
<p>))</p>
<p>{</p>
<p>cleanedUrl = cleanedUrl.substring(</p>
<p>0</p>
<p>,</p>
<p>cleanedUrl.length() -</p>
<p>1</p>
<p>);</p>
<p>}</p>
<p>// erst zurückgeben, wenn wir auch überprüft haben, ob nicht ein parameter mehrfach angegeben wurde...</p>
<p>if</p>
<p>(!containsOneOfTheUnwantedParams)</p>
<p>return</p>
<p>casUrl;</p>
<p>else</p>
<p>cleanedUrl = removeHttpGetParameters(cleanedUrl, paramsToBeRemoved);</p>
<p>}</p>
<p>}</p>
<p>return</p>
<p>cleanedUrl;</p>
<p>}</p>
<p>}
Labels:</p>
<p>None</p>
<p><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen#" title="Edit Labels ( Type &#39;l" target="_blank">Edit Labels</a>&quot;)</p>
<h2 id="-8-comments-https-wiki-jasig-org-display-cas-using-cas-without-the-login-screen-"><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen#" target="_blank">8 Comments</a></h2>
<p><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen#" title="Hide/Show Comments" target="_blank">Hide/Show Comments</a></p>
<ol>
<li><img src="&quot;battags&quot;" alt="User icon: battags"></li>
</ol>
<p>Apr 25, 2007</p>
<h3 id="-scott-battaglia-https-wiki-jasig-org-display-battags-"><a href="https://wiki.jasig.org/display/~battags" target="_blank">Scott Battaglia</a></h3>
<p>The IFRAME method actually does work. As stated in emails on the CAS developer&#39;s list, it requires replacing the default view with a JavaScript redirect view.</p>
<p>This allows the following:
(a) errors will continue to be displayed correctly (in the iframe)
(b) redirects the browser correctly
(c) usernames and passwords are never collected on the client application</p>
<ul>
<li><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen?focusedCommentId=3604556#comment-3604556" title="Permanent link to this comment" target="_blank">Permalink</a></li>
<li><img src="&quot;albert4cas&quot;" alt="User icon: albert4cas"></li>
</ul>
<p>Jul 09, 2007</p>
<h3 id="-alberto-mozzone-https-wiki-jasig-org-display-albert4cas-"><a href="https://wiki.jasig.org/display/~albert4cas" target="_blank">Alberto Mozzone</a></h3>
<p>Hi there,
I made the changes described here, but I&#39;m stuck with these problems:</p>
<ul>
<li>Where the file &quot;viewRedirectToRequestor.jsp&quot; must be placed ?</li>
<li>There isn&#39;t the definition of bean with class &quot;ProvideLoginTicketToRemoteRequestorAction&quot; in &quot;applicationContext.xml&quot;.</li>
<li>After adding it, I get the exception:</li>
</ul>
<p>2007-07-09 17:08:18,773 ERROR [org.apache.catalina.core.ContainerBase.[Catalina].[auth.domain.com].[/].[cas]] - Servlet.service() for servlet cas threw exception
java.lang.InstantiationException
    at sun.reflect.InstantiationExceptionConstructorAccessorImpl.newInstance(InstantiationExceptionConstructorAccessorImpl.java:30)</p>
<p>And CAS shows its generic exception page &quot;CAS is unavailable&quot;.</p>
<p>Where am I wrong ?</p>
<p>Somebody can help, please ?</p>
<p>Thanks in advance.</p>
<p>Alberto</p>
<ul>
<li><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen?focusedCommentId=6619787#comment-6619787" title="Permanent link to this comment" target="_blank">Permalink</a></li>
<li><img src="&quot;netstokedev@gmail.com&quot;" alt="User icon: netstokedev@gmail.com"></li>
</ul>
<p>Dec 07, 2007</p>
<h3 id="-kevin-mckee-https-wiki-jasig-org-display-netstokedev-gmail-com-"><a href="https://wiki.jasig.org/display/~netstokedev@gmail.com" target="_blank">Kevin McKee</a></h3>
<p>A much simpler and elegant version is to not deal with getting a login ticket at all and to simply auto submit the CAS form via Javascript if a param such as &#39;auto&#39; is submitted to the login form along with the service, username, and password parameters.</p>
<p>Example of casLoginView.jsp:
<a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen#" target="_blank">?</a> &lt;%</p>
<p>// If we recieve the &#39;auto&#39; parameter as &#39;true&#39; we attempt to
// auto populate the form from the request variables and submit it</p>
<p>String auto = request.getParameter(</p>
<p>&quot;auto&quot;</p>
<p>);
if</p>
<p>(auto !=</p>
<p>null</p>
<p>&amp;&amp; auto.equals(</p>
<p>&quot;true&quot;</p>
<p>)) {</p>
<p>%&gt;</p>
<script language=

"javascript"

>

 function doAutoLogin() {
  document.forms[

0

].username.value =

'<%=request.getParameter("username")%>'

;

  document.forms[

0

].password.value =

'<%=request.getParameter("password")%>'

;
  document.forms[

0

].submit();

 }


// Add the auto login function to the onload event

 addLoadEvent(doAutoLogin);
</script>

<p>&lt;% 
}</p>
<p>%&gt;    </p>
<p>No fuss, no muss. CAS will then redirect back to your service url with a ticket that is ready to be validated. This comes in really handy if you are doing something like creating users in your system and then auto logging them in after the creation process.</p>
<p>I know purists will hate the fact that we put a scriptlet in there (i&#39;m not too wild about it either), but it is alot easier than all the redirects involved for grabbing a login ticket just to submit credentials.</p>
<p>Just a note, you will also want to change the name of the submit button from &#39;submit&#39; or else Javascript will have a fit. Hope this helps.</p>
<ul>
<li><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen?focusedCommentId=8716750#comment-8716750" title="Permanent link to this comment" target="_blank">Permalink</a></li>
<li><img src="&quot;jacomac&quot;" alt="User icon: jacomac"></li>
</ul>
<p>Jun 06, 2008</p>
<h3 id="-konrad-wulf-https-wiki-jasig-org-display-jacomac-"><a href="https://wiki.jasig.org/display/~jacomac" target="_blank">Konrad Wulf</a></h3>
<p>Here&#39;s a tardy response to Alberto Mozzone&#39;s post. Sorry for not having answered any earlier. But better late than never <img src="" alt="(wink)"> It still seems to be of interest:</p>
<p>I have forgotten to mention in this article that the view bmRedirectToRequestorView needs to be defined in the default_views.properties file, which is located at &quot;/WEB-INF/classes&quot;. The following entries need to be added there:</p>
<p>/#/#/# Redirect with login ticket view
bmRedirectToRequestorView.(class)=org.springframework.web.servlet.view.JstlView
bmRedirectToRequestorView.url=/WEB-INF/view/jsp/default/ui/bmRedirectToRequestorView.jsp</p>
<p>Moreover, Alberto was also quite right that the bean &quot;provideLoginTicketToRemoteRequestorAction&quot; has to be defined somewhere. I did that in /WEB-INF/cas-servlet.xml:</p>
<p>id=&quot;provideLoginTicketToRemoteRequestorAction&quot;
class=&quot;de.businessmart.sso.cas.flow.ProvideLoginTicketToRemoteRequestorAction&quot; /&gt;</p>
<p>With these 2 little additions the solution description should be complete.</p>
<ul>
<li><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen?focusedCommentId=13570147#comment-13570147" title="Permanent link to this comment" target="_blank">Permalink</a></li>
<li><img src="&quot;gauravsaxena&quot;" alt="User icon: gauravsaxena"></li>
</ul>
<p>Oct 13, 2010</p>
<h3 id="-gaurav-saxena-https-wiki-jasig-org-display-gauravsaxena-"><a href="https://wiki.jasig.org/display/~gauravsaxena" target="_blank">gaurav saxena</a></h3>
<p>Hi,</p>
<p>This was a nice article. But i need to do the same with that latest version of CAS i.e. 3.4 . Can you please provide me the steps for the same. Atleast the stucture for login-webflow.xml as it is now using spring-webflow-2.0.xsd .</p>
<p>Thanks in advance.</p>
<p>Gaurav Saxena</p>
<ul>
<li><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen?focusedCommentId=37946049#comment-37946049" title="Permanent link to this comment" target="_blank">Permalink</a></li>
</ul>
<ol>
<li><img src="&quot;eholderman&quot;" alt="User icon: eholderman"></li>
</ol>
<p>Feb 02, 2011</p>
<h3 id="-ed-holderman-https-wiki-jasig-org-display-eholderman-"><a href="https://wiki.jasig.org/display/~eholderman" target="_blank">Ed Holderman</a></h3>
<p>I have the same question.  Does anyone have any tips on doing this in CAS 3.4.x and is there now a different way of accomplishing it with the new version?  My end goal is to alter the Liferay login portlet to submit credentials to CAS over https.  Out of the box IFrame portlets would hard code the service URL, breaking deep link capabilities.  Thank you - Ed</p>
<ul>
<li><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen?focusedCommentId=39813346#comment-39813346" title="Permanent link to this comment" target="_blank">Permalink</a></li>
<li><img src="&quot;rdemuth&quot;" alt="User icon: rdemuth"></li>
</ul>
<p>Jun 13, 2011</p>
<h3 id="-robert-demuth-https-wiki-jasig-org-display-rdemuth-"><a href="https://wiki.jasig.org/display/~rdemuth" target="_blank">Robert DeMuth</a></h3>
<p>Looking to do the same thing in CAS 3.4.6 (using the Maven2 overlay method).  It looks like login-webflow.xml has changed dramatically since this page was created.</p>
<ul>
<li><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen?focusedCommentId=46137905#comment-46137905" title="Permanent link to this comment" target="_blank">Permalink</a></li>
</ul>
<ol>
<li><img src="&quot;patino@fordham.edu&quot;" alt="User icon: patino@fordham.edu"></li>
</ol>
<p>Oct 17, 2011</p>
<h3 id="-jpats-https-wiki-jasig-org-display-patino-fordham-edu-"><a href="https://wiki.jasig.org/display/~patino@fordham.edu" target="_blank">jpats</a></h3>
<p>Hi, I just want to find out if you were able to have this working. If you did, really would like to find out how you did it. Thanks in advance.</p>
<ul>
<li><p><a href="https://wiki.jasig.org/display/CAS/Using+CAS+without+the+Login+Screen?focusedCommentId=50857235#comment-50857235" title="Permanent link to this comment" target="_blank">Permalink</a>
Powered by a free <strong>Atlassian Confluence Open Source Project License</strong> granted to Java Architectures Special Interest Group. <a href="http://www.atlassian.com/c/conf/11461" target="_blank">Evaluate Confluence today</a>.
This Confluence installation runs a Free Gliffy License - <a href="http://www.gliffy.com/products/confluence-plugin/" target="_blank">Evaluate Gliffy</a> for your Wiki!</p>
</li>
<li><p>Powered by <a href="http://www.atlassian.com/software/confluence" target="_blank">Atlassian Confluence</a> 4.1.5, the <a href="http://www.atlassian.com/software/confluence/tour/enterprise-wiki.jsp" target="_blank">Enterprise Wiki</a></p>
</li>
<li>Printed by Atlassian Confluence 4.1.5, the Enterprise Wiki.</li>
<li>·  <a href="http://jira.atlassian.com/secure/BrowseProject.jspa?id=10470" target="_blank">Report a bug</a></li>
<li>·  <a href="http://www.atlassian.com/about/connected.jsp?s_kwcid=Confluence-stayintouch" target="_blank">Atlassian News</a></li>
</ul>
<p><a href=""></a><a href=""></a><a href=""></a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/CAS/">CAS</a></li></span><span class="breadcrumb"><li><a href="/categories/CAS/">CAS</a></li><li><a href="/categories/CAS/without+cas+login+screen/">without+cas+login+screen</a></li></span></span> | <span class="tags">Tagged <a href="/tags/CAS/" class="label label-primary">CAS</a><a href="/tags/without+cas+login+screen/" class="label label-success">without+cas+login+screen</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:39"datetime="2014-03-07 09:54:39"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-CAS-withoutcasloginscreen--UsingCASwithouttheLoginScreen-CentralAuthe/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-CAS-withoutcasloginscreen--UsingCASwithouttheLoginScreen-CentralAuthe" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-安全-无线--BlackHat专题PwnieAwards2012奖项提名-FreebuFCOM/">[BlackHat专题]PwnieAwards 2012奖项提名</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:39.000Z"> <a href="/2014/02/02/2014-02-02-安全-无线--BlackHat专题PwnieAwards2012奖项提名-FreebuFCOM/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-blackhat-pwnieawards-2012-freebuf-com">[BlackHat专题]PwnieAwards 2012奖项提名- FreebuF.COM</h1>
<ul>
<li><a href="http://www.freebuf.com/" target="_blank">首页</a></li>
<li><a href="http://www.freebuf.com/category/news" target="_blank">资讯</a></li>
<li><a href="http://www.freebuf.com/category/tools" target="_blank">工具</a></li>
<li><p><a href="http://www.freebuf.com/category/articles" target="_blank">文章</a></p>
</li>
<li><p><a href="http://www.freebuf.com/category/articles/web" target="_blank">WEB安全</a></p>
</li>
<li><a href="http://www.freebuf.com/category/articles/wireless" target="_blank">无线安全</a></li>
<li><a href="http://www.freebuf.com/category/articles/system" target="_blank">系统安全</a></li>
<li><a href="http://www.freebuf.com/category/articles/database" target="_blank">数据库安全</a></li>
<li><a href="http://www.freebuf.com/category/articles/terminal" target="_blank">终端安全</a></li>
<li><a href="http://www.freebuf.com/category/articles/others-articles" target="_blank">其他</a></li>
<li><a href="http://www.freebuf.com/category/vuls" target="_blank">漏洞</a></li>
<li><a href="http://www.freebuf.com/category/jobs" target="_blank">招聘</a></li>
<li><a href="http://www.freebuf.com/category/others" target="_blank">周边</a></li>
<li><a href="http://plant.freebuf.com/" target="_blank">聚合</a></li>
<li><a href="http://club.freebuf.com/" target="_blank">社区</a></li>
<li><img src="" alt=""><a href="http://www.freebuf.com/newsend" target="_blank">投稿</a></li>
</ul>
<p><a href="http://www.freebuf.com/wp-login.php?redirect_to=http%3A%2F%2Fwww.freebuf.com%2Fnews%2Fblackhat-news%2F5088.html" title="登陆" target="_blank">登陆</a><a href="http://www.freebuf.com/wp-login.php?action=register" target="_blank">注册</a></p>
<p><a href="http://www.freebuf.com/" target="_blank"><img src="" alt="freebuf"></a></p>
<p><a href="http://www.weibo.com/freebuf" title="收听新浪微博" target="_blank">新浪微博</a> <a href="http://t.qq.com/freebuf" title="收听腾讯微博" target="_blank">腾讯微博</a><a href="http://www.freebuf.com/feed" title="订阅我们" target="_blank">订阅我们</a></p>
<h3 id="-blackhat-pwnieawards-2012-">[BlackHat专题]PwnieAwards 2012奖项提名</h3>
<p><a href="http://www.freebuf.com/news/blackhat-news/5088.html#" target="_blank"></a><a href="http://www.freebuf.com/author/jly12" title="由 jly@12 发布">jly@12</a> @ <a href="http://www.freebuf.com/category/news/blackhat-news" title="查看 Black Hat专题 中的全部文章" target="_blank">Black Hat专题</a> 2012-07-25 共 <strong>2441</strong> 人围观 </p>
<h1 id="-the-pwnie-award-http-pwnies-com-blackhat-usa-http-www-blackhat-com-usa-">第六届<a href="http://pwnies.com/" target="_blank">The Pwnie Award</a>将在<a href="http://www.blackhat.com/usa/" target="_blank">BlackHat USA</a>会议上公布最终结果。</h1>
<p>In the 2012 edition 奖项共9大类:</p>
<p>Pwnie for Best Server-Side Bug 最佳服务端漏洞 Pwnie for Best Client-Side Bug 最佳客户端漏洞 Pwnie for Best Privilege Escalation Bug 最佳提权漏洞 Pwnie for Most Innovative Research 最具创新价值研究 Pwnie for Lamest Vendor Response 最烂回应厂商 Pwnie for Best Song 最佳歌曲 Pwnie for Most Epic FAIL 最测漏失败奖 Pwnie for Epic Ownage 最霸气成功奖</p>
<p><strong>获得提名的有以下漏洞：</strong></p>
<h3 id="pwnie-for-best-server-side-bug-">Pwnie for Best Server-Side Bug 最佳服务端漏洞</h3>
<p>纵观所有奖项，我的票投给了WordPress Timthumb 插件 ‘timthumb’ 缓存目录任意文件上传漏洞，因为这个漏洞的传播及最终影响面非常之大。</p>
<p><strong>oracle Database Server ‘TNS Listener’远程数据投毒漏洞 (CVE-2012-1675)</strong>
Oracle Database Server在实现上存在可允许攻击者向远程“TNS Listener”组件处理的数据投毒的漏洞。攻击者可利用此漏洞将数据库服务器的合法“TNS Listener”组件中的数据转向到攻击者控制的系统，导致控制远程组件的数据库实例，造成组件和合法数据库之间的攻击者攻击、会话劫持或拒绝服务攻击。
此漏洞由Joxean Koret在2008年发现，甲骨文公司在4月发布声明称该漏洞已修复，但是Joxean Koret随后释放的漏洞细节，证明该漏洞并未修复。</p>
<p><strong>ProFTPD响应池释放后重用代码执行漏洞 (</strong><a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-4130" target="_blank"><strong>CVE-2011-4130</strong></a><strong>)</strong>
ProFTPD 1.3.3g之前版本的Response API中存在释放后使用漏洞。远程认证用户可借助包含FTP数据传输错误的向量执行任意代码。</p>
<p><strong>Mysql认证绕过漏洞(</strong><a href="http://eromang.zataz.com/2012/06/12/cve-2012-2122-oracle-mysql-authentication-bypass-password-dump-metasploit-demo/" target="_blank"><strong>CVE-2012-2122</strong></a><strong>)</strong>
MariaDB 5.1.62, 5.2.12、5.3.6、5.5.23之前版本和MySQL 5.1.63、5.5.24、5.6.6之前版本在用户验证的处理上存在安全漏洞，可能导致攻击者无需知道正确口令就能登录到MySQL服务器。
用户连接到MariaDB/MySQL后，应用会计算和比较令牌值，由于错误的转换，即使memcmp()返回非零值，也可能出现错误的比较，造成MySQL/MariaDB误认为密码是正确的，因为协议使用的是随机字符串，该Bug发生的几率为1/256。MySQL的版本是否受影响取决于程序的编译方式，很多版本（包括官方提供的二进制文件）并不受此漏洞的影响。
该漏洞相信大家已经很熟悉了，<strong>之前freebuf**</strong>也详细报道过**，详见<a href="http://www.freebuf.com/vuls/3815.html" target="_blank">地址</a></p>
<p><strong>WordPress缩略图插件Timthumb缓存目录任意文件上传漏洞(CVE-2011-4106)</strong>
WordPress Timthumb提供的Timthumb.php不正确处理$allowedSites变量，提交特殊的主机名可上传和执行timthumb缓存目录中的任意PHP代码。该漏洞是2011年8月份左右披露出来的，当时影响面非常广，几百万的wp站点被黑，而利用起来也非常简单。在第三方网站上写上一句话木马，然后提交的url里面包含该地址就可以了，成功利用之后会将该木马下载到缓存目录。</p>
<p><strong>Pinkie Pie’s Pwnium Exploit</strong></p>
<p>在2012年的3月份的Pwnium黑客大赛结束前的几个小时，一位名叫Pinkie Pie的小伙子赢得了为发现Chrome漏洞而设立的60000美金的奖金。他一口气利用三个不同的0day写出的exp成功打破了Chrome Sandbox的神话。在这之后，谷歌几乎立即发布了Chrome稳定更新版以解决这一问题。 据Wired报道，发现Chrome漏洞的Pinkie Pie并不想透露自己的名字，因为他的老板并不支持他的这一活动。</p>
<p><strong>Sergey Glazunov’s Pwnium Exploit (</strong><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3046" target="_blank"><strong>CVE-2011-3046</strong></a><strong>)</strong>
Sergey Glazunov也是在2012年的Pwnium黑客大赛中发现了chrome的至少14个bug，可以成功绕过沙盒机制来执行任意代码。</p>
<p><a href="http://blog.chromium.org/2012/06/tale-of-two-pwnies-part-2.html"></a></p>
<p><strong>MS11-087: 未知win32k.sys驱动TrueType字体解析引擎漏洞(CVE 2011-3402)</strong>
CVE 2011-3402，2011年12月MS11-087中已提供了补丁，Duqu恶意软件广泛地利用此漏洞。</p>
<p><strong>Flash BitmapData.histogram()信息泄露 (CVE 2012-0769)</strong>
Google安全小组Fermin J. Serna 发现了CVE 2012-0769漏洞，并在APSB12-05中修复了此漏洞。</p>
<p><strong>iOS绕过代码签名漏洞(CVE 2011-3442)</strong>
Accuvant实验室的Charlie Miller发现了该漏洞，并在iOS 5.0.1版本中修复了此漏洞。
该漏洞是一个绕过代码签名漏洞，第三方可在动态加载，执行代码及流氓软件中利用此漏洞。</p>
<p><strong>Pwnie for Best Privilege Escalation Bug**</strong>最佳提权漏洞**</p>
<p>我将投票给“Xen Intel x64 SYSRET指令权限提升漏洞”，因为该漏洞同时敲响了产品和供应商的警钟。</p>
<p><strong>Xen Intel x64 SYSRET指令权限提升漏洞(CVE-2012-0217)</strong>
Rafal Wojtczuk发现了此漏洞并报给了厂商。成功地验证了<a href="http://fail0verflow.com/blog/2012/cve-2012-0217-intel-sysret-freebsd.html" target="_blank">fail0verflow</a>在2012-07-05日提供的该漏洞。
点击这儿是该攻击的验证视频。</p>
<p><strong>iOS HFS目录文件整型溢出漏洞(</strong><a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0642" target="_blank"><strong>CVE-2012-0642</strong></a><strong>)</strong>
pod2g发现了此漏洞，在Absinthe iOS 5.0/5.0.1存在此漏洞。</p>
<p><strong>MS11-098: Windows内核异常处理漏洞(</strong><a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2018" target="_blank"><strong>CVE-2011-2018</strong></a><strong>)</strong>
 CVE-2011-2018, <a href="http://technet.microsoft.com/en-us/security/bulletin/ms11-098" target="_blank">MS11-098</a>中已提供了补丁，Mateusz “j00ru” Jurczyk发现了此漏洞并报告给厂商。</p>
<p><strong>VMware高带宽后门ROM重写权限提升漏洞(</strong><a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-1515" target="_blank"><strong>CVE-2012-1515</strong></a><strong>)</strong>
<a href="http://technet.microsoft.com/en-us/security/bulletin/ms12-042" target="_blank">CVE-2012-1515</a>, MS12-042和VMSA-2012-0006.2中已提供补丁，Derek Soeder发现了此漏洞并报告给厂商。</p>
<p><a href="http://technet.microsoft.com/en-us/security/bulletin/ms12-042"></a></p>
<h3 id="-freebuf-com-http-www-freebuf-com-"><img src="" alt=""> <strong>版权声明：转载请注明出自:</strong> <a href="http://www.freebuf.com/" target="_blank">FreebuF.COM</a></h3>
<ul>
<li><a href="">赞: 3</a></li>
<li><p><a href="">踩: 0</a>
您已评价！</p>
<p>分享到： <a href="http://v.t.sina.com.cn/share/share.php?url=http://www.freebuf.com/news/blackhat-news/5088.html&amp;title=[BlackHat%E4%B8%93%E9%A2%98]PwnieAwards%202012%E5%A5%96%E9%A1%B9%E6%8F%90%E5%90%8D" title="分享到新浪微博" target="_blank">新浪微博</a> <a href="http://v.t.qq.com/share/share.php?url=http://www.freebuf.com/news/blackhat-news/5088.html&amp;title=[BlackHat%E4%B8%93%E9%A2%98]PwnieAwards%202012%E5%A5%96%E9%A1%B9%E6%8F%90%E5%90%8D" title="分享到腾讯微博" target="_blank">腾讯微博</a> <a href="&quot;分享到豆瓣&quot;">豆瓣</a> <a href="http://share.renren.com/share/buttonshare.do?link=http://www.freebuf.com/news/blackhat-news/5088.html&amp;title=[BlackHat%E4%B8%93%E9%A2%98]PwnieAwards%202012%E5%A5%96%E9%A1%B9%E6%8F%90%E5%90%8D" title="分享到人人网" target="_blank">人人网</a> <a href="http://www.kaixin001.com/repaste/share.php?rtitle=[BlackHat%E4%B8%93%E9%A2%98]PwnieAwards%202012%E5%A5%96%E9%A1%B9%E6%8F%90%E5%90%8D&amp;rurl=http://www.freebuf.com/news/blackhat-news/5088.html%20title=" target="_blank">开心网</a> <a href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://www.freebuf.com/news/blackhat-news/5088.html&amp;title=[BlackHat%E4%B8%93%E9%A2%98]PwnieAwards%202012%E5%A5%96%E9%A1%B9%E6%8F%90%E5%90%8D" title="分享到QQ空间" target="_blank">QZone</a> <a href="http://facebook.com/share.php?u=http://www.freebuf.com/news/blackhat-news/5088.html&amp;title=[BlackHat%E4%B8%93%E9%A2%98]PwnieAwards%202012%E5%A5%96%E9%A1%B9%E6%8F%90%E5%90%8D" title="分享到facebook" target="_blank">facebook</a> <a href="http://twitter.com/share?url==http://www.freebuf.com/news/blackhat-news/5088.html&amp;title=[BlackHat%E4%B8%93%E9%A2%98]PwnieAwards%202012%E5%A5%96%E9%A1%B9%E6%8F%90%E5%90%8D" title="分享到twitter" target="_blank">twitter</a></p>
</li>
</ul>
<h3 id="-">相关文章</h3>
<ul>
<li><a href="http://www.freebuf.com/news/blackhat-news/5266.html" target="_blank">BlackHat大会后的WLAN统计报告</a></li>
</ul>
<p><strong>4</strong>条评论 <strong>1052</strong>人已围观</p>
<ul>
<li><a href="http://www.freebuf.com/tools/5246.html" target="_blank">[BlackHat2012工具]Google Hacking Diggity工具集</a></li>
</ul>
<p><strong>4</strong>条评论 <strong>1646</strong>人已围观</p>
<ul>
<li><a href="http://www.freebuf.com/news/blackhat-news/5233.html" target="_blank">传P0sixninja在黑帽大会上出售了越狱漏洞</a></li>
</ul>
<p><strong>1</strong>条评论 <strong>1236</strong>人已围观</p>
<ul>
<li><a href="http://www.freebuf.com/news/blackhat-news/5149.html" target="_blank">GPS缺陷可让黑客跟踪智能手机用户，甚至完全接管移动设备</a></li>
</ul>
<p><strong>1</strong>条评论 <strong>1310</strong>人已围观</p>
<ul>
<li><a href="http://www.freebuf.com/news/blackhat-news/5097.html" target="_blank">[7月27日]BlackHat精彩内涵图集（每日更新）</a></li>
</ul>
<p><strong>10</strong>条评论 <strong>3116</strong>人已围观
﻿</p>
<h2 id="4-comments-http-www-freebuf-com-news-blackhat-news-5088-html-respond-">4 Comments <a href="http://www.freebuf.com/news/blackhat-news/5088.html#respond" target="_blank">发表评论</a></h2>
<ol>
<li><img src="" alt=""> phper <a href="http://www.freebuf.com/news/blackhat-news/5088.html#comment-1532"></a> 2012-07-25</li>
</ol>
<p>最测漏失败奖。。神级翻译。。
<a href="">支持</a>(3)<a href="">反对</a> (0)
<a href="http://www.freebuf.com/news/blackhat-news/5088.html?replytocom=1532#respond" target="_blank">回复</a></p>
<ol>
<li><img src="" alt=""> purpose <a href="http://www.freebuf.com/news/blackhat-news/5088.html#comment-1534"></a> 2012-07-25</li>
</ol>
<p>去年靠Timthumb这个漏洞收获了不少鸡 <img src="" alt=":lol:">
<a href="">支持</a>(1)<a href="">反对</a> (0)
<a href="http://www.freebuf.com/news/blackhat-news/5088.html?replytocom=1534#respond" target="_blank">回复</a></p>
<ol>
<li><a href="http://www.freebuf.com/?author=4" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/?author=4" target="_blank">thanks </a><img src="&quot;核心成员&quot;" alt=""> (6级) 手提酱油瓶从天而降 <a href="http://www.freebuf.com/news/blackhat-news/5088.html#comment-1536"></a> 2012-07-25</li>
</ol>
<p><img src="" alt=":cool:"> jly@12翻译辛苦了
<a href="">支持</a>(1)<a href="">反对</a> (0)
<a href="http://www.freebuf.com/news/blackhat-news/5088.html?replytocom=1536#respond" target="_blank">回复</a></p>
<ol>
<li><a href="http://www.freebuf.com/?author=131" target="_blank"><img src="" alt=""></a> <a href="http://www.freebuf.com/?author=131" target="_blank">Crow </a><img src="&quot;核心成员&quot;" alt=""> (5级)  <a href="http://www.freebuf.com/news/blackhat-news/5088.html#comment-1549"></a> 2012-07-26</li>
</ol>
<p>Pwnie for Most Epic FAIL 最测漏失败奖 <img src="" alt=":mrgreen:">
<a href="">支持</a>(0)<a href="">反对</a> (0)
<a href="http://www.freebuf.com/news/blackhat-news/5088.html?replytocom=1549#respond" target="_blank">回复</a>
昵称
(必须)您当前尚未登录。<a href="http://www.freebuf.com/wp-login.php?redirect_to=http%3A%2F%2Fwww.freebuf.com%2Fnews%2Fblackhat-news%2F5088.html" title="登陆" target="_blank">登陆</a>？注册</p>
<p>邮箱
必须(保密)
网址</p>
<p>发表言论前，请滑动滚动条解锁
<a href="">表情</a><a href="">插代码</a><a href="">粗体</a><a href="">斜体</a><a href="">删除线</a><a href="">下划线</a><a href="">引用</a><a href="">链接</a><a href="">插图</a></p>
<p><a href="&quot;mrgreen&quot;"><img src="" alt=""></a><a href="&quot;razz&quot;"><img src="" alt=""></a><a href="&quot;sad&quot;"><img src="" alt=""></a><a href="&quot;smile&quot;"><img src="" alt=""></a><a href="&quot;oops&quot;"><img src="" alt=""></a><a href="&quot;grin&quot;"><img src="" alt=""></a><a href="&quot;eek&quot;"><img src="" alt=""></a><a href="&quot;???&quot;"><img src="" alt=""></a><a href="&quot;cool&quot;"><img src="" alt=""></a><a href="&quot;lol&quot;"><img src="" alt=""></a><a href="&quot;mad&quot;"><img src="" alt=""></a><a href="&quot;twisted&quot;"><img src="" alt=""></a><a href="&quot;roll&quot;"><img src="" alt=""></a><a href="&quot;wink&quot;"><img src="" alt=""></a><a href="&quot;idea&quot;"><img src="" alt=""></a><a href="&quot;arrow&quot;"><img src="" alt=""></a><a href="&quot;neutral&quot;"><img src="" alt=""></a><a href="&quot;cry&quot;"><img src="" alt=""></a><a href="&quot;?&quot;"><img src="" alt=""></a><a href="&quot;evil&quot;"><img src="" alt=""></a><a href="&quot;shock&quot;"><img src="" alt=""></a><a href="&quot;!&quot;"><img src="" alt=""></a>
正在提交, 请稍候...</p>
<p>/#</p>
<p><a href="">取消</a>   有人回复时邮件通知我</p>
<h3 id="-hot-comments-"><strong>热门评论**</strong>Hot Comments**</h3>
<p><a href="http://www.freebuf.com/news/blackhat-news/5088.html#comment-1532" target="_blank">phper</a> @ 2012-07-25 17:29:18</p>
<p>最测漏失败奖。。神级翻译。。
<a href="">支持</a> (3) <a href="">反对</a> (0) <a href="http://www.freebuf.com/news/blackhat-news/5088.html#comment-1534" target="_blank">purpose</a> @ 2012-07-25 17:34:07</p>
<p>去年靠Timthumb这个漏洞收获了不少鸡 <img src="" alt=":lol:">
<a href="">支持</a> (1) <a href="">反对</a> (0) <a href="http://www.freebuf.com/news/blackhat-news/5088.html#comment-1536" target="_blank">thanks</a> @ 2012-07-25 19:17:12</p>
<p><img src="" alt=":cool:"> jly@12翻译辛苦了
<a href="">支持</a> (1) <a href="">反对</a> (0)</p>
<h3 id="-new-posts-"><strong>最新发布**</strong>New Posts**</h3>
<ul>
<li><a href="http://www.freebuf.com/articles/web/5373.html" title="QQ漂流瓶飘来的可能是愿望，也有可能是XSS！" target="_blank">QQ漂流瓶飘来的可能是愿望，也有可能是XSS！</a></li>
<li><a href="http://www.freebuf.com/news/5378.html" title="卡巴斯基寻民间牛人帮助破解高斯(Gauss)神秘Payload" target="_blank">卡巴斯基寻民间牛人帮助破解高斯(Gauss)神秘Payload</a></li>
<li><a href="http://www.freebuf.com/tools/5369.html" title="盲注（Blind SQL Injection）工具—BBQSQL v1.0.0" target="_blank">盲注（Blind SQL Injection）工具—BBQSQL v1.0.0</a></li>
<li><a href="http://www.freebuf.com/news/5364.html" title="计算机内存在关机后仍会泄露信息" target="_blank">计算机内存在关机后仍会泄露信息</a></li>
<li><a href="http://www.freebuf.com/tools/5361.html" title="34款Firefox渗透测试插件" target="_blank">34款Firefox渗透测试插件</a></li>
<li><a href="http://www.freebuf.com/tools/5363.html" title="BackTrack5 R3发布" target="_blank">BackTrack5 R3发布</a></li>
<li><a href="http://www.freebuf.com/articles/wireless/5351.html" title="浅析无线网络数据窥探技术" target="_blank">浅析无线网络数据窥探技术</a></li>
<li><a href="http://www.freebuf.com/news/5358.html" title="性骚扰是黑客文化的一部分？" target="_blank">性骚扰是黑客文化的一部分？</a></li>
<li><a href="http://www.freebuf.com/others/5357.html" title="freebuf安全周刊8月6日-8月12日" target="_blank">freebuf安全周刊8月6日-8月12日</a></li>
<li><a href="http://www.freebuf.com/tools/5352.html" title="一个“神奇”的工具：把 JavaScript 代码转为 ()[]{}!+ 字符" target="_blank">一个“神奇”的工具：把 JavaScript 代码转为 ()[]{}!+ 字符</a>
All of the material and the informations available on freebuf. com is for informative purpose. freebuf.com declines all responsibilities from the damage that may be done of it, consequently it does not encourage who might use it for illegal purposes.</li>
</ul>
<h3 id="freebuf-com">FREEBUF.COM</h3>
<p><a href="http://www.freebuf.com/dis" target="_blank">免责声明</a> <a href="http://www.freebuf.com/others/864.html" target="_blank">关于我们</a> <a href="mailto:freebuf@gmail.com">建议反馈</a> <a href="http://www.freebuf.com/contact" target="_blank">联系我们</a> <a href="http://www.freebuf.com/newsend" target="_blank">我要投稿</a></p>
<p>Copyright @ 2012 WWW.FREEBUF.COM All Rights Reserved <a href=""></a></p>
<p>FreebuF.COM</p>
<p>用户名</p>
<p>密码</p>
<p>Remember Me</p>
<p><a href="http://www.freebuf.com/wp-login.php?action=register" target="_blank">Register</a> | <a href="http://www.freebuf.com/wp-login.php?action=lostpassword" title="Password Lost and Found" target="_blank">Lost your password?</a>
Register</p>
<p>用户名</p>
<p>邮箱</p>
<p>密码(至少6位)</p>
<p>验证码:
看不清？<a href="">点击更换</a></p>
<p><img src="&quot;看不清?点击更换&quot;" alt="看不清?点击更换"></p>
<p><a href="http://www.freebuf.com/wp-login.php" target="_blank">登陆</a> | <a href="http://www.freebuf.com/wp-login.php?action=lostpassword" title="Password Lost and Found" target="_blank">忘记密码？</a>
Reset Password</p>
<p>Username or E-mail:</p>
<p><a href="http://www.freebuf.com/wp-login.php" target="_blank">登陆</a>| <a href="http://www.freebuf.com/wp-login.php?action=register" target="_blank">注册</a>
<a href="http://www.freebuf.com/news/blackhat-news/5088.html#prev" title="previous" target="_blank"></a><a href="http://www.freebuf.com/news/blackhat-news/5088.html#next" title="next"></a></p>
<p>prev
next</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/安全/">安全</a></li></span><span class="breadcrumb"><li><a href="/categories/安全/">安全</a></li><li><a href="/categories/安全/无线/">无线</a></li></span></span> | <span class="tags">Tagged <a href="/tags/安全/" class="label label-primary">安全</a><a href="/tags/无线/" class="label label-success">无线</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:39"datetime="2014-03-07 09:54:39"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-安全-无线--BlackHat专题PwnieAwards2012奖项提名-FreebuFCOM/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-安全-无线--BlackHat专题PwnieAwards2012奖项提名-FreebuFCOM" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-安全-无线--如何用意念获取附近美女的手机号码/">如何用意念获取附近美女的手机号码</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:39.000Z"> <a href="/2014/02/02/2014-02-02-安全-无线--如何用意念获取附近美女的手机号码/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-">如何用意念获取附近美女的手机号码</h1>
<h3 id="-">分享到</h3>
<ul>
<li><a href="">一键分享</a></li>
<li><a href="">QQ空间</a></li>
<li><a href="">新浪微博</a></li>
<li><a href="">百度云收藏</a></li>
<li><a href="">人人网</a></li>
<li><a href="">腾讯微博</a></li>
<li><a href="">百度相册</a></li>
<li><a href="">开心网</a></li>
<li><a href="">腾讯朋友</a></li>
<li><a href="">百度贴吧</a></li>
<li><a href="">豆瓣网</a></li>
<li><a href="">搜狐微博</a></li>
<li><a href="">百度新首页</a></li>
<li><a href="">QQ好友</a></li>
<li><a href="">和讯微博</a></li>
<li><a href="">更多...</a></li>
</ul>
<p><a href="">百度分享</a></p>
<h1 id="-wooyun-http-drops-wooyun-org-wooyun-"><a href="http://drops.wooyun.org/" title="WooYun知识库" target="_blank">WooYun知识库</a></h1>
<p><a href="http://drops.wooyun.org/login" title="登录" target="_blank">登录</a></p>
<p>像一朵乌云一样成长</p>
<ul>
<li><a href="http://drops.wooyun.org/" title="WooYun知识库" target="_blank">首页</a></li>
<li><a href="http://www.wooyun.org/" target="_blank">WooYun</a></li>
<li><a href="http://zone.wooyun.org/" target="_blank">Zone</a></li>
<li><a href="http://drops.wooyun.org/newsend" target="_blank">投稿</a>
<a href="http://drops.wooyun.org/" title="首页" target="_blank">首页</a> » <a href="http://drops.wooyun.org/category/tips" title="查看 技术分享 中的全部文章" target="_blank">技术分享</a> » 如何用意念获取附近美女的手机号码</li>
</ul>
<h2 id="-http-drops-wooyun-org-tips-573-permanent-link-to-"><a href="http://drops.wooyun.org/tips/573" title="Permanent Link to 如何用意念获取附近美女的手机号码" target="_blank">如何用意念获取附近美女的手机号码</a></h2>
<p>4人收藏 <a href="">收藏</a></p>
<p>2013/09/09 17:05  | <a href="http://drops.wooyun.org/author/Metasploit" title="由 Metasploit 发布" target="_blank">Metasploit</a>  | <a href="http://drops.wooyun.org/category/tips" title="查看 技术分享 中的全部文章" target="_blank">技术分享</a>  | <a href="">占个座先</a></p>
<h2 id="0x00-">0x00 背景</h2>
<p>那是一个漆黑的夜晚，北风凛凛，我和我的小伙伴们结伴走在回家的路上。下面……没有了，哈哈……我是标题党！</p>
<p>言归正传，我和我的小伙伴们住的地方离某知名艺术大学比较近，某天晚上下班回家，在开门的时候碰到几位美女，发现她们住在我们对面，使我们这群IT基友们甚是激动。巴不得凑上去对美女说一句“我是修电脑的，你家电脑慢不慢，我免费帮你弄下？”。</p>
<p>YY归YY，但我们这群搞IT的都是比较内敛的，怎么好意思主动搭讪，因为我们都是有身份证的人。回到屋里很不淡定，苦思冥想好几分钟；“我们不好意思问她们要，为什么不让他们主动给我们呢？”</p>
<h2 id="0x01-">0x01 准备</h2>
<p>我们附近没有CMCC信号，我们就想搭建一个免费的CMCC，让她们主动来输入手机号认证，岂不更好，下面是实施计划。</p>
<p><img src="" alt="2013090819053783681.jpg"></p>
<p>准备：无线网卡（8137）、bt5、钓鱼页面</p>
<h3 id="-bt5-eth0-ip">一：插入无线网卡进入BT5,把网卡启动起来，给eth0配个ip</h3>
<p>/#ifconfig eth0 up /#ifconfig wlan0 up /#ifconfig eht0 192.168.10.2/24</p>
<p><img src="" alt="2013090819074528998.jpg"></p>
<h3 id="-dhcp-">二：下面要安装dhcp和配置</h3>
<p>/#apt-get install dhcp3-server</p>
<p><img src="" alt="2013090819081424128.jpg"></p>
<p>/# vi /etc/default/dhcp3-server</p>
<p>INTERFACES=&quot;eth0&quot; 修改为 INTERFACES=&quot;at0&quot;</p>
<p><img src="" alt="2013090819093997661.jpg">
/# vi /etc/dhcp3/dhcpd.conf</p>
<p>把下面贴进去，或者改成自己想要分的网段。</p>
<p>default-lease-time 600; max-lease-time 7200; option subnet-mask 255.255.255.0; option broadcast-address 192.168.10.255; option routers 192.168.10.2; option domain-name-servers 192.168.10.1; option domain-name &quot;www.metasploit.cn&quot;; subnet 192.168.10.0 netmask 255.255.255.0 { range 192.168.10.10 192.168.10.100; }</p>
<p>如图</p>
<p><img src="" alt="2013090819102545091.jpg"></p>
<h3 id="-apache-">三：启动apache和配置钓鱼页面</h3>
<p>/# /etc/init.d/apache2 start /# cd /var/www/    //进入网站目录，bt5里apache默认首页是index.html /#vi index.html    //修改成自己的钓鱼页面，这里为了演示，我插入基础钓鱼</p>
<p>BT5里面我安装的有XSS平台，这里的Ip要注意，要和刚才我们在dhcp配置文件里面分配的ip段同网段，否则别人连接进来，访问不了的；</p>
<p>当然如果你直接伪造成移动CMCC页面也行！</p>
<p><img src="" alt="2013090819110030478.jpg"></p>
<h3 id="-">四：准备的差不多了，神器该派出来了</h3>
<p>/# cd /pentest/exploits/set/ /# ./set</p>
<p>这里选择第一个set&gt;1</p>
<p>1)  Social-Engineering Attacks</p>
<p><img src="" alt="2013090819113210713.jpg"></p>
<p>下一步</p>
<p>这里选择第一个set&gt;8</p>
<p>8) WirelessAccess Point Attack Vector</p>
<p><img src="" alt="2013090819115743190.jpg"></p>
<p>下一步</p>
<p>set:wireless&gt;1 //选择1 启动</p>
<p><img src="" alt="2013090819122771172.jpg"></p>
<p>会提示让你编辑dhcp3-server这个文件。按Ctrl+x 直接退出就可以，因为之前我们编辑过了。</p>
<p>下一步</p>
<p>选择分配的Ip段</p>
<p>set:wireless&gt;2</p>
<p>Enter the wireless network interface (ex. wlan0):wlan0 //选择wlan0</p>
<p><img src="" alt="2013090819125527463.jpg"></p>
<p>（忘记说一个，/# vi /pentest/exploits/set/config/set_config.py 更改为自己想要的AP名字，我这里改成CMCC）</p>
<p>下面是效果</p>
<p><img src="" alt="2013090819133492348.jpg"></p>
<p>连接AP不用输入密码</p>
<p>打开任意网站都会跳到我的钓鱼页面</p>
<p><img src="" alt="2013090819140773680.jpg"></p>
<p>手机UC登陆效果</p>
<p><img src="" alt="2013090819143770651.jpg"></p>
<p><img src="" alt="2013090819145114971.jpg"></p>
<p>总结:</p>
<p>钓了2天，钓到10多个“美女”手机号码，效果还是不错，如果伪造成cmcc登陆页面，效果会更好！ （仅限技术研究，切勿用于法非用途！！！后果自负）
版权声明：未经授权禁止转载 <a href="http://drops.wooyun.org/author/Metasploit" title="由 Metasploit 发布" target="_blank">Metasploit</a>@<a href="http://drops.wooyun.org/" target="_blank">乌云知识库</a>
分享到： <a href="&quot;分享到QQ空间&quot;"></a> <a href="&quot;分享到新浪微博&quot;"></a> <a href="&quot;分享到腾讯微博&quot;"></a> <a href="&quot;分享到人人网&quot;"></a> <a href="&quot;分享到网易微博&quot;"></a> <a href="&quot;累计分享11次&quot;">11</a></p>
<h3 id="-">相关日志</h3>
<ul>
<li><a href="http://drops.wooyun.org/papers/161" target="_blank">Rsync安全配置</a></li>
<li><a href="http://drops.wooyun.org/tips/134" target="_blank">针对性攻击与移动安全漏洞</a></li>
<li><a href="http://drops.wooyun.org/tips/409" target="_blank">snmp弱口令引起的信息泄漏</a></li>
<li><a href="http://drops.wooyun.org/tips/413" target="_blank">CentOS 6.2下安装基于Suricata + Barnyard 2 + Base 的⼊侵检测系统</a></li>
<li><a href="http://drops.wooyun.org/tips/640" target="_blank">Dionaea低交互式蜜罐部署详解</a></li>
<li><a href="http://drops.wooyun.org/tips/112" target="_blank">公共无线安全——FakeAP之WiFi钓鱼</a>
上一篇:<a href="http://drops.wooyun.org/tips/572" target="_blank">如何玩转andriod远控（androrat）</a></li>
</ul>
<p>下一篇:<a href="http://drops.wooyun.org/papers/384" target="_blank">对某创新路由的安全测试</a></p>
<h3 id="-14-rss-2-0-http-drops-wooyun-org-tips-573-feed-trackback-http-drops-wooyun-org-tips-573-trackback-">楼被抢了 14 层了... <a href="">抢座</a>、<a href="http://drops.wooyun.org/tips/573/feed" target="_blank">Rss 2.0</a>或者 <a href="http://drops.wooyun.org/tips/573/trackback" target="_blank">Trackback</a></h3>
<ul>
<li><img src="" alt=""> her0ma | 2013/09/09 20:16 | <a href="">/#</a></li>
</ul>
<p>淫荡的一塌糊涂！</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">登录以回复</a></p>
<ul>
<li><img src="" alt=""> 国士无双 | 2013/09/10 11:49 | <a href="">/#</a></li>
</ul>
<p>撸过</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">登录以回复</a></p>
<ul>
<li><img src="" alt=""> Creturn | 2013/09/10 17:12 | <a href="">/#</a></li>
</ul>
<p>其实dhcp控制权在你手里伪造个域名掩盖掉192.168.10.1不更好~~</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">登录以回复</a></p>
<ul>
<li><img src="" alt=""> insight-labs | 2013/09/11 21:15 | <a href="">/#</a></li>
</ul>
<p>你想说的是dns么？</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">登录以回复</a></p>
<ul>
<li><img src="http://zone.wooyun.org/upload/avatar/avatar_274_b.jpg" alt=""> hacker@sina.cn | 2013/09/18 22:19 | <a href="">/#</a></li>
</ul>
<p>dhcp 可以指定DNS， DNS设置为你自己本地的BIND服务即可</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">登录以回复</a></p>
<ul>
<li><img src="" alt=""> 小坤 | 2013/09/12 13:52 | <a href="">/#</a></li>
</ul>
<p>学习了。</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">登录以回复</a></p>
<ul>
<li><img src="" alt=""> 一只猿 | 2013/09/14 12:20 | <a href="">/#</a></li>
</ul>
<p>撸主，对于妹子，老夫专注YY30年，看完你这篇文章，节操碎了满地，遂决定一试</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">登录以回复</a></p>
<ul>
<li><img src="" alt=""> 核攻击 | 2013/09/17 10:23 | <a href="">/#</a></li>
</ul>
<p>节操已掉……</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">登录以回复</a></p>
<ul>
<li><img src="" alt=""> <a href="http://www.metasploit.cn/" target="_blank">Metasploit</a> | 2013/09/18 17:59 | <a href="">/#</a></li>
</ul>
<p>有没有人做的有CMCC页面啊？给我一份</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">登录以回复</a></p>
<ul>
<li><img src="" alt=""> Evi1c0de | 2013/10/28 17:21 | <a href="">/#</a></li>
</ul>
<p>连接CMCC跳转到登陆页面 右键源码 修改即可</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">登录以回复</a></p>
<ul>
<li><img src="" alt=""> 船长 | 2013/09/20 15:46 | <a href="">/#</a></li>
</ul>
<p>比一定全是女的楼主</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">登录以回复</a></p>
<ul>
<li><img src="" alt=""> 建建滴忘问 | 2013/09/22 17:32 | <a href="">/#</a></li>
</ul>
<p>WIN7本身就能搭建这个 创建无线 再来个WEB服务器 实在不行再开个虚拟机 来个DNS服务器哈哈！前年玩的东西</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">登录以回复</a></p>
<ul>
<li><img src="" alt=""> 4n0wGZ | 2013/09/23 18:07 | <a href="">/#</a></li>
</ul>
<p>淫荡的一塌糊涂！</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">登录以回复</a></p>
<ul>
<li><img src="" alt=""> 牛牛 | 2013/10/25 20:06 | <a href="">/#</a></li>
</ul>
<p>真心的觉得很荡呵呵</p>
<p><a href="http://drops.wooyun.org/login" target="_blank">登录以回复</a></p>
<h3 id="-">发表评论</h3>
<p><a href="">点击这里取消回复。</a></p>
<p>您必须 <a href="http://drops.wooyun.org/login" target="_blank">登陆</a> 后才能发表评论。</p>
<h3 id="-">订阅更新</h3>
<ul>
<li><a href="http://drops.wooyun.org/feed" title="点击订阅" target="_blank"><img src="" alt=""></a></li>
</ul>
<h3 id="-">分类</h3>
<ul>
<li><a href="http://drops.wooyun.org/category/papers" title="漏洞分析" target="_blank">漏洞分析</a> (40)</li>
<li><a href="http://drops.wooyun.org/category/tips" title="技术分享" target="_blank">技术分享</a> (57)</li>
<li><a href="http://drops.wooyun.org/category/tools" title="工具收集" target="_blank">工具收集</a> (5)</li>
<li><p><a href="http://drops.wooyun.org/category/news" title="业界资讯" target="_blank">业界资讯</a> (3)</p>
<h3 id="-">最新日志</h3>
</li>
<li><p><a href="http://drops.wooyun.org/tips/688" title="Flash CSRF" target="_blank">Flash CSRF</a></p>
</li>
<li><a href="http://drops.wooyun.org/tips/689" title="XSS与字符编码的那些事儿 —科普文" target="_blank">XSS与字符编码的那些事儿 —科普文</a></li>
<li><a href="http://drops.wooyun.org/papers/680" title="Zabbix SQL Injection/RCE – CVE-2013-5743" target="_blank">Zabbix SQL Injection/RCE – CVE-2013-5743</a></li>
<li><a href="http://drops.wooyun.org/papers/679" title="CDN流量放大攻击思路" target="_blank">CDN流量放大攻击思路</a></li>
<li><a href="http://drops.wooyun.org/news/674" title="从丝绸之路到安全运维（Operational Security）与风险控制（Risk Management） 上集" target="_blank">从丝绸之路到安全运维（Operational Security）与风险控制（Risk Management） 上集</a></li>
<li><a href="http://drops.wooyun.org/tips/662" title="攻击JavaWeb应用[8]-后门篇" target="_blank">攻击JavaWeb应用[8]-后门篇</a></li>
<li><a href="http://drops.wooyun.org/papers/660" title="php4fun.sinaapp.com PHP挑战通关攻略" target="_blank">php4fun.sinaapp.com PHP挑战通关攻略</a></li>
<li><a href="http://drops.wooyun.org/papers/653" title="搭建基于Suricata+Barnyard2+Base的IDS前端Snorby" target="_blank">搭建基于Suricata+Barnyard2+Base的IDS前端Snorby</a></li>
<li><a href="http://drops.wooyun.org/tools/655" title="GPU破解神器Hashcat使用简介" target="_blank">GPU破解神器Hashcat使用简介</a></li>
<li><a href="http://drops.wooyun.org/tips/649" title="内网渗透应用 跨vlan渗透的一种思路" target="_blank">内网渗透应用 跨vlan渗透的一种思路</a></li>
</ul>
<h3 id="-">最新评论</h3>
<ul>
<li><img src="" alt=""></li>
</ul>
<p>c2y2 在 <a href="http://drops.wooyun.org/tips/689#comment-1883" target="_blank">XSS与字符编码的那些事儿 ---科普文</a>
谢谢</p>
<ul>
<li><img src="" alt=""></li>
</ul>
<p>Evi1c0de 在 <a href="">如何用意念获取附近美女的手机号码</a>
连接CMCC跳转到登陆页面 右键源码 修改即可</p>
<ul>
<li><img src="" alt=""></li>
</ul>
<p>牛牛 在 <a href="http://drops.wooyun.org/tips/688#comment-1871" target="_blank">Flash CSRF</a>
支持一下呵呵</p>
<ul>
<li><img src="" alt=""></li>
</ul>
<p>luwikes 在 <a href="http://drops.wooyun.org/papers/178#comment-1870" target="_blank">JBoss安全问题总结</a>
mark</p>
<ul>
<li><img src="" alt=""></li>
</ul>
<p>NgInx 在 <a href="http://drops.wooyun.org/tips/688#comment-1869" target="_blank">Flash CSRF</a>
好吧，基佬，顶你一个，不错。</p>
<ul>
<li><a href="">下一页 »</a>
Powered by <a href="http://wordpress.org/" target="_blank">WordPress</a> | GZai Theme by <a href="http://huaidan.org/" title="GZai Theme produced by 鬼仔" target="_blank">鬼仔</a>
<a href="http://tongji.baidu.com/hm-web/welcome/ico?s=9fc41da6a2322bdd80563c9d5a4bdb1d" target="_blank"><img src="" alt=""></a></li>
</ul>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/安全/">安全</a></li></span><span class="breadcrumb"><li><a href="/categories/安全/">安全</a></li><li><a href="/categories/安全/无线/">无线</a></li></span></span> | <span class="tags">Tagged <a href="/tags/安全/" class="label label-primary">安全</a><a href="/tags/无线/" class="label label-success">无线</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:39"datetime="2014-03-07 09:54:39"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-安全-无线--如何用意念获取附近美女的手机号码/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-安全-无线--如何用意念获取附近美女的手机号码" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>





<ul id="pagination" class="pagination pagination-lg">
  <li><a class="extend prev" href="/page/85/">&laquo;</a></li><li><a class="page-number" href="/">1</a></li><li><a class="page-number" href="/page/2/">2</a></li><li><span class="space">&hellip;</span></li><li><a class="page-number" href="/page/83/">83</a></li><li><a class="page-number" href="/page/84/">84</a></li><li><a class="page-number" href="/page/85/">85</a></li><li class="active"><li><span class="page-number current">86</span></li><li><a class="page-number" href="/page/87/">87</a></li><li><a class="page-number" href="/page/88/">88</a></li><li><a class="page-number" href="/page/89/">89</a></li><li><span class="space">&hellip;</span></li></li><li><a class="page-number" href="/page/163/">163</a></li><li><a class="page-number" href="/page/164/">164</a></li><li><a class="extend next" href="/page/87/">&raquo;</a></li>
  <div class="clearfix"></div>
</ul></div><!--wapper-->
       </div><!-- ID main-col END -->
       <aside id="sidebar" class="alignright col-sx-6 col-sm-4 col-md-3 col-lg-3">
<div id="widget_search" class="widget panel panel-primary">
    <form action="//google.com/search" method="get" accept-charset="utf-8">
  <div class="input-group">
    <input class="form-control" id="searchbox" type="search" name="q" results="0" placeholder="search">
    <span class="input-group-btn">
      <button class="btn btn-default" type="submit">Go!</button>
    </span>
    <input type="hidden" name="q" value="site:itsolife.com">
  </div>
</form>
</div>

<div id="widget_category" class="widget panel panel-primary">
  <div class="panel-heading">category</div>  <div data-src='category' class='ajax_widgets'>正在加载...</div>
</div>

<div id="widget_recent_posts" class="widget panel panel-primary">
  <div class="panel-heading">recent posts</div>  <div data-src='recent_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_tagcloud" class="widget panel panel-primary">
  <div class="panel-heading">tagcloud</div>  <div data-src='tagcloud' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_latest_update_posts" class="widget panel panel-primary">
  <div class="panel-heading">最近更新</div>  <div data-src='latest_update_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_recent_comments" class="widget panel panel-primary">
  <div class="panel-heading">recent comments</div>  

<div class="list-group-item ds-recent-comments" data-num-items="6" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="50"></div>



</div>

</aside>
       <div class="clearfix"></div>
     </div><!-- row END -->
  </div>
  <footer id="footer" class="container">
  <div class="panel panel-info">
  <section id='footer_widget'></section>  <div class="panel-footer">
  <div id="site-info">
    <span class='author'>
  
  &copy; 2014 RobinChia
  
    &nbsp;&nbsp;</span>
  
  <span id='analytics-51la'></span><span id='analytics-google'>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-48559895-1']);
  _gaq.push(['_trackPageview']);
  _js2load.push({src:('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'});
</script></span><span id='analytics-cnzz'>
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_5774006'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s17.cnzz.com/stat.php%3Fid%3D5774006%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
</span><span id='analytics-baidu'>
<script>
var _hmt = _hmt || [];
_js2load.push({src:"//hm.baidu.com/hm.js?1442f50724afc42380b51f097c43082c"});
</script>
</span>  </div>
  <div id="copyright">Site powered by <a href='http://zespia.tw/hexo/'><strong>hexo</strong></a>  update time: <em>2014-03-29 22:06:56</em></span></div>
</div>
<div class="clearfix"></div>


  </div>
  </footer>
  
        <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>        
        <script src="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/js/bootstrap.min.js"></script>        
                
        <script src="http://cdn.bootcss.com/prettify/r298/prettify.min.js"></script>    <script type="text/javascript">
   var lang=["bsh", "c", "cc", "cpp", "cs", "csh", "cyc", "cv", "htm", "html",
    "java", "js", "m", "mxml", "perl", "pl", "pm", "py", "rb", "sh",
    "xhtml", "xml", "xsl"];
   var pretty_base='';
   $('script').each(function(){
	var c = $(this).attr('src');
	if (!c)
	    return;
	if (c.match(/(\/)?prettify(\.min)?\.js/i))
	{
	    var index = c.lastIndexOf('/');
	    if (index != -1)
		pretty_base = c.substr(0,index + 1);
	    return false;
	}
   })
   $('pre code').each(function(){
	var c = $(this).attr('class')
	if (!c)
	    return;
	c = c.match(/\s?(lang\-\w+)/i);
	if (c && lang.indexOf(c[1]) == -1)
	{
	    lang.push(c[1]);
	    $.getScript(pretty_base + c[1] + '.min.js');
	}
   })

    $(window).load(function(){
       $("pre").addClass("prettyprint");
       prettyPrint();
    })
</script>    
            <script type="text/javascript">
var duoshuoQuery = {short_name:"robinchia"};
_js2load.push({src:'http://static.duoshuo.com/embed.js',charset:'UTF-8'});
</script>
    
            <!--wumii_relatedItems-->
    
        <script src="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js"></script>    <script type="text/javascript">
(function($){
  $('.entry').each(function(i){
    $(this).find('img').each(function(){
      var alt = this.alt;

      if (alt){
        $(this).before('<span class="caption">' + alt + '</span>');
      }

      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="fancybox' + i + '" />');
    });
  });

  $('.fancybox').fancybox();
})(jQuery);
</script>    
        <script src="http://cdn.bootcss.com/mathjax/2.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>
    
<script type="text/javascript">
$('.ajax_widgets').each(function(){var src=$(this).attr('data-src');if(src)$(this).load('/widgets/'+src+'.html');});
$.each(_js2load,function(index,obj){loadjs(obj.src,obj.charset)});
</script>

<div id="scroll2top">
<img src="/scroll2top/arrow.png"/>
</div>
<script src="/scroll2top/scroll2top.min.js"></script>
<div id="winterland">
  <canvas></canvas>
</div>
<script src="/js/winterland.min.js"></script>

  </body>
</html>
