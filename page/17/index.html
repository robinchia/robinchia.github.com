
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>The 17 Page | It so life</title>
<meta name="author" content="RobinChia">

<meta name="description" content="It so life">


<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta property="og:site_name" content="It so life"/>

<!--[if IE]><style>.testIE.IE{display:inline;}</style><![endif]-->
<!--[if lte IE 7]><link rel="stylesheet" href="/css/ie7.css" type="text/css"><![endif]-->
<!--[if (lt IE 9)&(gt IE 7)]><style>.testIE.IE8{display:inline;}</style><![endif]-->
<!--[if gt IE 8]><style>.testIE.IE9{display:inline;}</style><![endif]-->

<link href="/favicon.png" rel="icon">
<link rel="alternate" href="/atom.xml" title="It so life Feed" type="application/atom+xml">

<link rel="stylesheet" href="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.0.3/css/font-awesome.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/prettify/r298/prettify.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" type="text/css">
<link rel="stylesheet" href="/css/style.css" type="text/css">
<!--[if lt IE 9]>
   <style>article,aside,dialog,footer,header,section,footer,nav,figure,menu{display:block}</style>
   <script src="http://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
   <script src="http://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
<link href="http://cdn.staticfile.org/respond.js/1.4.2/respond-proxy.html" id="respond-proxy" rel="respond-proxy" />
<link href="/js/respond.proxy.gif" id="respond-redirect" rel="respond-redirect" />
<script src="/js/respond.proxy.js"></script>
   <script src="http://cdn.bootcss.com/selectivizr/1.0.2/selectivizr-min.js"></script>
<![endif]-->
<script type="text/javascript">
function loadjs(c,d){var a=document.createElement("script");a.async=!0;a.type="text/javascript";a.src=c;a.charset=d||"gbk";(document.getElementsByTagName("HEAD")[0]||document.getElementsByTagName("BODY")[0]).appendChild(a)};
var _protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
var _js2load = [];
</script>

</head>
<body>
      <header id="header" class="container"><nav id="main-nav" class="navbar navbar-default navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="/">It so life</a>
    </div>
    <div  class="collapse navbar-collapse">
      <ul  class="nav navbar-nav">
  
        <li><a href="/" title="Home">Home</a></li>      
        <li><a href="/about/" title="About">About</a></li>      
        <li><a href="/archives/" title="Archives">Archives</a></li>      
      <li class='dropdown'>
        <a class='dropdown-toggle' data-toggle='dropdown' href='#'>website<b class='caret'></b></a>
        <ul class='dropdown-menu pure-menu-selected'>
    
          <li><a href="//groups.google.com/forum/#!forum/pongba" title="TopLanguage">TopLanguage</a></li>    
          <li><a href="//itpub.net/" title="ITPub">ITPub</a></li>    
          <li><a href="//blog.jobbole.com/" title="Bole">Bole</a></li>    
          <li><a href="//nosql-database.org/" title="nosql">nosql</a></li>    
          <li><a href="//gitimmersion.googol.im/" title="Git">Git</a></li>    
        </ul>
      </li>
    
      </ul>
      <ul class="nav navbar-nav navbar-right">
      
        <li><a href="/atom.xml">RSS</a></li>
      
      
        <li><a href="https://twitter.com/robinchia">twitter</a></li>
      
      
      
      
        <li><a href="https://github.com/robinchia">github</a></li>
      
      </ul>
    </div>
  </div>
</nav>
<div class="clearfix"></div>
</header>
  <div id='content' class="container">
     <div class="page-header-wrapper">
      <!--[if lt IE 9]><div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong>提示:</strong>您的浏览器版本太低了,建议升级到 <strong><a href="http://windows.microsoft.com/zh-cn/internet-explorer/download-ie" title="IE9">IE9</a></strong> 以上,本站使用<a href="https://www.google.com/intl/zh-CN/chrome/">Chrome浏览器</a>可以获得最好的显示效果.</div><![endif]-->
      <div class="page-header"><h1 align="center"><big>It so life</big> </h1>
        <h5 align="center"><big>love as life</big></h5>
      </div>
     </div>
     <div class="row">
       <div id="main-col" class="alignleft col-sx-12 col-sm-8 col-md-9 col-lg-9">
      <section id='header_widget'></section>
          <div id="wrapper"><article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-AlgorithmGossip-AlgorithmGossip--HeapSort/">HeapSort</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:44.000Z"> <a href="/2014/02/02/2014-02-02-AlgorithmGossip-AlgorithmGossip--HeapSort/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="heapsort">HeapSort</h1>
<h1 id="-algorithm-gossip-heap-"><a href="">Algorithm Gossip: Heap 排序法 - 改良的选择排序</a></h1>
<h2 id="-">说明</h2>
<p>选择排序法的概念简单，每次从未排序部份选一最小值，插入已排序部份的后端，其时间主要花费于在整个未排序部份寻找最小值，如果能让搜寻最小值的方式加 快，选择排序法的速率也就可以加快，Heap排序法让搜寻的路径由树根至最后一个树叶，而不是整个未排序部份，因而称之为改良的选择排序法。</p>
<h2 id="-">解法</h2>
<p>Heap排序法使用Heap Tree（堆积树），树是一种资料结构，而堆积树是一个二元树，也就是每一个父节点最多只有两个子节点（关于树的详细定义还请见资料结构书籍），堆积树的 父节点若小于子节点，则称之为最小堆积（Min Heap），父节点若大于子节点，则称之为最大堆积（Max Heap），而同一层的子节点则无需理会其大小关系，例如下面就是一个堆积树：
<img src="&quot;Heap 排序&quot;" alt="Heap 排序">
可以使用一维阵列来储存堆积树的所有元素与其顺序，为了计算方便，使用的起始索引是1而不是0，索引1是树根位置，如果左子节点储存在阵列中的索引为s，则其父节点的索引为s/2，而右子节点为s+1，就如上图所示，将上图的堆积树转换为一维阵列之后如下所示：
<img src="&quot;Heap 排序&quot;" alt="Heap 排序">
首先必须知道如何建立堆积树，加至堆积树的元素会先放置在最后一个树叶节点位置，然后检查父节点是否小于子节点（最小堆积），将小的元素不断与父节点交换，直到满足堆积树的条件为止，例如在上图的堆积加入一个元素12，则堆积树的调整方式如下所示：
<img src="&quot;Heap 排序&quot;" alt="Heap 排序">
建立好堆积树之后，树根一定是所有元素的最小值，您的目的就是：</p>
<ol>
<li>将最小值取出</li>
<li>然后调整树为堆积树
不断重复以上的步骤，就可以达到排序的效果，最小值的取出方式是将树根与最后一个树叶节点交换，然后切下树叶节点，重新调整树为堆积树，如下所示：
<img src="&quot;Heap 排序&quot;" alt="Heap 排序">
调整完毕后，树根节点又是最小值了，于是我们可以重覆这个步骤，再取出最小值，并调整树为堆积树，如下所示：
<img src="&quot;Heap 排序&quot;" alt="Heap 排序">
如此重覆步骤之后，由于使用一维阵列来储存堆积树，每一次将树叶与树根交换的动作就是将最小值放至后端的阵列，所以最后阵列就是变为已排序的状态。
其实堆积在调整的过程中，就是一个选择的行为，每次将最小值选至树根，而选择的路径并不是所有的元素，而是由树根至树叶的路径，因而可以加快选择的过程， 所以Heap排序法才会被称之为改良的选择排序法。</li>
</ol>
<h2 id="-">实作</h2>
<ul>
<li><p>C
/#include <stdio.h>
/#include <stdlib.h>
/#include <time.h>
/#define MAX 10
/#define SWAP(x,y) {int t; t = x; x = y; y = t;}
void createheap(int[]);
void heapsort(int[]);
int main(void) {
int number[MAX+1] = {-1};
int i, num;
srand(time(NULL));
printf(&quot;排序前：&quot;);
for(i = 1; i &lt;= MAX; i++) {
number[i] = rand() % 100;
printf(&quot;%d &quot;, number[i]);
}
printf(&quot;\n建立堆积树：&quot;);
createheap(number);
for(i = 1; i &lt;= MAX; i++)
printf(&quot;%d &quot;, number[i]);
printf(&quot;\n&quot;);
heapsort(number);
printf(&quot;\n&quot;);
return 0;
}
void createheap(int number[]) {
int i, s, p;
int heap[MAX+1] = {-1};
for(i = 1; i &lt;= MAX; i++) {
heap[i] = number[i];
s = i;
p = i / 2;
while(s &gt;= 2 &amp;&amp; heap[p] &gt; heap[s]) {
SWAP(heap[p], heap[s]);
s = p;
p = s / 2;
}
}
for(i = 1; i &lt;= MAX; i++)
number[i] = heap[i];
}
void heapsort(int number[]) {
int i, m, p, s;
m = MAX;
while(m &gt; 1) {
SWAP(number[1], number[m]);
m--;
p = 1;
s = 2 /<em> p;
while(s &lt;= m) {
if(s &lt; m &amp;&amp; number[s+1] &lt; number[s])
s++;
if(number[p] &lt;= number[s])
break;
SWAP(number[p], number[s]);
p = s;
s = 2 /</em> p;
}
printf(&quot;\n排序中：&quot;);
for(i = MAX; i &gt; 0; i--)
printf(&quot;%d &quot;, number[i]);
}
}</p>
</li>
<li><p>Java
public class HeapSort {
public static void sort(int[] number) {
int[] tmp = new int[number.length + 1];
// 配合说明，使用一个有遍移的暂存阵列
for(int i = 1; i &lt; tmp.length; i++) {
tmp[i] = number[i-1];
}
createHeap(tmp);
int m = number.length;
while(m &gt; 1) {
swap(tmp, 1, m);
m--;
int p = 1;
int s = 2 /<em> p;
while(s &lt;= m) {
if(s &lt; m &amp;&amp; tmp[s+1] &lt; tmp[s])
s++;
if(tmp[p] &lt;= tmp[s])
break;
swap(tmp, p, s);
p = s;
s = 2 /</em> p;
}
}
// 这边将排序好的暂存阵列设定回原阵列
for(int i = 0; i &lt; number.length; i++) {
number[i] = tmp[i+1];
}
}
private static void createHeap(int[] tmp) {
int[] heap = new int[tmp.length];
for(int i = 0; i &lt; heap.length; i++)
heap[i] = -1;
for(int i = 1; i &lt; heap.length; i++) {
heap[i] = tmp[i];
int s = i;
int p = i / 2;
while(s &gt;= 2 &amp;&amp; heap[p] &gt; heap[s]) {
swap(heap, p, s);
s = p;
p = s / 2;
}
}
for(int i = 1; i &lt; tmp.length; i++)
tmp[i] = heap[i];
}
private static void swap(int[] number, int i, int j) {
int t;
t = number[i];
number[i] = number[j];
number[j] = t;
}
}</p>
</li>
</ul>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/AlgorithmGossip/">AlgorithmGossip</a></li></span></span> | <span class="tags">Tagged <a href="/tags/AlgorithmGossip/" class="label label-primary">AlgorithmGossip</a></span> | <span class="time">recent updated:<time title="2014-03-07 10:37:38"datetime="2014-03-07 10:37:38"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-AlgorithmGossip-AlgorithmGossip--HeapSort/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-AlgorithmGossip-AlgorithmGossip--HeapSort" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-xml-xstream--JAVA中Stringformat的用法/">JAVA中String.format的用法 </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:44.000Z"> <a href="/2014/02/02/2014-02-02-xml-xstream--JAVA中Stringformat的用法/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="java-string-format-xytop-">JAVA中String.format的用法 - xytop - 博客园</h1>
<p><a href="http://www.cnblogs.com/xytop/" target="_blank">xytop</a></p>
<h2 id="java-string-format-">JAVA String.format 方法使用介绍</h2>
<p>1.对整数进行格式化：%[index$][标识][最小宽度]转换方式
        我们可以看到，格式化字符串由4部分组成，其中%[index$]的含义我们上面已经讲过，[最小宽度]的含义也很好理解，就是最终该整数转化的字符串最少包含多少位数字。我们来看看剩下2个部分的含义吧：
<img src="" alt="">标识： 
<img src="" alt="">&#39;-&#39;    在最小宽度内左对齐，不可以与“用0填充”同时使用
<img src="" alt="">&#39;/#&#39;    只适用于8进制和16进制，8进制时在结果前面增加一个0，16进制时在结果前面增加0x
<img src="" alt="">&#39;+&#39;    结果总是包括一个符号（一般情况下只适用于10进制，若对象为BigInteger才可以用于8进制和16进制）
<img src="" alt="">&#39;  &#39;    正值前加空格，负值前加负号（一般情况下只适用于10进制，若对象为BigInteger才可以用于8进制和16进制）
<img src="" alt="">&#39;0&#39;    结果将用零来填充
<img src="" alt="">&#39;,&#39;    只适用于10进制，每3位数字之间用“，”分隔
<img src="" alt="">&#39;(&#39;    若参数是负数，则结果中不添加负号而是用圆括号把数字括起来（同‘+’具有同样的限制）
<img src="" alt="">
<img src="" alt="">转换方式：
<img src="" alt="">d-十进制   o-八进制   x或X-十六进制</p>
<pre><code>    上面的说明过于枯燥，我们来看几个具体的例子。需要特别注意的一点是：大部分标识字符可以同时使用。
</code></pre><p><img src="" alt="">        System.out.println(String.format(&quot;%1$,09d&quot;, -3123));
<img src="" alt="">        System.out.println(String.format(&quot;%1$9d&quot;, -31));
<img src="" alt="">        System.out.println(String.format(&quot;%1$-9d&quot;, -31));
<img src="" alt="">        System.out.println(String.format(&quot;%1$(9d&quot;, -31));
<img src="" alt="">        System.out.println(String.format(&quot;%1$/#9x&quot;, 5689));
<img src="" alt="">
<img src="" alt="">//结果为：
<img src="" alt="">//-0003,123
<img src="" alt="">//      -31
<img src="" alt="">//-31<br><img src="" alt="">//     (31)
<img src="" alt="">//   0x1639</p>
<p>2.对浮点数进行格式化：%[index$][标识][最少宽度][.精度]转换方式
        我们可以看到，浮点数的转换多了一个“精度”选项，可以控制小数点后面的位数。</p>
<p><img src="" alt="">标识： 
<img src="" alt="">&#39;-&#39;    在最小宽度内左对齐，不可以与“用0填充”同时使用
<img src="" alt="">&#39;+&#39;    结果总是包括一个符号
<img src="" alt="">&#39;  &#39;    正值前加空格，负值前加负号
<img src="" alt="">&#39;0&#39;    结果将用零来填充
<img src="" alt="">&#39;,&#39;    每3位数字之间用“，”分隔（只适用于fgG的转换）
<img src="" alt="">&#39;(&#39;    若参数是负数，则结果中不添加负号而是用圆括号把数字括起来（只适用于eEfgG的转换）
<img src="" alt="">
<img src="" alt="">转换方式：
<img src="" alt="">&#39;e&#39;, &#39;E&#39;  --  结果被格式化为用计算机科学记数法表示的十进制数
<img src="" alt="">&#39;f&#39;          --  结果被格式化为十进制普通表示方式
<img src="" alt="">&#39;g&#39;, &#39;G&#39;    --  根据具体情况，自动选择用普通表示方式还是科学计数法方式
<img src="" alt="">&#39;a&#39;, &#39;A&#39;    --   结果被格式化为带有效位数和指数的十六进制浮点数</p>
<p>3.对字符进行格式化：
        对字符进行格式化是非常简单的，c表示字符，标识中&#39;-&#39;表示左对齐，其他就没什么了。
4.对百分比符号进行格式化：
        看了上面的说明，大家会发现百分比符号“%”是特殊格式的一个前缀。那么我们要输入一个百分比符号该怎么办呢？肯定是需要转义字符的,但是要注意的是，在这里转义字符不是“\”，而是“%”。换句话说，下面这条语句可以输出一个“12%”：
System.out.println(String.format(&quot;%1$d%%&quot;, 12));
5.取得平台独立的行分隔符：
        System.getProperty(&quot;line.separator&quot;)可以取得平台独立的行分隔符，但是用在format中间未免显得过于烦琐了。于是format函数自带了一个平台独立的行分隔符那就是String.format(&quot;%n&quot;)。
6.对日期类型进行格式化：
         以下日期和时间转换的后缀字符是为 &#39;t&#39; 和 &#39;T&#39; 转换定义的。这些类型相似于但不完全等同于那些由 GNU date 和 POSIX strftime(3c) 定义的类型。提供其他转换类型是为了访问特定于 Java 的功能（如将 &#39;L&#39; 用作秒中的毫秒）。
以下转换字符用来格式化时间：
&#39;H&#39;     24 小时制的小时，被格式化为必要时带前导零的两位数，即 00 - 23。
&#39;I&#39;     12 小时制的小时，被格式化为必要时带前导零的两位数，即 01 - 12。
&#39;k&#39;     24 小时制的小时，即 0 - 23。
&#39;l&#39;     12 小时制的小时，即 1 - 12。
&#39;M&#39;     小时中的分钟，被格式化为必要时带前导零的两位数，即 00 - 59。
&#39;S&#39;     分钟中的秒，被格式化为必要时带前导零的两位数，即 00 - 60 （&quot;60&quot; 是支持闰秒所需的一个特殊值）。
&#39;L&#39;     秒中的毫秒，被格式化为必要时带前导零的三位数，即 000 - 999。
&#39;N&#39;     秒中的毫微秒，被格式化为必要时带前导零的九位数，即 000000000 - 999999999。
&#39;p&#39;     特定于语言环境的 上午或下午 标记以小写形式表示，例如 &quot;am&quot; 或 &quot;pm&quot;。使用转换前缀 &#39;T&#39; 可以强行将此输出转换为大写形式。
&#39;z&#39;     相对于 GMT 的 RFC 822 格式的数字时区偏移量，例如 -0800。
&#39;Z&#39;     表示时区缩写形式的字符串。Formatter 的语言环境将取代参数的语言环境（如果有）。
&#39;s&#39;     自协调世界时 (UTC) 1970 年 1 月 1 日 00:00:00 至现在所经过的秒数，即 Long.MIN_VALUE/1000 与 Long.MAX_VALUE/1000 之间的差值。
&#39;Q&#39;     自协调世界时 (UTC) 1970 年 1 月 1 日 00:00:00 至现在所经过的毫秒数，即 Long.MIN_VALUE 与 Long.MAX_VALUE 之间的差值。
以下转换字符用来格式化日期：
&#39;B&#39;     特定于语言环境的月份全称，例如 &quot;January&quot; 和 &quot;February&quot;。
&#39;b&#39;     特定于语言环境的月份简称，例如 &quot;Jan&quot; 和 &quot;Feb&quot;。
&#39;h&#39;     与 &#39;b&#39; 相同。
&#39;A&#39;     特定于语言环境的星期几全称，例如 &quot;Sunday&quot; 和 &quot;Monday&quot;
&#39;a&#39;     特定于语言环境的星期几简称，例如 &quot;Sun&quot; 和 &quot;Mon&quot;
&#39;C&#39;     除以 100 的四位数表示的年份，被格式化为必要时带前导零的两位数，即 00 - 99
&#39;Y&#39;     年份，被格式化为必要时带前导零的四位数（至少），例如，0092 等于格里高利历的 92 CE。
&#39;y&#39;     年份的最后两位数，被格式化为必要时带前导零的两位数，即 00 - 99。
&#39;j&#39;     一年中的天数，被格式化为必要时带前导零的三位数，例如，对于格里高利历是 001 - 366。
&#39;m&#39;     月份，被格式化为必要时带前导零的两位数，即 01 - 13。
&#39;d&#39;     一个月中的天数，被格式化为必要时带前导零两位数，即 01 - 31
&#39;e&#39;     一个月中的天数，被格式化为两位数，即 1 - 31。
以下转换字符用于格式化常见的日期/时间组合。
&#39;R&#39;     24 小时制的时间，被格式化为 &quot;%tH:%tM&quot;
&#39;T&#39;     24 小时制的时间，被格式化为 &quot;%tH:%tM:%tS&quot;。
&#39;r&#39;     12 小时制的时间，被格式化为 &quot;%tI:%tM:%tS %Tp&quot;。上午或下午标记 (&#39;%Tp&#39;) 的位置可能与语言环境有关。
&#39;D&#39;     日期，被格式化为 &quot;%tm/%td/%ty&quot;。
&#39;F&#39;     ISO 8601 格式的完整日期，被格式化为 &quot;%tY-%tm-%td&quot;。
&#39;c&#39;     日期和时间，被格式化为 &quot;%ta %tb %td %tT %tZ %tY&quot;，例如 &quot;Sun Jul 20 16:17:00 EDT 1969&quot;。</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/xml/">xml</a></li></span><span class="breadcrumb"><li><a href="/categories/xml/">xml</a></li><li><a href="/categories/xml/xstream/">xstream</a></li></span></span> | <span class="tags">Tagged <a href="/tags/xml/" class="label label-primary">xml</a><a href="/tags/xstream/" class="label label-success">xstream</a></span> | <span class="time">recent updated:<time title="2014-04-07 16:43:33"datetime="2014-04-07 16:43:33"> abr. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-xml-xstream--JAVA中Stringformat的用法/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-xml-xstream--JAVA中Stringformat的用法" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-xml-xstream--Java对XML节点的修改、添加、删除–ByXstream框架/">Java对XML节点的修改、添加、删除 –By Xstream框架 </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:44.000Z"> <a href="/2014/02/02/2014-02-02-xml-xstream--Java对XML节点的修改、添加、删除–ByXstream框架/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="java-xml-by-xstream-">Java对XML节点的修改、添加、删除 –By Xstream框架</h1>
<p> 用最简洁的页面描述企业应用与Java艺术!   <a href="http://www.javabloger.com/about_njthnet.html" target="_blank">关于作者</a> </p>
<h2 id="java-xml-by-xstream-">Java对XML节点的修改、添加、删除 –By Xstream框架</h2>
<p>12 三月, 2010 (10:36) | <a href="http://www.javabloger.com/article/category/code" title="查看 代码 的全部文章" target="_blank">代码</a> |  <a href="http://translate.google.com/translate?langpair=zh-CN%7Czh-TW&amp;u=http://www.javabloger.com/article/java-xml-node-add-delete-update.html" target="_blank">繁体</a> <a href="http://translate.google.com/translate?langpair=zh-CN%7Cen&amp;u=http://www.javabloger.com/article/java-xml-node-add-delete-update.html" target="_blank">English</a>        作者: H.E. </p>
<p>在J2EE、Java项目中对xml操作是一项非常常见的事情，在我认识了XStream以后，才彻底明白XML模型对象的概念，使用XStream让我XML的设计不由自主更符合OO的风格。另外，除了在设计上得到的体验，还在实际操作中得到了便捷的体验。</p>
<p>简单来说，我在IBM的Java开发园地上看过一些操作XML经典的文章被广为流传，但是无论是采用DOM4J还是JDOM对XML文件中的节点或者整个文件的进行 修改、添加、删除 都没有XStream 简单、方便。</p>
<p>下面来看一下 XStream 官方网站上的例子，网站地址：     <a href="http://xstream.codehaus.org/tutorial.html。" target="_blank">http://xstream.codehaus.org/tutorial.html。</a></p>
<p>官方网站上的例子只是提供了一个例子，并没有说明如何对 XML节点进行修改、添加、删除，XStream 官方网站上只是给出了一个从对象到XML，从XML到对象的例子。</p>
<p>Javabloger的作者H.E.通过实践发现采用 XStream可以很简单的对XML节点进行 修改、添加、删除，比传统的XML框架简单很多倍，用过一次的人都不会忘记，<strong>因为实在是太方便了</strong>。</p>
<p><strong>修改XML节点代码示例如下：</strong></p>
<pre><code>public void upDateMySQLRecentHost(String  HostID)  throws  Exception {
    List &lt;RecentHost&gt; list=null;
    try {
            list=getMySQLRecentHost();   **// 1. 先通过 XStream读取XML文件，变成List集合里面包含节点对象。**

            for (int i=0;i&lt;list.size();i++){      **  //  2. 遍历整个 List 对象集合**
                if (list.get(i).getId().equals(HostID )){        **// 3. 比较 需要进行修改的节点 ID**
                    list.remove(i);                                     **//  4. 移除 指定的节点  **
                    list.add(recentHost);                          **  //  5. 添加 定义的新节点**
                }
            }                                                                **   //  完成操作，对节点进行 匹配的删除和添加 这个就修改。**

       *    //  以下代码H.E.就不一一介绍了，大致意思就是 将修改过的List 对象集合，重新写入XML中。*
            xstream.alias(&quot;RecentHost&quot;,  RecentHost.class);         
            String xml=&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;\n&quot;+xstream.toXML(list);
             System.out.println ( xml );
            FileWriter resultFile = new FileWriter(recentLoginHostCaseXMLFile);
            PrintWriter myFile = new PrintWriter(resultFile);
            myFile.println(xml);
            resultFile.close();
        }
    catch ( Exception e) {
        logger.error(e);
    }
}
</code></pre><p><strong>添加XML节点代码示例如下：</strong></p>
<pre><code>public void AddMySQLRecentHost(RecentHost RecentHostInfo)  throws  Exception {
    List &lt;RecentHost&gt; list=null;
    try {
            list=getMySQLRecentHost(); **  // 1. 先通过 XStream读取XML文件，变成List集合里面包含节点对象。**
            list.add( RecentHostInfo  );    **//   2. 添加到  List集合里面。**

            xstream.alias(&quot;RecentHost&quot;,  RecentHost.class);  **// 3.进行XML对象映射**
            String xml=&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;\n&quot;+xstream.toXML(list);

         *   //  以下代码H.E.就不一一介绍了，大致意思就是 将添加过的List 对象集合，重新写入XML中。*
            FileWriter resultFile = new FileWriter(recentLoginHostCaseXMLFile);
            PrintWriter myFile = new PrintWriter(resultFile);
            myFile.println(xml);
            resultFile.close();      
        }
    catch ( Exception e) {
        logger.error(e);
    }
}
</code></pre><p><strong>删除XML节点代码示例如下：</strong></p>
<pre><code>public void deleteMySQLRecentHost(String id)  throws  Exception {
    List &lt;RecentHost&gt; list=null;
    try {
            list=getMySQLRecentHost();   **// 1. 先通过 XStream读取XML文件，变成List集合里面包含节点对象。**

            for (int i=0;i&lt;list.size();i++){      **  //  2. 遍历整个 List 对象集合**
                if (list.get(i).getId().equals(HostID )){       **// 3. 比较 需要进行修改的节点 ID**
                    list.remove(i);                                    **  //  4. 移除 指定的节点  **
                }                                                                                                                     
            }                                                             **      //  完成删除操作。**                            

*            //  以下代码H.E.就不一一介绍了，大致意思就是 将修改过的List 对象集合，重新写入XML中。*
            xstream.alias(&quot;RecentHost&quot;,  RecentHost.class);                                     
            String xml=&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;\n&quot;+xstream.toXML(list);
             System.out.println ( xml );                                                   
            FileWriter resultFile = new FileWriter(recentLoginHostCaseXMLFile);
            PrintWriter myFile = new PrintWriter(resultFile);                                      
            myFile.println(xml);                                                                                        
            resultFile.close();                                                                                           
        }                                                                                                                              
    catch ( Exception e) {                                                                                              
        logger.error(e);                                                                                                    
    }                                                                                                                                  
}
</code></pre><p>–end–</p>
<p><strong>H.E.@Info:</strong>
J2EE Architect/<strong>J</strong>Evangelist
Life@NanJing
Hobby@Photography
Email@njthnet(at)gmail.com</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/xml/">xml</a></li></span><span class="breadcrumb"><li><a href="/categories/xml/">xml</a></li><li><a href="/categories/xml/xstream/">xstream</a></li></span></span> | <span class="tags">Tagged <a href="/tags/xml/" class="label label-primary">xml</a><a href="/tags/xstream/" class="label label-success">xstream</a></span> | <span class="time">recent updated:<time title="2014-04-07 16:42:22"datetime="2014-04-07 16:42:22"> abr. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-xml-xstream--Java对XML节点的修改、添加、删除–ByXstream框架/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-xml-xstream--Java对XML节点的修改、添加、删除–ByXstream框架" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-xml-xstream--XStream-AnnotationsTutorial/">XStream </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:44.000Z"> <a href="/2014/02/02/2014-02-02-xml-xstream--XStream-AnnotationsTutorial/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="xstream-annotations-tutorial">XStream - Annotations Tutorial</h1>
<p><a href="http://xstream.codehaus.org/index.html" target="_blank"><img src="" alt="XStream"></a></p>
<h1 id="annotations-tutorial">Annotations Tutorial</h1>
<h2 id="motivation">Motivation</h2>
<p>Sometimes it can get tedious to call all those XStream aliases/register converter methods or you might simply like the new trend on configuring POJOs: Java annotations.</p>
<p>This tutorial will show you how to use some of the annotations provided by XStream in order to make configuration easier. Let&#39;s start with a custom Message class:
package com.thoughtworks.xstream; package com.thoughtworks.xstream; public class RendezvousMessage { private int messageType; public RendezvousMessage(int messageType) { this.messageType = messageType; } }</p>
<p>Let&#39;s code the XStream calls which generate the XML file:</p>
<p>package com.thoughtworks.xstream; public class Tutorial { public static void main(String[] args) { XStream stream = new XStream(); RendezvousMessage msg = new RendezvousMessage(15); System.out.println(stream.toXML(msg)); } }</p>
<p>Results in the following XML:</p>
<p><com.thoughtworks.xstream.RendezvousMessage> <messageType>15</messageType> </com.thoughtworks.xstream.RendezvousMessage></p>
<h2 id="aliasing-annotation">Aliasing Annotation</h2>
<p>The most basic annotation is the one responsible for type and field aliasing: @XStreamAlias. Let&#39;s annotate both our type and field and run the tutorial method again:
@XStreamAlias(&quot;message&quot;) class RendezvousMessage { @XStreamAlias(&quot;type&quot;) private int messageType; public RendezvousMessage(int messageType) { this.messageType = messageType; } }</p>
<p>In some strange way, the result is the same. What happened here? XStream does not read this annotation by default as it would be impossible to deserialize the XML code. Therefore we need to tell XStream to read the annotations from this type:</p>
<p>public static void main(String[] args) { XStream stream = new XStream(); xstream.processAnnotations(RendezvousMessage.class); RendezvousMessage msg = new RendezvousMessage(15); System.out.println(stream.toXML(msg)); }</p>
<p>Note that we have called the processAnnotations method of XStream. This method registers all aliases annotations in the XStream instance passed as first argument. You may also use the overloaded version of this method taking an array of types. The resulting XML is now what we have expected:</p>
<message> <type>15</type> </message>

<p>If you let XStream process the annotations of a type, it will also process all annotations of the related types i.e. all super types, implemented interfaces, the class types of the members and all their generic types.</p>
<h2 id="implicit-collections">Implicit Collections</h2>
<p>Let&#39;s add a List of content to our RendezvousMessage. We desire the same functionality obtained with implicit collections:
@XStreamAlias(&quot;message&quot;) class RendezvousMessage { @XStreamAlias(&quot;type&quot;) private int messageType; private List<String> content; public RendezvousMessage(int messageType, String ... content) { this.messageType = messageType; this.content = Arrays.asList(content); } }</p>
<p>public static void main(String[] args) { XStream stream = new XStream(); xstream.processAnnotations(RendezvousMessage.class); RendezvousMessage msg = new RendezvousMessage(15, &quot;firstPart&quot;,&quot;secondPart&quot;); System.out.println(stream.toXML(msg)); }</p>
<p>The resulting XML shows the collection name before its elements:</p>
<message> <type>15</type> <content class="java.util.Arrays$ArrayList"> <a class="string-array"> <string>firstPart</string> <string>secondPart</string> </a> </content> </message>

<p>This is not what we desire therefore we will annotate the content list to be recognized as an implicit collection:</p>
<p>@XStreamAlias(&quot;message&quot;) class RendezvousMessage { @XStreamAlias(&quot;type&quot;) private int messageType; @XStreamImplicit private List<String> content; public RendezvousMessage(int messageType, String... content) { this.messageType = messageType; this.content = Arrays.asList(content); } }</p>
<p>Resulting in an XML which ignores the field name (content) of the list:</p>
<message> <type>15</type> <a class="string-array"> <string>firstPart</string> <string>secondPart</string> </a> </message>

<p>We are almost there... we still want to remove the &#39;a&#39; tag, and define each content part with the tag &#39;part&#39;. In order to do so, let&#39;s add another attribute to our implicit collection annotation. The attribute field defines the name of the tag used for data contained inside this collection:</p>
<p>@XStreamAlias(&quot;message&quot;) class RendezvousMessage { @XStreamAlias(&quot;type&quot;) private int messageType; @XStreamImplicit(itemFieldName=&quot;part&quot;) private List<String> content; public RendezvousMessage(int messageType, String... content) { this.messageType = messageType; this.content = Arrays.asList(content); } }</p>
<p>Resulting in a cleaner XML:</p>
<message> <type>15</type> <part>firstPart</part> <part>secondPart</part> </message>

<h2 id="local-converters">Local Converters</h2>
<p>Let&#39;s create another attribute which defines the timestamp when the message was created:
@XStreamAlias(&quot;message&quot;) class RendezvousMessage { @XStreamAlias(&quot;type&quot;) private int messageType; @XStreamImplicit(itemFieldName=&quot;part&quot;) private List<String> content; private Calendar created = new GregorianCalendar(); public RendezvousMessage(int messageType, String... content) { this.messageType = messageType; this.content = Arrays.asList(content); } }</p>
<p>Resulting in the following xml:</p>
<message> <type>15</type> <part>firstPart</part> <part>secondPart</part> <created> <time>1154097812245</time> <timezone>America/Sao_Paulo</timezone> </created> </message>

<p>Now we face the following problem: We want to use a custom converter locally for this Calendar, but only for this Calendar, this exact field in this exact type. Easy... let&#39;s annotate it with the custom converter annotation:</p>
<p>@XStreamAlias(&quot;message&quot;) class RendezvousMessage { @XStreamAlias(&quot;type&quot;) private int messageType; @XStreamImplicit(itemFieldName=&quot;part&quot;) private List<String> content; @XStreamConverter(SingleValueCalendarConverter.class) private Calendar created = new GregorianCalendar(); public RendezvousMessage(int messageType, String... content) { this.messageType = messageType; this.content = Arrays.asList(content); } }</p>
<p>Let&#39;s create the custom converter:</p>
<p>public class SingleValueCalendarConverter implements Converter { public void marshal(Object source, HierarchicalStreamWriter writer, MarshallingContext context) { Calendar calendar = (Calendar) source; writer.setValue(String.valueOf(calendar.getTime().getTime())); } public Object unmarshal(HierarchicalStreamReader reader, UnmarshallingContext context) { GregorianCalendar calendar = new GregorianCalendar(); calendar.setTime(new Date(Long.parseLong(reader.getValue()))); return calendar; } public boolean canConvert(Class type) { return type.equals(GregorianCalendar.class); } }</p>
<p>And we end up with the converter being used and generating the following XML:</p>
<message> <type>15</type> <part>firstPart</part> <part>secondPart</part> <created>1154097812245</created> </message>

<h2 id="attributes">Attributes</h2>
<p>The client may asks for the type tag to be an attribute inside the message tag, as follows:</p>
<message type="15"> <part>firstPart</part> <part>secondPart</part> <created>1154097812245</created> </message>

<p>All you need to do is add the @XStreamAsAttribute annotation:</p>
<p>@XStreamAlias(&quot;message&quot;) class RendezvousMessage { @XStreamAlias(&quot;type&quot;) @XStreamAsAttribute private int messageType; @XStreamImplicit(itemFieldName=&quot;part&quot;) private List<String> content; @XStreamConverter(SingleValueCalendarConverter.class) private Calendar created = new GregorianCalendar(); public RendezvousMessage(int messageType, String... content) { this.messageType = messageType; this.content = Arrays.asList(content); } }</p>
<h2 id="omitting-fields">Omitting Fields</h2>
<p>Sometimes a class may contain elements that should not be part of the resulting XML. In our case we may now drop the &#39;messageType&#39;, since we are only interested at the content. This is easy using the @XStreamOmitField annotation:
@XStreamAlias(&quot;message&quot;) class RendezvousMessage { @XStreamOmitField private int messageType; @XStreamImplicit(itemFieldName=&quot;part&quot;) private List<String> content; @XStreamConverter(SingleValueCalendarConverter.class) private Calendar created = new GregorianCalendar(); public RendezvousMessage(int messageType, String... content) { this.messageType = messageType; this.content = Arrays.asList(content); } }</p>
<p>The resulting XML does not contain the type of the message anymore:</p>
<message> <part>firstPart</part> <part>secondPart</part> <created>1154097812245</created> </message>

<h2 id="auto-detect-annotations">Auto-detect Annotations</h2>
<p>Until now we have always told you, that you have to call processAnnotation to configure the XStream instance with the present annotations in the different classes. However, this is only half the truth. You can run XStream also in a lazy mode, where it auto-detects the annotations while processing the object graph and configure the XStream instance on-the-fly:
package com.thoughtworks.xstream; public class Tutorial { public static void main(String[] args) { XStream stream = new XStream(); xstream.autodetectAnnotations(true); RendezvousMessage msg = new RendezvousMessage(15); System.out.println(stream.toXML(msg)); } }</p>
<p>The resulting XML will look as expected! Nevertheless you have to understand the implications, therefore some words of warning:</p>
<ol>
<li><strong>Chicken-and-egg problem</strong></li>
</ol>
<p>An XStream instance caches all class types processed for annotations. Every time XStream converts an object it will in auto-detection mode first process the object&#39;s type and all the types related (as explained <a href="http://xstream.codehaus.org/annotations-tutorial.html#Aliasing" target="_blank">above</a>). Therefore it is no problem to serialize an object graph into XML, since XStream will know of all types in advance. This is no longer true at deserialization time. XStream has to know the alias to turn it into the proper type, but it can find the annotation for the alias only if it has processed the type in advance. Therefore deserialization will fail if the type has not already been processed either by having called XStream&#39;s processAnnotations method or by already having serialized this type. However, @XStreamAlias is the only annotation that may fail in this case.</p>
<ol>
<li><strong>Concurrency</strong></li>
</ol>
<p>XStream is not thread-safe while it is configured, thread-safety is only guaranteed during marshalling and unmarshalling. However an annotation is defining a change in configuration that is now applied while object marshalling is processed. Therefore will the auto-detection mode turn XStream&#39;s marshalling process in a thread-unsafe operation any you may run under certain circumstances into concurrency problems.</p>
<ol>
<li><strong>Exceptions</strong></li>
</ol>
<p>XStream uses a well-defined exception hierarchy. Normally an InitializationException is only thrown while XStream is configured. If annotations are processed on the fly they can be thrown obviously also in a marshalling process.</p>
<ol>
<li><strong>Performance</strong></li>
</ol>
<p>In auto-detection mode XStream will have to examine any unknown class type for annotations. This will slow down the marshalling process until all processed types have been examined once.</p>
<p>Please note, that any call to XStream.processAnnotations will turn off the auto-detection mode.</p>
<h2 id="summing-up">Summing up</h2>
<p>The XStream annotations support might help you configuring your class mappings in some ways, as the custom configuration will appear in your types, but might not be the solution for other problems, i.e. when you need to map the same type to two different XML &#39;standards&#39;. Others might claim that the configuration should be clearly stated in a Java class and not mixed with your model, its up to you to pick the best approach in your case: Annotations or direct method calls to the XStream instance. Annotations do not provide more functionality, but may improve convenience.</p>
<h1 id="software">Software</h1>
<ul>
<li><a href="http://xstream.codehaus.org/index.html" target="_blank">About XStream</a></li>
<li><a href="http://xstream.codehaus.org/news.html" target="_blank">News</a></li>
<li><a href="http://xstream.codehaus.org/changes.html" target="_blank">Change History</a></li>
<li><a href="http://xstream.codehaus.org/versioning.html" target="_blank">About Versioning</a></li>
</ul>
<h1 id="evaluating-xstream">Evaluating XStream</h1>
<ul>
<li><a href="http://xstream.codehaus.org/tutorial.html" target="_blank">Two Minute Tutorial</a></li>
<li><a href="http://xstream.codehaus.org/graphs.html" target="_blank">Object references</a></li>
<li><a href="http://xstream.codehaus.org/manual-tweaking-output.html" target="_blank">Tweaking the Output</a></li>
<li><a href="http://xstream.codehaus.org/license.html" target="_blank">License</a></li>
<li><a href="http://xstream.codehaus.org/download.html" target="_blank">Download</a></li>
<li><a href="http://xstream.codehaus.org/references.html" target="_blank">References</a></li>
<li><p><a href="http://www.ohloh.net/projects/3459" target="_blank">Statistics</a></p>
<h1 id="using-xstream">Using XStream</h1>
</li>
<li><p><a href="http://xstream.codehaus.org/architecture.html" target="_blank">Architecture Overview</a></p>
</li>
<li><a href="http://xstream.codehaus.org/converters.html" target="_blank">Converters</a></li>
<li><a href="http://xstream.codehaus.org/faq.html" target="_blank">Frequently Asked Questions</a></li>
<li><a href="http://xstream.codehaus.org/list-user.html" target="_blank">Users&#39; Mailing List</a></li>
<li><a href="http://xstream.codehaus.org/javadoc/index.html" target="_blank">JavaDoc Core</a></li>
<li><a href="http://xstream.codehaus.org/benchmark-javadoc/index.html" target="_blank">JavaDoc Benchmark</a></li>
<li><a href="http://xstream.codehaus.org/issues.html" target="_blank">Reporting Issues</a></li>
</ul>
<h1 id="tutorials">Tutorials</h1>
<ul>
<li><a href="http://xstream.codehaus.org/tutorial.html" target="_blank">Two Minute Tutorial</a></li>
<li><a href="http://xstream.codehaus.org/alias-tutorial.html" target="_blank">Alias Tutorial</a></li>
<li>Annotations Tutorial</li>
<li><a href="http://xstream.codehaus.org/converter-tutorial.html" target="_blank">Converter Tutorial</a></li>
<li><a href="http://xstream.codehaus.org/objectstream.html" target="_blank">Object Streams Tutorial</a></li>
<li><a href="http://xstream.codehaus.org/persistence-tutorial.html" target="_blank">Persistence API Tutorial</a></li>
<li><p><a href="http://xstream.codehaus.org/json-tutorial.html" target="_blank">JSON Tutorial</a></p>
<h1 id="developing-xstream">Developing XStream</h1>
</li>
<li><p><a href="http://xstream.codehaus.org/how-to-contribute.html" target="_blank">How to Contribute</a></p>
</li>
<li><a href="http://xstream.codehaus.org/list-dev.html" target="_blank">Developers&#39; Mailing List</a></li>
<li><a href="http://xstream.codehaus.org/team.html" target="_blank">Development Team</a></li>
<li><a href="http://xstream.codehaus.org/repository.html" target="_blank">Source Repository</a></li>
<li><a href="http://bamboo.ci.codehaus.org/browse/XSTREAM" target="_blank">Continuous Integration</a></li>
</ul>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/xml/">xml</a></li></span><span class="breadcrumb"><li><a href="/categories/xml/">xml</a></li><li><a href="/categories/xml/xstream/">xstream</a></li></span></span> | <span class="tags">Tagged <a href="/tags/xml/" class="label label-primary">xml</a><a href="/tags/xstream/" class="label label-success">xstream</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:44"datetime="2014-03-07 09:54:44"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-xml-xstream--XStream-AnnotationsTutorial/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-xml-xstream--XStream-AnnotationsTutorial" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-AlgorithmGossip-AlgorithmGossip--FourNArray/">FourNArray</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:44.000Z"> <a href="/2014/02/02/2014-02-02-AlgorithmGossip-AlgorithmGossip--FourNArray/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="fournarray">FourNArray</h1>
<h1 id="-algorithm-gossip-4n-"><a href="">Algorithm Gossip: 4N 魔方阵</a></h1>
<h2 id="-">说明</h2>
<p>与 <a href="">奇数魔术方阵</a> 相同，在于求各行、各列与各对角线的和相等，而这次方阵的维度是4的倍数。</p>
<h2 id="-">解法</h2>
<p>先来看看4X4方阵的解法：
<img src="&quot;4N 魔方阵&quot;" alt="4N 魔方阵">
简单的说，就是一个从左上由1依序开始填，但遇对角线不填，另一个由左上由16开始填，但只填在对角线，再将两个合起来就是解答了；如果N大于2，则以 4X4为单位画对角线：
<img src="&quot;4N 魔方阵&quot;" alt="4N 魔方阵">
至于对角线的位置该如何判断，有两个公式，有兴趣的可以画图印证看看，如下所示：
左上至右下：j % 4 == i % 4
右上至左下：(j % 4 + i % 4) == 1</p>
<h2 id="-">实作</h2>
<ul>
<li><p>C
/#include <stdio.h>
/#include <stdlib.h>
/#define N 8
int main(void) {
int i, j;
int square[N+1][N+1] = {0};
for(j = 1; j &lt;= N; j++) {
for(i = 1; i &lt;= N; i++){
if(j % 4 == i % 4 || (j % 4 + i % 4) == 1)
square[i][j] = (N+1-i) /<em> N -j + 1;
else
square[i][j] = (i - 1) /</em> N + j;
}
}
for(i = 1; i &lt;= N; i++) {
for(j = 1; j &lt;= N; j++)
printf(&quot;%2d &quot;, square[i][j]);
printf(&quot;\n&quot;);
}
return 0;
}</p>
</li>
<li><p>Java
public class Matrix {
public static int[][] magicFourN(int n) {
int[][] square = new int[n+1][n+1];
for(int j = 1; j &lt;= n; j++) {
for(int i = 1; i &lt;= n; i++){
if(j % 4 == i % 4 || (j % 4 + i % 4) == 1)
square[i][j] = (n+1-i) /<em> n -j + 1;
else
square[i][j] = (i - 1) /</em> n + j;
}
}
int[][] matrix = new int[n][n];
for(int k = 0; k &lt; matrix.length; k++) {
for(int l = 0; l &lt; matrix[0].length; l++) {
matrix[k][l] = square[k+1][l+1];
}
}
return matrix;
}
public static void main(String[] args) {
int[][] magic = Matrix.magicFourN(8);
for(int k = 0; k &lt; magic.length; k++) {
for(int l = 0; l &lt; magic[0].length; l++) {
System.out.print(magic[k][l] + &quot; &quot;);
}
System.out.println();
}
}
}</p>
</li>
</ul>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/AlgorithmGossip/">AlgorithmGossip</a></li></span></span> | <span class="tags">Tagged <a href="/tags/AlgorithmGossip/" class="label label-primary">AlgorithmGossip</a></span> | <span class="time">recent updated:<time title="2014-03-07 10:37:59"datetime="2014-03-07 10:37:59"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-AlgorithmGossip-AlgorithmGossip--FourNArray/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-AlgorithmGossip-AlgorithmGossip--FourNArray" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>





<ul id="pagination" class="pagination pagination-lg">
  <li><a class="extend prev" href="/page/16/">&laquo;</a></li><li><a class="page-number" href="/">1</a></li><li><a class="page-number" href="/page/2/">2</a></li><li><span class="space">&hellip;</span></li><li><a class="page-number" href="/page/14/">14</a></li><li><a class="page-number" href="/page/15/">15</a></li><li><a class="page-number" href="/page/16/">16</a></li><li class="active"><li><span class="page-number current">17</span></li><li><a class="page-number" href="/page/18/">18</a></li><li><a class="page-number" href="/page/19/">19</a></li><li><a class="page-number" href="/page/20/">20</a></li><li><span class="space">&hellip;</span></li></li><li><a class="page-number" href="/page/161/">161</a></li><li><a class="page-number" href="/page/162/">162</a></li><li><a class="extend next" href="/page/18/">&raquo;</a></li>
  <div class="clearfix"></div>
</ul></div><!--wapper-->
       </div><!-- ID main-col END -->
       <aside id="sidebar" class="alignright col-sx-6 col-sm-4 col-md-3 col-lg-3">
<div id="widget_search" class="widget panel panel-primary">
    <form action="//google.com/search" method="get" accept-charset="utf-8">
  <div class="input-group">
    <input class="form-control" id="searchbox" type="search" name="q" results="0" placeholder="search">
    <span class="input-group-btn">
      <button class="btn btn-default" type="submit">Go!</button>
    </span>
    <input type="hidden" name="q" value="site:itsolife.com">
  </div>
</form>
</div>

<div id="widget_category" class="widget panel panel-primary">
  <div class="panel-heading">category</div>  <div data-src='category' class='ajax_widgets'>正在加载...</div>
</div>

<div id="widget_recent_posts" class="widget panel panel-primary">
  <div class="panel-heading">recent posts</div>  <div data-src='recent_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_tagcloud" class="widget panel panel-primary">
  <div class="panel-heading">tagcloud</div>  <div data-src='tagcloud' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_latest_update_posts" class="widget panel panel-primary">
  <div class="panel-heading">最近更新</div>  <div data-src='latest_update_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_recent_comments" class="widget panel panel-primary">
  <div class="panel-heading">recent comments</div>  

<div class="list-group-item ds-recent-comments" data-num-items="6" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="50"></div>



</div>

</aside>
       <div class="clearfix"></div>
     </div><!-- row END -->
  </div>
  <footer id="footer" class="container">
  <div class="panel panel-info">
  <section id='footer_widget'></section>  <div class="panel-footer">
  <div id="site-info">
    <span class='author'>
  
  &copy; 2014 RobinChia
  
    &nbsp;&nbsp;</span>
  
  <span id='analytics-51la'></span><span id='analytics-google'>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-48559895-1']);
  _gaq.push(['_trackPageview']);
  _js2load.push({src:('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'});
</script></span><span id='analytics-cnzz'>
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_5774006'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s17.cnzz.com/stat.php%3Fid%3D5774006%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
</span><span id='analytics-baidu'>
<script>
var _hmt = _hmt || [];
_js2load.push({src:"//hm.baidu.com/hm.js?1442f50724afc42380b51f097c43082c"});
</script>
</span>  </div>
  <div id="copyright">Site powered by <a href='http://zespia.tw/hexo/'><strong>hexo</strong></a>  update time: <em>2014-04-07 17:26:53</em></span></div>
</div>
<div class="clearfix"></div>


  </div>
  </footer>
  
        <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>        
        <script src="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/js/bootstrap.min.js"></script>        
                
        <script src="http://cdn.bootcss.com/prettify/r298/prettify.min.js"></script>    <script type="text/javascript">
   var lang=["bsh", "c", "cc", "cpp", "cs", "csh", "cyc", "cv", "htm", "html",
    "java", "js", "m", "mxml", "perl", "pl", "pm", "py", "rb", "sh",
    "xhtml", "xml", "xsl"];
   var pretty_base='';
   $('script').each(function(){
	var c = $(this).attr('src');
	if (!c)
	    return;
	if (c.match(/(\/)?prettify(\.min)?\.js/i))
	{
	    var index = c.lastIndexOf('/');
	    if (index != -1)
		pretty_base = c.substr(0,index + 1);
	    return false;
	}
   })
   $('pre code').each(function(){
	var c = $(this).attr('class')
	if (!c)
	    return;
	c = c.match(/\s?(lang\-\w+)/i);
	if (c && lang.indexOf(c[1]) == -1)
	{
	    lang.push(c[1]);
	    $.getScript(pretty_base + c[1] + '.min.js');
	}
   })

    $(window).load(function(){
       $("pre").addClass("prettyprint");
       prettyPrint();
    })
</script>    
            <script type="text/javascript">
var duoshuoQuery = {short_name:"robinchia"};
_js2load.push({src:'http://static.duoshuo.com/embed.js',charset:'UTF-8'});
</script>
    
            <!--wumii_relatedItems-->
    
        <script src="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js"></script>    <script type="text/javascript">
(function($){
  $('.entry').each(function(i){
    $(this).find('img').each(function(){
      var alt = this.alt;

      if (alt){
        $(this).before('<span class="caption">' + alt + '</span>');
      }

      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="fancybox' + i + '" />');
    });
  });

  $('.fancybox').fancybox();
})(jQuery);
</script>    
        <script src="http://cdn.bootcss.com/mathjax/2.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>
    
<script type="text/javascript">
$('.ajax_widgets').each(function(){var src=$(this).attr('data-src');if(src)$(this).load('/widgets/'+src+'.html');});
$.each(_js2load,function(index,obj){loadjs(obj.src,obj.charset)});
</script>

<div id="scroll2top">
<img src="/scroll2top/arrow.png"/>
</div>
<script src="/scroll2top/scroll2top.min.js"></script>
<div id="winterland">
  <canvas></canvas>
</div>
<script src="/js/winterland.min.js"></script>

  </body>
</html>
