
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>The 124 Page | It so life</title>
<meta name="author" content="RobinChia">

<meta name="description" content="It so life">


<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta property="og:site_name" content="It so life"/>

<!--[if IE]><style>.testIE.IE{display:inline;}</style><![endif]-->
<!--[if lte IE 7]><link rel="stylesheet" href="/css/ie7.css" type="text/css"><![endif]-->
<!--[if (lt IE 9)&(gt IE 7)]><style>.testIE.IE8{display:inline;}</style><![endif]-->
<!--[if gt IE 8]><style>.testIE.IE9{display:inline;}</style><![endif]-->

<link href="/favicon.png" rel="icon">
<link rel="alternate" href="/atom.xml" title="It so life Feed" type="application/atom+xml">

<link rel="stylesheet" href="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.0.3/css/font-awesome.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/prettify/r298/prettify.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" type="text/css">
<link rel="stylesheet" href="/css/style.css" type="text/css">
<!--[if lt IE 9]>
   <style>article,aside,dialog,footer,header,section,footer,nav,figure,menu{display:block}</style>
   <script src="http://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
   <script src="http://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
<link href="http://cdn.staticfile.org/respond.js/1.4.2/respond-proxy.html" id="respond-proxy" rel="respond-proxy" />
<link href="/js/respond.proxy.gif" id="respond-redirect" rel="respond-redirect" />
<script src="/js/respond.proxy.js"></script>
   <script src="http://cdn.bootcss.com/selectivizr/1.0.2/selectivizr-min.js"></script>
<![endif]-->
<script type="text/javascript">
function loadjs(c,d){var a=document.createElement("script");a.async=!0;a.type="text/javascript";a.src=c;a.charset=d||"gbk";(document.getElementsByTagName("HEAD")[0]||document.getElementsByTagName("BODY")[0]).appendChild(a)};
var _protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
var _js2load = [];
</script>

</head>
<body>
      <header id="header" class="container"><nav id="main-nav" class="navbar navbar-default navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="/">It so life</a>
    </div>
    <div  class="collapse navbar-collapse">
      <ul  class="nav navbar-nav">
  
        <li><a href="/" title="Home">Home</a></li>      
        <li><a href="/about/" title="About">About</a></li>      
        <li><a href="/archives/" title="Archives">Archives</a></li>      
      <li class='dropdown'>
        <a class='dropdown-toggle' data-toggle='dropdown' href='#'>website<b class='caret'></b></a>
        <ul class='dropdown-menu pure-menu-selected'>
    
          <li><a href="//groups.google.com/forum/#!forum/pongba" title="TopLanguage">TopLanguage</a></li>    
          <li><a href="//itpub.net/" title="ITPub">ITPub</a></li>    
          <li><a href="//blog.jobbole.com/" title="Bole">Bole</a></li>    
          <li><a href="//nosql-database.org/" title="nosql">nosql</a></li>    
          <li><a href="//gitimmersion.googol.im/" title="Git">Git</a></li>    
        </ul>
      </li>
    
      </ul>
      <ul class="nav navbar-nav navbar-right">
      
        <li><a href="/atom.xml">RSS</a></li>
      
      
        <li><a href="https://twitter.com/robinchia">twitter</a></li>
      
      
      
      
        <li><a href="https://github.com/robinchia">github</a></li>
      
      </ul>
    </div>
  </div>
</nav>
<div class="clearfix"></div>
</header>
  <div id='content' class="container">
     <div class="page-header-wrapper">
      <!--[if lt IE 9]><div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong>提示:</strong>您的浏览器版本太低了,建议升级到 <strong><a href="http://windows.microsoft.com/zh-cn/internet-explorer/download-ie" title="IE9">IE9</a></strong> 以上,本站使用<a href="https://www.google.com/intl/zh-CN/chrome/">Chrome浏览器</a>可以获得最好的显示效果.</div><![endif]-->
      <div class="page-header"><h1 align="center"><big>It so life</big> </h1>
        <h5 align="center"><big>love as life</big></h5>
      </div>
     </div>
     <div class="row">
       <div id="main-col" class="alignleft col-sx-12 col-sm-8 col-md-9 col-lg-9">
      <section id='header_widget'></section>
          <div id="wrapper"><article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-DB-oracle-oracle---oraclepreparedStatementResultSetType_Scroll_Ins/">oracle preparedStatement ResultSet.Type_Scroll_Ins</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:35.000Z"> <a href="/2014/02/02/2014-02-02-DB-oracle-oracle---oraclepreparedStatementResultSetType_Scroll_Ins/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="oracle-preparedstatement-resultset-type_scroll_insensitive-iteye-">oracle preparedStatement ResultSet.Type_Scroll_Insensitive 乱码 - 我是一只愚 - ITeye技术网站</h1>
<p><a href="http://www.iteye.com/" target="_blank">首页</a> <a href="http://www.iteye.com/news" target="_blank">资讯</a> <a href="http://www.iteye.com/magazines" target="_blank">精华</a> <a href="http://www.iteye.com/forums" target="_blank">论坛</a> <a href="http://www.iteye.com/ask" target="_blank">问答</a> <a href="http://www.iteye.com/blogs" target="_blank">博客</a> <a href="http://www.iteye.com/blogs/subjects" target="_blank">专栏</a> <a href="http://www.iteye.com/groups" target="_blank">群组</a> <a href="http://vvnet.iteye.com/blog/1469370#" target="_blank">更多 ▼</a></p>
<p><a href="http://www.iteye.com/job" target="_blank">招聘</a> <a href="http://www.iteye.com/search" target="_blank">搜索</a></p>
<p><a href="http://vvnet.iteye.com/login" title="登录" target="_blank">您还未登录 !</a> <a href="http://vvnet.iteye.com/login" target="_blank">登录</a> <a href="http://vvnet.iteye.com/signup" target="_blank">注册</a></p>
<h1 id="-http-vvnet-iteye-com-"><a href="http://vvnet.iteye.com/" target="_blank">我是一只愚</a></h1>
<ul>
<li><a href="http://vvnet.iteye.com/" target="_blank"><strong>博客</strong></a></li>
<li><a href="http://vvnet.iteye.com/weibo" target="_blank">微博</a></li>
<li><a href="http://vvnet.iteye.com/album" target="_blank">相册</a></li>
<li><a href="http://vvnet.iteye.com/link" target="_blank">收藏</a></li>
<li><a href="http://vvnet.iteye.com/blog/guest_book" target="_blank">留言</a></li>
<li><a href="http://vvnet.iteye.com/blog/profile" target="_blank">关于我</a></li>
</ul>
<h3 id="-oracle-preparedstatement-resultset-type_scroll_insensitive-"><a href="">oracle preparedStatement ResultSet.Type_Scroll_Insensitive 乱码</a> **</h3>
<p><strong>博客分类：</strong></p>
<ul>
<li><a href="http://vvnet.iteye.com/category/47121" target="_blank">JAVA</a></li>
</ul>
<p>问题：</p>
<p>我用的数据库是 oracle 字符集 us7ascii
用preparedStatement(sqlString, ResultSet.Type_Scroll_Insensitive, ResultSet.Concur_read_only)
从数据库中 读取数据后 中文字段乱码,不管是转不转码都是乱码
但是如果preparedStatement(sqlString) 转码成GBK后就能正常显示中，服了。</p>
<p>查询百度，有说是oracle jdbc驱动的问题，这个还没有验证，有时间验证一下，作参考。</p>
<p>深入理解（<strong>原文<a href="http://www.iteye.com/topic/123557" target="_blank">http://www.iteye.com/topic/123557</a></strong> ）</p>
<p>JDBC2.0后提出了三种不同的cursor类型，用户代码可以在创建Statement指定cursor类型，如下：
Statement createStatement( int resultSetType, int resultSetConcurrency)</p>
<h1 id="-cursor-"><strong>cursor类型</strong></h1>
<h2 id="resultset-type_forward_only">ResultSet.TYPE_FORWARD_ONLY</h2>
<p>   默认的cursor类型，仅仅支持向前forward，不支持backforward，random，last，first操作，类似单向链表。
   TYPE_FORWARD_ONLY类型通常是效率最高最快的cursor类型</p>
<h2 id="resultset-type_scroll_insensitive">ResultSet.TYPE_SCROLL_INSENSITIVE</h2>
<p>   支持backforward，random，last，first操作，对其它数据session对选择数据做出的更改是不敏感，不可见的。</p>
<h2 id="resultset-type_scroll_sensitive">ResultSet.TYPE_SCROLL_SENSITIVE</h2>
<p>   支持backforward，random，last，first操作，对其它数据session对选择数据做出的更改是敏感，可见的。</p>
<h1 id="-">分析</h1>
<p>   众所周知，JDBC对数据库进行数据查询时，数据库会创建查询结果的cache和cursor。而数据库的cursor是不支持 backforward，random，last，first操作，仅仅只支持向前forward。那么TYPE_SCROLL_INSENSITIVE 是如何实现支持backforward，random，last，first的呢？很简单，TYPE_SCROLL_INSENSITIVE的 Statement查询把所有fetch的记录都缓存到JVM的Resultset对象内，如果有10个记录，直接跳到最后记 录，TYPE_SCROLL_INSENSITIVE方式下把fetch所有记录到jvm端，并缓存下来，再进行random就是在数据库数组里面进行 的。这也是TYPE_FORWARD_ONLY类型通常是效率最高最快的cursor类型原因，如果要做一些复杂的功能，必然是要牺牲一些效率的。
    那么为什么TYPE_SCROLL_INSENSITIVE对选择数据做出的更改是不敏感，不可见的呢？前面提到，JDBC对数据库进行数据查询时，数据库会创建查询结果的cache和cursor，如下面sql:
    select name,id from foo
    用jdbc执行上面的sql语句时，数据库会把foo表所有记录的name和id字段缓存到cache中，之后cache和真正的数据库数据文件没有任何 联系了，foo表发生的改变在查询完成后不会自动同步到cache上去，因此TYPE_SCROLL_INSENSITIVE对选择数据做出的更改是不敏 感，不可见。
    那么TYPE_SCROLL_SENSITIVE是怎么做到其它数据session对选择数据做出的更改是敏感，可见的。上面的sql语句用TYPE_SCROLL_SENSITIVE的Statement来执行，会转化成以下的sql语句：
    select rowid from foo
    数据库这时候是把foo表所有记录的rowid缓存到cache中，用户代码在fetch记录时，再继续做以下查询：
    select name,id from foo where rowid=?
    因此这时候发生的查询是实时从真正的数据库数据文件中取，因此对期间发生的数据更改是可见的，敏感的。但是这种可见性仅限于update操作，而 insert和delete同样是不可见的。因为如果查询发生在insert之前，insert生成的rowid并不会反应在cache中的rowid结 果集上。在一个记录的rowid已经缓存到cache中，这时候被删除了，但一般数据库的删除是标记删除，也就是说rowid对应那行记录并没有真正从数 据库文件中抹去，一般是可以再次取到记录的。</p>
<h1 id="-">总结</h1>
<pre><code>TYPE_FORWARD_ONLY类型通常是效率最高最快的cursor类型，也是最常用的选择。
TYPE_SCROLL_INSENSITIVE需要在jvm中cache所有fetch到的记录实体，在大量记录集返回时慎用。
TYPE_SCROLL_SENSITIVE在jvm中cache所有fetch到的记录rowid，需要进行二次查询，效率最低，开销最大
</code></pre><p>JDBC ResultSet分析 （<strong>原文<a href="http://www.iteye.com/topic/560109" target="_blank">http://www.iteye.com/topic/560109</a></strong> ）</p>
<p>JDBC1.0 、JDBC2.0 、JDBC3.0 中分别用以下方法创建Statement 。</p>
<p>JDBC1.0 ： createStatement()</p>
<p>JDBC2.0 ： createStatement(resultSetType, resultSetConcurrency)</p>
<p>JDBC3.0 ： createStatement(resultSetType, resultSetConcurrency, resultSetHoldability)</p>
<p>下面依次分析resultSetType 、resultSetConcurrency 、resultSetHoldability 这几个参数的含义。</p>
<p><strong>一 ResultSetType</strong></p>
<pre><code>  resultSetType 的可选值有： ResultSet.TYPE_FORWARD_ONLY 、ResultSet.TYPE_SCROLL_INSENSITIVE 、ResultSet.TYPE_SCROLL_SENSITIVE 。
</code></pre><p><strong>1</strong> <strong>：ResultSet.TYPE_FORWARD_ONLY</strong></p>
<p>默认的cursor 类型，仅仅支持结果集forward ，不支持backforward ，random ，last ，first 等操作。  </p>
<p><strong>2</strong> <strong>：ResultSet.TYPE_SCROLL_INSENSITIVE</strong></p>
<p>支持结果集backforward ，random ，last ，first 等操作，对其它session 对数据库中数据做出的更改是不敏感的。</p>
<p>实现方法：从数据库取出数据后，会把全部数据缓存到cache 中，对结果集的后续操作，是操作的cache 中的数据，数据库中记录发生变化后，不影响cache 中的数据，所以ResultSet 对结果集中的数据是<strong>INSENSITIVE</strong> 的。</p>
<p><strong>3</strong> <strong>：ResultSet.TYPE_SCROLL_SENSITIVE</strong></p>
<p>支持结果集backforward ，random ，last ，first 等操作，对其它session 对数据库中数据做出的更改是敏感的，即其他session 修改了数据库中的数据，会反应到本结果集中。</p>
<p>实现方法：从数据库取出数据后，不是把全部数据缓存到cache 中，而是把每条数据的rowid 缓存到cache 中，对结果集后续操作时，是根据rowid 再去数据库中取数据。所以数据库中记录发生变化后，通过ResultSet 取出的记录是最新的，即ResultSet 是<strong>SENSITIVE</strong> 的。 但insert 和delete 操作不会影响到ResultSet ，因为insert 数据的rowid 不在ResultSet 取出的rowid 中，所以insert 的数据对ResultSet 是不可见的，而delete 数据的rowid 依旧在ResultSet 中，所以ResultSet 仍可以取出被删除的记录（ 因为一般数据库的删除是标记删除，不是真正在数据库文件中删除 ）。</p>
<p>做个试验，验证一下SENSITIVE 特性。数据库为oracle10g ，驱动为ojdbc14.jar 。</p>
<p>test 表中数据如下：</p>
<p>c1 c2 c3 1c1 1c2 1c3 2c1 2c2 2c3 3c1 3c2 3c3</p>
<p>程序如下：
Java代码  <a href="&quot;收藏这段代码&quot;"><img src="" alt="收藏代码"></a></p>
<ol>
<li>public   static   void  testResultSetSensitive(Connection conn)  throws  Exception{  </li>
<li></li>
<li>String sql = &quot;SELECT c1,c2,c3 FROM test&quot; ;  </li>
<li>try  {  </li>
<li>Statement stmt = conn  </li>
<li>.createStatement(ResultSet.TYPE_SCROLL_SENSITIVE, ResultSet.CONCUR_READ_ONLY);  </li>
<li></li>
<li>ResultSet rs = stmt.executeQuery(sql);  </li>
<li></li>
<li>while  (rs.next()) {  </li>
<li>System.out.println(&quot;[行号：&quot;  + rs.getRow() +  &quot;]\t&quot;  + rs.getString( 1 ) +  &quot;\t&quot;  + rs.getString( 2 )  </li>
<li><ul>
<li>&quot;\t&quot;  + rs.getString( 3 ));  </li>
</ul>
</li>
<li>Thread.sleep(20000 );  </li>
<li>}  </li>
<li></li>
<li>rs.close();  </li>
<li>stmt.close();  </li>
<li>} catch  (SQLException e) {  </li>
<li>e.printStackTrace();  </li>
<li>} finally  {  </li>
<li>try  {  </li>
<li>conn.close();  </li>
<li>} catch  (Exception e) {  </li>
<li>}  </li>
<li>}  </li>
<li>}  </li>
</ol>
<p>定义ResultSet 为 ResultSet. TYPE_SCROLL_SENSITIVE 类型，首先执行 sql 访问数据库，然后执行 rs.next() 移动游标取数据。在循环里面加上 Thread.<em>sleep</em> (20000) 的目的是为了我们有时间在后台把数据库里的数据改了。比如当在循环里打印出第一行的数据后，我们在后台，把第三行数据的 c3 列改成 ”3uuu” 。如果 ResultSet 真的是敏感的话，那应该取出 ”3uuu” ，而不是原始的“ 3c 3 ”。但最终的结果却是如下：</p>
<p>[ 行号： 1]  1c1    1c2    1c3</p>
<p>[ 行号： 2]  2c1    2c2    2c3</p>
<p>[ 行号： 3]  3c1    3c2    3c3</p>
<p>数据没变呀，ResultSet 不敏感啊！于是去查阅资料，找了n 久，还是在英文文档上找到了答案。原来是fetchsize 的问题。调用ResultSet 的next 方法取数据时，并不是每调用一次方法就去数据库里查一次，而是有个fetchSize, 一次取fetchSize 条数据。Oracle 默认的fetchsize 等于10 ，所以上面的代码在第一次调用rs.next() 时，就已经把3 条数据都取出来了，所以才会有上面的结果。</p>
<pre><code>  第二次实验，在ResultSet rs = stmt.executeQuery(sql); 前面加上 stmt.setFetchSize(1); 将fetchSize 设置为1 。然后重新第一次实验的步骤，发现最 终结果为：
</code></pre><p>[ 行号： 1]  1c1    1c2    1c3</p>
<p>[ 行号： 2]  2c1    2c2    2c3</p>
<p>[ 行号： 3]  3c1    3c2    3uuu</p>
<pre><code>原因就是 fetchsize 设置为 1 时，每次 next 取数时都会重新用 rowid 取数据库里取数据，当然取到的是最新的数据了。



 **二 ResultSetConcurrency**



  ResultSetConcurrency的可选值有2个：
  ResultSet.CONCUR_READ_ONLY 在ResultSet中的数据记录是只读的，不可以修改
  ResultSet.CONCUR_UPDATABLE 在ResultSet中的数据记录可以任意修改，然后更新到数据库，可以插入，删除，修改。



 **三 ResultSetHoldability**
</code></pre><h1 id="resultsetholdability-2-">ResultSetHoldability    的可选值有2 个 ：</h1>
<pre><code> HOLD_CURSORS_OVER_COMMIT:  在事务commit 或rollback 后，ResultSet 仍然可用。
 CLOSE_CURSORS_AT_COMMIT:  在事务commit 或rollback 后，ResultSet  被关闭。



 需要注意的地方：
</code></pre><p>   1 ：Oracle 只支持HOLD_CURSORS_OVER_COMMIT 。</p>
<p>   2 ：当Statement 执行下一个查询，生成第二个ResultSet 时，第一个ResultSet 会被关闭，这和是否支持支持HOLD_CURSORS_OVER_COMMIT 无关。</p>
<p><strong>     四 验证数据库是否支持ResultSet的各种特性</strong></p>
<p>不同的数据库版本及 JDBC 驱动版本，对 ResultSet 的各种高级特性的支持是不一样的，我们可以通过以下方法，来验证具体的数据库及 JDBC 驱动，是否支持 ResultSet 的各种特性。</p>
<pre><code> DatabaseMetaData dbMeta = conn.getMetaData();

   然后调用 DatabaseMetaData 对象的以下方法：

   boolean supportsResultSetType(int resultSetType);

   boolean supportsResultSetConcurrency(int type, int concurrency);

    boolean supportsResultSetHoldability(int holdability);



  参考的2 篇英文文档：
</code></pre><p> <a href="http://cs.felk.cvut.cz/10gr2/java.102/b14355/jdbcvers.htm" target="_blank">http://cs.felk.cvut.cz/10gr2/java.102/b14355/jdbcvers.htm</a>  （JDBC Standards Support ）</p>
<p> <a href="http://download.oracle.com/docs/cd/B10501_01/java.920/a96654/resltset.htm/#1023642" target="_blank">http://download.oracle.com/docs/cd/B10501_01/java.920/a96654/resltset.htm/#1023642</a> (Oracle9i JDBC Developer&#39;s Guide and Reference Release 2 (9.2))
分享到： <a href="&quot;分享到新浪微博&quot;"><img src="" alt=""></a> <a href="&quot;分享到腾讯微博&quot;"><img src="" alt=""></a></p>
<p><a href="http://vvnet.iteye.com/blog/840267" title="JAVA5的新特性收集" target="_blank">JAVA5的新特性收集</a> | <a href="http://vvnet.iteye.com/blog/1397474" title="ORACLE：按月累计问题的解决方法" target="_blank">ORACLE：按月累计问题的解决方法</a></p>
<ul>
<li>2012-03-30 00:31:23</li>
<li>浏览 25</li>
<li><a href="http://vvnet.iteye.com/blog/1469370#comments" target="_blank">评论(0)</a></li>
<li>分类:<a href="http://www.iteye.com/blogs/category/database" target="_blank">数据库</a></li>
<li><a href="http://www.iteye.com/wiki/blog/1469370" target="_blank">相关推荐</a></li>
</ul>
<h3 id="-">评论</h3>
<p><a href=""></a></p>
<h3 id="-">发表评论</h3>
<p><a href="http://vvnet.iteye.com/login" target="_blank"><img src="" alt=""></a><a href="http://vvnet.iteye.com/login" target="_blank">您还没有登录,请您登录后再发表评论</a></p>
<p><a href="http://vvnet.iteye.com/" target="_blank"><img src="&quot;vvnet的博客: 我是一只愚&quot;" alt="vvnet的博客"></a></p>
<p>vvnet</p>
<ul>
<li>浏览: 28526 次</li>
<li>性别: <img src="&quot;男&quot;" alt="Icon_minigender_1"></li>
<li>来自: 青岛</li>
<li><img src="" alt=""><h3 id="-http-vvnet-iteye-com-blog-user_visits-">最近访客 <a href="http://vvnet.iteye.com/blog/user_visits" target="_blank">更多访客&gt;&gt;</a></h3>
</li>
</ul>
<p><a href="http://coldsummerwei.iteye.com/" target="_blank"><img src="&quot;coldsummerwei的博客: &quot;" alt="coldsummerwei的博客"></a></p>
<p><a href="http://coldsummerwei.iteye.com/" target="_blank">coldsummerwei</a></p>
<p><a href="http://shadow19831112.iteye.com/" target="_blank"><img src="&quot;shadow19831112的博客: &quot;" alt="shadow19831112的博客"></a></p>
<p><a href="http://shadow19831112.iteye.com/" target="_blank">shadow19831112</a>
<a href="http://hwf52591.iteye.com/" target="_blank"><img src="&quot;hwf52591的博客: &quot;" alt="hwf52591的博客"></a></p>
<p><a href="http://hwf52591.iteye.com/" target="_blank">hwf52591</a></p>
<p><a href="http://17369644.iteye.com/" target="_blank"><img src="&quot;17369644的博客: &quot;" alt="17369644的博客"></a></p>
<p><a href="http://17369644.iteye.com/" target="_blank">17369644</a></p>
<h3 id="-">文章分类</h3>
<ul>
<li><a href="http://vvnet.iteye.com/" target="_blank">全部博客 (61)</a></li>
<li><a href="http://vvnet.iteye.com/category/47121" target="_blank">JAVA (26)</a></li>
<li><a href="http://vvnet.iteye.com/category/47122" target="_blank">数据库 (14)</a></li>
<li><a href="http://vvnet.iteye.com/category/47123" target="_blank">JavaScript (7)</a></li>
<li><a href="http://vvnet.iteye.com/category/47710" target="_blank">操作系统 (2)</a></li>
<li><a href="http://vvnet.iteye.com/category/48387" target="_blank">爱好 (3)</a></li>
<li><a href="http://vvnet.iteye.com/category/49118" target="_blank">杂文 (4)</a></li>
<li><a href="http://vvnet.iteye.com/category/52379" target="_blank">闲言碎语 (1)</a></li>
<li><a href="http://vvnet.iteye.com/category/55223" target="_blank">装修 (1)</a></li>
<li><p><a href="http://vvnet.iteye.com/category/55346" target="_blank">考试 (2)</a></p>
<h3 id="-">社区版块</h3>
</li>
<li><p><a href="http://vvnet.iteye.com/blog/news" target="_blank">我的资讯</a> (0)</p>
</li>
<li><a href="http://vvnet.iteye.com/blog/post" target="_blank">我的论坛</a> (20)</li>
<li><a href="http://vvnet.iteye.com/blog/solution" target="_blank">我解决的问题</a> (0)</li>
</ul>
<h3 id="-">存档分类</h3>
<ul>
<li><a href="http://vvnet.iteye.com/blog/monthblog/2012-03" target="_blank">2012-03</a> (2)</li>
<li><a href="http://vvnet.iteye.com/blog/monthblog/2012-02" target="_blank">2012-02</a> (1)</li>
<li><a href="http://vvnet.iteye.com/blog/monthblog/2011-05" target="_blank">2011-05</a> (2)</li>
<li><p><a href="http://vvnet.iteye.com/blog/monthblog_more" target="_blank">更多存档...</a></p>
<h3 id="-">最新评论</h3>
</li>
<li><p><a href="http://623deyingxiong.iteye.com/" target="_blank">623deyingxiong</a>： 补充一点：在Eclipse里，子类的方法名只要满足参数列表，方 ...
<a href="http://vvnet.iteye.com/blog/309691#bc1715319" target="_blank">overload和override的区别</a></p>
</li>
<li><a href="http://whz1987.iteye.com/" target="_blank">qq274035206</a>： 很好 写的很详细
<a href="http://vvnet.iteye.com/blog/311393#bc862725" target="_blank">Eclipse下支持jQuery1.2.6</a></li>
<li><a href="http://vvnet.iteye.com/" target="_blank">vvnet</a>： 我用的版本是Myeclipse6.6
<a href="http://vvnet.iteye.com/blog/311393#bc832009" target="_blank">Eclipse下支持jQuery1.2.6</a></li>
<li><a href="http://rockjava.iteye.com/" target="_blank">rockjava</a>： 这个插件我试了N回都没好用过,不知道为什么?
<a href="http://vvnet.iteye.com/blog/311393#bc831948" target="_blank">Eclipse下支持jQuery1.2.6</a>
声明：ITeye文章版权属于作者，受法律保护。没有作者书面许可不得转载。若作者同意转载，必须以超链接形式标明文章原始出处和作者。
© 2003-2011 ITeye.com. All rights reserved. [ 京ICP证110151号 京公网安备110105010620 ]
<img src="" alt=""></li>
</ul>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/DB/">DB</a></li></span><span class="breadcrumb"><li><a href="/categories/DB/">DB</a></li><li><a href="/categories/DB/oracle/">oracle</a></li><li><a href="/categories/DB/oracle/oracle-/">oracle-</a></li></span></span> | <span class="tags">Tagged <a href="/tags/DB/" class="label label-primary">DB</a><a href="/tags/oracle/" class="label label-success">oracle</a><a href="/tags/oracle-/" class="label label-info">oracle-</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:35"datetime="2014-03-07 09:54:35"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-DB-oracle-oracle---oraclepreparedStatementResultSetType_Scroll_Ins/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-DB-oracle-oracle---oraclepreparedStatementResultSetType_Scroll_Ins" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-linux-redhat--Linux系统常用命令-CentOS-RedHat包的安装和卸载/">Linux系统常用命令</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:35.000Z"> <a href="/2014/02/02/2014-02-02-linux-redhat--Linux系统常用命令-CentOS-RedHat包的安装和卸载/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="linux-centos-redhat-">Linux系统常用命令:CentOS,RedHat包的安装和卸载</h1>
<p><strong>怎样看linux软件是for 64位还是for 32位？</strong></p>
<p>file -b binFileName</p>
<p><strong>打包和压缩文件</strong>
bunzip2 file1.bz2 解压一个叫做 &#39;file1.bz2&#39;的文件
bzip2 file1 压缩一个叫做 &#39;file1&#39; 的文件
gunzip file1.gz 解压一个叫做 &#39;file1.gz&#39;的文件
gzip file1 压缩一个叫做 &#39;file1&#39;的文件
gzip -9 file1 最大程度压缩
rar a file1.rar test_file 创建一个叫做 &#39;file1.rar&#39; 的包
rar a file1.rar file1 file2 dir1 同时压缩 &#39;file1&#39;, &#39;file2&#39; 以及目录 &#39;dir1&#39;
rar x file1.rar 解压rar包
unrar x file1.rar 解压rar包
tar cvf archive.tar file1 创建一个非压缩的 tarball
tar cvf archive.tar file1 file2 dir1 创建一个包含了 &#39;file1&#39;, &#39;file2&#39; 以及 &#39;dir1&#39;的档案文件
tar tf archive.tar 显示一个包中的内容
tar xvf archive.tar 释放一个包
tar xvf archive.tar -C /tmp 将压缩包释放到 /tmp目录下
tar cvfj archive.tar.bz2 dir1 创建一个bzip2格式的压缩包
tar xvfj archive.tar.bz2 解压一个bzip2格式的压缩包
tar cvfz archive.tar.gz dir1 创建一个gzip格式的压缩包
tar xvfz archive.tar.gz 解压一个gzip格式的压缩包
zip file1.zip file1 创建一个zip格式的压缩包
zip -r file1.zip file1 file2 dir1 将几个文件和目录同时压缩成一个zip格式的压缩包
unzip file1.zip 解压一个zip格式压缩包
<strong>RPM 包</strong> - （Fedora, Redhat及类似系统）
rpm -ivh package.rpm 安装一个rpm包
rpm -ivh --nodeeps package.rpm 安装一个rpm包而忽略依赖关系警告
rpm -U package.rpm 更新一个rpm包但不改变其配置文件
rpm -F package.rpm 更新一个确定已经安装的rpm包
rpm -e package_name.rpm 删除一个rpm包
rpm -qa 显示系统中所有已经安装的rpm包‍
rpm -qa | grep httpd 显示所有名称中包含 &quot;httpd&quot; 字样的rpm包
rpm -qi package_name 获取一个已安装包的特殊信息
rpm -qg &quot;System Environment/Daemons&quot; 显示一个组件的rpm包
rpm -ql package_name 显示一个已经安装的rpm包提供的文件列表
rpm -qc package_name 显示一个已经安装的rpm包提供的配置文件列表
rpm -q package_name --whatrequires 显示与一个rpm包存在依赖关系的列表
rpm -q package_name --whatprovides 显示一个rpm包所占的体积
rpm -q package_name --scripts 显示在安装/删除期间所执行的脚本l
rpm -q package_name --changelog 显示一个rpm包的修改历史
rpm -qf /etc/httpd/conf/httpd.conf 确认所给的文件由哪个rpm包所提供
rpm -qp package.rpm -l 显示由一个尚未安装的rpm包提供的文件列表
rpm --import /media/cdrom/RPM-GPG-KEY 导入公钥数字证书
rpm --checksig package.rpm 确认一个rpm包的完整性
rpm -qa gpg-pubkey 确认已安装的所有rpm包的完整性
rpm -V package_name 检查文件尺寸、 许可、类型、所有者、群组、MD5检查以及最后修改时间
rpm -Va 检查系统中所有已安装的rpm包- 小心使用
rpm -Vp package.rpm 确认一个rpm包还未安装
rpm2cpio package.rpm | cpio --extract --make-directories /<em>bin/</em> 从一个rpm包运行可执行文件
rpm -ivh /usr/src/redhat/RPMS/<code>arch</code>/package.rpm 从一个rpm源码安装一个构建好的包
rpmbuild --rebuild package_name.src.rpm 从一个rpm源码构建一个 rpm 包
<strong>YUM 软件包升级器</strong> - （Fedora, RedHat及类似系统）
yum install package_name 下载并安装一个rpm包
yum localinstall package_name.rpm 将安装一个rpm包，使用你自己的软件仓库为你解决所有依赖关系
yum update package_name.rpm 更新当前系统中所有安装的rpm包
yum update package_name 更新一个rpm包
yum remove package_name 删除一个rpm包
yum list 列出当前系统中安装的所有包
yum search package_name 在rpm仓库中搜寻软件包
yum clean packages 清理rpm缓存删除下载的包
yum clean headers 删除所有头文件
yum clean all 删除所有缓存的包和头文件</p>
<p><strong>DEB 包</strong> (Debian, Ubuntu 以及类似系统)
dpkg -i package.deb 安装/更新一个 deb 包
dpkg -r package_name 从系统删除一个 deb 包
dpkg -l 显示系统中所有已经安装的 deb 包
dpkg -l | grep httpd 显示所有名称中包含 &quot;httpd&quot; 字样的deb包
dpkg -s package_name 获得已经安装在系统中一个特殊包的信息
dpkg -L package_name 显示系统中已经安装的一个deb包所提供的文件列表
dpkg --contents package.deb 显示尚未安装的一个包所提供的文件列表
dpkg -S /bin/ping 确认所给的文件由哪个deb包提供
<strong>APT 软件工具</strong> (Debian, Ubuntu 以及类似系统)
apt-get install package_name 安装/更新一个 deb 包
apt-cdrom install package_name 从光盘安装/更新一个 deb 包
apt-get update 升级列表中的软件包
apt-get upgrade 升级所有已安装的软件
apt-get remove package_name 从系统删除一个deb包
apt-get check 确认依赖的软件仓库正确
apt-get clean 从下载的软件包中清理缓存
apt-cache search searched-package 返回包含所要搜索字符串的软件包名称  </p>
<p><strong>系统信息</strong>
arch 显示机器的处理器架构(1)
uname -m 显示机器的处理器架构(2)
uname -r 显示正在使用的内核版本
dmidecode -q 显示硬件系统部件 - (SMBIOS / DMI)
hdparm -i /dev/hda 罗列一个磁盘的架构特性
hdparm -tT /dev/sda 在磁盘上执行测试性读取操作
cat /proc/cpuinfo 显示CPU info的信息
cat /proc/interrupts 显示中断
cat /proc/meminfo 校验内存使用
cat /proc/swaps 显示哪些swap被使用
cat /proc/version 显示内核的版本
cat /proc/net/dev 显示网络适配器及统计
cat /proc/mounts 显示已加载的文件系统
lspci -tv 罗列 PCI 设备
lsusb -tv 显示 USB 设备
date 显示系统日期
cal 2007 显示2007年的日历表
date 041217002007.00 设置日期和时间 - 月日时分年.秒
clock -w 将时间修改保存到 BIOS
<strong>关机</strong> (系统的关机、重启以及登出 )
shutdown -h now 关闭系统(1)
init 0 关闭系统(2)
telinit 0 关闭系统(3)
shutdown -h hours:minutes &amp; 按预定时间关闭系统
shutdown -c 取消按预定时间关闭系统
shutdown -r now 重启(1)
reboot 重启(2)
logout 注销
<strong>文件和目录</strong>
cd /home 进入 &#39;/ home&#39; 目录&#39;
cd .. 返回上一级目录
cd ../.. 返回上两级目录
cd 进入个人的主目录
cd ~user1 进入个人的主目录
cd - 返回上次所在的目录
pwd 显示工作路径
ls 查看目录中的文件
ls -F 查看目录中的文件
ls -l 显示文件和目录的详细资料
ls -a 显示隐藏文件
ls /<em>[0-9]/</em> 显示包含数字的文件名和目录名
tree 显示文件和目录由根目录开始的树形结构(1)
lstree 显示文件和目录由根目录开始的树形结构(2)
mkdir dir1 创建一个叫做 &#39;dir1&#39; 的目录&#39;
mkdir dir1 dir2 同时创建两个目录
mkdir -p /tmp/dir1/dir2 创建一个目录树
rm -f file1 删除一个叫做 &#39;file1&#39; 的文件&#39;
rmdir dir1 删除一个叫做 &#39;dir1&#39; 的目录&#39;
rm -rf dir1 删除一个叫做 &#39;dir1&#39; 的目录并同时删除其内容
rm -rf dir1 dir2 同时删除两个目录及它们的内容
mv dir1 new_dir 重命名/移动 一个目录
cp file1 file2 复制一个文件
cp dir0/g&#39; example.txt 用单个零替换多个零
cat -n file1 标示文件的行数
cat example.txt | awk &#39;NR%2==1&#39; 删除example.txt文件中的所有偶数行
echo a b c | awk &#39;{print $1}&#39; 查看一行第一栏
echo a b c | awk &#39;{print $1,$3}&#39; 查看一行的第一和第三栏
paste file1 file2 合并两个文件或两栏的内容
paste -d &#39;+&#39; file1 file2 合并两个文件或两栏的内容，中间用&quot;+&quot;区分
sort file1 file2 排序两个文件的内容
sort file1 file2 | uniq 取出两个文件的并集(重复的行只保留一份)
sort file1 file2 | uniq -u 删除交集，留下其他的行
sort file1 file2 | uniq -d 取出两个文件的交集(只留下同时存在于两个文件中的文件)
comm -1 file1 file2 比较两个文件的内容只删除 &#39;file1&#39; 所包含的内容
comm -2 file1 file2 比较两个文件的内容只删除 &#39;file2&#39; 所包含的内容
comm -3 file1 file2 比较两个文件的内容只删除两个文件共有的部分</p>
<p><strong>查看文件内容
</strong>cat file1 从第一个字节开始正向查看文件的内容
tac file1 从最后一行开始反向查看一个文件的内容
more file1 查看一个长文件的内容
less file1 类似于 &#39;more&#39; 命令，但是它允许在文件中和正向操作一样的反向操作
head -2 file1 查看一个文件的前两行
tail -2 file1 查看一个文件的最后两行
tail -f /var/log/messages 实时查看被添加到一个文件中的内容</p>
<p><strong>文件搜索</strong>
find / -name file1 从 &#39;/&#39; 开始进入根文件系统搜索文件和目录
find / -user user1 搜索属于用户 &#39;user1&#39; 的文件和目录
find /home/user1 -name \/<em>.bin 在目录 &#39;/ home/user1&#39; 中搜索带有&#39;.bin&#39; 结尾的文件
find /usr/bin -type f -atime +100 搜索在过去100天内未被使用过的执行文件
find /usr/bin -type f -mtime -10 搜索在10天内被创建或者修改过的文件
find / -name \/</em>.rpm -exec chmod 755 &#39;{}&#39; \; 搜索以 &#39;.rpm&#39; 结尾的文件并定义其权限
find / -xdev -name \/<em>.rpm 搜索以 &#39;.rpm&#39; 结尾的文件，忽略光驱、捷盘等可移动设备
locate \/</em>.ps 寻找以 &#39;.ps&#39; 结尾的文件 - 先运行 &#39;updatedb&#39; 命令
whereis halt 显示一个二进制文件、源码或man的位置
which halt 显示一个二进制文件或可执行文件的完整路径</p>
<p><strong>文本处理</strong>
cat file1 file2 ... | command &lt;&gt; file1_in.txt_or_file1_out.txt general syntax for text manipulation using PIPE, STDIN and STDOUT
cat file1 | command( sed, grep, awk, grep, etc...) &gt; result.txt 合并一个文件的详细说明文本，并将简介写入一个新文件中
cat file1 | command( sed, grep, awk, grep, etc...) &gt;&gt; result.txt 合并一个文件的详细说明文本，并将简介写入一个已有的文件中
grep Aug /var/log/messages 在文件 &#39;/var/log/messages&#39;中查找关键词&quot;Aug&quot;
grep ^Aug /var/log/messages 在文件 &#39;/var/log/messages&#39;中查找以&quot;Aug&quot;开始的词汇
grep [0-9] /var/log/messages 选择 &#39;/var/log/messages&#39; 文件中所有包含数字的行
grep Aug -R /var/log0/g&#39; example.txt 用单个零替换多个零
cat -n file1 标示文件的行数
cat example.txt | awk &#39;NR%2==1&#39; 删除example.txt文件中的所有偶数行
echo a b c | awk &#39;{print $1}&#39; 查看一行第一栏
echo a b c | awk &#39;{print $1,$3}&#39; 查看一行的第一和第三栏
paste file1 file2 合并两个文件或两栏的内容
paste -d &#39;+&#39; file1 file2 合并两个文件或两栏的内容，中间用&quot;+&quot;区分
sort file1 file2 排序两个文件的内容
sort file1 file2 | uniq 取出两个文件的并集(重复的行只保留一份)
sort file1 file2 | uniq -u 删除交集，留下其他的行
sort file1 file2 | uniq -d 取出两个文件的交集(只留下同时存在于两个文件中的文件)
comm -1 file1 file2 比较两个文件的内容只删除 &#39;file1&#39; 所包含的内容
comm -2 file1 file2 比较两个文件的内容只删除 &#39;file2&#39; 所包含的内容
comm -3 file1 file2 比较两个文件的内容只删除两个文件共有的部分</p>
<p><strong>字符设置和文件格式转换</strong>
dos2unix filedos.txt fileunix.txt 将一个文本文件的格式从MSDOS转换成UNIX
unix2dos fileunix.txt filedos.txt 将一个文本文件的格式从UNIX转换成MSDOS
recode ..HTML &lt; page.txt &gt; page.html 将一个文本文件转换成html
recode -l | more 显示所有允许的转换格式
<strong>文件系统分析</strong>
badblocks -v /dev/hda1 检查磁盘hda1上的坏磁块
fsck /dev/hda1 修复/检查hda1磁盘上linux文件系统的完整性
fsck.ext2 /dev/hda1 修复/检查hda1磁盘上ext2文件系统的完整性
e2fsck /dev/hda1 修复/检查hda1磁盘上ext2文件系统的完整性
e2fsck -j /dev/hda1 修复/检查hda1磁盘上ext3文件系统的完整性
fsck.ext3 /dev/hda1 修复/检查hda1磁盘上ext3文件系统的完整性
fsck.vfat /dev/hda1 修复/检查hda1磁盘上fat文件系统的完整性
fsck.msdos /dev/hda1 修复/检查hda1磁盘上dos文件系统的完整性
dosfsck /dev/hda1 修复/检查hda1磁盘上dos文件系统的完整性
<strong>初始化一个文件系统</strong>
mkfs /dev/hda1 在hda1分区创建一个文件系统
mke2fs /dev/hda1 在hda1分区创建一个linux ext2的文件系统
mke2fs -j /dev/hda1 在hda1分区创建一个linux ext3(日志型)的文件系统
mkfs -t vfat 32 -F /dev/hda1 创建一个 FAT32 文件系统
fdformat -n /dev/fd0 格式化一个软盘
mkswap /dev/hda3 创建一个swap文件系统
<strong>SWAP文件系统</strong>
mkswap /dev/hda3 创建一个swap文件系统
swapon /dev/hda3 启用一个新的swap文件系统
swapon /dev/hda2 /dev/hdb3 启用两个swap分区</p>
<p><strong>挂载一个文件系统</strong>
mount /dev/hda2 /mnt/hda2 挂载一个叫做hda2的盘 - 确定目录 &#39;/ mnt/hda2&#39; 已经存在
umount /dev/hda2 卸载一个叫做hda2的盘 - 先从挂载点 &#39;/ mnt/hda2&#39; 退出
fuser -km /mnt/hda2 当设备繁忙时强制卸载
umount -n /mnt/hda2 运行卸载操作而不写入 /etc/mtab 文件- 当文件为只读或当磁盘写满时非常有用
mount /dev/fd0 /mnt/floppy 挂载一个软盘
mount /dev/cdrom /mnt/cdrom 挂载一个cdrom或dvdrom
mount /dev/hdc /mnt/cdrecorder 挂载一个cdrw或dvdrom
mount /dev/hdb /mnt/cdrecorder 挂载一个cdrw或dvdrom
mount -o loop file.iso /mnt/cdrom 挂载一个文件或ISO镜像文件
mount -t vfat /dev/hda5 /mnt/hda5 挂载一个Windows FAT32文件系统
mount /dev/sda1 /mnt/usbdisk 挂载一个usb 捷盘或闪存设备
mount -t smbfs -o username=user,password=pass //WinClient/share /mnt/share 挂载一个windows网络共享
<strong>磁盘空间</strong>
df -h 显示已经挂载的分区列表
ls -lSr |more 以尺寸大小排列文件和目录
du -sh dir1 估算目录 &#39;dir1&#39; 已经使用的磁盘空间&#39;
du -sk /<em> | sort -rn 以容量大小为依据依次显示文件和目录的大小
rpm -q -a --qf &#39;{SIZE}t%{NAME}n&#39; | sort -k1,1n 以大小为依据依次显示已安装的rpm包所使用的空间 (fedora, redhat类系统)
dpkg-query -W -f=&#39;${Installed-Size;10}t${Package}n&#39; | sort -k1,1n 以大小为依据显示已安装的deb包所使用的空间 (ubuntu, debian类系统)
<strong>备份
</strong>dump -0aj -f /tmp/home0.bak /home 制作一个 &#39;/home&#39; 目录的完整备份
dump -1aj -f /tmp/home0.bak /home 制作一个 &#39;/home&#39; 目录的交互式备份
restore -if /tmp/home0.bak 还原一个交互式备份
rsync -rogpav --delete /home /tmp 同步两边的目录
rsync -rogpav -e ssh --delete /home ip_address:/tmp 通过SSH通道rsync
rsync -az -e ssh --delete ip_addr:/home/public /home/local 通过ssh和压缩将一个远程目录同步到本地目录
rsync -az -e ssh --delete /home/local ip_addr:/home/public 通过ssh和压缩将本地目录同步到远程目录
dd bs=1M if=/dev/hda | gzip | ssh user@ip_addr &#39;dd of=hda.gz&#39; 通过ssh在远程主机上执行一次备份本地磁盘的操作
dd if=/dev/sda of=/tmp/file1 备份磁盘内容到一个文件
tar -Puf backup.tar /home/user 执行一次对 &#39;/home/user&#39; 目录的交互式备份操作
( cd /tmp/local/ &amp;&amp; tar c . ) | ssh -C user@ip_addr &#39;cd /home/share/ &amp;&amp; tar x -p&#39; 通过ssh在远程目录中复制一个目录内容
( tar c /home ) | ssh -C user@ip_addr &#39;cd /home/backup-home &amp;&amp; tar x -p&#39; 通过ssh在远程目录中复制一个本地目录
tar cf - . | (cd /tmp/backup ; tar xf - ) 本地将一个目录复制到另一个地方，保留原有权限及链接
find /home/user1 -name &#39;/</em>.txt&#39; | xargs cp -av --target-directory=/home/backup/ --parents 从一个目录查找并复制所有以 &#39;.txt&#39; 结尾的文件到另一个目录
find /var/log -name &#39;/<em>.log&#39; | tar cv --files-from=- | bzip2 &gt; log.tar.bz2 查找所有以 &#39;.log&#39; 结尾的文件并做成一个bzip包
dd if=/dev/hda of=/dev/fd0 bs=512 count=1 做一个将 MBR (Master Boot Record)内容复制到软盘的动作
dd if=/dev/fd0 of=/dev/hda bs=512 count=1 从已经保存到软盘的备份中恢复MBR内容
<strong>光盘</strong>
cdrecord -v gracetime=2 dev=/dev/cdrom -eject blank=fast -force 清空一个可复写的光盘内容
mkisofs /dev/cdrom &gt; cd.iso 在磁盘上创建一个光盘的iso镜像文件
mkisofs /dev/cdrom | gzip &gt; cd_iso.gz 在磁盘上创建一个压缩了的光盘iso镜像文件
mkisofs -J -allow-leading-dots -R -V &quot;Label CD&quot; -iso-level 4 -o ./cd.iso data_cd 创建一个目录的iso镜像文件
cdrecord -v dev=/dev/cdrom cd.iso 刻录一个ISO镜像文件
gzip -dc cd_iso.gz | cdrecord dev=/dev/cdrom - 刻录一个压缩了的ISO镜像文件
mount -o loop cd.iso /mnt/iso 挂载一个ISO镜像文件
cd-paranoia -B 从一个CD光盘转录音轨到 wav 文件中
cd-paranoia -- &quot;-3&quot; 从一个CD光盘转录音轨到 wav 文件中（参数-3）
cdrecord --scanbus 扫描总线以识别scsi通道
dd if=/dev/hdc | md5sum 校验一个设备的md5sum编码，例如一张 CD
<em>*网络</em></em> - （以太网和WIFI无线）
ifconfig eth0 显示一个以太网卡的配置
ifup eth0 启用一个 &#39;eth0&#39; 网络设备
ifdown eth0 禁用一个 &#39;eth0&#39; 网络设备
ifconfig eth0 192.168.1.1 netmask 255.255.255.0 控制IP地址
ifconfig eth0 promisc 设置 &#39;eth0&#39; 成混杂模式以嗅探数据包 (sniffing)
dhclient eth0 以dhcp模式启用 &#39;eth0&#39;
route -n show routing table
route add -net 0/0 gw IP_Gateway configura default gateway
route add -net 192.168.0.0 netmask 255.255.0.0 gw 192.168.1.1 configure static route to reach network &#39;192.168.0.0/16&#39;
route del 0/0 gw IP_gateway remove static route
echo &quot;1&quot; &gt; /proc/sys/net/ipv4/ip_forward activate ip routing
hostname show hostname of system
host www.example.com lookup hostname to resolve name to ip address and viceversa(1)
nslookup www.example.com lookup hostname to resolve name to ip address and viceversa(2)
ip link show show link status of all interfaces
mii-tool eth0 show link status of &#39;eth0&#39;
ethtool eth0 show statistics of network card &#39;eth0&#39;
netstat -tup show all active network connections and their PID
netstat -tupl show all network services listening on the system and their PID
tcpdump tcp port 80 show all HTTP traffic
iwlist scan show wireless networks
iwconfig eth1 show configuration of a wireless network card
hostname show hostname
host www.example.com lookup hostname to resolve name to ip address and viceversa
nslookup www.example.com lookup hostname to resolve name to ip address and viceversa
whois www.example.com lookup on Whois database
GO TOP INDEX ^
Microsoft Windows networks (SAMBA)
nbtscan ip_addr netbios name resolution
nmblookup -A ip_addr netbios name resolution
smbclient -L ip_addr/hostname show remote shares of a windows host
smbget -Rr smb://ip_addr/share like wget can download files from a host windows via smb
mount -t smbfs -o username=user,password=pass //WinClient/share /mnt/share mount a windows network share</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/linux/">linux</a></li></span><span class="breadcrumb"><li><a href="/categories/linux/">linux</a></li><li><a href="/categories/linux/redhat/">redhat</a></li></span></span> | <span class="tags">Tagged <a href="/tags/linux/" class="label label-primary">linux</a><a href="/tags/redhat/" class="label label-success">redhat</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:35"datetime="2014-03-07 09:54:35"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-linux-redhat--Linux系统常用命令-CentOS-RedHat包的安装和卸载/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-linux-redhat--Linux系统常用命令-CentOS-RedHat包的安装和卸载" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-DB-分区--oracle的表空间、分区表、以及索引的总结/">oracle的表空间、分区表、以及索引的总结</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:35.000Z"> <a href="/2014/02/02/2014-02-02-DB-分区--oracle的表空间、分区表、以及索引的总结/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="oracle-">oracle的表空间、分区表、以及索引的总结</h1>
<p>表空间：</p>
<p>Oracle的UNDOTBS01.DBF文件太大的解决办法</p>
<p>1、.禁止undo tablespace自动增长</p>
<p>alter database datafile &#39;full_path\undotbs01.dbf&#39; autoextend off;</p>
<p>2.-- 创建一个新的小空间的undo tablespace</p>
<p>create undo tablespace undotBS2 datafile &#39;full_path\UNDOTBS02.DBF&#39; size 100m;</p>
<p>-- 设置新的表空间为系统undo_tablespace</p>
<p>alter system set undo_tablespace=undotBS2;</p>
<p>-- Drop 旧的表空间</p>
<p>drop tablespace undotbs1 including contents;</p>
<p>--查看所有表空间的情况</p>
<p>select /* from dba_tablespaces</p>
<p>--创建表空间</p>
<p>create tablespace HRPM0</p>
<p>datafile &#39;/oradata/misdb/HRPM0.DBF&#39; size 5m autoextend on next 10m maxsize unlimited</p>
<p>--删除表空间</p>
<p>DROP TABLESPACE data01 INCLUDING CONTENTS AND DATAFILES;</p>
<p>--修改表空间大小</p>
<p>alter database datafile &#39;/path/NADDate05.dbf&#39; resize 100M</p>
<p>分区表：</p>
<p>当表中的数据量不断增大，查询数据的速度就会变慢，应用程序的性能就会下降，这时就应该考虑对表进行分区。表进行分区后，逻辑上表仍然是一张完整的表，只是将表中的数据在物理上存放到多个表空间(物理文件上)，这样查询数据时，不至于每次都扫描整张表。</p>
<p>Oracle中提供了以下几种表分区：</p>
<p>一、范围分区：这种类型的分区是使用列的一组值，通常将该列成为分区键。</p>
<p>示例1：假设有一个CUSTOMER表，表中有数据200000行，我们将此表通过CUSTOMER_ID进行分区，每个分区存储100000行，我们将每个分区保存到单独的表空间中，这样数据文件就可以跨越多个物理磁盘。下面是创建表和分区的代码，如下：</p>
<p>CREATE TABLE CUSTOMER</p>
<p>(</p>
<p>CUSTOMER_ID NUMBER NOT NULL PRIMARY KEY,</p>
<p>FIRST_NAME VARCHAR2(30) NOT NULL,</p>
<p>LAST_NAME VARCHAR2(30) NOT NULL,</p>
<p>PHONE VARCHAR2(15) NOT NULL,</p>
<p>EMAIL VARCHAR2(80),</p>
<p>STATUS CHAR(1)</p>
<p>)</p>
<p>PARTITION BY RANGE (CUSTOMER_ID)</p>
<p>(</p>
<p>PARTITION CUS_PART1 VALUES LESS THAN (100000) TABLESPACE CUS_TS01,</p>
<p>PARTITION CUS_PART2 VALUES LESS THAN (200000) TABLESPACE CUS_TS02</p>
<p>)</p>
<p>注意：在创建表进行分区时，表空间必须先存在，而且建议将不同的分区放入不同的表空间中。</p>
<p>示例2：假设有ORDER_ACTIVITIES表，每6个月对订单进行清理，我们可以按月份对表进行分区，分区代码如下：</p>
<p>CREATE TABLE ORDER_ACTIVITIES</p>
<p>(</p>
<p>ORDER_ID NUMBER(7) NOT NULL,</p>
<p>ORDER_DATE DATE,</p>
<p>TOTAL_AMOUNT NUMBER,</p>
<p>CUSTOTMER_ID NUMBER(7),</p>
<p>PAID CHAR(1)</p>
<p>)</p>
<p>PARTITION BY RANGE (ORDER_DATE)</p>
<p>(</p>
<p>PARTITION ORD_ACT_PART01 VALUES LESS THAN (TO_DATE(&#39;01-MAY-2003&#39;,&#39;DD-MON-YYYY&#39;)) TABLESPACE ORD_TS01,</p>
<p>PARTITION ORD_ACT_PART02 VALUES LESS THAN (TO_DATE(&#39;01-JUN-2003&#39;,&#39;DD-MON-YYYY&#39;)) TABLESPACE ORD_TS02,</p>
<p>PARTITION ORD_ACT_PART02 VALUES LESS THAN (TO_DATE(&#39;01-JUL-2003&#39;,&#39;DD-MON-YYYY&#39;)) TABLESPACE ORD_TS03</p>
<p>)</p>
<p>二、列表分区：该分区的特点是某列的值只有几个，基于这样的特点我们可以采用列表分区。</p>
<p>示例1：</p>
<p>CREATE TABLE PROBLEM_TICKETS</p>
<p>(</p>
<p>PROBLEM_ID NUMBER(7) NOT NULL PRIMARY KEY,</p>
<p>DESCRIPTION VARCHAR2(2000),</p>
<p>CUSTOMER_ID NUMBER(7) NOT NULL,</p>
<p>DATE_ENTERED DATE NOT NULL,</p>
<p>STATUS VARCHAR2(20)</p>
<p>)</p>
<p>PARTITION BY LIST (STATUS)</p>
<p>(</p>
<p>PARTITION PROB_ACTIVE VALUES (&#39;ACTIVE&#39;) TABLESPACE PROB_TS01,</p>
<p>PARTITION PROB_INACTIVE VALUES (&#39;INACTIVE&#39;) TABLESPACE PROB_TS02</p>
<p>)</p>
<p>三、散列分区：这类分区是在列值上使用散列算法，以确定将行放入哪个分区中。当列的值没有合适的条件时，建议使用散列分区。请看下列示例：</p>
<p>示例1：</p>
<p>CREATE TABLE HASH_TABLE</p>
<p>(</p>
<p>COL NUMBER(8),</p>
<p>INF VARCHAR2(100)</p>
<p>)</p>
<p>PARTITION BY HASH (COL)</p>
<p>(</p>
<p>PARTITION PART01 TABLESPACE HASH_TS01,</p>
<p>PARTITION PART02 TABLESPACE HASH_TS02,</p>
<p>PARTITION PART03 TABLESPACE HASH_TS03</p>
<p>)</p>
<p>四、复合范围列表分区：这种分区是基于范围分区和列表分区，表首先按某列进行范围分区，然后再按某列进行列表分区，分区之中的分区被称为子分区。</p>
<p>示例1：</p>
<p>CREATE TABLE SALES</p>
<p>(</p>
<p>PRODUCT_ID VARCHAR2(5),</p>
<p>SALES_DATE DATE,</p>
<p>SALES_COST NUMBER(10),</p>
<p>STATUS VARCHAR2(20)</p>
<p>)</p>
<p>PARTITION BY RANGE(SALES_DATE)</p>
<p>SUBPARTITION BY LIST (STATUS)</p>
<p>(</p>
<p>PARTITION P1 VALUES LESS THAN (TO_DATE(&#39;2003-01-01&#39;,&#39;YYYY-MM-DD&#39;)) TABLESPACE P1_TS</p>
<p>(</p>
<p>SUBPARTITION P1SUB1 VALUES (&#39;ACTIVE&#39;) TABLESPACE SUBP1_TS1,</p>
<p>SUBPARTITION P1SUB2 VALUES (&#39;INACTIVE&#39;) TABLESPACE SUBP1_TS2</p>
<p>),</p>
<p>PARTITION P2 VALUES LESS THAN (TO_DATE(&#39;2003-03-01&#39;,&#39;YYYY-MM-DD&#39;)) TABLESPACE P2_TS</p>
<p>(</p>
<p>SUBPARTITION P2SUB1 VALUES (&#39;ACTIVE&#39;) TABLESPACE SUBP2_TS1,</p>
<p>SUBPARTITION P2SUB2 VALUES (&#39;INACTIVE&#39;) TABLESPACE SUBP2_TS2</p>
<p>)</p>
<p>)</p>
<p>示例2：使用TEMPLATE模板</p>
<p>CREATE TABLE SALES</p>
<p>(</p>
<p>PRODUCT_ID VARCHAR2(5),</p>
<p>SALES_DATE DATE,</p>
<p>SALES_COST NUMBER(10),</p>
<p>STATUS VARCHAR2(20)</p>
<p>)</p>
<p>PARTITION BY RANGE(SALES_DATE)</p>
<p>SUBPARTITION BY LIST (STATUS)</p>
<p>SUBPARTITION TEMPLATE</p>
<p>(</p>
<p>SUBPARTITION SUB1 VALUES (&#39;ACTIVE&#39;) TABLESPACE SUBP1_TS1,</p>
<p>SUBPARTITION SUB2 VALUES (&#39;INACTIVE&#39;) TABLESPACE SUBP2_TS2</p>
<p>)</p>
<p>(</p>
<p>PARTITION P1 VALUES LESS THAN (TO_DATE(&#39;2003-01-01&#39;,&#39;YYYY-MM-DD&#39;)) TABLESPACE P1_TS,</p>
<p>PARTITION P2 VALUES LESS THAN (TO_DATE(&#39;2003-03-01&#39;,&#39;YYYY-MM-DD&#39;)) TABLESPACE P2_TS</p>
<p>)</p>
<p>五、复合范围散列分区：这种分区是基于范围分区和散列分区，表首先按某列进行范围分区，然后再按某列进行散列分区。与上面的定义方式非常的类似，在此不单独举例。</p>
<p>表分区对于用户来说是透明的，我们在插入数据时Oracle会自动判断插入的数据，然后放入相应的表分区中。但有时我们想单独查询某个分区中的数据时，就必须手工指定分区的名称。</p>
<p>示例1：(此示例基于：四、复合范围列表分区的示例一)</p>
<p>向SALES表插入记录，不必指定表分区。</p>
<p>INSERT INTO SALES VALUES(&#39;00001&#39;,&#39;01-1月-02&#39;,100,&#39;ACTIVE&#39;)</p>
<p>/</p>
<p>INSERT INTO SALES VALUES(&#39;00002&#39;,&#39;01-1月-01&#39;,200,&#39;ACTIVE&#39;)</p>
<p>/</p>
<p>INSERT INTO SALES VALUES(&#39;00003&#39;,&#39;01-2月-03&#39;,300,&#39;INACTIVE&#39;)</p>
<p>/</p>
<p>INSERT INTO SALES VALUES(&#39;00004&#39;,&#39;04-2月-03&#39;,300,&#39;INACTIVE&#39;)</p>
<p>/</p>
<p>INSERT INTO SALES VALUES(&#39;00005&#39;,&#39;04-2月-02&#39;,300,&#39;INACTIVE&#39;)</p>
<p>/</p>
<p>不指定表分区查看SALES表信息：</p>
<p>SELECT /* FROM SALES; 结果如下所示：</p>
<p>指定P1表分区查询SALES表信息：</p>
<p>SELECT /* FROM SALES PARTITION(P1); 结果如下所示：</p>
<p>指定P1SUB1子分区查询SALES表信息:</p>
<p>SELECT /* FROM SALES SUBPARTITION(P1SUB1); 结果如下所示：</p>
<p>示例2：(此示例基于：四、复合范围列表分区的示例二)</p>
<p>示例2基于TEMPLATE模板的表分区，查询稍稍烦琐一点。</p>
<p>指定P1表分区查询SALES表信息：</p>
<p>SELECT /* FROM SALES PARTITION(P1); 结果如下所示,和刚才查询一致。</p>
<p>指定SUB1子分区查询SALES表信息:</p>
<p>SELECT /* FROM SALES SUBPARTITION(SUB1); 出现如下错误信息：</p>
<p>怎么解决以上问题呢？我们通过sys模式查看分区信息的数据字典,如下：</p>
<p>可以看出子分区不叫SUB1，而是P1_SUB1,重新查询信息，如下图所示：</p>
<p>有关表分区的一些维护性操作：
一、添加分区
以下代码给SALES表添加了一个P3分区
ALTER TABLE SALES ADD PARTITION P3 VALUES LESS THAN(TO_DATE(&#39;2003-06-01&#39;,&#39;YYYY-MM-DD&#39;));
注意：以上添加的分区界限应该高于最后一个分区界限。</p>
<p>以下代码给SALES表的P3分区添加了一个P3SUB1子分区
ALTER TABLE SALES MODIFY PARTITION P3 ADD SUBPARTITION P3SUB1 VALUES(&#39;COMPLETE&#39;);</p>
<p>二、删除分区
以下代码删除了P3表分区：
ALTER TABLE SALES DROP PARTITION P3;</p>
<p>在以下代码删除了P4SUB1子分区：
ALTER TABLE SALES DROP SUBPARTITION P4SUB1;
注意：如果删除的分区是表中唯一的分区，那么此分区将不能被删除，要想删除此分区，必须删除表。</p>
<p>三、截断分区
截断某个分区是指删除某个分区中的数据，并不会删除分区，也不会删除其它分区中的数据。当表中即使只有一个分区时，也可以截断该分区。通过以下代码截断分区：
ALTER TABLE SALES TRUNCATE PARTITION P2;
通过以下代码截断子分区：
ALTER TABLE SALES TRUNCATE SUBPARTITION P2SUB2;</p>
<p>四、合并分区
合并分区是将相邻的分区合并成一个分区，结果分区将采用较高分区的界限，值得注意的是，不能将分区合并到界限较低的分区。以下代码实现了P1 P2分区的合并：
ALTER TABLE SALES MERGE PARTITIONS P1,P2 INTO PARTITION P2;</p>
<p>五、拆分分区
拆分分区将一个分区拆分两个新分区，拆分后原来分区不再存在。注意不能对HASH类型的分区进行拆分。
ALTER TABLE SALES SBLIT PARTITION P2 AT(TO_DATE(&#39;2003-02-01&#39;,&#39;YYYY-MM-DD&#39;))
INTO (PARTITION P21,PARTITION P22);</p>
<p>六、接合分区(coalesca)
结合分区是将散列分区中的数据接合到其它分区中，当散列分区中的数据比较大时，可以增加散列分区，然后进行接合，值得注意的是，接合分区只能用于散列分区中。通过以下代码进行接合分区：
ALTER TABLE SALES COALESCA PARTITION;</p>
<p>七、重命名表分区
以下代码将P21更改为P2
ALTER TABLE SALES RENAME PARTITION P21 TO P2;</p>
<p>九、跨分区查询
select sum( /<em>) from (
(select count(/</em>) cn from t_table_SS PARTITION (P200709_1)
union all
select count(/*) cn from t_table_SS PARTITION (P200709_2));</p>
<p>十、查询表上有多少分区
SELECT /* FROM useR_TAB_PARTITIONS WHERE TABLE_NAME=&#39;tableName&#39;</p>
<p>十一、查询索引信息
select object_name,object_type,tablespace_name,sum(value)
from v$segment_statistics
where statistic_name IN (&#39;physical reads&#39;,&#39;physical write&#39;,&#39;logical reads&#39;)and object_type=&#39;INDEX&#39;
group by object_name,object_type,tablespace_name
order by 4 desc</p>
<p>--显示数据库所有分区表的信息：
select /* from DBA_PART_TABLES</p>
<p>--显示当前用户可访问的所有分区表信息:
select /* from ALL_PART_TABLES</p>
<p>--显示当前用户所有分区表的信息：
select /* from USER_PART_TABLES</p>
<p>--显示表分区信息 显示数据库所有分区表的详细分区信息：
select /* from DBA_TAB_PARTITIONS</p>
<p>--显示当前用户可访问的所有分区表的详细分区信息：
select /* from ALL_TAB_PARTITIONS</p>
<p>--显示当前用户所有分区表的详细分区信息：
select /* from USER_TAB_PARTITIONS</p>
<p>--显示子分区信息 显示数据库所有组合分区表的子分区信息：
select /* from DBA_TAB_SUBPARTITIONS</p>
<p>--显示当前用户可访问的所有组合分区表的子分区信息：
select /* from ALL_TAB_SUBPARTITIONS</p>
<p>--显示当前用户所有组合分区表的子分区信息：
select /* from USER_TAB_SUBPARTITIONS</p>
<p>--显示分区列 显示数据库所有分区表的分区列信息：
select /* from DBA_PART_KEY_COLUMNS</p>
<p>--显示当前用户可访问的所有分区表的分区列信息：
select /* from ALL_PART_KEY_COLUMNS</p>
<p>--显示当前用户所有分区表的分区列信息：
select /* from USER_PART_KEY_COLUMNS</p>
<p>--显示子分区列 显示数据库所有分区表的子分区列信息：
select /* from DBA_SUBPART_KEY_COLUMNS</p>
<p>--显示当前用户可访问的所有分区表的子分区列信息：
select /* from ALL_SUBPART_KEY_COLUMNS</p>
<p>--显示当前用户所有分区表的子分区列信息：
select /* from USER_SUBPART_KEY_COLUMNS</p>
<p>--怎样查询出oracle数据库中所有的的分区表
select /* from user_tables a where a.partitioned=&#39;YES&#39;</p>
<p>--删除一个表的数据是
truncate table table_name;</p>
<p>--删除分区表一个分区的数据是
alter table table_name truncate partition p5;</p>
<p>注：分区根据具体情况选择。</p>
<p>表分区有以下优点：
1、数据查询：数据被存储到多个文件上，减少了I/O负载，查询速度提高。
2、数据修剪：保存历史数据非常的理想。
3、备份：将大表的数据分成多个文件，方便备份和恢复。</p>
<h1 id="4-dml-">4、并行性：可以同时向表中进行DML操作，并行性性能提高。</h1>
<p>索引：
1、一般索引：
create index index_name on table(col_name);
2、Oracle 分区索引详解
语法：Table Index
CREATE [UNIQUE|BITMAP] INDEX [schema.]index_name
ON [schema.]table_name [tbl_alias]
(col [ASC | DESC]) index_clause index_attribs</p>
<p>index_clauses:
分以下两种情况</p>
<ol>
<li>Local Index
就是索引信息的存放位置依赖于父表的Partition信息，换句话说创建这样的索引必须保证父表是Partition
1.1 索引信息存放在父表的分区所在的表空间。但是仅可以创建在父表为HashTable或者composite分区表的。
LOCAL STORE IN (tablespace)
1.2 仅可以创建在父表为HashTable或者composite分区表的。并且指定的分区数目要与父表的分区数目要一致
LOCAL STORE IN (tablespace) (PARTITION [partition [LOGGING|NOLOGGING] [TABLESPACE {tablespace|DEFAULT}] [PCTFREE int] [PCTUSED int] [INITRANS int] [MAXTRANS int] [STORAGE storage_clause] [STORE IN {tablespace_name|DEFAULT] [SUBPARTITION [subpartition [TABLESPACE tablespace]]]])</li>
</ol>
<p>1.3 索引信息存放在父表的分区所在的表空间，这种语法最简单，也是最常用的分区索引创建方式。
Local
1.4 并且指定的Partition 数目要与父表的Partition要一致
LOCAL (PARTITION [partition
[LOGGING|NOLOGGING]
[TABLESPACE {tablespace|DEFAULT}]
[PCTFREE int]
[PCTUSED int]
[INITRANS int]
[MAXTRANS int]
[STORAGE storage_clause]
[STORE IN {tablespace_name|DEFAULT]
[SUBPARTITION [subpartition [TABLESPACE tablespace]]]])</p>
<p>Global Index
索引信息的存放位置与父表的Partition信息完全不相干。甚至父表是不是分区表都无所谓的。语法如下：
GLOBAL PARTITION BY RANGE (col_list)
( PARTITION partition VALUES LESS THAN (value_list)
[LOGGING|NOLOGGING]
[TABLESPACE {tablespace|DEFAULT}]
[PCTFREE int]
[PCTUSED int]
[INITRANS int]
[MAXTRANS int]
[STORAGE storage_clause] )
但是在这种情况下，如果父表是分区表，要删除父表的一个分区都必须要更新Global Index ,否则索引信息不正确
ALTER TABLE TableName DROP PARTITION PartitionName Update Global Indexes</p>
<p>--查询索引
select object_name,object_type,tablespace_name,sum(value)
from v$segment_statistics
where statistic_name IN (&#39;physical reads&#39;,&#39;physical write&#39;,&#39;logical reads&#39;)and object_type=&#39;INDEX&#39;
group by object_name,object_type,tablespace_name
order by 4 desc</p>
<p>--删除分区
ALTER TABLE WID_SETT_TICKET_DAY_1100 DROP PARTITION P20100401;
--增加分区
ALTER TABLE WID_SETT_TICKET_DAY_1100 ADD PARTITION P20100401 VALUES (20100401) TABLESPACE ODSDATA_04 NOLOGGING;
--查找分区
select /*
from USER_TAB_PARTITIONS
where table_name = &#39;WID_SETT_TICKET_DAY_1100&#39;
and partition_name = &#39;P20100401&#39;; </p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/DB/">DB</a></li></span><span class="breadcrumb"><li><a href="/categories/DB/">DB</a></li><li><a href="/categories/DB/分区/">分区</a></li></span></span> | <span class="tags">Tagged <a href="/tags/DB/" class="label label-primary">DB</a><a href="/tags/分区/" class="label label-success">分区</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:35"datetime="2014-03-07 09:54:35"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-DB-分区--oracle的表空间、分区表、以及索引的总结/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-DB-分区--oracle的表空间、分区表、以及索引的总结" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-DB-mysql--MYSQL不能从远程连接的一个解决方法/">MYSQL不能从远程连接的一个解决方法</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:34.000Z"> <a href="/2014/02/02/2014-02-02-DB-mysql--MYSQL不能从远程连接的一个解决方法/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="mysql-">MYSQL不能从远程连接的一个解决方法</h1>
<p>所有栏目 服务器 社交网络 电子商务 注册破解 网络资讯 本站作品 搜索引擎 酷站欣赏 安全防护 精品美文 整站程序 入侵检测 精品美图 ASP程序 精美整站 常用技巧 免费空间 架站技术 搜索引擎 PHP程序 新闻文章 免费电影 精美音乐 平面设计 站长心得 .NET程序 精品MV 社区论坛 DIV+CSS 有奖活动 数据库技术 网络常识 其他免费 JSP程序 服务器安全 JavaScript 生活常识 Vbscript VB程序 其他程序  标题 作者 内容</p>
<ul>
<li><a href="http://www.haishui.net/index.php" target="_blank">首页</a></li>
<li><a href="http://www.haishui.net/list.php?tid=53" target="_blank">热点资讯</a></li>
<li><a href="http://www.haishui.net/list.php?tid=12" target="_blank">免费资源</a></li>
<li><a href="http://www.haishui.net/list.php?tid=11" target="_blank">网络编程</a></li>
<li><a href="http://www.haishui.net/list.php?tid=10" target="_blank">站长天地</a></li>
<li><a href="http://www.haishui.net/list.php?tid=16" target="_blank">网页设计</a></li>
<li><a href="http://www.haishui.net/list.php?tid=15" target="_blank">网络安全</a></li>
<li><a href="http://www.haishui.net/list.php?tid=13" target="_blank">精品赏析</a></li>
<li><a href="http://www.haishui.net/list.php?tid=17" target="_blank">程序下载</a></li>
<li><a href="http://www.haishui.net/proxy/index.php" target="_blank">代理IP</a>
<a href="http://www.haishui.net/list.php" target="_blank">死灰复燃那天才会有更新改版！ [08-05-19 14:49:51]</a></li>
</ul>
<p>当前位置：<a href="http://www.haishui.net/index.php" target="_blank">首 页</a> &gt;&gt; <a href="http://www.haishui.net/list.php?tid=10" target="_blank">站长天地</a> &gt;&gt; <a href="http://www.haishui.net/list.php?tid=30" target="_blank">数据库技术</a> &gt;&gt; <a href="http://www.haishui.net/view.php?tid=30&amp;id=483" target="_blank">MYSQL不能从远程连接的一个解决方法</a> <strong>MYSQL不能从远程连接的一个解决方法</strong> 搜集者：海水 发布时间：06-03-13 浏览次数：12483 [<a href="">大</a> <a href="">中</a> <a href="">小</a>] 如果你想连接你的mysql的时候发生这个错误：
以下是引用内容：
ERROR 1130: Host &#39;192.168.1.3&#39; is not allowed to connect to this MySQL server
解决方法：
1。 改表法。可能是你的帐号不允许从远程登陆，只能在localhost。这个时候只要在localhost的那台电脑，登入mysql后，更改 &quot;mysql&quot; 数据库里的 &quot;user&quot; 表里的 &quot;host&quot; 项，从&quot;localhost&quot;改称&quot;%&quot;
mysql -u root -pvmwaremysql&gt;use mysql;mysql&gt;update user set host = &#39;%&#39; where user = &#39;root&#39;;mysql&gt;select host, user from user;</p>
<ol>
<li>授权法。例如，你想myuser使用mypassword从任何主机连接到mysql服务器的话。
GRANT ALL PRIVILEGES ON /<em>./</em> TO &#39;myuser&#39;@&#39;%&#39; IDENTIFIED BY &#39;mypassword&#39; WITH GRANT OPTION;
如果你想允许用户myuser从ip为192.168.1.3的主机连接到mysql服务器，并使用mypassword作为密码
GRANT ALL PRIVILEGES ON /<em>./</em> TO &#39;myuser&#39;@&#39;192.168.1.3&#39; IDENTIFIED BY &#39;mypassword&#39; WITH GRANT OPTION;    相关附件：无  相关文章[MYSQL]：</li>
</ol>
<ul>
<li>[05-10-09] <a href="http://www.haishui.net/view.php?tid=30&amp;id=13" title=" MYSQL 5.0.13 RC发布" target="_blank">MYSQL 5.0.13 RC发布</a></li>
<li>[05-11-23] <a href="http://www.haishui.net/view.php?tid=1&amp;id=165" title="配置最新的PHP加MYSQL服务器" target="_blank">配置最新的PHP加MYSQL服务器</a></li>
<li>[05-12-03] <a href="http://www.haishui.net/view.php?tid=30&amp;id=184" title="MYSQL出错代码列表" target="_blank">MYSQL出错代码列表</a></li>
<li>[06-01-27] <a href="http://www.haishui.net/view.php?tid=39&amp;id=326" title="免费200MB，PHP，MYSQL，CGI，FTP空间" target="_blank">免费200MB，PHP，MYSQL，CGI，FTP空间</a></li>
<li>[06-09-29] <a href="http://www.haishui.net/view.php?tid=30&amp;id=893" title="MYSQL常见出错代码" target="_blank">MYSQL常见出错代码</a> 下一篇：[06-03-13] <a href="http://www.haishui.net/view.php?tid=58&amp;id=484" title="一个馒头引发的血案" target="_blank">一个馒头引发的血案</a> 上一篇：[06-03-13] <a href="http://www.haishui.net/view.php?tid=5&amp;id=482" title="女生教你怎么追MM--送给没有女朋友的朋友" target="_blank">女生教你怎么追MM--送给没有女朋友的朋友</a> 相关评论： 添加评论:  Email: 验证码: <img src="" alt=""> 评论[最多255字节]:</li>
</ul>
<h2 id="-">广告时间</h2>
<h2 id="-">搜索信息</h2>
<p>输入您的搜索字词 站内搜索 网络搜索
提交搜索表单</p>
<h2 id="-">置顶文章</h2>
<h2 id="-">推荐文章</h2>
<h2 id="-">点击排行</h2>
<ul>
<li><a href="http://www.haishui.net/view.php?tid=30&amp;id=719" title="MySQL开发中的外键与参照完整性" target="_blank">MySQL开发中的外键与参照完整性</a></li>
<li><a href="http://www.haishui.net/view.php?tid=30&amp;id=483" title="MYSQL不能从远程连接的一个解决方法" target="_blank">MYSQL不能从远程连接的一个解决方法</a></li>
<li><a href="http://www.haishui.net/view.php?tid=30&amp;id=150" title="SQL Server 2000安装图解" target="_blank">SQL Server 2000安装图解</a></li>
<li><a href="http://www.haishui.net/view.php?tid=30&amp;id=215" title="忘记MySQL密码的更改方法" target="_blank">忘记MySQL密码的更改方法</a></li>
<li><a href="http://www.haishui.net/view.php?tid=30&amp;id=419" title="远程连接sql server 2000服务器的解决方案" target="_blank">远程连接sql server 2000服务器的解决方案..</a></li>
<li><a href="http://www.haishui.net/view.php?tid=30&amp;id=720" title="MySQL字段类型说明" target="_blank">MySQL字段类型说明</a></li>
<li><a href="http://www.haishui.net/view.php?tid=30&amp;id=13" title=" MYSQL 5.0.13 RC发布" target="_blank">MYSQL 5.0.13 RC发布</a>
版权所有 海水工作室 程序支持 海水 &amp; Spring 界面风格 MacroLong    <a href="http://www.miibeian.gov.cn/" target="_blank">晋ICP备05007933号</a></li>
</ul>
<p>本站所有信息均转载自网络，供大家阅读、使用，不负责任何侵权行为。</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/DB/">DB</a></li></span><span class="breadcrumb"><li><a href="/categories/DB/">DB</a></li><li><a href="/categories/DB/mysql/">mysql</a></li></span></span> | <span class="tags">Tagged <a href="/tags/DB/" class="label label-primary">DB</a><a href="/tags/mysql/" class="label label-success">mysql</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:34"datetime="2014-03-07 09:54:34"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-DB-mysql--MYSQL不能从远程连接的一个解决方法/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-DB-mysql--MYSQL不能从远程连接的一个解决方法" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-DB-oracle--高水位线HighWaterMark-oracle性能优化/">高水位线(High Water Mark) </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:34.000Z"> <a href="/2014/02/02/2014-02-02-DB-oracle--高水位线HighWaterMark-oracle性能优化/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-high-water-mark-oracle-">高水位线(High Water Mark) - oracle性能优化</h1>
<p>  <a href="http://blog.chinaunix.net/" target="_blank">博客首页</a> <a href="http://blog.chinaunix.net/register.php" target="_blank">注册</a> <a href="http://bbs.chinaunix.net/forumdisplay.php?fid=51" target="_blank">建议与交流</a> <a href="http://blog.chinaunix.net/top/" target="_blank">排行榜</a> <a href="http://blog.chinaunix.net/u2/60332/" target="_blank">加入友情链接</a>  <img src="" alt=""> <a href="http://blog.chinaunix.net/u2/star.php?blogid=60332" title="给此博客推荐值" target="_blank">推荐</a> <a href="http://blog.chinaunix.net/u2/complaint.php?blogid=60332" title="投诉此博客" target="_blank">投诉</a> 搜索：  <a href="http://blog.chinaunix.net/help/" target="_blank">帮助</a>  <strong>huaihe0410</strong></p>
<p> 努力,坚持,成败在此    <a href="http://huaihe0410.cublog.cn/" target="_blank">huaihe0410.cublog.cn</a> </p>
<ul>
<li><a href="http://control.cublog.cn/" target="_blank">管理博客</a></li>
<li><a href="http://control.cublog.cn/article_new.php" target="_blank">发表文章</a></li>
<li><a href="http://blog.chinaunix.net/u2/60332/guestbook.html" target="_blank">留言</a></li>
<li><a href="http://blog.chinaunix.net/u2/60332/links.html" target="_blank">收藏夹</a></li>
<li><a href="http://blog.chinaunix.net/u2/60332/group.html" target="_blank">博客圈</a></li>
<li><a href="http://blog.chinaunix.net/u2/60332/music.html" target="_blank">音乐</a></li>
<li><a href="http://blog.chinaunix.net/u2/60332/photo.html" target="_blank">相册</a></li>
<li><p><a href="http://blog.chinaunix.net/u2/60332/article.html" target="_blank">文章</a></p>
</li>
<li><p><a href="http://blog.chinaunix.net/u2/60332/article_138247.html" target="_blank">· AIX</a></p>
</li>
<li><p><a href="http://blog.chinaunix.net/u2/60332/article_125862.html" target="_blank">· 协议   }</a></p>
</li>
<li><p><a href="http://blog.chinaunix.net/u2/60332/article_126906.html" target="_blank">· socket</a></p>
</li>
<li><a href="http://blog.chinaunix.net/u2/60332/article_93657.html" target="_blank">· jsp</a></li>
<li><p><a href="http://blog.chinaunix.net/u2/60332/article_77152.html" target="_blank">· linux/unix   }</a></p>
</li>
<li><p><a href="http://blog.chinaunix.net/u2/60332/article_138139.html" target="_blank">· cvs</a></p>
</li>
<li><a href="http://blog.chinaunix.net/u2/60332/article_120120.html" target="_blank">· 网络</a></li>
<li><a href="http://blog.chinaunix.net/u2/60332/article_133308.html" target="_blank">· shell</a></li>
<li><a href="http://blog.chinaunix.net/u2/60332/article_133261.html" target="_blank">· 指令</a></li>
<li><p><a href="http://blog.chinaunix.net/u2/60332/article_78134.html" target="_blank">· mysql   }</a></p>
</li>
<li><p><a href="http://blog.chinaunix.net/u2/60332/article_141554.html" target="_blank">· cluster</a></p>
</li>
<li><p><a href="http://blog.chinaunix.net/u2/60332/article_77026.html" target="_blank">· oracle   }</a></p>
</li>
<li><p><a href="http://blog.chinaunix.net/u2/60332/article_105725.html" target="_blank">· oracle 并行</a></p>
</li>
<li><a href="http://blog.chinaunix.net/u2/60332/article_105724.html" target="_blank">· oracle1011新特性</a></li>
<li><a href="http://blog.chinaunix.net/u2/60332/article_105726.html" target="_blank">· Oracle9i初始化参数中文说明</a></li>
<li><a href="http://blog.chinaunix.net/u2/60332/article_80194.html" target="_blank">· oracle性能优化</a></li>
<li><a href="http://blog.chinaunix.net/u2/60332/article_105313.html" target="_blank">· oracle索引组织表</a></li>
<li><a href="http://blog.chinaunix.net/u2/60332/article_80555.html" target="_blank">· oracle分区表</a></li>
<li><a href="http://blog.chinaunix.net/u2/60332/article_105723.html" target="_blank">· oracle函数</a></li>
<li><a href="http://blog.chinaunix.net/u2/60332/article_125712.html" target="_blank">· oracle字符集</a></li>
<li><a href="http://blog.chinaunix.net/u2/60332/article_110365.html" target="_blank">· PL/SQL</a></li>
<li><p><a href="http://blog.chinaunix.net/u2/60332/article_99870.html" target="_blank">· python   }</a></p>
</li>
<li><p><a href="http://blog.chinaunix.net/u2/60332/article_120449.html" target="_blank">· smtp</a></p>
</li>
<li><a href="http://blog.chinaunix.net/u2/60332/article_126980.html" target="_blank">· socket</a></li>
<li><a href="http://blog.chinaunix.net/u2/60332/article_126157.html" target="_blank">· 中文字符</a></li>
<li><a href="http://blog.chinaunix.net/u2/60332/article_97234.html" target="_blank">· resin/java</a></li>
<li><a href="http://blog.chinaunix.net/u2/60332/article_125210.html" target="_blank">· 编码</a></li>
<li><a href="http://blog.chinaunix.net/u2/60332/article_106939.html" target="_blank">· 编译</a></li>
<li><a href="http://blog.chinaunix.net/u2/60332/article_111905.html" target="_blank">· 测试</a></li>
<li><a href="http://blog.chinaunix.net/u2/60332/article_77025.html" target="_blank">· 其他</a></li>
<li><a href="http://blog.chinaunix.net/u2/60332/index.html" target="_blank">首页</a>  <strong>关于作者</strong> <img src="&quot;收起&quot;" alt="">   <a href="http://blog.chinaunix.net/u2/60332/" target="_blank"><img src="" alt=""></a>
<strong>我的分类</strong> <img src="&quot;收起&quot;" alt=""> 
<a href="http://blog.chinaunix.net/u2/rss.php?id=60332" target="_blank"><img src="" alt=""></a>
<strong>高水位线(High Water Mark)**</strong>什么是水线**(High Water Mark)?</li>
</ul>
<hr>
<p>所有的oracle段(segments，在此，为了理解方便，建议把segment作为表的一个同义词) 都有一个在段内容纳数据的上限，我们把这个上限称为&quot;high water mark&quot;或HWM。这个HWM是一个标记，用来说明已经有多少没有使用的数据块分配给这个segment。HWM通常增长的幅度为一次5个数据块，原则上HWM只会增大，不会缩小，即使将表中的数据全部删除，HWM还是为原值，由于这个特点，使HWM很象一个水库的历史最高水位，这也就是HWM的原始含义，当然不能说一个水库没水了，就说该水库的历史最高水位为0。但是如果我们在表上使用了truncate命令，则该表的HWM会被重新置为0。
<strong>HWM数据库的操作有如下影响：</strong>
a) 全表扫描通常要读出直到HWM标记的所有的属于该表数据库块，即使该表中没有任何数据。
b) 即使HWM以下有空闲的数据库块，键入在插入数据时使用了append关键字，则在插入时使用HWM以上的数据块，此时HWM会自动增大。
<strong>如何知道一个表的HWM？</strong>
a) 首先对表进行分析:
ANALYZE TABLE <tablename> ESTIMATE/COMPUTE STATISTICS;
b) SELECT blocks, empty_blocks, num_rows
FROM user_tables
WHERE table_name = <tablename>;
BLOCKS 列代表该表中曾经使用过得数据库块的数目，即水线。
EMPTY_BLOCKS 代表分配给该表，但是在水线以上的数据库块，即从来没有使用的数据块。
让我们以一个有28672行的BIG_EMP1表为例进行说明：
1) SQL&gt; SELECT segment_name,segment_type,blocks
FROM dba_segments
WHERE segment_name=&#39;BIG_EMP1&#39;;
SEGMENT_NAME SEGMENT_TYPE BLOCKS EXTENTS</p>
<hr>
<p>BIG_EMP1 TABLE 1024 2
1 row selected.
2) SQL&gt; ANALYZE TABLE big_emp1 ESTIMATE STATISTICS;
Statement processed.
3) SQL&gt; SELECT table_name,num_rows,blocks,empty_blocks
FROM user_tables
WHERE table_name=&#39;BIG_EMP1&#39;;
TABLE_NAME NUM_ROWS BLOCKS EMPTY_BLOCKS</p>
<hr>
<p>BIG_EMP1 28672 700 323
1 row selected.
<strong>注意：</strong>
BLOCKS + EMPTY_BLOCKS (700+323=1023)比DBA_SEGMENTS.BLOCKS少个数据库块，这是因为有一个数据库块被保留用作segment header。DBA_SEGMENTS.BLOCKS 表示分配给这个表的所有的数据库块的数目。USER_TABLES.BLOCKS表示已经使用过的数据库块的数目。
4) SQL&gt; SELECT COUNT (DISTINCT
DBMS_ROWID.ROWID_BLOCK_NUMBER(rowid)||
DBMS_ROWID.ROWID_RELATIVE_FNO(rowid)) &quot;Used&quot;
FROM big_emp1;</p>
<h2 id="used">Used</h2>
<p>700
1 row selected.
5) SQL&gt; DELETE from big_emp1;
28672 rows processed.
6) SQL&gt; commit;
Statement processed.
7) SQL&gt; ANALYZE TABLE big_emp1 ESTIMATE STATISTICS;
Statement processed.
8) SQL&gt; SELECT table_name,num_rows,blocks,empty_blocks
FROM user_tables
WHERE table_name=&#39;BIG_EMP1&#39;;
TABLE_NAME NUM_ROWS BLOCKS EMPTY_BLOCKS</p>
<hr>
<p>BIG_EMP1 0 700 323
1 row selected.
9) SQL&gt; SELECT COUNT (DISTINCT
DBMS_ROWID.ROWID_BLOCK_NUMBER(rowid)||
DBMS_ROWID.ROWID_RELATIVE_FNO(rowid)) &quot;Used&quot;
FROM big_emp1;</p>
<h2 id="used">Used</h2>
<p>0 -- 这表名没有任何数据库块容纳数据，即表中无数据
1 row selected.
10) SQL&gt; TRUNCATE TABLE big_emp1;
Statement processed.
11) SQL&gt; ANALYZE TABLE big_emp1 ESTIMATE STATISTICS;
Statement processed.
12) SQL&gt; SELECT table_name,num_rows,blocks,empty_blocks
2&gt; FROM user_tables
3&gt; WHERE table_name=&#39;BIG_EMP1&#39;;
TABLE_NAME NUM_ROWS BLOCKS EMPTY_BLOCKS</p>
<hr>
<p>BIG_EMP1 0 0 511
1 row selected.
13) SQL&gt; SELECT segment_name,segment_type,blocks
FROM dba_segments
WHERE segment_name=&#39;BIG_EMP1&#39;;
SEGMENT_NAME SEGMENT_TYPE BLOCKS EXTENTS</p>
<hr>
<p>BIG_EMP1 TABLE 512 1
1 row selected.
<strong>注意:</strong>
TRUNCATE命令回收了由delete命令产生的空闲空间，注意该表分配的空间由原先的1024块降为512块。
为了保留由delete命令产生的空闲空间，可以使用
TRUNCATE TABLE big_emp1 REUSE STORAGE
用此命令后，该表还会是原先的1024块。
/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em></p>
<p><strong>Oracle表段中的高水位线HWM</strong>  </p>
<p>在Oracle数据的存储中，可以把存储空间想象为一个水库，数据想象为水库中的水。水库中的水的位置有一条线叫做水位线，在Oracle中，这条线被称为高水位线（High-warter mark, HWM）。在数据库表刚建立的时候，由于没有任何数据，所以这个时候水位线是空的，也就是说HWM为最低值。当插入了数据以后，高水位线就会上涨，但是这里也有一个特性，就是如果你采用delete语句删除数据的话，数据虽然被删除了，但是高水位线却没有降低，还是你刚才删除数据以前那么高的水位。也就是说，这条高水位线在日常的增删操作中只会上涨，不会下跌。</p>
<p>下面我们来谈一下Oracle中Select语句的特性。Select语句会对表中的数据进行一次扫描，但是究竟扫描多少数据存储块呢，这个并不是说数据库中有多少数据，Oracle就扫描这么大的数据块，而是Oracle会扫描高水位线以下的数据块。现在来想象一下，如果刚才是一张刚刚建立的空表，你进行了一次Select操作，那么由于高水位线HWM在最低的0位置上，所以没有数据块需要被扫描，扫描时间会极短。而如果这个时候你首先插入了一千万条数据，然后再用delete语句删除这一千万条数据。由于插入了一千万条数据，所以这个时候的高水位线就在一千万条数据这里。后来删除这一千万条数据的时候，由于delete语句不影响高水位线，所以高水位线依然在一千万条数据这里。这个时候再一次用select语句进行扫描，虽然这个时候表中没有数据，但是由于扫描是按照高水位线来的，所以需要把一千万条数据的存储空间都要扫描一次，也就是说这次扫描所需要的时间和扫描一千万条数据所需要的时间是一样多的。所以有时候有人总是经常说，怎么我的表中没有几条数据，但是还是这么慢呢，这个时候其实奥秘就是这里的高水位线了。</p>
<pre><code>那有没有办法让高水位线下降呢，其实有一种比较简单的方法，那就是采用TRUNCATE语句进行删除数据。采用TRUNCATE语句删除一个表的数据的时候，类似于重新建立了表，不仅把数据都删除了，还把HWM给清空恢复为0。所以如果需要把表清空，在有可能利用TRUNCATE语句来删除数据的时候就利用TRUNCATE语句来删除表，特别是那种数据量有可能很大的临时存储表。

在手动段空间管理（Manual Segment Space Management）中，段中只有一个HWM，但是在Oracle9iRelease1才添加的自动段空间管理（Automatic Segment Space Management）中，又有了一个低HWM的概念出来。为什么有了HWM还又有一个低HWM呢，这个是因为自动段空间管理的特性造成的。在手段段空间管理中，当数据插入以后，如果是插入到新的数据块中，数据块就会被自动格式化等待数据访问。而在自动段空间管理中，数据插入到新的数据块以后，数据块并没有被格式化，而是在第一次在第一次访问这个数据块的时候才格式化这个块。所以我们又需要一条水位线，用来标示已经被格式化的块。这条水位线就叫做低HWM。一般来说，低HWM肯定是低于等于HWM的。
</code></pre><p>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>/<em>/</em>
<strong>修正ORACLE表的高水位线</strong></p>
<p>在ORACLE中，执行对表的删除操作不会降低该表的高水位线。而全表扫描将始终读取一个段(extent)中所有<strong>低于高水位线标记</strong>的块。如果在执行删除操作后不降低高水位线标记，则将导致查询语句的性能低下。下面的方法都可以降低高水位线标记。</p>
<p>1.执行表重建指令 alter table <em>table_name</em> move;
(在线转移表空间ALTER TABLE 。。。 MOVE TABLESPACE 。。。
 ALTER TABLE 。。。 MOVE 后面不跟参数也行，
 不跟参数表还是在原来的表空间，move后记住重建索引
 如果以后还要继续向这个表增加数据，没有必要move，
 只是释放出来的空间，只能这个表用，其他的表或者segment无法使用该空间
 )
2.执行alter table <em>table_name</em> shrink space; 注意，此命令为Oracle 10g新增功能，再执行该指令之前必须允许行移动 alter table <em>table_name</em> enable row movement;
3.复制要保留的数据到临时表t，drop原表，然后rename临时表t为原表
4.emp/imp
5.alter   table  table_name  deallocate   unused<br>6.尽量truncate 吧</p>
<p>   发表于： 2008-03-13，修改于： 2008-03-13 16:42 已浏览4027次，有评论1条 <a href="http://blog.chinaunix.net/u2/star.php?blogid=60332&amp;artid=495441" title="推荐这篇文章" target="_blank">推荐</a> <a href="http://blog.chinaunix.net/u2/complaint.php?blogid=60332&amp;artid=495441" title="投诉这篇文章" target="_blank">投诉</a>
  <strong>网友评论</strong>  <strong>凝结水晶</strong> 时间：2010-06-20 14:09:09 IP地址：122.233.180.★  <em>**</em> SQL&gt; select  EMPTY_BLOCKS,NUM_ROWS,BLOCKS,AVG_SPACE,AVG_ROW_LEN from user_tables where TABLE_NAME=upper(&#39;lyq_index_test&#39;);
EMPTY_BLOCKS   NUM_ROWS     BLOCKS  AVG_SPACE AVG_ROW_LEN</p>
<hr>
<pre><code>      98     821426       3358       3330         116
</code></pre><p>Elapsed: 00:00:00.05
SQL&gt; 
SQL&gt; 
SQL&gt; 
SQL&gt; select  segment_name,segment_type,blocks 
  2  from dba_segments
  3  where segment_name=upper(&#39;lyq_index_test&#39;);
SEGMENT_NAME                                                                      SEGMENT_TYPE           BLOCKS</p>
<hr>
<p>LYQ_INDEX_TEST                                                                    TABLE                    3456
为什么我从user_tables 表中出来的和dba_segments中出来的blocks是相等的？不是说会有一个保留的segments作为header吗？
  <strong>发表评论</strong> Copyright © 2001-2010 ChinaUnix.net All Rights Reserved</p>
<p>感谢所有关心和支持过ChinaUnix的朋友们
页面生成时间：0.07427</p>
<p><a href="http://www.miibeian.gov.cn/" target="_blank">京ICP证041476号</a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/DB/">DB</a></li></span><span class="breadcrumb"><li><a href="/categories/DB/">DB</a></li><li><a href="/categories/DB/oracle/">oracle</a></li></span></span> | <span class="tags">Tagged <a href="/tags/DB/" class="label label-primary">DB</a><a href="/tags/oracle/" class="label label-success">oracle</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:34"datetime="2014-03-07 09:54:34"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-DB-oracle--高水位线HighWaterMark-oracle性能优化/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-DB-oracle--高水位线HighWaterMark-oracle性能优化" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>





<ul id="pagination" class="pagination pagination-lg">
  <li><a class="extend prev" href="/page/123/">&laquo;</a></li><li><a class="page-number" href="/">1</a></li><li><a class="page-number" href="/page/2/">2</a></li><li><span class="space">&hellip;</span></li><li><a class="page-number" href="/page/121/">121</a></li><li><a class="page-number" href="/page/122/">122</a></li><li><a class="page-number" href="/page/123/">123</a></li><li class="active"><li><span class="page-number current">124</span></li><li><a class="page-number" href="/page/125/">125</a></li><li><a class="page-number" href="/page/126/">126</a></li><li><a class="page-number" href="/page/127/">127</a></li><li><span class="space">&hellip;</span></li></li><li><a class="page-number" href="/page/161/">161</a></li><li><a class="page-number" href="/page/162/">162</a></li><li><a class="extend next" href="/page/125/">&raquo;</a></li>
  <div class="clearfix"></div>
</ul></div><!--wapper-->
       </div><!-- ID main-col END -->
       <aside id="sidebar" class="alignright col-sx-6 col-sm-4 col-md-3 col-lg-3">
<div id="widget_search" class="widget panel panel-primary">
    <form action="//google.com/search" method="get" accept-charset="utf-8">
  <div class="input-group">
    <input class="form-control" id="searchbox" type="search" name="q" results="0" placeholder="search">
    <span class="input-group-btn">
      <button class="btn btn-default" type="submit">Go!</button>
    </span>
    <input type="hidden" name="q" value="site:itsolife.com">
  </div>
</form>
</div>

<div id="widget_category" class="widget panel panel-primary">
  <div class="panel-heading">category</div>  <div data-src='category' class='ajax_widgets'>正在加载...</div>
</div>

<div id="widget_recent_posts" class="widget panel panel-primary">
  <div class="panel-heading">recent posts</div>  <div data-src='recent_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_tagcloud" class="widget panel panel-primary">
  <div class="panel-heading">tagcloud</div>  <div data-src='tagcloud' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_latest_update_posts" class="widget panel panel-primary">
  <div class="panel-heading">最近更新</div>  <div data-src='latest_update_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_recent_comments" class="widget panel panel-primary">
  <div class="panel-heading">recent comments</div>  

<div class="list-group-item ds-recent-comments" data-num-items="6" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="50"></div>



</div>

</aside>
       <div class="clearfix"></div>
     </div><!-- row END -->
  </div>
  <footer id="footer" class="container">
  <div class="panel panel-info">
  <section id='footer_widget'></section>  <div class="panel-footer">
  <div id="site-info">
    <span class='author'>
  
  &copy; 2014 RobinChia
  
    &nbsp;&nbsp;</span>
  
  <span id='analytics-51la'></span><span id='analytics-google'>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-48559895-1']);
  _gaq.push(['_trackPageview']);
  _js2load.push({src:('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'});
</script></span><span id='analytics-cnzz'>
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_5774006'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s17.cnzz.com/stat.php%3Fid%3D5774006%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
</span><span id='analytics-baidu'>
<script>
var _hmt = _hmt || [];
_js2load.push({src:"//hm.baidu.com/hm.js?1442f50724afc42380b51f097c43082c"});
</script>
</span>  </div>
  <div id="copyright">Site powered by <a href='http://zespia.tw/hexo/'><strong>hexo</strong></a>  update time: <em>2014-04-07 17:26:53</em></span></div>
</div>
<div class="clearfix"></div>


  </div>
  </footer>
  
        <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>        
        <script src="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/js/bootstrap.min.js"></script>        
                
        <script src="http://cdn.bootcss.com/prettify/r298/prettify.min.js"></script>    <script type="text/javascript">
   var lang=["bsh", "c", "cc", "cpp", "cs", "csh", "cyc", "cv", "htm", "html",
    "java", "js", "m", "mxml", "perl", "pl", "pm", "py", "rb", "sh",
    "xhtml", "xml", "xsl"];
   var pretty_base='';
   $('script').each(function(){
	var c = $(this).attr('src');
	if (!c)
	    return;
	if (c.match(/(\/)?prettify(\.min)?\.js/i))
	{
	    var index = c.lastIndexOf('/');
	    if (index != -1)
		pretty_base = c.substr(0,index + 1);
	    return false;
	}
   })
   $('pre code').each(function(){
	var c = $(this).attr('class')
	if (!c)
	    return;
	c = c.match(/\s?(lang\-\w+)/i);
	if (c && lang.indexOf(c[1]) == -1)
	{
	    lang.push(c[1]);
	    $.getScript(pretty_base + c[1] + '.min.js');
	}
   })

    $(window).load(function(){
       $("pre").addClass("prettyprint");
       prettyPrint();
    })
</script>    
            <script type="text/javascript">
var duoshuoQuery = {short_name:"robinchia"};
_js2load.push({src:'http://static.duoshuo.com/embed.js',charset:'UTF-8'});
</script>
    
            <!--wumii_relatedItems-->
    
        <script src="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js"></script>    <script type="text/javascript">
(function($){
  $('.entry').each(function(i){
    $(this).find('img').each(function(){
      var alt = this.alt;

      if (alt){
        $(this).before('<span class="caption">' + alt + '</span>');
      }

      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="fancybox' + i + '" />');
    });
  });

  $('.fancybox').fancybox();
})(jQuery);
</script>    
        <script src="http://cdn.bootcss.com/mathjax/2.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>
    
<script type="text/javascript">
$('.ajax_widgets').each(function(){var src=$(this).attr('data-src');if(src)$(this).load('/widgets/'+src+'.html');});
$.each(_js2load,function(index,obj){loadjs(obj.src,obj.charset)});
</script>

<div id="scroll2top">
<img src="/scroll2top/arrow.png"/>
</div>
<script src="/scroll2top/scroll2top.min.js"></script>
<div id="winterland">
  <canvas></canvas>
</div>
<script src="/js/winterland.min.js"></script>

  </body>
</html>
