
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>The 104 Page | It so life</title>
<meta name="author" content="RobinChia">

<meta name="description" content="It so life">


<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta property="og:site_name" content="It so life"/>

<!--[if IE]><style>.testIE.IE{display:inline;}</style><![endif]-->
<!--[if lte IE 7]><link rel="stylesheet" href="/css/ie7.css" type="text/css"><![endif]-->
<!--[if (lt IE 9)&(gt IE 7)]><style>.testIE.IE8{display:inline;}</style><![endif]-->
<!--[if gt IE 8]><style>.testIE.IE9{display:inline;}</style><![endif]-->

<link href="/favicon.png" rel="icon">
<link rel="alternate" href="/atom.xml" title="It so life Feed" type="application/atom+xml">

<link rel="stylesheet" href="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.0.3/css/font-awesome.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/prettify/r298/prettify.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" type="text/css">
<link rel="stylesheet" href="/css/style.css" type="text/css">
<!--[if lt IE 9]>
   <style>article,aside,dialog,footer,header,section,footer,nav,figure,menu{display:block}</style>
   <script src="http://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
   <script src="http://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
<link href="http://cdn.staticfile.org/respond.js/1.4.2/respond-proxy.html" id="respond-proxy" rel="respond-proxy" />
<link href="/js/respond.proxy.gif" id="respond-redirect" rel="respond-redirect" />
<script src="/js/respond.proxy.js"></script>
   <script src="http://cdn.bootcss.com/selectivizr/1.0.2/selectivizr-min.js"></script>
<![endif]-->
<script type="text/javascript">
function loadjs(c,d){var a=document.createElement("script");a.async=!0;a.type="text/javascript";a.src=c;a.charset=d||"gbk";(document.getElementsByTagName("HEAD")[0]||document.getElementsByTagName("BODY")[0]).appendChild(a)};
var _protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
var _js2load = [];
</script>

</head>
<body>
      <header id="header" class="container"><nav id="main-nav" class="navbar navbar-default navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="/">It so life</a>
    </div>
    <div  class="collapse navbar-collapse">
      <ul  class="nav navbar-nav">
  
        <li><a href="/" title="Home">Home</a></li>      
        <li><a href="/about/" title="About">About</a></li>      
        <li><a href="/archives/" title="Archives">Archives</a></li>      
      <li class='dropdown'>
        <a class='dropdown-toggle' data-toggle='dropdown' href='#'>website<b class='caret'></b></a>
        <ul class='dropdown-menu pure-menu-selected'>
    
          <li><a href="//groups.google.com/forum/#!forum/pongba" title="TopLanguage">TopLanguage</a></li>    
          <li><a href="//itpub.net/" title="ITPub">ITPub</a></li>    
          <li><a href="//blog.jobbole.com/" title="Bole">Bole</a></li>    
          <li><a href="//nosql-database.org/" title="nosql">nosql</a></li>    
          <li><a href="//gitimmersion.googol.im/" title="Git">Git</a></li>    
        </ul>
      </li>
    
      </ul>
      <ul class="nav navbar-nav navbar-right">
      
        <li><a href="/atom.xml">RSS</a></li>
      
      
        <li><a href="https://twitter.com/robinchia">twitter</a></li>
      
      
      
      
        <li><a href="https://github.com/robinchia">github</a></li>
      
      </ul>
    </div>
  </div>
</nav>
<div class="clearfix"></div>
</header>
  <div id='content' class="container">
     <div class="page-header-wrapper">
      <!--[if lt IE 9]><div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong>提示:</strong>您的浏览器版本太低了,建议升级到 <strong><a href="http://windows.microsoft.com/zh-cn/internet-explorer/download-ie" title="IE9">IE9</a></strong> 以上,本站使用<a href="https://www.google.com/intl/zh-CN/chrome/">Chrome浏览器</a>可以获得最好的显示效果.</div><![endif]-->
      <div class="page-header"><h1 align="center"><big>It so life</big> </h1>
        <h5 align="center"><big>love as life</big></h5>
      </div>
     </div>
     <div class="row">
       <div id="main-col" class="alignleft col-sx-12 col-sm-8 col-md-9 col-lg-9">
      <section id='header_widget'></section>
          <div id="wrapper"><article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-Httpclient--AdvancedHTTPClientInfo/">Advanced HTTPClient Info</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:37.000Z"> <a href="/2014/02/02/2014-02-02-Httpclient--AdvancedHTTPClientInfo/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="advanced-httpclient-info">Advanced HTTPClient Info</h1>
<h1 id="advanced-httpclient-info">Advanced HTTPClient Info</h1>
<h2 id="contents">Contents</h2>
<ul>
<li><a href="http://www.innovation.ch/java/HTTPClient/advanced_info.html#proxies" target="_blank">Proxies</a></li>
<li><a href="http://www.innovation.ch/java/HTTPClient/advanced_info.html#timeouts" target="_blank">Timeouts</a></li>
<li><a href="http://www.innovation.ch/java/HTTPClient/advanced_info.html#out_streams" target="_blank">Output Streams</a></li>
<li><a href="http://www.innovation.ch/java/HTTPClient/advanced_info.html#contexts" target="_blank">Contexts</a></li>
<li><a href="http://www.innovation.ch/java/HTTPClient/advanced_info.html#pers_con" target="_blank">Persistent Connections (Keep-Alive&#39;s)</a></li>
<li><a href="http://www.innovation.ch/java/HTTPClient/advanced_info.html#close_con" target="_blank">Closing Connections</a></li>
<li><a href="http://www.innovation.ch/java/HTTPClient/advanced_info.html#pipelining" target="_blank">Pipelining</a></li>
<li><a href="http://www.innovation.ch/java/HTTPClient/advanced_info.html#conn_details" target="_blank">Relationship between HTTPConnection instances and TCP connections</a></li>
<li><a href="http://www.innovation.ch/java/HTTPClient/advanced_info.html#threading" target="_blank">Multithreading</a></li>
<li><a href="http://www.innovation.ch/java/HTTPClient/advanced_info.html#urlcon" target="_blank">HttpURLConnection</a></li>
<li><a href="http://www.innovation.ch/java/HTTPClient/advanced_info.html#prot_vers" target="_blank">Protocol Version</a></li>
<li><a href="http://www.innovation.ch/java/HTTPClient/advanced_info.html#modules" target="_blank">Modules</a></li>
<li><a href="http://www.innovation.ch/java/HTTPClient/advanced_info.html#properties" target="_blank">Java System Properties recognized by HTTPClient</a></li>
<li><a href="http://www.innovation.ch/java/HTTPClient/advanced_info.html#headers" target="_blank">HTTP Header Fields</a></li>
<li><a href="http://www.innovation.ch/java/HTTPClient/advanced_info.html#specs" target="_blank">HTTP (and related) Specifications</a></li>
</ul>
<h2 id="-proxies-"><a href="">Proxies</a></h2>
<p>Support for proxies (including SOCKS) is fully implemented. However, using proxies in applets is subject to a number of security restrictions (see <a href="http://www.innovation.ch/java/HTTPClient/security.html" target="_blank">security</a> for more information on the various security policies and the consequences that arise from them). If you are using an http proxy then use the <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html#setProxyServer(java.lang.String, int" target="_blank">HTTPConnection.setProxyServer()</a>) method to set the default proxy for all new HTTPConnections; <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html#setCurrentProxy(java.lang.String, int" target="_blank">HTTPConnection.setCurrentProxy()</a>) can be used to set a proxy for the current HTTPConnection only. You can also manipulate a list of hosts for which no proxy is to be used with the methods <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html#dontProxyFor(java.lang.String" target="_blank">HTTPConnection.dontProxyFor()</a>) and <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html#doProxyFor(java.lang.String" target="_blank">HTTPConnection.doProxyFor()</a>). Example:
HTTPConnection.setProxyServer(&quot;my.proxy.dom&quot;, 8008); HTTPConnection.dontProxyFor(&quot;localhost&quot;); HTTPConnection.dontProxyFor(&quot;.mycompany.com&quot;); AuthorizationInfo.addBasicAuthorization(&quot;my.proxy.dom&quot;, 8008, realm, user, passwd); ... HTTPConnection con = new HTTPConnection(...);This will cause all connections to use the proxy (and automatically authenticate with it) except when connecting to localhost or any other machine within the company.</p>
<p>If you are using SOCKS then the method to use is <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html#setSocksServer(java.lang.String" target="_blank">setSocksServer()</a>). Note that both an http proxy and a SOCKS proxy can be set at the same time, in which case a request is sent via the SOCKS server to the proxy server, which in turn relays the request to the desired destination.</p>
<p>Some proxies will proxy for protocols other than http using http to contact the proxy itself. If you have such a proxy then you can use the HTTPClient to do requests for other protocols through the proxy. To do this you need to create an HTTPConnection to the proxy itself (i.e. <em>don&#39;t</em> use <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html#setCurrentProxy(java.lang.String, int" target="_blank">setCurrentProxy()</a>) or <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html#setProxyServer(java.lang.String, int" target="_blank">setProxyServer()</a>)) and specify the full URL of the file/article/whatever in the Get(), Put(), etc. Example: if you want to retrieve the file /pub/README via ftp from rtfm.mit.edu then you could use something like:
HTTPConnection proxy = new HTTPConnection(&quot;my.proxy.dom&quot;, 8000); HTTPResponse resp = proxy.Get(&quot;ftp://rtfm.mit.edu/pub/README&quot;); ...</p>
<h2 id="-timeouts-"><a href="">Timeouts</a></h2>
<p>Sometimes one doesn&#39;t want to wait (almost) forever until a connection is established to the server or until the server answers. In this case a timeout can be set using the methods <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html#setDefaultTimeout(int" target="_blank">HTTPConnection.setDefaultTimeout()</a>) and <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html#setTimeout(int" target="_blank">HTTPConnection.setTimeout()</a>). Setting a timeout will cause the client to limit the time it will spend trying to get the hosts IP-address and establishing a connection with the server, and it will also set the timeout on the socket while reading the response.</p>
<p><strong>Note:</strong> if a timeout occurs while reading the response (i.e. an InterruptedIOException is thrown) then doing another</p>
<p>read()
may or may not lose data, depending on what streams have been pushed on the response input stream. In general all HTTPClient streams are restartable, but those from the JDK aren&#39;t (e.g GZIPInputStream). This means that if such a stream has been pushed onto the stack (typically when a compression content-coding or transfer-coding was used) and an InterruptedIOException occurs then chances are the response data will be corrupted.</p>
<h2 id="-output-streams-"><a href="">Output Streams</a></h2>
<p>All request methods which may send data (such as POST and PUT) take either a byte[] or an <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HttpOutputStream.html" target="_blank">HttpOutputStream</a>. Using the latter may be beneficial when sending large amounts of data because it streams the data directly over the socket in many cases. However, restrictions on many servers may prevent the streaming, necessitating buffering of the data by the HttpOutputStream. The class documentation gives the full details, but in summary here are the things to consider: if you know the length of the data beforehand then use the appropriate constructor and you will be able to stream the data to any server. If you do not know the length beforehand then you may encounter problems, in which case you&#39;ll need to set the java system property HTTPClient.dontChunkRequests to true, and all data will be buffered by the client and only sent when the stream is close()&#39;d.</p>
<p>Various modules (such as the RedirectionModule and AuthorizationModule) need to resend certain requests in order to do their job. However, if the request used an HttpOutputStream then they cannot do so; in such cases the application will have to handle those statuses itself. In order to partially solve this problem, an application may set the java system property HTTPClient.deferStreamed to true. Requests which need resending (and which used an HttpOutputStream) are then remembered by the modules and the <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPResponse.html#retryRequest(" target="_blank">retry flag</a>) in the response is set to true. The application can then check this flag, and if it&#39;s true just blindly resend the request; the modules will detect the resend and apply the appropriate modifications (such as adding the necessary Authorization header field, or changing the request-uri to a new location).</p>
<h2 id="-contexts-"><a href="">Contexts</a></h2>
<p>By default all authorization info, cookies, permanent redirection lists, etc. are shared between all instance of HTTPConnection. However, there are cases where one wants to simulate multiple independent clients or users within the same application. To enable this the HTTPClient a supports a concept called contexts. Each HTTPConnection instance has an associated context, which can be any Object at all, and which can be set using (<a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html#setContext(java.lang.Object" target="_blank">HTTPConnection.setContext()</a>)). All instances of HTTPConnection which have the same context will share all info on cookies, authorization info, etc. This is done by having each <a href="http://www.innovation.ch/java/HTTPClient/advanced_info.html#modules" target="_blank">module</a> which keeps information on behalf of the application (such as the cookie module, the authorization module and the redirection module) use a separate list for each context. By setting the context for each HTTPConnection instance appropriately, you can control exactly which instances share data and which don&#39;t.</p>
<p>Note that you can&#39;t have more than one context per HTTPConnection, i.e. you need at least one separate instance of HTTPConnection for each client.</p>
<p>Example: suppose you want to simulate 3 independent clients, each having two HTTPConnection instances. Then you could do something like:
HTTPConnection cl1_con1 = new HTTPConnection(...); HTTPConnection cl1_con2 = new HTTPConnection(...); cl1_con1.setContext(&quot;client1&quot;); cl1_con2.setContext(&quot;client1&quot;); HTTPConnection cl2_con1 = new HTTPConnection(...); HTTPConnection cl2_con2 = new HTTPConnection(...); cl2_con1.setContext(&quot;client2&quot;); cl2_con2.setContext(&quot;client2&quot;); HTTPConnection cl3_con1 = new HTTPConnection(...); HTTPConnection cl3_con2 = new HTTPConnection(...); cl3_con1.setContext(&quot;client3&quot;); cl3_con2.setContext(&quot;client3&quot;);</p>
<p>As mentioned above, the context may be any object at all. So, if in the above example you were going to run each client in a separate thread then you could use the thread itself as the context (e.g.</p>
<p>con.setContext(Thread.currentThread());
). If no context is set a default context is used which is the same for all HTTPConnection&#39;s. Therefore applications which don&#39;t need this feature can just ignore it.</p>
<h2 id="-persistent-connections-keep-alive-s-"><a href="">Persistent Connections (Keep-Alive&#39;s)</a></h2>
<p>The Hypertext Transfer Protocol originally allowed only one request per TCP connection. However, establishing a TCP connection is fairly expensive time wise, so that some implementors of HTTP/1.0 added so called Keep-Alive&#39;s to keep a connection open after a request was completed and to allow further requests to be made over that connection. Unfortunately, this was not well defined and is broken in the face of proxies. HTTP/1.1 defines persistent connections correctly and even makes them the default.</p>
<p>The HTTPClient will by default try to keep a connection alive for as many requests as possible, both when talking to HTTP/1.0 and HTTP/1.1 servers. To disable persistent connections you can specify a Connection header with the value close. Example:
NVPair[] def_hdrs = { new NVPair(&quot;Connection&quot;, &quot;close&quot;) }; con.setDefaultHeaders(def_hdrs);</p>
<p>This will disable persistent connections for all future request (unless overridden by a connection header on the request method call).</p>
<p>Keeping the socket connection to the server open after a request is fine as long as another request follows within a short period of time. However when you are done you should let the library know by passing the above</p>
<p>&quot;Connection: close&quot;
header with the last request. Furthermore, to limit the length of time the connection will be held open a timer is started after each request which will close the socket connection if no further requests arrive within the next 60 seconds.</p>
<p>Note that most of this is transparent as far as the functioning of the requests is concerned; the only differences you will notice is in the time required for a request to be sent. Also note that persistent connections are only done within the context of a given instance of HTTPConnection; so if you create two instances both pointing at the same server then they will create separate connections to the server.</p>
<h2 id="-closing-connections-"><a href="">Closing Connections</a></h2>
<p>The HTTPClient will close a socket as soon as it has determined that no more data will arrive on the socket or that any outstanding data is to be discarded. However, this is not always easy to do, and in at least one common case the client will keep a connection open indefinitely unless a simple precaution is taken (see below).</p>
<p>A socket is closed when one of the five following conditions occurs:</p>
<ul>
<li>an exception occurs during read or write.</li>
<li>the connection timeout triggers and no responses are outstanding (note this is <em>not</em> the timeout set by <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html#setTimeout(int" target="_blank">HTTPConnection.setTimeout()</a>), but an internal, hard coded 60 second timeout).</li>
<li>all response streams on the connection have been closed, up to and including a terminal response.</li>
<li><a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html#stop(" target="_blank">stop()</a>) is invoked on the HTTPConnection.</li>
<li>the stream demultiplexer is finalized.</li>
</ul>
<p>A &quot;terminal&quot; response is a response for which client has determined that the connection should be closed after it has been fully received. This includes the server sending a</p>
<p>&quot;Connection: close&quot;
(in the case of an HTTP/1.1 server) or not sending a</p>
<p>Connection: keep-alive
(in the case of an HTTP/1.0 server) with the response, the response having no Content-length and no self-delimiting body, or the receipt of certain error status codes.</p>
<p>As can be seen from above, a basic condition for the connection to be closed is that the response streams have been closed. This is necessary because the client can&#39;t distinguish between a slow application which takes its time to read the response and an application which is not interested in the response. Failing to close the response streams can lead to a lot of open connections hanging around, which will eventually cause you to run out of file descriptors (on a Unix box - socket descriptors on Windoze). Therefore it is important that you <strong>always close the response stream</strong> of every response. This can be done either by invoking</p>
<p>resp.getData()
or invoking</p>
<p>close()
on the stream from</p>
<p>resp.getInputStream()
(where resp is the HTTPResponse). If you are not interested in the response data you can just do a</p>
<p>resp.getInputStream().close()
.</p>
<h2 id="-pipelining-"><a href="">Pipelining</a></h2>
<p>If the connection is kept open across requests then the requests may be pipelined. Pipelining here means that a new request is sent before the response to a previous request is received. Since this can obviously enhance performance by reducing the overall round-trip time for a series of requests to the same server, the HTTPClient has been written to support pipelining (at the expense of some extra code to keep track of the outstanding requests).</p>
<p>The programming model is always the same: for every request you send you get a response back which contains the headers and data of the servers response. Now, to support pipelining, the fields in the response aren&#39;t necessarily filled in yet when the HTTPResponse object is returned to the caller (i.e. the actual response headers and data haven&#39;t been read off the net), but the first call to any method in the response (e.g. a getStatusCode()) will wait till the response has actually been read and parsed. Also any previous requests will be forced to read their responses if they have not already done so (so e.g. if you send two consecutive requests and receive responses r1 and r2, calling</p>
<p>r2.getHeader(&quot;Content-type&quot;)
will first force the complete response r1 to be read before reading the response r2). All this should be completely transparent, except for the fact that invoking a method on one response may sometimes take a few seconds to complete, while the same method on a different response will return immediately with the desired info.</p>
<h2 id="-relationship-between-httpconnection-instances-and-tcp-connections-"><a href="">Relationship between HTTPConnection instances and TCP connections</a></h2>
<p>The relationship between an HTTPConnection instance and actual TCP connections (instances of java.net.Socket) is as follows: each HTTPConnection instance creates its own sockets, i.e. sockets are not shared between instances. Sockets are created on demand, just before a request is sent (so creating an HTTPConnection instance does <em>not</em> immediately cause a TCP connection to be opened). A new socket is only created if either the current socket (if any) has been closed, or the previous request/response over it has determined that it will be closed at the end that response.</p>
<p>Some implications of the above are that 1) applications can control the number of parallel TCP connections to some degree by creating multiple instances of HTTPConnection pointing to the same server, but 2) that control is not absolute: if the server does not support keep-alive&#39;s and the application sends requests before having the read the response to the previous request, then you may end up with multiple parallel TCP connections from the same HTTPConnection instance.</p>
<h2 id="-multithreading-"><a href="">Multithreading</a></h2>
<p>The HTTPClient is completely multithread safe (or at least should be ;-). A single HTTPConnection instance may be shared between multiple threads, multiple requests may be run concurrently on a single or multiple HTTPConnection instances, and you may even have multiple threads reading on a single response (though I&#39;m not sure that the latter makes much sense). Because a number of parameters are on a per HTTPConnection instance basis (such as the module list, proxy settings, default headers, etc), care should be taken when modifying these parameters if the HTTPConnection instance is shared among multiple threads.</p>
<h2 id="-httpurlconnection-"><a href="">HttpURLConnection</a></h2>
<p>The <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HttpURLConnection.html" target="_blank">HttpURLConnection</a> class provides a java.net.HttpURLConnection compatible interface to the HTTPClient. It exists mainly to allow the HTTPClient to be used as a direct plug-in replacement for Sun&#39;s HttpClient (part of the JDK); if you are writing HTTPClient specific code, then I recommend using the HTTPClient&#39;s &quot;native&quot; API, i.e. HTTPConnection et. al.</p>
<p>The HttpURLConnection follows the model of java.net.URLConnection and java.net.HttpURLConnection in that each instance is only capable of doing a single request (i.e. a new instance must be created for each request, usually via</p>
<p>URL.openConnection()
or</p>
<p>URL.openStream()
). To enable reuse of connections, HttpURLConnection manages a pool of HTTPConnection&#39;s internally. Different instances of HttpURLConnection will use the same HTTPConnection if they have the same host and port. This way socket connections are reused as much as possible (i.e. you still get to take advantage of the persistent connections capability). In addition, <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HttpURLConnection.html#connect(" target="_blank">connect()</a>) will only send the request but not read or parse the response; only when a method such as</p>
<p>getInputStream()
,</p>
<p>getResponseCode()
, etc, is invoked is the response read and parsed. This, together with the reuse of HTTPConnection&#39;s, allows requests to be pipelined by explicitly invoking</p>
<p>connect()
. Example:
URLConnection con1 = url1.openConnection(); con1.connect(); // sends first request URLConnection con2 = url2.openConnection(); con2.connect(); // sends second request InputStream is1 = con1.getInputStream(); // waits for first response InputStream is2 = con2.getInputStream(); // waits for second response</p>
<h2 id="-protocol-version-"><a href="">Protocol Version</a></h2>
<p>The request protocol version sent is always HTTP/1.1, except in a few circumstances when a broken server is encountered, in which case the version sent reverts to HTTP/1.0. An HTTP/0.9 request is never sent.</p>
<p>The protocol version returned by the server is used to select between different mechanisms for persistent connections. If the server advertises itself as being HTTP/1.1 compliant then HTTP/1.1 persistent connections are used; otherwise HTTP/1.0 keep-alive&#39;s are used (the difference is the tokens used in the Connection header for signaling persistence and the end of a connection). Apart from this, the only other distinction made between talking to an HTTP/1.0 or an HTTP/1.1 server is in how request are automatically retried (retried requests with a body need to use slightly different mechanisms for determining how long to wait after sending the headers, before sending the body).</p>
<h2 id="-modules-"><a href="">Modules</a></h2>
<p>A number of functions of the HTTPClient, such as authorization and redirection handling, are broken out into <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPClientModule.html" target="_blank">modules</a>. Modules can be dynamically added and removed, thereby allowing certain functionality to be disabled or new functionality to be added without having to modify any of the core code. Each connection has a list of modules it will use to process a request and response. When a request method is invoked (such as</p>
<p>Get()
or</p>
<p>Post()
) the request is first assembled into a <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/Request.html" target="_blank">Request</a> instance. Then the <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPClientModule.html#requestHandler(HTTPClient.Request,HTTPClient.Response[]" target="_blank">request handler</a>) of each module is invoked in turn with this request. This handler may modify the request (such as add headers) or even generate a response directly (such as a cache might do). Only after all handlers have been invoked (and none of them generated a response) is the request actually sent over the wire. Similarly, when a response is read the <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPClientModule.html#responsePhase1Handler(HTTPClient.Response,HTTPClient.RoRequest" target="_blank">response handlers</a>) in each module are invoked in turn. They may do certain things based on the status code (such as the redirection module) or the headers (such as the cookie module), modify the response, or even generate a new request (such as in the redirection and authentication modules). If a new request is generated the process starts from the top again.</p>
<p>The currently supplied modules are the AuthorizationModule, the RedirectionModule, the ContentEncodingModule, the TransferEncodingModule, the CookieModule, the ContentMD5Module, the RetryModule and the DefaultModule. These are explained in more detail further down.</p>
<p>Modules can be dynamically added and removed to tailor the request and response processing desired. The methods <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html#addDefaultModule(java.lang.Class, int" target="_blank">HTTPConnection.addDefaultModule()</a>), <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html#removeDefaultModule(java.lang.Class" target="_blank">HTTPConnection.removeDefaultModule()</a>) and <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html#getDefaultModules(" target="_blank">HTTPConnection.getDefaultModules()</a>) manipulate and return the list of default modules which is used when a new <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html" target="_blank">HTTPConnection</a> is created. Similarly, the methods <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html#addModule(java.lang.Class, int" target="_blank">HTTPConnection.addModule()</a>), <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html#removeModule(java.lang.Class" target="_blank">HTTPConnection.removeModule()</a>) and <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html#getModules(" target="_blank">HTTPConnection.getModules()</a>) manipulate and return the list of current modules for an HTTPConnection instance. Note that for the modules which are not public you must get their Class objects via Class.forName() (e.g. to remove the redirection module, use</p>
<p>con.removeModule(Class.forName(&quot;HTTPClient.RedirectionModule&quot;))
).</p>
<p>The default list of modules is initialized from the java system property HTTPClient.Modules. This property must be a &quot;|&quot; separated list of class names. If this property is not set it defaults to all the classes listed below. Normally if during class initialization any module in the list does not exist or cannot be instantiated then an Error is thrown. However, if this is being used in an unsigned applet then the error is suppressed. This way applets can limit the modules loaded over the net by simply not providing them (remember, they can&#39;t set system properties due to security restrictions).</p>
<p>You may create your own modules and add them using the above methods. Any module you write must implement the <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPClientModule.html" target="_blank">HTTPClientModule</a> interface. See the API docs more info. <strong>Note:</strong> this interface may change. If you write a module and find the interface insufficient or difficult, please contact me. Also, if you write a module which you think might be of general usefulness and would like to make it freely available, let me know.</p>
<p>Here is a short description of each module.</p>
<h3 id="-authorizationmodule-"><a href="">AuthorizationModule</a></h3>
<p>Authorization briefly described in <a href="http://www.innovation.ch/java/HTTPClient/getting_started.html#auth" target="_blank">Getting Started</a>. As mentioned, this module will handle both server and proxy authorization requests (status codes 401 and 407). In addition to the &#39;Basic&#39; and &#39;Digest&#39; authorization schemes, the AuthorizationModule can be made to handle other schemes as well, so long as they are not &quot;too exotic&quot; (i.e. they follow the simple challenge-response mechanism outlined in the http specs); this is done by setting your own <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/AuthorizationHandler.html" target="_blank">AuthorizationHandler</a>. Of course, if you need to something more sophisticated you can always plug in your own authorization module.</p>
<p>When confronted with an authorization request the authorization module will query all known authorization info for a possible candidate (the match must be for the host, port, scheme and realm). If no suitable info is found, or if the server rejects any info found, an authorization handler is called to try and get the necessary info from the user; if the user does not give any information, or if the information she gives is also rejected, then the retrying is terminated and the last failure status returned to the caller. The default handler currently only understands requests for the &#39;Basic&#39; and &#39;Digest&#39; authorization schemes; you may however set your own handler via the <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/AuthorizationInfo.html#setAuthHandler(HTTPClient.AuthorizationHandler" target="_blank">AuthorizationInfo.setAuthHandler()</a>) method. The handler given must implement the <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/AuthorizationHandler.html" target="_blank">AuthorizationHandler</a> interface. To disable the handler completely give null for the handler.</p>
<p>A server (or proxy) may send multiple authorization challenges in the response, in which case the above algorithm is modified to go through the list of challenges in the same order as they were sent, trying to get authorization info for each challenge in the list and going to the next challenge if either no info was found or the server rejects that info. If the end of the list is reached without achieving authorization then the authorization handler is called on each challenge (in the same order) until either an authorization request is successful, the authorization handler returns null (e.g. when the Cancel button in the default popup box is activated) or the list is exhausted, in which case the response to the last failed request is returned.</p>
<p>Whenever the <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/DefaultAuthHandler.html" target="_blank">default authorization handler</a> needs to ask the user for a username and password, it queries the current <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/AuthorizationPrompter.html" target="_blank">AuthorizationPrompter</a>. This is responsible for popping up a dialog box or otherwise acquiring the necessary info. A default prompter is provided which will pop up a simple dialog box, if the AWT is running, or use a command line prompt if it isn&#39;t and the currently running system is Unix or VMS; you may set your own prompter using <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/DefaultAuthHandler.html#setAuthorizationPrompter(HTTPClient.AuthorizationPrompter" target="_blank">DefaultAuthHandler.setAuthorizationPrompter()</a>). To prevent the prompter from being queried (e.g. to prevent the popup box from appearing) you can either set the prompter to null, or use <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html#setAllowUserInteraction(boolean" target="_blank">con.setAllowUserInteraction(false)</a>).</p>
<h3 id="-redirectionmodule-"><a href="">RedirectionModule</a></h3>
<p>This module handles the redirection status codes 301, 302, 303, 305 and 307. 301 and 307 responses are only redirected if the request method was GET or HEAD; this is because redirecting, say, a POST blindly might lead to undesired behaviour, as the circumstances leading to the POST might have changed. 302 and 303 are treated identically: the new request to the new location is done using GET (this is what many cgi&#39;s expect - they are basically directing you to a prefabricated answer). 305 is only honored if the connection is not already using a proxy.</p>
<p>This module also keeps a list of permanently redirected URL&#39;s (status code 301) and will preemptively redirect requests for these. This list is volatile (i.e. it will be lost when the application exits).</p>
<h3 id="-cookiemodule-http-www-innovation-ch-java-httpclient-api-httpclient-cookiemodule-html-"><a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/CookieModule.html" target="_blank">CookieModule</a></h3>
<p>This module implements cookies as defined by <a href="http://home.netscape.com/newsref/std/cookie_spec.html" target="_blank">Netscape&#39;s cookie spec</a> and the latest <a href="http://www.ietf.org/rfc/rfc2965.txt" target="_blank">HTTP State Management Mechanism</a> spec. During response processing it intercepts and parses the Set-Cookie and Set-Cookie2 header fields (removing them from the response in the process), and during request processing it adds all eligible cookies to the requests.</p>
<p>Because of privacy issues surrounding cookies, whenever the server tries to set a cookie a <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/CookiePolicyHandler.html" target="_blank">policy handler</a> is invoked to see whether this cookie should be accepted. The default handler brings up a popup describing the cookie and allowing the user to accept or reject it; the user may also summarily accept or reject cookies from whole domains. You may substitute your own policy handler using the <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/CookieModule.html#setCookiePolicyHandler(HTTPClient.CookiePolicyHandler" target="_blank">setCookiePolicyHandler()</a>) method. If you set the handler to null then all cookies will be silently accepted. If you do not want any cookies to be accepted then either remove the CookieModule from the list of modules or set your own handler which always returns false. The handler must implement the <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/CookiePolicyHandler.html" target="_blank">CookiePolicyHandler</a> interface.</p>
<p>The CookieModule provides methods to view the currently stored cookies, and to add and remove cookies from that list. If you want to manually provide additional cookies for a request then you must add them to the CookieModule&#39;s internal list - any Cookie header fields you create yourself and pass to a request will be removed by the CookieModule.</p>
<p>The CookieModule will save and restore cookies at the start and end of the application only if the java system property HTTPClient.cookies.save is set to true. All cookies which are meant to persist across invocations are then saved to a file when the application exits and read from that file when the CookieModule is loaded. The format of the file is a serialized Hashtable of Cookies. The name of file can controlled through the system property HTTPClient.cookies.jar. If this is not set, a system dependent name is used:</p>
<ul>
<li>Unix: $HOME/.httpclient_cookies</li>
<li>Mac: System Folder:Preferences:HTTPClientCookies</li>
<li>OS/2: $HOME/.httpclient_cookies</li>
<li>Win95: $JAVA_HOME/.httpclient_cookies</li>
<li>WinNT: $HOME/.httpclient_cookies
(where $HOME is the value of the java system property &quot;user.home&quot;, and $JAVA_HOME is the value of the java system property &quot;java.home&quot;).</li>
</ul>
<h3 id="-contentencodingmodule-"><a href="">ContentEncodingModule</a></h3>
<p>Servers may apply various content encodings to the content. The most widely used encodings are compressions: gzip, compress, and deflate. This module will handle these three content encodings by pushing an appropriate decoding stream; this means that the data read from <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPResponse.html#getInputStream(" target="_blank">getInputStream()</a>) will be the clear text. The Content-Encoding header is also modified appropriately.</p>
<p>You might want to consider disabling this module if you are using the HTTPClient for things like web-copying where storing the compressed document makes sense.</p>
<h3 id="-transferencodingmodule-"><a href="">TransferEncodingModule</a></h3>
<p>This is similar to the ContentEncoding module except that it applies to transfer encodings. It also handles the gzip, compress, and deflate encodings by pushing an appropriate decoding stream onto the response input stream and modifies the Transfer-Encoding header appropriately.</p>
<h3 id="-contentmd5module-"><a href="">ContentMD5Module</a></h3>
<p>Some servers may generate a Content-MD5 header which contains an MD5 hash of the message body (after any content encoding, but before any transport encoding is applied). If this header is present this module will push a stream which calculates the MD5 hash of the body. When the stream is closed or the end of the data is reached the calculated hash is compared to the one in the Content-MD5 header and if they don&#39;t match an IOException is thrown.</p>
<h3 id="-defaultmodule-"><a href="">DefaultModule</a></h3>
<p>This handles the response status codes 408 (request timeout) and 411 (length required).</p>
<h3 id="-retrymodule-"><a href="">RetryModule</a></h3>
<p>This module is special. It is responsible for automatically retrying requests which were aborted due to an IOException on the socket. It is unlike other modules in that it is closely tied in to the core code, instead of just manipulating the request and response structures as other modules do. The code in this module could have been put in with the rest of the core code, but moving it to a module has the advantage that this automatic retrying of requests may be disabled using the standard mechanism of removing modules.</p>
<h3 id="ordering-the-modules">Ordering the Modules</h3>
<p>The handlers in the modules are invoked in the order the modules are placed in the list. Because of certain constraints between modules this order is important. The default order for the supplied modules is:</p>
<ol>
<li>RetryModule</li>
<li>CookieModule</li>
<li>RedirectionModule</li>
<li>AuthorizationModule</li>
<li>DefaultModule</li>
<li>TransferEncodingModule</li>
<li>ContentMD5Module</li>
<li>ContentEncodingModule
However the constraints impose only a partial ordering, so that the above order may be changed as long as the following restrictions are observed:</li>
</ol>
<ul>
<li>The RetryModule <em>must</em> be first. It catches a special RetryException, which is thrown by the core code. If it were not the first module it would not be able to catch this exception.</li>
<li>The TransferEncoding module must precede any module which handles the response message (such as the ContentEncoding module and the ContentMD5Module). There are a number of reasons for this, but basically it&#39;s because all the headers refer to the message before transport encoding is applied.</li>
<li>The ContentMD5 module must precede the ContentEncoding module, as the hash is calculated for the encoded message.</li>
</ul>
<h2 id="-java-system-properties-recognized-by-httpclient-"><a href="">Java System Properties recognized by HTTPClient</a></h2>
<p>There are a number of java system properties which are used by the HTTPClient. Most are documented somewhere in the api docs. Some of the properties may contain a list of elements, in which case the elements are separated by vertical bars (&quot;|&quot;). White space is ignored, except that a &quot;| |&quot; produces an empty element whereas &quot;||&quot; is treated like a single delimiter (i.e. &quot;|&quot;).</p>
<p>The properties are read once, when the class that uses them is loaded (i.e. they&#39;re read in the class&#39; static initializer). This means they need to be set either on the command line via the -D option, as in
java -DHTTPClient.dontChunkRequests=true MyAppor early in your application before the class is first accessed: System.getProperties().put(&quot;HTTPClient.dontChunkRequests&quot;, &quot;true&quot;); ... HTTPConnection.setDefaultHeaders(...);</p>
<p>Here is summary of all properties recognized:</p>
<p>http.proxyHostRead by <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html" target="_blank">HTTPConnection</a>. Used to specify the http proxy to use. See <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html#setProxyServer(java.lang.String, int" target="_blank">setProxyServer()</a>) for more info. This is the same property that is used by Sun&#39;s JDK 1.1 (and later).http.proxyPortRead by <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html" target="_blank">HTTPConnection</a>. Used to specify the http proxy to use. See <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html#setProxyServer(java.lang.String, int" target="_blank">setProxyServer()</a>) for more info. This is the same property that is used by Sun&#39;s JDK 1.1 (and later).proxySetRead by <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html" target="_blank">HTTPConnection</a>. Obsolete. Used by Sun&#39;s JDK 1.0.2. If http.proxyHost is not set and proxySet is true, then the default proxy is set using the values in proxyHost and proxyPort.proxyHostRead by <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html" target="_blank">HTTPConnection</a>. Obsolete. Used by Sun&#39;s JDK 1.0.2. If http.proxyHost is not set and proxySet is true, then the default proxy is set using the values in proxyHost and proxyPort.proxyPortRead by <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html" target="_blank">HTTPConnection</a>. Obsolete. Used by Sun&#39;s JDK 1.0.2. If http.proxyHost is not set and proxySet is true, then the default proxy is set using the values in proxyHost and proxyPort.HTTPClient.nonProxyHostsRead by <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html" target="_blank">HTTPConnection</a>. Used to specify a list hosts for which no http proxy is to be used. See <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html#dontProxyFor(java.lang.String" target="_blank">dontProxyFor()</a>) for more info.http.nonProxyHostsRead by <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html" target="_blank">HTTPConnection</a>. Used to specify a list hosts for which no http proxy is to be used. See <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html#dontProxyFor(java.lang.String" target="_blank">dontProxyFor()</a>) for more info. This is the same property that is used by Sun&#39;s JDK 1.1 (and later).HTTPClient.socksHostRead by <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html" target="_blank">HTTPConnection</a>. Used to specify the SOCKS proxy host. See <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html#setSocksServer(java.lang.String, int, int" target="_blank">setSocksServer()</a>) for more info.HTTPClient.socksPortRead by <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html" target="_blank">HTTPConnection</a>. Used to specify the SOCKS proxy port. See <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html#setSocksServer(java.lang.String, int, int" target="_blank">setSocksServer()</a>) for more info.HTTPClient.socksVersionRead by <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html" target="_blank">HTTPConnection</a>. Used to specify the SOCKS proxy version. See <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html#setSocksServer(java.lang.String, int, int" target="_blank">setSocksServer()</a>) for more info.HTTPClient.ModulesRead by <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html" target="_blank">HTTPConnection</a>. Used to define the default list of modules. See <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html#addDefaultModule(java.lang.Class, int" target="_blank">HTTPConnection.addDefaultModule()</a>) for more info.HTTPClient.disable_pipeliningRead by <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html" target="_blank">HTTPConnection</a>. Used to disable all pipelining. This should never be needed, but you may encounter a server which displays problems when pipelining requests. Setting this property to true will cause the HTTPClient to stall each request until the headers from the response to the previous request have been received and parsed.HTTPClient.disableKeepAlivesRead by <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html" target="_blank">HTTPConnection</a>. Used to disable keep-alive&#39;s. This exactly equivalent to (and is implemented as)</p>
<p>con.setDefaultHeaders(new NVPair[] { new NVPair(&quot;Connection&quot;, &quot;close&quot;) })
.HTTPClient.forceHTTP_1.0Read by <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html" target="_blank">HTTPConnection</a>. Used to force the client to pretend it&#39;s only capable of HTTP/1.0. Setting this to true causes all requests to be sent as if the server could only handle HTTP/1.0, and causes the HTTP-version in the request-line to be sent as HTTP/1.0.HTTPClient.dontChunkRequestsRead by <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html" target="_blank">HTTPConnection</a>. Used to prevent the client from using the chunked transfer encoding on requests. Setting this to true causes all data written to an HttpOutputStream (that was not constructed with a content length) to be buffered and only sent when the stream is closed.HTTPClient.deferStreamedRead by <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPConnection.html" target="_blank">HTTPConnection</a>. When a request is sent which uses an <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HttpOutputStream.html" target="_blank">HttpOutputStream</a>, and handling of the response by modules would require the module to resend the request, then modules have to punt because they do not have the request data (i.e. the data written to the output stream). In order to make things easier on the application, an application can set this property to true and then check the <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HTTPResponse.html#retryRequest(" target="_blank">retry flag</a>) in the response for whether it needs to resend the request. If the value is false, the retry flag will always be false. The default is false in order to prevent memory leaks in applications which aren&#39;t prepared for it.HTTPClient.dontTimeoutRespBodyRead by RespInputStream. Used to restore pre-V0.3-3 behaviour of disabling any timeout while reading the response body. Setting this to true causes read()&#39;s on the response input stream to block indefinitely until some data arrives or the connection closes, irrespective of whether a timeout has been set or not.HTTPClient.cookies.hosts.acceptRead by <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/CookieModule.html" target="_blank">CookieModule</a>. Used to initialize the list of hosts and domains from which to always accept cookies. See <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/CookieModule.html#setCookiePolicyHandler(HTTPClient.CookiePolicyHandler" target="_blank">setCookiePolicyHandler()</a>) for more info.HTTPClient.cookies.hosts.rejectRead by <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/CookieModule.html" target="_blank">CookieModule</a>. Used to initialize the list of hosts and domains from which to always reject cookies. See <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/CookieModule.html#setCookiePolicyHandler(HTTPClient.CookiePolicyHandler" target="_blank">setCookiePolicyHandler()</a>) for more info.HTTPClient.cookies.saveRead by <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/CookieModule.html" target="_blank">CookieModule</a>. If set to true then the CookieModule will read stored cookie at startup time, and save cookies that should persist at application exit time.HTTPClient.cookies.jarRead by <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/CookieModule.html" target="_blank">CookieModule</a>. This specifies the cookie jar to use for reading and saving cookies. If not set, a system dependent name is used.HTTPClient.log.fileRead by <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/Log.html" target="_blank">Log</a>. If defined, this specifies the name of the file to which log messages are to be written. By default log messages are written to System.err.HTTPClient.log.maskRead by <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/Log.html" target="_blank">Log</a>. If defined, this specifies which debug messages should be logged. The value is a number which is the bitwise OR (&#39;|&#39;) of the values of the facilities for which logging should be enabled. E.g. the value -1 enables logging for all facilities. By default logging is disabled.HTTPClient.HttpURLConnection.AllowUIRead by <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HttpURLConnection.html" target="_blank">HttpURLConnection</a>. If set to true then set the defaultAllowUserInteraction to true. By default this is set to false in java.net.URLConnection.http.agentRead by <a href="http://www.innovation.ch/java/HTTPClient/api/HTTPClient/HttpURLConnection.html" target="_blank">HttpURLConnection</a>. If set then the &quot;User-Agent&quot; header is set to this property&#39;s value.</p>
<h2 id="-http-header-fields-"><a href="">HTTP Header Fields</a></h2>
<p>All request methods accept optional header fields to be sent with the request. Here are a list of possible request and response header fields as defined in the HTTP/1.1 spec. I have added some comments to some of them, but for further info I recommend getting the <a href="http://www.innovation.ch/java/HTTPClient/advanced_info.html#specs" target="_blank">specs</a> (every header field is described in a paragraph of its own in the spec, so you can read just the part that interests you and ignore the rest).</p>
<h3 id="request-header-fields">Request Header Fields</h3>
<ul>
<li>Cache-Control</li>
<li>Connection - used for persistent connections; need not be set by applications</li>
<li>Date - use only in PUT/POST; even then optional</li>
<li>Keep-Alive - used for persistent connections (HTTP/1.0 only); set by the HTTPClient as needed.</li>
<li>Pragma</li>
<li>Transfer-Encoding - set by the client as necessary</li>
<li>Upgrade</li>
<li><p>Via</p>
</li>
<li><p>Accept</p>
</li>
<li>Accept-Charset</li>
<li>Accept-Encoding - set by the ContentEncoding module</li>
<li>Accept-Language</li>
<li>Authorization - generated by HTTPClient as necessary</li>
<li>From</li>
<li>Host - set by HTTPClient; may be overridden by application</li>
<li>If-Modified-Since - the server returns 304 if the document was not modified</li>
<li>If-Match - the server returns 412 if the match fails</li>
<li>If-NoneMatch - the server returns 304 if the match succeeds</li>
<li>If-Range</li>
<li>If-Unmodified-Since - the server returns 412 if modified</li>
<li>Max-Forwards - used with TRACE and OPTIONS</li>
<li>Proxy-Authorization - generated by HTTPClient as necessary</li>
<li>Range</li>
<li>Referer</li>
<li><p>User-Agent - generated by HTTPClient; can be modified</p>
</li>
<li><p>Allow - only with PUT</p>
</li>
<li>Content-Base</li>
<li>Content-Encoding - examples: gzip, compress, deflate</li>
<li>Content-Language</li>
<li>Content-Length - set by HTTPClient</li>
<li>Content-MD5</li>
<li>Content-Range</li>
<li>Content-Type</li>
</ul>
<h3 id="response-header-fields">Response Header Fields</h3>
<ul>
<li>Cache-Control</li>
<li>Connection - used for persistent connections</li>
<li>Date - date that the document was delivered (<strong>not</strong> when it was last modified)</li>
<li>Keep-Alive - used for persistent connections (HTTP/1.0 only)</li>
<li>Pragma</li>
<li>Transfer-Encoding - HTTPClient handles chunked in the core code; gzip and deflate are handled by the TransferEncoding module.</li>
<li>Upgrade - sent with a 101 response;</li>
<li><p>Via - carries a list of proxies that were involved in returning the request; especially interesting for TRACE and OPTIONS requests.</p>
</li>
<li><p>Age - from caches</p>
</li>
<li>Location - sent with a redirection status code; since HTTPClient automatically handles 301, 302, 303, 305 and 307 status codes this field is seldom seen.</li>
<li>Proxy-Authenticate - read by HTTPClient</li>
<li>Public</li>
<li>Retry-After - optionally sent with a 503 status</li>
<li>Vary</li>
<li>Warning</li>
<li><p>WWW-Authenticate - read by HTTPClient</p>
</li>
<li><p>Accept-Ranges</p>
</li>
<li>Allow - with a 405 status</li>
<li>Content-Base</li>
<li>Content-Encoding - gzip, deflate, and compress are handled by the ContentEncoding module.</li>
<li>Content-Language</li>
<li>Content-Length</li>
<li>Content-Location</li>
<li>Content-MD5 - handled by the ContentMD5 module.</li>
<li>Content-Range</li>
<li>Content-Type</li>
<li>ETag</li>
<li>Expires - the date when the document expires</li>
<li>Last-Modified - the date the document was last modified</li>
</ul>
<h1 id="-further-reading-"><a href="">Further Reading</a></h1>
<p><img src="" alt="*"> <a href="http://www.w3.org/Protocols/" target="_blank">General HTTP Info at W3C</a><img src="" alt="*"> <a href="http://www.ietf.org/rfc/rfc1945.txt" target="_blank">HTTP/1.0 Spec (RFC 1945)</a><img src="" alt="*"> <a href="http://www.ietf.org/rfc/rfc2616.txt" target="_blank">HTTP/1.1 Spec (RFC 2616)</a><img src="" alt="*"> <a href="http://www.ietf.org/rfc/rfc2617.txt" target="_blank">Digest Authentication Spec (RFC 2617)</a></p>
<p><a href="http://www.innovation.ch/java/HTTPClient/index.html" target="_blank"><img src="" alt="[HTTPClient]"></a></p>
<p>Ronald Tschalär / 6. May 2001 / <a href="mailto:ronald@innovation.ch">ronald@innovation.ch</a>.</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/Httpclient/">Httpclient</a></li></span></span> | <span class="tags">Tagged <a href="/tags/Httpclient/" class="label label-primary">Httpclient</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:37"datetime="2014-03-07 09:54:37"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-Httpclient--AdvancedHTTPClientInfo/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-Httpclient--AdvancedHTTPClientInfo" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-Httpclient--远程会话与远程桌面同步关闭问题/">远程会话与远程桌面同步关闭问题</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:37.000Z"> <a href="/2014/02/02/2014-02-02-Httpclient--远程会话与远程桌面同步关闭问题/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-">远程会话与远程桌面同步关闭问题</h1>
<p>  <a href="http://blog.zxbc.cn/" target="_blank">专家博客</a> | <a href="http://bbs.zxbc.cn/" target="_blank">论坛</a> | <a href="http://down.zxbc.cn/" target="_blank">下载</a> | <a href="http://sp.zxbc.cn/" target="_blank">视频</a> | <a href="http://www.zxbc.cn/html/network/" target="_blank">网络</a> | <a href="http://dh.zxbc.cn/" target="_blank">导航</a> | <a href="http://www.zxbc.cn/html/windows/" target="_blank">Windows</a> | <a href="http://www.zxbc.cn/html/itrz/" target="_blank">IT认证</a> | <a href="http://down.zxbc.cn/shuji/" target="_blank">书籍</a> | <a href="http://www.zxbc.cn/opensource/" target="_blank">开源</a> | <a href="http://www.zxbc.cn/Solutions/" target="_blank">方案</a> | <a href="http://www.zxbc.cn/html/wzdh/" target="_blank">站内导航</a> <a href="http://www.zxbc.cn/plus/rssmap.html" target="_blank"><img src="" alt=""></a> <a href="http://www.zxbc.cn/" target="_blank"><img src="" alt="中国自学编程网"></a> <a href="http://www.zxbc.cn/html/news/" target="_blank"><strong>资讯</strong></a><a href="http://www.zxbc.cn/html/news/cmsnews/" target="_blank">动态</a><a href="http://www.zxbc.cn/html/ITnews/" target="_blank">业界</a>  <a href="http://www.zxbc.cn/html/kfyy/" title="编程语言" target="_blank"><strong>语言</strong></a><a href="http://www.zxbc.cn/html/Csutdy/" target="_blank">C语言</a><a href="http://www.zxbc.cn/html/cjj/" target="_blank">C++</a><a href="http://www.zxbc.cn/html/cshorp/" target="_blank">C/#</a><a href="http://www.zxbc.cn/html/vb/" target="_blank">VB</a>  <a href="http://www.zxbc.cn/html/rjkf/" target="_blank"><strong>开发</strong></a><a href="http://www.zxbc.cn/html/erp/" target="_blank">ERP</a><a href="http://www.zxbc.cn/html/pm/" target="_blank">项目管理</a><a href="http://www.zxbc.cn/html/rjgc/" target="_blank">软件工程</a>  <a href="http://www.zxbc.cn/html/sjk/" target="_blank"><strong>数据库</strong></a><a href="http://www.zxbc.cn/html/SQLServer/" target="_blank">MSSQL</a><a href="http://www.zxbc.cn/html/Oracle/" target="_blank">Oracle</a> <a href="http://www.zxbc.cn/html/MySQL/" target="_blank">Mysql</a>  <a href="http://www.zxbc.cn/html/webkaifa/" target="_blank"><strong>WEB</strong></a><a href="http://www.zxbc.cn/html/article/" target="_blank">ASP</a><a href="http://www.zxbc.cn/html/PHP/" target="_blank">PHP</a><a href="http://www.zxbc.cn/html/aspnet/" target="_blank">ASP.NET</a> <a href="http://www.zxbc.cn/html/renwu/" target="_blank">人物</a><a href="http://www.zxbc.cn/html/sydt/" target="_blank">商业</a><a href="http://www.zxbc.cn/html/tongxun/" target="_blank">通讯</a> <a href="http://www.zxbc.cn/html/dnet/" target="_blank">.NET</a><a href="http://www.zxbc.cn/html/java/" target="_blank">JAVA</a><a href="http://www.zxbc.cn/html/DELPHI/" target="_blank">Delphi</a><a href="http://www.zxbc.cn/html/sf/" target="_blank">算法</a> <a href="http://www.zxbc.cn/html/yxkf/" target="_blank">游戏</a><a href="http://www.zxbc.cn/html/qrskf/" target="_blank">嵌入式</a><a href="http://www.zxbc.cn/html/yyzh/" target="_blank">测 试</a><a href="http://www.zxbc.cn/html/3gwl/" target="_blank">移动开发</a> <a href="http://www.zxbc.cn/html/DB2/" target="_blank">IBM-DB2</a> <a href="http://www.zxbc.cn/html/Sybase/" target="_blank">Sybase</a> <a href="http://www.zxbc.cn/html/Access/" target="_blank">ACCESS</a><a href="http://www.zxbc.cn/html/VFP/" target="_blank">VFP</a> <a href="http://www.zxbc.cn/html/xml/" target="_blank">XML</a><a href="http://www.zxbc.cn/html/HEML/" target="_blank">HTML</a><a href="http://www.zxbc.cn/html/article/webprog/" target="_blank">CSS+DIV</a><a href="http://www.zxbc.cn/html/jsp2/" target="_blank">JSP</a>  <a href="http://www.zxbc.cn/" target="_blank">中国自学编程网</a> &gt; <a href="http://www.zxbc.cn/html/Windows/" target="_blank">Windows</a> &gt; <a href="http://www.zxbc.cn/html/oswl/" target="_blank">网络技巧</a> &gt; 正文 <img src="" alt="">   <a href=""></a> <strong>远程会话与远程桌面同步关闭问题</strong> 来源：中国自学编程网   发布日期：2008-06-03   在日常操作中，网管员往往哪个需要通过远程桌面在主机中进行下载、文件安装、程序运行等等操作，这时，即使管理员推出远程桌面我们也希望这些操作照常进行，不要中断，不过在实际情况中却有很多情况不是这样，只要管理员退出这些操作就会同步中断，给网管员的操作带来了很大的不便。从理论上来说，在对服务器主机进行远程控制时，网络管理员只要不对服务器系统执行系统注销操作或重新启动操作，只是简单地单击远程桌面连接窗口右上角处的关闭按钮时，那些通过远程控制方式启动运行的应用程序还应该继续以后台方式运行，并不会跟随远程桌面连接窗口的关闭而同步关闭。但为什么会出现同步关不的问题呢，经过笔者的观察，这主要是设置的问题，只要我们进行了正确的设置，就完全可以避免此种情况的发生。现在，本文就将该故障的详细排除过程贡献出来：</p>
<p>首先看看在远程登录服务器系统时使用的帐号设置是否正确，如果登录帐号的权限不够或者属性参数设置不当的话，那么就容易出现远程会话同步关闭的现象。假设网络管理员以系统管理员帐号“administrator”来远程登录服务器系统的，在检查“administrator”帐号的设置正确性时，我们可以在服务器系统中用鼠标右键单击桌面上的“我的电脑”图标，从弹出的右键菜单中执行“管理”命令，打开服务器系统的计算机管理界面。在该界面的左侧显示区域，用鼠标依次展开“系统工具”/“本地用户和用户组”/“用户”分支选项，在对应“用户”分支选项的右侧显示区域中，选中目标登录帐号“administrator”，并用鼠标右键单击该帐号，再执行右键菜单中的“属性”命令，打开对应帐号的属性设置界面；单击该设置界面中的“会话”选项卡，在对应的选项设置界面中我们会看到“空闲会话限制”、“活动会话限制”、“结束已断开的会话”、“当达到会话极限或连接中断时如何操作的设置”等几个参数（如图1所示）。其中“空闲会话限制”选项是在服务器系统中没有进行任何操作时所要设置的一项参数，“活动会话限制”选项是用来限制服务器系统中活动连接持续使用时间的一种参数，“结束已断开的会话”选项是用来强行关闭某个会话连接的一项参数。为了避免远程会话同步关闭现象的发生，我们必须在这里将上面的各项参数全部修改为“从不”，以确保远程会话不会被服务器系统强行关闭。</p>
<p><img src="&quot;图1&quot;" alt="图1"></p>
<p>图1</p>
<pre><code>其次检查服务器系统中的终端服务配置参数是否正确，如果终端服务器模式设置不当的话，也可能引起远程会话同步关闭的现象。打开服务器系统的“开始”菜单，从中依次选择“程序”/“管理工具”/“终端服务配置”选项，进入终端服务配置界面，选中该界面左侧显示区域的“服务器设置”选项，并在对应该选项的右侧显示区域我们就能看到终端服务器模式究竟是什么了，要是发现终端服务器模式不是“应用程序服务器”模式时，我们必须及时修改过来，并且还需要在这里将“活动桌面”功能启用起来（如图2所示）。
</code></pre><p><img src="&quot;图2&quot;" alt="图2"></p>
<p>图2</p>
<pre><code>下面我们还要对远程终端服务属性界面中的一些参数进行检查，并且这里的参数设置优先级一般要高于系统登录帐号属性界面中的参数设置。在进行这种检查时，我们可以先按照前面的操作打开服务器系统的终端服务配置界面，之后依次选中“终端服务配置”/“连接”选项，在对应该选项右侧显示区域中用鼠标右键单击“RDP-TCP”选项，从弹出的快捷菜单中执行“属性”命令，打开远程终端服务属性设置界面（如图3所示）；在该设置界面中我们看到了“替代用户设置”这个选项参数，要是将该选项参数选中的话，那么我们之前在系统登录帐号属性界面中设置的各项参数都将不能发挥作用，所有参数都会自动按照远程终端服务属性设置界面中的参数进行处理，要是没有选中“替代用户设置”这个选项参数时，那么我们之前在系统登录帐号属性界面中设置的各项参数才能生效。而且，“替代用户设置”设置项下面，我们同样也会看到“空闲会话限制”、“活动会话限制”、“结束已断开的会话”、“当达到会话极限或连接中断时如何操作的设置”等几个参数，我们可以根据工作需要进行有针对性设置就行了。
</code></pre><p><img src="&quot;图3&quot;" alt="图3"></p>
<p>图3</p>
<pre><code>网络管理员在远程控制单位服务器系统时，发现这里的“替代用户设置”选项被意外选中了，同时“结束已断开的会话”参数也被设置为了1分钟，这也是为什么网络管理员通过远程桌面连接在服务器系统中启动某个会话连接后，单击远程桌面连接窗口中的关闭按钮时该会话连接也会同步关闭的原因。找到故障原因后，问题就很好解决了，网络管理员在这里将“结束已断开的会话”参数设置为了“从不”后，就立即解决了服务器远程会话同步关闭故障。  ![]() 相关文章  关于 **远程会话与远程桌面同步关闭问题** ·[ADSl浅析](http://www.zxbc.cn/html/20080530/51611.html)
</code></pre><p>·<a href="http://www.zxbc.cn/html/20080530/51701.html" target="_blank">Windows 2000 Server DNS维护一点通</a>
·<a href="http://www.zxbc.cn/html/20080530/51959.html" target="_blank">用&quot;连接共享&quot;实现ADSL共享上网</a>
·<a href="http://www.zxbc.cn/html/20080530/51612.html" target="_blank">通过NETBIOS实现信息收集与渗透(1)</a>
·<a href="http://www.zxbc.cn/html/20080530/51636.html" target="_blank">未公开的Windows网络工具</a>
·<a href="http://www.zxbc.cn/html/20080530/51991.html" target="_blank">去除Windows 2000的默认共享</a> <strong>新闻动态</strong> ·<a href="http://www.zxbc.cn/html/20070419/1254.html" target="_blank">网络电视突遇监管风暴 腾讯QQlive停播部份节目</a>
 ·<a href="http://www.zxbc.cn/html/20070419/1111.html" target="_blank">熊猫烧香病毒案告破 8犯罪嫌疑人被抓获</a> ·<a href="http://www.zxbc.cn/html/20070616/22989.html" target="_blank">第三届中国(南京)国际软件产品博览会</a>
 ·<a href="http://www.zxbc.cn/html/20080527/51220.html" target="_blank">百度将推新一代营销平台“我的营销中心”</a> ·<a href="http://www.zxbc.cn/html/20070903/26868.html" target="_blank">微软收购企业群组通讯软件商Parlano</a>
 ·<a href="http://www.zxbc.cn/html/20080311/32227.html" target="_blank">Sun和微软加深合作成立了Sun/微软协作中心</a> ·<a href="http://www.zxbc.cn/html/20070510/16550.html" target="_blank">大企业领袖“高薪低能排行榜”</a>
 ·<a href="http://www.zxbc.cn/html/20070913/26946.html" target="_blank">入侵省内多所高校计算机系统，制贩假文凭被捕</a> ·<a href="http://www.zxbc.cn/html/20071127/29814.html" target="_blank">戴尔代工厂被曝出违反《劳动法》有关规定</a>
 ·<a href="http://www.zxbc.cn/html/20081121/68047.html" target="_blank">互联网公司应主动&quot;锻炼&quot;积极&quot;过冬&quot;</a>   <strong>栏目推荐</strong>   <img src="" alt=""> <img src="" alt=""> ·<a href="http://www.zxbc.cn/html/20080530/51542.html" target="_blank">让PXE无盘工作站使用固定的IP地址</a>
·<a href="http://www.zxbc.cn/html/20080530/51569.html" target="_blank">网络数据库的复制和同步(2)</a>
·<a href="http://www.zxbc.cn/html/20080530/51974.html" target="_blank">需要密码的Windows XP系统的共享文件夹</a>
·<a href="http://www.zxbc.cn/html/20081112/67722.html" target="_blank">巧设IP地址便于简化管理网络</a>
·<a href="http://www.zxbc.cn/html/20080530/51891.html" target="_blank">利用Win XP自带工具实现远程管理</a>
·<a href="http://www.zxbc.cn/html/20080530/51768.html" target="_blank">在网络服务中避免远程引用</a>   <strong>专家博客</strong>   <img src="" alt=""> <img src="" alt=""> <strong>程序人生</strong>   <a href="http://www.zxbc.cn/html/20090524/71367.html" target="_blank"><img src="" alt="编程的首要原则是？"></a> <a href="http://www.zxbc.cn/html/20090524/71367.html" target="_blank">编程的首要原则是？</a> <a href="http://www.zxbc.cn/html/20080829/64957.html" target="_blank"><img src="" alt="北漂IT人如何崛起网络间"></a> <a href="http://www.zxbc.cn/html/20080829/64957.html" target="_blank">北漂IT人如何崛起网络</a> ·<a href="http://www.zxbc.cn/html/20070511/16558.html" target="_blank">JBoss创始人Marc Fleury的成功职业生涯</a>
·<a href="http://www.zxbc.cn/html/20080813/64330.html" target="_blank">怎样才能成为高手?</a>
·<a href="http://www.zxbc.cn/html/20081225/69262.html" target="_blank">亲历惊心48小时,抢救35亿交易数据</a>
·<a href="http://www.zxbc.cn/html/20070804/25703.html" target="_blank">微软架构师谈编程语言发展（一）</a>
·<a href="http://www.zxbc.cn/html/20070519/20020.html" target="_blank">IT人你除了IT还能干什么？</a>
·<a href="http://www.zxbc.cn/html/20070521/20077.html" target="_blank">电子工程师也是十余年了</a> <a href="http://www.zxbc.cn/html/gyzd/" target="_blank">关于站点</a> - <a href="http://www.zxbc.cn/html/gywm/" target="_blank">联系我们</a> - <a href="http://www.zxbc.cn/html/bqys/" target="_blank">版权隐私</a> -  - <a href="http://www.zxbc.cn/html/20080603/56461.html#top" target="_blank">返回顶部</a>  中国自学编程网版权所有 本站原创文章，未经授权禁止转载或建立镜象站点 E-Mail:520it@163.com Tel:15802529892 Copyright 2006-2008 Zxbc.cn Corporation 中国自学编程网倡导软件开发学习文化，崇尚软件开源和共享，致力于帮助编程学习者在各自专业领域取得成功！</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/Httpclient/">Httpclient</a></li></span></span> | <span class="tags">Tagged <a href="/tags/Httpclient/" class="label label-primary">Httpclient</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:37"datetime="2014-03-07 09:54:37"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-Httpclient--远程会话与远程桌面同步关闭问题/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-Httpclient--远程会话与远程桌面同步关闭问题" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-Httpclient--注意设置httpclient连接数-黄刚的专栏-CSDN博客/">注意设置httpclient连接数 </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:37.000Z"> <a href="/2014/02/02/2014-02-02-Httpclient--注意设置httpclient连接数-黄刚的专栏-CSDN博客/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-httpclient-csdn-">注意设置httpclient连接数 - 黄刚的专栏 - CSDN博客</h1>
<h1 id="-http-blog-csdn-net-lovingprince-"><a href="http://blog.csdn.net/lovingprince" target="_blank">黄刚的专栏</a></h1>
<h2 id="no-complain-just-do-it-">No Complain ,Just Do It !</h2>
<ul>
<li><a href="http://hi.csdn.net/space-notice.html" target="_blank">条新通知</a></li>
<li><a href="http://passport.csdn.net/UserLogin.aspx" target="_blank">登录</a></li>
<li><a href="http://passport.csdn.net/CSDNUserRegister.aspx" target="_blank">注册</a></li>
<li><a href="http://hi.csdn.net/" target="_blank">欢迎</a></li>
<li><a href="http://writeblog.csdn.net/Signout.aspx" target="_blank">退出</a></li>
<li><a href="http://blog.csdn.net/" target="_blank">我的博客</a></li>
<li><a href="http://writeblog.csdn.net/configure.aspx" target="_blank">配置</a></li>
<li><a href="http://writeblog.csdn.net/PostEdit.aspx" target="_blank">写文章</a></li>
<li><a href="http://writeblog.csdn.net/PostList.aspx" target="_blank">文章管理</a></li>
<li><a href="http://blog.csdn.net/" target="_blank">博客首页</a></li>
</ul>
<p>*</p>
<ul>
<li><p>全站 当前博客
*</p>
</li>
<li><p><a href="http://hi.csdn.net/lovingprince" target="_blank">空间</a></p>
</li>
<li><a href="http://blog.csdn.net/lovingprince" target="_blank">博客</a></li>
<li><a href="http://hi.csdn.net/!s/friend/list/lovingprince" target="_blank">好友</a></li>
<li><a href="http://hi.csdn.net/!s/album/list/lovingprince" target="_blank">相册</a></li>
<li><a href="http://hi.csdn.net/!s/wall/to/lovingprince" target="_blank">留言</a></li>
</ul>
<p>用户操作<a href="http://hi.csdn.net/!s/wall/to/lovingprince" target="_blank">[留言]</a>  <a href="http://hi.csdn.net/!s/msg/to/lovingprince" target="_blank">[发消息]</a>  <a href="http://hi.csdn.net/!s/friend/add/lovingprince" target="_blank">[加为好友]</a> 订阅我的博客<a href="http://feeds.feedsky.com/csdn.net/lovingprince" target="_blank"><img src="" alt="XML聚合"></a>   <a href="http://feeds.feedsky.com/csdn.net/lovingprince" target="_blank"><img src="" alt="FeedSky"></a><a href="http://www.xianguo.com/subscribe.php?url=http://feeds.feedsky.com/csdn.net/lovingprince" target="_blank"><img src="" alt="订阅到鲜果"></a><a href="http://fusion.google.com/add?feedurl=http://feeds.feedsky.com/csdn.net/lovingprince" target="_blank"><img src="" alt="订阅到Google"></a><a href="http://www.zhuaxia.com/add_channel.php?url=http://feeds.feedsky.com/csdn.net/lovingprince" target="_blank"><img src="" alt="订阅到抓虾"></a><a href="http://writeblog.csdn.net/configure.aspx" target="_blank">[编辑]</a>lovingprince的公告权当备忘，分享经验点滴，不在乎内容是否简单，简单中其实更能体现出不平凡，不喜欢空谈的文章，更愿意实际一点，为需要的朋友做点贡献，如果能留下您宝贵的评价，相信您也可以让众多朋友受益，我分享，我快乐。
<a href="http://s.click.taobao.com/t_1?i=qzvnpphF1HNGGA%3D%3D&amp;p=mm_14667228_0_0&amp;n=12" target="_blank"><img src="" alt=""></a> <a href="http://s.click.taobao.com/t_1?i=qzvnpphF1HNGGA%3D%3D&amp;p=mm_14667228_0_0&amp;n=12" target="_blank">《淘宝天下》12个月/52期 260元 送价值599元Black Rivet包</a> 260.0元 <a href="http://s.click.taobao.com/t_1?i=qzvnpphF1HNGGA%3D%3D&amp;p=mm_14667228_0_0&amp;n=12" target="_blank"><img src="" alt=""></a>
<a href="http://s.click.taobao.com/t_1?i=qzvmMjgQtB0UgQ%3D%3D&amp;p=mm_14667228_0_0&amp;n=12" target="_blank"><img src="" alt=""></a> <a href="http://s.click.taobao.com/t_1?i=qzvmMjgQtB0UgQ%3D%3D&amp;p=mm_14667228_0_0&amp;n=12" target="_blank">《淘宝天下》6个月/26期 130元 送瑞士军刀旗舰店398元抵价券</a> 130.0元 <a href="http://s.click.taobao.com/t_1?i=qzvmMjgQtB0UgQ%3D%3D&amp;p=mm_14667228_0_0&amp;n=12" target="_blank"><img src="" alt=""></a>
<a href="http://s.click.taobao.com/t_1?i=qzvmMjm%2Bgumi1Q%3D%3D&amp;p=mm_14667228_0_0&amp;n=12" target="_blank"><img src="" alt=""></a> <a href="http://s.click.taobao.com/t_1?i=qzvmMjm%2Bgumi1Q%3D%3D&amp;p=mm_14667228_0_0&amp;n=12" target="_blank">《淘宝天下》3个月/13期 65元 送OOPS服饰专营店118元抵价券</a> 65.0元 <a href="http://s.click.taobao.com/t_1?i=qzvmMjm%2Bgumi1Q%3D%3D&amp;p=mm_14667228_0_0&amp;n=12" target="_blank"><img src="" alt=""></a><a href="http://writeblog.csdn.net/EditCategories.aspx?catID=1" target="_blank">[编辑]</a>文章分类* <a href="http://blog.csdn.net/lovingprince/category/489565.aspx/rss" target="_blank"><img src="" alt="(RSS)"></a><a href="http://blog.csdn.net/lovingprince/category/489565.aspx" title="架构分析" target="_blank">Architecture</a></p>
<ul>
<li><a href="http://blog.csdn.net/lovingprince/category/284705.aspx/rss" target="_blank"><img src="" alt="(RSS)"></a><a href="http://blog.csdn.net/lovingprince/category/284705.aspx" title="包含一些数据库处理心得" target="_blank">Database</a></li>
<li><a href="http://blog.csdn.net/lovingprince/category/289923.aspx/rss" target="_blank"><img src="" alt="(RSS)"></a><a href="http://blog.csdn.net/lovingprince/category/289923.aspx" title="设计模式" target="_blank">Design Pattern</a></li>
<li><a href="http://blog.csdn.net/lovingprince/category/267838.aspx/rss" target="_blank"><img src="" alt="(RSS)"></a><a href="http://blog.csdn.net/lovingprince/category/267838.aspx" title="包含一些基本的基础常识等" target="_blank">Java</a></li>
<li><a href="http://blog.csdn.net/lovingprince/category/601796.aspx/rss" target="_blank"><img src="" alt="(RSS)"></a><a href="http://blog.csdn.net/lovingprince/category/601796.aspx" title="linux相关， 命令，安装等" target="_blank">Linux</a></li>
<li><a href="http://blog.csdn.net/lovingprince/category/479430.aspx/rss" target="_blank"><img src="" alt="(RSS)"></a><a href="http://blog.csdn.net/lovingprince/category/479430.aspx" title="各种杂类文章" target="_blank">Others</a></li>
<li><a href="http://blog.csdn.net/lovingprince/category/604421.aspx/rss" target="_blank"><img src="" alt="(RSS)"></a><a href="http://blog.csdn.net/lovingprince/category/604421.aspx" title="项目管理" target="_blank">Project Management</a></li>
<li><a href="http://blog.csdn.net/lovingprince/category/289037.aspx/rss" target="_blank"><img src="" alt="(RSS)"></a><a href="http://blog.csdn.net/lovingprince/category/289037.aspx" title="数据结构与算法" target="_blank">Structure&amp;Arithmetic</a></li>
<li><a href="http://blog.csdn.net/lovingprince/category/284725.aspx/rss" target="_blank"><img src="" alt="(RSS)"></a><a href="http://blog.csdn.net/lovingprince/category/284725.aspx" title="记录一些平时开发过程中得到的启示和想法等等&lt;br /&gt;" target="_blank">Thinking</a></li>
<li><a href="http://blog.csdn.net/lovingprince/category/284704.aspx/rss" target="_blank"><img src="" alt="(RSS)"></a><a href="http://blog.csdn.net/lovingprince/category/284704.aspx" title="一些WEB处理技巧和方法" target="_blank">Web</a></li>
<li><a href="http://blog.csdn.net/lovingprince/category/490182.aspx/rss" target="_blank"><img src="" alt="(RSS)"></a><a href="http://blog.csdn.net/lovingprince/category/490182.aspx" title="职场的各大信息" target="_blank">职场风云</a><a href="http://writeblog.csdn.net/EditLinks.aspx" target="_blank">[编辑]</a>代码质量<a href="http://www.gotapi.com/html" target="_blank">各类API查询</a><a href="http://www.ibm.com/developerworks/cn/java/j-cq/" target="_blank">追求代码质量</a><a href="http://www.ibm.com/developerworks/cn/java/j-cq/" target="_blank">追求代码质量: 测试 Struts 遗留的应用程序</a><a href="http://www.ibm.com/developerworks/cn/java/j-cq05227/index.html?S_TACT=105AGX52&amp;S_CMP=techcsdn" target="_blank">追求代码质量: 谨防紧密耦合！</a><a href="http://writeblog.csdn.net/EditLinks.aspx" target="_blank">[编辑]</a>发表论文<a href="http://www.ahcit.com/lanmuyd.asp?id=1972" target="_blank">结合混沌密码理论的彩色图象水印算法</a><a href="http://writeblog.csdn.net/EditLinks.aspx" target="_blank">[编辑]</a>技术文章<a href="http://www.cjsdn.net/post/view?bid=1&amp;id=155312&amp;age=0" target="_blank">finally子句和try子句中return的先后关系，以及原理</a><a href="http://www.elook.net.cn/cms/Site/Article/wlbch15/Java400/J2EEEJBJMS421/45129.html" target="_blank">Hibernate包作用详解</a><a href="http://hsqldb.bokee.com/" target="_blank">HSQLDB中文网站</a><a href="http://dreamstone.javaeye.com/blog/77889" target="_blank">Java 1.5被忽略了的小动作</a><a href="http://www.360doc.com/showweb/0/0/402740.aspx" target="_blank">Java XML API 漫谈</a><a href="http://www.ibm.com/developerworks/cn/java/coretech/index.html?S_TACT=105AGX52&amp;S_CMP=techcsdn" target="_blank">Java 核心技术专题</a><a href="http://ltc603.javaeye.com/blog/123191" target="_blank">JavaScript 打印web页面</a><a href="http://searchwebservices.techtarget.com.cn/tips/362/2158862.shtml" target="_blank">Java类加载内幕</a><a href="http://www.jdon.com/jivejdon/thread/15456.html" target="_blank">Java编程极限考验：ClassLoader类装载策略</a><a href="http://tvjody.javaeye.com/blog/125643" target="_blank">java调用dll</a><a href="http://www.itisedu.com/phrase/200604261751455.html" target="_blank">JMX</a><a href="http://www.sonatype.com/" target="_blank">maven文档</a><a href="http://www.jdon.com/concurrent/reactor.htm" target="_blank">Reactor模式和NIO</a><a href="http://www.ibm.com/developerworks/cn/java/j-ropes/?S_TACT=105AGX52&amp;S_CMP=techcsdn" target="_blank">Rope：理论与实践 为何以及何时使用 Ropes for Java 操纵字符串</a><a href="http://www.ibm.com/developerworks/cn/java/wa-spring1/" target="_blank">Spring 系列: Spring 框架简介</a><a href="http://www-128.ibm.com/developerworks/cn/java/j-sr1.html" target="_blank">Struts 与 Velocity 的集成</a><a href="http://xdoclet.sourceforge.net/xdoclet/ant/xdoclet/modules/hibernate/HibernateDocletTask.html" target="_blank">xdoclet</a><a href="http://www.ibm.com/developerworks/cn/webservices/understand/index.html?S_TACT=105AGX52&amp;S_CMP=techcsdn" target="_blank">了解 Web 服务规范</a><a href="http://www-128.ibm.com/developerworks/cn/opensource/os-cn-cas/?S_TACT=105AGX52&amp;S_CMP=techcsdn" target="_blank">使用 CAS 在 Tomcat 中实现单点登录</a><a href="http://www-128.ibm.com/developerworks/cn/java/j-velocity/" target="_blank">使用 Velocity 实现客户端和服务器端模板</a><a href="http://coolyongzi.javaeye.com/blog/192957" target="_blank">使用spring2.5注释驱动的IOC功能</a><a href="http://www.blogjava.net/hopeshared/archive/2006/10/23/76780.html" target="_blank">初探Java类加载机制的奥秘（zz）</a><a href="http://www.ibm.com/developerworks/cn/java/j-ioc/index.html?S_TACT=105AGX52&amp;S_CMP=techcsdn" target="_blank">在方法签名中使用控制反转（IoC）</a><a href="http://www.cnblogs.com/passer/archive/2008/07/16/1243811.html" target="_blank">看看baidu是如何AJAX跨域的</a><a href="http://www.ibm.com/developerworks/cn/xml/x-jsonml/index.html?S_TACT=105AGX52&amp;S_CMP=techcsdn" target="_blank">认识 JsonML</a><a href="http://thinkbase.net/w/main/Wiki?Tomcat5SSL_ServerAndClient" target="_blank">配置适用于正式使用环境下的Tomcat Web服务器双向SSL认证</a><a href="http://writeblog.csdn.net/EditLinks.aspx" target="_blank">[编辑]</a>设计模式<a href="http://www.ibm.com/developerworks/cn/java/design/?S_TACT=105AGX52&amp;S_CMP=tec-csdn" target="_blank">Java 设计模式与建模专题</a><a href="http://hqmank.blog.bokee.net/bloggermodule/blog_viewblog.do?id=472499" target="_blank">jive的设计模式-jive源代码研究2</a><a href="http://www.jdon.com/designpatterns/index.htm" target="_blank">设计模式(Patterns in Java)</a><a href="http://www.cnblogs.com/kid-li/category/44668.html?Show=All" target="_blank">设计模式学习笔记-写得很好</a><a href="http://writeblog.csdn.net/EditLinks.aspx" target="_blank">[编辑]</a>系统架构<a href="http://www.ccs.neu.edu/groups/IEEE/ind-acad/brewer/index.htm" target="_blank">Lessons from Internet Services: ACID vs. BASE</a><a href="http://www.infoq.com/cn/interviews/fengdahui-database-architecture" target="_blank">与冯大辉谈数据库架构</a><a href="http://www.infoq.com/cn/articles/Qclub-on-open-platform" target="_blank">互联网开放平台技术趋势和讨论</a><a href="http://www.infoq.com/cn/articles/distributed-sys-usability" target="_blank">分布式系统中的一致性和可用性</a><a href="http://www.infoq.com/cn/articles/ebay-scalability-best-practices" target="_blank">可伸缩性最佳实践：来自eBay的经验</a><a href="http://www.infoq.com/cn/articles/scalability-panel" target="_blank">构建的可伸缩性和达到的性能</a><a href="http://www.infoq.com/cn/news/2008/03/ebaybase" target="_blank">牺牲一致性来换取分布式架构的可伸缩性</a><a href="http://www.infoq.com/cn/interviews/popescu-infoq-architecture-cn" target="_blank">谈InfoQ.com网站架构</a><a href="http://highscalability.com/" target="_blank">高伸缩性网站架构分析</a>存档* <a href="http://blog.csdn.net/lovingprince/archive/2010/01.aspx" target="_blank">2010年01月(1)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2009/12.aspx" target="_blank">2009年12月(4)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2009/11.aspx" target="_blank">2009年11月(1)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2009/10.aspx" target="_blank">2009年10月(5)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2009/09.aspx" target="_blank">2009年09月(5)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2009/07.aspx" target="_blank">2009年07月(2)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2009/06.aspx" target="_blank">2009年06月(4)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2009/05.aspx" target="_blank">2009年05月(1)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2009/04.aspx" target="_blank">2009年04月(2)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2009/03.aspx" target="_blank">2009年03月(5)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2009/02.aspx" target="_blank">2009年02月(4)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2009/01.aspx" target="_blank">2009年01月(5)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2008/12.aspx" target="_blank">2008年12月(7)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2008/11.aspx" target="_blank">2008年11月(14)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2008/10.aspx" target="_blank">2008年10月(4)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2008/09.aspx" target="_blank">2008年09月(5)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2008/08.aspx" target="_blank">2008年08月(6)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2008/07.aspx" target="_blank">2008年07月(8)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2008/06.aspx" target="_blank">2008年06月(7)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2008/05.aspx" target="_blank">2008年05月(8)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2008/04.aspx" target="_blank">2008年04月(2)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2008/03.aspx" target="_blank">2008年03月(3)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2008/02.aspx" target="_blank">2008年02月(1)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2008/01.aspx" target="_blank">2008年01月(1)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2007/12.aspx" target="_blank">2007年12月(9)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2007/11.aspx" target="_blank">2007年11月(3)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2007/10.aspx" target="_blank">2007年10月(2)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2007/09.aspx" target="_blank">2007年09月(3)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2007/08.aspx" target="_blank">2007年08月(5)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2007/06.aspx" target="_blank">2007年06月(7)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2007/05.aspx" target="_blank">2007年05月(6)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2007/04.aspx" target="_blank">2007年04月(20)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2007/03.aspx" target="_blank">2007年03月(22)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2007/02.aspx" target="_blank">2007年02月(2)</a></li>
<li><a href="http://blog.csdn.net/lovingprince/archive/2006/12.aspx" target="_blank">2006年12月(1)</a><h1 id="-httpclient-"><img src="" alt="原创">  注意设置httpclient连接数 <a href="&quot;收藏到我的网摘中，并分享给我的朋友&quot;">收藏</a></h1>
</li>
</ul>
<p>在使用Httpclient的过程中，线上的酒店出现过一个问题，就是当访问量增大的时候，会发现本地的连接等待时间急剧增加，例如从400ms增加到 78000ms，之前一直以为是航信系统问题，后面经过检查才发现，原来是本地httpclient设置时，最大连接数采用了默认设置的原因，而默认的最大连接数只有2个，所以当有大量连接需要建立时，大多数连接只有等待。后面将连接数设置修改成32个之后，这个响应时间就基本上很少出现很大的时候。</p>
<pre><code>  HttpConnectionManager httpConnectionManager = new MultiThreadedHttpConnectionManager();
    HttpConnectionManagerParams params = httpConnectionManager.getParams();
    params.setConnectionTimeout(5000);
    params.setSoTimeout(20000);
    params.setDefaultMaxConnectionsPerHost(32);//very important!!
    params.setMaxTotalConnections(256);//very important!!
    this.client = new HttpClient(httpConnectionManager);
    // 设置编码
    this.client.getParams().setContentCharset(CharsetHelper.GBK);
    this.client.getParams().setHttpElementCharset(CharsetHelper.GBK);
</code></pre><p>我们一般很容易注意到设置超时时间，例如这里的红色部分，但是极有可能忘记设置每个主机的最大连接数(绿色)，因此大家注意一下，本来是最简单的，但也最容易被忽略。</p>
<p>发表于 @ 2009年09月03日　18:39:00 | <a href="http://blog.csdn.net/lovingprince/archive/2009/09/03/4516532.aspx#FeedBack" title="评论" target="_blank">评论( loading...  )</a>| <a href="http://writeblog.csdn.net/PostEdit.aspx?entryId=4516532" title="编辑" target="_blank">编辑</a>| <a href="mailto:webmaster@csdn.net?subject=Article Report!!!&amp;body=Author:lovingprinceURL:http://blog.csdn.net/ArticleContent.aspx?UserName=lovingprince&amp;Entryid=4516532">举报</a>| <a href="&quot;收藏到我的网摘中，并分享给我的朋友&quot;">收藏</a></p>
<h3 id="-java-http-blog-csdn-net-lovingprince-archive-2009-07-02-4317069-aspx-jboss-as-http-blog-csdn-net-lovingprince-archive-2009-09-03-4516537-aspx-"><a href="http://blog.csdn.net/lovingprince/archive/2009/07/02/4317069.aspx" target="_blank">旧一篇:java 类加载器体系结构</a> | <a href="http://blog.csdn.net/lovingprince/archive/2009/09/03/4516537.aspx" target="_blank">新一篇:Jboss as 基本设置</a></h3>
<p><a href="http://blog.csdn.net/" target="_blank">查看最新精华文章 请访问博客首页</a>相关文章<a href=""></a></p>
<ul>
<li><p>发表评论</p>
</li>
<li><p>表 情：</p>
</li>
<li><p><a href="http://blog.csdn.net/lovingprince/archive/2009/09/03/4516532.aspx#" target="_blank"><img src="&quot;顶&quot;" alt="顶"></a> <a href="http://blog.csdn.net/lovingprince/archive/2009/09/03/4516532.aspx#" target="_blank"><img src="&quot;砸&quot;" alt="砸"></a> <a href="http://blog.csdn.net/lovingprince/archive/2009/09/03/4516532.aspx#" target="_blank"><img src="&quot;棒&quot;" alt="棒"></a> <a href="http://blog.csdn.net/lovingprince/archive/2009/09/03/4516532.aspx#" target="_blank"><img src="&quot;大笑&quot;" alt="大笑"></a> <a href="http://blog.csdn.net/lovingprince/archive/2009/09/03/4516532.aspx#" target="_blank"><img src="&quot;愤怒&quot;" alt="愤怒"></a> <a href="http://blog.csdn.net/lovingprince/archive/2009/09/03/4516532.aspx#" target="_blank"><img src="&quot;大哭&quot;" alt="大哭"></a> <a href="http://blog.csdn.net/lovingprince/archive/2009/09/03/4516532.aspx#" target="_blank"><img src="&quot;疑问&quot;" alt="疑问"></a> <a href="http://blog.csdn.net/lovingprince/archive/2009/09/03/4516532.aspx#" target="_blank"><img src="&quot;汗&quot;" alt="汗"></a> <a href="http://blog.csdn.net/lovingprince/archive/2009/09/03/4516532.aspx#" target="_blank"><img src="&quot;呕吐&quot;" alt="呕吐"></a> <a href="http://blog.csdn.net/lovingprince/archive/2009/09/03/4516532.aspx#" target="_blank"><img src="&quot;送花&quot;" alt="送花"></a></p>
</li>
<li><p>评论内容：
*</p>
</li>
<li>用 户 名：</li>
<li><p><a href="">登录</a> <a href="http://passport.csdn.net/CSDNUserRegister.aspx" target="_blank">注册</a> 匿名评论</p>
</li>
<li><p>验 证 码：</p>
</li>
<li><a href=""><img src="" alt="验证码"></a> <a href="">重新获得验证码</a></li>
</ul>
<p>*</p>
<ul>
<li><a href="http://blog.csdn.net/lovingprince/archive/2009/09/03/4516532.aspx#" target="_blank"><img src="" alt=""></a></li>
</ul>
<p>Copyright © lovingprincePowered by CSDN Blog<img src="" alt=""></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/Httpclient/">Httpclient</a></li></span></span> | <span class="tags">Tagged <a href="/tags/Httpclient/" class="label label-primary">Httpclient</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:37"datetime="2014-03-07 09:54:37"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-Httpclient--注意设置httpclient连接数-黄刚的专栏-CSDN博客/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-Httpclient--注意设置httpclient连接数-黄刚的专栏-CSDN博客" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-Httpclient--httpClient中文乱码问题解决（wap提交）收藏-kangojian的专栏-博客频道/">httpClient中文乱码问题解决（wap提交）收藏 </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:37.000Z"> <a href="/2014/02/02/2014-02-02-Httpclient--httpClient中文乱码问题解决（wap提交）收藏-kangojian的专栏-博客频道/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="httpclient-wap-kangojian-csdn-net">httpClient中文乱码问题解决（wap提交）收藏 - kangojian的专栏 - 博客频道 - CSDN.NET</h1>
<p>您还未登录！|<a href="https://passport.csdn.net/account/login" target="_blank">登录</a>|<a href="https://passport.csdn.net/account/register" target="_blank">注册</a>|<a href="https://passport.csdn.net/help/faq" target="_blank">帮助</a></p>
<ul>
<li><a href="http://www.csdn.net/" target="_blank">首页</a></li>
<li><a href="http://news.csdn.net/" target="_blank">业界</a></li>
<li><a href="http://mobile.csdn.net/" target="_blank">移动</a></li>
<li><a href="http://cloud.csdn.net/" target="_blank">云计算</a></li>
<li><a href="http://sd.csdn.net/" target="_blank">研发</a></li>
<li><a href="http://bbs.csdn.net/" target="_blank">论坛</a></li>
<li><a href="http://blog.csdn.net/" target="_blank">博客</a></li>
<li><a href="http://download.csdn.net/" target="_blank">下载</a></li>
<li><h2 id="-"><a href="">更多</a></h2>
</li>
</ul>
<h1 id="-kangojian-http-blog-csdn-net-kangojian-"><a href="http://blog.csdn.net/kangojian" target="_blank">kangojian的专栏</a></h1>
<h1 id="-">#</h1>
<ul>
<li><a href="http://blog.csdn.net/kangojian?viewmode=contents" target="_blank"><img src="" alt="">目录视图</a></li>
<li><a href="http://blog.csdn.net/kangojian?viewmode=list" target="_blank"><img src="" alt="">摘要视图</a></li>
<li><a href="http://blog.csdn.net/kangojian/rss/list" target="_blank"><img src="" alt="">订阅</a>
<a href="http://blog.csdn.net/sq_zhuyi/article/details/7924776" target="_blank">公告：CSDN博客频道推出博客导出工具（开源）</a>      <a href="http://blog.csdn.net/csdnproduct/article/details/7987178" target="_blank">公告：CSDN博客频道推出文章目录功能</a>     <a href="http://blog.csdn.net/csdnproduct/article/details/7964475" target="_blank">CSDN产品客服新浪微博正式上线</a>
<a href="http://mdcc.csdn.net/" target="_blank">移动开发者大会最新议题发布6折抢票最后3天</a>                 <a href="http://blog.csdn.net/blogdevteam/article/details/7954317" target="_blank">“第一次亲密接触”—项目遇到的问题有奖征文活动</a></li>
</ul>
<h3 id="-httpclient-wap-"><a href="">httpClient中文乱码问题解决（wap提交）收藏</a></h3>
<p>2008-06-24 14:55 547人阅读 <a href="http://blog.csdn.net/kangojian/article/details/2582161#comments" target="_blank">评论</a>(0) <a href="&quot;收藏&quot;">收藏</a> <a href="http://blog.csdn.net/kangojian/article/details/2582161#report" title="举报" target="_blank">举报</a>
我在尝试着直接将中文改变为utf-8的字符串直接写入，失败后！以为是网络传输中应该是iso-8859-1方式传输的，然后将中文转为该编码格式，还是失败后，看httpclient源代码发现：重写postmethod中的getrequestcharset()方法，虽然源代码中该方法动态的设置编码格式，但是好像并没有很好的执行！在重写后，问题解决！ package pro; import java.io.IOException; import org.apache.commons.httpclient.HttpClient; import org.apache.commons.httpclient.HttpException; import org.apache.commons.httpclient.HttpStatus; import org.apache.commons.httpclient.NameValuePair; import org.apache.commons.httpclient.methods.PostMethod; public class simulateWebAction {     public static void main(String[] args) throws IOException {         // TODO Auto-generated method stub         String url = “/<em>/</em>/<em>/</em>/<em>/</em>/<em>”;         PostMethod postMethod = new UTF8PostMethod(url);         StringBuilder origin = new StringBuilder();         origin.setLength(0);                 HttpClient httpClient = new HttpClient(); //        getMethod.getParams().setParameter(HttpMethodParams.RETRY_HANDLER, new DefaultHttpMethodRetryHandler());                 NameValuePair a = new NameValuePair(&quot;a&quot;,&quot;/</em>/<em>&quot;);         NameValuePair q = new NameValuePair(&quot;q&quot;,&quot;/</em>/*&quot;);         NameValuePair[] param = new NameValuePair[]{a,q};                 postMethod.setRequestBody(param);         try { //            执行getMethod             int statusCode = httpClient.executeMethod(postMethod);             if (statusCode != HttpStatus.SC_OK) {                 System.err.println(&quot;Method failed: &quot;+ postMethod.getStatusLine());             }else{ //                读内容                 System.out.println(postMethod.getResponseBodyAsString());             }                         } catch (HttpException e) {                 // TODO Auto-generated catch block                 e.printStackTrace();             } catch (IOException e) {                 // TODO Auto-generated catch block                 e.printStackTrace();             }finally{                 postMethod.releaseConnection();             }        }         public static class UTF8PostMethod extends PostMethod{         public UTF8PostMethod(String url){             super(url);         }         @Override         public String getRequestCharSet() {             //return super.getRequestCharSet();             return &quot;UTF-8&quot;;         }     } }</p>
<p>分享到： <a href="&quot;分享到新浪微博&quot;"></a><a href="&quot;分享到腾讯微博&quot;"></a></p>
<ul>
<li>上一篇：<a href="http://blog.csdn.net/kangojian/article/details/2582124" target="_blank">HTTP 1.1 状态码与它们的用途(ZT)- -</a></li>
<li><p>下一篇：<a href="http://blog.csdn.net/kangojian/article/details/2597273" target="_blank">struts2.0----菜鸟日记一</a>
查看评论<a href=""></a></p>
<p>暂无评论
您还没有登录,请<a href="http://passport.csdn.net/account/login?from=http%3A%2F%2Fblog.csdn.net%2Fkangojian%2Farticle%2Fdetails%2F2582161" target="_blank">[登录]</a>或<a href="http://passport.csdn.net/account/register?from=http%3A%2F%2Fblog.csdn.net%2Fkangojian%2Farticle%2Fdetails%2F2582161" target="_blank">[注册]</a></p>
</li>
</ul>
<p>/* 以上用户言论只代表其个人观点，不代表CSDN网站的观点或立场<a href=""></a><a href=""></a>
<a href="http://blog.csdn.net/kangojian/article/details/2582161#" title="回到顶部" target="_blank"><img src="" alt="TOP"></a></p>
<p>个人资料</p>
<p><a href="http://my.csdn.net/kangojian" target="_blank"><img src="&quot;访问我的空间&quot;" alt=""></a>
<a href="http://my.csdn.net/kangojian" target="_blank">kangojian</a></p>
<p><a href="http://blog.csdn.net/kangojian/article/details/2582161#" title="[加关注]" target="_blank"></a> <a href="http://my.csdn.net/my/letter/send/kangojian" title="[发私信]"></a></p>
<ul>
<li>访问：87731次</li>
<li>积分：2367分</li>
<li><p>排名：第2242名</p>
</li>
<li><p>原创：127篇</p>
</li>
<li>转载：103篇</li>
<li>译文：2篇</li>
<li>评论：36条</li>
</ul>
<p>文章搜索</p>
<p><a href=""></a>
文章分类</p>
<ul>
<li><a href="http://blog.csdn.net/kangojian/article/category/496276" target="_blank">Apache</a>(15)</li>
<li><a href="http://blog.csdn.net/kangojian/article/category/502638" target="_blank">java Spider</a>(2)</li>
<li><a href="http://blog.csdn.net/kangojian/article/category/509900" target="_blank">java 算法</a>(13)</li>
<li><a href="http://blog.csdn.net/kangojian/article/category/496279" target="_blank">javaAPI</a>(56)</li>
<li><a href="http://blog.csdn.net/kangojian/article/category/496277" target="_blank">Js</a>(1)</li>
<li><a href="http://blog.csdn.net/kangojian/article/category/583377" target="_blank">Linux</a>(2)</li>
<li><a href="http://blog.csdn.net/kangojian/article/category/496278" target="_blank">Luncece</a>(1)</li>
<li><a href="http://blog.csdn.net/kangojian/article/category/502640" target="_blank">luncece</a>(1)</li>
<li><a href="http://blog.csdn.net/kangojian/article/category/496281" target="_blank">mysql</a>(25)</li>
<li><a href="http://blog.csdn.net/kangojian/article/category/496280" target="_blank">spring</a>(12)</li>
<li><a href="http://blog.csdn.net/kangojian/article/category/702233" target="_blank">数据层</a>(4)</li>
<li><a href="http://blog.csdn.net/kangojian/article/category/567162" target="_blank">杂谈</a>(19)</li>
<li><a href="http://blog.csdn.net/kangojian/article/category/683710" target="_blank">设计模式</a>(4)</li>
</ul>
<p>文章存档</p>
<ul>
<li><a href="http://blog.csdn.net/kangojian/article/month/2012/03" target="_blank">2012年03月</a>(1)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2012/02" target="_blank">2012年02月</a>(2)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2012/01" target="_blank">2012年01月</a>(5)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2011/11" target="_blank">2011年11月</a>(1)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2011/10" target="_blank">2011年10月</a>(5)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2011/09" target="_blank">2011年09月</a>(4)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2011/08" target="_blank">2011年08月</a>(5)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2011/05" target="_blank">2011年05月</a>(5)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2011/04" target="_blank">2011年04月</a>(2)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2011/03" target="_blank">2011年03月</a>(5)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2011/02" target="_blank">2011年02月</a>(8)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2011/01" target="_blank">2011年01月</a>(4)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2010/12" target="_blank">2010年12月</a>(4)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2010/11" target="_blank">2010年11月</a>(4)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2010/10" target="_blank">2010年10月</a>(1)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2010/08" target="_blank">2010年08月</a>(4)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2010/07" target="_blank">2010年07月</a>(16)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2010/06" target="_blank">2010年06月</a>(3)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2010/05" target="_blank">2010年05月</a>(2)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2010/04" target="_blank">2010年04月</a>(5)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2010/03" target="_blank">2010年03月</a>(2)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2010/02" target="_blank">2010年02月</a>(7)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2010/01" target="_blank">2010年01月</a>(7)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2009/12" target="_blank">2009年12月</a>(2)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2009/11" target="_blank">2009年11月</a>(10)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2009/10" target="_blank">2009年10月</a>(3)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2009/09" target="_blank">2009年09月</a>(2)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2009/08" target="_blank">2009年08月</a>(8)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2009/07" target="_blank">2009年07月</a>(7)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2009/06" target="_blank">2009年06月</a>(1)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2009/05" target="_blank">2009年05月</a>(5)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2009/04" target="_blank">2009年04月</a>(1)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2009/03" target="_blank">2009年03月</a>(11)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2009/02" target="_blank">2009年02月</a>(1)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2009/01" target="_blank">2009年01月</a>(4)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2008/12" target="_blank">2008年12月</a>(2)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2008/11" target="_blank">2008年11月</a>(11)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2008/10" target="_blank">2008年10月</a>(9)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2008/09" target="_blank">2008年09月</a>(8)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2008/08" target="_blank">2008年08月</a>(6)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2008/07" target="_blank">2008年07月</a>(6)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2008/06" target="_blank">2008年06月</a>(10)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2008/05" target="_blank">2008年05月</a>(11)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2008/04" target="_blank">2008年04月</a>(7)</li>
<li><a href="http://blog.csdn.net/kangojian/article/month/2008/03" target="_blank">2008年03月</a>(5)</li>
</ul>
<p>展开
阅读排行</p>
<ul>
<li><a href="http://blog.csdn.net/kangojian/article/details/3122483" title="•Oracle 9i企业版官方下载 9.2.0.1.0 " target="_blank">•Oracle 9i企业版官方下载 9.2.0.1.0</a>(6936)</li>
<li><a href="http://blog.csdn.net/kangojian/article/details/3216884" title="Java中的invoke使用" target="_blank">Java中的invoke使用</a>(4194)</li>
<li><a href="http://blog.csdn.net/kangojian/article/details/2991316" title="java 超简单 生成json与解析" target="_blank">java 超简单 生成json与解析</a>(3731)</li>
<li><a href="http://blog.csdn.net/kangojian/article/details/3238699" title="spring配置文件详解" target="_blank">spring配置文件详解</a>(3037)</li>
<li><a href="http://blog.csdn.net/kangojian/article/details/2801200" title="mysql  #1349 - View&#39;s SELECT contains a subquery in the FROM clause  错误" target="_blank">mysql /#1349 - View&#39;s SELECT contains a subquery in the FROM clause 错误</a>(2801)</li>
<li><a href="http://blog.csdn.net/kangojian/article/details/3095274" title="在windows xp下,一块网卡绑定多个ip,设置多个网络连接" target="_blank">在windows xp下,一块网卡绑定多个ip,设置多个网络连接</a>(2062)</li>
<li><a href="http://blog.csdn.net/kangojian/article/details/2808001" title="hibernate 级联 必须注意的问题" target="_blank">hibernate 级联 必须注意的问题</a>(1650)</li>
<li><a href="http://blog.csdn.net/kangojian/article/details/3410763" title="Ext（一） 登录+验证码" target="_blank">Ext（一） 登录+验证码</a>(1469)</li>
<li><a href="http://blog.csdn.net/kangojian/article/details/2597586" title="struts2.0----菜鸟日记二" target="_blank">struts2.0----菜鸟日记二</a>(1330)</li>
<li><a href="http://blog.csdn.net/kangojian/article/details/5955677" title="java 内存监控使用" target="_blank">java 内存监控使用</a>(1320)</li>
</ul>
<p>评论排行</p>
<ul>
<li><a href="http://blog.csdn.net/kangojian/article/details/3410763" title="Ext（一） 登录+验证码" target="_blank">Ext（一） 登录+验证码</a>(5)</li>
<li><a href="http://blog.csdn.net/kangojian/article/details/3216884" title="Java中的invoke使用" target="_blank">Java中的invoke使用</a>(5)</li>
<li><a href="http://blog.csdn.net/kangojian/article/details/5711358" title="java nio Selector的使用－客户端" target="_blank">java nio Selector的使用－客户端</a>(5)</li>
<li><a href="http://blog.csdn.net/kangojian/article/details/6207464" title="网页快照 java 实现" target="_blank">网页快照 java 实现</a>(5)</li>
<li><a href="http://blog.csdn.net/kangojian/article/details/3122483" title="•Oracle 9i企业版官方下载 9.2.0.1.0 " target="_blank">•Oracle 9i企业版官方下载 9.2.0.1.0</a>(4)</li>
<li><a href="http://blog.csdn.net/kangojian/article/details/3624788" title="java博客灌水器完成" target="_blank">java博客灌水器完成</a>(1)</li>
<li><a href="http://blog.csdn.net/kangojian/article/details/5823357" title="Why use a ProtocolCodecFilter" target="_blank">Why use a ProtocolCodecFilter</a>(1)</li>
<li><a href="http://blog.csdn.net/kangojian/article/details/3853955" title="java算法之冒泡" target="_blank">java算法之冒泡</a>(1)</li>
<li><a href="http://blog.csdn.net/kangojian/article/details/5710977" title="java IO 概念误区---------同步/异步与阻塞/非阻塞的区别 " target="_blank">java IO 概念误区---------同步/异步与阻塞/非阻塞的区别</a>(1)</li>
<li><a href="http://blog.csdn.net/kangojian/article/details/5710877" title="java NIO 与IO的比较" target="_blank">java NIO 与IO的比较</a>(1)
推荐文章</li>
</ul>
<p>最新评论</p>
<ul>
<li><a href="http://blog.csdn.net/kangojian/article/details/5710877#comments" target="_blank">java NIO 与IO的比较</a></li>
</ul>
<p>liu149339750: 下载地址不可用！！</p>
<ul>
<li><a href="http://blog.csdn.net/kangojian/article/details/6207464#comments" target="_blank">网页快照 java 实现</a></li>
</ul>
<p>yangyawei2013: DJNativeSwing</p>
<ul>
<li><a href="http://blog.csdn.net/kangojian/article/details/6207464#comments" target="_blank">网页快照 java 实现</a></li>
</ul>
<p>jinyan1218: 能把chrriis包提供出来不？</p>
<ul>
<li><a href="http://blog.csdn.net/kangojian/article/details/5710977#comments" target="_blank">java IO 概念误区---------同步/异步与阻塞/非阻塞的区别</a></li>
</ul>
<p>wanghuichun8000: 不错</p>
<ul>
<li><a href="http://blog.csdn.net/kangojian/article/details/6207464#comments" target="_blank">网页快照 java 实现</a></li>
</ul>
<p>ncx1259988: 你把jar包提供出来啊</p>
<ul>
<li><a href="http://blog.csdn.net/kangojian/article/details/5443220#comments" target="_blank">深入理解java的finalize</a></li>
</ul>
<p>qin0701: 想看对象的状态转换图。</p>
<ul>
<li><a href="http://blog.csdn.net/kangojian/article/details/6207464#comments" target="_blank">网页快照 java 实现</a></li>
</ul>
<p>zq86813: 运行都报错。</p>
<ul>
<li><a href="http://blog.csdn.net/kangojian/article/details/5711358#comments" target="_blank">java nio Selector的使用－客户端</a></li>
</ul>
<p>yun2223: 顶一下。能不能也发一份代码到给我啊。。。eye上要下个代码还要注册以后等三天。。。397864905...</p>
<ul>
<li><a href="http://blog.csdn.net/kangojian/article/details/5711358#comments" target="_blank">java nio Selector的使用－客户端</a></li>
</ul>
<p>huanhuanyunzhou: ffsadfsdf</p>
<ul>
<li><a href="http://blog.csdn.net/kangojian/article/details/5711358#comments" target="_blank">java nio Selector的使用－客户端</a></li>
</ul>
<p>huanhuanyunzhou: rtyrtyryryrytr
      <img src="" alt=""></p>
<p><a href="http://www.csdn.net/company/about.html" target="_blank">公司简介</a>|<a href="http://www.csdn.net/company/recruit.html" target="_blank">招贤纳士</a>|<a href="http://www.csdn.net/company/marketing.html" target="_blank">广告服务</a>|<a href="http://www.csdn.net/company/account.html" target="_blank">银行汇款帐号</a>|<a href="http://www.csdn.net/company/contact.html" target="_blank">联系方式</a>|<a href="http://www.csdn.net/company/statement.html" target="_blank">版权声明</a>|<a href="http://www.csdn.net/company/layer.html" target="_blank">法律顾问</a>|<a href="mailto:webmaster@csdn.net">问题报告</a>京 ICP 证 070598 号北京创新乐知信息技术有限公司 版权所有<img src="" alt=""> 联系邮箱：webmaster@csdn.netCopyright © 1999-2012, CSDN.NET, All Rights Reserved <a href="http://www.hd315.gov.cn/beian/view.asp?bianhao=010202001032100010" target="_blank"><img src="" alt="GongshangLogo"></a></p>
<h3 id="-close-"><a href=""><img src="" alt="close"></a></h3>
<p><a href="http://2012amap.csdn.net/" target="_blank"><img src="" alt=""></a><img src="" alt=""></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/Httpclient/">Httpclient</a></li></span></span> | <span class="tags">Tagged <a href="/tags/Httpclient/" class="label label-primary">Httpclient</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:37"datetime="2014-03-07 09:54:37"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-Httpclient--httpClient中文乱码问题解决（wap提交）收藏-kangojian的专栏-博客频道/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-Httpclient--httpClient中文乱码问题解决（wap提交）收藏-kangojian的专栏-博客频道" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-脚本-batch--批处理计算雯波那契数列/">批处理计算雯波那契数列</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:37.000Z"> <a href="/2014/02/02/2014-02-02-脚本-batch--批处理计算雯波那契数列/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-">批处理计算雯波那契数列</h1>
<h1 id="-">批处理计算雯波那契数列</h1>
<p>01</p>
<p>@</p>
<p>echo</p>
<p>off</p>
<p>02</p>
<p>rem 批处理计算雯波那契数列
03</p>
<p>setlocal enabledelayedexpansion</p>
<p>04</p>
<p>set</p>
<p>a=1
05</p>
<p>set</p>
<p>b=1</p>
<p>06</p>
<p>echo</p>
<p>任意键查看下一项.
07</p>
<p>echo</p>
<p>第1项为：!a!</p>
<p>08</p>
<p>echo</p>
<p>第2项为：!b!
09</p>
<p>:start</p>
<p>10</p>
<p>set</p>
<p>/a tn+=1
11</p>
<p>set</p>
<p>/a n_=!tn!+2</p>
<p>12</p>
<p>for</p>
<p>/l %%a </p>
<p>in</p>
<p>(1,1,1000) </p>
<p>do</p>
<p>(
13</p>
<p>set</p>
<p>ka=!a:~%%a,1!</p>
<p>14</p>
<p>if</p>
<p>not defined ka (
15</p>
<p>set</p>
<p>la=%%a</p>
<p>16</p>
<p>goto :start_a
17</p>
<p>)</p>
<p>18</p>
<p>)
19</p>
<p>:start_a</p>
<p>20</p>
<p>for</p>
<p>/l %%a </p>
<p>in</p>
<p>(1,1,1000) </p>
<p>do</p>
<p>(
21</p>
<p>set</p>
<p>kb=!b:~%%a,1!</p>
<p>22</p>
<p>if</p>
<p>not defined kb (
23</p>
<p>set</p>
<p>lb=%%a</p>
<p>24</p>
<p>goto :start_b
25</p>
<p>)</p>
<p>26</p>
<p>)
27</p>
<p>:start_b</p>
<p>28</p>
<p>if</p>
<p>!la! == !lb! (
29</p>
<p>set</p>
<p>l=!la!</p>
<p>30</p>
<p>set</p>
<p>/a m=!a:~0,1!+!b:~0,1!
31</p>
<p>if</p>
<p>!m! geq 9 (</p>
<p>32</p>
<p>set</p>
<p>n=1
33</p>
<p>) </p>
<p>else</p>
<p>(</p>
<p>34</p>
<p>set</p>
<p>n=0
35</p>
<p>)</p>
<p>36</p>
<p>) </p>
<p>else</p>
<p>(
37</p>
<p>set</p>
<p>n=0</p>
<p>38</p>
<p>)
39</p>
<p>if</p>
<p>!la! gtr !lb! (</p>
<p>40</p>
<p>set</p>
<p>/a l=!la!+!n!
41</p>
<p>) </p>
<p>else</p>
<p>(</p>
<p>42</p>
<p>set</p>
<p>/a l=!lb!+!n!
43</p>
<p>)</p>
<p>44</p>
<p>for</p>
<p>/l %%a </p>
<p>in</p>
<p>(1,1,!l!) </p>
<p>do</p>
<p>(
45</p>
<p>if</p>
<p>!la! geq %%a (</p>
<p>46</p>
<p>set</p>
<p>x=!a:~-%%a,1!
47</p>
<p>) </p>
<p>else</p>
<p>(</p>
<p>48</p>
<p>set</p>
<p>x=0
49</p>
<p>)</p>
<p>50</p>
<p>if</p>
<p>!lb! geq %%a (
51</p>
<p>set</p>
<p>y=!b:~-%%a,1!</p>
<p>52</p>
<p>) </p>
<p>else</p>
<p>(
53</p>
<p>set</p>
<p>y=0</p>
<p>54</p>
<p>)
55</p>
<p>if</p>
<p>defined o (</p>
<p>56</p>
<p>set</p>
<p>/a z=!x!+!y!+!o!
57</p>
<p>set</p>
<p>o=</p>
<p>58</p>
<p>) </p>
<p>else</p>
<p>(
59</p>
<p>set</p>
<p>/a z=!x!+!y!</p>
<p>60</p>
<p>)
61</p>
<p>if</p>
<p>!z! gtr 9 </p>
<p>set</p>
<p>o=1</p>
<p>62</p>
<p>set</p>
<p>/p =!z:~-1,1!<nul>&gt;%temp%\temp.txt
63</p>
<p>set</p>
<p>/p all=&lt;%temp%\temp.txt</p>
<p>64</p>
<p>65</p>
<p>)</p>
<p>66</p>
<p>for</p>
<p>/l %%a </p>
<p>in</p>
<p>(1,1,!l!) </p>
<p>do</p>
<p>set</p>
<p>/p =!all:~-%%a,1!<nul>&gt;%temp%\temp_.txt
67</p>
<p>set</p>
<p>b=!a!</p>
<p>68</p>
<p>set</p>
<p>/p a=&lt;%temp%\temp_.txt
69</p>
<p>del %temp%\temp/*.txt /q</p>
<p>70</p>
<p>if</p>
<p>&quot;!a:~0,1!&quot;</p>
<p>== </p>
<p>&quot;0&quot;</p>
<p>set</p>
<p>a=!a:~1!
71</p>
<p>echo</p>
<p>第!n_!项为：!a!</p>
<p>72</p>
<p>pause&gt;nul
73</p>
<p>goto :start</p>
<p>来源： <a href="[http://my.oschina.net/veterans/blog/27841](http://my.oschina.net/veterans/blog/27841)">[http://my.oschina.net/veterans/blog/27841](http://my.oschina.net/veterans/blog/27841)</a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/脚本/">脚本</a></li></span><span class="breadcrumb"><li><a href="/categories/脚本/">脚本</a></li><li><a href="/categories/脚本/batch/">batch</a></li></span></span> | <span class="tags">Tagged <a href="/tags/batch/" class="label label-primary">batch</a><a href="/tags/脚本/" class="label label-success">脚本</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:37"datetime="2014-03-07 09:54:37"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-脚本-batch--批处理计算雯波那契数列/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-脚本-batch--批处理计算雯波那契数列" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>





<ul id="pagination" class="pagination pagination-lg">
  <li><a class="extend prev" href="/page/103/">&laquo;</a></li><li><a class="page-number" href="/">1</a></li><li><a class="page-number" href="/page/2/">2</a></li><li><span class="space">&hellip;</span></li><li><a class="page-number" href="/page/101/">101</a></li><li><a class="page-number" href="/page/102/">102</a></li><li><a class="page-number" href="/page/103/">103</a></li><li class="active"><li><span class="page-number current">104</span></li><li><a class="page-number" href="/page/105/">105</a></li><li><a class="page-number" href="/page/106/">106</a></li><li><a class="page-number" href="/page/107/">107</a></li><li><span class="space">&hellip;</span></li></li><li><a class="page-number" href="/page/164/">164</a></li><li><a class="page-number" href="/page/165/">165</a></li><li><a class="extend next" href="/page/105/">&raquo;</a></li>
  <div class="clearfix"></div>
</ul></div><!--wapper-->
       </div><!-- ID main-col END -->
       <aside id="sidebar" class="alignright col-sx-6 col-sm-4 col-md-3 col-lg-3">
<div id="widget_search" class="widget panel panel-primary">
    <form action="//google.com/search" method="get" accept-charset="utf-8">
  <div class="input-group">
    <input class="form-control" id="searchbox" type="search" name="q" results="0" placeholder="search">
    <span class="input-group-btn">
      <button class="btn btn-default" type="submit">Go!</button>
    </span>
    <input type="hidden" name="q" value="site:itsolife.com">
  </div>
</form>
</div>

<div id="widget_category" class="widget panel panel-primary">
  <div class="panel-heading">category</div>  <div data-src='category' class='ajax_widgets'>正在加载...</div>
</div>

<div id="widget_recent_posts" class="widget panel panel-primary">
  <div class="panel-heading">recent posts</div>  <div data-src='recent_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_tagcloud" class="widget panel panel-primary">
  <div class="panel-heading">tagcloud</div>  <div data-src='tagcloud' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_latest_update_posts" class="widget panel panel-primary">
  <div class="panel-heading">最近更新</div>  <div data-src='latest_update_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_recent_comments" class="widget panel panel-primary">
  <div class="panel-heading">recent comments</div>  

<div class="list-group-item ds-recent-comments" data-num-items="6" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="50"></div>



</div>

</aside>
       <div class="clearfix"></div>
     </div><!-- row END -->
  </div>
  <footer id="footer" class="container">
  <div class="panel panel-info">
  <section id='footer_widget'></section>  <div class="panel-footer">
  <div id="site-info">
    <span class='author'>
  
  &copy; 2014 RobinChia
  
    &nbsp;&nbsp;</span>
  
  <span id='analytics-51la'></span><span id='analytics-google'>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-48559895-1']);
  _gaq.push(['_trackPageview']);
  _js2load.push({src:('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'});
</script></span><span id='analytics-cnzz'>
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_5774006'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s17.cnzz.com/stat.php%3Fid%3D5774006%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
</span><span id='analytics-baidu'>
<script>
var _hmt = _hmt || [];
_js2load.push({src:"//hm.baidu.com/hm.js?1442f50724afc42380b51f097c43082c"});
</script>
</span>  </div>
  <div id="copyright">Blog powered by <a href='http://zespia.tw/hexo/'><strong>hexo</strong></a> Theme <strong><a href='https://github.com/chenall/hexo-theme-chenall'>chenall</a></strong>(Some change in it)<span class="pull-right"> 更新时间: <em>2014-03-25 18:15:42</em></span></div>
</div>
<div class="clearfix"></div>


  </div>
  </footer>
  
        <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>        
        <script src="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/js/bootstrap.min.js"></script>        
                
        <script src="http://cdn.bootcss.com/prettify/r298/prettify.min.js"></script>    <script type="text/javascript">
   var lang=["bsh", "c", "cc", "cpp", "cs", "csh", "cyc", "cv", "htm", "html",
    "java", "js", "m", "mxml", "perl", "pl", "pm", "py", "rb", "sh",
    "xhtml", "xml", "xsl"];
   var pretty_base='';
   $('script').each(function(){
	var c = $(this).attr('src');
	if (!c)
	    return;
	if (c.match(/(\/)?prettify(\.min)?\.js/i))
	{
	    var index = c.lastIndexOf('/');
	    if (index != -1)
		pretty_base = c.substr(0,index + 1);
	    return false;
	}
   })
   $('pre code').each(function(){
	var c = $(this).attr('class')
	if (!c)
	    return;
	c = c.match(/\s?(lang\-\w+)/i);
	if (c && lang.indexOf(c[1]) == -1)
	{
	    lang.push(c[1]);
	    $.getScript(pretty_base + c[1] + '.min.js');
	}
   })

    $(window).load(function(){
       $("pre").addClass("prettyprint");
       prettyPrint();
    })
</script>    
            <script type="text/javascript">
var duoshuoQuery = {short_name:"robinchia"};
_js2load.push({src:'http://static.duoshuo.com/embed.js',charset:'UTF-8'});
</script>
    
            <!--wumii_relatedItems-->
    
        <script src="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js"></script>    <script type="text/javascript">
(function($){
  $('.entry').each(function(i){
    $(this).find('img').each(function(){
      var alt = this.alt;

      if (alt){
        $(this).before('<span class="caption">' + alt + '</span>');
      }

      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="fancybox' + i + '" />');
    });
  });

  $('.fancybox').fancybox();
})(jQuery);
</script>    
        <script src="http://cdn.bootcss.com/mathjax/2.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>
    
<script type="text/javascript">
$('.ajax_widgets').each(function(){var src=$(this).attr('data-src');if(src)$(this).load('/widgets/'+src+'.html');});
$.each(_js2load,function(index,obj){loadjs(obj.src,obj.charset)});
</script>

<div id="scroll2top">
<img src="/scroll2top/arrow.png"/>
</div>
<script src="/scroll2top/scroll2top.min.js"></script>
<div id="winterland">
  <canvas></canvas>
</div>
<script src="/js/winterland.min.js"></script>

  </body>
</html>
