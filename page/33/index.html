
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>The 33 Page | It so life</title>
<meta name="author" content="RobinChia">

<meta name="description" content="It so life">


<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta property="og:site_name" content="It so life"/>

<!--[if IE]><style>.testIE.IE{display:inline;}</style><![endif]-->
<!--[if lte IE 7]><link rel="stylesheet" href="/css/ie7.css" type="text/css"><![endif]-->
<!--[if (lt IE 9)&(gt IE 7)]><style>.testIE.IE8{display:inline;}</style><![endif]-->
<!--[if gt IE 8]><style>.testIE.IE9{display:inline;}</style><![endif]-->

<link href="/favicon.png" rel="icon">
<link rel="alternate" href="/atom.xml" title="It so life Feed" type="application/atom+xml">

<link rel="stylesheet" href="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.0.3/css/font-awesome.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/prettify/r298/prettify.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" type="text/css">
<link rel="stylesheet" href="/css/style.css" type="text/css">
<!--[if lt IE 9]>
   <style>article,aside,dialog,footer,header,section,footer,nav,figure,menu{display:block}</style>
   <script src="http://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
   <script src="http://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
<link href="http://cdn.staticfile.org/respond.js/1.4.2/respond-proxy.html" id="respond-proxy" rel="respond-proxy" />
<link href="/js/respond.proxy.gif" id="respond-redirect" rel="respond-redirect" />
<script src="/js/respond.proxy.js"></script>
   <script src="http://cdn.bootcss.com/selectivizr/1.0.2/selectivizr-min.js"></script>
<![endif]-->
<script type="text/javascript">
function loadjs(c,d){var a=document.createElement("script");a.async=!0;a.type="text/javascript";a.src=c;a.charset=d||"gbk";(document.getElementsByTagName("HEAD")[0]||document.getElementsByTagName("BODY")[0]).appendChild(a)};
var _protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
var _js2load = [];
</script>

</head>
<body>
      <header id="header" class="container"><nav id="main-nav" class="navbar navbar-default navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="/">It so life</a>
    </div>
    <div  class="collapse navbar-collapse">
      <ul  class="nav navbar-nav">
  
        <li><a href="/" title="Home">Home</a></li>      
        <li><a href="/about/" title="About">About</a></li>      
        <li><a href="/archives/" title="Archives">Archives</a></li>      
      <li class='dropdown'>
        <a class='dropdown-toggle' data-toggle='dropdown' href='#'>website<b class='caret'></b></a>
        <ul class='dropdown-menu pure-menu-selected'>
    
          <li><a href="//groups.google.com/forum/#!forum/pongba" title="TopLanguage">TopLanguage</a></li>    
          <li><a href="//itpub.net/" title="ITPub">ITPub</a></li>    
          <li><a href="//blog.jobbole.com/" title="Bole">Bole</a></li>    
          <li><a href="//nosql-database.org/" title="nosql">nosql</a></li>    
          <li><a href="//gitimmersion.googol.im/" title="Git">Git</a></li>    
        </ul>
      </li>
    
      </ul>
      <ul class="nav navbar-nav navbar-right">
      
        <li><a href="/atom.xml">RSS</a></li>
      
      
        <li><a href="https://twitter.com/robinchia">twitter</a></li>
      
      
      
      
        <li><a href="https://github.com/robinchia">github</a></li>
      
      </ul>
    </div>
  </div>
</nav>
<div class="clearfix"></div>
</header>
  <div id='content' class="container">
     <div class="page-header-wrapper">
      <!--[if lt IE 9]><div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong>提示:</strong>您的浏览器版本太低了,建议升级到 <strong><a href="http://windows.microsoft.com/zh-cn/internet-explorer/download-ie" title="IE9">IE9</a></strong> 以上,本站使用<a href="https://www.google.com/intl/zh-CN/chrome/">Chrome浏览器</a>可以获得最好的显示效果.</div><![endif]-->
      <div class="page-header"><h1 align="center"><big>It so life</big> </h1>
        <h5 align="center"><big>love as life</big></h5>
      </div>
     </div>
     <div class="row">
       <div id="main-col" class="alignleft col-sx-12 col-sm-8 col-md-9 col-lg-9">
      <section id='header_widget'></section>
          <div id="wrapper"><article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-unix--Awk_百度百科/">Awk_百度百科</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:43.000Z"> <a href="/2014/02/02/2014-02-02-unix--Awk_百度百科/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="awk_-">Awk_百度百科</h1>
<h3 id="-">分享到</h3>
<ul>
<li><a href="">一键分享</a></li>
<li><a href="">QQ空间</a></li>
<li><a href="">新浪微博</a></li>
<li><a href="">百度云收藏</a></li>
<li><a href="">人人网</a></li>
<li><a href="">腾讯微博</a></li>
<li><a href="">百度相册</a></li>
<li><a href="">开心网</a></li>
<li><a href="">腾讯朋友</a></li>
<li><a href="">百度贴吧</a></li>
<li><a href="">豆瓣网</a></li>
<li><a href="">搜狐微博</a></li>
<li><a href="">百度新首页</a></li>
<li><a href="">QQ好友</a></li>
<li><a href="">和讯微博</a></li>
<li><a href="">更多...</a></li>
</ul>
<p><a href="">百度分享</a></p>
<ul>
<li><p>jywv</p>
</li>
<li><p><a href="">我的主页</a></p>
</li>
<li><a href="http://passport.baidu.com/center" target="_blank">帐号设置</a></li>
<li><a href="https://passport.baidu.com/?logout&amp;u=http%3A//baike.baidu.com/view/209681.htm" target="_blank">退出</a></li>
<li><a href="http://www.baidu.com/search/baike_help.html#百科积分体系" target="_blank">秀才</a>　二级</li>
<li>|</li>
<li><p>消息</p>
</li>
<li><p><a href="http://msg.baidu.com/" target="_blank">私信</a></p>
</li>
<li><a href="http://baike.baidu.com/messages" target="_blank">通知</a></li>
<li>|</li>
<li><p><a href="http://baike.baidu.com/uc/home" target="_blank">我的百科</a></p>
</li>
<li><p><a href="http://baike.baidu.com/uc/effort/" target="_blank">我的贡献</a></p>
</li>
<li><a href="http://baike.baidu.com/uc/draftlist/" target="_blank">草稿箱</a></li>
<li><a href="http://baike.baidu.com/uc/task/" target="_blank">我的任务</a></li>
<li><a href="http://baike.baidu.com/uc/recommend/" target="_blank">完善词条</a></li>
<li>|</li>
<li><a href="http://www.baidu.com/" target="_blank">百度首页</a></li>
</ul>
<p><a href="http://baike.baidu.com/" title="到百科首页" target="_blank"><img src="" alt=""></a></p>
<p><a href="http://news.baidu.com/ns?tn=news&amp;cl=2&amp;rn=20&amp;ct=1&amp;fr=bks0000&amp;ie=utf-8&amp;word=" target="_blank">新闻</a><a href="http://www.baidu.com/s?ie=utf-8&amp;fr=bks0000&amp;wd=" target="_blank">网页</a><a href="http://tieba.baidu.com/f?ie=utf-8&amp;fr=bks0000&amp;kw=" target="_blank">贴吧</a><a href="http://zhidao.baidu.com/search?pn=0&amp;&amp;rn=10&amp;lm=0&amp;fr=bks0000&amp;word=" target="_blank">知道</a><a href="http://music.baidu.com/search?f=ms&amp;ct=134217728&amp;ie=utf-8&amp;rn=&amp;lm=-1&amp;pn=30fr=bks0000&amp;key=" target="_blank">音乐</a><a href="http://image.baidu.com/i?tn=baiduimage&amp;ct=201326592&amp;lm=-1&amp;cl=2&amp;nc=1&amp;ie=utf-8&amp;word=" target="_blank">图片</a><a href="http://video.baidu.com/v?ct=301989888&amp;rn=20&amp;pn=0&amp;db=0&amp;s=22&amp;ie=utf-8&amp;fr=bks0000&amp;word=" target="_blank">视频</a><a href="http://map.baidu.com/m?ie=utf-8&amp;fr=bks0000&amp;word=" target="_blank">地图</a><strong>百科</strong><a href="http://wenku.baidu.com/search?lm=0&amp;od=0&amp;ie=utf-8&amp;fr=bks0000&amp;word=" target="_blank">文库</a></p>
<hr>
<p><a href="http://www.baidu.com/search/baike_help.html" target="_blank">帮助</a></p>
<ul>
<li><a href="http://baike.baidu.com/" target="_blank">首页</a></li>
<li><a href="http://baike.baidu.com/ziran/" target="_blank">自然</a></li>
<li><a href="http://baike.baidu.com/wenhua/" target="_blank">文化</a></li>
<li><a href="http://baike.baidu.com/dili/" target="_blank">地理</a></li>
<li><a href="http://baike.baidu.com/lishi/" target="_blank">历史</a></li>
<li><a href="http://baike.baidu.com/shenghuo/" target="_blank">生活</a></li>
<li><a href="http://baike.baidu.com/shehui/" target="_blank">社会</a></li>
<li><a href="http://baike.baidu.com/yishu/" target="_blank">艺术</a></li>
<li><a href="http://baike.baidu.com/renwu/" target="_blank">人物</a></li>
<li><a href="http://baike.baidu.com/jingji/" target="_blank">经济</a></li>
<li><a href="http://baike.baidu.com/keji/" target="_blank">科技</a></li>
<li><a href="http://baike.baidu.com/tiyu/" target="_blank">体育</a></li>
<li><a href="http://baike.baidu.com/museum/" target="_blank">数字博物馆</a></li>
<li><a href="http://baike.baidu.com/cms/s/core/index.html" target="_blank">核心用户</a></li>
<li><a href="http://baike.baidu.com/mall/" target="_blank">百科商城</a> <a href="http://baike.baidu.com/culture/wuxi" title="来城市百科读懂魅力无锡" target="_blank">来城市百科读懂魅力无锡</a></li>
</ul>
<p><a href="http://baike.baidu.com/tpldivideload?lemmaId=209681" target="_blank"></a> <a href="http://baike.baidu.com/divideload?lemmaid=209681"></a></p>
<h1 id="awk">Awk</h1>
<p>目录
<a href="">awk释义</a><a href="">awk简介</a><a href="">调用方式</a><a href="">语法</a><a href="">内置变量</a><a href="">内置函数</a><a href="">命令行使用</a><a href="">详细介绍</a><a href="">变量</a><a href="">运算与判断</a><a href="">流程控制</a></p>
<ol>
<li><a href="">1</a></li>
<li><p><a href="">2</a>
<a href="">函数</a><a href="">输入输出</a>展开<a href="">awk释义</a><a href="">awk简介</a><a href="">调用方式</a><a href="">语法</a><a href="">内置变量</a><a href="">内置函数</a><a href="">命令行使用</a><a href="">详细介绍</a><a href="">变量</a><a href="">运算与判断</a><a href="">流程控制</a></p>
</li>
<li><p><a href="">1</a></p>
</li>
<li><a href="">2</a>
<a href="">函数</a><a href="">输入输出</a>展开</li>
</ol>
<h2 id="-awk-"><a href="">编辑本段</a><a href=""></a><a href=""></a>awk释义</h2>
<p>英文原义：Aho、Weinberger、Kernighan</p>
<p>中文释义：三位创造者Aho、Weinberger和Kernighan统称</p>
<h2 id="-awk-"><a href="">编辑本段</a><a href=""></a><a href=""></a>awk简介</h2>
<p>AWK是一种优良的文本处理工具。它不仅是 <a href="http://baike.baidu.com/view/1634.htm" target="_blank">Linux</a> 中也是任何环境中现有的功能最强大的数据处理引擎之一。这种编程及<a href="http://baike.baidu.com/view/3426309.htm" target="_blank">数据操作语言</a>（其名称得自于它的创始人 Alfred Aho 、Peter Weinberger 和 Brian Kernighan 姓氏的首个字母）的最大功能取决于一个人所拥有的知识。AWK 提供了极其强大的功能：可以进行样式装入、<a href="http://baike.baidu.com/view/1292763.htm" target="_blank">流控制</a>、数学<a href="http://baike.baidu.com/view/425996.htm" target="_blank">运算符</a>、进程<a href="http://baike.baidu.com/view/1359886.htm" target="_blank">控制语句</a>甚至于内置的<a href="http://baike.baidu.com/view/296689.htm" target="_blank">变量</a>和函数。它具备了一个完整的语言所应具有的几乎所有精美特性。实际上 AWK 的确拥有自己的语言：AWK <a href="http://baike.baidu.com/view/128511.htm" target="_blank">程序设计语言</a>， 三位创建者已将它正式定义为“样式扫描和处理语言”。它允许您创建简短的程序，这些程序读取输入文件、为<a href="http://baike.baidu.com/view/2586460.htm" target="_blank">数据排序</a>、处理数据、对输入执行计算以及生成报表，还有无数其他的功能。</p>
<p>最简单地说， AWK 是一种用于处理文本的编程语言工具。AWK 在很多方面类似于 shell 编程语言，尽管 AWK 具有完全属于其本身的语法。它的设计思想来源于 SNOBOL4 、sed 、Marc Rochkind设计的有效性语言、语言工具 yacc 和 lex ，当然还从 C 语言中获取了一些优秀的思想。在最初创造 AWK 时，其目的是用于文本处理，并且这种语言的基础是，只要在输入数据中有模式匹配，就执行一系列指令。该实用工具扫描文件中的每一行，查找与命令行中所给定内容相匹配的模式。如果发现匹配内容，则进行下一个编程步骤。如果找不到匹配内容，则继续处理下一行。
尽管操作可能会很复杂，但命令的语法始终是：</p>
<p>awk &#39;{pattern + action}&#39; 或者 awk &#39;pattern {action}&#39;
其中 pattern 表示 AWK 在数据中查找的内容，而 action 是在找到匹配内容时所执行的一系列命令。花括号 ({}) 不需要在程序中始终出现，但它们用于根据特定的模式对一系列指令进行分组。</p>
<p>gawk 是 AWK 的 GNU 版本。
一般的UNIX作业系统，本身即附有AWK，不同的UNIX作业系统所附的AWK其版本亦不尽相同，若读者所使用的系统上未附有AWK，可通过 anonymous ftp 到下列地方取得：</p>
<p>phi.sinica.edu.tw:/pub/gnu
ftp.edu.tw:/UNIX/gnu</p>
<p>prep.ai.mit.edu:/pub/gnu
注 解：一种编程语言，因其模式匹配语法而特别有用，通常用于数据检索和数据转换。一个GNU版本称为Gawk。</p>
<h2 id="-"><a href="">编辑本段</a><a href=""></a><a href=""></a>调用方式</h2>
<p>awk提供了适应多种需要的不同解决方案，它们是：</p>
<p>一、 awk命令行，你可以象使用普通UNIX命令一样使用awk，在命令行中你也可以使用awk<a href="http://baike.baidu.com/view/128511.htm" target="_blank">程序设计语言</a>，虽然awk支持多行的录入，但是录入长长的命令行并保证其正确无误却是一件令人头疼的事，因此，这种方法一般只用于解决简单的问题。当然，你也可以在shell script程序中引用awk命令行甚至awk程序<a href="http://baike.baidu.com/view/54.htm" target="_blank">脚本</a>。
二、使用-f选项调用awk程序。awk允许将一段awk程序写入一个文本文件，然后在awk命令行中用-f选项调用并执行这段程序。具体的方法我们将在后面的awk语法中讲到。</p>
<p>三、利用命令<a href="http://baike.baidu.com/view/592974.htm" target="_blank">解释器</a>调用awk程序：利用UNIX支持的命令解释器功能，我们可以将一段awk程序写入文本文件，然后在它的第一行加上：
/#!/bin/awk -f</p>
<p>并赋予这个文本文件以执行的权限。这样做之后，你就可以在命令行中用类似于下面这样的方式调用并执行这段awk程序了。
awk<a href="http://baike.baidu.com/view/54.htm" target="_blank">脚本</a>文本名 待处理文件</p>
<h2 id="-"><a href="">编辑本段</a><a href=""></a><a href=""></a>语法</h2>
<p>与其它UNIX命令一样，awk拥有自己的语法：</p>
<p>awk [ -F re] [parameter...] [&#39;prog&#39;] [-f progfile]
参数说明：</p>
<p>-F re：允许awk更改其字段<a href="http://baike.baidu.com/view/1268377.htm" target="_blank">分隔符</a>。
parameter: 该参数帮助为不同的<a href="http://baike.baidu.com/view/296689.htm" target="_blank">变量</a>赋值。</p>
<p>&#39;prog&#39;: awk的程序语句段。这个语句段必须用单拓号：&#39;和&#39;括起，以防被shell解释。这个程序语句段的标准形式为：
&#39;pattern {action}&#39;</p>
<p>其中pattern参数可以是egrep<a href="http://baike.baidu.com/view/94238.htm" target="_blank">正则表达式</a>中的任何一个，它可以使用语法/re/再加上一些样式匹配技巧构成。与sed类似，你也可以使用&quot;,&quot; 分开两样式以选择某个范围。关于匹配的细节，你可以参考附录，如果仍不懂的话，找本UNIX书学学grep和sed（本人是在学习ed时掌握匹配技术的）。action参数总是被大括号包围，它由一系列awk语句组成，各语句之间用&quot;;&quot;分隔。awk解释它们，并在pattern给定的样式匹配的记录上执行其操作。与shell类似，你也可以使用“/#”作为<a href="http://baike.baidu.com/view/3389132.htm" target="_blank">注释符</a>，它使“/#”到行尾的内容成为注释，在<a href="http://baike.baidu.com/view/1182922.htm" target="_blank">解释执行</a>时，它们将被忽略。你可以省略pattern和 action之一，但不能两者同时省略，当省略pattern时没有样式匹配，表示对所有行（记录）均执行操作，省略action时执行缺省的操作——在标准输出上显示。
-f progfile：允许awk调用并执行progfile指定有<a href="http://baike.baidu.com/view/600314.htm" target="_blank">程序文件</a>。progfile是一个文本文件，他必须符合awk的语法。</p>
<p>in_file:awk的输入文件，awk允许对多个输入文件进行处理。值得注意的是awk不修改输入文件。如果未指定输入文件，awk将接受标准输入，并将结果显示在标准输出上。awk支持输入输出重定向。</p>
<h2 id="-"><a href="">编辑本段</a><a href=""></a><a href=""></a>内置变量</h2>
<p>前面说过，awk处理的工作与数据库的处理方式有相同之处，其相同处之一就是awk支持对记录和字段的处理，其中对字段的处理是grep和sed不能实现的，这也是awk优于二者的原因之一。在awk中，缺省的情况下总是将文本文件中的一行视为一个记录，而将一行中的某一部分作为记录中的一个字段。为了操作这些不同的字段，awk借用shell的方法，用1,2,3...这样的方式来顺序地表示行（记录）中的不同字段。特殊地，awk用0表示整个行（记录）。不同的字段之间是用称作<a href="http://baike.baidu.com/view/1268377.htm" target="_blank">分隔符</a>的<a href="http://baike.baidu.com/view/263416.htm" target="_blank">字符</a>分隔开的。系统默认的<a href="http://baike.baidu.com/view/1268377.htm" target="_blank">分隔符</a>是空格。awk允许在命令行中用-F re的形式来改变这个<a href="http://baike.baidu.com/view/1268377.htm" target="_blank">分隔符</a>。事实上，awk用一个内置的变量FS来记忆这个<a href="http://baike.baidu.com/view/1268377.htm" target="_blank">分隔符</a>。awk中有好几个这样的内置变量，例如，记录<a href="http://baike.baidu.com/view/1268377.htm" target="_blank">分隔符</a>变量RS、当前工作的记录数NR等等，本文后面的附表列出了全部的内置变量。这些内置的变量可以在awk程序中引用或修改，例如，你可以利用NR变量在模式匹配中指定工作范围，也可以通过修改记录<a href="http://baike.baidu.com/view/1268377.htm" target="_blank">分隔符</a>RS让一个特殊字符而不是换行符作为记录的分隔符。</p>
<p>例：显示文本文件myfile中第七行到第十五行中以<a href="http://baike.baidu.com/view/263416.htm" target="_blank">字符</a>%分隔的第一字段，第三字段和第七字段：
awk -F % &#39;NR==7,NR==15 {print $1 $3 $7}&#39; myfile</p>
<h2 id="-"><a href="">编辑本段</a><a href=""></a><a href=""></a>内置函数</h2>
<p>awk 之所以成为一种优秀的<a href="http://baike.baidu.com/view/128511.htm" target="_blank">程序设计语言</a>的原因之一是它吸收了某些优秀的程序设计语言（例如C）语言的许多优点。这些优点之一就是内置函数的使用，awk定义并支持了一系列的内置函数，由于这些函数的使用，使得awk提供的功能更为完善和强大，例如，awk使用了一系列的字符串处理内置函数(这些函数看起来与C 语言的字符串处理函数相似，其使用方式与C语言中的函数也相差无几)，正是由于这些内置函数的使用，使awk处理字符串的功能更加强大。本文后面的附录中列有一般的awk所提供的内置函数，这些内置函数也许与你的awk版本有些出入，因此，在使用之前，最好参考一下你的系统中的<a href="http://baike.baidu.com/view/732145.htm" target="_blank">联机帮助</a>。</p>
<p>内置的字符串函数
gsub(r,s)在整个$0中用s代替rgsub(r,s,t)在整个t中用s替代rindex(s,t)返回s中字符串t的第一位置length(s)返回s长度match(s,r)测试s是否包含匹配r的字符串split(s,a,fs)在fs上将s分成序列asprint(fmt,exp)返回经fmt格式化后的expsub(r,s)用$0中最左边最长的子串代替ssubstr(s,p)返回字符串s中从p开始的后缀部分substr(s,p,n)返回字符串s中从p开始长度为n的后缀部分</p>
<p>gsub函数有点类似于sed查找和替换。它允许替换一个字符串或字符为另一个字符串或字符，并以<a href="http://baike.baidu.com/view/94238.htm" target="_blank">正则表达式</a>的形式执行。第一个函数作用于记录$0，第二个gsub函数允许指定目标，然而，如果未指定目标，缺省为$0。
index(s，t）函数返回目标字符串s中查询字符串t的首位置。length函数返回<a href="http://baike.baidu.com/view/263416.htm" target="_blank">字符</a>串s字符长度。</p>
<p>match函数测试字符串s是否包含一个<a href="http://baike.baidu.com/view/94238.htm" target="_blank">正则表达式</a>r定义的匹配。
split使用域<a href="http://baike.baidu.com/view/1268377.htm" target="_blank">分隔符</a>fs将字符串s划分为指定序列a。</p>
<p>sprint函数类似于printf函数，返回基本输出格式fmt的结果字符串exp。
sub(r，s）函数将用s替代$0中最左边最长的子串，该子串被r匹配。</p>
<p>substr(s，p）返回字符串s在位置p后的后缀。
substr(s，p，n）同上，并指定子串长度为n。</p>
<h2 id="-"><a href="">编辑本段</a><a href=""></a><a href=""></a>命令行使用</h2>
<p>按照顺序，我们应当讲解awk程序设计的内容了，但在讲解之前，我们将用一些例子来对前面的知识进行回顾，这些例子都是在命令行中使用的，由此我们可以知道在命令行中使用awk是多么的方便。这样做的原因一方面是为下面的内容作铺垫，另一方面是介绍一些解决简单问题的方法，我们完全没有必要用复杂的方法来解决简单的问题----既然awk提供了较为简单的方法的话。</p>
<p>例：显示文本文件mydoc匹配（含有）字符串&quot;sun&quot;的所有行。
awk &#39;/sun/&#39; mydoc</p>
<p>由于显示整个记录（全行）是awk的缺省动作，因此可以省略action项。
awk &#39;/sun/&#39; mydoc</p>
<p>例：下面是一个较为复杂的匹配的示例：
awk &#39;/[Ss]un/,/[Mm]oon/ &#39; myfile</p>
<p>它将显示第一个匹配Sun或sun的行与第一个匹配Moon或moon的行之间的行，并显示到标准输出上。
例：下面的示例显示了内置<a href="http://baike.baidu.com/view/296689.htm" target="_blank">变量</a>和<a href="http://baike.baidu.com/view/700770.htm" target="_blank">内置函数</a>length（）的使用：</p>
<p>awk &#39;length($0)&gt;80 {print NR}&#39; myfile
该命令行将显示文本myfile中所有超过80个字符的<a href="http://baike.baidu.com/view/239028.htm" target="_blank">行号</a>，在这里，用0表示整个记录（行），同时，内置<a href="http://baike.baidu.com/view/296689.htm" target="_blank">变量</a>NR不使用标志符&#39;&#39;。</p>
<p>例：作为一个较为实际的例子，我们假设要对UNIX中的用户进行安全性检查，方法是考察/etc下的passwd文件，检查其中的passwd字段（第二字段）是否为&quot;/<em>&quot;，如不为&quot;/</em>&quot;，则表示该用户没有设置密码，显示出这些用户名（第一字段）。我们可以用如下语句实现：
/#awk -F: &#39;$2!=&quot;/*&quot; {printf(&quot;%s no password!\n&quot;,$1）&#39;} /etc/passwd</p>
<p>在这个示例中，passwd文件的字段<a href="http://baike.baidu.com/view/1268377.htm" target="_blank">分隔符</a>是“：”，因此，必须用-F：来更改默认的字段分隔符，这个示例中也涉及到了<a href="http://baike.baidu.com/view/700770.htm" target="_blank">内置函数</a>printf的使用。</p>
<h2 id="-"><a href="">编辑本段</a><a href=""></a><a href=""></a>详细介绍</h2>
<p>awk提供了有很多内置<a href="http://baike.baidu.com/view/296689.htm" target="_blank">变量</a>，如果你经常使用awk处理文本，了解这些这些内置变量的使用是很有必要的。下面看一下这些内置<a href="http://baike.baidu.com/view/296689.htm" target="_blank">变量</a>的详细介绍。</p>
<p>ARGC <a href="http://baike.baidu.com/view/1646320.htm" target="_blank">命令行参数</a>个数（不包括awk的选项和awk的程序内容）。
ARGIND 当前正在处理的ARGV中的文件的索引值（同时处理多个文件时会用到）。</p>
<p>ARGV 命令行参数序列<a href="http://baike.baidu.com/view/209670.htm" target="_blank">数组</a>，下标从0开始。
CONVFMT 数字转换格式，和C语言中的数字输出格式化类似，默认为&quot;%.6g&quot;。</p>
<p>ENVIRON 当前系统的环境变量。
ERRNO 出错时的错误信息。</p>
<p>FIELDWIDTHS 以空格分隔的字段宽度，如果指定此<a href="http://baike.baidu.com/view/296689.htm" target="_blank">变量</a>，awk将会用指定的宽度替换变量FS指定的<a href="http://baike.baidu.com/view/1268377.htm" target="_blank">分隔符</a>。看下面的例子：
[LinuxSong@test /tmp]$ cat t</p>
<p>abcdefasfa
abcdefasfa</p>
<p>abcdefasfa
[LinuxSong@test /tmp]$ awk &#39;BEGIN {FIELDWIDTHS=&quot;2 3 4&quot;}{print $1,$2,$3}&#39; t</p>
<p>ab cde fasf
ab cde fasf</p>
<p>ab cde fasf
FILENAME 当前正在处理的文件名，该<a href="http://baike.baidu.com/view/296689.htm" target="_blank">变量</a>不能在BEGIN块中使用。</p>
<p><a href="http://baike.baidu.com/view/7205646.htm" target="_blank">FNR</a> 当前处理的记录号。
FS 字段的<a href="http://baike.baidu.com/view/1268377.htm" target="_blank">分隔符</a>，默认为空格。</p>
<p>IGNORECASE 如果该变量设置为非0值，在进行<a href="http://baike.baidu.com/view/1436430.htm" target="_blank">字符串匹配</a>时忽略大小写。
NF 当前记录中的字段个数。</p>
<p>NR 已经读出的记录数。
OFMT 数字的输出格式。</p>
<p>OFS 输出的字段<a href="http://baike.baidu.com/view/1268377.htm" target="_blank">分隔符</a>，默认为空格。
ORS 输出的记录<a href="http://baike.baidu.com/view/1268377.htm" target="_blank">分隔符</a>，默认为新行。</p>
<p>RS 输入记录的<a href="http://baike.baidu.com/view/1268377.htm" target="_blank">分隔符</a>，默认为新行。
RSTART 被match（）函数匹配的字符串的起始位置，如果没有匹配则为0（从1开始）。</p>
<p>RLENGTH 被match（）函数匹配的字符串的长度。
SUBSEP <a href="http://baike.baidu.com/view/209670.htm" target="_blank">数组</a>中多个下标的分隔符，默认为&quot;\034&quot;。</p>
<h2 id="-"><a href="">编辑本段</a><a href=""></a><a href=""></a>变量</h2>
<p>如同其它<a href="http://baike.baidu.com/view/128511.htm" target="_blank">程序设计语言</a>一样，awk允许在程序语言中设置变量，事实上，提供变量的功能是程序设计语言的基本要求。</p>
<p>awk 提供两种<a href="http://baike.baidu.com/view/296689.htm" target="_blank">变量</a>，一种是awk内置的变量，这前面我们已经讲过，需要着重指出的是，与后面提到的其它变量不同的是，在awk程序中引用内置变量不需要使用标志符&quot;&quot;（回忆一下前面讲过的NR的使用）。awk提供的另一种<a href="http://baike.baidu.com/view/296689.htm" target="_blank">变量</a>是自定义变量。awk允许用户在awk程序语句中定义并调用自已的<a href="http://baike.baidu.com/view/296689.htm" target="_blank">变量</a>。当然这种<a href="http://baike.baidu.com/view/296689.htm" target="_blank">变量</a>不能与内置变量及其它awk保留字相同，在awk中引用自定义变量必须在它前面加上标志符&quot;&quot;。与C语言不同的是，awk中不需要对<a href="http://baike.baidu.com/view/296689.htm" target="_blank">变量</a>进行初始化， awk根据其在awk中第一次出现的形式和上下文确定其具体的<a href="http://baike.baidu.com/view/675645.htm" target="_blank">数据类型</a>。当<a href="http://baike.baidu.com/view/296689.htm" target="_blank">变量</a>类型不确定时，awk默认其为字符串类型。这里有一个技巧：如果你要让你的 awk程序知道你所使用的<a href="http://baike.baidu.com/view/296689.htm" target="_blank">变量</a>的明确类型，你应当在在程序中给它赋初值。在后面的实例中，我们将用到这一技巧。</p>
<h2 id="-"><a href="">编辑本段</a><a href=""></a><a href=""></a>运算与判断</h2>
<p>作为一种<a href="http://baike.baidu.com/view/128511.htm" target="_blank">程序设计语言</a>所应具有的特点之一，awk支持多种运算，这些运算与C语言提供的基本相同：如+、-、/*、/、%等等，同时，awk也支持C语言中类似++、--、+=、-=、=+、=-之类的功能，这给熟悉C语言的使用者编写awk程序带来了极大的方便。作为对运算功能的一种扩展，awk还提供了一系列内置的运算函数（如log、sqr、cos、sin等等）和一些用于对字符串进行操作（运算）的函数（如length、substr等等）。这些函数的引用大大的提高了awk的运算功能。</p>
<p>作为对条件转移指令的一部分，关系判断是每种<a href="http://baike.baidu.com/view/128511.htm" target="_blank">程序设计语言</a>都具备的功能，awk也不例外。awk 中允许进行多种测试，如常用的==（等于）、！=（不等于）、&gt;（大于）、&gt;=（大于等于）、&lt;=（小于等于）等等，同时，作为样式匹配，还提供了~（匹配于）和！~（不匹配于）判断。
作为对测试的一种扩充，awk也支持用<a href="http://baike.baidu.com/view/1717998.htm" target="_blank">逻辑运算符</a>：！（非）、&amp;&amp;；（与）、||（或）和括号（）进行多重判断，这大大增强了awk的功能。本文的附录中列出了awk所允许的运算、判断以及操作符的优先级。</p>
<h2 id="-"><a href="">编辑本段</a><a href=""></a><a href=""></a>流程控制</h2>
<p><a href="http://baike.baidu.com/view/2846066.htm" target="_blank">流程控制</a>语句是任何<a href="http://baike.baidu.com/view/128511.htm" target="_blank">程序设计语言</a>都不能缺少的部分。任何好的语言都有一些执行<a href="http://baike.baidu.com/view/2846066.htm" target="_blank">流程控制</a>的语句。awk提供的完备的流程<a href="http://baike.baidu.com/view/1359886.htm" target="_blank">控制语句</a>类似于C语言，这给我们编程带来了极大的方便。</p>
<h3 id="-1"><a href=""></a><a href=""></a>1</h3>
<p>在awk 中两个特别的表达式，BEGIN和END，这两者都可用于pattern中（参考前面的awk语法），提供BEGIN和END的作用是给程序赋予初始状态和在程序结束之后执行一些扫尾的工作。任何在BEGIN之后列出的操作（在{}内）将在awk开始扫描输入之前执行，而END之后列出的操作将在扫描完全部的输入之后执行。因此，通常使用BEGIN来显示<a href="http://baike.baidu.com/view/296689.htm" target="_blank">变量</a>和预置（初始化）变量，使用END来输出最终结果。</p>
<p>例：累计销售文件xs中的销售金额（假设销售金额在记录的第三字段）：
awk</p>
<blockquote>
<p>&#39;BEGIN { FS=&quot;:&quot;;print &quot;统计销售金额&quot;;total=0}
{print $3;total=total+$3;}</p>
<p>END {printf &quot;销售金额总计：%.2f&quot;,total}&#39; sx
（注：&gt;；是shell提供的第二提示符，如要在shell程序awk语句和awk语言中换行，则需在行尾加反斜杠\）</p>
</blockquote>
<p>在这里，BEGIN预置了内部<a href="http://baike.baidu.com/view/296689.htm" target="_blank">变量</a>FS（字段<a href="http://baike.baidu.com/view/1268377.htm" target="_blank">分隔符</a>）和自定义变量total，同时在扫描之前显示出输出行头。而END则在扫描完成后打印出总合计。</p>
<h3 id="-2"><a href=""></a><a href=""></a>2</h3>
<p>awk提供了完备的流程控制语句，其用法与C语言类似。下面我们一一加以说明：</p>
<p>2.1、if...else语句：
格式：</p>
<p>if（<a href="http://baike.baidu.com/view/420676.htm" target="_blank">表达式</a>）
语句1</p>
<p>else
语句2</p>
<p>格式中&quot;语句1&quot;可以是多个语句，如果你为了方便awk判断也方便你自已阅读，你最好将多个语句用{}括起来。awk分枝结构允许嵌套，其格式为：
if（<a href="http://baike.baidu.com/view/420676.htm" target="_blank">表达式</a>1）</p>
<p>{if（<a href="http://baike.baidu.com/view/420676.htm" target="_blank">表达式</a>2）
语句1</p>
<p>else
语句2</p>
<p>}
语句3</p>
<p>else {if（<a href="http://baike.baidu.com/view/420676.htm" target="_blank">表达式</a>3）
语句4</p>
<p>else
语句5</p>
<p>}
语句6</p>
<p>当然实际操作过程中你可能不会用到如此复杂的分枝结构，这里只是为了给出其样式罢了。
2.2、while语句</p>
<p>格式为：
while（<a href="http://baike.baidu.com/view/420676.htm" target="_blank">表达式</a>）</p>
<p>语句
2.3、do-while语句</p>
<p>格式为：
do</p>
<p>{
语句</p>
<p>}while（条件判断语句）
2.4、for语句</p>
<p>格式为：
for（初始表达式；终止条件；步长表达式）</p>
<p>{语句}
在awk 的 while、do-while和for语句中允许使用break,continue语句来控制流程走向，也允许使用exit这样的语句来退出。break 中断当前正在执行的循环并跳到循环外执行下一条语句。continue从当前位置跳到循环开始处执行。对于exit的执行有两种情况：当exit语句不在 END中时，任何操作中的exit命令表现得如同到了文件尾，所有模式或操作执行将停止，END模式中的操作被执行。而出现在END中的exit将导致程序终止。</p>
<h2 id="-"><a href="">编辑本段</a><a href=""></a><a href=""></a>函数</h2>
<p>定义和调用用户自己的函数是几乎每个高级语言都具有的功能，awk也不例外，但原始的awk并不提供函数功能，只有在nawk或较新的awk版本中才可以增加函数。</p>
<p>函数的使用包含两部分：函数的定义与<a href="http://baike.baidu.com/view/2369016.htm" target="_blank">函数调用</a>。其中函数定义又包括要执行的代码（函数本身）和从主程序代码传递到该函数的临时调用。
awk函数的定义方法如下：</p>
<p>function 函数名（参数表）{
<a href="http://baike.baidu.com/view/1377635.htm" target="_blank">函数体</a></p>
<p>}
在gawk中允许将function省略为func，但其它版本的awk不允许。函数名必须是一个合法的标志符，参数表中可以不提供参数（但在调用函数时函数名后的一对括号仍然是不可缺少的），也可以提供一个或多个参数。与C语言相似，awk的参数也是通过值来传递的。</p>
<p>在awk 中调用函数比较简单，其方法与C语言相似，但awk比C语言更为灵活，它不执行参数有效性检查。换句话说，在你调用函数时，可以列出比函数预计（函数定义中规定）的多或少的参数，多余的参数会被awk所忽略，而不足的参数，awk将它们置为缺省值0或空字符串，具体置为何值，将取决于参数的使用方式。
awk函数有两种返回方式：隐式返回和显式返回。当awk执行到函数的结尾时，它自动地返回到调用程序，这是函数是隐式返回的。如果需要在结束之前退出函数，可以明确地使用返回语句提前退出。方法是在函数中使用形如：return 返回值 格式的语句。</p>
<p>例：下面的例子演示了函数的使用。在这个示例中，定义了一个名为print_header的函数，该<a href="http://baike.baidu.com/view/2369016.htm" target="_blank">函数调用</a>了两个参数FileName和 PageNum， FileName参数传给函数当前使用的文件名，PageNum参数是当前页的页号。这个函数的功能是打印（显示）出当前文件的文件名，和当前页的页号。完成这个功能后，这个函数将返回下一页的页号。
nawk</p>
<blockquote>
<p>&#39;BEGIN{pageno=1;file=FILENAME
pageno=print_header(file，pageno）；/#调用函数print_header</p>
<p>printf(&quot;当前页页号是：%d\n&quot;,pageno);
}</p>
<p>/#定义函数print_header
function print_header(FileName,PageNum){</p>
<p>printf(&quot;%s %d\n&quot;,FileName,PageNum); &gt;PageNum++;return PageNUm;
}</p>
<p>}&#39; myfile
执行这个程序将显示如下内容：</p>
</blockquote>
<p>myfile 1
当前页页号是：2</p>
<h2 id="-"><a href="">编辑本段</a><a href=""></a><a href=""></a>输入输出</h2>
<p>1.读取下一条记录：</p>
<p>awk的next语句导致awk读取下一个记录并完成模式匹配，然后立即执行相应的操作。通常它用匹配的模式执行操作中的代码。next导致这个记录的任何额外匹配模式被忽略。
2.简单地读取一条记录</p>
<p>awk 的 getline语句用于简单地读取一条记录。如果用户有一个数据记录类似两个物理记录，那么getline将尤其有用。它完成一般字段的分离（设置字段变量0<a href="http://baike.baidu.com/view/7205646.htm" target="_blank">FNR</a>NF NR）。如果成功则返回1，失败则返回0（到达文件尾）。如果需简单地读取一个文件，则可以编写以下代码：
例：示例getline的使用</p>
<p>{while(getline==1）
{</p>
<p>/#process the inputted fields
}</p>
<p>}
也可以使getline保存输入数据在一个字段中，而不是通过使用getline variable的形式处理一般字段。当使用这种方式时，NF被置成0，<a href="http://baike.baidu.com/view/7205646.htm" target="_blank">FNR</a>和NR被增值。</p>
<p>用户也可以使用getline&quot;datafile&quot;
或</p>
<p>printf(&quot;hello word!\n&quot;</p>
<blockquote>
<blockquote>
<p>&quot;datafile&quot;</p>
</blockquote>
</blockquote>
<ol>
<li>输出记录
可以通过print 和 printf 将结果输出：</li>
</ol>
<p>awk &#39;{ print $1,$2 }&#39; file
4.输出到一个命令</p>
<p>awk中允许用如下方式将结果输出到一个命令：
printf(&quot;hello word!\n&quot;</p>
<p>|&quot;sort-t&#39;,&#39;&quot;
awk与shell script混合编程</p>
<p>因为awk可以作为一个shell命令使用，因此awk能与shell<a href="http://baike.baidu.com/view/121494.htm" target="_blank">批处理程序</a>很好的融合在一起，这给实现awk与shell程序的<a href="http://baike.baidu.com/view/1157548.htm" target="_blank">混合编程</a>提供了可能。实现<a href="http://baike.baidu.com/view/1157548.htm" target="_blank">混合编程</a>的关键是awk与shell script之间的对话，换言之，就是awk与shell script之间的信息交流：awk从shell script中获取所需的信息（通常是<a href="http://baike.baidu.com/view/296689.htm" target="_blank">变量</a>的值）、在awk中执行shell命令行、shell script将命令执行的结果送给awk处理以及shell scrit读取awk的执行结果等等。
<strong>1.awk**</strong>读取Shell script<strong>**程序变量</strong></p>
<p>在awk中我们可以通过“<strong>&#39;$**</strong>变量名&#39;**”的方式读取sell scrpit程序中的变量。
例：在下面的示例中，我们将读取sell scrpit程序中的变量Name，该变量存放的是文本myfile的撰写者，awk将打印出这个人名。</p>
<p>$cat writename
:</p>
<p>/# @(/#)
/#</p>
<p>Name=&quot;张三&quot; nawk &#39;BEGIN {name=&quot;&#39;Name&#39;&quot;;\ printf(&quot;\t%s\t撰写者%s\n&quot;,FILENAME,name&quot;);}\
{...}END{...}&#39; myfile</p>
<p><strong>2.**</strong>将shell<strong><strong>命令的执行结果送给awk</strong></strong>处理**
作为信息传送的一种方法，我们可以将一条shell命令的结果通过管道线（|）传递给awk处理：</p>
<p>例：示例awk处理shell命令的执行结果
$who -u | awk &#39;{printf(&quot;%s正在执行%s\n&quot;,$2,$1)}&#39;</p>
<p>该命令将打印出注册终端正在执行的程序名。
<strong>3.shell script**</strong>程序读awk<strong>**的执行结果</strong></p>
<p>为了实现shell script程序读取awk执行的结果，我们可以采取一些特殊的方法，例如我们可以用变量名=<code>awk语句</code>的形式将awk执行的结果存放入一个shell script变量。当然也可以用管道线的方法将awk执行结果传递给shell script程序处理。
例：作为传送消息的机制之一，UNIX提供了一个向其所有用户传送消息的命令wall（意思是write to all写给所有用户），该命令允许向所有工作中的用户（终端）发送消息。为此，我们可以通过一段shell批处理程序wall.shell来模拟这一程序（事实上比较老的版本中wall就是一段shell批处理程序：</p>
<p>$cat wall.shell
:</p>
<p>/# @(/#) wall.shell:发送消息给每个已注册终端
/#</p>
<p>cat &gt;/tmp/$$
/#用户录入消息文本who -u | awk &#39;{print $2}&#39; | while read tty</p>
<p>do
cat /tmp/$$&gt;$tty</p>
<p>done
在这个程序里，awk接受who -u命令的执行结果，该命令打印出所有已注册终端的信息，其中第二个字段是已注册终端的设备名，因此用awk命令析出该设备名，然后用while read tty语句循环读出这些文件名到变量（shell script变量）tty中，作为信息传送的终结地址。</p>
<p><strong>4.**</strong>在awk<strong><strong>中执行shell</strong></strong>命令行----<strong>**嵌入函数system()</strong>
system()是一个不适合字符或数字类型的嵌入函数，该函数的功能是处理作为参数传递给它的字符串。system对这个参数的处理就是将其作为命令处理，也就是说将其当作命令行一样加以执行。这使得用户在自己的awk程序需要时可以灵活地执行命令或脚本。</p>
<p>例：下面的程序将使用system嵌入函数打印用户编制好的报表文件，这个文件存放在名为myreport.txt的文件中。为简约起见，我们只列出了其END部分：
END {close(&quot;myreport.txt&quot;);system(&quot;lp myreport.txt&quot;);}</p>
<p>在这个示例中，我们首先使用close语句关闭了文件myreport.txt文件，然后使用system嵌入函数将myreport.txt送入打印机打印。
<a href=""></a><a href=""></a></p>
<p><a href="&quot;收起&quot;"></a></p>
<h3 id="unix-">Unix命令行程序和内建指令(更多)</h3>
<p>文件系统 ▪ <a href="http://baike.baidu.com/view/250626.htm" title="cat" target="_blank">cat</a> ▪ <a href="http://baike.baidu.com/view/22623.htm" title="cd" target="_blank">cd</a> ▪ <a href="http://baike.baidu.com/view/1229012.htm" title="chmod" target="_blank">chmod</a> ▪ <a href="http://baike.baidu.com/view/1229019.htm" title="chown" target="_blank">chown</a>▪ <a href="http://baike.baidu.com/view/1188586.htm" title="chgrp" target="_blank">chgrp</a> ▪ <a href="http://baike.baidu.com/view/2761036.htm" title="cksum" target="_blank">cksum</a> ▪ <a href="http://baike.baidu.com/view/631858.htm" title="cmp" target="_blank">cmp</a> ▪ <a href="http://baike.baidu.com/view/25561.htm" title="cp" target="_blank">cp</a>▪ <a href="http://baike.baidu.com/view/43913.htm" title="du" target="_blank">du</a> ▪ <a href="http://baike.baidu.com/view/111942.htm" title="df" target="_blank">df</a> ▪ <a href="http://baike.baidu.com/view/1757895.htm" title="fsck" target="_blank">fsck</a> ▪ <a href="http://baike.baidu.com/view/3123051.htm" title="fuser" target="_blank">fuser</a>▪ <a href="http://baike.baidu.com/view/1156839.htm" title="ln" target="_blank">ln</a> ▪ <a href="http://baike.baidu.com/view/370184.htm" title="ls" target="_blank">ls</a> ▪ <a href="http://baike.baidu.com/view/4811972.htm" title="lsattr" target="_blank">lsattr</a> ▪ <a href="http://baike.baidu.com/searchword/?word=lsof&amp;pic=1&amp;sug=1&amp;enc=utf8" title="待创建" target="_blank">lsof</a>▪ <a href="http://baike.baidu.com/view/1279338.htm" title="mkdir" target="_blank">mkdir</a> ▪ <a href="http://baike.baidu.com/view/1374830.htm" title="mount" target="_blank">mount</a> ▪ <a href="http://baike.baidu.com/view/17861.htm" title="mv" target="_blank">mv</a> ▪ <a href="http://baike.baidu.com/view/920712.htm" title="pwd" target="_blank">pwd</a>▪ <a href="http://baike.baidu.com/view/6779.htm" title="rm" target="_blank">rm</a> ▪ <a href="http://baike.baidu.com/view/1081230.htm" title="rmdir" target="_blank">rmdir</a> ▪ <a href="http://baike.baidu.com/view/356808.htm" title="split" target="_blank">split</a> ▪ <a href="http://baike.baidu.com/view/345328.htm" title="touch" target="_blank">touch</a>▪ <a href="http://baike.baidu.com/view/1867757.htm" title="umask" target="_blank">umask</a> 程序 ▪ <a href="http://baike.baidu.com/view/27835.htm" title="at" target="_blank">at</a> ▪ <a href="http://baike.baidu.com/view/194376.htm" title="bg" target="_blank">bg</a> ▪ <a href="http://baike.baidu.com/view/2977396.htm" title="chroot" target="_blank">chroot</a> ▪ <a href="http://baike.baidu.com/view/660015.htm" title="cron" target="_blank">cron</a>▪ <a href="http://baike.baidu.com/view/619980.htm" title="exit" target="_blank">exit</a> ▪ <a href="http://baike.baidu.com/view/228000.htm" title="fg" target="_blank">fg</a> ▪ <a href="http://baike.baidu.com/view/1374855.htm" title="jobs" target="_blank">jobs</a> ▪ <a href="http://baike.baidu.com/view/22085.htm" title="kill" target="_blank">kill</a>▪ <a href="http://baike.baidu.com/searchword/?word=killall&amp;pic=1&amp;sug=1&amp;enc=utf8" title="待创建" target="_blank">killall</a> ▪ <a href="http://baike.baidu.com/view/620110.htm" title="nice" target="_blank">nice</a> ▪ <a href="http://baike.baidu.com/searchword/?word=pgrep&amp;pic=1&amp;sug=1&amp;enc=utf8" title="待创建" target="_blank">pgrep</a> ▪ <a href="http://baike.baidu.com/searchword/?word=pidof&amp;pic=1&amp;sug=1&amp;enc=utf8" title="待创建" target="_blank">pidof</a>▪ <a href="http://baike.baidu.com/view/6624478.htm" title="pkill" target="_blank">pkill</a> ▪ <a href="http://baike.baidu.com/view/7556.htm" title="ps" target="_blank">ps</a> ▪ <a href="http://baike.baidu.com/view/1229127.htm" title="pstree" target="_blank">pstree</a> ▪ <a href="http://baike.baidu.com/view/66232.htm" title="sleep" target="_blank">sleep</a>▪ <a href="http://baike.baidu.com/view/10368.htm" title="time" target="_blank">time</a> ▪ <a href="http://baike.baidu.com/view/184937.htm" title="top" target="_blank">top</a> ▪ <a href="http://baike.baidu.com/view/11068.htm" title="wait" target="_blank">wait</a> 使用环境 ▪ <a href="http://baike.baidu.com/view/6397758.htm" title="env" target="_blank">env</a> ▪ <a href="http://baike.baidu.com/view/137128.htm" title="finger" target="_blank">finger</a> ▪ <a href="http://baike.baidu.com/view/371.htm" title="id" target="_blank">id</a> ▪ <a href="http://baike.baidu.com/searchword/?word=logname&amp;pic=1&amp;sug=1&amp;enc=utf8" title="待创建" target="_blank">logname</a>▪ <a href="http://baike.baidu.com/view/1229115.htm" title="mesg" target="_blank">mesg</a> ▪ <a href="http://baike.baidu.com/view/1116984.htm" title="passwd" target="_blank">passwd</a> ▪ <a href="http://baike.baidu.com/view/843034.htm" title="su" target="_blank">su</a> ▪ <a href="http://baike.baidu.com/view/1138183.htm" title="sudo" target="_blank">sudo</a>▪ <a href="http://baike.baidu.com/view/1228993.htm" title="uptime" target="_blank">uptime</a> ▪ <a href="http://baike.baidu.com/view/59877.htm" title="w" target="_blank">w</a> ▪ <a href="http://baike.baidu.com/view/126810.htm" title="wall" target="_blank">wall</a> ▪ <a href="http://baike.baidu.com/view/52104.htm" title="who" target="_blank">who</a>▪ <a href="http://baike.baidu.com/view/1116259.htm" title="whoami" target="_blank">whoami</a> ▪ <a href="http://baike.baidu.com/view/1081203.htm" title="write" target="_blank">write</a> 文字编辑 ▪ <strong>awk</strong> ▪ <a href="http://baike.baidu.com/view/1374860.htm" title="comm" target="_blank">comm</a> ▪ <a href="http://baike.baidu.com/view/443540.htm" title="cut" target="_blank">cut</a> ▪ <a href="http://baike.baidu.com/view/16488.htm" title="ed" target="_blank">ed</a>▪ <a href="http://baike.baidu.com/view/345491.htm" title="ex" target="_blank">ex</a> ▪ <a href="http://baike.baidu.com/view/2131324.htm" title="fmt" target="_blank">fmt</a> ▪ <a href="http://baike.baidu.com/view/463665.htm" title="head" target="_blank">head</a> ▪ <a href="http://baike.baidu.com/view/1437030.htm" title="iconv" target="_blank">iconv</a>▪ <a href="http://baike.baidu.com/view/598388.htm" title="join" target="_blank">join</a> ▪ <a href="http://baike.baidu.com/view/1229034.htm" title="less" target="_blank">less</a> ▪ <a href="http://baike.baidu.com/view/29762.htm" title="more" target="_blank">more</a> ▪ <a href="http://baike.baidu.com/view/1374816.htm" title="paste" target="_blank">paste</a>▪ <a href="http://baike.baidu.com/view/432091.htm" title="sed" target="_blank">sed</a> ▪ <a href="http://baike.baidu.com/view/1374853.htm" title="sort" target="_blank">sort</a> ▪ <a href="http://baike.baidu.com/view/7923.htm" title="strings" target="_blank">strings</a> ▪ <a href="http://baike.baidu.com/view/112883.htm" title="talk" target="_blank">talk</a>▪ <a href="http://baike.baidu.com/view/754049.htm" title="tac" target="_blank">tac</a> ▪ <a href="http://baike.baidu.com/view/1053222.htm" title="tail" target="_blank">tail</a> ▪ <a href="http://baike.baidu.com/view/316588.htm" title="tr" target="_blank">tr</a> ▪ <a href="http://baike.baidu.com/view/1374849.htm" title="uniq" target="_blank">uniq</a>▪ <a href="http://baike.baidu.com/view/27682.htm" title="vi" target="_blank">vi</a> ▪ <a href="http://baike.baidu.com/view/24408.htm" title="wc" target="_blank">wc</a> ▪ <a href="http://baike.baidu.com/view/2285387.htm" title="xargs" target="_blank">xargs</a> Shell 程序 ▪ <a href="http://baike.baidu.com/view/49616.htm" title="alias" target="_blank">alias</a> ▪ <a href="http://baike.baidu.com/view/2978587.htm" title="basename" target="_blank">basename</a> ▪ <a href="http://baike.baidu.com/view/2978588.htm" title="dirname" target="_blank">dirname</a> ▪ <a href="http://baike.baidu.com/view/32757.htm" title="echo" target="_blank">echo</a>▪ <a href="http://baike.baidu.com/view/1229144.htm" title="expr" target="_blank">expr</a> ▪ <a href="http://baike.baidu.com/view/2152638.htm" title="false" target="_blank">false</a> ▪ <a href="http://baike.baidu.com/view/410546.htm" title="printf" target="_blank">printf</a> ▪ <a href="http://baike.baidu.com/view/1234.htm" title="test" target="_blank">test</a>▪ <a href="http://baike.baidu.com/view/743997.htm" title="true" target="_blank">true</a> ▪ <a href="http://baike.baidu.com/view/4879915.htm" title="unset" target="_blank">unset</a> 网络 ▪ <a href="http://baike.baidu.com/view/500836.htm" title="inetd" target="_blank">inetd</a> ▪ <a href="http://baike.baidu.com/view/28008.htm" title="netstat" target="_blank">netstat</a> ▪ <a href="http://baike.baidu.com/view/709.htm" title="ping" target="_blank">ping</a> ▪ <a href="http://baike.baidu.com/view/611069.htm" title="rlogin" target="_blank">rlogin</a>▪ <a href="http://baike.baidu.com/view/560266.htm" title="netcat" target="_blank">netcat</a> ▪ <a href="http://baike.baidu.com/view/70478.htm" title="traceroute" target="_blank">traceroute</a> 搜索 ▪ <a href="http://baike.baidu.com/view/801452.htm" title="find" target="_blank">find</a> ▪ <a href="http://baike.baidu.com/view/1057278.htm" title="grep" target="_blank">grep</a> ▪ <a href="http://baike.baidu.com/view/1229038.htm" title="locate" target="_blank">locate</a> ▪ <a href="http://baike.baidu.com/view/1793607.htm" title="whereis" target="_blank">whereis</a>▪ <a href="http://baike.baidu.com/view/1793602.htm" title="which" target="_blank">which</a> 杂项 ▪ <a href="http://baike.baidu.com/searchword/?word=apropos&amp;pic=1&amp;sug=1&amp;enc=utf8" title="待创建" target="_blank">apropos</a> ▪ <a href="http://baike.baidu.com/view/53292.htm" title="banner" target="_blank">banner</a> ▪ <a href="http://baike.baidu.com/view/104163.htm" title="bc" target="_blank">bc</a> ▪ <a href="http://baike.baidu.com/view/56183.htm" title="cal" target="_blank">cal</a>▪ <a href="http://baike.baidu.com/view/611255.htm" title="clear" target="_blank">clear</a> ▪ <a href="http://baike.baidu.com/view/555251.htm" title="date" target="_blank">date</a> ▪ <a href="http://baike.baidu.com/view/21965.htm" title="dd" target="_blank">dd</a> ▪ <a href="http://baike.baidu.com/view/32758.htm" title="file" target="_blank">file</a>▪ <a href="http://baike.baidu.com/view/310222.htm" title="help" target="_blank">help</a> ▪ <a href="http://baike.baidu.com/view/105555.htm" title="info" target="_blank">info</a> ▪ <a href="http://baike.baidu.com/view/126727.htm" title="size" target="_blank">size</a> ▪ <a href="http://baike.baidu.com/view/136896.htm" title="lp" target="_blank">lp</a>▪ <a href="http://baike.baidu.com/view/2671.htm" title="man" target="_blank">man</a> ▪ <a href="http://baike.baidu.com/view/325910.htm" title="history" target="_blank">history</a> ▪ <a href="http://baike.baidu.com/view/912941.htm" title="tee" target="_blank">tee</a> ▪ <a href="http://baike.baidu.com/searchword/?word=tput&amp;pic=1&amp;sug=1&amp;enc=utf8" title="待创建" target="_blank">tput</a>▪ <a href="http://baike.baidu.com/view/360307.htm" title="type" target="_blank">type</a> ▪ <a href="http://baike.baidu.com/view/74673.htm" title="yes" target="_blank">yes</a> ▪ <a href="http://baike.baidu.com/view/1374878.htm" title="uname" target="_blank">uname</a> ▪ <a href="http://baike.baidu.com/view/2129683.htm" title="whatis" target="_blank">whatis</a></p>
<p>开放分类： <a href="http://baike.baidu.com/fenlei/%E7%BD%91%E7%BB%9C" target="_blank">网络</a><a href="http://baike.baidu.com/fenlei/%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1" target="_blank">程序设计</a></p>
<p><a href="">我来完善</a>  “Awk”相关词条： <a href="http://baike.baidu.com/view/1057278.htm?func=retitle" title="GREP" target="_blank">GREP</a><a href="http://baike.baidu.com/view/432091.htm?func=retitle" title="SED" target="_blank">SED</a></p>
<p><a href="http://baike.baidu.com/view/1057278.htm?func=retitle" title="GREP" target="_blank">GREP</a> <a href="http://baike.baidu.com/view/432091.htm?func=retitle" title="SED" target="_blank">SED</a> </p>
<p>百度百科中的词条正文与判断内容均由用户提供，不代表百度百科立场。如果您需要解决具体问题（如法律、医学等领域），建议您咨询相关领域专业人士。
<strong>433</strong>本词条对我有帮助
<a href="http://cang.baidu.com/do/add" title="添加到搜藏" target="_blank">添加到收藏</a></p>
<p>分享到:</p>
<p><a href="&quot;分享到新浪微博&quot;"></a><a href="&quot;分享到腾讯微博&quot;"></a><a href="&quot;分享到豆瓣网&quot;"></a><a href="&quot;分享到搜狐微博&quot;"></a><a href="&quot;分享到网易微博&quot;"></a> <a href="&quot;分享到人人网&quot;"></a><a href="&quot;分享到一键分享&quot;"></a>更多
合作编辑者 <a href="http://www.baidu.com/p/seagull007?from=wk" title="查看此用户资料" target="_blank">seagull007</a>  ， <a href="http://www.baidu.com/p/AleXu039?from=wk" title="查看此用户资料" target="_blank">AleXu039</a>  ， <a href="http://www.baidu.com/p/nwpujunesky?from=wk" title="查看此用户资料" target="_blank">nwpujunesky</a>  ， <a href="http://www.baidu.com/p/906412558?from=wk" title="查看此用户资料" target="_blank">906412558</a>  ， <a href="http://www.baidu.com/p/zsf8510?from=wk" title="查看此用户资料" target="_blank">zsf8510</a>  ， <a href="http://www.baidu.com/p/%E5%93%8E_%E5%8F%88%E8%A7%81%E8%90%BD%E5%8F%B6?from=wk" title="查看此用户资料" target="_blank">哎_又见落叶</a>  ， <a href="http://www.baidu.com/p/rhyain?from=wk" title="查看此用户资料" target="_blank">rhyain</a> <a href="http://baike.baidu.com/update/id=209681?from=au" target="_blank">更多</a></p>
<p>如果您认为本词条还需进一步完善，百科欢迎您也来参与 <a href="">编辑词条</a> 在开始编辑前，您还可以先学习<a href="http://www.baidu.com/search/baike_help.html#编辑原则" target="_blank">如何编辑词条</a></p>
<p>如想投诉，请到<a href="http://tousu.baidu.com/baike" target="_blank">百度百科投诉中心</a>；如想提出意见、建议，请到<a href="http://baike.baidu.com/feedback" target="_blank">意见反馈</a>。</p>
<h3 id="-">百度百科内容方针</h3>
<ul>
<li>提倡有可靠依据、权威可信的内容</li>
<li>鼓励客观、中立、严谨的表达观点</li>
<li>不欢迎恶意破坏、自我或商业宣传</li>
</ul>
<h3 id="-">在这里你可以</h3>
<p>编辑质疑投诉</p>
<h3 id="-">全方位的质量监督</h3>
<ul>
<li><a href="http://baike.baidu.com/zhuanjia" target="_blank">学术委员会</a>：为亿万网友提供权威意见</li>
<li><a href="http://baike.baidu.com/collator#1" target="_blank">编修院</a>：把控质量，做更好的知识</li>
</ul>
<p><a href="http://baike.baidu.com/uc/home" target="_blank"><img src="" alt=""></a></p>
<p><a href="http://baike.baidu.com/cms/s/kdt/index.html" target="_blank"><img src="&quot;百科蝌蚪团&quot;" alt="百科蝌蚪团"></a><a href="http://baike.baidu.com/cms/topic/master/index.html" target="_blank"><img src="&quot;百科分类管理员&quot;" alt="百科分类管理员"></a><a href="http://baike.baidu.com/cms/s/core/index.html" target="_blank"><img src="&quot;核心用户&quot;" alt="核心用户"></a><a href="http://baike.baidu.com/uc/home" target="_blank">jywv</a></p>
<p><a href="http://www.baidu.com/search/baike_help.html#百科积分体系" target="_blank"><img src="" alt=""></a><a href="http://www.baidu.com/search/baike_help.html#图片优质、初级、中级和高级优质的概念" title="高质量版本" target="_blank"></a>0<a href="http://www.baidu.com/search/baike_help.html#中级优质评选规则及说明" title="优质版本"></a>0
<a href="http://baike.baidu.com/mall/zone?zoneId=1" target="_blank">去兑换&gt;&gt;</a>您尚无道具可使用</p>
<h3 id="-http-baike-baidu-com-uc-task-http-baike-baidu-com-uc-task-"><a href="http://baike.baidu.com/uc/task" target="_blank"></a><a href="http://baike.baidu.com/uc/task">成长任务</a></h3>
<h3 id="-http-baike-baidu-com-uc-task-3-http-baike-baidu-com-uc-task-3-"><a href="http://baike.baidu.com/uc/task#3" target="_blank"></a><a href="http://baike.baidu.com/uc/task#3">日常任务</a></h3>
<ul>
<li>本月累计点亮0天。今日笑脸还没点亮哦。</li>
<li><a href="http://baike.baidu.com/cms/s/event/dailyymlr/task.html" target="_blank">一目了然 日常任务</a>：参加任务<a href="http://baike.baidu.com/cms/s/event/dailyymlr/task.html" target="_blank"></a><h3 id="-http-www-baidu-com-search-baike-hothelp-http-baike-baidu-com-uc-recommend-"><a href="http://www.baidu.com/search/baike/hothelp/"></a><a href="http://baike.baidu.com/uc/recommend" target="_blank">热词推送</a><a href=""></a></h3>
</li>
</ul>
<p>编辑热词可获得额外经验值</p>
<h3 id="-"><a href=""></a><a href=""></a></h3>
<h3 id="-http-baike-baidu-com-uc-effort-http-baike-baidu-com-uc-effort-"><a href="http://baike.baidu.com/uc/effort" target="_blank"></a><a href="http://baike.baidu.com/uc/effort">词条动态</a></h3>
<p><a href="http://baike.baidu.com/uc/home" target="_blank">进入我的百科</a></p>
<p>您目前的等级是2级
您目前的经验值是236点
您还需264点经验值即可升为3级
词条统计浏览次数：约 177858次编辑次数：34次 <a href="http://baike.baidu.com/update/id=209681" target="_blank">历史版本</a>词条讨论：1次 <a href="http://baike.baidu.com/historydoubt?lemmaId=209681" target="_blank">讨论历史</a>最近更新：2013-07-09创建者：<a href="http://www.baidu.com/p/xztlsy?from=wk" title="查看此用户资料" target="_blank">xztlsy</a></p>
<p><a href="http://baike.baidu.com/update/id=209681" target="_blank">更多</a>贡献光荣榜<strong>辛勤贡献者：</strong><a href="&quot;贡献复杂版本，被称为辛勤贡献者&quot;"></a><a href="http://www.baidu.com/p/%E5%93%8E_%E5%8F%88%E8%A7%81%E8%90%BD%E5%8F%B6?from=wk" title="查看此用户资料">哎_又见落...</a><a href="http://www.baidu.com/search/baike_help.html#百科积分体系" target="_blank"><img src="" alt="用户等级"></a><a href="http://www.baidu.com/search/baike_help.html#复杂编辑" target="_blank"><img src="&quot;为词条改进贡献了复杂版本的用户，被称为辛勤贡献者&quot;" alt="为词条改进贡献了复杂版本的用户，被称为辛勤贡献者"></a> <a href="http://baike.baidu.com/history/id=39614501" target="_blank">版本</a><a href="http://www.baidu.com/p/906412558?from=wk" title="查看此用户资料" target="_blank">906412558</a><a href="http://www.baidu.com/search/baike_help.html#百科积分体系" target="_blank"><img src="" alt="用户等级"></a><a href="http://www.baidu.com/search/baike_help.html#复杂编辑" target="_blank"><img src="&quot;为词条改进贡献了复杂版本的用户，被称为辛勤贡献者&quot;" alt="为词条改进贡献了复杂版本的用户，被称为辛勤贡献者"></a> <a href="http://baike.baidu.com/history/id=41988487" target="_blank">版本</a><a href="http://www.baidu.com/p/%E6%88%91%E6%98%AF%E5%8A%A0%E7%99%BE%E5%8A%9B?from=wk" title="查看此用户资料" target="_blank">我是加百力</a><a href="http://www.baidu.com/search/baike_help.html#百科积分体系" target="_blank"><img src="" alt="用户等级"></a><a href="http://www.baidu.com/search/baike_help.html#复杂编辑" target="_blank"><img src="&quot;为词条改进贡献了复杂版本的用户，被称为辛勤贡献者&quot;" alt="为词条改进贡献了复杂版本的用户，被称为辛勤贡献者"></a> <a href="http://baike.baidu.com/history/id=33287897" target="_blank">版本</a><a href="http://www.baidu.com/p/goodzili?from=wk" title="查看此用户资料" target="_blank">goodzili</a><a href="http://www.baidu.com/search/baike_help.html#百科积分体系" target="_blank"><img src="" alt="用户等级"></a><a href="http://www.baidu.com/search/baike_help.html#复杂编辑" target="_blank"><img src="&quot;为词条改进贡献了复杂版本的用户，被称为辛勤贡献者&quot;" alt="为词条改进贡献了复杂版本的用户，被称为辛勤贡献者"></a> <a href="http://baike.baidu.com/history/id=4892580" target="_blank">版本</a><a href="http://www.baidu.com/p/sania9?from=wk" title="查看此用户资料" target="_blank">sania9</a><a href="http://www.baidu.com/search/baike_help.html#百科积分体系" target="_blank"><img src="" alt="用户等级"></a><a href="http://www.baidu.com/search/baike_help.html#复杂编辑" target="_blank"><img src="&quot;为词条改进贡献了复杂版本的用户，被称为辛勤贡献者&quot;" alt="为词条改进贡献了复杂版本的用户，被称为辛勤贡献者"></a> <a href="http://baike.baidu.com/history/id=5055017" target="_blank">版本</a><a href="">查看更多贡献者</a>
最新动态全国首家3D全景博物馆：<a href="http://baike.baidu.com/museum/yungang.html" target="_blank"></a> <a href="http://baike.baidu.com/museum/yungang.html"><img src="" alt=""></a>百科消息：<a href="http://baike.baidu.com/m#download" target="_blank">快来下载全新百科客户端2.0版</a><a href="http://baike.baidu.com/m#mini" target="_blank">【百科mini】无锡百科城市手册</a><a href="http://uxsurvey.baidu.com/index.php?sid=61557&amp;lang=zh-Hans" target="_blank">【有奖调研】给词条页提提建议</a><a href="http://baike.baidu.com/m#mini" target="_blank">【百科mini】曼德拉的光辉岁月</a><a href="http://music.baidu.com/topic/cooperation/chinavoice2013?fr=baike" target="_blank">好声音第二季 独家音频首发</a>
© 2013 Baidu <a href="http://www.baidu.com/duty/" target="_blank">使用百度前必读</a> | <a href="http://www.baidu.com/search/baike_help.html#百科协议" target="_blank">百科协议</a> | <a href="http://baike.baidu.com/hezuo/" target="_blank">百度百科合作平台</a>
<a href="&quot;返回顶部&quot;"></a></p>
<p>Awk</p>
<h2 id="-awk-awk-"><a href="&quot;awk释义&quot;">awk释义</a></h2>
<h2 id="-awk-awk-"><a href="&quot;awk简介&quot;">awk简介</a></h2>
<h2 id="-"><a href="&quot;调用方式&quot;">调用方式</a></h2>
<h2 id="-"><a href="&quot;语法&quot;">语法</a></h2>
<h2 id="-"><a href="&quot;内置变量&quot;">内置变量</a></h2>
<h2 id="-"><a href="&quot;内置函数&quot;">内置函数</a></h2>
<h2 id="-"><a href="&quot;命令行使用&quot;">命令行使用</a></h2>
<h2 id="-"><a href="&quot;详细介绍&quot;">详细介绍</a></h2>
<h2 id="-"><a href="&quot;变量&quot;">变量</a></h2>
<h2 id="-"><a href="&quot;运算与判断&quot;">运算与判断</a></h2>
<h2 id="-"><a href="&quot;流程控制&quot;">流程控制</a></h2>
<h3 id="-1-1-"><a href="&quot;1&quot;">1</a></h3>
<h3 id="-2-2-"><a href="&quot;2&quot;">2</a></h3>
<h2 id="-"><a href="&quot;函数&quot;">函数</a></h2>
<h2 id="-"><a href="&quot;输入输出&quot;">输入输出</a></h2>
<p><img src="http://c.baidu.com/c.gif?t=7&amp;q=Awk&amp;p=0" alt=""></p>
<p>参考资料
<a href=""><img src="" alt=""></a></p>
<p><a href=""></a></p>
<p><img src="" alt=""></p>
<p><a href=""></a></p>
<p>会员:发帖:
<img src="" alt="">
<a href=""></a></p>
<p><a href="http://uxsurvey.baidu.com/index.php?sid=61557&amp;lang=zh-Hans" target="_blank"><img src="" alt=""></a></p>
<h3 id="-http-uxsurvey-baidu-com-index-php-sid-61557-lang-zh-hans-"><a href="http://uxsurvey.baidu.com/index.php?sid=61557&amp;lang=zh-Hans" target="_blank">词条页面有奖调研</a></h3>
<p>想让词条页的展现形式更丰富多彩吗？只要你敢想，百科就可能帮你实现。参加调研问卷，还能获得精美礼品！<a href="http://uxsurvey.baidu.com/index.php?sid=61557&amp;lang=zh-Hans" target="_blank">查看更多</a><a href="&quot;关闭&quot;">关闭</a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/unix/">unix</a></li></span></span> | <span class="tags">Tagged <a href="/tags/unix/" class="label label-primary">unix</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:43"datetime="2014-03-07 09:54:43"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-unix--Awk_百度百科/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-unix--Awk_百度百科" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-unix--Awk学习笔记/">Awk学习笔记</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:43.000Z"> <a href="/2014/02/02/2014-02-02-unix--Awk学习笔记/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="awk-">Awk学习笔记</h1>
<h1 id="-awk-"><a href=""></a>Awk学习笔记</h1>
<h3 id="-jims-of-http-www-ringkee-com-">整理：Jims of <a href="http://www.ringkee.com/" target="_blank">肥肥世家</a></h3>
<p><a href="&#109;&#97;&#x69;&#x6c;&#x74;&#111;&#58;&#91;&#x6a;&#105;&#109;&#x73;&#46;&#x79;&#x61;&#x6e;&#103;&#x40;&#x67;&#x6d;&#x61;&#105;&#x6c;&#x2e;&#x63;&#x6f;&#109;&#x5d;&#x28;&#x6d;&#x61;&#105;&#108;&#x74;&#111;&#58;&#106;&#105;&#x6d;&#115;&#x2e;&#121;&#97;&#110;&#103;&#64;&#x67;&#109;&#97;&#x69;&#x6c;&#x2e;&#x63;&#111;&#109;&#41;">&#91;&#x6a;&#105;&#109;&#x73;&#46;&#x79;&#x61;&#x6e;&#103;&#x40;&#x67;&#x6d;&#x61;&#105;&#x6c;&#x2e;&#x63;&#x6f;&#109;&#x5d;&#x28;&#x6d;&#x61;&#105;&#108;&#x74;&#111;&#58;&#106;&#105;&#x6d;&#115;&#x2e;&#121;&#97;&#110;&#103;&#64;&#x67;&#109;&#97;&#x69;&#x6c;&#x2e;&#x63;&#111;&#109;&#41;</a>
Copyright © 2004 本文遵从GPL协议，欢迎转载、修改、散布。</p>
<p>第一次发布时间:2004年8月6日</p>
<p><strong>Table of Contents</strong>
<a href="">1. awk简介</a><a href="">2. awk命令格式和选项</a><a href="">2.1. awk的语法有两种形式</a><a href="">2.2. 命令选项</a><a href="">3. 模式和操作</a><a href="">3.1. 模式</a><a href="">3.2. 操作</a><a href="">4. awk的环境变量</a><a href="">5. awk运算符</a><a href="">6. 记录和域</a><a href="">6.1. 记录</a><a href="">6.2. 域</a><a href="">6.3. 域分隔符</a><a href="">7. gawk专用正则表达式元字符</a><a href="">8. POSIX字符集</a><a href="">9. 匹配操作符(~)</a><a href="">10. 比较表达式</a><a href="">11. 范围模板</a><a href="">12. 一个验证passwd文件有效性的例子</a><a href="">13. 几个实例</a><a href="">14. awk编程</a><a href="">14.1. 变量</a><a href="">14.2. BEGIN模块</a><a href="">14.3. END模块</a><a href="">14.4. 重定向和管道</a><a href="">14.5. 条件语句</a><a href="">14.6. 循环</a><a href="">14.7. 数组</a><a href="">14.8. awk的内建函数</a><a href="">15. How-to</a></p>
<h2 id="-1-awk-"><a href=""></a>1. awk简介</h2>
<p>awk是一种编程语言，用于在linux/unix下对文本和数据进行处理。数据可以来自标准输入、一个或多个文件，或其它命令的输出。它支持用户自定义函数和动态正则表达式等先进功能，是linux/unix下的一个强大编程工具。它在命令行中使用，但更多是作为脚本来使用。awk的处理文本和数据的方式是这样的，它逐行扫描文件，从第一行到最后一行，寻找匹配的特定模式的行，并在这些行上进行你想要的操作。如果没有指定处理动作，则把匹配的行显示到标准输出(屏幕)，如果没有指定模式，则所有被操作所指定的行都被处理。awk分别代表其作者姓氏的第一个字母。因为它的作者是三个人，分别是Alfred Aho、Brian Kernighan、Peter Weinberger。gawk是awk的GNU版本，它提供了Bell实验室和GNU的一些扩展。下面介绍的awk是以GUN的gawk为例的，在linux系统中已把awk链接到gawk，所以下面全部以awk进行介绍。</p>
<h2 id="-2-awk-"><a href=""></a>2. awk命令格式和选项</h2>
<h3 id="-2-1-awk-"><a href=""></a>2.1. awk的语法有两种形式</h3>
<ul>
<li>awk [options] &#39;script&#39; var=value file(s)</li>
<li>awk [options] -f scriptfile var=value file(s)<h3 id="-2-2-"><a href=""></a>2.2. 命令选项</h3>
</li>
</ul>
<p>-F fs or --field-separator fs
指定输入文件折分隔符，fs是一个字符串或者是一个正则表达式，如-F:。
-v var=value or --asign var=value
赋值一个用户定义变量。
-f scripfile or --file scriptfile
从脚本文件中读取awk命令。
-mf nnn and -mr nnn
对nnn值设置内在限制，-mf选项限制分配给nnn的最大块数目；-mr选项限制记录的最大数目。这两个功能是Bell实验室版awk的扩展功能，在标准awk中不适用。
-W compact or --compat, -W traditional or --traditional
在兼容模式下运行awk。所以gawk的行为和标准的awk完全一样，所有的awk扩展都被忽略。
-W copyleft or --copyleft, -W copyright or --copyright
打印简短的版权信息。
-W help or --help, -W usage or --usage
打印全部awk选项和每个选项的简短说明。
-W lint or --lint
打印不能向传统unix平台移植的结构的警告。
-W lint-old or --lint-old
打印关于不能向传统unix平台移植的结构的警告。
-W posix
打开兼容模式。但有以下限制，不识别：\x、函数关键字、func、换码序列以及当fs是一个空格时，将新行作为一个域分隔符；操作符/<em>/</em>和/<em>/</em>=不能代替^和^=；fflush无效。
-W re-interval or --re-inerval
允许间隔正则表达式的使用，参考(grep中的Posix字符类)，如括号表达式[[:alpha:]]。
-W source program-text or --source program-text
使用program-text作为源代码，可与-f命令混用。
-W version or --version
打印bug报告信息的版本。</p>
<h2 id="-3-"><a href=""></a>3. 模式和操作</h2>
<p>awk脚本是由模式和操作组成的：
pattern {action} 如$ awk &#39;/root/&#39; test，或$ awk &#39;$3 &lt; 100&#39; test。</p>
<p>两者是可选的，如果没有模式，则action应用到全部记录，如果没有action，则输出匹配全部记录。默认情况下，每一个输入行都是一条记录，但用户可通过RS变量指定不同的分隔符进行分隔。</p>
<h3 id="-3-1-"><a href=""></a>3.1. 模式</h3>
<p>模式可以是以下任意一个：</p>
<ul>
<li>/正则表达式/：使用通配符的扩展集。</li>
<li>关系表达式：可以用下面运算符表中的关系运算符进行操作，可以是字符串或数字的比较，如$2&gt;%1选择第二个字段比第一个字段长的行。</li>
<li>模式匹配表达式：用运算符~(匹配)和~!(不匹配)。</li>
<li>模式，模式：指定一个行的范围。该语法不能包括BEGIN和END模式。</li>
<li>BEGIN：让用户指定在第一条输入记录被处理之前所发生的动作，通常可在这里设置全局变量。</li>
<li>END：让用户在最后一条输入记录被读取之后发生的动作。</li>
</ul>
<h3 id="-3-2-"><a href=""></a>3.2. 操作</h3>
<p>操作由一人或多个命令、函数、表达式组成，之间由换行符或分号隔开，并位于大括号内。主要有四部份：</p>
<ul>
<li>变量或数组赋值</li>
<li>输出命令</li>
<li>内置函数</li>
<li>控制流命令</li>
</ul>
<h2 id="-4-awk-"><a href=""></a>4. awk的环境变量</h2>
<p><a href=""></a></p>
<p><strong>Table 1. awk的环境变量</strong></p>
<p>变量描述$n当前记录的第n个字段，字段间由FS分隔。$0完整的输入记录。ARGC命令行参数的数目。ARGIND命令行中当前文件的位置(从0开始算)。ARGV包含命令行参数的数组。CONVFMT数字转换格式(默认值为%.6g)ENVIRON环境变量关联数组。ERRNO最后一个系统错误的描述。FIELDWIDTHS字段宽度列表(用空格键分隔)。FILENAME当前文件名。FNR同NR，但相对于当前文件。FS字段分隔符(默认是任何空格)。IGNORECASE如果为真，则进行忽略大小写的匹配。NF当前记录中的字段数。NR当前记录数。OFMT数字的输出格式(默认值是%.6g)。OFS输出字段分隔符(默认值是一个空格)。ORS输出记录分隔符(默认值是一个换行符)。RLENGTH由match函数所匹配的字符串的长度。RS记录分隔符(默认是一个换行符)。RSTART由match函数所匹配的字符串的第一个位置。SUBSEP数组下标分隔符(默认值是\034)。</p>
<h2 id="-5-awk-"><a href=""></a>5. awk运算符</h2>
<p><a href=""></a></p>
<p><strong>Table 2. 运算符</strong></p>
<p>运算符描述= += -= /<em>= /= %= ^= /</em>/<em>=赋值?:C条件表达式||逻辑或&amp;&amp;逻辑与~ ~!匹配正则表达式和不匹配正则表达式&lt; &lt;= &gt; &gt;= != ==关系运算符空格连接+ -加，减/</em> / &amp;乘，除与求余+ - !一元加，减和逻辑非^ /<em>/</em>/*求幂++ --增加或减少，作为前缀或后缀$字段引用in数组成员</p>
<h2 id="-6-"><a href=""></a>6. 记录和域</h2>
<h3 id="-6-1-"><a href=""></a>6.1. 记录</h3>
<p>awk把每一个以换行符结束的行称为一个记录。</p>
<p>记录分隔符：默认的输入和输出的分隔符都是回车，保存在内建变量ORS和RS中。</p>
<p>$0变量：它指的是整条记录。如$ awk &#39;{print $0}&#39; test将输出test文件中的所有记录。</p>
<p>变量NR：一个计数器，每处理完一条记录，NR的值就增加1。如$ awk &#39;{print NR,$0}&#39; test将输出test文件中所有记录，并在记录前显示记录号。</p>
<h3 id="-6-2-"><a href=""></a>6.2. 域</h3>
<p>记录中每个单词称做“域”，默认情况下以空格或tab分隔。awk可跟踪域的个数，并在内建变量NF中保存该值。如$ awk &#39;{print $1,$3}&#39; test将打印test文件中第一和第三个以空格分开的列(域)。</p>
<h3 id="-6-3-"><a href=""></a>6.3. 域分隔符</h3>
<p>内建变量FS保存输入域分隔符的值，默认是空格或tab。我们可以通过-F命令行选项修改FS的值。如$ awk -F: &#39;{print $1,$5}&#39; test将打印以冒号为分隔符的第一，第五列的内容。</p>
<p>可以同时使用多个域分隔符，这时应该把分隔符写成放到方括号中，如$awk -F&#39;[:\t]&#39; &#39;{print $1,$3}&#39; test，表示以空格、冒号和tab作为分隔符。</p>
<p>输出域的分隔符默认是一个空格，保存在OFS中。如$ awk -F: &#39;{print $1,$5}&#39; test，$1和$5间的逗号就是OFS的值。</p>
<h2 id="-7-gawk-"><a href=""></a>7. gawk专用正则表达式元字符</h2>
<p>一般通用的元字符集就不讲了，可参考我的<a href="http://www.ringkee.com/jims/technic_folder/sed.htm" target="_blank">Sed</a>和<a href="http://www.ringkee.com/jims/technic_floder/grep.htm" target="_blank">Grep</a>学习笔记。以下几个是gawk专用的，不适合unix版本的awk。</p>
<p>\Y
匹配一个单词开头或者末尾的空字符串。
\B
匹配单词内的空字符串。
\&lt;
匹配一个单词的开头的空字符串，锚定开始。
>
匹配一个单词的末尾的空字符串，锚定末尾。
\w
匹配一个字母数字组成的单词。
\W
匹配一个非字母数字组成的单词。
\‘
匹配字符串开头的一个空字符串。
\&#39;
匹配字符串末尾的一个空字符串。</p>
<h2 id="-8-posix-"><a href=""></a>8. POSIX字符集</h2>
<p>可参考我的<a href="http://www.ringkee.com/jims/technic_folder/grep.htm" target="_blank">Grep学习笔记</a></p>
<h2 id="-9-"><a href=""></a>9. 匹配操作符(~)</h2>
<p>用来在记录或者域内匹配正则表达式。如$ awk &#39;$1 ~/^root/&#39; test将显示test文件第一列中以root开头的行。</p>
<h2 id="-10-"><a href=""></a>10. 比较表达式</h2>
<p>conditional expression1 ? expression2: expression3，例如：$ awk &#39;{max = {$1 &gt; $3} ? $1: $3: print max}&#39; test。如果第一个域大于第三个域，$1就赋值给max，否则$3就赋值给max。</p>
<p>$ awk &#39;$1 + $2 &lt; 100&#39; test。如果第一和第二个域相加大于100，则打印这些行。</p>
<p>$ awk &#39;$1 &gt; 5 &amp;&amp; $2 &lt; 10&#39; test,如果第一个域大于5，并且第二个域小于10，则打印这些行。</p>
<h2 id="-11-"><a href=""></a>11. 范围模板</h2>
<p>范围模板匹配从第一个模板的第一次出现到第二个模板的第一次出现之间所有行。如果有一个模板没出现，则匹配到开头或末尾。如$ awk &#39;/root/,/mysql/&#39; test将显示root第一次出现到mysql第一次出现之间的所有行。</p>
<h2 id="-12-passwd-"><a href=""></a>12. 一个验证passwd文件有效性的例子</h2>
<p><a href=""></a><img src="http://man.lupaworld.com/content/manage/ringkee/images/callouts/1.png" alt="1">$ cat /etc/passwd | awk -F: &#39;\ <a href=""></a><img src="http://man.lupaworld.com/content/manage/ringkee/images/callouts/2.png" alt="2">NF != 7{\ <a href=""></a><img src="http://man.lupaworld.com/content/manage/ringkee/images/callouts/3.png" alt="3">printf(&quot;line %d,does not have 7 fields:%s\n&quot;,NR,$0)}\ <a href=""></a><img src="http://man.lupaworld.com/content/manage/ringkee/images/callouts/4.png" alt="4">$1 !~ /[A-Za-z0-9]/{printf(&quot;line %d,non alpha and numeric user id:%d: %s\n,NR,$0)}\ <a href=""></a><img src="http://man.lupaworld.com/content/manage/ringkee/images/callouts/5.png" alt="5">$2 == &quot;/*&quot; {printf(&quot;line %d, no password: %s\n&quot;,NR,$0)}&#39;</p>
<p><a href=""><img src="http://man.lupaworld.com/content/manage/ringkee/images/callouts/1.png" alt="1"></a>
cat把结果输出给awk，awk把域之间的分隔符设为冒号。<a href=""><img src="http://man.lupaworld.com/content/manage/ringkee/images/callouts/2.png" alt="2"></a>
如果域的数量(NF)不等于7，就执行下面的程序。<a href=""><img src="http://man.lupaworld.com/content/manage/ringkee/images/callouts/3.png" alt="3"></a>
printf打印字符串&quot;line ?? does not have 7 fields&quot;，并显示该条记录。<a href=""><img src="http://man.lupaworld.com/content/manage/ringkee/images/callouts/4.png" alt="4"></a>
如果第一个域没有包含任何字母和数字，printf打印“no alpha and numeric user id&quot; ，并显示记录数和记录。<a href=""><img src="http://man.lupaworld.com/content/manage/ringkee/images/callouts/5.png" alt="5"></a>
如果第二个域是一个星号，就打印字符串“no passwd”，紧跟着显示记录数和记录本身。</p>
<h2 id="-13-"><a href=""></a>13. 几个实例</h2>
<ul>
<li>$ awk &#39;/^(no|so)/&#39; test-----打印所有以模式no或so开头的行。</li>
<li>$ awk &#39;/^[ns]/{print $1}&#39; test-----如果记录以n或s开头，就打印这个记录。</li>
<li>$ awk &#39;$1 ~/[0-9][0-9]$/(print $1}&#39; test-----如果第一个域以两个数字结束就打印这个记录。</li>
<li>$ awk &#39;$1 == 100 || $2 &lt; 50&#39; test-----如果第一个或等于100或者第二个域小于50，则打印该行。</li>
<li>$ awk &#39;$1 != 10&#39; test-----如果第一个域不等于10就打印该行。</li>
<li>$ awk &#39;/test/{print $1 + 10}&#39; test-----如果记录包含正则表达式test，则第一个域加10并打印出来。</li>
<li>$ awk &#39;{print ($1 &gt; 5 ? &quot;ok &quot;$1: &quot;error&quot;$1)}&#39; test-----如果第一个域大于5则打印问号后面的表达式值，否则打印冒号后面的表达式值。</li>
<li>$ awk &#39;/^root/,/^mysql/&#39; test----打印以正则表达式root开头的记录到以正则表达式mysql开头的记录范围内的所有记录。如果找到一个新的正则表达式root开头的记录，则继续打印直到下一个以正则表达式mysql开头的记录为止，或到文件末尾。</li>
</ul>
<h2 id="-14-awk-"><a href=""></a>14. awk编程</h2>
<h3 id="-14-1-"><a href=""></a>14.1. 变量</h3>
<ul>
<li>在awk中，变量不需要定义就可以直接使用，变量类型可以是数字或字符串。</li>
<li>赋值格式：Variable = expression，如$ awk &#39;$1 ~/test/{count = $2 + $3; print count}&#39; test,上式的作用是,awk先扫描第一个域，一旦test匹配，就把第二个域的值加上第三个域的值，并把结果赋值给变量count，最后打印出来。</li>
<li>awk可以在命令行中给变量赋值，然后将这个变量传输给awk脚本。如$ awk -F: -f awkscript month=4 year=2004 test，上式的month和year都是自定义变量，分别被赋值为4和2004。在awk脚本中，这些变量使用起来就象是在脚本中建立的一样。注意，如果参数前面出现test，那么在BEGIN语句中的变量就不能被使用。</li>
<li>域变量也可被赋值和修改，如$ awk &#39;{$2 = 100 + $1; print }&#39; test,上式表示，如果第二个域不存在，awk将计算表达式100加$1的值，并将其赋值给$2，如果第二个域存在，则用表达式的值覆盖$2原来的值。再例如：$ awk &#39;$1 == &quot;root&quot;{$1 =&quot;test&quot;;print}&#39; test，如果第一个域的值是“root”，则把它赋值为“test”，注意，字符串一定要用双引号。</li>
<li>内建变量的使用。变量列表在前面已列出，现在举个例子说明一下。$ awk -F: &#39;{IGNORECASE=1; $1 == &quot;MARY&quot;{print NR,$1,$2,$NF}&#39;test，把IGNORECASE设为1代表忽略大小写，打印第一个域是mary的记录数、第一个域、第二个域和最后一个域。<h3 id="-14-2-begin-"><a href=""></a>14.2. BEGIN模块</h3>
</li>
</ul>
<p>BEGIN模块后紧跟着动作块，这个动作块在awk处理任何输入文件之前执行。所以它可以在没有任何输入的情况下进行测试。它通常用来改变内建变量的值，如OFS,RS和FS等，以及打印标题。如：$ awk &#39;BEGIN{FS=&quot;:&quot;; OFS=&quot;\t&quot;; ORS=&quot;\n\n&quot;}{print $1,$2,$3} test。上式表示，在处理输入文件以前，域分隔符(FS)被设为冒号，输出文件分隔符(OFS)被设置为制表符，输出记录分隔符(ORS)被设置为两个换行符。$ awk &#39;BEGIN{print &quot;TITLE TEST&quot;}只打印标题。</p>
<h3 id="-14-3-end-"><a href=""></a>14.3. END模块</h3>
<p>END不匹配任何的输入文件，但是执行动作块中的所有动作，它在整个输入文件处理完成后被执行。如$ awk &#39;END{print &quot;The number of records is&quot; NR}&#39; test，上式将打印所有被处理的记录数。</p>
<h3 id="-14-4-"><a href=""></a>14.4. 重定向和管道</h3>
<ul>
<li>awk可使用shell的重定向符进行重定向输出，如：$ awk &#39;$1 = 100 {print $1 &gt; &quot;output_file&quot; }&#39; test。上式表示如果第一个域的值等于100，则把它输出到output_file中。也可以用&gt;&gt;来重定向输出，但不清空文件，只做追加操作。</li>
<li>输出重定向需用到getline函数。getline从标准输入、管道或者当前正在处理的文件之外的其他输入文件获得输入。它负责从输入获得下一行的内容，并给NF,NR和FNR等内建变量赋值。如果得到一条记录，getline函数返回1，如果到达文件的末尾就返回0，如果出现错误，例如打开文件失败，就返回-1。如：</li>
</ul>
<p>$ awk &#39;BEGIN{ &quot;date&quot; | getline d; print d}&#39; test。执行linux的date命令，并通过管道输出给getline，然后再把输出赋值给自定义变量d，并打印它。</p>
<p>$ awk &#39;BEGIN{&quot;date&quot; | getline d; split(d,mon); print mon[2]}&#39; test。执行shell的date命令，并通过管道输出给getline，然后getline从管道中读取并将输入赋值给d，split函数把变量d转化成数组mon，然后打印数组mon的第二个元素。</p>
<p>$ awk &#39;BEGIN{while( &quot;ls&quot; | getline) print}&#39;，命令ls的输出传递给geline作为输入，循环使getline从ls的输出中读取一行，并把它打印到屏幕。这里没有输入文件，因为BEGIN块在打开输入文件前执行，所以可以忽略输入文件。</p>
<p>$ awk &#39;BEGIN{printf &quot;What is your name?&quot;; getline name &lt; &quot;/dev/tty&quot; } $1 ~name {print &quot;Found&quot; name on line &quot;, NR &quot;.&quot;} END{print &quot;See you,&quot; name &quot;.&quot;} test。在屏幕上打印”What is your name?&quot;,并等待用户应答。当一行输入完毕后，getline函数从终端接收该行输入，并把它储存在自定义变量name中。如果第一个域匹配变量name的值，print函数就被执行，END块打印See you和name的值。</p>
<p>$ awk &#39;BEGIN{while (getline &lt; &quot;/etc/passwd&quot; &gt; 0) lc++; print lc}&#39;。awk将逐行读取文件/etc/passwd的内容，在到达文件末尾前，计数器lc一直增加，当到末尾时，打印lc的值。注意，如果文件不存在，getline返回-1，如果到达文件的末尾就返回0，如果读到一行，就返回1，所以命令 while (getline &lt; &quot;/etc/passwd&quot;)在文件不存在的情况下将陷入无限循环，因为返回-1表示逻辑真。</p>
<ul>
<li>可以在awk中打开一个管道，且同一时刻只能有一个管道存在。通过close()可关闭管道。如：$ awk &#39;{print $1, $2 | &quot;sort&quot; }&#39; test END {close(&quot;sort&quot;)}。awd把print语句的输出通过管道作为linux命令sort的输入,END块执行关闭管道操作。</li>
<li>system函数可以在awk中执行linux的命令。如：$ awk &#39;BEGIN{system(&quot;clear&quot;)&#39;。</li>
<li>fflush函数用以刷新输出缓冲区，如果没有参数，就刷新标准输出的缓冲区，如果以空字符串为参数，如fflush(&quot;&quot;),则刷新所有文件和管道的输出缓冲区。</li>
</ul>
<h3 id="-14-5-"><a href=""></a>14.5. 条件语句</h3>
<p>awk中的条件语句是从C语言中借鉴过来的，可控制程序的流程。</p>
<h3 id="-14-5-1-if-if-expression-statement-statement-"><a href=""></a>14.5.1. if语句格式： {if (expression){ statement; statement; ... } }</h3>
<p>$ awk &#39;{if ($1 &lt;$2) print $2 &quot;too high&quot;}&#39; test。如果第一个域小于第二个域则打印。</p>
<p>$ awk &#39;{if ($1 &lt; $2) {count++; print &quot;ok&quot;}}&#39; test.如果第一个域小于第二个域，则count加一，并打印ok。</p>
<h3 id="-14-5-2-if-else-if-expression-statement-statement-else-statement-statement-"><a href=""></a>14.5.2. if/else语句，用于双重判断。格式： {if (expression){ statement; statement; ... } else{ statement; statement; ... } }</h3>
<p>$ awk &#39;{if ($1 &gt; 100) print $1 &quot;bad&quot; ; else print &quot;ok&quot;}&#39; test。如果$1大于100则打印$1 bad,否则打印ok。</p>
<p>$ awk &#39;{if ($1 &gt; 100){ count++; print $1} else {count--; print $2}&#39; test。如果$1大于100，则count加一，并打印$1，否则count减一，并打印$1。</p>
<h3 id="-14-5-3-if-else-else-if-if-expression-statement-statement-else-if-expression-statement-statement-else-if-expression-statement-statement-else-statement-statement-"><a href=""></a>14.5.3. if/else else if语句，用于多重判断。格式： {if (expression){ statement; statement; ... } else if (expression){ statement; statement; ... } else if (expression){ statement; statement; ... } else { statement; statement; ... } }</h3>
<h3 id="-14-6-"><a href=""></a>14.6. 循环</h3>
<ul>
<li>awk有三种循环:while循环；for循环；special for循环。</li>
<li>$ awk &#39;{ i = 1; while ( i &lt;= NF ) { print NF,$i; i++}}&#39; test。变量的初始值为1，若i小于可等于NF(记录中域的个数),则执行打印语句，且i增加1。直到i的值大于NF.</li>
<li>$ awk &#39;{for (i = 1; i&lt;NF; i++) print NF,$i}&#39; test。作用同上。</li>
<li>breadkcontinue语句。break用于在满足条件的情况下跳出循环；continue用于在满足条件的情况下忽略后面的语句，直接返回循环的顶端。如：
{for ( x=3; x&lt;=NF; x++) if ($x&lt;0){print &quot;Bottomed out!&quot;; break}} {for ( x=3; x&lt;=NF; x++) if ($x==0){print &quot;Get next item&quot;; continue}}</li>
<li>next语句从输入文件中读取一行，然后从头开始执行awk脚本。如：
{if ($1 ~/test/){next} else {print} }</li>
<li>exit语句用于结束awk程序，但不会略过END块。退出状态为0代表成功，非零值表示出错。</li>
</ul>
<h3 id="-14-7-"><a href=""></a>14.7. 数组</h3>
<p>awk中的数组的下标可以是数字和字母，称为关联数组。</p>
<h3 id="-14-7-1-"><a href=""></a>14.7.1. 下标与关联数组</h3>
<ul>
<li>用变量作为数组下标。如：$ awk {name[x++]=$2};END{for(i=0;i&lt;NR;i++) print i,name[i]}&#39; test。数组name中的下标是一个自定义变量x，awk初始化x的值为0，在每次使用后增加1。第二个域的值被赋给name数组的各个元素。在END模块中，for循环被用于循环整个数组，从下标为0的元素开始，打印那些存储在数组中的值。因为下标是关健字，所以它不一定从0开始，可以从任何值开始。</li>
<li>special for循环用于读取关联数组中的元素。格式如下：
{for (item in arrayname){ print arrayname[item] } } $ awk &#39;/^tom/{name[NR]=$1}; END{for(i in name){print name[i]}}&#39; test。打印有值的数组元素。打印的顺序是随机的。</li>
<li>用字符串作为下标。如：count[&quot;test&quot;]</li>
<li>用域值作为数组的下标。一种新的for循环方式，for (index_value in array) statement。如:$ awk &#39;{count[$1]++} END{for(name in count) print name,count[name]}&#39; test。该语句将打印$1中字符串出现的次数。它首先以第一个域作数组count的下标，第一个域变化，索引就变化。</li>
<li>delete函数用于删除数组元素。如：$ awk &#39;{line[x++]=$1} END{for(x in line) delete(line[x])}&#39; test。分配给数组line的是第一个域的值，所有记录处理完成后，special for循环将删除每一个元素。<h3 id="-14-8-awk-"><a href=""></a>14.8. awk的内建函数</h3>
</li>
</ul>
<h3 id="-14-8-1-"><a href=""></a>14.8.1. 字符串函数</h3>
<ul>
<li>sub函数匹配记录中最大、最靠左边的子字符串的正则表达式，并用替换字符串替换这些字符串。如果没有指定目标字符串就默认使用整个记录。替换只发生在第一次匹配的时候。格式如下：
sub (regular expression, substitution string): sub (regular expression, substitution string, target string)</li>
</ul>
<p>实例：</p>
<p>$ awk &#39;{ sub(/test/, &quot;mytest&quot;); print }&#39; testfile $ awk &#39;{ sub(/test/, &quot;mytest&quot;); $1}; print }&#39; testfile</p>
<p>第一个例子在整个记录中匹配，替换只发生在第一次匹配发生的时候。如要在整个文件中进行匹配需要用到gsub</p>
<p>第二个例子在整个记录的第一个域中进行匹配，替换只发生在第一次匹配发生的时候。</p>
<ul>
<li>gsub函数作用如sub，但它在整个文档中进行匹配。格式如下：
gsub (regular expression, substitution string) gsub (regular expression, substitution string, target string)</li>
</ul>
<p>实例：</p>
<p>$ awk &#39;{ gsub(/test/, &quot;mytest&quot;); print }&#39; testfile $ awk &#39;{ gsub(/test/, &quot;mytest&quot;), $1 }; print }&#39; testfile</p>
<p>第一个例子在整个文档中匹配test，匹配的都被替换成mytest。</p>
<p>第二个例子在整个文档的第一个域中匹配，所有匹配的都被替换成mytest。</p>
<ul>
<li>index函数返回子字符串第一次被匹配的位置，偏移量从位置1开始。格式如下：
index(string, substring)</li>
</ul>
<p>实例：</p>
<p>$ awk &#39;{ print index(&quot;test&quot;, &quot;mytest&quot;) }&#39; testfile</p>
<p>实例返回test在mytest的位置，结果应该是3。</p>
<ul>
<li>length函数返回记录的字符数。格式如下：
length( string ) length</li>
</ul>
<p>实例：</p>
<p>$ awk &#39;{ print length( &quot;test&quot; ) }&#39; $ awk &#39;{ print length }&#39; testfile</p>
<p>第一个实例返回test字符串的长度。</p>
<p>第二个实例返回testfile文件中第条记录的字符数。</p>
<ul>
<li>substr函数返回从位置1开始的子字符串，如果指定长度超过实际长度，就返回整个字符串。格式如下：
substr( string, starting position ) substr( string, starting position, length of string )</li>
</ul>
<p>实例：</p>
<p>$ awk &#39;{ print substr( &quot;hello world&quot;, 7,11 ) }&#39;</p>
<p>上例截取了world子字符串。</p>
<ul>
<li>match函数返回在字符串中正则表达式位置的索引，如果找不到指定的正则表达式则返回0。match函数会设置内建变量RSTART为字符串中子字符串的开始位置，RLENGTH为到子字符串末尾的字符个数。substr可利于这些变量来截取字符串。函数格式如下：
match( string, regular expression )</li>
</ul>
<p>实例：</p>
<p>$ awk &#39;{start=match(&quot;this is a test&quot;,/[a-z]+$/); print start}&#39; $ awk &#39;{start=match(&quot;this is a test&quot;,/[a-z]+$/); print start, RSTART, RLENGTH }&#39;</p>
<p>第一个实例打印以连续小写字符结尾的开始位置，这里是11。</p>
<p>第二个实例还打印RSTART和RLENGTH变量，这里是11(start)，11(RSTART)，4(RLENGTH)。</p>
<ul>
<li>toupper和tolower函数可用于字符串大小间的转换，该功能只在gawk中有效。格式如下：
toupper( string ) tolower( string )</li>
</ul>
<p>实例：</p>
<p>$ awk &#39;{ print toupper(&quot;test&quot;), tolower(&quot;TEST&quot;) }&#39;</p>
<ul>
<li>split函数可按给定的分隔符把字符串分割为一个数组。如果分隔符没提供，则按当前FS值进行分割。格式如下：
split( string, array, field separator ) split( string, array )</li>
</ul>
<p>实例：</p>
<p>$ awk &#39;{ split( &quot;20:18:00&quot;, time, &quot;:&quot; ); print time[2] }&#39;</p>
<p>上例把时间按冒号分割到time数组内，并显示第二个数组元素18。</p>
<h3 id="-14-8-2-"><a href=""></a>14.8.2. 时间函数</h3>
<ul>
<li>systime函数返回从1970年1月1日开始到当前时间(不计闰年)的整秒数。格式如下：
systime()</li>
</ul>
<p>实例：</p>
<p>$ awk &#39;{ now = systime(); print now }&#39;</p>
<ul>
<li>strftime函数使用C库中的strftime函数格式化时间。格式如下：
systime( [format specification][,timestamp] )</li>
</ul>
<p><a href=""></a></p>
<p><strong>Table 3. 日期和时间格式说明符</strong></p>
<p>格式描述%a星期几的缩写(Sun)%A星期几的完整写法(Sunday)%b月名的缩写(Oct)%B月名的完整写法(October)%c本地日期和时间%d十进制日期%D日期 08/20/99%e日期，如果只有一位会补上一个空格%H用十进制表示24小时格式的小时%I用十进制表示12小时格式的小时%j从1月1日起一年中的第几天%m十进制表示的月份%M十进制表示的分钟%p12小时表示法(AM/PM)%S十进制表示的秒%U十进制表示的一年中的第几个星期(星期天作为一个星期的开始)%w十进制表示的星期几(星期天是0)%W十进制表示的一年中的第几个星期(星期一作为一个星期的开始)%x重新设置本地日期(08/20/99)%X重新设置本地时间(12：00：00)%y两位数字表示的年(99)%Y当前月份%Z时区(PDT)%%百分号(%)</p>
<p>实例：
$ awk &#39;{ now=strftime( &quot;%D&quot;, systime() ); print now }&#39; $ awk &#39;{ now=strftime(&quot;%m/%d/%y&quot;); print now }&#39;</p>
<h3 id="-14-8-3-"><a href=""></a>14.8.3. 内建数学函数</h3>
<p><a href=""></a></p>
<p><strong>Table 4. </strong></p>
<p>函数名称返回值atan2(x,y)y,x范围内的余切cos(x)余弦函数exp(x)求幂int(x)取整log(x)自然对数rand()随机数sin(x)正弦sqrt(x)平方根srand(x)x是rand()函数的种子int(x)取整，过程没有舍入rand()产生一个大于等于0而小于1的随机数</p>
<h3 id="-14-8-4-"><a href=""></a>14.8.4. 自定义函数</h3>
<p>在awk中还可自定义函数，格式如下：</p>
<p>function name ( parameter, parameter, parameter, ... ) { statements return expression /# the return statement and expression are optional }</p>
<h2 id="-15-how-to"><a href=""></a>15. How-to</h2>
<ul>
<li>如何把一行竖排的数据转换成横排？</li>
</ul>
<p>awk &#39;{printf(&quot;%s,&quot;,$1)}&#39; filename</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/unix/">unix</a></li></span></span> | <span class="tags">Tagged <a href="/tags/unix/" class="label label-primary">unix</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:43"datetime="2014-03-07 09:54:43"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-unix--Awk学习笔记/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-unix--Awk学习笔记" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-gitgithub--Git详解之二：Git基础/">Git详解之二：Git基础</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:43.000Z"> <a href="/2014/02/02/2014-02-02-gitgithub--Git详解之二：Git基础/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="git-git-">Git详解之二：Git基础</h1>
<p>原文：<a href="http://git-scm.com/book/zh" target="_blank">《Pro Git》</a></p>
<p><strong>Git 基础</strong></p>
<p>读完本章你就能上手使用 Git 了（<a href="http://www.jobbole.com/" title="1" target="_blank">伯乐</a>在线注：如果你对Git还不了解，建议从本<a href="http://blog.jobbole.com/25775/" target="_blank">Git</a>系列<a href="http://blog.jobbole.com/25775/" target="_blank">第一篇文章</a>开始阅读）。本章将介绍几个最基本的，也是最常用的 Git 命令，以后绝大多数时间里用到的也就是这几个命令。读完本章，你就能初始化一个新的代码仓库，做一些适当配置；开始或停止跟踪某些文件；暂存或提交某些更 新。我们还会展示如何让 Git 忽略某些文件，或是名称符合特定模式的文件；如何既快且容易地撤消犯下的小错误；如何浏览项目的更新历史，查看某两次更新之间的差异；以及如何从远程仓库 拉数据下来或者推数据上去。</p>
<p><strong>2.1  取得项目的 Git 仓库</strong></p>
<p>有两种取得 Git 项目仓库的方法。第一种是在现存的目录下，通过导入所有文件来创建新的 Git 仓库。第二种是从已有的 Git 仓库克隆出一个新的镜像仓库来。</p>
<p><strong>在工作目录中初始化新仓库</strong></p>
<p>要对现有的某个项目开始用 Git 管理，只需到此项目所在的目录，执行：
1$ git init</p>
<p>初始化后，在当前目录下会出现一个名为 .git 的目录，所有 Git 需要的数据和资源都存放在这个目录中。不过目前，仅仅是按照既有的结构框架初始化好了里边所有的文件和目录，但我们还没有开始跟踪管理项目中的任何一个文件。（在第九章我们会详细说明刚才创建的</p>
<p>.git
 目录中究竟有哪些文件，以及都起些什么作用。）</p>
<p>如果当前目录下有几个文件想要纳入版本控制，需要先用 git add 命令告诉 Git 开始对这些文件进行跟踪，然后提交：
1</p>
<p>2
3$ git add /*.c</p>
<p>$ git add README
$ git commit -m</p>
<p>&#39;initial project version&#39;</p>
<p>稍后我们再逐一解释每条命令的意思。不过现在，你已经得到了一个实际维护着若干文件的 Git 仓库。</p>
<p><strong>从现有仓库克隆</strong></p>
<p>如果想对某个开源项目出一份力，可以先把该项目的 Git 仓库复制一份出来，这就需要用到 git clone 命令。如果你熟悉其他的 VCS 比如 Subversion，你可能已经注意到这里使用的是 clone 而不是 checkout。这是个非常重要的差别，Git 收取的是项目历史的所有数据（每一个文件的每一个版本），服务器上有的数据克隆之后本地也都有了。实际上，即便服务器的磁盘发生故障，用任何一个克隆出来 的客户端都可以重建服务器上的仓库，回到当初克隆时的状态（虽然可能会丢失某些服务器端的挂钩设置，但所有版本的数据仍旧还在，有关细节请参考第四章）。<a href="http://blog.jobbole.com/6492/" title="GitHub如何运作：时间并不决定一切" target="_blank">GitHub</a></p>
<p>克隆仓库的命令格式为 </p>
<p>git clone [url]
。比如，要克隆 Ruby 语言的 Git 代码仓库 Grit，可以用下面的命令：
1$ git clone git:</p>
<p>//github</p>
<p>.com</p>
<p>/schacon/grit</p>
<p>.git</p>
<p>这会在当前目录下创建一个名为“grit”的目录，其中包含一个 </p>
<p>.git
 的目录，用于保存下载下来的所有版本记录，然后从中取出最新版本的文件拷贝。如果进入这个新建的</p>
<p>grit
 目录，你会看到项目中的所有文件已经在里边了，准备好后续的开发和使用。如果希望在克隆的时候，自己定义要新建的项目目录名称，可以在上面的命令末尾指定新的名字：</p>
<p>1$ git clone git:</p>
<p>//github</p>
<p>.com</p>
<p>/schacon/grit</p>
<p>.git mygrit</p>
<p>唯一的差别就是，现在新建的目录成了 mygrit，其他的都和上边的一样。</p>
<p>Git 支持许多数据传输协议。之前的例子使用的是 </p>
<p>git://
 协议，不过你也可以用 </p>
<p>http(s)://
 或者</p>
<p>user@server:/path.git
表示的 SSH 传输协议。我们会在第四章详细介绍所有这些协议在服务器端该如何配置使用，以及各种方式之间的利弊。</p>
<p><strong>2.2  记录每次更新到仓库</strong></p>
<p>现在我们手上已经有了一个真实项目的 Git 仓库，并从这个仓库中取出了所有文件的工作拷贝。接下来，对这些文件作些修改，在完成了一个阶段的目标之后，提交本次更新到仓库。</p>
<p>请记住，工作目录下面的所有文件都不外乎这两种状态：已跟踪或未跟踪。已跟踪的文件是指本来就被纳入版本控制管理的文件，在上次快照中有它们的记 录，工作一段时间后，它们的状态可能是未更新，已修改或者已放入暂存区。而所有其他文件都属于未跟踪文件。它们既没有上次更新时的快照，也不在当前的暂存 区域。初次克隆某个仓库时，工作目录中的所有文件都属于已跟踪文件，且状态为未修改。</p>
<p>在编辑过某些文件之后，Git 将这些文件标为已修改。我们逐步把这些修改过的文件放到暂存区域，直到最后一次性提交所有这些暂存起来的文件，如此重复。所以使用 Git 时的文件状态变化周期如图 2-1 所示。</p>
<p><a href="http://cdn2.jobbole.com/2012/08/20120201121432_845.png" title="Git详解之二：Git基础" target="_blank"><img src="&quot;Git详解之二：Git基础&quot;" alt="Git详解之二：Git基础"></a></p>
<p>图 2-1. 文件的状态变化周期</p>
<p><strong>检查当前文件状态</strong></p>
<p>要确定哪些文件当前处于什么状态，可以用 git status 命令。如果在克隆仓库之后立即执行此命令，会看到类似这样的输出：
1$ git status</p>
<p>/# On branch master nothing to commit (working directory clean)</p>
<p>这说明你现在的工作目录相当干净。换句话说，当前没有任何跟踪着的文件，也没有任何文件在上次提交后更改过。此外，上面的信息还表明，当前目录下没 有出现任何处于未跟踪的新文件，否则 Git 会在这里列出来。最后，该命令还显示了当前所在的分支是 master，这是默认的分支名称，实际是可以修改的，现在先不用考虑。下一章我们就会详细讨论分支和引用。</p>
<p>现在让我们用 vim 编辑一个新文件 README，保存退出后运行 </p>
<p>git status
 会看到该文件出现在未跟踪文件列表中：
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
$ vim README</p>
<p>$ git status
/# On branch master</p>
<p>/# Untracked files:
/#   (use &quot;git add</p>
<p>...&quot; to include</p>
<p>in</p>
<p>what will be committed)</p>
<p>/#
/#   README</p>
<p>nothing added to commit but untracked files present (use</p>
<p>&quot;git add&quot;</p>
<p>to track)</p>
<p>就是在“Untracked files”这行下面。Git 不会自动将之纳入跟踪范围，除非你明明白白地告诉它“我需要跟踪该文件”，因而不用担心把临时文件什么的也归入版本管理。不过现在的例子中，我们确实想要跟踪管理 README 这个文件。</p>
<p><strong>跟踪新文件</strong></p>
<p>使用命令 </p>
<p>git add
 开始跟踪一个新文件。所以，要跟踪 README 文件，运行：
1$ git add README</p>
<p>此时再运行 </p>
<p>git status
 命令，会看到 README 文件已被跟踪，并处于暂存状态：</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9$ git status</p>
<p>/# On branch master
/# Changes to be committed:</p>
<p>/#   (use &quot;git reset HEAD</p>
<p>...&quot; to unstage)
/#</p>
<p>/#   new file:   README
/#</p>
<p>只要在 “Changes to be committed” 这行下面的，就说明是已暂存状态。如果此时提交，那么该文件此时此刻的版本将被留存在历史记录中。你可能会想起之前我们使用</p>
<p>git init
 后就运行了 </p>
<p>git add
 命令，开始跟踪当前目录下的文件。在 </p>
<p>git add
 后面可以指明要跟踪的文件或目录路径。如果是目录的话，就说明要递归跟踪该目录下的所有文件。（译注：其实</p>
<p>git add
 的潜台词就是把目标文件快照放入暂存区域，也就是 add file into staged area，同时未曾跟踪过的文件标记为需要跟踪。这样就好理解后续 add 操作的实际意义了。）</p>
<p><strong>暂存已修改文件</strong></p>
<p>现在我们修改下之前已跟踪过的文件 </p>
<p>benchmarks.rb
，然后再次运行 </p>
<p>status
 命令，会看到这样的状态报告：
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13</p>
<p>14
15</p>
<p>16
$ git status</p>
<p>/# On branch master
/# Changes to be committed:</p>
<p>/#   (use &quot;git reset HEAD</p>
<p>...&quot; to unstage)
/#</p>
<p>/#   new file:   README
/#</p>
<p>/# Changed but not updated:
/#   (use &quot;git add</p>
<p>...&quot; to update what will be committed)</p>
<p>/#
/#   modified:   benchmarks.rb</p>
<p>/#</p>
<p>文件 benchmarks.rb 出现在 “Changed but not updated” 这行下面，说明已跟踪文件的内容发生了变化，但还没有放到暂存区。要暂存这次更新，需要运行</p>
<p>git add
 命令（这是个多功能命令，根据目标文件的状态不同，此命令的效果也不同：可以用它开始跟踪新文件，或者把已跟踪的文件放到暂存区，还能用于合并时把有冲突的文件标记为已解决状态等）。现在让我们运行</p>
<p>git add
 将 benchmarks.rb 放到暂存区，然后再看看 </p>
<p>git status
 的输出：</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11$ git add benchmarks.rb</p>
<p>$ git status
/# On branch master</p>
<p>/# Changes to be committed:
/#   (use &quot;git reset HEAD</p>
<p>...&quot; to unstage)</p>
<p>/#
/#   new file:   README</p>
<p>/#   modified:   benchmarks.rb
/#</p>
<p>现在两个文件都已暂存，下次提交时就会一并记录到仓库。假设此时，你想要在 benchmarks.rb 里再加条注释，重新编辑存盘后，准备好提交。不过且慢，再运行</p>
<p>git status
 看看：</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13</p>
<p>14
15</p>
<p>16
17</p>
<p>18
$ vim benchmarks.rb</p>
<p>$ git status
/# On branch master</p>
<p>/# Changes to be committed:
/#   (use &quot;git reset HEAD</p>
<p>...&quot; to unstage)</p>
<p>/#
/#   new file:   README</p>
<p>/#   modified:   benchmarks.rb
/#</p>
<p>/# Changed but not updated:
/#   (use &quot;git add</p>
<p>...&quot; to update what will be committed)</p>
<p>/#
/#   modified:   benchmarks.rb</p>
<p>/#</p>
<p>怎么回事？benchmarks.rb 文件出现了两次！一次算未暂存，一次算已暂存，这怎么可能呢？好吧，实际上 Git 只不过暂存了你运行 git add 命令时的版本，如果现在提交，那么提交的是添加注释前的版本，而非当前工作目录中的版本。所以，运行了</p>
<p>git add
 之后又作了修订的文件，需要重新运行 </p>
<p>git add
 把最新版本重新暂存起来：</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11$ git add benchmarks.rb</p>
<p>$ git status
/# On branch master</p>
<p>/# Changes to be committed:
/#   (use &quot;git reset HEAD</p>
<p>...&quot; to unstage)</p>
<p>/#
/#   new file:   README</p>
<p>/#   modified:   benchmarks.rb
/#</p>
<p><strong>忽略某些文件</strong></p>
<p>一般我们总会有些文件无需纳入 Git 的管理，也不希望它们总出现在未跟踪文件列表。通常都是些自动生成的文件，比如日志文件，或者编译过程中创建的临时文件等。我们可以创建一个名为 .gitignore 的文件，列出要忽略的文件模式。来看一个实际的例子：
1$</p>
<p>cat</p>
<p>.gitignore /<em>.[oa] /</em>~</p>
<p>第一行告诉 Git 忽略所有以 .o 或 .a 结尾的文件。一般这类对象文件和存档文件都是编译过程中出现的，我们用不着跟踪它们的版本。第二行告诉 Git 忽略所有以波浪符（</p>
<p>~
）结尾的文件，许多文本编辑软件（比如 Emacs）都用这样的文件名保存副本。此外，你可能还需要忽略 log，tmp 或者 pid 目录，以及自动生成的文档等等。要养成一开始就设置好 .gitignore 文件的习惯，以免将来误提交这类无用的文件。</p>
<p>文件 .gitignore 的格式规范如下：</p>
<p>● 所有空行或者以注释符号 ＃ 开头的行都会被 Git 忽略。</p>
<p>● 可以使用标准的 glob 模式匹配。 /* 匹配模式最后跟反斜杠（</p>
<p>/
）说明要忽略的是目录。 /* 要忽略指定模式以外的文件或目录，可以在模式前加上惊叹号（</p>
<p>!
）取反。</p>
<p>所谓的 glob 模式是指 shell 所使用的简化了的正则表达式。星号（</p>
<p>/*
）匹配零个或多个任意字符；</p>
<p>[abc]
 匹配任何一个列在方括号中的字符（这个例子要么匹配一个 a，要么匹配一个 b，要么匹配一个 c）；问号（</p>
<p>?
）只匹配一个任意字符；如果在方括号中使用短划线分隔两个字符，表示所有在这两个字符范围内的都可以匹配（比如</p>
<p>[0-9]
 表示匹配所有 0 到 9 的数字）。</p>
<p>我们再看一个 .gitignore 文件的例子：
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
/# 此为注释 – 将被 Git 忽略</p>
<p>/*.a      </p>
<p>/# 忽略所有 .a 结尾的文件
!lib.a   </p>
<p>/# 但 lib.a 除外</p>
<p>/TODO</p>
<p>/# 仅仅忽略项目根目录下的 TODO 文件，不包括 subdir/TODO
build/   </p>
<p>/# 忽略 build/ 目录下的所有文件</p>
<p>doc//*.txt</p>
<p>/# 会忽略 doc/notes.txt 但不包括 doc/server/arch.txt</p>
<p><strong>查看已暂存和未暂存的更新</strong></p>
<p>实际上 </p>
<p>git status
 的显示比较简单，仅仅是列出了修改过的文件，如果要查看具体修改了什么地方，可以用 </p>
<p>git diff
 命令。稍后我们会详细介绍</p>
<p>git diff
，不过现在，它已经能回答我们的两个问题了：当前做的哪些更新还没有暂存？有哪些更新已经暂存起来准备好了下次提交？ </p>
<p>git diff
 会使用文件补丁的格式显示具体添加和删除的行。</p>
<p>假如再次修改 README 文件后暂存，然后编辑 benchmarks.rb 文件后先别暂存，运行 </p>
<p>status
 命令，会看到：
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13</p>
<p>14
15</p>
<p>16
$ git status</p>
<p>/# On branch master
/# Changes to be committed:</p>
<p>/#   (use &quot;git reset HEAD</p>
<p>...&quot; to unstage)
/#</p>
<p>/#   new file:   README
/#</p>
<p>/# Changed but not updated:
/#   (use &quot;git add</p>
<p>...&quot; to update what will be committed)</p>
<p>/#
/#   modified:   benchmarks.rb</p>
<p>/#</p>
<p>要查看尚未暂存的文件更新了哪些部分，不加参数直接输入 </p>
<p>git diff
：</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13</p>
<p>14
15</p>
<p>16
$ git</p>
<p>diff</p>
<p>diff</p>
<p>--git a</p>
<p>/benchmarks</p>
<p>.rb b</p>
<p>/benchmarks</p>
<p>.rb
index 3cb747f..da65585 100644</p>
<p>--- a</p>
<p>/benchmarks</p>
<p>.rb
+++ b</p>
<p>/benchmarks</p>
<p>.rb</p>
<p>@@ -36,6 +36,10 @@ def main</p>
<p>@commit.parents[0].parents[0].parents[0]</p>
<p>end</p>
<ul>
<li>run_code(x,</li>
</ul>
<p>&#39;commits 1&#39;</p>
<p>)</p>
<p>do</p>
<ul>
<li><p>git.commits.size</p>
</li>
<li><p>end
+</p>
</li>
</ul>
<p>run_code(x,</p>
<p>&#39;commits 2&#39;</p>
<p>)</p>
<p>do</p>
<p>log = git.commits(</p>
<p>&#39;master&#39;</p>
<p>, 15)</p>
<p>log.size</p>
<p>此命令比较的是工作目录中当前文件和暂存区域快照之间的差异，也就是修改之后还没有暂存起来的变化内容。</p>
<p>若要看已经暂存起来的文件和上次提交时的快照之间的差异，可以用 </p>
<p>git diff --cached
 命令。（Git 1.6.1 及更高版本还允许使用</p>
<p>git diff --staged
，效果是相同的，但更好记些。）来看看实际的效果：
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
$ git</p>
<p>diff</p>
<p>--cached</p>
<p>diff</p>
<p>--git a</p>
<p>/README</p>
<p>b</p>
<p>/README
new</p>
<p>file</p>
<p>mode 100644</p>
<h2 id="index-0000000-03902a1">index 0000000..03902a1</h2>
<p>/dev/null</p>
<p>+++ b</p>
<p>/README2
@@ -0,0 +1,5 @@</p>
<p>+grit</p>
<ul>
<li><p>by Tom Preston-Werner, Chris Wanstrath</p>
</li>
<li><p>http:</p>
</li>
</ul>
<p>//github</p>
<p>.com</p>
<p>/mojombo/grit
+</p>
<p>+Grit is a Ruby library</p>
<p>for</p>
<p>extracting information from a Git repository</p>
<p>请注意，单单 </p>
<p>git diff
 不过是显示还没有暂存起来的改动，而不是这次工作和上次提交之间的差异。所以有时候你一下子暂存了所有更新过的文件后，运行</p>
<p>git diff
 后却什么也没有，就是这个原因。</p>
<p>像之前说的，暂存 benchmarks.rb 后再编辑，运行 </p>
<p>git status
 会看到暂存前后的两个版本：
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13$ git add benchmarks.rb</p>
<p>$</p>
<p>echo</p>
<p>&#39;/# test line&#39;</p>
<blockquote>
<blockquote>
<p>benchmarks.rb
$ git status</p>
</blockquote>
</blockquote>
<p>/# On branch master
/#</p>
<p>/# Changes to be committed:
/#</p>
<p>/#   modified:   benchmarks.rb
/#</p>
<p>/# Changed but not updated:
/#</p>
<p>/#   modified:   benchmarks.rb
/#</p>
<p>现在运行 </p>
<p>git diff
 看暂存前后的变化：</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
$ git</p>
<p>diff</p>
<p>diff</p>
<p>--git a</p>
<p>/benchmarks</p>
<p>.rb b</p>
<p>/benchmarks</p>
<p>.rb
index e445e28..86b2f7c 100644</p>
<p>--- a</p>
<p>/benchmarks</p>
<p>.rb
+++ b</p>
<p>/benchmarks</p>
<p>.rb</p>
<p>@@ -127,3 +127,4 @@ end</p>
<p>main()</p>
<p>/#/#pp Grit::GitRuby.cache_client.stats</p>
<p>+</p>
<p>/# test line</p>
<p>然后用 </p>
<p>git diff --cached
 查看已经暂存起来的变化：</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13</p>
<p>14
15</p>
<p>16
$ git</p>
<p>diff</p>
<p>--cached</p>
<p>diff</p>
<p>--git a</p>
<p>/benchmarks</p>
<p>.rb b</p>
<p>/benchmarks</p>
<p>.rb
index 3cb747f..e445e28 100644</p>
<p>--- a</p>
<p>/benchmarks</p>
<p>.rb
+++ b</p>
<p>/benchmarks</p>
<p>.rb</p>
<p>@@ -36,6 +36,10 @@ def main</p>
<p>@commit.parents[0].parents[0].parents[0]</p>
<p>end</p>
<ul>
<li>run_code(x,</li>
</ul>
<p>&#39;commits 1&#39;</p>
<p>)</p>
<p>do</p>
<ul>
<li><p>git.commits.size</p>
</li>
<li><p>end
+</p>
</li>
</ul>
<p>run_code(x,</p>
<p>&#39;commits 2&#39;</p>
<p>)</p>
<p>do</p>
<p>log = git.commits(</p>
<p>&#39;master&#39;</p>
<p>, 15)</p>
<p>log.size</p>
<p><strong>提交更新</strong></p>
<p>现在的暂存区域已经准备妥当可以提交了。在此之前，请一定要确认还有什么修改过的或新建的文件还没有 </p>
<p>git add
 过，否则提交的时候不会记录这些还没暂存起来的变化。所以，每次准备提交前，先用</p>
<p>git status
 看下，是不是都已暂存起来了，然后再运行提交命令 </p>
<p>git commit
：
1$ git commit</p>
<p>这种方式会启动文本编辑器以便输入本次提交的说明。（默认会启用 shell 的环境变量 </p>
<p>$EDITOR
 所指定的软件，一般都是 vim 或 emacs。当然也可以按照第一章介绍的方式，使用</p>
<p>git config --global core.editor
 命令设定你喜欢的编辑软件。）</p>
<p>编辑器会显示类似下面的文本信息（本例选用 Vim 的屏显方式展示）：
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13</p>
<p>14
/# Please enter the commit message for your changes. Lines starting</p>
<p>/# with &#39;/#&#39; will be ignored, and an empty message aborts the commit.
/# On branch master</p>
<p>/# Changes to be committed:
/#   (use &quot;git reset HEAD</p>
<p>...&quot; to unstage)</p>
<p>/#
/#       new file:   README</p>
<p>/#       modified:   benchmarks.rb
~</p>
<p>~
~</p>
<p>&quot;.git/COMMIT_EDITMSG&quot;</p>
<p>10L, 283C</p>
<p>可以看到，默认的提交消息包含最后一次运行 </p>
<p>git status
 的输出，放在注释行里，另外开头还有一空行，供你输入提交说明。你完全可以去掉这些注释行，不过留着也没关系，多少能帮你回想起这次更新的内容有哪些。（如果觉得这还不够，可以用</p>
<p>-v
 选项将修改差异的每一行都包含到注释中来。）退出编辑器时，Git 会丢掉注释行，将说明内容和本次更新提交到仓库。</p>
<p>另外也可以用 -m 参数后跟提交说明的方式，在一行命令中提交更新：
1</p>
<p>2
3</p>
<p>4
$ git commit -m</p>
<p>&quot;Story 182: Fix benchmarks for speed&quot;</p>
<p>[master]: created 463dc4f:</p>
<p>&quot;Fix benchmarks for speed&quot;</p>
<p>2 files changed, 3 insertions(+), 0 deletions(-)</p>
<p>create mode 100644 README</p>
<p>好，现在你已经创建了第一个提交！可以看到，提交后它会告诉你，当前是在哪个分支（master）提交的，本次提交的完整 SHA-1 校验和是什么（</p>
<p>463dc4f
），以及在本次提交中，有多少文件修订过，多少行添改和删改过。</p>
<p>记住，提交时记录的是放在暂存区域的快照，任何还未暂存的仍然保持已修改状态，可以在下次提交时纳入版本管理。每一次运行提交操作，都是对你项目作一次快照，以后可以回到这个状态，或者进行比较。</p>
<p><strong>跳过使用暂存区域</strong></p>
<p>尽管使用暂存区域的方式可以精心准备要提交的细节，但有时候这么做略显繁琐。Git 提供了一个跳过使用暂存区域的方式，只要在提交的时候，给 </p>
<p>git commit
 加上</p>
<p>-a
 选项，Git 就会自动把所有已经跟踪过的文件暂存起来一并提交，从而跳过 </p>
<p>git add
 步骤：
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
$ git status</p>
<p>/# On branch master
/#</p>
<p>/# Changed but not updated:
/#</p>
<p>/#   modified:   benchmarks.rb
/#</p>
<p>$ git commit -a -m</p>
<p>&#39;added new benchmarks&#39;
[master 83e38c7] added new benchmarks</p>
<p>1 files changed, 5 insertions(+), 0 deletions(-)</p>
<p>看到了吗？提交之前不再需要 </p>
<p>git add
 文件 benchmarks.rb 了。</p>
<p><strong>移除文件</strong></p>
<p>要从 Git 中移除某个文件，就必须要从已跟踪文件清单中移除（确切地说，是从暂存区域移除），然后提交。可以用 </p>
<p>git rm
 命令完成此项工作，并连带从工作目录中删除指定的文件，这样以后就不会出现在未跟踪文件清单中了。</p>
<p>如果只是简单地从工作目录中手工删除文件，运行 </p>
<p>git status
 时就会在 “Changed but not updated” 部分（也就是<em>未暂存</em>清单）看到：
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11$</p>
<p>rm</p>
<p>grit.gemspec</p>
<p>$ git status
/# On branch master</p>
<p>/#
/# Changed but not updated:</p>
<p>/#   (use &quot;git add/rm</p>
<p>...&quot; to update what will be committed)
/#</p>
<p>/#       deleted:    grit.gemspec
/#</p>
<p>然后再运行 </p>
<p>git rm
 记录此次移除文件的操作：</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
$ git</p>
<p>rm</p>
<p>grit.gemspec</p>
<p>rm</p>
<p>&#39;grit.gemspec&#39;
$ git status</p>
<p>/# On branch master
/#</p>
<p>/# Changes to be committed:
/#   (use &quot;git reset HEAD</p>
<p>...&quot; to unstage)</p>
<p>/#
/#       deleted:    grit.gemspec</p>
<p>/#</p>
<p>最后提交的时候，该文件就不再纳入版本管理了。如果删除之前修改过并且已经放到暂存区域的话，则必须要用强制删除选项 </p>
<p>-f
（译注：即 force 的首字母），以防误删除文件后丢失修改的内容。</p>
<p>另外一种情况是，我们想把文件从 Git 仓库中删除（亦即从暂存区域移除），但仍然希望保留在当前工作目录中。换句话说，仅是从跟踪清单中删除。比如一些大型日志文件或者一堆</p>
<p>.a
 编译文件，不小心纳入仓库后，要移除跟踪但不删除文件，以便稍后在 </p>
<p>.gitignore
 文件中补上，用 </p>
<p>--cached
 选项即可：
1$ git</p>
<p>rm</p>
<p>--cached readme.txt</p>
<p>后面可以列出文件或者目录的名字，也可以使用 glob 模式。比方说：</p>
<p>1$ git</p>
<p>rm</p>
<p>log/\/*.log</p>
<p>注意到星号 </p>
<p>/*
 之前的反斜杠 </p>
<p>\
，因为 Git 有它自己的文件模式扩展匹配方式，所以我们不用 shell 来帮忙展开（译注：实际上不加反斜杠也可以运行，只不过按照 shell 扩展的话，仅仅删除指定目录下的文件而不会递归匹配。上面的例子本来就指定了目录，所以效果等同，但下面的例子就会用递归方式匹配，所以必须加反斜 杠。）。此命令删除所有</p>
<p>log/
 目录下扩展名为 </p>
<p>.log
 的文件。类似的比如：</p>
<p>1$ git</p>
<p>rm</p>
<p>\/*~</p>
<p>会递归删除当前目录及其子目录中所有 </p>
<p>~
 结尾的文件。</p>
<p><strong>移动文件</strong></p>
<p>不像其他的 VCS 系统，Git 并不跟踪文件移动操作。如果在 Git 中重命名了某个文件，仓库中存储的元数据并不会体现出这是一次改名操作。不过 Git 非常聪明，它会推断出究竟发生了什么，至于具体是如何做到的，我们稍后再谈。</p>
<p>既然如此，当你看到 Git 的 </p>
<p>mv
 命令时一定会困惑不已。要在 Git 中对文件改名，可以这么做：
1$ git</p>
<p>mv</p>
<p>file_from file_to</p>
<p>它会恰如预期般正常工作。实际上，即便此时查看状态信息，也会明白无误地看到关于重命名操作的说明：</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
$ git</p>
<p>mv</p>
<p>README.txt README</p>
<p>$ git status
/# On branch master</p>
<p>/# Your branch is ahead of &#39;origin/master&#39; by 1 commit.
/#</p>
<p>/# Changes to be committed:
/#   (use &quot;git reset HEAD</p>
<p>...&quot; to unstage)</p>
<p>/#
/#       renamed:    README.txt -&gt; README</p>
<p>/#</p>
<p>其实，运行 </p>
<p>git mv
 就相当于运行了下面三条命令：</p>
<p>1$</p>
<p>mv</p>
<p>README.txt README $ git</p>
<p>rm</p>
<p>README.txt $ git add README</p>
<p>如此分开操作，Git 也会意识到这是一次改名，所以不管何种方式都一样。当然，直接用 </p>
<p>git mv
 轻便得多，不过有时候用其他工具批处理改名的话，要记得在提交前删除老的文件名，再添加新的文件名。</p>
<p><strong>2.3  查看提交历史</strong></p>
<p>在提交了若干更新之后，又或者克隆了某个项目，想回顾下提交历史，可以使用 </p>
<p>git log
 命令查看。</p>
<p>接下来的例子会用我专门用于演示的 simplegit 项目，运行下面的命令获取该项目源代码：
1git clone git:</p>
<p>//github</p>
<p>.com</p>
<p>/schacon/simplegit-progit</p>
<p>.git</p>
<p>然后在此项目中运行 </p>
<p>git log
，应该会看到下面的输出：</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13</p>
<p>14
15</p>
<p>16
17</p>
<p>18
19</p>
<p>20
21$ git log</p>
<p>commit ca82a6dff817ec66f44342007202690a93763949
Author: Scott Chacon</p>
<p>Date:   Mon Mar 17 21:52:11 2008 -0700</p>
<p>changed the version number</p>
<p>commit 085bb3bcb608e1e8451d4b2432f8ecbe6306e7e7</p>
<p>Author: Scott Chacon</p>
<p>Date:   Sat Mar 15 16:40:33 2008 -0700</p>
<p>removed unnecessary</p>
<p>test</p>
<p>code</p>
<p>commit a11bef06a3f659402fe7563abf99ad00de2209e6
Author: Scott Chacon</p>
<p>Date:   Sat Mar 15 10:31:28 2008 -0700</p>
<p>first commit</p>
<p>默认不用任何参数的话，</p>
<p>git log
 会按提交时间列出所有的更新，最近的更新排在最上面。看到了吗，每次更新都有一个 SHA-1 校验和、作者的名字和电子邮件地址、提交时间，最后缩进一个段落显示提交说明。</p>
<p>git log
 有许多选项可以帮助你搜寻感兴趣的提交，接下来我们介绍些最常用的。</p>
<p>我们常用 </p>
<p>-p
 选项展开显示每次提交的内容差异，用 </p>
<p>-2
 则仅显示最近的两次更新：
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13</p>
<p>14
15</p>
<p>16
17</p>
<p>18
19</p>
<p>20
21</p>
<p>22
23</p>
<p>24
25</p>
<p>26
27</p>
<p>28
29</p>
<p>30
31</p>
<p>32
33</p>
<p>34
35</p>
<p>36
37</p>
<p>38
39$ git log -p -2</p>
<p>commit ca82a6dff817ec66f44342007202690a93763949
Author: Scott Chacon</p>
<p>Date:   Mon Mar 17 21:52:11 2008 -0700</p>
<p>changed the version number</p>
<p>diff</p>
<p>--git a</p>
<p>/Rakefile</p>
<p>b</p>
<p>/Rakefile</p>
<p>index a874b73..8f94139 100644
--- a</p>
<p>/Rakefile</p>
<p>+++ b</p>
<p>/Rakefile
@@ -5,7 +5,7 @@ require</p>
<p>&#39;rake/gempackagetask&#39;</p>
<p>spec = Gem::Specification.new</p>
<p>do</p>
<p>|s|</p>
<ul>
<li>s.version   =  </li>
</ul>
<p>&quot;0.1.0&quot;</p>
<ul>
<li>s.version   =  </li>
</ul>
<p>&quot;0.1.1&quot;</p>
<p>s.author    =  </p>
<p>&quot;Scott Chacon&quot;</p>
<p>commit 085bb3bcb608e1e8451d4b2432f8ecbe6306e7e7</p>
<p>Author: Scott Chacon</p>
<p>Date:   Sat Mar 15 16:40:33 2008 -0700</p>
<p>removed unnecessary</p>
<p>test</p>
<p>code</p>
<p>diff</p>
<p>--git a</p>
<p>/lib/simplegit</p>
<p>.rb b</p>
<p>/lib/simplegit</p>
<p>.rb
index a0a60ae..47c6340 100644</p>
<p>--- a</p>
<p>/lib/simplegit</p>
<p>.rb
+++ b</p>
<p>/lib/simplegit</p>
<p>.rb</p>
<p>@@ -18,8 +18,3 @@ class SimpleGit</p>
<p>end</p>
<p>end</p>
<p>-
-</p>
<p>if</p>
<p>$0 == <strong>FILE</strong></p>
<ul>
<li>git = SimpleGit.new</li>
<li>puts git.show</li>
</ul>
<p>-end
\ No newline at end of</p>
<p>file</p>
<p>在做代码审查，或者要快速浏览其他协作者提交的更新都作了哪些改动时，就可以用这个选项。此外，还有许多摘要选项可以用，比如 </p>
<p>--stat
，仅显示简要的增改行数统计：</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13</p>
<p>14
15</p>
<p>16
17</p>
<p>18
19</p>
<p>20
21</p>
<p>22
23</p>
<p>24
25</p>
<p>26
27</p>
<p>28
29</p>
<p>30
31</p>
<p>32
$ git log --stat</p>
<p>commit ca82a6dff817ec66f44342007202690a93763949
Author: Scott Chacon</p>
<p>Date:   Mon Mar 17 21:52:11 2008 -0700</p>
<p>changed the version number</p>
<p>Rakefile |    2 +-</p>
<p>1 files changed, 1 insertions(+), 1 deletions(-)</p>
<p>commit 085bb3bcb608e1e8451d4b2432f8ecbe6306e7e7
Author: Scott Chacon</p>
<p>Date:   Sat Mar 15 16:40:33 2008 -0700</p>
<p>removed unnecessary</p>
<p>test</p>
<p>code</p>
<p>lib</p>
<p>/simplegit</p>
<p>.rb |    5 -----</p>
<p>1 files changed, 0 insertions(+), 5 deletions(-)</p>
<p>commit a11bef06a3f659402fe7563abf99ad00de2209e6
Author: Scott Chacon</p>
<p>Date:   Sat Mar 15 10:31:28 2008 -0700</p>
<p>first commit</p>
<p>README           |    6 ++++++</p>
<p>Rakefile         |   23 +++++++++++++++++++++++</p>
<p>lib</p>
<p>/simplegit</p>
<p>.rb |   25 +++++++++++++++++++++++++</p>
<p>3 files changed, 54 insertions(+), 0 deletions(-)</p>
<p>每个提交都列出了修改过的文件，以及其中添加和移除的行数，并在最后列出所有增减行数小计。还有个常用的 </p>
<p>--pretty
 选项，可以指定使用完全不同于默认格式的方式展示提交历史。比如用</p>
<p>oneline
 将每个提交放在一行显示，这在提交数很大时非常有用。另外还有 </p>
<p>short
，</p>
<p>full
 和</p>
<p>fuller
 可以用，展示的信息或多或少有些不同，请自己动手实践一下看看效果如何。</p>
<p>1</p>
<p>2
3</p>
<p>4
$ git log --pretty=oneline</p>
<p>ca82a6dff817ec66f44342007202690a93763949 changed the version number
085bb3bcb608e1e8451d4b2432f8ecbe6306e7e7 removed unnecessary</p>
<p>test</p>
<p>code</p>
<p>a11bef06a3f659402fe7563abf99ad00de2209e6 first commit</p>
<p>但最有意思的是 </p>
<p>format
，可以定制要显示的记录格式，这样的输出便于后期编程提取分析，像这样：</p>
<p>1</p>
<p>2
3</p>
<p>4
$ git log --pretty=</p>
<p>format</p>
<p>:</p>
<p>&quot;%h - %an, %ar : %s&quot;</p>
<p>ca82a6d - Scott Chacon, 11 months ago : changed the version number
085bb3b - Scott Chacon, 11 months ago : removed unnecessary</p>
<p>test</p>
<p>code</p>
<p>a11bef0 - Scott Chacon, 11 months ago : first commit</p>
<p>表 2-1 列出了常用的格式占位符写法及其代表的意义。</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13</p>
<p>14
15</p>
<p>16
选项   说明</p>
<p>%H  提交对象（commit）的完整哈希字串
%h  提交对象的简短哈希字串</p>
<p>%T  树对象（tree）的完整哈希字串
%t  树对象的简短哈希字串</p>
<p>%P  父对象（parent）的完整哈希字串
%p  父对象的简短哈希字串</p>
<p>%an 作者（author）的名字
%ae 作者的电子邮件地址</p>
<p>%ad 作者修订日期（可以用 -</p>
<p>date</p>
<p>= 选项定制格式）
%ar 作者修订日期，按多久以前的方式显示</p>
<p>%cn 提交者(committer)的名字
%ce 提交者的电子邮件地址</p>
<p>%</p>
<p>cd</p>
<p>提交日期
%cr 提交日期，按多久以前的方式显示</p>
<p>%s  提交说明</p>
<p>你一定奇怪<em>作者（author）</em>和<em>提交者（committer）</em>之间究竟有何差别，其实作者指的是实际作出修改的人，提交者指的是最后将此 工作成果提交到仓库的人。所以，当你为某个项目发布补丁，然后某个核心成员将你的补丁并入项目时，你就是作者，而那个核心成员就是提交者。我们会在第五章 再详细介绍两者之间的细微差别。</p>
<p>用 oneline 或 format 时结合 </p>
<p>--graph
 选项，可以看到开头多出一些 ASCII 字符串表示的简单图形，形象地展示了每个提交所在的分支及其分化衍合情况。在我们之前提到的 Grit 项目仓库中可以看到：
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11$ git log --pretty=</p>
<p>format</p>
<p>:</p>
<p>&quot;%h %s&quot;</p>
<p>--graph</p>
<p>/* 2d3acf9 ignore errors from SIGCHLD on</p>
<p>trap
/*  5e3ee11 Merge branch</p>
<p>&#39;master&#39;</p>
<p>of git:</p>
<p>//github</p>
<p>.com</p>
<p>/dustin/grit</p>
<p>|\
| /* 420eac9 Added a method</p>
<p>for</p>
<p>getting the current branch.</p>
<p>/<em> | 30e367c timeout code and tests
/</em> | 5a09431 add timeout protection to grit</p>
<p>/* | e1193f8 support</p>
<p>for</p>
<p>heads with slashes</p>
<p>in</p>
<p>them
|/</p>
<p>/* d6016bc require</p>
<p>time</p>
<p>for</p>
<p>xmlschema
/*  11d191e Merge branch</p>
<p>&#39;defunkt&#39;</p>
<p>into</p>
<p>local</p>
<p>以上只是简单介绍了一些 </p>
<p>git log
 命令支持的选项。表 2-2 还列出了一些其他常用的选项及其释义。</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
选项 说明</p>
<p>-p 按补丁格式显示每个更新之间的差异。
--stat 显示每次更新的文件修改统计信息。</p>
<p>--shortstat 只显示 --stat 中最后的行数修改添加移除统计。
--name-only 仅在提交信息后显示已修改的文件清单。</p>
<p>--name-status 显示新增、修改、删除的文件清单。
--abbrev-commit 仅显示 SHA-1 的前几个字符，而非所有的 40 个字符。</p>
<p>--relative-</p>
<p>date</p>
<p>使用较短的相对时间显示（比如，“2 weeks ago”）。
--graph 显示 ASCII 图形表示的分支合并历史。</p>
<p>--pretty 使用其他格式显示历史提交信息。可用的选项包括 oneline，short，full，fuller 和</p>
<p>format</p>
<p>（后跟指定格式）。</p>
<p><strong>限制输出长度</strong></p>
<p>除了定制输出格式的选项之外，</p>
<p>git log
 还有许多非常实用的限制输出长度的选项，也就是只输出部分提交信息。之前我们已经看到过 </p>
<p>-2
 了，它只显示最近的两条提交，实际上，这是 </p>
<ul>
<li>选项的写法，其中的 </li>
</ul>
<p>n
 可以是任何自然数，表示仅显示最近的若干条提交。不过实践中我们是不太用这个选项的，Git 在输出所有提交时会自动调用分页程序（less），要看更早的更新只需翻到下页即可。</p>
<p>另外还有按照时间作限制的选项，比如 </p>
<p>--since
 和 </p>
<p>--until
。下面的命令列出所有最近两周内的提交：
1$ git log --since=2.weeks</p>
<p>你可以给出各种时间格式，比如说具体的某一天（“2008-01-15”），或者是多久以前（“2 years 1 day 3 minutes ago”）。</p>
<p>还可以给出若干搜索条件，列出符合的提交。用 </p>
<p>--author
 选项显示指定作者的提交，用 </p>
<p>--grep
 选项搜索提交说明中的关键字。（请注意，如果要得到同时满足这两个选项搜索条件的提交，就必须用</p>
<p>--all-match
 选项。）</p>
<p>如果只关心某些文件或者目录的历史提交，可以在 </p>
<p>git log
 选项的最后指定它们的路径。因为是放在最后位置上的选项，所以用两个短划线（</p>
<p>--
）隔开之前的选项和后面限定的路径名。</p>
<p>表 2-3 还列出了其他常用的类似选项。
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
选项 说明</p>
<p>-(n)    仅显示最近的 n 条提交
--since, --after 仅显示指定时间之后的提交。</p>
<p>--</p>
<p>until</p>
<p>, --before 仅显示指定时间之前的提交。
--author 仅显示指定作者相关的提交。</p>
<p>--committer 仅显示指定提交者相关的提交。</p>
<p>来看一个实际的例子，如果要查看 Git 仓库中，2008 年 10 月期间，Junio Hamano 提交的但未合并的测试脚本（位于项目的 t/ 目录下的文件），可以用下面的查询命令：</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
$ git log --pretty=</p>
<p>&quot;%h - %s&quot;</p>
<p>--author=gitster --since=</p>
<p>&quot;2008-10-01&quot;</p>
<p>\</p>
<p>--before=</p>
<p>&quot;2008-11-01&quot;</p>
<p>--no-merges -- t/
5610e3b - Fix testcase failure when extended attribute</p>
<p>acd3b9e - Enhance hold<em>lock_file_for</em>{update,append}()
f563754 - demonstrate breakage of detached checkout wi</p>
<p>d1a43f2 - reset --hard</p>
<p>/read-tree</p>
<p>--reset -u: remove un
51a94af - Fix</p>
<p>&quot;checkout --track -b newbranch&quot;</p>
<p>on detac</p>
<p>b0ad11e - pull: allow &quot;git pull origin $something:$cur</p>
<p>Git 项目有 20,000 多条提交，但我们给出搜索选项后，仅列出了其中满足条件的 6 条。</p>
<h3 id="-">使用图形化工具查阅提交历史</h3>
<p>有时候图形化工具更容易展示历史提交的变化，随 Git 一同发布的 gitk 就是这样一种工具。它是用 Tcl/Tk 写成的，基本上相当于 </p>
<p>git log
 命令的可视化版本，凡是</p>
<p>git log
 可以用的选项也都能用在 gitk 上。在项目工作目录中输入 gitk 命令后，就会启动图 2-2 所示的界面。</p>
<p><a href="http://cdn2.jobbole.com/2012/08/20120201121433_829.png" title="Git详解之二：Git基础" target="_blank"><img src="&quot;Git详解之二：Git基础&quot;" alt="Git详解之二：Git基础"></a></p>
<p>图 2-2. gitk 的图形界面</p>
<p>上半个窗口显示的是历次提交的分支祖先图谱，下半个窗口显示当前点选的提交对应的具体差异。</p>
<p><strong>2.4  撤消操作</strong></p>
<p>任何时候，你都有可能需要撤消刚才所做的某些操作。接下来，我们会介绍一些基本的撤消操作相关的命令。请注意，有些操作并不总是可以撤消的，所以请务必谨慎小心，一旦失误，就有可能丢失部分工作成果。</p>
<p><strong>修改最后一次提交</strong></p>
<p>有时候我们提交完了才发现漏掉了几个文件没有加，或者提交信息写错了。想要撤消刚才的提交操作，可以使用 </p>
<p>--amend
选项重新提交：
1$ git commit --amend</p>
<p>此命令将使用当前的暂存区域快照提交。如果刚才提交完没有作任何改动，直接运行此命令的话，相当于有机会重新编辑提交说明，但将要提交的文件快照和之前的一样。</p>
<p>启动文本编辑器后，会看到上次提交时的说明，编辑它确认没问题后保存退出，就会使用新的提交说明覆盖刚才失误的提交。</p>
<p>如果刚才提交时忘了暂存某些修改，可以先补上暂存操作，然后再运行 </p>
<p>--amend
 提交：
1</p>
<p>2
3$ git commit -m</p>
<p>&#39;initial commit&#39;</p>
<p>$ git add forgotten_file
$ git commit --amend</p>
<p>上面的三条命令最终只是产生一个提交，第二个提交命令修正了第一个的提交内容。</p>
<p><strong>取消已经暂存的文件</strong></p>
<p>接下来的两个小节将演示如何取消暂存区域中的文件，以及如何取消工作目录中已修改的文件。不用担心，查看文件状态的时候就提示了该如何撤消，所以不需要死记硬背。来看下面的例子，有两个修改过的文件，我们想要分开提交，但不小心用</p>
<p>git add .
 全加到了暂存区域。该如何撤消暂存其中的一个文件呢？其实，</p>
<p>git status
 的命令输出已经告诉了我们该怎么做：
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11$ git add .</p>
<p>$ git status
/# On branch master</p>
<p>/# Changes to be committed:
/#   (use &quot;git reset HEAD</p>
<p>...&quot; to unstage)</p>
<p>/#
/#       modified:   README.txt</p>
<p>/#       modified:   benchmarks.rb
/#</p>
<p>就在 “Changes to be committed” 下面，括号中有提示，可以使用 </p>
<p>git reset HEAD ... 
的方式取消暂存。好吧，我们来试试取消暂存 benchmarks.rb 文件：</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13</p>
<p>14
15</p>
<p>16
17</p>
<p>18
19</p>
<p>20
21$ git reset HEAD benchmarks.rb</p>
<p>benchmarks.rb: locally modified
$ git status</p>
<p>/# On branch master
/# Changes to be committed:</p>
<p>/#   (use &quot;git reset HEAD</p>
<p>...&quot; to unstage)
/#</p>
<p>/#       modified:   README.txt
/#</p>
<p>/# Changed but not updated:
/#   (use &quot;git add</p>
<p>...&quot; to update what will be committed)</p>
<p>/#   (use &quot;git checkout --</p>
<p>...&quot; to discard changes</p>
<p>in</p>
<p>working directory)
/#</p>
<p>/#       modified:   benchmarks.rb
/#</p>
<p>这条命令看起来有些古怪，先别管，能用就行。现在 benchmarks.rb 文件又回到了之前已修改未暂存的状态。</p>
<p><strong>取消对文件的修改</strong></p>
<p>如果觉得刚才对 benchmarks.rb 的修改完全没有必要，该如何取消修改，回到之前的状态（也就是修改之前的版本）呢？</p>
<p>git status
 同样提示了具体的撤消方法，接着上面的例子，现在未暂存区域看起来像这样：
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
/# Changed but not updated:</p>
<p>/#   (use &quot;git add</p>
<p>...&quot; to update what will be committed)
/#   (use &quot;git checkout --</p>
<p>...&quot; to discard changes</p>
<p>in</p>
<p>working directory)</p>
<p>/#
/#       modified:   benchmarks.rb</p>
<p>/#</p>
<p>在第二个括号中，我们看到了抛弃文件修改的命令（至少在 Git 1.6.1 以及更高版本中会这样提示，如果你还在用老版本，我们强烈建议你升级，以获取最佳的用户体验），让我们试试看：</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
$ git checkout -- benchmarks.rb</p>
<p>$ git status
/# On branch master</p>
<p>/# Changes to be committed:
/#   (use &quot;git reset HEAD</p>
<p>...&quot; to unstage)</p>
<p>/#
/#       modified:   README.txt</p>
<p>/#</p>
<p>可以看到，该文件已经恢复到修改前的版本。你可能已经意识到了，这条命令有些危险，所有对文件的修改都没有了，因为我们刚刚把之前版本的文件复制过 来重写了此文件。所以在用这条命令前，请务必确定真的不再需要保留刚才的修改。如果只是想回退版本，同时保留刚才的修改以便将来继续工作，可以用下章介绍 的 stashing 和分支来处理，应该会更好些。</p>
<p>记住，任何已经提交到 Git 的都可以被恢复。即便在已经删除的分支中的提交，或者用 </p>
<p>--amend
 重新改写的提交，都可以被恢复（关于数据恢复的内容见第九章）。所以，你可能失去的数据，仅限于没有提交过的，对 Git 来说它们就像从未存在过一样。</p>
<p><strong>2.5  远程仓库的使用</strong></p>
<p>要参与任何一个 Git 项目的协作，必须要了解该如何管理远程仓库。远程仓库是指托管在网络上的项目仓库，可能会有好多个，其中有些你只能读，另外有些可以写。同他人协作开发某 个项目时，需要管理这些远程仓库，以便推送或拉取数据，分享各自的工作进展。管理远程仓库的工作，包括添加远程库，移除废弃的远程库，管理各式远程库分 支，定义是否跟踪这些分支，等等。本节我们将详细讨论远程库的管理和使用。</p>
<p><strong>查看当前的远程库</strong></p>
<p>要查看当前配置有哪些远程仓库，可以用 </p>
<p>git remote
 命令，它会列出每个远程库的简短名字。在克隆完某个项目后，至少可以看到一个名为 origin 的远程库，Git 默认使用这个名字来标识你所克隆的原始仓库：
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
$ git clone git:</p>
<p>//github</p>
<p>.com</p>
<p>/schacon/ticgit</p>
<p>.git</p>
<p>Initialized empty Git repository</p>
<p>in</p>
<p>/private/tmp/ticgit/</p>
<p>.git/
remote: Counting objects: 595,</p>
<p>done</p>
<p>.</p>
<p>remote: Compressing objects: 100% (269</p>
<p>/269</p>
<p>),</p>
<p>done</p>
<p>.
remote: Total 595 (delta 255), reused 589 (delta 253)</p>
<p>Receiving objects: 100% (595</p>
<p>/595</p>
<p>), 73.31 KiB | 1 KiB</p>
<p>/s</p>
<p>,</p>
<p>done</p>
<p>.
Resolving deltas: 100% (255</p>
<p>/255</p>
<p>),</p>
<p>done</p>
<p>.</p>
<p>$</p>
<p>cd</p>
<p>ticgit
$ git remote</p>
<p>origin</p>
<p>也可以加上 </p>
<p>-v
 选项（译注：此为 </p>
<p>--verbose
 的简写，取首字母），显示对应的克隆地址：</p>
<p>1</p>
<p>2
$ git remote -</p>
<p>v</p>
<p>origin  git:</p>
<p>//github</p>
<p>.com</p>
<p>/schacon/ticgit</p>
<p>.git</p>
<p>如果有多个远程仓库，此命令将全部列出。比如在我的 Grit 项目中，可以看到：</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7$</p>
<p>cd</p>
<p>grit</p>
<p>$ git remote -</p>
<p>v
bakkdoor  git:</p>
<p>//github</p>
<p>.com</p>
<p>/bakkdoor/grit</p>
<p>.git</p>
<p>cho45     git:</p>
<p>//github</p>
<p>.com</p>
<p>/cho45/grit</p>
<p>.git
defunkt   git:</p>
<p>//github</p>
<p>.com</p>
<p>/defunkt/grit</p>
<p>.git</p>
<p>koke      git:</p>
<p>//github</p>
<p>.com</p>
<p>/koke/grit</p>
<p>.git
origin    git@ github.com:mojombo</p>
<p>/grit</p>
<p>.git</p>
<p>这样一来，我就可以非常轻松地从这些用户的仓库中，拉取他们的提交到本地。请注意，上面列出的地址只有 origin 用的是 SSH URL 链接，所以也只有这个仓库我能推送数据上去（我们会在第四章解释原因）。</p>
<p><strong>添加远程仓库</strong></p>
<p>要添加一个新的远程仓库，可以指定一个简单的名字，以便将来引用，运行 </p>
<p>git remote add [shortname] [url]
：
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
$ git remote</p>
<p>origin
$ git remote add pb git:</p>
<p>//github</p>
<p>.com</p>
<p>/paulboone/ticgit</p>
<p>.git</p>
<p>$ git remote -</p>
<p>v
origin  git:</p>
<p>//github</p>
<p>.com</p>
<p>/schacon/ticgit</p>
<p>.git</p>
<p>pb  git:</p>
<p>//github</p>
<p>.com</p>
<p>/paulboone/ticgit</p>
<p>.git</p>
<p>现在可以用字串 pb 指代对应的仓库地址了。比如说，要抓取所有 Paul 有的，但本地仓库没有的信息，可以运行 </p>
<p>git fetch pb
：</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
$ git fetch pb</p>
<p>remote: Counting objects: 58,</p>
<p>done</p>
<p>.
remote: Compressing objects: 100% (41</p>
<p>/41</p>
<p>),</p>
<p>done</p>
<p>.</p>
<p>remote: Total 44 (delta 24), reused 1 (delta 0)
Unpacking objects: 100% (44</p>
<p>/44</p>
<p>),</p>
<p>done</p>
<p>.</p>
<p>From git:</p>
<p>//github</p>
<p>.com</p>
<p>/paulboone/ticgit</p>
<p>/* [new branch]      master     -&gt; pb</p>
<p>/master</p>
<p>/* [new branch]      ticgit     -&gt; pb</p>
<p>/ticgit</p>
<p>现在，Paul 的主干分支（master）已经完全可以在本地访问了，对应的名字是 </p>
<p>pb/master
，你可以将它合并到自己的某个分支，或者切换到这个分支，看看有些什么有趣的更新。</p>
<p><strong>从远程仓库抓取数据</strong></p>
<p>正如之前所看到的，可以用下面的命令从远程仓库抓取数据到本地：
1$ git fetch [remote-name]</p>
<p>此命令会到远程仓库中拉取所有你本地仓库中还没有的数据。运行完成后，你就可以在本地访问该远程仓库中的所有分支，将其中某个分支合并到本地，或者只是取出某个分支，一探究竟。（我们会在第三章详细讨论关于分支的概念和操作。）</p>
<p>如果是克隆了一个仓库，此命令会自动将远程仓库归于 origin 名下。所以，</p>
<p>git fetch origin
 会抓取从你上次克隆以来别人上传到此远程仓库中的所有更新（或是上次 fetch 以来别人提交的更新）。有一点很重要，需要记住，fetch 命令只是将远端的数据拉到本地仓库，并不自动合并到当前工作分支，只有当你确实准备好了，才能手工合并。</p>
<p>如果设置了某个分支用于跟踪某个远端仓库的分支（参见下节及第三章的内容），可以使用 </p>
<p>git pull
 命令自动抓取数据下来，然后将远端分支自动合并到本地仓库中当前分支。在日常工作中我们经常这么用，既快且好。实际上，默认情况下</p>
<p>git clone
 命令本质上就是自动创建了本地的 master 分支用于跟踪远程仓库中的 master 分支（假设远程仓库确实有 master 分支）。所以一般我们运行</p>
<p>git pull
，目的都是要从原始克隆的远端仓库中抓取数据后，合并到工作目录中的当前分支。</p>
<p><strong>推送数据到远程仓库</strong></p>
<p>项目进行到一个阶段，要同别人分享目前的成果，可以将本地仓库中的数据推送到远程仓库。实现这个任务的命令很简单： </p>
<p>git push [remote-name] [branch-name]
。如果要把本地的 master 分支推送到</p>
<p>origin
 服务器上（再次说明下，克隆操作会自动使用默认的 master 和 origin 名字），可以运行下面的命令：
1$ git push origin master</p>
<p>只有在所克隆的服务器上有写权限，或者同一时刻没有其他人在推数据，这条命令才会如期完成任务。如果在你推数据前，已经有其他人推送了若干更新，那 你的推送操作就会被驳回。你必须先把他们的更新抓取到本地，合并到自己的项目中，然后才可以再次推送。有关推送数据到远程仓库的详细内容见第三章。</p>
<p><strong>查看远程仓库信息</strong></p>
<p>我们可以通过命令 </p>
<p>git remote show [remote-name]
 查看某个远程仓库的详细信息，比如要看所克隆的 </p>
<p>origin
 仓库，可以运行：
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
$ git remote show origin</p>
<p>/* remote origin</p>
<p>URL: git:</p>
<p>//github</p>
<p>.com</p>
<p>/schacon/ticgit</p>
<p>.git</p>
<p>Remote branch merged with</p>
<p>&#39;git pull&#39;</p>
<p>while</p>
<p>on branch master</p>
<p>master</p>
<p>Tracked remote branches</p>
<p>master</p>
<p>ticgit</p>
<p>除了对应的克隆地址外，它还给出了许多额外的信息。它友善地告诉你如果是在 master 分支，就可以用 </p>
<p>git pull
 命令抓取数据合并到本地。另外还列出了所有处于跟踪状态中的远端分支。</p>
<p>上面的例子非常简单，而随着使用 Git 的深入，</p>
<p>git remote show
 给出的信息可能会像这样：
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13</p>
<p>14
15</p>
<p>16
17</p>
<p>18
19</p>
<p>20
21$ git remote show origin</p>
<p>/* remote origin</p>
<p>URL: git@ github.com:defunkt</p>
<p>/github</p>
<p>.git</p>
<p>Remote branch merged with</p>
<p>&#39;git pull&#39;</p>
<p>while</p>
<p>on branch issues</p>
<p>issues</p>
<p>Remote branch merged with</p>
<p>&#39;git pull&#39;</p>
<p>while</p>
<p>on branch master</p>
<p>master</p>
<p>New remote branches (next fetch will store</p>
<p>in</p>
<p>remotes</p>
<p>/origin</p>
<p>)</p>
<p>caching</p>
<p>Stale tracking branches (use</p>
<p>&#39;git remote prune&#39;</p>
<p>)</p>
<p>libwalker</p>
<p>walker2</p>
<p>Tracked remote branches</p>
<p>acl</p>
<p>apiv2</p>
<p>dashboard2</p>
<p>issues</p>
<p>master</p>
<p>postgres</p>
<p>Local branch pushed with</p>
<p>&#39;git push&#39;</p>
<p>master:master</p>
<p>它告诉我们，运行 </p>
<p>git push
 时缺省推送的分支是什么（译注：最后两行）。它还显示了有哪些远端分支还没有同步到本地（译注：第六行的</p>
<p>caching
 分支），哪些已同步到本地的远端分支在远端服务器上已被删除（译注：</p>
<p>Stale tracking branches
 下面的两个分支），以及运行</p>
<p>git pull
 时将自动合并哪些分支（译注：前四行中列出的 </p>
<p>issues
 和 </p>
<p>master
 分支）。</p>
<p><strong>远程仓库的删除和重命名</strong></p>
<p>在新版 Git 中可以用 </p>
<p>git remote rename
 命令修改某个远程仓库在本地的简短名称，比如想把 </p>
<p>pb
 改成</p>
<p>paul
，可以这么运行：
1</p>
<p>2
3</p>
<p>4
$ git remote rename pb paul</p>
<p>$ git remote
origin</p>
<p>paul</p>
<p>注意，对远程仓库的重命名，也会使对应的分支名称发生变化，原来的 </p>
<p>pb/master
 分支现在成了 </p>
<p>paul/master
。</p>
<p>碰到远端仓库服务器迁移，或者原来的克隆镜像不再使用，又或者某个参与者不再贡献代码，那么需要移除对应的远端仓库，可以运行 </p>
<p>git remote rm
 命令：
1</p>
<p>2
3$ git remote</p>
<p>rm</p>
<p>paul</p>
<p>$ git remote
origin</p>
<p><strong>2.6  打标签</strong></p>
<p>同大多数 VCS 一样，Git 也可以对某一时间点上的版本打上标签。人们在发布某个软件版本（比如 v1.0 等等）的时候，经常这么做。本节我们一起来学习如何列出所有可用的标签，如何新建标签，以及各种不同类型标签之间的差别。</p>
<p><strong>列显已有的标签</strong></p>
<p>列出现有标签的命令非常简单，直接运行 </p>
<p>git tag
 即可：
1$ git tag v0.1 v1.3</p>
<p>显示的标签按字母顺序排列，所以标签的先后并不表示重要程度的轻重。</p>
<p>我们可以用特定的搜索模式列出符合条件的标签。在 Git 自身项目仓库中，有着超过 240 个标签，如果你只对 1.4.2 系列的版本感兴趣，可以运行下面的命令：
1$ git tag -l</p>
<p>&#39;v1.4.2./*&#39;</p>
<p>v1.4.2.1 v1.4.2.2 v1.4.2.3 v1.4.2.4</p>
<p><strong>新建标签</strong></p>
<p>Git 使用的标签有两种类型：轻量级的（lightweight）和含附注的（annotated）。轻量级标签就像是个不会变化的分支，实际上它就是个指向特 定提交对象的引用。而含附注标签，实际上是存储在仓库中的一个独立对象，它有自身的校验和信息，包含着标签的名字，电子邮件地址和日期，以及标签说明，标 签本身也允许使用 GNU Privacy Guard (GPG) 来签署或验证。一般我们都建议使用含附注型的标签，以便保留相关信息；当然，如果只是临时性加注标签，或者不需要旁注额外信息，用轻量级标签也没问题。</p>
<p><strong>含附注的标签</strong></p>
<p>创建一个含附注类型的标签非常简单，用 </p>
<p>-a
 （译注：取 </p>
<p>annotated
 的首字母）指定标签名字即可：
1</p>
<p>2
3</p>
<p>4
5$ git tag -a v1.4 -m</p>
<p>&#39;my version 1.4&#39;</p>
<p>$ git tag
v0.1</p>
<p>v1.3
v1.4</p>
<p>而 </p>
<p>-m
 选项则指定了对应的标签说明，Git 会将此说明一同保存在标签对象中。如果没有给出该选项，Git 会启动文本编辑软件供你输入标签说明。</p>
<p>可以使用 </p>
<p>git show
 命令查看相应标签的版本信息，并连同显示打标签时的提交对象。
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13</p>
<p>14
$ git show v1.4</p>
<p>tag v1.4
Tagger: Scott Chacon</p>
<p>Date:   Mon Feb 9 14:45:11 2009 -0800</p>
<p>my version 1.4</p>
<p>commit 15027957951b64cf874c3557a0f3547bd83b3ff6
Merge: 4a447f7... a6b4c97...</p>
<p>Author: Scott Chacon</p>
<p>Date:   Sun Feb 8 19:02:46 2009 -0800</p>
<p>Merge branch</p>
<p>&#39;experiment&#39;</p>
<p>我们可以看到在提交对象信息上面，列出了此标签的提交者和提交时间，以及相应的标签说明。</p>
<p><strong>签署标签</strong></p>
<p>如果你有自己的私钥，还可以用 GPG 来签署标签，只需要把之前的 </p>
<p>-a
 改为 </p>
<p>-s
 （译注： 取 </p>
<p>signed
 的首字母）即可：
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
$ git tag -s v1.5 -m</p>
<p>&#39;my signed 1.5 tag&#39;</p>
<p>You need a passphrase to unlock the secret key</p>
<p>for
user: &quot;Scott Chacon</p>
<p>&quot;</p>
<p>1024-bit DSA key, ID F721C45A, created 2009-02-09</p>
<p>现在再运行 </p>
<p>git show
 会看到对应的 GPG 签名也附在其内：</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13</p>
<p>14
15</p>
<p>16
17</p>
<p>18
19</p>
<p>20
21$ git show v1.5</p>
<p>tag v1.5
Tagger: Scott Chacon</p>
<p>Date:   Mon Feb 9 15:22:20 2009 -0800</p>
<p>my signed 1.5 tag</p>
<p>-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (Darwin)</p>
<p>iEYEABECAAYFAkmQurIACgkQON3DxfchxFr5cACeIMN+ZxLKggJQf0QYiQBwgySN</p>
<p>Ki0An2JeAVUCAiJ7Ox6ZEtK+NvZAj82/
=WryJ</p>
<p>-----END PGP SIGNATURE-----
commit 15027957951b64cf874c3557a0f3547bd83b3ff6</p>
<p>Merge: 4a447f7... a6b4c97...
Author: Scott Chacon</p>
<p>Date:   Sun Feb 8 19:02:46 2009 -0800</p>
<p>Merge branch</p>
<p>&#39;experiment&#39;</p>
<p>稍后我们再学习如何验证已经签署的标签。</p>
<p><strong>轻量级标签</strong></p>
<p>轻量级标签实际上就是一个保存着对应提交对象的校验和信息的文件。要创建这样的标签，一个 </p>
<p>-a
，</p>
<p>-s
 或 </p>
<p>-m
 选项都不用，直接给出标签名字即可：
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7$ git tag v1.4-lw</p>
<p>$ git tag
v0.1</p>
<p>v1.3
v1.4</p>
<p>v1.4-lw
v1.5</p>
<p>现在运行 </p>
<p>git show
 查看此标签信息，就只有相应的提交对象摘要：</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
$ git show v1.4-lw</p>
<p>commit 15027957951b64cf874c3557a0f3547bd83b3ff6
Merge: 4a447f7... a6b4c97...</p>
<p>Author: Scott Chacon</p>
<p>Date:   Sun Feb 8 19:02:46 2009 -0800</p>
<p>Merge branch</p>
<p>&#39;experiment&#39;</p>
<p><strong>验证标签</strong></p>
<p>可以使用 </p>
<p>git tag -v [tag-name]
 （译注：取 </p>
<p>verify
 的首字母）的方式验证已经签署的标签。此命令会调用 GPG 来验证签名，所以你需要有签署者的公钥，存放在 keyring 中，才能验证：
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13</p>
<p>14
15</p>
<p>16
17$ git tag -</p>
<p>v</p>
<p>v1.4.2.1</p>
<p>object 883653babd8ee7ea23e6a5c392bb739348b1eb61
type</p>
<p>commit</p>
<p>tag v1.4.2.1
tagger Junio C Hamano</p>
<p>1158138501 -0700</p>
<p>GIT 1.4.2.1</p>
<p>Minor fixes since 1.4.2, including git-</p>
<p>mv</p>
<p>and git-http with alternates.</p>
<p>gpg: Signature made Wed Sep 13 02:08:25 2006 PDT using DSA key ID F3119B9A
gpg: Good signature from &quot;Junio C Hamano</p>
<p>&quot;</p>
<p>gpg:                 aka</p>
<p>&quot;[jpeg image of size 1513]&quot;
Primary key fingerprint: 3565 2A26 2040 E066 C9A7  4A7D C0C6 D9A4 F311 9B9A</p>
<p>若是没有签署者的公钥，会报告类似下面这样的错误：</p>
<p>1</p>
<p>2
3gpg: Signature made Wed Sep 13 02:08:25 2006 PDT using DSA key ID F3119B9A</p>
<p>gpg: Can&#39;t check signature: public key not found
error: could not verify the tag</p>
<p>&#39;v1.4.2.1&#39;</p>
<p><strong>后期加注标签</strong></p>
<p>你甚至可以在后期对早先的某次提交加注标签。比如在下面展示的提交历史中：
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11$ git log --pretty=oneline</p>
<p>15027957951b64cf874c3557a0f3547bd83b3ff6 Merge branch</p>
<p>&#39;experiment&#39;
a6b4c97498bd301d84096da251c98a07c7723e65 beginning write support</p>
<p>0d52aaab4479697da7686c15f77a3d64d9165190 one</p>
<p>more</p>
<p>thing
6d52a271eda8725415634dd79daabbc4d9b6008e Merge branch</p>
<p>&#39;experiment&#39;</p>
<p>0b7434d86859cc7b8c3d5e1dddfed66ff742fcbc added a commit</p>
<p>function
4682c3261057305bdd616e23b64b0857d832627b added a todo</p>
<p>file</p>
<p>166ae0c4d3f420721acbb115cc33848dfcc2121a started write support
9fceb02d0ae598e95dc970b74767f19372d61af8 updated rakefile</p>
<p>964f16d36dfccde844893cac5b347e7b3d44abbc commit the todo
8a5cbc430f1a9c3d00faaeffd07798508422908a updated readme</p>
<p>我们忘了在提交 “updated rakefile” 后为此项目打上版本号 v1.2，没关系，现在也能做。只要在打标签的时候跟上对应提交对象的校验和（或前几位字符）即可：</p>
<p>1$ git tag -a v1.2 9fceb02</p>
<p>可以看到我们已经补上了标签：</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13</p>
<p>14
15</p>
<p>16
17</p>
<p>18
19</p>
<p>20
21</p>
<p>22
$ git tag</p>
<p>v0.1
v1.2</p>
<p>v1.3
v1.4</p>
<p>v1.4-lw
v1.5</p>
<p>$ git show v1.2</p>
<p>tag v1.2
Tagger: Scott Chacon</p>
<p>Date:   Mon Feb 9 15:32:16 2009 -0800</p>
<p>version 1.2</p>
<p>commit 9fceb02d0ae598e95dc970b74767f19372d61af8
Author: Magnus Chacon</p>
<p>Date:   Sun Apr 27 20:43:35 2008 -0700</p>
<p>updated rakefile</p>
<p>...</p>
<p><strong>分享标签</strong></p>
<p>默认情况下，</p>
<p>git push
 并不会把标签传送到远端服务器上，只有通过显式命令才能分享标签到远端仓库。其命令格式如同推送分支，运行</p>
<p>git push origin [tagname]
 即可：
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7$ git push origin v1.5</p>
<p>Counting objects: 50,</p>
<p>done</p>
<p>.
Compressing objects: 100% (38</p>
<p>/38</p>
<p>),</p>
<p>done</p>
<p>.</p>
<p>Writing objects: 100% (44</p>
<p>/44</p>
<p>), 4.56 KiB,</p>
<p>done</p>
<p>.
Total 44 (delta 18), reused 8 (delta 1)</p>
<p>To git@ github.com:schacon</p>
<p>/simplegit</p>
<p>.git
/* [new tag]         v1.5 -&gt; v1.5</p>
<p>如果要一次推送所有本地新增的标签上去，可以使用 </p>
<p>--tags
 选项：</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11$ git push origin --tags</p>
<p>Counting objects: 50,</p>
<p>done</p>
<p>.
Compressing objects: 100% (38</p>
<p>/38</p>
<p>),</p>
<p>done</p>
<p>.</p>
<p>Writing objects: 100% (44</p>
<p>/44</p>
<p>), 4.56 KiB,</p>
<p>done</p>
<p>.
Total 44 (delta 18), reused 8 (delta 1)</p>
<p>To git@ github.com:schacon</p>
<p>/simplegit</p>
<p>.git</p>
<p>/* [new tag]         v0.1 -&gt; v0.1</p>
<p>/* [new tag]         v1.2 -&gt; v1.2</p>
<p>/* [new tag]         v1.4 -&gt; v1.4</p>
<p>/* [new tag]         v1.4-lw -&gt; v1.4-lw</p>
<p>/* [new tag]         v1.5 -&gt; v1.5</p>
<p>现在，其他人克隆共享仓库或拉取数据同步后，也会看到这些标签。</p>
<p><strong>2.7  技巧和窍门</strong></p>
<p>在结束本章之前，我还想和大家分享一些 Git 使用的技巧和窍门。很多使用 Git 的开发者可能根本就没用过这些技巧，我们也不是说在读过本书后非得用这些技巧不可，但至少应该有所了解吧。说实话，有了这些小窍门，我们的工作可以变得更简单，更轻松，更高效。</p>
<p><strong>自动完成</strong></p>
<p>如果你用的是 Bash shell，可以试试看 Git 提供的自动完成脚本。下载 Git 的源代码，进入 </p>
<p>contrib/completion
 目录，会看到一个</p>
<p>git-completion.bash
 文件。将此文件复制到你自己的用户主目录中（译注：按照下面的示例，还应改名加上点：</p>
<p>cp git-completion.bash ~/.git-completion.bash
），并把下面一行内容添加到你的</p>
<p>.bashrc
 文件中：
1source</p>
<p>~/.git-completion.</p>
<p>bash</p>
<p>也可以为系统上所有用户都设置默认使用此脚本。Mac 上将此脚本复制到 </p>
<p>/opt/local/etc/bash_completion.d
 目录中，Linux 上则复制到</p>
<p>/etc/bash_completion.d/
 目录中。这两处目录中的脚本，都会在 Bash 启动时自动加载。</p>
<p>如果在 Windows 上安装了 msysGit，默认使用的 Git Bash 就已经配好了这个自动完成脚本，可以直接使用。</p>
<p>在输入 Git 命令的时候可以敲两次跳格键（Tab），就会看到列出所有匹配的可用命令建议：
1$ git co commit config</p>
<p>此例中，键入 git co 然后连按两次 Tab 键，会看到两个相关的建议（命令） commit 和 config。继而输入 </p>
<p>m 
会自动完成</p>
<p>git commit
 命令的输入。</p>
<p>命令的选项也可以用这种方式自动完成，其实这种情况更实用些。比如运行 </p>
<p>git log
 的时候忘了相关选项的名字，可以输入开头的几个字母，然后敲 Tab 键看看有哪些匹配的：
1</p>
<p>2
3$ git log --s</p>
<p>--shortstat  --since=  --src-prefix=  --stat   --summary</p>
<p>这个技巧不错吧，可以节省很多输入和查阅文档的时间。</p>
<p><strong>Git 命令别名</strong></p>
<p>Git 并不会推断你输入的几个字符将会是哪条命令，不过如果想偷懒，少敲几个命令的字符，可以用 </p>
<p>git config
 为命令设置别名。来看看下面的例子：
1</p>
<p>2
3</p>
<p>4
$ git config --global</p>
<p>alias</p>
<p>.co checkout</p>
<p>$ git config --global</p>
<p>alias</p>
<p>.br branch
$ git config --global</p>
<p>alias</p>
<p>.ci commit</p>
<p>$ git config --global</p>
<p>alias</p>
<p>.st status</p>
<p>现在，如果要输入 </p>
<p>git commit
 只需键入 </p>
<p>git ci
 即可。而随着 Git 使用的深入，会有很多经常要用到的命令，遇到这种情况，不妨建个别名提高效率。</p>
<p>使用这种技术还可以创造出新的命令，比方说取消暂存文件时的输入比较繁琐，可以自己设置一下：
1$ git config --global</p>
<p>alias</p>
<p>.unstage</p>
<p>&#39;reset HEAD --&#39;</p>
<p>这样一来，下面的两条命令完全等同：</p>
<p>1</p>
<p>2
$ git unstage fileA</p>
<p>$ git reset HEAD fileA</p>
<p>显然，使用别名的方式看起来更清楚。另外，我们还经常设置 </p>
<p>last
 命令：</p>
<p>1$ git config --global</p>
<p>alias</p>
<p>.last</p>
<p>&#39;log -1 HEAD&#39;</p>
<p>然后要看最后一次的提交信息，就变得简单多了：</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9$ git last</p>
<p>commit 66938dae3329c7aebe598c2246a8e6af90d04646
Author: Josh Goebel</p>
<p>Date:   Tue Aug 26 19:48:51 2008 +0800</p>
<p>test</p>
<p>for</p>
<p>current</p>
<p>head</p>
<p>Signed-off-by: Scott Chacon</p>
<p>可以看出，实际上 Git 只是简单地在命令中替换了你设置的别名。不过有时候我们希望运行某个外部命令，而非 Git 的附属工具，这个好办，只需要在命令前加上 </p>
<p>!
 就行。如果你自己写了些处理 Git 仓库信息的脚本的话，就可以用这种技术包装起来。作为演示，我们可以设置用 </p>
<p>git visual
 启动</p>
<p>gitk
：</p>
<p>1$ git config --global</p>
<p>alias</p>
<p>.visual</p>
<p>&quot;!gitk&quot;</p>
<p><strong>2.8  小结</strong></p>
<p>到目前为止，你已经学会了最基本的 Git 操作：创建和克隆仓库，做出更新，暂存并提交这些更新，以及查看所有历史更新记录。接下来，我们将学习 Git 的必杀技特性：分支模型。
<img src="&quot;6 votes, average: 4.83 out of 5&quot;" alt="6 votes, average: 4.83 out of 5"><img src="&quot;6 votes, average: 4.83 out of 5&quot;" alt="6 votes, average: 4.83 out of 5"><img src="&quot;6 votes, average: 4.83 out of 5&quot;" alt="6 votes, average: 4.83 out of 5"><img src="&quot;6 votes, average: 4.83 out of 5&quot;" alt="6 votes, average: 4.83 out of 5"><img src="&quot;6 votes, average: 4.83 out of 5&quot;" alt="6 votes, average: 4.83 out of 5"> (<strong>*6</strong> 个评分，平均: <strong>4.83*</strong>)</p>
<p><img src="&quot;Loading ...&quot;" alt="Loading ..."> Loading ...</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/git&github/">git&github</a></li></span></span> | <span class="tags">Tagged <a href="/tags/git&github/" class="label label-primary">git&github</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:43"datetime="2014-03-07 09:54:43"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-gitgithub--Git详解之二：Git基础/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-gitgithub--Git详解之二：Git基础" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-gitgithub--git-thesimpleguide-nodeepshit/">git </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:43.000Z"> <a href="/2014/02/02/2014-02-02-gitgithub--git-thesimpleguide-nodeepshit/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="git-the-simple-guide-no-deep-shit-">git - the simple guide - no deep shit!</h1>
<h1 id="git-">git - 简易指南</h1>
<p>助你开始使用 git 的简易指南，木有高深内容，;)。
<a href="https://twitter.com/share" target="_blank">Tweet</a></p>
<p>作者：<a href="http://www.twitter.com/rogerdudler" target="_blank">罗杰·杜德勒</a>
感谢：<a href="http://www.twitter.com/tfnico" target="_blank">@tfnico</a>, <a href="http://www.twitter.com/fhd" target="_blank">@fhd</a> and <a href="http://www.namics.com/" target="_blank">Namics</a>
其他语言 <a href="http://rogerdudler.github.com/git-guide/index.html" target="_blank">english</a>, <a href="http://rogerdudler.github.com/git-guide/index.de.html" target="_blank">deutsch</a>, <a href="http://rogerdudler.github.com/git-guide/index.es.html" target="_blank">español</a>, <a href="http://rogerdudler.github.com/git-guide/index.fr.html" target="_blank">français</a>, <a href="http://rogerdudler.github.com/git-guide/index.it.html" target="_blank">italiano</a>, <a href="http://rogerdudler.github.com/git-guide/index.nl.html" target="_blank">nederlands</a>, <a href="http://rogerdudler.github.com/git-guide/index.pt_BR.html" target="_blank">português</a>, <a href="http://rogerdudler.github.com/git-guide/index.ru.html" target="_blank">русский</a>, <a href="http://rogerdudler.github.com/git-guide/index.tr.html" target="_blank">türkçe</a>,
<a href="http://rogerdudler.github.com/git-guide/index.my.html" target="_blank">မြန်မာ</a>, <a href="http://rogerdudler.github.com/git-guide/index.ja.html" target="_blank">日本語</a>, <a href="http://rogerdudler.github.com/git-guide/index.ko.html" target="_blank">한국어</a>
如有纰漏，请到 <a href="https://github.com/rogerdudler/git-guide/issues" target="_blank">github</a> 填报</p>
<p><img src="" alt="">  <a href=""></a></p>
<h2 id="-">安装</h2>
<p><a href="http://code.google.com/p/git-osx-installer/downloads/list?can=3" target="_blank">下载 git OSX 版</a></p>
<p><a href="http://code.google.com/p/msysgit/downloads/list?can=3" target="_blank">下载 git Windows 版</a></p>
<p><a href="http://book.git-scm.com/2_installing_git.html" target="_blank">下载 git Linux 版</a>
<a href=""></a></p>
<h2 id="-">创建新仓库</h2>
<p>创建新文件夹，打开，然后执行</p>
<p>git init
以创建新的 git 仓库。
<a href=""></a></p>
<h2 id="-">检出仓库</h2>
<p>执行如下命令以创建一个本地仓库的克隆版本：</p>
<p>git clone /path/to/repository
如果是远端服务器上的仓库，你的命令会是这个样子：</p>
<p>git clone username@host:/path/to/repository
<a href=""></a></p>
<h2 id="-">工作流</h2>
<p>你的本地仓库由 git 维护的三棵“树”组成。第一个是你的</p>
<p>工作目录
，它持有实际文件；第二个是</p>
<p>缓存区（Index）
，它像个缓存区域，临时保存你的改动；最后是</p>
<p>HEAD
，指向你最近一次提交后的结果。
<img src="" alt="">
<a href=""></a></p>
<h2 id="-">添加与提交</h2>
<p>你可以计划改动（把它们添加到缓存区），使用如下命令：</p>
<p>git add <filename></p>
<p>git add /*
这是 git 基本工作流程的第一步；使用如下命令以实际提交改动：</p>
<p>git commit -m &quot;代码提交信息&quot;
现在，你的改动已经提交到了 <strong>HEAD</strong>，但是还没到你的远端仓库。
<a href=""></a></p>
<h2 id="-">推送改动</h2>
<p>你的改动现在已经在本地仓库的 <strong>HEAD</strong> 中了。执行如下命令以将这些改动提交到远端仓库：</p>
<p>git push origin master
可以把 master 换成你想要推送的任何分支。
如果你还没有克隆现有仓库，并欲将你的仓库连接到某个远程服务器，你可以使用如下命令添加：</p>
<p>git remote add origin <server>
如此你就能够将你的改动推送到所添加的服务器上去了。
<a href=""></a></p>
<h2 id="-">分支</h2>
<p>分支是用来将特性开发绝缘开来的。在你创建仓库的时候，master 是“默认的”。在其他分支上进行开发，完成后再将它们合并到主分支上。
<img src="" alt=""></p>
<p>创建一个叫做“feature_x”的分支，并切换过去：</p>
<p>git checkout -b feature_x
切换回主分支：</p>
<p>git checkout master
再把新建的分支删掉：</p>
<p>git branch -d feature_x
除非你将分支推送到远端仓库，不然该分支就是 不为他人所见的：</p>
<p>git push origin <branch>
<a href=""></a></p>
<h2 id="-">更新与合并</h2>
<p>要更新你的本地仓库至最新改动，执行：</p>
<p>git pull
以在你的工作目录中 获取（fetch） 并 合并（merge） 远端的改动。
要合并其他分支到你的当前分支（例如 master），执行：</p>
<p>git merge <branch>
两种情况下，git 都会尝试去自动合并改动。不幸的是，自动合并并非次次都能成功，并可能导致 冲突（conflicts）。 这时候就需要你修改这些文件来人肉合并这些 冲突（conflicts） 了。改完之后，你需要执行如下命令以将它们标记为合并成功：</p>
<p>git add <filename>
在合并改动之前，也可以使用如下命令查看：</p>
<p>git diff <source_branch> <target_branch>
<a href=""></a></p>
<h2 id="-">标签</h2>
<p>在软件发布时创建标签，是被推荐的。这是个旧有概念，在 SVN 中也有。可以执行如下命令以创建一个叫做 1.0.0 的标签：</p>
<p>git tag 1.0.0 1b2e1d63ff
1b2e1d63ff 是你想要标记的提交 ID 的前 10 位字符。使用如下命令获取提交 ID：</p>
<p>git log
你也可以用该提交 ID 的少一些的前几位，只要它是唯一的。
<a href=""></a></p>
<h2 id="-">替换本地改动</h2>
<p>假如你做错事（自然，这是不可能的），你可以使用如下命令替换掉本地改动：</p>
<p>git checkout -- <filename>
此命令会使用 HEAD 中的最新内容替换掉你的工作目录中的文件。已添加到缓存区的改动，以及新文件，都不受影响。</p>
<p>假如你想要丢弃你所有的本地改动与提交，可以到服务器上获取最新的版本并将你本地主分支指向到它：</p>
<p>git fetch origin</p>
<p>git reset --hard origin/master
<a href=""></a></p>
<h2 id="-">有用的贴士</h2>
<p>内建的图形化 git：</p>
<p>gitk
彩色的 git 输出：</p>
<p>git config color.ui true
显示历史记录时，只显示一行注释信息：</p>
<p>git config format.pretty oneline
交互地添加文件至缓存区：</p>
<p>git add -i
<a href=""></a></p>
<h2 id="-">链接与资源</h2>
<h3 id="-">图形化界面</h3>
<ul>
<li><a href="http://gitx.laullon.com/" target="_blank">GitX (L) (OSX, open source)</a></li>
<li><a href="http://www.git-tower.com/" target="_blank">Tower (OSX)</a></li>
<li><a href="http://www.sourcetreeapp.com/" target="_blank">Source Tree (OSX, free)</a></li>
<li><a href="http://mac.github.com/" target="_blank">GitHub for Mac (OSX, free)</a></li>
<li><a href="https://itunes.apple.com/gb/app/gitbox/id403388357?mt=12" target="_blank">GitBox (OSX)</a></li>
</ul>
<h3 id="-">指南与手册</h3>
<ul>
<li><a href="http://book.git-scm.com/" target="_blank">Git 社区参考书</a></li>
<li><a href="http://progit.org/book/" target="_blank">专业 Git</a></li>
<li><a href="http://think-like-a-git.net/" target="_blank">如 git 思考</a></li>
<li><a href="http://help.github.com/" target="_blank">GitHub 帮助</a></li>
<li><a href="http://marklodato.github.com/visual-git-guide/index-en.html" target="_blank">图形化的 Git 指南一则</a>
<a href=""></a></li>
</ul>
<h2 id="-">评论</h2>
<p>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript" target="_blank">comments powered by Disqus.</a>
<a href="http://www.git-tower.com/?source=rd" target="_blank"></a> <a href="http://rogerdudler.github.com/git-guide/files/git_cheat_sheet.pdf"></a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/git&github/">git&github</a></li></span></span> | <span class="tags">Tagged <a href="/tags/git&github/" class="label label-primary">git&github</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:43"datetime="2014-03-07 09:54:43"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-gitgithub--git-thesimpleguide-nodeepshit/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-gitgithub--git-thesimpleguide-nodeepshit" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-gitgithub--git-api/">git</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:43.000Z"> <a href="/2014/02/02/2014-02-02-gitgithub--git-api/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="git-api">git-api</h1>
<p><img src="" alt=""></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/git&github/">git&github</a></li></span></span> | <span class="tags">Tagged <a href="/tags/git&github/" class="label label-primary">git&github</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:43"datetime="2014-03-07 09:54:43"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-gitgithub--git-api/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-gitgithub--git-api" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>





<ul id="pagination" class="pagination pagination-lg">
  <li><a class="extend prev" href="/page/32/">&laquo;</a></li><li><a class="page-number" href="/">1</a></li><li><a class="page-number" href="/page/2/">2</a></li><li><span class="space">&hellip;</span></li><li><a class="page-number" href="/page/30/">30</a></li><li><a class="page-number" href="/page/31/">31</a></li><li><a class="page-number" href="/page/32/">32</a></li><li class="active"><li><span class="page-number current">33</span></li><li><a class="page-number" href="/page/34/">34</a></li><li><a class="page-number" href="/page/35/">35</a></li><li><a class="page-number" href="/page/36/">36</a></li><li><span class="space">&hellip;</span></li></li><li><a class="page-number" href="/page/164/">164</a></li><li><a class="page-number" href="/page/165/">165</a></li><li><a class="extend next" href="/page/34/">&raquo;</a></li>
  <div class="clearfix"></div>
</ul></div><!--wapper-->
       </div><!-- ID main-col END -->
       <aside id="sidebar" class="alignright col-sx-6 col-sm-4 col-md-3 col-lg-3">
<div id="widget_search" class="widget panel panel-primary">
    <form action="//google.com/search" method="get" accept-charset="utf-8">
  <div class="input-group">
    <input class="form-control" id="searchbox" type="search" name="q" results="0" placeholder="search">
    <span class="input-group-btn">
      <button class="btn btn-default" type="submit">Go!</button>
    </span>
    <input type="hidden" name="q" value="site:itsolife.com">
  </div>
</form>
</div>

<div id="widget_category" class="widget panel panel-primary">
  <div class="panel-heading">category</div>  <div data-src='category' class='ajax_widgets'>正在加载...</div>
</div>

<div id="widget_recent_posts" class="widget panel panel-primary">
  <div class="panel-heading">recent posts</div>  <div data-src='recent_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_tagcloud" class="widget panel panel-primary">
  <div class="panel-heading">tagcloud</div>  <div data-src='tagcloud' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_latest_update_posts" class="widget panel panel-primary">
  <div class="panel-heading">最近更新</div>  <div data-src='latest_update_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_recent_comments" class="widget panel panel-primary">
  <div class="panel-heading">recent comments</div>  

<div class="list-group-item ds-recent-comments" data-num-items="6" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="50"></div>



</div>

</aside>
       <div class="clearfix"></div>
     </div><!-- row END -->
  </div>
  <footer id="footer" class="container">
  <div class="panel panel-info">
  <section id='footer_widget'></section>  <div class="panel-footer">
  <div id="site-info">
    <span class='author'>
  
  &copy; 2014 RobinChia
  
    &nbsp;&nbsp;</span>
  
  <span id='analytics-51la'></span><span id='analytics-google'>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-48559895-1']);
  _gaq.push(['_trackPageview']);
  _js2load.push({src:('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'});
</script></span><span id='analytics-cnzz'>
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_5774006'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s17.cnzz.com/stat.php%3Fid%3D5774006%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
</span><span id='analytics-baidu'>
<script>
var _hmt = _hmt || [];
_js2load.push({src:"//hm.baidu.com/hm.js?1442f50724afc42380b51f097c43082c"});
</script>
</span>  </div>
  <div id="copyright">Blog powered by <a href='http://zespia.tw/hexo/'><strong>hexo</strong></a> Theme <strong><a href='https://github.com/chenall/hexo-theme-chenall'>chenall</a></strong>(Some change in it)<span class="pull-right"> 更新时间: <em>2014-03-15 16:47:45</em></span></div>
</div>
<div class="clearfix"></div>


  </div>
  </footer>
  
        <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>        
        <script src="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/js/bootstrap.min.js"></script>        
                
        <script src="http://cdn.bootcss.com/prettify/r298/prettify.min.js"></script>    <script type="text/javascript">
   var lang=["bsh", "c", "cc", "cpp", "cs", "csh", "cyc", "cv", "htm", "html",
    "java", "js", "m", "mxml", "perl", "pl", "pm", "py", "rb", "sh",
    "xhtml", "xml", "xsl"];
   var pretty_base='';
   $('script').each(function(){
	var c = $(this).attr('src');
	if (!c)
	    return;
	if (c.match(/(\/)?prettify(\.min)?\.js/i))
	{
	    var index = c.lastIndexOf('/');
	    if (index != -1)
		pretty_base = c.substr(0,index + 1);
	    return false;
	}
   })
   $('pre code').each(function(){
	var c = $(this).attr('class')
	if (!c)
	    return;
	c = c.match(/\s?(lang\-\w+)/i);
	if (c && lang.indexOf(c[1]) == -1)
	{
	    lang.push(c[1]);
	    $.getScript(pretty_base + c[1] + '.min.js');
	}
   })

    $(window).load(function(){
       $("pre").addClass("prettyprint");
       prettyPrint();
    })
</script>    
            <script type="text/javascript">
var duoshuoQuery = {short_name:"robinchia"};
_js2load.push({src:'http://static.duoshuo.com/embed.js',charset:'UTF-8'});
</script>
    
            <!--wumii_relatedItems-->
    
        <script src="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js"></script>    <script type="text/javascript">
(function($){
  $('.entry').each(function(i){
    $(this).find('img').each(function(){
      var alt = this.alt;

      if (alt){
        $(this).before('<span class="caption">' + alt + '</span>');
      }

      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="fancybox' + i + '" />');
    });
  });

  $('.fancybox').fancybox();
})(jQuery);
</script>    
        <script src="http://cdn.bootcss.com/mathjax/2.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>
    
<script type="text/javascript">
$('.ajax_widgets').each(function(){var src=$(this).attr('data-src');if(src)$(this).load('/widgets/'+src+'.html');});
$.each(_js2load,function(index,obj){loadjs(obj.src,obj.charset)});
</script>

<div id="scroll2top">
<img src="/scroll2top/arrow.png"/>
</div>
<script src="/scroll2top/scroll2top.min.js"></script>
<div id="winterland">
  <canvas></canvas>
</div>
<script src="/js/winterland.min.js"></script>

  </body>
</html>
