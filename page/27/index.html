
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>The 27 Page | It so life</title>
<meta name="author" content="RobinChia">

<meta name="description" content="It so life">


<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta property="og:site_name" content="It so life"/>

<!--[if IE]><style>.testIE.IE{display:inline;}</style><![endif]-->
<!--[if lte IE 7]><link rel="stylesheet" href="/css/ie7.css" type="text/css"><![endif]-->
<!--[if (lt IE 9)&(gt IE 7)]><style>.testIE.IE8{display:inline;}</style><![endif]-->
<!--[if gt IE 8]><style>.testIE.IE9{display:inline;}</style><![endif]-->

<link href="/favicon.png" rel="icon">
<link rel="alternate" href="/atom.xml" title="It so life Feed" type="application/atom+xml">

<link rel="stylesheet" href="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.0.3/css/font-awesome.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/prettify/r298/prettify.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" type="text/css">
<link rel="stylesheet" href="/css/style.css" type="text/css">
<!--[if lt IE 9]>
   <style>article,aside,dialog,footer,header,section,footer,nav,figure,menu{display:block}</style>
   <script src="http://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
   <script src="http://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
<link href="http://cdn.staticfile.org/respond.js/1.4.2/respond-proxy.html" id="respond-proxy" rel="respond-proxy" />
<link href="/js/respond.proxy.gif" id="respond-redirect" rel="respond-redirect" />
<script src="/js/respond.proxy.js"></script>
   <script src="http://cdn.bootcss.com/selectivizr/1.0.2/selectivizr-min.js"></script>
<![endif]-->
<script type="text/javascript">
function loadjs(c,d){var a=document.createElement("script");a.async=!0;a.type="text/javascript";a.src=c;a.charset=d||"gbk";(document.getElementsByTagName("HEAD")[0]||document.getElementsByTagName("BODY")[0]).appendChild(a)};
var _protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
var _js2load = [];
</script>

</head>
<body>
      <header id="header" class="container"><nav id="main-nav" class="navbar navbar-default navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="/">It so life</a>
    </div>
    <div  class="collapse navbar-collapse">
      <ul  class="nav navbar-nav">
  
        <li><a href="/" title="Home">Home</a></li>      
        <li><a href="/about/" title="About">About</a></li>      
        <li><a href="/archives/" title="Archives">Archives</a></li>      
      <li class='dropdown'>
        <a class='dropdown-toggle' data-toggle='dropdown' href='#'>website<b class='caret'></b></a>
        <ul class='dropdown-menu pure-menu-selected'>
    
          <li><a href="//groups.google.com/forum/#!forum/pongba" title="TopLanguage">TopLanguage</a></li>    
          <li><a href="//itpub.net/" title="ITPub">ITPub</a></li>    
          <li><a href="//blog.jobbole.com/" title="Bole">Bole</a></li>    
          <li><a href="//nosql-database.org/" title="nosql">nosql</a></li>    
          <li><a href="//gitimmersion.googol.im/" title="Git">Git</a></li>    
        </ul>
      </li>
    
      </ul>
      <ul class="nav navbar-nav navbar-right">
      
        <li><a href="/atom.xml">RSS</a></li>
      
      
        <li><a href="https://twitter.com/robinchia">twitter</a></li>
      
      
      
      
        <li><a href="https://github.com/robinchia">github</a></li>
      
      </ul>
    </div>
  </div>
</nav>
<div class="clearfix"></div>
</header>
  <div id='content' class="container">
     <div class="page-header-wrapper">
      <!--[if lt IE 9]><div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong>提示:</strong>您的浏览器版本太低了,建议升级到 <strong><a href="http://windows.microsoft.com/zh-cn/internet-explorer/download-ie" title="IE9">IE9</a></strong> 以上,本站使用<a href="https://www.google.com/intl/zh-CN/chrome/">Chrome浏览器</a>可以获得最好的显示效果.</div><![endif]-->
      <div class="page-header"><h1 align="center"><big>It so life</big> </h1>
        <h5 align="center"><big>love as life</big></h5>
      </div>
     </div>
     <div class="row">
       <div id="main-col" class="alignleft col-sx-12 col-sm-8 col-md-9 col-lg-9">
      <section id='header_widget'></section>
          <div id="wrapper"><article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-AlgorithmGossip-AlgorithmGossip--GrayCode/">GrayCode</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:44.000Z"> <a href="/2014/02/02/2014-02-02-AlgorithmGossip-AlgorithmGossip--GrayCode/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="graycode">GrayCode</h1>
<h1 id="-algorithm-gossip-gray-code-"><a href="">Algorithm Gossip: 格雷码（Gray Code）</a></h1>
<h2 id="-">说明</h2>
<p>Gray Code是一个数列集合，每个数使用二进位来表示，假设使用n位元来表示每个数好了，任两个数之间只有一个位元值不同，例如以下为3位元的Gray Code：
000 001 011 010 110 111 101 100
由定义可以知道，Gray Code的顺序并不是唯一的，例如将上面的数列反过来写，也是一组Gray Code：
100 101 111 110 010 011 001 000
Gray Code是由贝尔实验室的Frank Gray在1940年代提出的，用来在使用PCM（Pusle Code Modulation）方法传送讯号时避免出错，并于1953年三月十七日取得美国专利。</p>
<h2 id="-">解法</h2>
<p>由于Gray Code相邻两数之间只改变一个位元，所以可观 察Gray Code从1变0或从0变1时的位置，假设有4位元的Gray Code如下：
0000 0001 0011 0010 0110 0111 0101 0100
1100 1101 1111 1110 1010 1011 1001 1000
观察奇数项的变化时，我们发现无论它是第几个Gray Code，永远只改变最右边的位元，如果是1就改为0，如果是0就改为1。
观察偶数项的变化时，我们发现所改变的位元，是由右边算来第一个1的左边位元。
以上两个变化规则是固定的，无论位元数为何；所以只要判断位元的位置是奇数还是偶数，就可以决定要改变哪一个位元的值，为了程式撰写方便，将阵列索引 0当作最右边的值，而在列印结果时，是由索引数字大的开始反向列印。
将2位元的Gray Code当作平面座标来看，可以构成一个四边形，您可以发现从任一顶点出发，绕四边形周长绕一圈，所经过的顶点座标就是一组Gray Code，所以您可以得到四组Gray Code。
同样的将3位元的Gray Code当作平面座标来看的话，可以构成一个正立方体，如果您可以从任一顶点出发，将所有的边长走过，并不重复经过顶点的话，所经过的顶点座标顺序之组合也就是一组Gray Code。</p>
<h2 id="-">实作</h2>
<ul>
<li><p>C
/#include <stdio.h>
/#include <stdlib.h>
/#define MAXBIT 20
/#define TRUE 1
/#define CHANGE_BIT(x) x = ((x) == &#39;0&#39; ? &#39;1&#39; : &#39;0&#39;)
/#define NEXT(x) x = (1 - (x))
int main(void) {
char digit[MAXBIT];
int i, bits, odd;
printf(&quot;输入位元数：&quot;);
scanf(&quot;%d&quot;, &amp;bits);
for(i = 0; i &lt; bits; i++) {
digit[i] = &#39;0&#39;;
printf(&quot;0&quot;);
}
printf(&quot;\n&quot;);
odd = TRUE;
while(1) {
if(odd)
CHANGE_BIT(digit[0]);
else {
// 计算第一个1的位置
for(i = 0; i &lt; bits &amp;&amp; digit[i] == &#39;0&#39;; i++) ;
if(i == bits - 1) // 最后一个Gray Code
break;
CHANGE_BIT(digit[i+1]);
}
for(i = bits - 1; i &gt;= 0; i--)
printf(&quot;%c&quot;, digit[i]);
printf(&quot;\n&quot;);
NEXT(odd);
}
return 0;
}</p>
</li>
<li><p>Java
public class GrayCode {
private char[] digit;
private boolean first;
private boolean odd;
private int count;
public GrayCode(int length) {
digit = new char[length];
for(int i = 0; i &lt; length; i++) {
digit[i] = &#39;0&#39;;
}
first = true;
odd = true;
}
public boolean hasNext() {
// 计算第一个1的位置
for(count = 0;
(count &lt; digit.length) &amp;&amp; (digit[count] == &#39;0&#39;);
count++) ;
return count != digit.length - 1;
}
public char[] next() {
if(first) {
first = false;
return digit;
}
if(odd)
chargeBit(digit, 0);
else {
// 最后一个Gray Code 吗
if(hasNext())
chargeBit(digit, count+1);
}
odd = ((odd == true) ? false : true);
return digit;
}
private void chargeBit(char[] digit, int i) {
digit[i] = ((digit[i] == &#39;0&#39;) ? &#39;1&#39; : &#39;0&#39;);
}
public static void main(String[] args) {
GrayCode code = new GrayCode(4);
while(code.hasNext()) {
char[] digit = code.next();
for(int i = digit.length - 1; i &gt;= 0; i--)
System.out.print(digit[i]);
System.out.println();
}
}
}</p>
</li>
</ul>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/AlgorithmGossip/">AlgorithmGossip</a></li></span></span> | <span class="tags">Tagged <a href="/tags/AlgorithmGossip/" class="label label-primary">AlgorithmGossip</a></span> | <span class="time">recent updated:<time title="2014-03-07 10:37:44"datetime="2014-03-07 10:37:44"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-AlgorithmGossip-AlgorithmGossip--GrayCode/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-AlgorithmGossip-AlgorithmGossip--GrayCode" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-AlgorithmGossip-AlgorithmGossip--GCDPNumber/">GCDPNumber</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:44.000Z"> <a href="/2014/02/02/2014-02-02-AlgorithmGossip-AlgorithmGossip--GCDPNumber/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="gcdpnumber">GCDPNumber</h1>
<h1 id="-algorithm-gossip-"><a href="">Algorithm Gossip: 最大公因数、最小公倍数、因式分解</a></h1>
<h2 id="-">说明</h2>
<p>最大公因数使用辗转相除法来求，最小公倍数则由这个公式来求：
GCD /* LCM = 两数乘积</p>
<h2 id="-">解法</h2>
<p>最大公因数可以使用递回与非递回求解，因式分解基本上就是使用小于输入数的数值当作除数，去除以输入数值，如果可以整除就视为因数，要比较快的解法就是求出小于该数的所有质数，并试试看是不是可以整除，求质数的问题是另一个课题，请参考 <a href="">Eratosthenes 筛选求质数</a>。</p>
<h2 id="-">实作（最大公因数、最小公倍数）</h2>
<ul>
<li><p>C
/#include <stdio.h>
/#include <stdlib.h>
int main(void) {
int m, n, r;
int s;
printf(&quot;输入两数：&quot;);
scanf(&quot;%d %d&quot;, &amp;m, &amp;n);
s = m /* n;
while(n != 0) {
r = m % n;
m = n;
n = r;
}
printf(&quot;GCD：%d\n&quot;, m);
printf(&quot;LCM：%d\n&quot;, s/m);
return 0;
}</p>
</li>
<li><p>Java
public class GcdLcm {
public static int gcdOf(int m, int n) {
int r;
while(n != 0) {
r = m % n;
m = n;
n = r;
}
return m;
}
public static int lcmOf(int m, int n) {
return m /* n / gcdOf(m, n);
}
public static void main(String[] args) {
System.out.println(&quot;GCD of (10, 4) = &quot; +
GcdLcm.gcdOf(10, 4));
System.out.println(&quot;LCM of (10, 4) = &quot; +
GcdLcm.lcmOf(10, 4));
}
}</p>
</li>
</ul>
<h2 id="-">实作（因式分解）</h2>
<ul>
<li><p>C（不用质数表）
/#include <stdio.h>
/#include <stdlib.h>
int main(void) {
int i, n;
printf(&quot;请输入整数：&quot;);
scanf(&quot;%d&quot;, &amp;n);
printf(&quot;%d = &quot;, n);
for(i = 2; i /<em> i &lt;= n;) {
if(n % i == 0) {
printf(&quot;%d /</em> &quot;, i);
n /= i;
}
else
i++;
}
printf(&quot;%d\n&quot;, n);
return 0;
}</p>
</li>
<li><p>C（使用质数表）
/#include <stdio.h>
/#include <stdlib.h>
/#define N 1000
int prime(int/<em>); // 求质数表
void factor(int/</em>, int); // 求factor
int main(void) {
int ptable[N+1] = {0};
int count, i, temp;
count = prime(ptable);
printf(&quot;请输入一数：&quot;);
scanf(&quot;%d&quot;, &amp;temp);
factor(ptable, temp);
printf(&quot;\n&quot;);
return 0;
}
int prime(int/<em> pNum) {
int i, j;
int prime[N+1];
for(i = 2; i &lt;= N; i++)
prime[i] = 1;
for(i = 2; i/</em>i &lt;= N; i++) {
if(prime[i] == 1) {
for(j = 2/<em>i; j &lt;= N; j++) {
if(j % i == 0)
prime[j] = 0;
}
}
}
for(i = 2, j = 0; i &lt; N; i++) {
if(prime[i] == 1)
pNum[j++] = i;
}
return j;
}
void factor(int/</em> table, int num) {
int i;
for(i = 0; table[i] /<em> table[i] &lt;= num;) {
if(num % table[i] == 0) {
printf(&quot;%d /</em> &quot;, table[i]);
num /= table[i];
}
else
i++;
}
printf(&quot;%d\n&quot;, num);
}</p>
</li>
<li><p>Java（使用质数表）
import java.util.ArrayList;
public class Factor {
public static int[] factor(int num) {
int[] pNum = Prime.findPrimes(num);
ArrayList list = new ArrayList();
for(int i = 0; pNum[i] /* pNum[i] &lt;= num;) {
if(num % pNum[i] == 0) {
list.add(new Integer(pNum[i]));
num /= pNum[i];
}
else
i++;
}
list.add(new Integer(num));
int[] f = new int[list.size()];
Object[] objs = list.toArray();
for(int i = 0; i &lt; f.length; i++) {
f[i] = ((Integer) objs[i]).intValue();
}
return f;
}
public static void main(String[] args) {
int[] f = Factor.factor(100);
for(int i = 0; i &lt; f.length; i++) {
System.out.print(f[i] + &quot; &quot;);
}
System.out.println();
}
}</p>
</li>
</ul>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/AlgorithmGossip/">AlgorithmGossip</a></li></span></span> | <span class="tags">Tagged <a href="/tags/AlgorithmGossip/" class="label label-primary">AlgorithmGossip</a></span> | <span class="time">recent updated:<time title="2014-03-07 10:37:52"datetime="2014-03-07 10:37:52"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-AlgorithmGossip-AlgorithmGossip--GCDPNumber/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-AlgorithmGossip-AlgorithmGossip--GCDPNumber" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-AlgorithmGossip-AlgorithmGossip--ArmstrongNumber/">ArmstrongNumber</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:44.000Z"> <a href="/2014/02/02/2014-02-02-AlgorithmGossip-AlgorithmGossip--ArmstrongNumber/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="armstrongnumber">ArmstrongNumber</h1>
<h1 id="-algorithm-gossip-"><a href="">Algorithm Gossip: 阿姆斯壮数</a></h1>
<h2 id="-">说明</h2>
<p>在三位的整数中，例如153可以满足13 + 53 + 33 = 153，这样的数称之为Armstrong数，试写出一程式找出所有的三位数Armstrong数。</p>
<h2 id="-">解法</h2>
<p>Armstrong数的寻找，其实就是在问如何将一个数字分解为个位数、十位数、百位数......，这只要使用除法与余数运算就可以了，例如输入 input为abc，则：
a = input / 100
b = (input%100) / 10
c = input % 10</p>
<h2 id="-">实作</h2>
<ul>
<li><p>C
/#include <stdio.h>
/#include <time.h>
/#include <math.h>
int main(void) {
int a, b, c;
int input;
printf(&quot;寻找Armstrong数：\n&quot;);
for(input = 100; input &lt;= 999; input++) {
a = input / 100;
b = (input % 100) / 10;
c = input % 10;
if(a/<em>a/</em>a + b/<em>b/</em>b + c/<em>c/</em>c == input)
printf(&quot;%d &quot;, input);
}
printf(&quot;\n&quot;);
return 0;
}</p>
</li>
<li><p>Java
public class Armstrong {
public static void main(String[] args) {
System.out.println(&quot;寻找Armstrong数：&quot;);
for(int i = 100; i &lt;= 999; i++) {
int a = i / 100;
int b = (i % 100) / 10;
int c = i % 10;
if(a/<em>a/</em>a + b/<em>b/</em>b + c/<em>c/</em>c == i)
System.out.print(i + &quot; &quot;);
}
System.out.println();
}
}</p>
</li>
</ul>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/AlgorithmGossip/">AlgorithmGossip</a></li></span></span> | <span class="tags">Tagged <a href="/tags/AlgorithmGossip/" class="label label-primary">AlgorithmGossip</a></span> | <span class="time">recent updated:<time title="2014-03-07 10:35:39"datetime="2014-03-07 10:35:39"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-AlgorithmGossip-AlgorithmGossip--ArmstrongNumber/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-AlgorithmGossip-AlgorithmGossip--ArmstrongNumber" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-xml-xstream--使用XStream序列化、反序列化XML数据时遇到的各种问题/">使用XStream序列化、反序列化XML数据时遇到的各种问题</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:44.000Z"> <a href="/2014/02/02/2014-02-02-xml-xstream--使用XStream序列化、反序列化XML数据时遇到的各种问题/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-xstream-xml-">使用XStream序列化、反序列化XML数据时遇到的各种问题</h1>
<p>现在参与的项目是一个纯Application Server，整个Server都是自己搭建的，使用JMS消息实现客户端和服务器的交互，交互的数据格式采用XML。说来惭愧，开始为了赶进度，所有XML消息都是使用字符串拼接的，而XML的解析则是使用DOM方式查找的。我很早就看这些代码不爽了，可惜一直没有时间去重构，最近项目加了几个人，而且美国那边也开始渐渐的把这个项目开发的控制权交给我们了，所以我开始有一些按自己的方式开发的机会了。因而最近动手开始重构这些字符串拼接的代码。</p>
<p>对XML到Java Bean的解析框架，熟悉一点的只有Digester和XStream，Digester貌似只能从XML文件解析成Java Bean对象，所以只能选择XStream来做了，而且同组的其他项目也有在用XStream。一直听说XStream的使用比较简单，而且我对ThoughtWorks这家公司一直比较有好感，所以还以为引入XStream不会花太多时间，然而使用以后才发现XStream并没有想象的你那么简单。不过这个也有可能是因为我不想改变原来的XML数据格式，而之前的XML数据格式的设计自然不会考虑到如何便利的使用XStream。因而记录在使用过程中遇到的问题，供后来人参考，也为自己以后如果打算开其源码提供参考。废话就到这里了，接下来步入正题。</p>
<p>首先对于简单的引用，XStream使用起来确实比较简单，比如自定义标签的属性、使用属性和使用子标签的定义等：
@XStreamAlias(&quot;request&quot;)
public class XmlRequest1 {
    private static XStream xstream;
    static {
        xstream = new XStream();
        xstream.autodetectAnnotations(true);
    }</p>
<pre><code>@XStreamAsAttribute
private String from;

@XStreamAsAttribute
@XStreamAlias(&quot;calculate-method&quot;)
private String calculateMethod;

@XStreamAlias(&quot;request-time&quot;)
private Date requestTime;

@XStreamAlias(&quot;input-files&quot;)
private List&lt;InputFileInfo&gt; inputFiles;

public static String toXml(XmlRequest1 request) {
    StringWriter writer = new StringWriter();
    writer.append(Constants.XML_HEADER);
    xstream.toXML(request, writer);
    return writer.toString();
}
public static XmlRequest1 toInstance(String xmlContent) {
    return (XmlRequest1)xstream.fromXML(xmlContent);
</code></pre><p>}
<img src="" alt="">
    @XStreamAlias(&quot;input-file&quot;)
    public static class InputFileInfo {
        private String type;
        private String fileName;
        <img src="" alt="">
    }
    public static void main(String[] args) {
        XmlRequest1 request = buildXmlRequest();
        System.out.println(XmlRequest1.toXml(request));
    }
    private static XmlRequest1 buildXmlRequest() {
        <img src="" alt="">
    }
}</p>
<p> 对以上Request定义，我们可以得到如下结果：</p>
<p>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</p>
<request from="levin@host" calculate-method="advanced">
 <request-time>2012-11-28 17:11:54.664 UTC</request-time>
 <input-files>
    <input-file>
      <type>DATA</type>
      <fileName>data.2012.11.29.dat</fileName>
    </input-file>
    <input-file>
      <type>CALENDAR</type>
      <fileName>calendar.2012.11.29.dat</fileName>
    </input-file>
 </input-files>
</request>

<p>可惜这个世界不会那么清净，这个格式有些时候貌似并不符合要求，比如request-time的格式、input-files的格式，我们实际需要的格式是这样的：</p>
<p>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</p>
<request from="levin@host" calculate-method="advanced">
 <request-time>20121128T17:51:05</request-time>
 <input-file type="DATA">data.2012.11.29.dat</input-file>
 <input-file type="CALENDAR">calendar.2012.11.29.dat</input-file>
</request>

<p>对不同Date格式的支持可以是用Converter实现，在XStream中默认使用自己实现的DateConverter，它支持的格式是：yyyy-MM-dd HH:mm:ss.S &#39;UTC&#39;，然而我们现在需要的格式是yyyy-MM-dd’T’HH:mm:ss，如果使用XStream直接注册DateConverter，可以使用配置自己的DateConverter，但是由于DateConverter的构造函数的定义以及@XStreamConverter的构造函数参数的支持方式的限制，貌似DateConverter不能很好的支持注解方式的注册，因而我时间了一个自己的DateConverter以支持注解：</p>
<p>public class LevinDateConverter extends DateConverter {
    public LevinDateConverter(String dateFormat) {
        super(dateFormat, new String[] { dateFormat });
    }
}</p>
<p>在requestTime字段中需要加入以下注解定义：</p>
<p>@XStreamConverter(value=LevinDateConverter.class, strings={&quot;yyyyMMdd&#39;T&#39;HH:mm:ss&quot;})
@XStreamAlias(&quot;request-time&quot;)
private Date requestTime;</p>
<p>对集合类，XStream提供了@XStreamImplicit注解，以将集合中的内容摊平到上一层XML元素中，其中itemFieldName的值为其使用的标签名，此时InputFileInfo类中不需要@XStreamAlias标签的定义：</p>
<p>@XStreamImplicit(itemFieldName=&quot;input-file&quot;)
private List<InputFileInfo> inputFiles;</p>
<p>对InputFileInfo中的字段，type作为属性很容易，只要为它加上@XStreamAsAttribute注解即可，而将fileName作为input-file标签的一个内容字符串，则需要使用ToAttributedValueConverter，其中Converter的参数为需要作为字符串内容的字段名：</p>
<p>@XStreamConverter(value=ToAttributedValueConverter.class, strings={&quot;fileName&quot;})
public static class InputFileInfo {
    @XStreamAsAttribute
    private String type;
private String fileName;
<img src="" alt="">
}</p>
<p>XStream对枚举类型的支持貌似不怎么好，默认注册的EnumSingleValueConverter只是使用了Enum提供的name()和静态的valueOf()方法将enum转换成String或将String转换回enum。然而有些时候XML的字符串和类定义的enum值并不完全匹配，最常见的就是大小写的不匹配，此时需要写自己的Converter。在这种情况下，我一般会在enum中定义一个name属性，这样就可以自定义enum的字符串表示。比如有TimePeriod的enum：</p>
<p>public enum TimePeriod {
    MONTHLY(&quot;monthly&quot;), WEEKLY(&quot;weekly&quot;), DAILY(&quot;daily&quot;);</p>
<pre><code>private String name;

public String getName() {
    return name;
}

private TimePeriod(String name) {
    this.name = name;
}

public static TimePeriod toEnum(String timePeriod) {
    try {
        return Enum.valueOf(TimePeriod.class, timePeriod);
    } catch(Exception ex) {
        for(TimePeriod period : TimePeriod.values()) {
            if(period.getName().equalsIgnoreCase(timePeriod)) {
                return period;
            }
        }
        throw new IllegalArgumentException(&quot;Cannot convert &lt;&quot; + timePeriod + &quot;&gt; to TimePeriod enum&quot;);
    }
}
</code></pre><p>}</p>
<p>我们可以编写以下Converter以实现对枚举类型的更宽的容错性：</p>
<p>public class LevinEnumSingleNameConverter extends EnumSingleValueConverter {
    private static final String CUSTOM_ENUM_NAME_METHOD = &quot;getName&quot;;
    private static final String CUSTOM_ENUM_VALUE_OF_METHOD = &quot;toEnum&quot;;</p>
<pre><code>private Class&lt;? extends Enum&lt;?&gt;&gt; enumType;

public LevinEnumSingleNameConverter(Class&lt;? extends Enum&lt;?&gt;&gt; type) {
    super(type);
    this.enumType = type;
}

@Override
public String toString(Object obj) {
    Method method = getCustomEnumNameMethod();
    if(method == null) {
        return super.toString(obj);
    } else {
        try {
            return (String)method.invoke(obj, (Object[])null);
        } catch(Exception ex) {
            return super.toString(obj);
        }
    }
}

@Override
public Object fromString(String str) {
    Method method = getCustomEnumStaticValueOfMethod();
    if(method == null) {
        return enhancedFromString(str);
    }
    try {
        return method.invoke(null, str);
    } catch(Exception ex) {
        return enhancedFromString(str);
    }
}

private Method getCustomEnumNameMethod() {
    try {
        return enumType.getMethod(CUSTOM_ENUM_NAME_METHOD, (Class&lt;?&gt;[])null);
    } catch(Exception ex) {
        return null;
    }
}

private Method getCustomEnumStaticValueOfMethod() {
    try {
        Method method = enumType.getMethod(CUSTOM_ENUM_VALUE_OF_METHOD, (Class&lt;?&gt;[])null);
        if(method.getModifiers() == Modifier.STATIC) {
            return method;
        }
        return null;
    } catch(Exception ex) {
        return null;
    }
}

private Object enhancedFromString(String str) {
    try {
        return super.fromString(str);
    } catch(Exception ex) {
        for(Enum&lt;?&gt; item : enumType.getEnumConstants()) {
            if(item.name().equalsIgnoreCase(str)) {
                return item;
            }
        }
        throw new IllegalStateException(&quot;Cannot converter &lt;&quot; + str + &quot;&gt; to enum &lt;&quot; + enumType + &quot;&gt;&quot;);
    }
}
</code></pre><p>}</p>
<p>如下方式使用即可：</p>
<p>@XStreamAsAttribute
@XStreamAlias(&quot;time-period&quot;)
@XStreamConverter(value=LevinEnumSingleNameConverter.class)
private TimePeriod timePeriod;</p>
<p>对double类型，貌似默认的DoubleConverter实现依然不给力，它不支持自定义的格式，比如我们想在序列化的时候用一下格式：” /#/#/#,/#/#0.0/#/#/#/#/#/#/#/#”，此时又需要编写自己的Converter：</p>
<p>public class FormatableDoubleConverter extends DoubleConverter {
    private String pattern;
    private DecimalFormat formatter;</p>
<pre><code>public FormatableDoubleConverter(String pattern) {
    this.pattern = pattern;
    this.formatter = new DecimalFormat(pattern);
}

@Override
public String toString(Object obj) {
    if(formatter == null) {
        return super.toString(obj);
    } else {
        return formatter.format(obj);
    }
}

@Override
public Object fromString(String str) {
    try {
        return super.fromString(str);
    } catch(Exception ex) {
        if(formatter != null) {
            try {
                return formatter.parse(str);
            } catch(Exception e) {
                throw new IllegalArgumentException(&quot;Cannot parse &lt;&quot; + str + &quot;&gt; to double value&quot;, e);
            }
        }
        throw new IllegalArgumentException(&quot;Cannot parse &lt;&quot; + str + &quot;&gt; to double value&quot;, ex);
    }
}

public String getPattern() {
    return pattern;
}
</code></pre><p>}</p>
<p>使用方式和之前的Converter类似：</p>
<p>@XStreamAsAttribute
@XStreamConverter(value=FormatableDoubleConverter.class, strings={&quot;/#/#/#,/#/#0.0/#/#/#/#/#/#/#/#&quot;})
private double value;</p>
<p>最后，还有两个XStream没法实现的，或者说我没有找到一个更好的实现方式的场景。<strong>第一种场景是**</strong>XStream<strong>**不能很好的处理对象组合问题：</strong></p>
<p>在面向对象编程中，一般尽量的倾向于抽取相同的数据成一个类，而通过组合的方式构建整个数据结构。比如Student类中有name、address，Address是一个类，它包含city、code、street等信息，此时如果要对Student对象做如下格式序列化：</p>
<student name=”Levin”>
 <city>shanghai</city>
 <street>zhangjiang</street>
 <code>201203</code>
</student>

<p>貌似我没有找到可以实现的方式，XStream能做是在中间加一层address标签。对这种场景的解决方案，一种是将Address中的属性平摊到Student类中，另一种是让Student继承自Address类。不过貌似这两种都不是比较理想的办法。</p>
<p><strong>第二种场景是XStream**</strong>不能很好的处理多态问题：**</p>
<p>比如我们有一个Trade类，它可能表示不同的产品：
public class Trade {
    private String tradeId;
    private Product product;
<img src="" alt="">
}
abstract class Product {
    private String name;
    public Product(String name) {
        this.name = name;
}
<img src="" alt="">
}
class FX extends Product {
    private double ratio;
    public FX() {
        super(&quot;fx&quot;);
    }
    <img src="" alt="">
}
class Future extends Product {
    private double maturity;
    public Future() {
        super(&quot;future&quot;);
    }
    <img src="" alt="">
}</p>
<p>通过一些简单的设置，我们能得到如下XML格式：</p>
<trades>
 <trade trade-id="001">
    <product class="levin.xstream.blog.FX" name="fx" ratio="0.59"/>
 </trade>
 <trade trade-id="002">
    <product class="levin.xstream.blog.Future" name="future" maturity="2.123"/>
 </trade>
</trades>

<p>作为数据文件，对Java类的定义显然是不合理的，因而简单一些，我们可以编写自己的Converter将class属性从product中去除：</p>
<p>xstream.registerConverter(new ProductConverter(
        xstream.getMapper(), xstream.getReflectionProvider()));</p>
<pre><code>public ProductConverter(Mapper mapper, ReflectionProvider reflectionProvider) {
    super(mapper, reflectionProvider);
}

@Override
public boolean canConvert(@SuppressWarnings(&quot;rawtypes&quot;) Class type) {
    return Product.class.isAssignableFrom(type);
}

@Override
protected Object instantiateNewInstance(HierarchicalStreamReader reader, UnmarshallingContext context) {
    Object currentObject = context.currentObject();
    if(currentObject != null) {
        return currentObject;
    }

    String name = reader.getAttribute(&quot;name&quot;);
    if(&quot;fx&quot;.equals(name)) {
        return reflectionProvider.newInstance(FX.class);
    } else if(&quot;future&quot;.equals(name)) {
        return reflectionProvider.newInstance(Future.class);
    }
    throw new IllegalStateException(&quot;Cannot convert &lt;&quot; + name + &quot;&gt; product&quot;);
}
</code></pre><p>}</p>
<p>在所有Production上定义@XStreamAlias(“product”)注解。这时的XML输出结果为：</p>
<trades>
 <trade trade-id="001">
    <product name="fx" ratio="0.59"/>
 </trade>
 <trade trade-id="002">
    <product name="future" maturity="2.123"/>
 </trade>
</trades>

<p>然而如果有人希望XML的输出结果如下呢?</p>
<trades>
 <trade trade-id="001">
    <fx ratio="0.59"/>
 </trade>
 <trade trade-id="002">
    <future maturity="2.123"/>
 </trade>
</trades>

<p>大概找了一下，可能可以定义自己的Mapper来解决，不过XStream的源码貌似比较复杂，没有时间深究这个问题，留着以后慢慢解决吧。</p>
<p><strong>补充：</strong></p>
<p>对Map类型数据，XStream默认使用以下格式显示：</p>
<map class="linked-hash-map">
    <entry>
      <string>key1</string>
      <string>value1</string>
    </entry>
    <entry>
      <string>key2</string>
      <string>value2</string>
    </entry>
 </map>



<p>但是对一些简单的Map，我们希望如下显示：
 <map>
    <entry key="key1" value="value1"/>
    <entry key="key2" value="value2"/>
 </map></p>
<p>对这种需求需要通过编写Converter解决，继承自MapConverter，覆盖以下函数，这里的Map默认key和value都是String类型，如果他们不是String类型，需要另外添加逻辑：
@SuppressWarnings(&quot;rawtypes&quot;)
@Override
public void marshal(Object source, HierarchicalStreamWriter writer,
        MarshallingContext context) {
    Map map = (Map) source;
    for (Iterator iterator = map.entrySet().iterator(); iterator.hasNext();) {
        Entry entry = (Entry) iterator.next();
        ExtendedHierarchicalStreamWriterHelper.startNode(writer, mapper()
                .serializedClass(Map.Entry.class), entry.getClass());</p>
<pre><code>    writer.addAttribute(&quot;key&quot;, entry.getKey().toString());
    writer.addAttribute(&quot;value&quot;, entry.getValue().toString());
    writer.endNode();
}
</code></pre><p>}</p>
<p>@Override
@SuppressWarnings({ &quot;unchecked&quot;, &quot;rawtypes&quot; })
protected void putCurrentEntryIntoMap(HierarchicalStreamReader reader,
        UnmarshallingContext context, Map map, Map target) {
    Object key = reader.getAttribute(&quot;key&quot;);
    Object value = reader.getAttribute(&quot;value&quot;);</p>
<pre><code>target.put(key, value);
</code></pre><p>}</p>
<p>但是只是使用Converter，得到的结果多了一个class属性：
 <map class="linked-hash-map">
    <entry key="key1" value="value1"/>
    <entry key="key2" value="value2"/>
 </map></p>
<p>在XStream中，如果定义的字段是一个父类或接口，在序列化是会默认加入class属性以确定反序列化时用的类，为了去掉这个class属性，可以定义默认的实现类来解决（虽然感觉这种解决方案不太好，但是目前还没有找到更好的解决方案）。</p>
<p><em>*
</em>xstream.addDefaultImplementation(LinkedHashMap.class, Map.class);*</p>
<p>来源： <a href="[http://www.blogjava.net/DLevin/archive/2012/11/30/392240.html](http://www.blogjava.net/DLevin/archive/2012/11/30/392240.html)">[http://www.blogjava.net/DLevin/archive/2012/11/30/392240.html](http://www.blogjava.net/DLevin/archive/2012/11/30/392240.html)</a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/xml/">xml</a></li></span><span class="breadcrumb"><li><a href="/categories/xml/">xml</a></li><li><a href="/categories/xml/xstream/">xstream</a></li></span></span> | <span class="tags">Tagged <a href="/tags/xml/" class="label label-primary">xml</a><a href="/tags/xstream/" class="label label-success">xstream</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:44"datetime="2014-03-07 09:54:44"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-xml-xstream--使用XStream序列化、反序列化XML数据时遇到的各种问题/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-xml-xstream--使用XStream序列化、反序列化XML数据时遇到的各种问题" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-xml-jdom--jdom解析xml--JavaEye技术网站/">jdom解析xml </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:44.000Z"> <a href="/2014/02/02/2014-02-02-xml-jdom--jdom解析xml--JavaEye技术网站/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="jdom-xml">jdom解析xml</h1>
<p>jdom解析xml
    xml是一种广为使用的可扩展标记语言，java中解析xml的方式有很多，最常用的像jdom、dom4j、sax等等。前两天刚好有个程序需要解析xml，就学了下jdom，写了个小例子，这里做个学习笔记。</p>
<pre><code>要使用jdom解析xml文件，需要下载jdom的包，我使用的是jdom-1.1。解压之后，将lib文件夹下的.jar文件以及build文件夹下的jdom.jar拷贝到工程文件夹下，然后就可以使用jdom操作xml文件了。

一、读取xml文件

假设有这样一个xml文件：
</code></pre><p>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</p>
<p><sys-config>
    <jdbc-info>
        <driver-class-name>oracle.jdbc.driver.OracleDriver</driver-class-name>
        <url>jdbc:oracle:thin:@localhost:1521:database</url>
        <user-name>why</user-name>
        <password>why</password>
    </jdbc-info>
    <provinces-info>
        <province id="hlj" name="黑龙江">
            <city id="harb">哈尔滨</city>
            <city id="nj">嫩江</city>
        </province>
        <province id="jl" name="吉林"></province>
    </provinces-info>
</sys-config></p>
<pre><code>首先，用 org.jdom.input.SAXBuilder 这个类取得要操作的xml文件，会返回一个 org.jdom.Document 对象，这里需要做一下异常处理。然后，取得这个xml文件的根节点，org.jdom.Element 代表xml文件中的一个节点，取得跟节点后，便可以读取xml文件中的信息。利用 org.jdom.xpath.XPath 可以取得xml中的任意制定的节点中的信息。
例如，要取得上面文件中的 &lt;jdbc-info&gt; 下的 &lt;driver-class-name&gt; 中的内容，先取得这个节点Element driverClassNameElement = (Element)XPath.selectSingleNode(rootEle, &quot;//sys-config/jdbc-info/driver-class-name&quot;)，注意，根节点前要使用两个 &quot;/&quot; ，然后，用 driverClassNameElement.getText() 便可以取得这个节点下的信息。
如果一个节点下有多个名称相同的子节点，可以用XPath.selectNodes()方法取得多个子节点的List，遍历这个List就可以操作各个子节点的内容了。
下面是我写的读取上面xml文件的例子，比起文字描述更直观一些吧：
</code></pre><p>package com.why.jdom;</p>
<p>import java.io.IOException;
import java.util.Iterator;
import java.util.List;</p>
<p>import org.jdom.input.SAXBuilder;
import org.jdom.xpath.XPath;
import org.jdom.Document;
import org.jdom.Element;
import org.jdom.JDOMException;</p>
<p>public class ReadXML {</p>
<pre><code>/**
 * @param args
 */
public static void main(String[] args) {
    SAXBuilder sax = new SAXBuilder();
    try {
        Document doc = sax.build(&quot;src/config.xml&quot;);
        Element rootEle = doc.getRootElement();
        Element driverClassNameElement = (Element)XPath.selectSingleNode(rootEle, &quot;//sys-config/jdbc-info/driver-class-name&quot;);
        String driverClassName = driverClassNameElement.getText();
        System.out.println(&quot;driverClassName = &quot; + driverClassName);
        List provinceList = XPath.selectNodes(rootEle, &quot;//sys-config/provinces-info/province&quot;);
        for(Iterator it = provinceList.iterator();it.hasNext();){
            Element provinceEle = (Element)it.next();
            String proId = provinceEle.getAttributeValue(&quot;id&quot;);
            String proName = provinceEle.getAttributeValue(&quot;name&quot;);

            System.out.println(&quot;provinceId = &quot; + proId + &quot;   provinceName = &quot; + proName);
            List cityEleList = (List)provinceEle.getChildren(&quot;city&quot;);
            for(Iterator cityIt = cityEleList.iterator();cityIt.hasNext();){
                Element cityEle = (Element)cityIt.next();
                String cityId = cityEle.getAttributeValue(&quot;id&quot;);
                String cityName = cityEle.getText();

                System.out.println(&quot;    cityId = &quot; + cityId + &quot;   cityName = &quot; + cityName);
            }
        }
    } catch (JDOMException e) {
        // TODO 自动生成 catch 块
        e.printStackTrace();
    } catch (IOException e) {
        // TODO 自动生成 catch 块
        e.printStackTrace();
    }

}
</code></pre><p>}</p>
<pre><code>二、写xml文件

写xml文件与读取xml文件的操作类似，利用 org.jdom.output.XMLOutputter 就可以将处理好的xml输出到文件了。可以设置文件的编码方式，不过一般使用UTF-8就可以了。代码如下：
</code></pre><p>package com.why.jdom;</p>
<p>import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;</p>
<p>import org.jdom.Document;
import org.jdom.Element;
import org.jdom.output.XMLOutputter;</p>
<p>public class WriteXML {</p>
<pre><code>/**
 * @param args
 */
public static void main(String[] args) {
    // TODO 自动生成方法存根
    Element rootEle = new Element(&quot;sys-config&quot;);
    Element provincesEle = new Element(&quot;provinces-info&quot;);
    Element provinceEle = new Element(&quot;province&quot;);
    provinceEle.setAttribute(&quot;id&quot;,&quot;hlj&quot;);
    provinceEle.setAttribute(&quot;name&quot;,&quot;黑龙江省&quot;);
    Element cityEle1 = new Element(&quot;city&quot;);
    cityEle1.setAttribute(&quot;id&quot;,&quot;harb&quot;);
    cityEle1.addContent(&quot;哈尔滨&quot;);
    Element cityEle2 = new Element(&quot;city&quot;);
    cityEle2.setAttribute(&quot;id&quot;,&quot;nj&quot;);
    cityEle2.addContent(&quot;嫩江&quot;);
    provinceEle.addContent(cityEle1);
    provinceEle.addContent(cityEle2);
    provincesEle.addContent(provinceEle);
    rootEle.addContent(provincesEle);
    Document doc = new Document(rootEle);
    XMLOutputter out = new XMLOutputter();
</code></pre><p>//        out.setFormat(Format.getCompactFormat().setEncoding(&quot;GBK&quot;));//设置文件编码，默认为UTF-8
        String xmlStr = out.outputString(doc);
        System.out.println(xmlStr);
        try {
            out.output(doc, new FileOutputStream(&quot;c:/test.xml&quot;));
        } catch (FileNotFoundException e) {
            // TODO 自动生成 catch 块
            e.printStackTrace();
        } catch (IOException e) {
            // TODO 自动生成 catch 块
            e.printStackTrace();
        }
    }</p>
<p>}</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/xml/">xml</a></li></span><span class="breadcrumb"><li><a href="/categories/xml/">xml</a></li><li><a href="/categories/xml/jdom/">jdom</a></li></span></span> | <span class="tags">Tagged <a href="/tags/jdom/" class="label label-primary">jdom</a><a href="/tags/xml/" class="label label-success">xml</a></span> | <span class="time">recent updated:<time title="2014-04-07 16:31:40"datetime="2014-04-07 16:31:40"> abr. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-xml-jdom--jdom解析xml--JavaEye技术网站/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-xml-jdom--jdom解析xml--JavaEye技术网站" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>





<ul id="pagination" class="pagination pagination-lg">
  <li><a class="extend prev" href="/page/26/">&laquo;</a></li><li><a class="page-number" href="/">1</a></li><li><a class="page-number" href="/page/2/">2</a></li><li><span class="space">&hellip;</span></li><li><a class="page-number" href="/page/24/">24</a></li><li><a class="page-number" href="/page/25/">25</a></li><li><a class="page-number" href="/page/26/">26</a></li><li class="active"><li><span class="page-number current">27</span></li><li><a class="page-number" href="/page/28/">28</a></li><li><a class="page-number" href="/page/29/">29</a></li><li><a class="page-number" href="/page/30/">30</a></li><li><span class="space">&hellip;</span></li></li><li><a class="page-number" href="/page/161/">161</a></li><li><a class="page-number" href="/page/162/">162</a></li><li><a class="extend next" href="/page/28/">&raquo;</a></li>
  <div class="clearfix"></div>
</ul></div><!--wapper-->
       </div><!-- ID main-col END -->
       <aside id="sidebar" class="alignright col-sx-6 col-sm-4 col-md-3 col-lg-3">
<div id="widget_search" class="widget panel panel-primary">
    <form action="//google.com/search" method="get" accept-charset="utf-8">
  <div class="input-group">
    <input class="form-control" id="searchbox" type="search" name="q" results="0" placeholder="search">
    <span class="input-group-btn">
      <button class="btn btn-default" type="submit">Go!</button>
    </span>
    <input type="hidden" name="q" value="site:itsolife.com">
  </div>
</form>
</div>

<div id="widget_category" class="widget panel panel-primary">
  <div class="panel-heading">category</div>  <div data-src='category' class='ajax_widgets'>正在加载...</div>
</div>

<div id="widget_recent_posts" class="widget panel panel-primary">
  <div class="panel-heading">recent posts</div>  <div data-src='recent_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_tagcloud" class="widget panel panel-primary">
  <div class="panel-heading">tagcloud</div>  <div data-src='tagcloud' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_latest_update_posts" class="widget panel panel-primary">
  <div class="panel-heading">最近更新</div>  <div data-src='latest_update_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_recent_comments" class="widget panel panel-primary">
  <div class="panel-heading">recent comments</div>  

<div class="list-group-item ds-recent-comments" data-num-items="6" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="50"></div>



</div>

</aside>
       <div class="clearfix"></div>
     </div><!-- row END -->
  </div>
  <footer id="footer" class="container">
  <div class="panel panel-info">
  <section id='footer_widget'></section>  <div class="panel-footer">
  <div id="site-info">
    <span class='author'>
  
  &copy; 2014 RobinChia
  
    &nbsp;&nbsp;</span>
  
  <span id='analytics-51la'></span><span id='analytics-google'>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-48559895-1']);
  _gaq.push(['_trackPageview']);
  _js2load.push({src:('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'});
</script></span><span id='analytics-cnzz'>
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_5774006'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s17.cnzz.com/stat.php%3Fid%3D5774006%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
</span><span id='analytics-baidu'>
<script>
var _hmt = _hmt || [];
_js2load.push({src:"//hm.baidu.com/hm.js?1442f50724afc42380b51f097c43082c"});
</script>
</span>  </div>
  <div id="copyright">Site powered by <a href='http://zespia.tw/hexo/'><strong>hexo</strong></a>  update time: <em>2014-04-07 19:05:46</em></span></div>
</div>
<div class="clearfix"></div>


  </div>
  </footer>
  
        <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>        
        <script src="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/js/bootstrap.min.js"></script>        
                
        <script src="http://cdn.bootcss.com/prettify/r298/prettify.min.js"></script>    <script type="text/javascript">
   var lang=["bsh", "c", "cc", "cpp", "cs", "csh", "cyc", "cv", "htm", "html",
    "java", "js", "m", "mxml", "perl", "pl", "pm", "py", "rb", "sh",
    "xhtml", "xml", "xsl"];
   var pretty_base='';
   $('script').each(function(){
	var c = $(this).attr('src');
	if (!c)
	    return;
	if (c.match(/(\/)?prettify(\.min)?\.js/i))
	{
	    var index = c.lastIndexOf('/');
	    if (index != -1)
		pretty_base = c.substr(0,index + 1);
	    return false;
	}
   })
   $('pre code').each(function(){
	var c = $(this).attr('class')
	if (!c)
	    return;
	c = c.match(/\s?(lang\-\w+)/i);
	if (c && lang.indexOf(c[1]) == -1)
	{
	    lang.push(c[1]);
	    $.getScript(pretty_base + c[1] + '.min.js');
	}
   })

    $(window).load(function(){
       $("pre").addClass("prettyprint");
       prettyPrint();
    })
</script>    
            <script type="text/javascript">
var duoshuoQuery = {short_name:"robinchia"};
_js2load.push({src:'http://static.duoshuo.com/embed.js',charset:'UTF-8'});
</script>
    
            <!--wumii_relatedItems-->
    
        <script src="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js"></script>    <script type="text/javascript">
(function($){
  $('.entry').each(function(i){
    $(this).find('img').each(function(){
      var alt = this.alt;

      if (alt){
        $(this).before('<span class="caption">' + alt + '</span>');
      }

      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="fancybox' + i + '" />');
    });
  });

  $('.fancybox').fancybox();
})(jQuery);
</script>    
        <script src="http://cdn.bootcss.com/mathjax/2.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>
    
<script type="text/javascript">
$('.ajax_widgets').each(function(){var src=$(this).attr('data-src');if(src)$(this).load('/widgets/'+src+'.html');});
$.each(_js2load,function(index,obj){loadjs(obj.src,obj.charset)});
</script>

<div id="scroll2top">
<img src="/scroll2top/arrow.png"/>
</div>
<script src="/scroll2top/scroll2top.min.js"></script>
<div id="winterland">
  <canvas></canvas>
</div>
<script src="/js/winterland.min.js"></script>

  </body>
</html>
