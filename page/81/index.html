
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>The 81 Page | It so life</title>
<meta name="author" content="RobinChia">

<meta name="description" content="It so life">


<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta property="og:site_name" content="It so life"/>

<!--[if IE]><style>.testIE.IE{display:inline;}</style><![endif]-->
<!--[if lte IE 7]><link rel="stylesheet" href="/css/ie7.css" type="text/css"><![endif]-->
<!--[if (lt IE 9)&(gt IE 7)]><style>.testIE.IE8{display:inline;}</style><![endif]-->
<!--[if gt IE 8]><style>.testIE.IE9{display:inline;}</style><![endif]-->

<link href="/favicon.png" rel="icon">
<link rel="alternate" href="/atom.xml" title="It so life Feed" type="application/atom+xml">

<link rel="stylesheet" href="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.0.3/css/font-awesome.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/prettify/r298/prettify.min.css" type="text/css">
<link rel="stylesheet" href="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" type="text/css">
<link rel="stylesheet" href="/css/style.css" type="text/css">
<!--[if lt IE 9]>
   <style>article,aside,dialog,footer,header,section,footer,nav,figure,menu{display:block}</style>
   <script src="http://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
   <script src="http://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
<link href="http://cdn.staticfile.org/respond.js/1.4.2/respond-proxy.html" id="respond-proxy" rel="respond-proxy" />
<link href="/js/respond.proxy.gif" id="respond-redirect" rel="respond-redirect" />
<script src="/js/respond.proxy.js"></script>
   <script src="http://cdn.bootcss.com/selectivizr/1.0.2/selectivizr-min.js"></script>
<![endif]-->
<script type="text/javascript">
function loadjs(c,d){var a=document.createElement("script");a.async=!0;a.type="text/javascript";a.src=c;a.charset=d||"gbk";(document.getElementsByTagName("HEAD")[0]||document.getElementsByTagName("BODY")[0]).appendChild(a)};
var _protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
var _js2load = [];
</script>

</head>
<body>
      <header id="header" class="container"><nav id="main-nav" class="navbar navbar-default navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="/">It so life</a>
    </div>
    <div  class="collapse navbar-collapse">
      <ul  class="nav navbar-nav">
  
        <li><a href="/" title="Home">Home</a></li>      
        <li><a href="/about/" title="About">About</a></li>      
        <li><a href="/archives/" title="Archives">Archives</a></li>      
      <li class='dropdown'>
        <a class='dropdown-toggle' data-toggle='dropdown' href='#'>website<b class='caret'></b></a>
        <ul class='dropdown-menu pure-menu-selected'>
    
          <li><a href="//groups.google.com/forum/#!forum/pongba" title="TopLanguage">TopLanguage</a></li>    
          <li><a href="//itpub.net/" title="ITPub">ITPub</a></li>    
          <li><a href="//blog.jobbole.com/" title="Bole">Bole</a></li>    
          <li><a href="//nosql-database.org/" title="nosql">nosql</a></li>    
          <li><a href="//gitimmersion.googol.im/" title="Git">Git</a></li>    
        </ul>
      </li>
    
      </ul>
      <ul class="nav navbar-nav navbar-right">
      
        <li><a href="/atom.xml">RSS</a></li>
      
      
        <li><a href="https://twitter.com/robinchia">twitter</a></li>
      
      
      
      
        <li><a href="https://github.com/robinchia">github</a></li>
      
      </ul>
    </div>
  </div>
</nav>
<div class="clearfix"></div>
</header>
  <div id='content' class="container">
     <div class="page-header-wrapper">
      <!--[if lt IE 9]><div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong>提示:</strong>您的浏览器版本太低了,建议升级到 <strong><a href="http://windows.microsoft.com/zh-cn/internet-explorer/download-ie" title="IE9">IE9</a></strong> 以上,本站使用<a href="https://www.google.com/intl/zh-CN/chrome/">Chrome浏览器</a>可以获得最好的显示效果.</div><![endif]-->
      <div class="page-header"><h1 align="center"><big>It so life</big> </h1>
        <h5 align="center"><big>love as life</big></h5>
      </div>
     </div>
     <div class="row">
       <div id="main-col" class="alignleft col-sx-12 col-sm-8 col-md-9 col-lg-9">
      <section id='header_widget'></section>
          <div id="wrapper"><article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-缓存-ehcache--EHCache-单落撒旦的日志-网易博客/">EHCache </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:39.000Z"> <a href="/2014/02/02/2014-02-02-缓存-ehcache--EHCache-单落撒旦的日志-网易博客/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="ehcache-">EHCache - 单落撒旦的日志 - 网易博客</h1>
<p><a href="http://www.360doc.com/help.html" target="_blank">帮助</a>|<a href="http://www.360doc.com/advice.html" target="_blank">留言交流</a>|  <a href="http://www.360doc.com/login.aspx?reurl=http://www.360doc.com/content/10/1207/16/3880760_75861362.shtml" target="_blank">登录</a></p>
<p><img src="" alt=""></p>
<p><a href="http://www.360doc.com/index.html" target="_blank">首 页</a> <a href="http://www.360doc.com/readroom.html" target="_blank">阅览室</a> <a href="http://www.360doc.com/weekstar.html" target="_blank">馆友</a> <a href="http://www.360doc.com/my360doc.aspx" target="_blank">我的图书馆</a>
<img src="" alt=""></p>
<p><a href=""><img src="" alt=""></a>
来自：<a href="http://www.360doc.com/userhome/3880760" target="_blank">软件123</a> &gt; <a href="http://www.360doc.com/userhome.aspx?userid=3880760&amp;cid=3" target="_blank">Hibernate</a></p>
<p>配色： <img src="" alt=""> <img src="" alt=""> <img src="" alt=""> <img src="" alt=""> <img src="" alt=""> <img src="" alt=""> 字号：大中小 EHCache - 单落撒旦的日志 - 网易博客 2010-12-07 | 阅：257  转：1  |  <a href="http://www.360doc.com/content/10/1207/16/3880760_75861362.shtml#" target="_blank">分享</a> </p>
<p><img src="" alt=""></p>
<ul>
<li><a href="&quot;分享到QQ空间&quot;"><img src="" alt="分享到QQ空间">腾讯空间</a></li>
<li><a href="&quot;分享到人人&quot;"><img src="" alt="">人人网</a></li>
<li><a href="&quot;分享到开心&quot;"><img src="" alt="">开心网</a></li>
<li><a href=""><img src="" alt="分享到新浪微博">新浪微博</a></li>
<li><a href=""><img src="" alt="分享到腾讯微博">腾讯微博</a></li>
<li><a href="&quot;分享到搜狐微博&quot;"><img src="" alt="分享到搜狐微博">搜狐空间</a></li>
<li><img src="" alt="">推荐给朋友</li>
<li><img src="" alt="">举报
<a href="http://www.360doc.com/register.aspx?refer=57&amp;reurl=resaveArt.aspx?articleid=" target="_blank"><img src="" alt=""></a>
 <a href="http://yxp.163.com/h/action/photoplay.html?sss=frombkerz1116"></a>  </li>
</ul>
<p><a href="http://blog.163.com/zhang-_-jie/blog/static/16178437820105811397991/" target="_blank">Cache技术―OSCache</a></p>
<h3 id="ehcache">EHCache</h3>
<p><a href="http://blog.163.com/zhang-_-jie/blog/#m=0&amp;t=1&amp;c=fks_084067086083080064080080082095085080080068092082085068092" title="缓存技术" target="_blank">缓存技术</a> 2010-06-08 14:07:18 阅读170 评论0   字号：大<strong>中</strong>小 <a href="">订阅</a>
一、简介</p>
<p>非常简单，而且易用。</p>
<p>ehcache 是一个非常轻量级的缓存实现，而且从1.2 之后就支持了集群，而且是hibernate 默认的缓存provider 。EhCache 是一个纯Java的进程内缓存框架，具有快速、精干等特点，是Hibernate中默认的CacheProvider。</p>
<p>Ehcache可以直接使用。也可以和Hibernate对象/关系框架结合使用。还可以做Servlet缓存。</p>
<p>Cache 存储方式 ：内存或磁盘。</p>
<pre><code>   官方网站：[http://ehcache.sourceforge.net/](http://ehcache.sourceforge.net/)
</code></pre><p>主要特性</p>
<ol>
<li>快速.</li>
<li>简单.</li>
<li>多种缓存策略</li>
<li>缓存数据有两级：内存和磁盘，因此无需担心容量问题</li>
<li>缓存数据会在虚拟机重启的过程中写入磁盘</li>
<li>可以通过RMI、可插入API等方式进行分布式缓存</li>
<li>具有缓存和缓存管理器的侦听接口</li>
<li>支持多缓存管理器实例，以及一个实例的多个缓存区域</li>
<li>提供Hibernate的缓存实现</li>
<li>等等</li>
</ol>
<p>二、快速上手</p>
<p>1、  项目类库中添加ehcache.jar；</p>
<p>2、  在类路径下编写ehcache.xml配置文件。</p>
<p>三、配置文件参数详解</p>
<p>ehcache.xml是ehcache的配置文件，并且存放在应用的classpath中。下面是对该XML文件中的一些元素及其属性的相关说明： </p>
<p><diskStore>元素：指定一个文件目录，当EHCache把数据写到硬盘上时，将把数据写到这个文件目录下。 下面的参数这样解释：   </p>
<pre><code>     user.home – 用户主目录   

     user.dir      – 用户当前工作目录   

     java.io.tmpdir – 默认临时文件路径
</code></pre><p><defaultCache>元素：设定缓存的默认数据过期策略。 </p>
<cache>元素：设定具体的命名缓存的数据过期策略。



<cache>元素的属性 

name：缓存名称。通常为缓存对象的类名（非严格标准）。 

maxElementsInMemory：设置基于内存的缓存可存放对象的最大数目。 

maxElementsOnDisk：设置基于硬盘的缓存可存放对象的最大数目。<br>
eternal：如果为true，表示对象永远不会过期，此时会忽略timeToIdleSeconds和timeToLiveSeconds属性，默认为false; 

timeToIdleSeconds： 设定允许对象处于空闲状态的最长时间，以秒为单位。当对象自从最近一次被访问后，如果处于空闲状态的时间超过了timeToIdleSeconds属性值，这个对象就会过期。当对象过期，EHCache将把它从缓存中清空。只有当eternal属性为false，该属性才有效。如果该属性值为0，则表示对象可以无限期地处于空闲状态。 

timeToLiveSeconds：设定对象允许存在于缓存中的最长时间，以秒为单位。当对象自从被存放到缓存中后，如果处于缓存中的时间超过了 timeToLiveSeconds属性值，这个对象就会过期。当对象过期，EHCache将把它从缓存中清除。只有当eternal属性为false，该属性才有效。如果该属性值为0，则表示对象可以无限期地存在于缓存中。timeToLiveSeconds必须大于timeToIdleSeconds属性，才有意义。 

overflowToDisk：如果为true,表示当基于内存的缓存中的对象数目达到了maxElementsInMemory界限后，会把益出的对象写到基于硬盘的缓存中。注意：如果缓存的对象要写入到硬盘中的话，则该对象必须实现了Serializable接口才行。

memoryStoreEvictionPolicy：缓存对象清除策略。有三种：

1 FIFO ，first in first out ，这个是大家最熟的，先进先出，不多讲了

2 LFU ， Less Frequently Used ，就是上面例子中使用的策略，直白一点就是讲一直以来最少被使用的。如上面所讲，缓存的元素有一个hit 属性，hit 值最小的将会被清出缓存。

2 LRU ，Least Recently Used ，最近最少使用的，缓存的元素有一个时间戳，当缓存容量满了，而又需要腾出地方来缓存新的元素的时候，那么现有缓存元素中时间戳离当前时间最远的元素将被清出缓存。

四、单独使用EHCache

1.创建CacheManager （net.sf.ehcache.CacheManager）

（1）使用默认配置文件创建

CacheManager manager = CacheManager.create();

（2）使用指定配置文件创建

CacheManager manager = CacheManager.create(&quot;src/config/ehcache.xml&quot;);

（3）从classpath找寻配置文件并创建

URL url = getClass().getResource(&quot;/anothername.xml&quot;);

CacheManager manager = CacheManager.create(url);

（4）通过输入流创建

InputStream fis = new FileInputStream(new File(&quot;src/config/ehcache.xml&quot;).getAbsolutePath());

try { manager = CacheManager.create(fis); } finally { fis.close(); }



2.创建Caches （net.sf.ehcache.Cache）

（1）取得配置文件中预先 定义的sampleCache1设置,生成一个Cache

Cache cache = manager.getCache(&quot;sampleCache1&quot;);



（2）设置一个名为test 的新cache,test属性为默认

CacheManager manager = CacheManager.create();

manager.addCache(&quot;test&quot;);



（3）设置一个名为test 的新cache,并定义其属性

CacheManager manager = CacheManager.create();

Cache cache = new Cache(&quot;test&quot;, 1, true, false, 5, 2);

manager.addCache(cache);



（4）删除cache

CacheManager singletonManager = CacheManager.create();

singletonManager.removeCache(&quot;sampleCache1&quot;);<br>


3.使用Caches

（1）往cache中加入元素

Element element = new Element(&quot;key1&quot;, &quot;value1&quot;);

cache.put(new Element(element);



（2）从cache中取得元素

Element element = cache.get(&quot;key1&quot;);



（3）从cache中删除元素

Cache cache = manager.getCache(&quot;sampleCache1&quot;);

Element element = new Element(&quot;key1&quot;, &quot;value1&quot;);

cache.remove(&quot;key1&quot;);<br>


3.卸载CacheManager ,关闭Cache

 manager.shutdown();

下附代码。





五、在 Hibernate 中运用EHCache

1、hibernate.cfg.xml中需设置如下：

3系列版本加入
<property name=” hibernate.cache.provider_class”>
org.hibernate.cache.EhCacheProvider
</property>  EhCacheProvider类位于hibernate3.jar

2.1版本加入

net.sf.ehcache.hibernate.Provider

2.1以下版本加入

net.sf.hibernate.cache.EhCache



2、在Hibernate3.x中的etc目录下有ehcache.xml的示范文件，将其复制应用程序的src目录下（编译时会把ehcache.xml复制到WEB-INF/classess目录下），对其中的相关值进行更改以和自己的程序相适合。



3、持久化类的映射文件进行配置

       <cache usage="read-write"/>

在<set>标记中设置了<cache usage="read-write"/>，但Hibernate仅把和Group相关的Student的主键id加入到缓存中，如果希望把整个Student的散装属性都加入到二级缓存中，还需要在Student.hbm.xml文件的<class>标记中加入<cache>子标记，如下所示：

<cache usage="read-write" /> <!--cache标记需跟在class标记后-->



注：SSH中hibernate配置的cache信息

<prop key="hibernate.cache.provider_class">org.hibernate.cache.EhCacheProvider</prop>

六、在页面中使用EHCache缓存

       简单的来说，如果一个应用中80% 的时间内都在访问20% 的数据，那么，这时候就应该使用缓存了。

       在80/20 原则生效的地方，我们都应该考虑是否可以使用缓存。但即使是这样，缓存也有不同的用法，举个例子，一个网站的首页估计是被访问的次数最多的，我们可以考虑给首页做一个页面缓存。页面访问最频繁的，做缓存。不同的页面的缓存策略有可能有天壤之别。

       毫无疑问，几乎所有的网站的首页都是访问率最高的，而首页上的数据来源又是非常广泛的，大多数来自不同的对象，而且有可能来自不同的db ，所以给首页做缓存是一个不错的主意，那么主页的缓存策略是什么样子的呢，我认为应该是某个固定时间之内不变的，比如说2 分钟更新一次。或者根据不同的网页功能采取合理的策略。



在使用ehcache 的页面缓存之前，我们必须要了解ehcache 的2个概念：

（1）timeToIdleSeconds ，多长时间不访问该缓存，那么ehcache 就会清除该缓存。

（2）timeToLiveSeconds ，缓存的存活时间，从开始创建的时间算起。



1、配置ehcache.xml文件

2、在web.xml配置文件中配置过滤器信息

好了，缓存整个页面看上去是非常的简单，甚至都不需要写一行代码，只需要几行配置就行了，够简单吧，虽然看上去简单，但是事实上内部实现却不简单哦，有兴趣的话，大家可以看看SimplePageCachingFilter 继承体系的源代码。



缓存首页（整个页面）示例：

&lt; filter &gt;

        &lt; filter-name &gt; indexCacheFilter </filter-name >

        &lt; filter-class &gt;

            net.sf.ehcache.constructs.web.filter.SimplePageCachingFilter

        </filter-class >

</filter ><br>
&lt; filter-mapping &gt;

        &lt; filter-name &gt; indexCacheFilter </filter-name >

        &lt; url-pattern &gt; /<em>index.action </url-pattern >

</filter-mapping >



缓存首页的部分内容时，需要使用SimplePageFragmentCachingFilter 这个filter 。如：<br>
&lt; filter &gt;

        &lt; filter-name &gt; indexCacheFilter </filter-name >

        &lt; filter-class &gt;

            net.sf.ehcache.constructs.web.filter.SimplePageFragmentCachingFilter

        </filter-class >

</filter ><br>
&lt; filter-mapping &gt;

        &lt; filter-name &gt; indexCacheFilter </filter-name >

        &lt; url-pattern &gt; /</em>/index_right.jsp </url-pattern >

</filter-mapping ><br>
这个jsp 需要被jsp:include 到其他页面，这样就做到的局部页面的缓存。这一点貌似没有oscache 的tag 好用。



七、在Spring框架中使用EHCache缓存



       就是使用Spring提供的springmodules和EHCache来简化程序的开发，通过配置文件来完成提供缓存。参考springmodules的文档。



1、配置ehcache.xml文件

2、创建Spring EHCache的配置xml文件

配置文件代码示例（调试通过）：

&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;

<beans xmlns="http://www.springframework.org/schema/beans"

    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"

    xmlns:aop="http://www.springframework.org/schema/aop"

    xmlns:tx="http://www.springframework.org/schema/tx"

    xmlns:ehcache="http://www.springmodules.org/schema/ehcache"

    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd  

    http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd  

    http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd   

    http://www.springmodules.org/schema/ehcache http://www.springmodules.org/schema/cache/springmodules-ehcache.xsd">



    <bean id="EhCacheFacade"

       class="org.springmodules.cache.provider.ehcache.EhCacheFacade">

       <property name="failQuietlyEnabled" value="true" />

       <property name="cacheManager">

           <bean

              class="org.springframework.cache.ehcache.EhCacheManagerFactoryBean">

              <property name="configLocation"

                  value="classpath:ehcache.xml">

              </property>

           </bean>

       </property>

    </bean>



    <bean id="cachingInterceptor"

       class="org.springmodules.cache.interceptor.caching.MethodMapCachingInterceptor">

       <property name="cacheProviderFacade" ref="EhCacheFacade" />

       <property name="cachingModels">

           <props>

              <prop key="com....test.Manager.get/*">

                  cacheName=dictCache

              </prop>

           </props>

       </property>

    </bean>



    <bean id="flushingInterceptor"

       class="org.springmodules.cache.interceptor.flush.MethodMapFlushingInterceptor">

       <property name="cacheProviderFacade" ref="EhCacheFacade" />

       <property name="flushingModels">

           <props>

              <prop key="com....test.Manager.update/*">

                  cacheNames=dictCache

              </prop>

           </props>

       </property>

    </bean>



    <bean

       class="org.springframework.aop.framework.autoproxy.BeanNameAutoProxyCreator">

       <property name="beanNames">

           <value>/*anager</value>

       </property>

       <property name="interceptorNames">

           <list>

              <value>flushingInterceptor</value>

              <value>cachingInterceptor</value>

           </list>

       </property>

    </bean>

    <bean id="manager" class="com...test.Manager"></bean>

</beans>

 <cache name="dictCache"

    maxElementsInMemory="50"

    eternal="false"

    timeToIdleSeconds="60"

    timeToLiveSeconds="60"

    overflowToDisk="false"

    memoryStoreEvictionPolicy="LFU">

    </cache>



<p>也可以使用注解的形式进行标注缓存方法，不过要修改配置文件，详见springmodules的文档，这里就不提供了。</p>
<p>缓存说明：</p>
<p>1、方法不含有参数</p>
<pre><code>时间到期缓存失效；调用flush，缓存失效。
</code></pre><p>2、方法中含有参数</p>
<pre><code>参数不同则每次都缓存,若缓存中存在相同对象，则调用缓存。

当调用flush，该id对应的缓存都失效。

当缓存时间到期，该id对应的缓存都失效。
</code></pre><p>建议：对没有关联的缓存对象采取不同的id配置。所以ehcache会有好多的cache-id配置信息。</p>
<pre><code>       &lt;props&gt;

          &lt;prop key=&quot;com....test.Manager.get/*&quot;&gt;

              cacheName=dictCache

          &lt;/prop&gt;

          ………                     

          &lt;prop key=&quot;com....test.Manager2.get/*&quot;&gt;

              cacheName=dictCache2

          &lt;/prop&gt;

       &lt;/props&gt;



       &lt;props&gt;

          &lt;prop key=&quot;com....test.Manager.update/*&quot;&gt;

              cacheNames=dictCache

          &lt;/prop&gt;

          ………

          &lt;prop key=&quot;com....test.Manager2.update/*&quot;&gt;

              cacheNames=dictCache2

          &lt;/prop&gt;

       &lt;/props&gt;
</code></pre><p>  上一篇：<a href="http://www.360doc.com/content/10/1206/20/3880760_75614432.shtml" target="_blank">基于按annotation的hibernate主键生成策略 - 白首穷经通秘义...</a></p>
<p>下一篇：<a href="http://www.360doc.com/content/10/1207/16/3880760_75862016.shtml" target="_blank">Cache技术―OSCache - 单落撒旦的日志 - 网易博客</a> <a href=""><img src="" alt=""></a></p>
<p>献花(0)</p>
<p>+1 分享到：<a href="&quot;分享到QQ空间&quot;"><img src="" alt="分享到QQ空间"></a><a href="&quot;分享到人人&quot;"><img src="" alt=""></a><a href="&quot;分享到开心&quot;"><img src="" alt=""></a><a href=""><img src="" alt="分享到新浪微博"></a><a href=""><img src="" alt="分享到腾讯微博"></a><a href="&quot;分享到搜狐微博&quot;"><img src="" alt="分享到搜狐微博"></a><a href=""><img src="" alt=""></a></p>
<ul>
<li><img src="" alt="">推荐给朋友</li>
<li><img src="" alt="">举报  (本文系<a href="http://www.360doc.com/userhome/3880760" target="_blank">软件123</a>首藏  <a href="http://blog.163.com/zhang-_-jie/blog/static/1617843782010582718212/" target="_blank">源文网址</a>)</li>
</ul>
<p>类似文章</p>
<ul>
<li><a href="http://www.360doc.com/content/11/0811/15/7270363_139632250.shtml" target="_blank">Ehcache</a></li>
<li><a href="http://www.360doc.com/content/07/0828/15/5136_700268.shtml" target="_blank">配置Spring+hibernate使用ehcache作为se...</a></li>
<li><a href="http://www.360doc.com/content/06/0927/12/6272_218072.shtml" target="_blank">Hibernate ehcache二级缓存技术</a></li>
<li><a href="http://www.360doc.com/content/10/1011/11/2560742_60066155.shtml" target="_blank">EhCache使用详细介绍（转）</a></li>
<li><a href="http://www.360doc.com/content/11/0402/17/6069386_106731794.shtml" target="_blank">二级 ehcache</a></li>
<li><a href="http://www.360doc.com/content/11/1216/17/6088543_172744745.shtml" target="_blank">Hibernate一级缓存和二级缓存</a></li>
<li><a href="http://www.360doc.com/content/10/1128/16/1689336_73159043.shtml" target="_blank">【有声读物】单田芳评书 - 浅草细浪的日...</a></li>
<li><a href="http://www.360doc.com/content/09/0803/16/189491_4643744.shtml" target="_blank">低血压 - 只要有你的日志 - 网易博客</a></li>
<li><a href="http://www.360doc.com/content/10/0207/18/289502_15377865.shtml" target="_blank">网易博客教程一 - 闲人SGM的日志 - 网易...</a>
<a href="http://www.360doc.com/relevant/75861362_more.shtml" target="_blank">更多</a></li>
</ul>
<p>0</p>
<p><img src="" alt="正在加载推荐文章"></p>
<p>您可能会喜欢</p>
<p>[<img src="" alt=""></p>
<p>老师开博客 天天开&quot;网上家长会&quot;
](<a href="http://www.360doc.com/content/07/0508/10/26144_488073.shtml" target="_blank">http://www.360doc.com/content/07/0508/10/26144_488073.shtml</a> &quot;老师开博客 天天开&quot;网上家长会&quot;&quot;) [<img src="" alt=""></p>
<p>博客冲击波（1）----商业周刊精华文章
](<a href="http://www.360doc.com/content/08/0706/10/8596_1402791.shtml" target="_blank">http://www.360doc.com/content/08/0706/10/8596_1402791.shtml</a> &quot;博客冲击波（1）----商业周刊精华文章&quot;) [<img src="" alt=""></p>
<p>红杏妹的博客 l
](<a href="http://www.360doc.com/content/12/0307/16/5060984_192513101.shtml" target="_blank">http://www.360doc.com/content/12/0307/16/5060984_192513101.shtml</a> &quot;红杏妹的博客 l&quot;) [<img src="" alt=""></p>
<p>Ehcache
](<a href="http://www.360doc.com/content/11/0811/15/7270363_139632250.shtml" target="_blank">http://www.360doc.com/content/11/0811/15/7270363_139632250.shtml</a> &quot;Ehcache&quot;) [<img src="" alt=""></p>
<p>教你怎样制作博客首页 - 敏儿的日志 - 网易博客
](<a href="http://www.360doc.com/content/10/0317/13/826574_19113845.shtml" target="_blank">http://www.360doc.com/content/10/0317/13/826574_19113845.shtml</a> &quot;教你怎样制作博客首页 - 敏儿的日志 - 网易博客&quot;)</p>
<p><a href="http://www.wumii.com/widget/relatedItems" title="无觅相关文章插件" target="_blank">无觅</a>
<a href=""></a></p>
<p><img src="" alt=""></p>
<p>发表评论：</p>
<p>您好，请 <a href="">登录</a> 或者 <a href="http://www.360doc.com/register.aspx?refer=53&amp;reurl=showweb/0/0/75861362.aspx" target="_blank">注册</a> 后再进行评论
使用合作网站登录：<img src="" alt="">新浪微博<img src="" alt="">QQ<img src="" alt="">人人
<img src="" alt="">
  <a href="http://www.360doc.com/userhome/3880760" target="_blank"><img src="" alt=""></a></p>
<p><a href="http://www.360doc.com/userhome/3880760" target="_blank">孙中熙——路</a></p>
<p>馆藏：<a href="http://www.360doc.com/userhome.aspx?userid=3880760&amp;app=1" target="_blank">157</a>
关注我：<a href="http://www.360doc.com/userhome.aspx?userid=3880760&amp;app=2" target="_blank">1</a></p>
<p><a href=""><img src="" alt=""></a> <a href=""><img src="" alt=""></a></p>
<p>最新文章</p>
<ul>
<li><a href="http://www.360doc.com/content/12/0912/20/3880760_235775281.shtml" target="_blank">JS计算字符串所占字节数</a></li>
<li><a href="http://www.360doc.com/content/12/0624/09/3880760_220086498.shtml" target="_blank">List的功能方法</a></li>
<li><a href="http://www.360doc.com/content/12/0225/15/3880760_189532854.shtml" target="_blank">maven dependency:sources</a></li>
<li><a href="http://www.360doc.com/content/12/0219/15/3880760_187825046.shtml" target="_blank">IBatis</a></li>
<li><a href="http://www.360doc.com/content/12/0218/13/3880760_187576669.shtml" target="_blank">myeclipse 8.5-9.0 安装 svn 方...</a></li>
<li><a href="http://www.360doc.com/content/12/0218/11/3880760_187551055.shtml" target="_blank">深入理解Java序列化中的SerialV...</a></li>
<li><a href="http://www.360doc.com/content/12/0218/11/3880760_187550886.shtml" target="_blank">关于spring中 几个 java.lang.C...</a></li>
<li><a href="http://www.360doc.com/content/12/0216/20/3880760_187173708.shtml" target="_blank">Derby 轻量级数据库</a></li>
<li><a href="http://www.360doc.com/content/12/0216/20/3880760_187173508.shtml" target="_blank">Template method pattern 模板...</a></li>
<li><a href="http://www.360doc.com/content/12/0216/20/3880760_187173416.shtml" target="_blank">工厂方法模式(Factory method)...</a></li>
<li><a href="http://www.360doc.com/content/12/0216/20/3880760_187173300.shtml" target="_blank">DAO层的分析（一）</a></li>
<li><a href="http://www.360doc.com/content/12/0216/20/3880760_187173130.shtml" target="_blank">提高数据库并发性能概要</a>
<a href="http://www.360doc.com/userhome/3880760" target="_blank">更多&gt;&gt;</a>
-</li>
</ul>
<p>热门文章</p>
<ul>
<li><a href="http://www.360doc.com/content/12/0428/23/0_207401601.shtml" target="_blank">99天毛笔书法速成练习</a></li>
<li><a href="http://www.360doc.com/content/11/0111/14/0_85740115.shtml" target="_blank">素饺子 做法集锦</a></li>
<li><a href="http://www.360doc.com/content/11/0609/10/0_122630336.shtml" target="_blank">趣图：我就喜欢你最丑的样子</a></li>
<li><a href="http://www.360doc.com/content/12/0222/16/0_188656716.shtml" target="_blank">巧做爽口腌黄瓜（图）</a></li>
<li><a href="http://www.360doc.com/content/12/0305/14/0_191838346.shtml" target="_blank">一个人的私奔</a></li>
<li><a href="http://www.360doc.com/content/10/0719/06/0_39976494.shtml" target="_blank">老中医的长寿秘诀——长寿粥</a></li>
<li><a href="http://www.360doc.com/content/11/0813/18/0_140148370.shtml" target="_blank">海论英语《从零开始学口语》（4...</a></li>
<li><a href="http://www.360doc.com/content/11/1205/23/0_169982196.shtml" target="_blank">尿路结石的秘方</a></li>
<li><a href="http://www.360doc.com/content/10/0713/13/0_38709357.shtml" target="_blank">能不能不要装可爱(图片)</a></li>
<li><a href="http://www.360doc.com/content/12/0511/08/0_210233282.shtml" target="_blank">好吃的茄饼蒸肉</a></li>
<li><a href="http://www.360doc.com/content/10/0811/21/0_45363446.shtml" target="_blank">庄子的快活 穿越时空之舞</a></li>
<li><a href="http://www.360doc.com/content/11/0613/15/0_126649064.shtml" target="_blank">健康教育处方大全</a>
<a href="http://www.360doc.com/readroom.html" target="_blank">更多&gt;&gt;</a></li>
</ul>
<p><a href="">关闭</a></p>
<p><a href="http://www.360doc.com/mobilapp.htm" target="_blank"><img src="" alt=""></a></p>
<p><a href="http://www.360doc.com/content/10/1207/16/3880760_75861362.shtml#"></a></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/缓存/">缓存</a></li></span><span class="breadcrumb"><li><a href="/categories/缓存/">缓存</a></li><li><a href="/categories/缓存/ehcache/">ehcache</a></li></span></span> | <span class="tags">Tagged <a href="/tags/ehcache/" class="label label-primary">ehcache</a><a href="/tags/缓存/" class="label label-success">缓存</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:39"datetime="2014-03-07 09:54:39"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-缓存-ehcache--EHCache-单落撒旦的日志-网易博客/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-缓存-ehcache--EHCache-单落撒旦的日志-网易博客" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-缓存-ehcache--EHCache的使用教程-黑神领主的博客-dev26com/">EHCache的使用教程</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:39.000Z"> <a href="/2014/02/02/2014-02-02-缓存-ehcache--EHCache的使用教程-黑神领主的博客-dev26com/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="ehcache-dev26-com">EHCache的使用教程-黑神领主的博客-dev26.com</h1>
<h3 id="-">分享到</h3>
<ul>
<li><a href="http://www.dev26.com/blog/article/352/1#" target="_blank">QQ空间</a></li>
<li><a href="http://www.dev26.com/blog/article/352/1#" target="_blank">新浪微博</a></li>
<li><a href="http://www.dev26.com/blog/article/352/1#" target="_blank">百度搜藏</a></li>
<li><a href="http://www.dev26.com/blog/article/352/1#" target="_blank">人人网</a></li>
<li><a href="http://www.dev26.com/blog/article/352/1#" target="_blank">腾讯微博</a></li>
<li><a href="http://www.dev26.com/blog/article/352/1#" target="_blank">开心网</a></li>
<li><a href="http://www.dev26.com/blog/article/352/1#" target="_blank">腾讯朋友</a></li>
<li><a href="http://www.dev26.com/blog/article/352/1#" target="_blank">更多...</a></li>
</ul>
<p><a href="http://www.dev26.com/blog/article/352/1#" target="_blank">百度分享</a></p>
<p><a href="http://www.dev26.com/blog/article/352/1#" target="_blank">首页</a>|<a href="http://www.dev26.com/blog/article/352/1#" target="_blank">文章</a>|<a href="http://www.dev26.com/blog/article/352/1#" target="_blank">博客</a>|<a href="http://www.dev26.com/blog/article/352/1#" target="_blank">开源</a></p>
<h1 id="www-dev26-com">www.dev26.com</h1>
<h2 id="-web-">黑神领主的Web开发站博客</h2>
<p>在 文章 博客 开源 论坛 中检索</p>
<h3 id="-">个人资料</h3>
<p><a href="http://www.dev26.com/blog/start/undead" target="_blank"><img src="" alt="黑神领主"></a></p>
<p>这家伙很懒，什么都没有留下……</p>
<p>等级: <img src="&quot;等级：20&quot;" alt="20"></p>
<p>加入时间:2011-12-05 22:36</p>
<p><a href="http://www.dev26.com/blog/article/352/1#inline1" target="_blank">发送消息</a></p>
<h3 id="-">操作中心</h3>
<ul>
<li><a href="&quot;我的博客&quot;">我的博客</a></li>
<li><a href="http://www.dev26.com/bbs/topic/focus/1" title="我关注的话题" target="_blank">我关注的话题</a></li>
<li>新闻投递</li>
<li><a href="http://www.dev26.com/manage/home/start" target="_blank">管理</a></li>
<li><a href="http://www.dev26.com/manage/blog/edit" target="_blank">发表文章</a></li>
<li><p><a href="">安全退出</a></p>
<h3 id="-">操作中心</h3>
</li>
<li><p><a href="http://www.dev26.com/login" target="_blank">登录</a></p>
</li>
<li><a href="http://www.dev26.com/runtime/register" target="_blank">注册</a></li>
</ul>
<h3 id="-http-www-dev26-com-blog-start-undead-http-www-dev26-com-rss-blog-username-undead-"><a href="http://www.dev26.com/blog/start/undead" target="_blank">所有文章</a> <a href="http://www.dev26.com/rss/blog?username=undead" target="_blank"><img src="&quot;订阅&quot;" alt=""></a></h3>
<ul>
<li><a href="http://www.dev26.com/blog/category/32" target="_blank">JDK基础</a></li>
<li><a href="http://www.dev26.com/blog/category/33" target="_blank">html5</a></li>
<li><a href="http://www.dev26.com/blog/category/35" target="_blank">javascript</a></li>
<li><a href="http://www.dev26.com/blog/category/5" target="_blank">我的JavaEE</a></li>
<li><a href="http://www.dev26.com/blog/category/6" target="_blank">我的博客</a></li>
<li><p><a href="http://www.dev26.com/blog/category/34" target="_blank">数据结构</a></p>
<h3 id="-">最新发表&gt;&gt;</h3>
</li>
<li><p><a href="http://www.dev26.com/blog/article/622/1" title="javascript中使用mvc" target="_blank">javascript中使用mvc</a></p>
</li>
<li><a href="http://www.dev26.com/blog/article/621/1" title="java实现二级域名" target="_blank">java实现二级域名</a></li>
<li><a href="http://www.dev26.com/blog/article/620/1" title="java Annotation注解知识" target="_blank">java Annotation注解知识</a></li>
<li><a href="http://www.dev26.com/blog/article/618/1" title="inner join,left join,right join,full join 的区别说明" target="_blank">inner join,left join,right join,full join 的区别说明</a></li>
<li><a href="http://www.dev26.com/blog/article/617/1" title="REST的概念是什么" target="_blank">REST的概念是什么</a></li>
</ul>
<h3 id="-">最新评论&gt;&gt;</h3>
<p><a href="http://www.dev26.com/blog/article.htm?articleId=558&amp;tmp=1#comments">你好，能不能把示例代码和xml发给我，我研究下自定义类，我这里用起来有点问题。谢谢
jiangdk85@126.com</a></p>
<p><a href="http://www.dev26.com/blog/article.htm?articleId=113&amp;tmp=1#comments" target="_blank">上面的代码找不到ResourceDetailsBuilder这个类</a>
<a href="http://www.dev26.com/blog/article.htm?articleId=113&amp;tmp=1#comments" target="_blank">上面已经是源码了哟，只是没有JAR包而已，你下载一下吧</a></p>
<p><a href="http://www.dev26.com/blog/article.htm?articleId=113&amp;tmp=1#comments" target="_blank">大大共享下源码可以么？</a>
<a href="http://www.dev26.com/blog/article.htm?articleId=113&amp;tmp=1#comments" target="_blank">是内存中的权限缓存，这样设置的权限可以即时生效</a>
-</p>
<h3 id="ehcache-">EHCache的使用教程</h3>
<p>发表于2012-06-08 19:19 | 阅读 218 | 1人对此综合评价 <img src="&quot;5分&quot;" alt="5分"></p>
<p>开发高并发量，高性能的网站应用系统时，缓存Cache起到了非常重要的作用。本文主要介绍EHCache的使用，以及使用EHCache的实践经验。
笔者使用过多种基于Java的开源Cache组件，其中包括OSCache、JBossCache、EHCache。OSCache功能强大，使用灵活，可用于对象缓存、Filter缓存以及在JSP中直接使用cache标签。笔者在最近的使用过程中发现，在并发量较高时，OSCache会出现线程阻塞和数据错误，通过分析源代码发现是其内部实现的缺陷。JBossCache最大的优点是支持基于对象属性的集群同步，不过JBossCache的配置使用都较复杂，在并发量较高的情况下，对象属性数据在集群中同步也会加大系统的开销。以上两种Cache本文仅作简单介绍，不做深入探讨。
EHCache是来自sourceforge（<a href="http://ehcache.sourceforge.net/" target="_blank"><a href="http://ehcache.sourceforge.net/">http://ehcache.sourceforge.net/</a></a>）的开源项目，也是纯Java实现的简单、快速的Cache组件。EHCache支持内存和磁盘的缓存，支持LRU、LFU和FIFO多种淘汰算法，支持分布式的Cache，可以作为Hibernate的缓存插件。同时它也能提供基于Filter的Cache，该Filter可以缓存响应的内容并采用Gzip压缩提高响应速度。</p>
<p> EHCache API的基本用法
首先介绍CacheManager类。它主要负责读取配置文件，默认读取CLASSPATH下的ehcache.xml，根据配置文件创建并管理Cache对象。
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13</p>
<p>14
15</p>
<p>16
// 使用默认配置文件创建CacheManager</p>
<p>CacheManager manager = CacheManager.create();
// 通过manager可以生成指定名称的Cache对象</p>
<p>Cache cache = cache = manager.getCache(</p>
<p>&quot;demoCache&quot;</p>
<p>);
// 使用manager移除指定名称的Cache对象</p>
<p>manager.removeCache(</p>
<p>&quot;demoCache&quot;</p>
<p>);
可以通过调用manager.removalAll()来移除所有的Cache。通过调用manager的shutdown()方法可以关闭CacheManager。</p>
<p>有了Cache对象之后就可以进行一些基本的Cache操作，例如：
//往cache中添加元素</p>
<p>Element element =</p>
<p>new</p>
<p>Element(</p>
<p>&quot;key&quot;</p>
<p>,</p>
<p>&quot;value&quot;</p>
<p>);
cache.put(element);</p>
<p>//从cache中取回元素
Element element = cache.get(</p>
<p>&quot;key&quot;</p>
<p>);</p>
<p>element.getValue();
//从Cache中移除一个元素</p>
<p>cache.remove(</p>
<p>&quot;key&quot;</p>
<p>);</p>
<p>可以直接使用上面的API进行数据对象的缓存，这里需要注意的是对于缓存的对象都是必须可序列化的。在下面的篇幅中笔者还会介绍EHCache和Spring、Hibernate的整合使用。</p>
<p> 配置文件
配置文件ehcache.xml中命名为demoCache的缓存配置：
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7&lt;</p>
<p>cache</p>
<p>name</p>
<p>=</p>
<p>&quot;demoCache&quot;</p>
<p>maxElementsInMemory</p>
<p>=</p>
<p>&quot;10000&quot;
eternal</p>
<p>=</p>
<p>&quot;false&quot;</p>
<p>overflowToDisk</p>
<p>=</p>
<p>&quot;true&quot;
timeToIdleSeconds</p>
<p>=</p>
<p>&quot;300&quot;</p>
<p>timeToLiveSeconds</p>
<p>=</p>
<p>&quot;600&quot;
memoryStoreEvictionPolicy</p>
<p>=</p>
<p>&quot;LFU&quot;</p>
<p>/&gt;</p>
<p>各配置参数的含义：
maxElementsInMemory：缓存中允许创建的最大对象数
eternal：缓存中对象是否为永久的，如果是，超时设置将被忽略，对象从不过期。
timeToIdleSeconds：缓存数据的钝化时间，也就是在一个元素消亡之前，两次访问时间的最大时间间隔值，这只能在元素不是永久驻留时有效，如果该值是 0 就意味着元素可以停顿无穷长的时间。
timeToLiveSeconds：缓存数据的生存时间，也就是一个元素从构建到消亡的最大时间间隔值，这只能在元素不是永久驻留时有效，如果该值是0就意味着元素可以停顿无穷长的时间。
overflowToDisk：内存不足时，是否启用磁盘缓存。
memoryStoreEvictionPolicy：缓存满了之后的淘汰算法。LRU和FIFO算法这里就不做介绍。LFU算法直接淘汰使用比较少的对象，在内存保留的都是一些经常访问的对象。对于大部分网站项目，该算法比较适用。
如果应用需要配置多个不同命名并采用不同参数的Cache，可以相应修改配置文件，增加需要的Cache配置即可。</p>
<p> 利用Spring APO整合EHCache
首先，在CLASSPATH下面放置ehcache.xml配置文件。在Spring的配置文件中先添加如下cacheManager配置：
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10</p>
<bean id=

"cacheManager"

class=

"org.springframework.cache.ehcache.EhCacheManagerFactoryBean"

>
</bean>

<p>配置demoCache：</p>
<bean id=

"demoCache"

class=

"org.springframework.cache.ehcache.EhCacheFactoryBean"

>

<property name=

"cacheManager"

ref=

"cacheManager"

/>
<property name=

"cacheName"

>

<value>demoCache</value>
</property>

</bean>

<p>接下来，写一个实现org.aopalliance.intercept.MethodInterceptor接口的拦截器类。有了拦截器就可以有选择性的配置想要缓存的 bean 方法。如果被调用的方法配置为可缓存，拦截器将为该方法生成 cache key 并检查该方法返回的结果是否已缓存。如果已缓存，就返回缓存的结果，否则再次执行被拦截的方法，并缓存结果供下次调用。具体代码如下：</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13</p>
<p>14
15</p>
<p>16
17</p>
<p>18
19</p>
<p>20
21</p>
<p>22
23</p>
<p>24
25</p>
<p>26
27</p>
<p>28
29</p>
<p>30
31</p>
<p>32
33</p>
<p>34
35</p>
<p>36
37</p>
<p>38
39</p>
<p>40
41</p>
<p>42
43</p>
<p>44
public</p>
<p>class</p>
<p>MethodCacheInterceptor</p>
<p>implements</p>
<p>MethodInterceptor,</p>
<p>InitializingBean {
private</p>
<p>Cache cache;</p>
<p>public</p>
<p>void</p>
<p>setCache(Cache cache) {</p>
<p>this</p>
<p>.cache = cache;
}</p>
<p>public</p>
<p>void</p>
<p>afterPropertiesSet()</p>
<p>throws</p>
<p>Exception {</p>
<p>Assert.notNull(cache,
&quot;A cache is required. Use setCache(Cache) to provide one.&quot;</p>
<p>);</p>
<p>}</p>
<p>public</p>
<p>Object invoke(MethodInvocation invocation)</p>
<p>throws</p>
<p>Throwable {
String targetName = invocation.getThis().getClass().getName();</p>
<p>String methodName = invocation.getMethod().getName();
Object[] arguments = invocation.getArguments();</p>
<p>Object result;
String cacheKey = getCacheKey(targetName, methodName, arguments);</p>
<p>Element element =</p>
<p>null</p>
<p>;
synchronized</p>
<p>(</p>
<p>this</p>
<p>){</p>
<p>element = cache.get(cacheKey);
if</p>
<p>(element ==</p>
<p>null</p>
<p>) {</p>
<p>//调用实际的方法
result = invocation.proceed();</p>
<p>element =</p>
<p>new</p>
<p>Element(cacheKey, (Serializable) result);
cache.put(element);</p>
<p>}
}</p>
<p>return</p>
<p>element.getValue();
}</p>
<p>private</p>
<p>String getCacheKey(String targetName, String methodName,</p>
<p>Object[] arguments) {
StringBuffer sb =</p>
<p>new</p>
<p>StringBuffer();</p>
<p>sb.append(targetName).append(</p>
<p>&quot;.&quot;</p>
<p>).append(methodName);
if</p>
<p>((arguments !=</p>
<p>null</p>
<p>) &amp;&amp; (arguments.length !=</p>
<p>0</p>
<p>)) {</p>
<p>for</p>
<p>(</p>
<p>int</p>
<p>i =</p>
<p>0</p>
<p>; i &lt; arguments.length; i++) {
sb.append(</p>
<p>&quot;.&quot;</p>
<p>).append(arguments[i]);</p>
<p>}
}</p>
<p>return</p>
<p>sb.toString();
}</p>
<p>}</p>
<p>synchronized (this)这段代码实现了同步功能。为什么一定要同步？Cache对象本身的get和put操作是同步的。如果我们缓存的数据来自数据库查询，在没有这段同步代码时，当key不存在或者key对应的对象已经过期时，在多线程并发访问的情况下，许多线程都会重新执行该方法，由于对数据库进行重新查询代价是比较昂贵的，而在瞬间大量的并发查询，会对数据库服务器造成非常大的压力。所以这里的同步代码是很重要的。</p>
<p>接下来，继续完成拦截器和Bean的配置：
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13</p>
<p>14
15&lt;</p>
<p>bean</p>
<p>id</p>
<p>=</p>
<p>&quot;methodCacheInterceptor&quot;</p>
<p>class</p>
<p>=</p>
<p>&quot;com.xiebing.utils.interceptor.MethodCacheInterceptor&quot;</p>
<p>&gt;</p>
<p>&lt;</p>
<p>property</p>
<p>name</p>
<p>=</p>
<p>&quot;cache&quot;</p>
<p>&gt;
&lt;</p>
<p>ref</p>
<p>local</p>
<p>=</p>
<p>&quot;demoCache&quot;</p>
<p>/&gt;</p>
<p>&lt;/</p>
<p>property</p>
<p>&gt;
&lt;/</p>
<p>bean</p>
<p>&gt;</p>
<p>&lt;</p>
<p>bean</p>
<p>id</p>
<p>=</p>
<p>&quot;methodCachePointCut&quot;</p>
<p>class</p>
<p>=</p>
<p>&quot;org.springframework.aop.support.RegexpMethodPointcutAdvisor&quot;</p>
<p>&gt;
&lt;</p>
<p>property</p>
<p>name</p>
<p>=</p>
<p>&quot;advice&quot;</p>
<p>&gt;</p>
<p>&lt;</p>
<p>ref</p>
<p>local</p>
<p>=</p>
<p>&quot;methodCacheInterceptor&quot;</p>
<p>/&gt;
&lt;/</p>
<p>property</p>
<p>&gt;</p>
<p>&lt;</p>
<p>property</p>
<p>name</p>
<p>=</p>
<p>&quot;patterns&quot;</p>
<p>&gt;
&lt;</p>
<p>list</p>
<p>&gt;</p>
<p>&lt;</p>
<p>value</p>
<blockquote>
<p>./*myMethod&lt;/</p>
</blockquote>
<p>value</p>
<p>&gt;
&lt;/</p>
<p>list</p>
<p>&gt;</p>
<p>&lt;/</p>
<p>property</p>
<p>&gt;
&lt;/</p>
<p>bean</p>
<p>&gt;</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
13&lt;</p>
<p>bean</p>
<p>id</p>
<p>=</p>
<p>&quot;myServiceBean&quot;</p>
<p>class</p>
<p>=</p>
<p>&quot;com.xiebing.ehcache.spring.MyServiceBean&quot;</p>
<p>&gt;
&lt;/</p>
<p>bean</p>
<p>&gt;</p>
<p>&lt;</p>
<p>bean</p>
<p>id</p>
<p>=</p>
<p>&quot;myService&quot;</p>
<p>class</p>
<p>=</p>
<p>&quot;org.springframework.aop.framework.ProxyFactoryBean&quot;</p>
<p>&gt;
&lt;</p>
<p>property</p>
<p>name</p>
<p>=</p>
<p>&quot;target&quot;</p>
<p>&gt;</p>
<p>&lt;</p>
<p>ref</p>
<p>local</p>
<p>=</p>
<p>&quot;myServiceBean&quot;</p>
<p>/&gt;
&lt;/</p>
<p>property</p>
<p>&gt;</p>
<p>&lt;</p>
<p>property</p>
<p>name</p>
<p>=</p>
<p>&quot;interceptorNames&quot;</p>
<p>&gt;
&lt;</p>
<p>list</p>
<p>&gt;</p>
<p>&lt;</p>
<p>value</p>
<blockquote>
<p>methodCachePointCut&lt;/</p>
</blockquote>
<p>value</p>
<p>&gt;
&lt;/</p>
<p>list</p>
<p>&gt;</p>
<p>&lt;/</p>
<p>property</p>
<p>&gt;
&lt;/</p>
<p>bean</p>
<p>&gt;</p>
<p>其中myServiceBean是实现了业务逻辑的Bean，里面的方法myMethod()的返回结果需要被缓存。这样每次对myServiceBean的myMethod()方法进行调用,都会首先从缓存中查找,其次才会查询数据库。使用AOP的方式极大地提高了系统的灵活性，通过修改配置文件就可以实现对方法结果的缓存，所有的对Cache的操作都封装在了拦截器的实现中。</p>
<p> CachingFilter功能
使用Spring的AOP进行整合，可以灵活的对方法的的返回结果对象进行缓存。CachingFilter功能可以对HTTP响应的内容进行缓存。这种方式缓存数据的粒度比较粗，例如缓存整张页面。它的优点是使用简单、效率高，缺点是不够灵活，可重用程度不高。
EHCache使用SimplePageCachingFilter类实现Filter缓存。该类继承自CachingFilter，有默认产生cache key的calculateKey()方法，该方法使用HTTP请求的URI和查询条件来组成key。也可以自己实现一个Filter，同样继承CachingFilter类,然后覆写calculateKey()方法，生成自定义的key。
在笔者参与的项目中很多页面都使用AJAX，为保证JS请求的数据不被浏览器缓存，每次请求都会带有一个随机数参数i。如果使用SimplePageCachingFilter，那么每次生成的key都不一样，缓存就没有意义了。这种情况下，我们就会覆写calculateKey()方法。</p>
<p>要使用SimplePageCachingFilter，首先在配置文件ehcache.xml中，增加下面的配置：
1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9</p>
<p>10
11</p>
<p>12
&lt;</p>
<p>cache</p>
<p>name</p>
<p>=</p>
<p>&quot;SimplePageCachingFilter&quot;</p>
<p>maxElementsInMemory</p>
<p>=</p>
<p>&quot;10000&quot;</p>
<p>eternal</p>
<p>=</p>
<p>&quot;false&quot;</p>
<p>overflowToDisk</p>
<p>=</p>
<p>&quot;false&quot;</p>
<p>timeToIdleSeconds</p>
<p>=</p>
<p>&quot;300&quot;</p>
<p>timeToLiveSeconds</p>
<p>=</p>
<p>&quot;600&quot;
memoryStoreEvictionPolicy</p>
<p>=</p>
<p>&quot;LFU&quot;</p>
<p>/&gt;</p>
<p>其中name属性必须为SimplePageCachingFilter，修改web.xml文件，增加一个Filter的配置：
&lt;</p>
<p>filter</p>
<p>&gt;</p>
<p>&lt;</p>
<p>filter-name</p>
<blockquote>
<p>SimplePageCachingFilter&lt;/</p>
</blockquote>
<p>filter-name</p>
<p>&gt;
&lt;</p>
<p>filter-class</p>
<blockquote>
<p>net.sf.ehcache.constructs.web.filter.SimplePageCachingFilter&lt;/</p>
</blockquote>
<p>filter-class</p>
<p>&gt;</p>
<p>&lt;/</p>
<p>filter</p>
<p>&gt;
&lt;</p>
<p>filter-mapping</p>
<p>&gt;</p>
<p>&lt;</p>
<p>filter-name</p>
<blockquote>
<p>SimplePageCachingFilter&lt;/</p>
</blockquote>
<p>filter-name</p>
<p>&gt;
&lt;</p>
<p>url-pattern</p>
<blockquote>
<p>/test.jsp&lt;/</p>
</blockquote>
<p>url-pattern</p>
<p>&gt;</p>
<p>&lt;/</p>
<p>filter-mapping</p>
<p>&gt;</p>
<p>下面我们写一个简单的test.jsp文件进行测试，缓存后的页面每次刷新，在600秒内显示的时间都不会发生变化的。代码如下：</p>
<p>1</p>
<p>2
3&lt;%</p>
<p>out.println(</p>
<p>new</p>
<p>Date());
%&gt;</p>
<p>CachingFilter输出的数据会根据浏览器发送的Accept-Encoding头信息进行Gzip压缩。经过笔者测试，Gzip压缩后的数据量是原来的1/4，速度是原来的4-5倍，所以缓存加上压缩，效果非常明显。
在使用Gzip压缩时，需注意两个问题：</p>
<ol>
<li>Filter在进行Gzip压缩时，采用系统默认编码，对于使用GBK编码的中文网页来说，需要将操作系统的语言设置为：zh_CN.GBK，否则会出现乱码的问题。</li>
<li>默认情况下CachingFilter会根据浏览器发送的请求头部所包含的Accept-Encoding参数值来判断是否进行Gzip压缩。虽然IE6/7浏览器是支持Gzip压缩的，但是在发送请求的时候却不带该参数。为了对IE6/7也能进行Gzip压缩，可以通过继承CachingFilter，实现自己的Filter，然后在具体的实现中覆写方法acceptsGzipEncoding。</li>
</ol>
<p>具体实现参考：
1</p>
<p>2
3</p>
<p>4
5protected</p>
<p>boolean</p>
<p>acceptsGzipEncoding(HttpServletRequest request) {</p>
<p>final</p>
<p>boolean</p>
<p>ie6 = headerContains(request,</p>
<p>&quot;User-Agent&quot;</p>
<p>,</p>
<p>&quot;MSIE 6.0&quot;</p>
<p>);
final</p>
<p>boolean</p>
<p>ie7 = headerContains(request,</p>
<p>&quot;User-Agent&quot;</p>
<p>,</p>
<p>&quot;MSIE 7.0&quot;</p>
<p>);</p>
<p>return</p>
<p>acceptsEncoding(request,</p>
<p>&quot;gzip&quot;</p>
<p>) || ie6 || ie7;
}</p>
<p>EHCache在Hibernate中的使用
EHCache可以作为Hibernate的二级缓存使用。在hibernate.cfg.xml中需增加如下设置：</p>
<p>1</p>
<p>2
3&lt;</p>
<p>prop</p>
<p>key</p>
<p>=</p>
<p>&quot;hibernate.cache.provider_class&quot;</p>
<p>&gt;</p>
<p>org.hibernate.cache.EhCacheProvider
&lt;/</p>
<p>prop</p>
<p>&gt;</p>
<p>然后在Hibernate映射文件的每个需要Cache的Domain中，加入类似如下格式信息：</p>
<p><cache usage="read-write|nonstrict-read-write|read-only" />
比如：</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
9&lt;</p>
<p>cache</p>
<p>usage</p>
<p>=</p>
<p>&quot;read-write&quot;</p>
<p>/&gt;</p>
<p>最后在配置文件ehcache.xml中增加一段cache的配置，其中name为该domain的类名。
&lt;</p>
<p>cache</p>
<p>name</p>
<p>=</p>
<p>&quot;domain.class.name&quot;</p>
<p>maxElementsInMemory</p>
<p>=</p>
<p>&quot;10000&quot;
eternal</p>
<p>=</p>
<p>&quot;false&quot;</p>
<p>timeToIdleSeconds</p>
<p>=</p>
<p>&quot;300&quot;
timeToLiveSeconds</p>
<p>=</p>
<p>&quot;600&quot;</p>
<p>overflowToDisk</p>
<p>=</p>
<p>&quot;false&quot;
/&gt;</p>
<p>EHCache的监控
对于Cache的使用，除了功能，在实际的系统运营过程中，我们会比较关注每个Cache对象占用的内存大小和Cache的命中率。有了这些数据，我们就可以对Cache的配置参数和系统的配置参数进行优化，使系统的性能达到最优。EHCache提供了方便的API供我们调用以获取监控数据，其中主要的方法有：</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
//得到缓存中的对象数</p>
<p>cache.getSize();
//得到缓存对象占用内存的大小</p>
<p>cache.getMemoryStoreSize();
//得到缓存读取的命中次数</p>
<p>cache.getStatistics().getCacheHits()
//得到缓存读取的错失次数</p>
<p>cache.getStatistics().getCacheMisses()</p>
<p>分布式缓存
EHCache从1.2版本开始支持分布式缓存。分布式缓存主要解决集群环境中不同的服务器间的数据的同步问题。具体的配置如下：</p>
<p>在配置文件ehcache.xml中加入
1</p>
<p>2
3</p>
<p>4
5&lt;</p>
<p>cacheManagerPeerProviderFactory</p>
<p>class</p>
<p>=</p>
<p>&quot;net.sf.ehcache.distribution.RMICacheManagerPeerProviderFactory&quot;
properties</p>
<p>=</p>
<p>&quot;peerDiscovery=automatic, multicastGroupAddress=230.0.0.1, multicastGroupPort=4446&quot;</p>
<p>/&gt;</p>
<p>&lt;</p>
<p>cacheManagerPeerListenerFactory
class</p>
<p>=</p>
<p>&quot;net.sf.ehcache.distribution.RMICacheManagerPeerListenerFactory&quot;</p>
<p>/&gt;</p>
<p>另外，需要在每个cache属性中加入</p>
<p>1</p>
<p>2
3</p>
<p>4
5</p>
<p>6
7</p>
<p>8
&lt;</p>
<p>cacheEventListenerFactory</p>
<p>class</p>
<p>=</p>
<p>&quot;net.sf.ehcache.distribution.RMICacheReplicatorFactory&quot;</p>
<p>/&gt;</p>
<p>例如：
&lt;</p>
<p>cache</p>
<p>name</p>
<p>=</p>
<p>&quot;demoCache&quot;</p>
<p>maxElementsInMemory</p>
<p>=</p>
<p>&quot;10000&quot;
eternal</p>
<p>=</p>
<p>&quot;true&quot;</p>
<p>overflowToDisk</p>
<p>=</p>
<p>&quot;true&quot;</p>
<p>&gt;
&lt;</p>
<p>cacheEventListenerFactory</p>
<p>class</p>
<p>=</p>
<p>&quot;net.sf.ehcache.distribution.RMICacheReplicatorFactory&quot;</p>
<p>/&gt;</p>
<p>&lt;/</p>
<p>cache</p>
<p>&gt;</p>
<p>总结
EHCache是一个非常优秀的基于Java的Cache实现。它简单、易用，而且功能齐全，并且非常容易与Spring、Hibernate等流行的开源框架进行整合。通过使用EHCache可以减少网站项目中数据库服务器的访问压力，提高网站的访问速度，改善用户的体验。</p>
<p>原文:<a href="http://blog.sina.com.cn/s/blog_46d5caa40100ka9z.html" target="_blank">http://blog.sina.com.cn/s/blog_46d5caa40100ka9z.html</a>
<a href="http://www.dev26.com/blog/article/352/1#" title="分享到QQ空间" target="_blank"></a> <a href="http://www.dev26.com/blog/article/352/1#" title="分享到新浪微博"></a> <a href="http://www.dev26.com/blog/article/352/1#" title="分享到腾讯微博" target="_blank"></a> <a href="http://www.dev26.com/blog/article/352/1#" title="分享到人人网"></a> 更多 <a href="http://www.dev26.com/blog/article/352/1#" title="累计分享0次" target="_blank">0</a></p>
<p>-
评分
请<a href="http://www.dev26.com/login" target="_blank">登录</a>后再对此文章评分</p>
<p><a href=""></a>列出所有评论</p>
<p><strong>没有可显示的项目</strong></p>
<p>发表您的评论</p>
<p>您尚未登录，无法发表评论   <img src="&quot;登录&quot;" alt="dev26登录">为什么要登录后才能发表评论？ 我们发现许多网站的大多数恶意评论（人身攻击，广告等）都是以匿名形式发布的，这样难以使一个技术社区形成一个和谐的讨论氛围。我们鼓励网友提出中肯的评论，留下您的身份也使得作者更容易与您交流。  您当前的登录名为<em>**</em> 评论：</p>
<p><a href="">加入收藏</a>- <a href="&quot;设为首页&quot;">设为首页</a>- <a href="http://www.dev26.com/runtime/privacy.html" target="_blank">隐私保护</a>- <a href="http://www.dev26.com/runtime/contact.html" target="_blank">联系我们</a>- <a href="http://www.dev26.com/runtime/help.html" target="_blank">获得帮助</a></p>
<p>Web开发站——为Web开发增添活力 <a href="http://tongji.baidu.com/hm-web/welcome/ico?s=ac500a971f22019aa0e7403308701c33" target="_blank"><img src="" alt=""></a></p>
<p>版权所有 © 2011-2012 备案号:京ICP备12003253号-1</p>
<h3 id="-">发送消息</h3>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/缓存/">缓存</a></li></span><span class="breadcrumb"><li><a href="/categories/缓存/">缓存</a></li><li><a href="/categories/缓存/ehcache/">ehcache</a></li></span></span> | <span class="tags">Tagged <a href="/tags/ehcache/" class="label label-primary">ehcache</a><a href="/tags/缓存/" class="label label-success">缓存</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:39"datetime="2014-03-07 09:54:39"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-缓存-ehcache--EHCache的使用教程-黑神领主的博客-dev26com/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-缓存-ehcache--EHCache的使用教程-黑神领主的博客-dev26com" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-缓存-memcached--应用memcached提升站点性能——减少读自数据库和数据源-简约设计の艺术-博客频道/">应用 memcached 提升站点性能——减少读自数据库和数据源 </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:39.000Z"> <a href="/2014/02/02/2014-02-02-缓存-memcached--应用memcached提升站点性能——减少读自数据库和数据源-简约设计の艺术-博客频道/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="-memcached-csdn-net">应用 memcached 提升站点性能——减少读自数据库和数据源 - 简约设计の艺术 - 博客频道 - CSDN.NET</h1>
<p>您还未登录！|<a href="https://passport.csdn.net/account/login" target="_blank">登录</a>|<a href="https://passport.csdn.net/account/register" target="_blank">注册</a>|<a href="https://passport.csdn.net/help/faq" target="_blank">帮助</a></p>
<ul>
<li><a href="http://www.csdn.net/" target="_blank">首页</a></li>
<li><a href="http://news.csdn.net/" target="_blank">业界</a></li>
<li><a href="http://mobile.csdn.net/" target="_blank">移动</a></li>
<li><a href="http://cloud.csdn.net/" target="_blank">云计算</a></li>
<li><a href="http://sd.csdn.net/" target="_blank">研发</a></li>
<li><a href="http://bbs.csdn.net/" target="_blank">论坛</a></li>
<li><a href="http://blog.csdn.net/" target="_blank">博客</a></li>
<li><a href="http://download.csdn.net/" target="_blank">下载</a></li>
<li><h2 id="-"><a href="">更多</a></h2>
</li>
</ul>
<h1 id="-http-blog-csdn-net-dl88250-"><a href="http://blog.csdn.net/DL88250" target="_blank">简约设计の艺术</a></h1>
<h2 id="-">一个自由程序员的琐碎</h2>
<ul>
<li><a href="http://blog.csdn.net/DL88250?viewmode=contents" target="_blank"><img src="" alt="">目录视图</a></li>
<li><a href="http://blog.csdn.net/DL88250?viewmode=list" target="_blank"><img src="" alt="">摘要视图</a></li>
<li><a href="http://blog.csdn.net/DL88250/rss/list" target="_blank"><img src="" alt="">订阅</a>
<a href="https://code.csdn.net/blog/12" target="_blank">公告：博客新增直接引用代码功能</a>        <a href="http://www.csdn.net/article/2013-07-24/2816320" target="_blank">专访谭海燕：移动互联网开发的那些事</a>      <a href="http://blog.csdn.net/csdnproduct/article/details/9226265" target="_blank">CSDN博客频道自定义摘要、图片水印、热门标签等功能上线啦</a>      <a href="http://blog.csdn.net/blogdevteam/article/details/9136613" target="_blank">CSDN博客第二期云计算最佳博主评选</a>      <a href=""></a></li>
</ul>
<h3 id="-memcached-"><a href="">应用 memcached 提升站点性能——减少读自数据库和数据源</a></h3>
<p>分类： <a href="http://blog.csdn.net/DL88250/article/category/768467" target="_blank">Cache</a> <a href="http://blog.csdn.net/DL88250/article/category/768466" target="_blank">Memcached</a> <a href="http://blog.csdn.net/DL88250/article/category/259943" target="_blank">Data-Structrue/Algorithms</a> <a href="http://blog.csdn.net/DL88250/article/category/296292" target="_blank">Open Source</a> <a href="http://blog.csdn.net/DL88250/article/category/362353" target="_blank">Architecture Design</a>  2010-12-21 09:14 4720人阅读 <a href="">评论</a>(4) <a href="&quot;收藏&quot;">收藏</a> <a href="&quot;举报&quot;">举报</a>
<a href="http://blog.csdn.net/tag/details.html?tag=memcached" target="_blank">memcached</a><a href="http://blog.csdn.net/tag/details.html?tag=%e6%95%b0%e6%8d%ae%e5%ba%93" target="_blank">数据库</a><a href="http://blog.csdn.net/tag/details.html?tag=%e5%ad%98%e5%82%a8" target="_blank">存储</a><a href="http://blog.csdn.net/tag/details.html?tag=%e6%9c%8d%e5%8a%a1%e5%99%a8" target="_blank">服务器</a><a href="http://blog.csdn.net/tag/details.html?tag=ibm" target="_blank">ibm</a><a href="http://blog.csdn.net/tag/details.html?tag=websphere" target="_blank">websphere</a></p>
<p>目录<a href="&quot;系统根据文章中H1到H6标签自动生成文章目录&quot;">(?)</a><a href="&quot;展开&quot;">[+]</a></p>
<ol>
<li><a href="">简介</a></li>
<li><a href="">基础知识</a></li>
<li><a href="">何时使用 memcached</a></li>
<li><a href="">键名称空间和值</a></li>
<li><a href="">填充并使用 memcached</a></li>
<li><a href=""></a></li>
<li><a href="">弹性和可用性</a></li>
<li><a href="">分配缓存</a></li>
<li><p><a href="">如何能不使用 memcached</a></p>
</li>
<li><p><a href="">memcached 不是一个数据库</a></p>
</li>
<li><a href="">不要缓存数据库行或文件</a></li>
<li><p><a href="">memcached 并不安全</a></p>
</li>
<li><p><a href="">不要限制自己</a></p>
</li>
<li><a href="">结束语</a></li>
<li><a href="">参考资料</a></li>
<li><a href="">关于作者</a>
<img src="" alt="Memcached Banner"></li>
</ol>
<p><a href="http://www.ibm.com/developerworks/cn/opensource/os-memcached/#author1" target="_blank">Martin Brown</a>, 自由撰稿人, Freelance Developer
Martin Brown 成为专业作家已有七年多的时间了。他是题材广泛的众多书籍和文章的作者。他的专业技术涉及各种开发语言和平台 —— Perl、Python、Java™、JavaScript、Basic、Pascal、Modula-2、C、C++、Rebol、Gawk、 Shellscript、Windows、Solaris、Linux®、BeOS、Mac OS/X 等等，还涉及 Web 编程、系统管理和集成。Martin 是 Microsoft® 的主题专家（SME），并且是 ServerWatch.com、LinuxToday.com 和 IBM developerWorks 的定期投稿人，他还是 Computerworld、The Apple Blog 和其他站点的正式博客。您可以通过他的 Web 站点 : <a href="http://www.mcslp.com/" target="_blank"><a href="http://www.mcslp.com">http://www.mcslp.com</a></a> 与他联系。</p>
<p><strong>简介：</strong> 开源 <em>memcached</em> 工具是一个用来存储常用信息的缓存，有了它，您便无需从缓慢的资源，比如磁盘或数据库，加载（并处理）信息了。该工具可部署在专用的情况下，也可作为用完 现有环境内的多余内存的一种方法。尽管 memcached 十分简便，但有时它仍被不当使用，或被用在错误的环境类型中。在本文中，了解使用 memcached 的最佳时机。</p>
<h2 id="-"><a href=""></a><a href="">简介</a></h2>
<p>memcached 常被用来加速应用程序的处理，在这里，我们将着重于介绍将它部署于应用程序和环境中的最佳实践。这包括应该存储或不应存储哪些、如何处理数据的灵活分布以 及如何调节用来更新 memcached 和所存储数据的方法。我们还将介绍对高可用性的解决方案的支持，比如 IBM WebSphere® eXtreme Scale。</p>
<p>所有的应用程序，特别是很多 web 应用程序都需要优化它们访问客户机和将信息返回至客户机的速度。可是，通常，返回的都是相同的信息。从数据源（数据库或文件系统）加载数据十分低效，若是每次想要访问该信息时都运行相同的查询，就尤显低效。</p>
<p>虽然很多 web 服务器都可被配置成使用缓存发回信息，但那与大多数应用程序的动态特性无法相适。而这正是 memcached 的用武之地。它提供了一个通用的内存存储器，可保存任何东西，包括本地语言的对象，这就让您可以存储各种各样的信息并可以从诸多的应用程序和环境访问这些信息。</p>
<h2 id="-"><a href=""></a><a href="">基础知识</a></h2>
<p>memcached 是一个开源项目，旨在利用多个服务器内的多余 RAM 来充当一个可存放经常被访问信息的内存缓存。这里的关键是使用了术语<em>缓存</em>：memcached 为加载自他处的信息提供的是内存中的暂时存储。</p>
<p>比如，考虑这样一个典型的基于 web 的应用程序。即便是一个动态网站可能也会有一些组件或信息常量是贯穿页面整个生命周期的。在一个博客站点内，针对单个 blog post 的类别列表不大可能在页面查看间经常性地变更。每次都通过一个对数据库的查询加载此信息相对比较昂贵，特别是在数据没有更改的情况下，就更是如此。从图 1 可以看到一个博客站点内可被缓存的页面分区。</p>
<p><a href=""><strong>图 1. 一个典型的博客页面内的可缓存元素</strong></a>
<img src="" alt="此图显示了可缓存的 blog 元素及其布局：顶部是 Page Header，左边是当前的 Current post lists，右边是 About、Post History、External Links 和 Category list"></p>
<p>将这种结构放在 blog 站点的其他元素，poster 信息、注释 — 设置 blog post 本身 — 进行推断，可以看出为了显示主页的内容很可能需要发生 10-20 次数据库查询和格式化。 每天对数百甚至数千的的页面查看重复此过程，那么您的服务器和应用程序执行的查询要远远多于为了显示页面内容所需执行的查询。</p>
<p>通过使用 memcached，可以将加载自数据库的格式化信息存储为一种可直接用在 Web 页面上的格式。并且由于信息是从 RAM 而不是通过数据库和其他处理从磁盘加载的，所以对信息的访问几乎是瞬时的。</p>
<p>再强调一下，memcached 是一个用来存储常用信息的缓存，有了它，您便无需从缓慢的资源，比如磁盘或数据库，加载并处理信息了。</p>
<p>对 memcached 的接口是通过网络连接提供的。这意味着您可以在多个客户机间共享单个的 memcached 服务器（或多个服务器，如本文稍后所示的）。这个网络接口非常迅速，并且为了改善性能，服务器会故意不支持身份验证或安全性通信。但这不应限制部署选项。 memcached 服务器应该存在于您网络的<em>内部</em>。网络接口的实用性以及可以部署多个 memcached 实例的简便性让您可以使用多个机器上的<em>多余</em> RAM 来提高您缓存的整体大小。</p>
<p>memcached 的存储方法是一个简单的键/值对，类似于很多语言内的散列或关联数组。通过提供键和值来将信息存储到 memcached 内，通过按特定的键请求信息来恢复信息。</p>
<p>信息会无限期地保留在缓存内，除非发生如下的情况：</p>
<ol>
<li><strong>为缓存分配的内存耗尽</strong> — 在这种情况下，memcached 使用 LRU（最近最少使用）方法从此缓存删除条目。最近未曾使用的条目会从此缓存中先删除，最旧的最先访问。</li>
<li><strong>条目被明确删除</strong> — 总是可以从此缓存内删除条目。</li>
<li><strong>条目过期失效</strong> — 各条目均有一个有效的期限以便针对此键存储的信息在过于陈旧时可从缓存中清除这些条目。</li>
</ol>
<p>上述这些情况可以与您应用程序的逻辑综合使用以便确保缓存内的信息是最新的。有了这些基础知识后，让我们来看看在应用程序内如何能最好地利用 memcached。</p>
<h2 id="-memcached-"><a href=""></a><a href="">何时使用 memcached</a></h2>
<p>在使用 memcached 改进应用程序性能时，可以对一些关键的过程和步骤进行修改。</p>
<p>在加载信息时，典型的场景如图 2 所示。</p>
<p><a href=""><strong>图 2. 加载要显示的信息的典型顺序</strong></a>
<img src="" alt="此图显示了从加载数据到处理/格式化数据再到发送数据至客户机的流程"></p>
<p>一般而言，这些步骤是：</p>
<ol>
<li>执行一个或多个查询来从数据库加载信息</li>
<li>格式化适合于显示（或进一步处理）的信息</li>
<li>使用或显示格式化了的数据</li>
</ol>
<p>在使用 memcached 时，为配合这个缓存，可对应用程序的逻辑进行稍许修改：</p>
<ul>
<li>尽量从缓存加载信息</li>
<li>如果存在，使用信息的被缓存版本</li>
<li>如果它不存在：</li>
</ul>
<ol>
<li>执行一个或多个查询来从数据库加载信息</li>
<li>格式化适合于显示或进一步处理的信息</li>
<li>将信息存储到缓存内</li>
<li>使用格式化了的数据</li>
</ol>
<p>图 3 是对这些步骤的总结。</p>
<p><a href=""><strong>图 3. 在使用 memcached 时加载适合于显示的信息</strong></a>
<img src="" alt="此图显示了如果所请求的数据位于缓存内，它就会跳过所有处理步骤，节省了时间"></p>
<p>数据加载成为了至多三个步骤的一个过程，从缓存加载数据或从数据库（视情况而定）加载数据并存储在缓存内。</p>
<p>当这个过程首次发生时，数据将正常地从数据库或其他数据源加载，然后再存储到 memcached 内。当下一次访问此信息时，它就会从 memcached 拉出，而不是从数据库加载，节省了时间和 CPU 循环。</p>
<p>问题的另一个方面是要确保如果更改了要存储在 memcached 内的信息，在更新后端信息的同时还要更新 memcached 的版本。这会让图 4 内所示的这个典型顺序发生稍许变化，如 <a href="http://www.ibm.com/developerworks/cn/opensource/os-memcached/#f5" target="_blank">图 5</a> 所示。</p>
<p><a href=""><strong>图 4. 在一个典型的应用程序内更新或存储数据</strong></a>
<img src="" alt="此图显示了从更新数据到处理/格式化数据再到发送更新了的数据至客户机的流程"></p>
<p>图 5 显示了使用 memcached 后发生了变化的流程。</p>
<p><a href=""><strong>图 5. 在使用 memcached 时更新或存储数据</strong></a>
<img src="" alt="此图显示了拓展了的流程：从更新数据到处理/格式化数据，再到将数据存储在 memcached 内，最后到发送更新了的数据至客户机"></p>
<p>比如，仍以博客站点为例，在博客系统更新数据库内的类别列表时，更新应该遵循如下顺序：</p>
<ol>
<li>更新数据库内的类别列表</li>
<li>格式化信息</li>
<li>将信息存储到 memcached 内</li>
<li>将信息返回至客户机</li>
</ol>
<p>memcached 内的存储操作是原子的，所以信息的更新不会让客户机只获得部分数据；它们获得的或者是老版本，或者是新版本。</p>
<p>对于大多数应用程序，这两个操作是您惟一需要注意的。在访问他人使用的数据时，它会自动被添加到这个缓存内，而且如果对该数据进行了更改，此缓存内也会自动进行更新。</p>
<h2 id="-"><a href=""></a><a href="">键、名称空间和值</a></h2>
<p>memcached 另一个需要重点考虑的因素是如何组织和命名存储在缓存内的这些数据。从之前博客站点的例子中，不难看出需要使用一种一致的命名结构以便您能加载博客类别、历史和其他信息，然后再在加载信息（并更新缓存）时或者在更新数据（同样也要更新缓存）时使用。</p>
<p>使用的何种具体的命名系统特定于应用程序，但通常可以使用一种与现有应用程序类似的结构，并且这种结构很可能基于某种惟一识别符。当从数据库拉出信息或在整理信息集时，就会发生这种情况。</p>
<p>以 blog post 为例，可以在一个具有键</p>
<p>category-list
的项中存储类别列表。与此 post ID 对应的单个 post，比如</p>
<p>blogpost-29
相关的值都可以使用，而该项的注释则可以存储在</p>
<p>blogcomments-29
内，其中 <em>29</em> 就是这个 blog post 的 ID。这样一来， 您就可以将各种各样的信息存储在缓存内，使用不同的前缀来标识这些信息。</p>
<p>memcached 键/值存储的简便性（以及安全性的缺乏）意味着如果您想要在使用同一个 memcached 服务器的同时支持多个应用程序，那么就可以考虑使用其他格式的量词来标识数据属于某种特定的应用程序。比如，可以添加像</p>
<p>blogapp:blogpost-29
这样的应用程序前缀。这些键是没有格式的，所以可以使用任何字符串作为键的名称。</p>
<p>在存储值的方面，应该确保存储在缓存内的信息适合于您的应用程序。比如，对于这个博客系统，您可能想要存储被博客应用程序使用的对象以便格式化博客信息，而不是原始的 HTML。如果同一个基础结构用在应用程序内的多个地方，这一点更具实用性。</p>
<p>大多数语言的接口，包括 Java™、Perl、PHP 等，都能串行化语言对象以便存储在 memcached 内。这就让您可以存储并随后从内存存储恢复全部对象，而不是在您的应用程序内手动重构它们。 很多对象，或它们使用的结构，都基于某种散列或数组结构。对于跨语言的环境，比如在 JSP 环境和 JavaScript 环境间共享相同信息，可以使用一种架构中立的格式，比如 JavaScript Object Notation (JSON) 甚或 XML。</p>
<h2 id="-memcached-"><a href=""></a><a href="">填充并使用 memcached</a></h2>
<p>作为一种开源产品以及一种最初开发用来工作于现有开源环境内的产品，memcached 受大量环境和平台支持。与 memcached 服务器通信的接口有很多，并常常具有针对所有语言的多个实现。参见 <a href="http://www.ibm.com/developerworks/cn/opensource/os-memcached/resources.html" target="_blank">参考资料</a> 以获得常用的库和工具箱。</p>
<p>要列出所有受支持的接口和环境不太可能，但它们均支持 memcached 协议提供的基础 API。这些描述已经被简化并应用在不同语言的上下文内，在这些语言中，使用不同的值可指示错误。主要的函数有：</p>
<ul>
<li>get(key)
— 从存储了特定键的 memcached 获得信息。 如果键不存在，就返回错误。</li>
<li>set(key, value [, expiry])
— 使用缓存内的标识符键存储这个特定的值。如果键已经存在，那么它就会被更新。期满时间的单位为秒，并且如果值小于 30 天 (30/<em>24/</em>60/*60)，那么就用作相对时间，如果值大于 30 天，那么就用作绝对时间 (epoch)。</li>
<li>add(key, value [, expiry])
— 如果键不存在就将这个键添加到缓存内，如果键已经存在就返回错误。如果您想要显式地添加一个新键而又不会因它已经存在而更新它，那么这个函数将十分有用。</li>
<li>replace(key, value [, expiry])
— 更新此特定键的值，如果键不存在就返回一个错误。</li>
<li>delete(key [, time])
— 从缓存中删除此键/值对。如果您提供一个时间，那么添加具有此键的一个新值就会被阻塞这个特定的时期。超时让您可以确保此值总是可以重新读取自您的数据中心。</li>
<li>incr(key [, value]
) — 为特定的键增 1 或特定的值。只适用于数值。</li>
<li>decr(key [, value])
— 为特定的键减 1 或特定的值，只适用于数值。</li>
<li>flush_all
— 让缓存内的所有当前条目无效（或到期失效）。</li>
</ul>
<p>比如，在 Perl 内，基本 set 操作可以如清单 1 所示的那样处理。</p>
<p><a href=""><strong>清单 1. Perl 内的基本 set 操作</strong></a>
use Cache::Memcached;
my $cache = new Cache::Memcached {
&#39;servers&#39; =&gt; [
&#39;localhost:11211&#39;,
],
};
$cache-&gt;set(&#39;mykey&#39;, &#39;myvalue&#39;);</p>
<p>Ruby 内的相同的基本操作如清单 2 所示。</p>
<p><a href=""><strong>清单 2. Ruby 内的基本 set 操作</strong></a>
require &#39;memcache&#39;
memc = MemCache::new &#39;192.168.0.100:11211&#39;
memc[&quot;mykey&quot;] = &quot;myvalue&quot;</p>
<p>在两个例子中可以看到相同的基本结构：设置 memcached 服务器，然后分配或设置值。其他的接口也可用，包括适合于 Java 技术的那些接口，让您可以在 WebSphere 应用程序内使用 memcached。memcached 接口类允许将 Java 对象直接序列化到 memcached 以便于存储和加载复杂的结构。当在像 WebSphere 这样的环境内进行部署时，有两个事情非常重要：服务的弹性（在 memcached 不可用时如何做）以及如何提高缓存存储量来改进在使用多个应用程序服务器或在使用像 WebSphere eXtreme Scale 这样的环境时的性能。我们接下来就来看看这两个问题。</p>
<h2 id="-"><a href=""></a></h2>
<h2 id="-"><a href=""></a><a href="">弹性和可用性</a></h2>
<p>有关 memcached 最常见的一个问题是：“若缓存不可用了，会发生什么情况呢？”正如之前章节中明示的，缓存内的信息不应该成为信息的的惟一资源。必须要能够从其他位置加载存储在缓存内的数据。</p>
<p>虽然，无法从缓存访问信息将会减缓应用程序的性能，但它不应该阻止应用程序的运转。可能会发生这样几个场景：</p>
<ol>
<li>如果 memcached 服务宕掉，应用程序应该回退到从原始数据源加载信息并对信息进行显示所需的格式化。此应用程序还应继续尝试在 memcached 内加载和存储信息。</li>
<li>一旦 memcached 服务器恢复可用，应用程序就应该自动尝试存储数据。没有必要强制重载已缓存了的数据，可以使用标准的访问来用信息加载和填充缓存。最终，缓存将会被最常用的数据重新填充。</li>
</ol>
<p>再次重申，memcached 是信息的缓存但并非惟一的数据源。memcached 服务器不可用不应该是应用程序的终结，虽然这意味着在 memcached 服务器恢复正常之前性能会有所降低。实际上，memcached 服务器相对简单，并且虽然不是绝对无故障的，但它的简单性的结果就是它很少会出错。</p>
<h2 id="-"><a href=""></a><a href="">分配缓存</a></h2>
<p>memcached 服务器只是网络上针对一些键存储值的一个缓存。如果有多台机器，那么很自然地会想要在所有多余机器上设置一个 memcached 的实例来提供一个超大的联网 RAM 缓存存储。</p>
<p>有了这个想法后，还有一种想当然是需要使用某种分配或复制机制来在机器之间复制键/值对。这种方式的问题是如果这么做反而会减少可用的 RAM 缓存，而不是增加。如图 6 所示，可以看出这里有三个应用程序服务器，每个服务器都可以访问一个 memcached 实例。</p>
<p><a href=""><strong>图 6. 多重 memcached 实例的不正确使用</strong></a>
<img src="" alt="此图显示了 memcached 的三个独立的 1-GB 实例，支持三个应用程序服务器，各产出 1 GB 的缓存空间"></p>
<p>尽管每个 memcached 实例都是 1 GB 的大小（产生 3 GB 的 RAM 缓存），但如果每个应用程序服务器只有其自己的缓存（或者在 memcached 之间存在着数据的复制），那么整个安装也仍只能有 1 GB 的缓存在每个实例间复制。</p>
<p>由于 memcached 通过一个网络接口提供信息，因此单个的客户机可以从它所能访问的任何一个 memcached 实例访问数据。如果数据没有跨每个实例被复制，那么最终在每个应用程序服务器上，就可以有 3 GB 的 RAM 缓存可用，如图 7 所示。</p>
<p><a href=""><strong>图 7. 多重 memcached 实例的正确使用</strong></a>
<img src="" alt="此图显示了三个交互的 1-GB memcached 实例，支持三个应用程序服务器，导致总体 3 GB 的共享缓存空间"></p>
<p>这个方法的问题是选择哪个服务器来储存键/值对，以及当想要重新获得一个值时，如何决定要与哪个 memcached 服务器对话。问题的解决方案就是忽略复杂的东西，比如查找表，或是寄望 memcached 服务器来为您处理这个过程。而 memcached 客户机则必须要力求简单。</p>
<p>memcached 客户机不必决定此信息，它只需对在存储信息时指定的键使用一个简单的散列算法。当想要从一列 memcached 服务器存储或获取信息时，memcached 客户机就会用一个一致的散列算法从这个键获取一个数值。举个例子，键</p>
<p>mykey
被转换成数值</p>
<p>23875
。是保存还是获取信息无关紧要，这个键将总是被用作惟一标识符来从 memcached 服务器加载，因此在本例中，“mykey” 散列转化后对应的值总是</p>
<p>23875
。</p>
<p>如果有两个服务器，那么 memcached 客户机将对这个数值进行一个简单的运算（例如，系数）来决定它应将此值存储在第一个还是第二个配置了的 memcached 实例上。</p>
<p>当存储一个值时，客户机会从这个键确定出散列值以及它原来存储在哪个服务器上。当获取一个值时，客户机会从这个键确定出相同的散列值并会选择相同的服务器来获取信息。</p>
<p>如果在每个应用程序服务器上使用的是相同的服务器列表（并且顺序相同），那么当需要保存或检索同一个键时，每个应用程序服务器都将选择同一个 服务器。现在，在这个例子中，有 3GB 的 memcached 空间可以共享，而不是同一个 1 GB 的空间的复制，这就带来了更多的可用缓存，并很有可能会提高有多个用户情况下的应用程序的性能。</p>
<p>这个过程也有其复杂性（比如当一个服务器不可用时会怎样），更多信息，请参见相关文档（参见 <a href="http://www.ibm.com/developerworks/cn/opensource/os-memcached/resources.html" target="_blank">参考资料</a>）。</p>
<h2 id="-memcached-"><a href=""></a><a href="">如何能不使用 memcached</a></h2>
<p>尽管 memcached 很简单，但 memcached 实例有时候还是会被不正确地使用。</p>
<h3 id="-memcached-"><a href=""></a><a href="">memcached 不是一个数据库</a></h3>
<p>最常见的 memcached 误用就是把它用作一个数据存储，而不是一个缓存。memcached 的首要目的就是加快数据的响应时间，否则数据从其他数据源构建或恢复需要很长时间。一个典型的例子就是从一个数据库中恢复信息，特别是在信息显示给用户前 需要对信息进行格式化或处理的时候。Memcached 被设计用来将信息存储在内存中以避免每次在数据需要恢复时重复执行相同的任务。</p>
<p>切不可将 memcached 用作运行应用程序所需信息的惟一信息源；数据应总是可以从其他信息源获取。此外，要记住 memcached 只是一个键/值的存储。不能在数据上执行查询，或者对内容进行迭代来提取信息。应该使用它来存储数据块或对象以备批量使用。</p>
<h3 id="-"><a href=""></a><a href="">不要缓存数据库行或文件</a></h3>
<p>虽然可以使用 memcached 存储加载自数据库的数据行，但这实际上是查询缓存，并且大多数数据库都提供各自的查询缓存的机制。其他的对象，比如文件系统的图像或文件的情况与此相同。很多应用程序和 web 服务器针对此类工作已经有了一些很好的解决方案。</p>
<p>如果在加载和格式化后，使用它来存储全部信息块，就可以从 memcached 获得更多的实用工具和性能上的改善。仍以我们的博客站点为例，存储信息的最佳点是在将博客类别格式化为对象，甚至是在格式化成 HTML 后。博客页面的构造可通过从 memcached 加载各个组件（比如 blog post、category list、post history 等）并将完成的 HTML 写回至客户机实现。</p>
<h3 id="-memcached-"><a href=""></a><a href="">memcached 并不安全</a></h3>
<p>为了确保最佳性能，memcached 并未提供任何形式的安全性，没有身份验证，也没有加密。这意味着对 memcached 服务器的访问应该这么处理：一是通过将它们放到应用程序部署环境相同的私有侧，二是如果安全性是必须的，那么就使用 UNIX® socket 并只允许当前主机上的应用程序访问此 memcached 服务器。</p>
<p>这多少牺牲了一些灵活性和弹性，以及跨网络上的多台机器共享 RAM 缓存的能力，但这是在目前的情况下确保 memcached 数据安全性的惟一一种解决方案。</p>
<h2 id="-"><a href=""></a><a href="">不要限制自己</a></h2>
<p>除了不应该使用 memcached 实例的情况外，memcached 的灵活性不应忽视。由于 memcached 与应用程序处于相同的架构水平，所以很容易集成并连接到它。并且更改应用程序以便利用 memcached 也并不复杂。此外，由于 memcached 只是一个缓存，所以在出现问题时它不会停止应用程序的执行。如果使用正确的话，它所做的是减轻其余服务器基础设施的负载（减少对数据库和数据源的读操 作），这意味着无需更多的硬件就可以支持更多的客户机。</p>
<p>但请记住，它仅仅是个缓存！</p>
<h2 id="-"><a href=""></a><a href="">结束语</a></h2>
<p>在本文中，我们了解了 memcached 以及如何最佳地使用它。我们看到了信息如何存储、如何选择合理的键以及如何选择要存储的信息。我们还讨论了所有 memcached 用户都要遇到的一些关键的部署问题，包括多服务器的使用、当 memcached 实例消亡时该怎么做，以及（也许最为重要的）在哪些情况下不能使用 memcached。</p>
<p>作为一种开源的应用程序并且是目的简单而直白的应用程序，memcached 的功能和实用性均来自于这种简单性。通过为信息提供巨大的 RAM 存储空间、让它在网络上可用，然后再让它可通过各种不同的接口和语言访问到，memcached 可被集成到多种多样的安装和环境中。</p>
<h2 id="-"><a href=""></a><a href="">参考资料</a></h2>
<p><strong>学习</strong></p>
<ul>
<li><a href="http://dev.mysql.com/doc/refman/5.1/en/ha-memcached.html" target="_blank">MySQL memcached 文档</a> 提供了很多有关如何在一个典型的数据库部署环境内使用 memcached 的信息。</li>
<li>通过体验 <a href="http://www.ibm.com/developerworks/cn/data/products/soliddb/" target="_blank">IBM solidDB 产品家族</a>，了解 IBM 的商业缓存解决方案 solidDB®。</li>
<li>随时关注 developerWorks <a href="http://www.ibm.com/developerworks/cn/offers/techbriefings/" target="_blank">技术活动</a>和<a href="http://www.ibm.com/developerworks/cn/swi/" target="_blank">网络广播</a>。</li>
<li>查阅最近将在全球举办的面向 IBM 开放源码开发人员的研讨会、交易展览、网络广播和其他 <a href="http://www.ibm.com/developerworks/views/opensource/events.jsp" target="_blank">活动</a>。</li>
<li>访问 developerWorks <a href="http://www.ibm.com/developerworks/cn/opensource/" target="_blank">Open source 专区</a>获得丰富的 how-to 信息、工具和项目更新以及<a href="http://www.ibm.com/developerworks/cn/opensource/best2009/index.html" target="_blank">最受欢迎的文章和教程</a>，帮助您用开放源码技术进行开发，并将它们与 IBM 产品结合使用。</li>
<li>查看免费的 <a href="http://www.ibm.com/developerworks/offers/lp/demos/" target="_blank">developerWorks On demand 演示</a>，观看并了解 IBM 及开源技术和产品功能。</li>
</ul>
<p><strong>获得产品和技术</strong></p>
<ul>
<li><a href="http://memcached.org/" target="_blank">memcached.org</a> 提供了有关 memcached 以及如何下载并安装它的信息。</li>
<li><a href="http://search.cpan.org/%7Ebradfitz/Cache-Memcached-1.28/" target="_blank">Cache::Memcached interface for Perl</a> 提供了一个广泛的接口。</li>
<li>对于 Java 技术，可使用 <a href="http://whalin.com/memcached/" target="_blank">com.danga.MemCached 类</a>，它会提供一些额外的故障转换及多实例扩展。</li>
<li>使用 <a href="http://www.ibm.com/developerworks/cn/downloads/" target="_blank">IBM 产品评估试用版软件</a> 改进您的下一个开发项目，这些软件可以通过下载获得。</li>
<li>下载 <a href="http://www.ibm.com/developerworks/cn/downloads/" target="_blank">IBM 产品评估试用版软件</a> 或 <a href="http://www.ibm.com/developerworks/cn/downloads/soasandbox/people/" target="_blank">IBM SOA Sandbox for People</a>，并开始使用来自 DB2®、Lotus®、Rational®、Tivoli® 和 WebSphere® 的应用程序开发工具和中间件产品。</li>
</ul>
<p><strong>讨论</strong></p>
<ul>
<li>参与 <a href="http://www.ibm.com/developerworks/blogs" target="_blank">developerWorks 博客</a> 加入 developerWorks 社区。</li>
<li>欢迎加入 <a href="http://www.ibm.com/developerworks/cn/mydeveloperworks/" target="_blank">My developerWorks 中文社区</a>。</li>
</ul>
<h2 id="-"><a href=""></a><a href="">关于作者</a></h2>
<p><a href=""></a>Martin Brown 成为专业作家已有七年多的时间了。他是题材广泛的众多书籍和文章的作者。他的专业技术涉及各种开发语言和平台 —— Perl、Python、Java™、JavaScript、Basic、Pascal、Modula-2、C、C++、Rebol、Gawk、 Shellscript、Windows、Solaris、Linux®、BeOS、Mac OS/X 等等，还涉及 Web 编程、系统管理和集成。Martin 是 Microsoft® 的主题专家（SME），并且是 ServerWatch.com、LinuxToday.com 和 IBM developerWorks 的定期投稿人，他还是 Computerworld、The Apple Blog 和其他站点的正式博客。您可以通过他的 Web 站点 : <a href="http://www.mcslp.com/"><a href="http://www.mcslp.com">http://www.mcslp.com</a></a> 与他联系。</p>
<p>转自：<a href="http://www.ibm.com/developerworks/cn/opensource/os-memcached" target="_blank">http://www.ibm.com/developerworks/cn/opensource/os-memcached</a>
本文是使用 <a href="http://b3log-solo.googlecode.com/" target="_blank">B3log Solo</a> 从 <a href="http://88250.b3log.org/" target="_blank">简约设计の艺术</a> 进行同步发布的</p>
<p>原文地址：<a href="http://88250.b3log.org/articles/2010/12/21/1292901251292.html" target="_blank"><a href="http://88250.b3log.org/articles/2010/12/21/1292901251292.html">http://88250.b3log.org/articles/2010/12/21/1292901251292.html</a></a></p>
<p>分享到： <a href="&quot;分享到新浪微博&quot;"></a><a href="&quot;分享到腾讯微博&quot;"></a></p>
<ul>
<li>上一篇：<a href="http://blog.csdn.net/dl88250/article/details/6081379" target="_blank">腾讯对外发布微博开放平台 API</a></li>
<li>下一篇：<a href="http://blog.csdn.net/dl88250/article/details/6091854" target="_blank">谁更胜一筹：技术解析 Google App Engine 和 Amazon EC2</a>
查看评论<a href=""></a></li>
</ul>
<p>4楼 <a href="http://blog.csdn.net/fang00y" target="_blank">fang00y</a> 2011-01-19 17:04发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/fang00y" target="_blank"><img src="" alt=""></a>[e03][e03][e03]3楼 <a href="http://blog.csdn.net/yuanyuan110_l" target="_blank">Rain</a> 2010-12-23 20:24发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/yuanyuan110_l" target="_blank"><img src="" alt=""></a>[e01]打算在现在的产品里用用2楼 <a href="http://blog.csdn.net/xjbx" target="_blank">xjbx</a> 2010-12-23 15:45发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/xjbx" target="_blank"><img src="" alt=""></a>[e03]1楼 <a href="http://blog.csdn.net/ajsfo" target="_blank">ajsfo</a> 2010-12-23 10:10发表 <a href="&quot;回复&quot;">[回复]</a>  <a href="&quot;引用&quot;">[引用]</a> <a href="&quot;举报&quot;">[举报]</a><a href="http://blog.csdn.net/ajsfo" target="_blank"><img src="" alt=""></a>[e01]楼主发现了绝好的东西。
您还没有登录,请<a href="">[登录]</a>或<a href="http://passport.csdn.net/account/register?from=http%3A%2F%2Fblog.csdn.net%2Fdl88250%2Farticle%2Fdetails%2F6088742" target="_blank">[注册]</a></p>
<p>/* 以上用户言论只代表其个人观点，不代表CSDN网站的观点或立场<a href=""></a><a href=""></a>
<a href="&quot;回到顶部&quot;"><img src="" alt="TOP"></a></p>
<p>个人资料</p>
<p><a href="http://my.csdn.net/DL88250" target="_blank"><img src="&quot;访问我的空间&quot;" alt=""></a>
<a href="http://my.csdn.net/DL88250" target="_blank">88250</a></p>
<p><a href="&quot;[加关注]&quot;"></a> <a href="&quot;[发私信]&quot;"></a></p>
<ul>
<li>访问：4219340次</li>
<li>积分：41528分</li>
<li><p>排名：第20名</p>
</li>
<li><p>原创：1195篇</p>
</li>
<li>转载：326篇</li>
<li>译文：42篇</li>
<li>评论：2834条</li>
</ul>
<p>文章搜索</p>
<p><a href=""></a></p>
<p>文章分类</p>
<ul>
<li><a href="http://blog.csdn.net/dl88250/article/category/359483" target="_blank">Adoration</a>(7)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/361991" target="_blank">Agile Develeopment</a>(25)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/817011" target="_blank">Alipay</a>(2)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/785718" target="_blank">Android</a>(2)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/735896" target="_blank">Apache</a>(2)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/362353" target="_blank">Architecture Design</a>(18)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/727396" target="_blank">B3log</a>(31)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/772464" target="_blank">Beyond</a>(2)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/466930" target="_blank">BeyondTrack</a>(8)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/792935" target="_blank">Book</a>(1)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/531019" target="_blank">BPEL</a>(7)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/737397" target="_blank">Buzz</a>(2)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/273193" target="_blank">C/# &amp; .Net</a>(36)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/259942" target="_blank">C/C++</a>(60)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/768467" target="_blank">Cache</a>(4)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/445355" target="_blank">CAS &amp; SAML &amp; SSO</a>(7)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/785583" target="_blank">Chinasb</a>(1)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/830731" target="_blank">Chrome</a>(1)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/279627" target="_blank">Code Name:l0y0l</a>(4)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/323229" target="_blank">Compile Principles</a>(8)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/259943" target="_blank">Data-Structrue/Algorithms</a>(41)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/307128" target="_blank">Database</a>(31)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/318447" target="_blank">Design Patterns</a>(22)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/688714" target="_blank">DHTML</a>(27)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/304165" target="_blank">Eclipse</a>(36)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/472355" target="_blank">EJB 3.x</a>(24)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/371604" target="_blank">English</a>(4)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/772184" target="_blank">EverBox</a>(1)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/259944" target="_blank">Fiddlededee</a>(87)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/798286" target="_blank">FireFox</a>(2)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/823430" target="_blank">FreeMarker</a>(1)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/731730" target="_blank">GAE</a>(32)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/509270" target="_blank">Game</a>(4)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/794103" target="_blank">GFW</a>(1)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/744371" target="_blank">Git</a>(5)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/790487" target="_blank">GlassFish</a>(5)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/755357" target="_blank">Go</a>(4)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/750293" target="_blank">Google</a>(19)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/801964" target="_blank">Guice</a>(1)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/336870" target="_blank">Hibernate Framework</a>(30)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/763988" target="_blank">HTML5</a>(2)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/735897" target="_blank">HttpClient</a>(1)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/801962" target="_blank">IoC/DI</a>(2)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/321666" target="_blank">J2EE/JavaEE</a>(123)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/273192" target="_blank">J2SE/JavaSE</a>(174)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/732513" target="_blank">Java</a>(63)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/362100" target="_blank">Java Persistence API</a>(25)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/359121" target="_blank">Java Server Faces</a>(40)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/742693" target="_blank">JavaEE</a>(14)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/461374" target="_blank">JavaEE Security</a>(3)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/363012" target="_blank">JavaFX</a>(25)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/570523" target="_blank">JavaScript</a>(7)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/450848" target="_blank">JBoss Seam</a>(26)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/531020" target="_blank">jBPM</a>(8)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/786045" target="_blank">JDK 7</a>(3)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/735349" target="_blank">Joke</a>(3)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/814017" target="_blank">JPA</a>(2)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/782163" target="_blank">jQuery</a>(1)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/758468" target="_blank">jsdoc</a>(1)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/757521" target="_blank">jsoup</a>(3)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/510376" target="_blank">JSR-299</a>(21)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/801963" target="_blank">JSR-330</a>(2)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/273771" target="_blank">Life in Programming</a>(153)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/298242" target="_blank">LivaPlayer</a>(14)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/365496" target="_blank">Mathematics</a>(9)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/735535" target="_blank">Maven</a>(8)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/461289" target="_blank">Maven 2</a>(18)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/768466" target="_blank">Memcached</a>(1)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/295040" target="_blank">MultiMediia</a>(17)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/483612" target="_blank">Music</a>(16)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/278915" target="_blank">My Linux</a>(165)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/345108" target="_blank">NetBeans</a>(225)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/300046" target="_blank">Network Engineering</a>(63)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/836154" target="_blank">node.js</a>(1)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/296292" target="_blank">Open Source</a>(261)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/821590" target="_blank">Optimization</a>(1)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/786046" target="_blank">Oracle</a>(6)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/742694" target="_blank">ORM</a>(4)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/364737" target="_blank">OSGi</a>(18)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/743945" target="_blank">PHP</a>(9)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/445013" target="_blank">Portal &amp; Portlet</a>(8)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/833677" target="_blank">Python</a>(1)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/755291" target="_blank">Quartz</a>(1)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/302630" target="_blank">Regular Expression</a>(16)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/361363" target="_blank">Ruby &amp; Rails</a>(19)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/435004" target="_blank">SCA</a>(1)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/310293" target="_blank">Shell Programming</a>(15)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/287867" target="_blank">Software Engineering</a>(42)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/481570" target="_blank">Software Quality Assurance</a>(2)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/318452" target="_blank">Software Testing</a>(15)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/336869" target="_blank">Spring Framework</a>(25)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/363915" target="_blank">StoneAgeDict</a>(28)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/454387" target="_blank">Struts Framework</a>(3)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/469638" target="_blank">Subversion</a>(10)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/319645" target="_blank">SWT/JFace/RCP</a>(25)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/747162" target="_blank">SyntaxHighlighter</a>(1)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/299913" target="_blank">System Analyst exam</a>(13)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/767001" target="_blank">Tencent</a>(1)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/799655" target="_blank">TestNG</a>(2)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/357256" target="_blank">TeX/LaTeX</a>(9)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/260439" target="_blank">Text Categorization</a>(9)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/742035" target="_blank">Ubuntu</a>(3)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/318451" target="_blank">UML Modeling</a>(12)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/832030" target="_blank">VI/VIM</a>(1)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/794848" target="_blank">Web</a>(4)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/798287" target="_blank">Web Browser</a>(2)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/475410" target="_blank">Web Service</a>(5)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/324813" target="_blank">Web UI Design</a>(23)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/803421" target="_blank">Wicket</a>(5)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/267361" target="_blank">Windows</a>(54)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/753760" target="_blank">Wine</a>(1)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/475341" target="_blank">Workflow &amp; BPM</a>(17)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/368591" target="_blank">にほんごのべんきょう</a>(4)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/848178" target="_blank">li</a>(0)</li>
<li><a href="http://blog.csdn.net/dl88250/article/category/911428" target="_blank">B3log Announcement</a>(3)</li>
<li><p><a href="http://blog.csdn.net/dl88250/article/category/1290033" target="_blank">B3log Solo</a>(1)
文章存档</p>
</li>
<li><p><a href="http://blog.csdn.net/dl88250/article/month/2013/05" target="_blank">2013年05月</a>(1)</p>
</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2012/11" target="_blank">2012年11月</a>(1)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2012/08" target="_blank">2012年08月</a>(1)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2012/02" target="_blank">2012年02月</a>(1)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2011/10" target="_blank">2011年10月</a>(1)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2011/08" target="_blank">2011年08月</a>(1)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2011/07" target="_blank">2011年07月</a>(1)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2011/06" target="_blank">2011年06月</a>(7)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2011/05" target="_blank">2011年05月</a>(6)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2011/04" target="_blank">2011年04月</a>(9)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2011/03" target="_blank">2011年03月</a>(17)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2011/02" target="_blank">2011年02月</a>(27)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2011/01" target="_blank">2011年01月</a>(13)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2010/12" target="_blank">2010年12月</a>(16)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2010/11" target="_blank">2010年11月</a>(29)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2010/10" target="_blank">2010年10月</a>(16)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2010/09" target="_blank">2010年09月</a>(17)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2010/08" target="_blank">2010年08月</a>(10)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2010/07" target="_blank">2010年07月</a>(10)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2010/06" target="_blank">2010年06月</a>(13)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2010/05" target="_blank">2010年05月</a>(12)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2010/04" target="_blank">2010年04月</a>(25)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2010/03" target="_blank">2010年03月</a>(13)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2010/02" target="_blank">2010年02月</a>(10)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2010/01" target="_blank">2010年01月</a>(13)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2009/12" target="_blank">2009年12月</a>(17)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2009/11" target="_blank">2009年11月</a>(9)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2009/10" target="_blank">2009年10月</a>(13)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2009/09" target="_blank">2009年09月</a>(9)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2009/08" target="_blank">2009年08月</a>(13)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2009/07" target="_blank">2009年07月</a>(13)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2009/06" target="_blank">2009年06月</a>(27)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2009/05" target="_blank">2009年05月</a>(13)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2009/04" target="_blank">2009年04月</a>(18)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2009/03" target="_blank">2009年03月</a>(17)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2009/02" target="_blank">2009年02月</a>(15)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2009/01" target="_blank">2009年01月</a>(23)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2008/12" target="_blank">2008年12月</a>(19)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2008/11" target="_blank">2008年11月</a>(34)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2008/10" target="_blank">2008年10月</a>(27)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2008/09" target="_blank">2008年09月</a>(27)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2008/08" target="_blank">2008年08月</a>(19)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2008/07" target="_blank">2008年07月</a>(18)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2008/06" target="_blank">2008年06月</a>(10)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2008/05" target="_blank">2008年05月</a>(31)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2008/04" target="_blank">2008年04月</a>(23)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2008/03" target="_blank">2008年03月</a>(55)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2008/02" target="_blank">2008年02月</a>(78)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2008/01" target="_blank">2008年01月</a>(76)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2007/12" target="_blank">2007年12月</a>(13)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2007/11" target="_blank">2007年11月</a>(28)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2007/10" target="_blank">2007年10月</a>(33)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2007/09" target="_blank">2007年09月</a>(21)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2007/08" target="_blank">2007年08月</a>(68)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2007/07" target="_blank">2007年07月</a>(113)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2007/06" target="_blank">2007年06月</a>(65)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2007/05" target="_blank">2007年05月</a>(83)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2007/04" target="_blank">2007年04月</a>(43)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2007/03" target="_blank">2007年03月</a>(22)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2007/02" target="_blank">2007年02月</a>(74)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2007/01" target="_blank">2007年01月</a>(78)</li>
<li><a href="http://blog.csdn.net/dl88250/article/month/2006/12" target="_blank">2006年12月</a>(48)</li>
</ul>
<p>展开</p>
<p>阅读排行</p>
<ul>
<li><a href="http://blog.csdn.net/dl88250/article/details/3852624" title="当代 IT 大牛排行榜" target="_blank">当代 IT 大牛排行榜</a>(438472)</li>
<li><a href="http://blog.csdn.net/dl88250/article/details/3280698" title="NetBeans 时事通讯（刊号 # 34 - Nov 11, 2008）" target="_blank">NetBeans 时事通讯（刊号 /# 34 - Nov 11, 2008）</a>(294762)</li>
<li><a href="http://blog.csdn.net/dl88250/article/details/3604772" title="Seam 2.1.1.GA 发布！" target="_blank">Seam 2.1.1.GA 发布！</a>(240265)</li>
<li><a href="http://blog.csdn.net/dl88250/article/details/3765750" title="JBoss Seam 框架下的单元测试" target="_blank">JBoss Seam 框架下的单元测试</a>(220053)</li>
<li><a href="http://blog.csdn.net/dl88250/article/details/1636841" title="20个漂亮xp桌面主题" target="_blank">20个漂亮xp桌面主题</a>(72125)</li>
<li><a href="http://blog.csdn.net/dl88250/article/details/5191092" title="了解 NoSQL 的必读资料" target="_blank">了解 NoSQL 的必读资料</a>(65897)</li>
<li><a href="http://blog.csdn.net/dl88250/article/details/1826713" title="初学UML之-------用例图" target="_blank">初学UML之-------用例图</a>(64870)</li>
<li><a href="http://blog.csdn.net/dl88250/article/details/4027668" title="数学符号大全" target="_blank">数学符号大全</a>(38964)</li>
<li><a href="http://blog.csdn.net/dl88250/article/details/3753193" title="Web Beans (JSR-299): Q&amp;A with Specification Lead Gavin King " target="_blank">Web Beans (JSR-299): Q&amp;A with Specification Lead Gavin King</a>(30472)</li>
<li><p><a href="http://blog.csdn.net/dl88250/article/details/3862541" title="《星际争霸》成为大学课程之一" target="_blank">《星际争霸》成为大学课程之一</a>(26977)
评论排行</p>
</li>
<li><p><a href="http://blog.csdn.net/dl88250/article/details/5931333" title="十二个理由让你不得不期待 Ubuntu10.10" target="_blank">十二个理由让你不得不期待 Ubuntu10.10</a>(106)</p>
</li>
<li><a href="http://blog.csdn.net/dl88250/article/details/5310751" title="2009 年个人回忆与总结" target="_blank">2009 年个人回忆与总结</a>(91)</li>
<li><a href="http://blog.csdn.net/dl88250/article/details/1587054" title="Linux下的千千静听——LivaPlayer" target="_blank">Linux下的千千静听——LivaPlayer</a>(69)</li>
<li><a href="http://blog.csdn.net/dl88250/article/details/1636841" title="20个漂亮xp桌面主题" target="_blank">20个漂亮xp桌面主题</a>(49)</li>
<li><a href="http://blog.csdn.net/dl88250/article/details/1826713" title="初学UML之-------用例图" target="_blank">初学UML之-------用例图</a>(48)</li>
<li><a href="http://blog.csdn.net/dl88250/article/details/4303524" title="书评：简洁代码──敏捷软件工艺指南 " target="_blank">书评：简洁代码──敏捷软件工艺指南</a>(44)</li>
<li><a href="http://blog.csdn.net/dl88250/article/details/5100894" title="程序员的幽默" target="_blank">程序员的幽默</a>(43)</li>
<li><a href="http://blog.csdn.net/dl88250/article/details/6386620" title="准备入职支付宝" target="_blank">准备入职支付宝</a>(39)</li>
<li><a href="http://blog.csdn.net/dl88250/article/details/5118301" title="HTML 5 WebSocket 示例" target="_blank">HTML 5 WebSocket 示例</a>(38)</li>
<li><a href="http://blog.csdn.net/dl88250/article/details/5518605" title="NetBeans IDE 6.9 Beta 发布" target="_blank">NetBeans IDE 6.9 Beta 发布</a>(38)</li>
</ul>
<p>推荐文章
最新评论</p>
<ul>
<li><a href="http://blog.csdn.net/DL88250/article/details/6174582#comments" target="_blank">GAE Java 应用性能优化</a></li>
</ul>
<p><a href="http://blog.csdn.net/wilder2000" target="_blank">wilder2000</a>: mark</p>
<ul>
<li><a href="http://blog.csdn.net/DL88250/article/details/2075637#comments" target="_blank">基于 JSF＋Spring + JPA 构建敏捷的Web应用[88250原创]</a></li>
</ul>
<p><a href="http://blog.csdn.net/az690236414" target="_blank">喝冰开水</a>: 把源码发给我还吗？690236414@qq.com谢谢了，最好是我能加你好友，好相互交流</p>
<ul>
<li><a href="http://blog.csdn.net/DL88250/article/details/4027668#comments" target="_blank">数学符号大全</a></li>
</ul>
<p><a href="http://blog.csdn.net/zinss26914" target="_blank">低调小一</a>: 多谢了，转载了，楼主辛苦</p>
<ul>
<li><a href="http://blog.csdn.net/DL88250/article/details/1843813#comments" target="_blank">java.util.logging日志功能使用快速入门</a></li>
</ul>
<p><a href="http://blog.csdn.net/ccssddnnbbookkee" target="_blank">ccssddnnbbookkee</a>: 很详细，谢谢</p>
<ul>
<li><a href="http://blog.csdn.net/DL88250/article/details/2799522#comments" target="_blank">使用 CAS 在 Tomcat 中实现单点登录</a></li>
</ul>
<p><a href="http://blog.csdn.net/hooqee" target="_blank">hooqee</a>: 不错！</p>
<ul>
<li><a href="http://blog.csdn.net/DL88250/article/details/6227988#comments" target="_blank">哪本书是对程序员最有影响、每个程序员都该阅读的书？</a></li>
</ul>
<p><a href="http://blog.csdn.net/yxm0603" target="_blank">起飞---为梦想而飞</a>: 我一本都没看过，需要好好看看</p>
<ul>
<li><a href="http://blog.csdn.net/DL88250/article/details/2794943#comments" target="_blank">Single SignOn - Integrating Liferay With CAS Server</a></li>
</ul>
<p><a href="http://blog.csdn.net/logoc" target="_blank">logoc</a>: 咱能，一天到晚不转来转去吗。还他妈的专家</p>
<ul>
<li><a href="http://blog.csdn.net/DL88250/article/details/6612090#comments" target="_blank">暂时告别 CSDN 博客，移居 GAE（<a href="http://88250.b3log.org）">http://88250.b3log.org）</a></a></li>
</ul>
<p><a href="http://blog.csdn.net/vbubble" target="_blank">bubble</a>: 顶b3blog 对搜索引擎优化方面做的如何</p>
<ul>
<li><a href="http://blog.csdn.net/DL88250/article/details/6208677#comments" target="_blank">加入中国 HTML5 研究小组</a></li>
</ul>
<p><a href="http://blog.csdn.net/vicns" target="_blank">簡約_Billy</a>: 想您致敬，</p>
<ul>
<li><a href="http://blog.csdn.net/DL88250/article/details/8227475#comments" target="_blank">Java 开源博客——B3log Solo 0.5.5 正式版发布了！</a></li>
</ul>
<p><a href="http://blog.csdn.net/vicns" target="_blank">簡約_Billy</a>:</p>
<p>Code snips</p>
<ul>
<li><a href="http://www.java2s.com/" target="_blank">Java Code examples</a></li>
<li><a href="http://www.blabla.cn/index.html" target="_blank">HTML代码示例</a></li>
<li><p><a href="http://www.java2s.com/Code/Cpp/CatalogCpp.htm" target="_blank">C 代码示例</a>
E-books</p>
</li>
<li><p><a href="http://www.chinaitlab.com/" target="_blank">中国 IT 实验室</a></p>
</li>
<li><a href="http://shop.apabi.com/index/index.aspx" target="_blank">中文电子书网</a></li>
<li><a href="http://book.httpcn.com/" target="_blank">网络中国 - E 书</a></li>
<li><a href="http://download.csdn.net/" target="_blank">CSDN 下载频道</a></li>
<li><a href="http://www.51leifeng.net/index.php" target="_blank">偶要雷锋 - 分享社区</a></li>
</ul>
<p>Linux/Ubuntu</p>
<ul>
<li><a href="http://www.gnome-look.org/" target="_blank">Gnome-Look</a></li>
<li><a href="http://forum.ubuntu.org.cn/" target="_blank">Ubuntu 中文官方论坛</a></li>
<li><a href="http://search.deviantart.com/" target="_blank">deviantART Search</a></li>
<li><a href="http://www.getdeb.net/" target="_blank">GetDeb</a></li>
<li><a href="http://www.kde-look.org/" target="_blank">KDE-Look</a></li>
<li><a href="http://linuxtoy.org/" target="_blank">LinuxToy</a></li>
<li><a href="http://www.compiz-themes.org/" target="_blank">Compiz Themes</a></li>
<li><a href="http://www.chinaunix.net/" target="_blank">ChinaUnix</a></li>
<li><p><a href="http://www.compiz-fusion.org/" target="_blank">Compiz-Fusion</a>
My friends</p>
</li>
<li><p><a href="http://yhuag.blogbus.com/" target="_blank">光光的Blog~</a></p>
</li>
<li><a href="http://hi.baidu.com/zy_tough" target="_blank">ZY Tough</a></li>
<li><a href="http://dorainm.cublog.cn/" target="_blank">师傅 dorainm</a></li>
<li><a href="http://blog.csdn.net/elevenxl" target="_blank">Eleven 的专栏</a></li>
<li><a href="http://blog.csdn.net/meteorlWJ" target="_blank">Meteor 的专栏</a></li>
<li><a href="http://blog.csdn.net/Vanessa219" target="_blank">Vanessa 的小窝</a></li>
<li><a href="http://blog.csdn.net/herian/" target="_blank">秋歌的专栏</a></li>
<li><a href="http://user.qzone.qq.com/769626482/" target="_blank">金秋风采</a></li>
<li><a href="http://www.eleven-china.com/" target="_blank">eleven-china</a></li>
<li><a href="http://blog.csdn.net/debug_today" target="_blank">野地的枯草</a></li>
<li><a href="http://hi.baidu.com/%C0%C7%C6%C6%C0%CB" target="_blank">狼猫窝</a></li>
<li><a href="http://www.co-soft.info/" target="_blank">云南科软</a></li>
<li><a href="http://88250.b3log.org/" target="_blank">88250 @ Solo</a> (<a href="http://88250.b3log.org/blog-articles-feed.do" target="_blank">RSS</a>)</li>
</ul>
<p>My projects</p>
<ul>
<li><a href="https://beyondtrack.dev.java.net/" target="_blank">BeyondTrack @ Java.net</a></li>
<li><a href="http://sourceforge.net/projects/livaplayer/" target="_blank">LivaPlayer</a></li>
<li><a href="http://kenai.com/projects/drop/" target="_blank">Drop</a></li>
<li><a href="http://b3log-solo.googlecode.com/" target="_blank">B3log Solo</a></li>
<li><p><a href="http://latke.googlecode.com/" target="_blank">B3log Latke</a>
Super stars :-)</p>
</li>
<li><p><a href="http://www-cs-staff.stanford.edu/~knuth/index.html" target="_blank">Don Knuth&#39;s Home Page</a></p>
</li>
<li><a href="http://www.martinfowler.com/" target="_blank">Martin Fowler</a></li>
<li><a href="http://www.turing.org.uk/turing/" target="_blank">Alan Turing</a></li>
<li><a href="http://blog.objectmentor.com/articles/category/uncle-bobs-blatherings" target="_blank">Uncle Bob (Robert C. Martin)</a></li>
<li><a href="http://www.research.att.com/~bs/" target="_blank">Bjarne Stroustrup&#39;s Homepage</a></li>
<li><a href="http://www.stallman.org/" target="_blank">Richard Stallman&#39;s Home Page</a></li>
</ul>
<p>Technologies</p>
<ul>
<li><a href="http://www-128.ibm.com/developerworks/cn/opensource/" target="_blank">IBM 软件技术</a></li>
<li><a href="http://www.csdn.net/" target="_blank">CSDN</a></li>
<li><a href="http://www.uml.org/" target="_blank">UML 官方</a></li>
<li><a href="http://www.eclipse.org/" target="_blank">Eclipse.org</a></li>
<li><a href="http://www.apache.org/" target="_blank">Apache Software</a></li>
<li><a href="http://dinosaur.compilertools.net/" target="_blank">LEX &amp; YACC Page</a></li>
<li><a href="http://www.open-open.com/" target="_blank">Java 开源大全</a></li>
<li><a href="http://labs.jboss.com/" target="_blank">JBoss.org</a></li>
<li><a href="http://www.php.net/" target="_blank">PHP 官方</a></li>
<li><a href="http://www.springframework.org/" target="_blank">Springframework.org</a></li>
<li><a href="http://www.netbeans.org/index_zh_CN.html" target="_blank">NetBeans 中文社区</a></li>
<li><a href="http://www.sourceforge.net/" target="_blank">SourceForge.net</a></li>
<li><a href="http://www.javaworld.com.tw/" target="_blank">JavaWorld@TW</a></li>
<li><a href="http://www.hibernate.org/" target="_blank">hibernate.org</a></li>
<li><a href="http://www.extremeprogramming.org/" target="_blank">Extreme Programming</a></li>
<li><a href="http://www.rubyonrails.org/" target="_blank">Ruby on Rails</a></li>
<li><a href="http://www.ruby-lang.org.cn/forums/" target="_blank">Ruby 中文社区论坛</a></li>
<li><a href="http://openjfx.java.sun.com/current-build/doc/" target="_blank">JavaFX Script Reference</a></li>
<li><a href="http://www.javafx.com/" target="_blank">JavaFX Home</a></li>
<li><a href="http://www.opensource.org/" target="_blank">Open Source Initiative</a></li>
<li><a href="https://facelets.dev.java.net/nonav/docs/dev/docbook.html" target="_blank">Facelets DevDoc</a></li>
<li><a href="http://www.testng.org/" target="_blank">Testng.org</a></li>
<li><a href="http://java-source.net/" target="_blank">java-source</a></li>
<li><a href="http://www.javaeye.com/" target="_blank">JavaEye</a></li>
<li><a href="http://wiki.netbeans.org/NetBeansDreamTeam" target="_blank">NetBeans Dream Team</a></li>
<li><a href="http://www.infoq.com/" target="_blank">InfoQ</a></li>
<li><a href="https://open-esb.dev.java.net/" target="_blank">OpenEBS</a></li>
<li><a href="http://www.seamframework.org/" target="_blank">JBoss Seam</a></li>
<li><a href="http://www.jdon.com/" target="_blank">J 道</a></li>
<li><a href="http://www.w3.org/TR/html4/" target="_blank">HTML 4.01 Spec</a></li>
<li><a href="http://xiexiejiao.cn/" target="_blank">歇歇脚</a></li>
<li><a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html" target="_blank">HTTP 1.1 Status Code</a></li>
<li><a href="http://www.oschina.net/" target="_blank">开源中国社区</a></li>
<li><a href="http://www.mhtml5.com/" target="_blank">HTML5 研究小组</a></li>
</ul>
<p><a href="http://www.csdn.net/company/about.html" target="_blank">公司简介</a>|<a href="http://www.csdn.net/company/recruit.html" target="_blank">招贤纳士</a>|<a href="http://www.csdn.net/company/marketing.html" target="_blank">广告服务</a>|<a href="http://www.csdn.net/company/account.html" target="_blank">银行汇款帐号</a>|<a href="http://www.csdn.net/company/contact.html" target="_blank">联系方式</a>|<a href="http://www.csdn.net/company/statement.html" target="_blank">版权声明</a>|<a href="http://www.csdn.net/company/layer.html" target="_blank">法律顾问</a>|<a href="mailto:webmaster@csdn.net">问题报告</a><a href="http://wpa.qq.com/msgrd?v=3&amp;uin=2355263776&amp;site=qq&amp;menu=yes" target="_blank">QQ客服</a> <a href="http://e.weibo.com/csdnsupport/profile" target="_blank">微博客服</a> <a href="http://bbs.csdn.net/forums/Service" target="_blank">论坛反馈</a> <a href="mailto:webmaster@csdn.net">联系邮箱：webmaster@csdn.net</a> 服务热线：400-600-2320京 ICP 证 070598 号北京创新乐知信息技术有限公司 版权所有世纪乐知(北京)网络技术有限公司 提供技术支持江苏乐知网络技术有限公司 提供商务支持Copyright © 1999-2012, CSDN.NET, All Rights Reserved <a href="http://www.hd315.gov.cn/beian/view.asp?bianhao=010202001032100010" target="_blank"><img src="" alt="GongshangLogo"></a>
<img src="http://counter.csdn.net/pv.aspx?id=24" alt=""></p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/缓存/">缓存</a></li></span><span class="breadcrumb"><li><a href="/categories/缓存/">缓存</a></li><li><a href="/categories/缓存/memcached/">memcached</a></li></span></span> | <span class="tags">Tagged <a href="/tags/memcached/" class="label label-primary">memcached</a><a href="/tags/缓存/" class="label label-success">缓存</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:39"datetime="2014-03-07 09:54:39"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-缓存-memcached--应用memcached提升站点性能——减少读自数据库和数据源-简约设计の艺术-博客频道/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-缓存-memcached--应用memcached提升站点性能——减少读自数据库和数据源-简约设计の艺术-博客频道" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-缓存--Web开发人员需知的Web缓存知识/">Web开发人员需知的Web缓存知识</a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:39.000Z"> <a href="/2014/02/02/2014-02-02-缓存--Web开发人员需知的Web缓存知识/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="web-web-">Web开发人员需知的Web缓存知识</h1>
<p>原文出处： <a href="http://www.mnot.net/cache_docs/" target="_blank">mnot</a>   译文出处： <a href="http://www.zhangxinxu.com/wordpress/2013/05/caching-tutorial-for-web-authors-and-webmasters/" target="_blank">张鑫旭</a></p>
<p>最近的译文距今已有4年之久，原文有一定的更新。今天踩着前辈们的肩膀，再次把这篇文章翻译整理下。一来让自己对web缓存的理解更深刻些，二来让大家注意力稍稍转移下，不要整天HTML5, 面试题啊叨啊叨的~~</p>
<h3 id="-web-">什么是Web缓存，为什么要使用它？</h3>
<p><em>Web缓存</em>游走于服务器和客户端之间。这个服务器可能是源服务器（资源所驻留的服务器Add），数量可能是1个或多个；这个客户端也可能是1个或多个。<em>Web缓存</em>就在服务器-客户端之间搞监控，监控请求，并且把请求输出的内容（例如html页面、 图片和文件）（统称为<em>副本</em>）另存一份；然后，如果下一个请求是相同的URL，则直接请求保存的副本，而不是再次麻烦源服务器。</p>
<p>使用缓存的2个主要原因：</p>
<ul>
<li><strong>降低延迟：</strong>缓存离客户端更近，因此，从缓存请求内容比从源服务器所用时间更少，呈现速度更快，网站就显得更灵敏。</li>
<li><strong>降低网络传输：</strong>副本被重复使用，大大降低了用户的带宽使用，其实也是一种变相的省钱（如果流量要付费的话），同时保证了带宽请求在一个低水平上，更容易维护了。</li>
</ul>
<h3 id="web-">Web缓存的类型</h3>
<p><strong>1. <a href="http://blog.jobbole.com/12749/" title="浏览器" target="_blank">浏览器</a>缓存</strong>
在任何<a href="http://blog.jobbole.com/12749/" title="现代浏览器" target="_blank">现代浏览器</a>上(如IE, FireFox, Chrome)折腾清除隐私数据（//zxx: 原文说的是首选项，显然out了，这里有改动）的对话框，你很可能会注意到“缓存”这个设置项。</p>
<p><a href="http://cdn2.jobbole.com/2013/06/cache-for-web-master-01.png" title="web制作、开发人员需知的Web缓存知识" target="_blank"><img src="&quot;web制作、开发人员需知的Web缓存知识&quot;" alt="web制作、开发人员需知的Web缓存知识"></a></p>
<p>浏览器会在你的硬盘上专门开辟一个空间专门为你存储资源副本。浏览器缓存的工作规则很简单：检查以确保副本是最新的，通常只要一次会话（就是当前浏览器调用的这次N）。</p>
<p>浏览器缓存在用户触发“后退”操作或点击一个之前看过的链接的时候很管用。同样，如果你在网站上访问同一张图片，该图片可以从浏览器缓存中调出并几乎立即显现出来。</p>
<p><strong>2. 代理服务器缓存</strong>
Web代理服务器使用同样的缓存原理，只是规模更大。代理以同样的方式服务千万用户，大公司和ISP(Internet Server Provider, Internet服务提供商Add)经常在他们的防火墙或者单独的设备（也被称为<em>中介(intermediaries)</em>）上架设代理缓存。</p>
<p>由于代理服务器缓存并非客户端或者源服务器的一部分，而是处于网络中，请求需要以某种方式路由到它们。一种方法是手动设置，告诉浏览器的你常用的代理服务器(//zxx: 翻墙的时候常用的)，另外就是使用拦截。<em>拦截代理(Interception proxies)</em>把Web请求根据自己的底层网络重定向，因此，客户端无需配置，甚至都不需要知道它们。//zxx: 维基百科上提供的几种检测拦截代理服务器存在的方法add，您若有兴趣，可以<a href="http://en.wikipedia.org/wiki/Proxy_server#Detection" target="_blank">点击这里</a>查看。</p>
<p>代理缓存属于一种<em>共享缓存</em>；往往有大量的用户使用，因此，其在降低延时和网络流量上很有用，毕竟每个副本都被大量重用。//zxx: 这里我有疑问：就算是放在代理服务器上，每次获取还是要通过网络的啊，如何降低了网络流量呢？希望谁可以帮忙解惑下。</p>
<p><strong>3. 网关缓存</strong>
也被称为“反向代理缓存”或“替代缓存”。网关缓存同样是起中介作用的，不过不是（素不相识、不曾谋面的Add）网络管理员部署的，而多半是网站管理员（公司专门的运维工程师、或UED或程序组某人Add）他们自己部署，这样更容易扩展与维护。</p>
<p>可以有多种方法把请求路由到网关缓存，但通常使用某种形式的负载均衡器①，使它们中的一个或多个看起来像是源服务器。<em>内容分发网络</em>②(CDNs)为整个网络（或部分）分配网关缓存，然后把这些缓存卖给需要的网站。<a href="http://www.speedera.com/" target="_blank">Speedera</a>③和<a href="http://www.akamai.com/" target="_blank">Akamai</a>④就是代表性的网络内容发布商。
①负载均衡器：是一种采用各种分配算法把网络请求分散到一个服务器集群中的可用服务器上去，通过管理进入的Web数据流量和增加有效的网络带宽，从而使网络访问者获得尽可能最佳的联网体验的硬件设备。</p>
<p>②内容分发网络：即CDN, 基本思路是尽可能避开互联网上有可能影响数据传输速度和稳定性的瓶颈和环节，使内容传输的更快、更稳定。通过在网络各处放置节点服务器所构成的在现有的互联网基础之上的一层智能虚拟网络，CDN系统能够实时地根据网络流量和各节点的连接、负载状况以及到用户的距离和响应时间等综合信息将用户的请求重新导向离用户最近的服务节点上。其目的是使用户可就近取得所需内容，解决 Internet网络拥挤的状况，提高用户访问网站的响应速度。</p>
<p>③Speedera：是一家全球性的内容服务提供商，它与北美、欧洲以及亚太地区的1000多家大型运营商都有联系，并为那些不想在自己服务器上寄存内容的公司提供软件下载、媒体及其它服务管理等业务。05年的时候被下面要介绍的Akamai以$130m的价格给收购了。</p>
<p>④Akamai：美国Akamai是国际上最大的CDN服务商，它巨大的网络分发能力在峰值时可达到15Tbps。Akamai公司是为数不多的旨在消除Internet瓶颈和提高下载速度的几家新公司之一，是一个致力于网络交通提速的”内容发布”公司，是波士顿高技术区最卓越的新兴企业之一。Akamai公司向全球企业提供发送互联网内容，汇流媒体和应用程序的服务（目前，该公司为15个国家的企业管理着8000多台服务器）。1998年，丹尼尔。L和麻省理工学院的一些研究人员一起创立了这家公司，他在麻省理工学院的硕士论文构成了Akamai公司最初的”自由流”（Freeflow）技术的核心。</p>
<p>本教程重点在浏览器和代理缓存，尽管有些信息对网关缓存感兴趣的人也适用。</p>
<h3 id="web-">Web缓存无害吗？为什么要鼓励缓存？</h3>
<p>Web缓存是互联网中最容易被误解的技术之一。网站管理员特别希望知道网站的一举一动，比方说多少人访问啦，访问时间啊什么的，而缓存会“隐藏”他们的用户，他们就无从得知到底谁访问了这个站点。</p>
<p>捡了芝麻丢西瓜，自认为放弃缓存可以精确跟踪用户，实际上，互联网中有太多的变数，想精确得到一张用户查看网站的图片？没那么简单的，亲！如果你很重视这个问题，恭喜你，本文正好提供了解决之道，即保证缓存友好，同时又能获得统计。</p>
<p>另外需要注意的是，缓存的内容都是旧的过时的。因此，如何准确更新就成了一个问题。不过不要担心，本文会向你展示如何配置服务器，让缓存就像你的女仆——随便调教。</p>
<p><a href="http://cdn2.jobbole.com/2013/06/cache-for-web-master-02.jpg" title="web制作、开发人员需知的Web缓存知识" target="_blank"><img src="&quot;web制作、开发人员需知的Web缓存知识&quot;" alt="web制作、开发人员需知的Web缓存知识"></a></p>
<p>CDN算是个挺有意思的技术，不同于代理缓存，CDN的网关缓存和被缓存的Web站点的利益是一致的，因此，上面提到的问题对于CDN而言是没有的。不过，即使你使用了CDN，你仍要顾虑下游的代理和浏览器缓存。</p>
<p>以上为缓存可能的“糟粕”，那他好的地方呢？缓存可以让你的Web站点加载更快，让你的服务器和互联网链接间负担更小。这种差异会导致一些类似质的变化，一个网站要几秒钟才能加载出来，而另外一个充分发挥缓存的优势，几乎瞬间显示。用户自然更喜欢那个加载迅速的站点，访问也更多。</p>
<p>再说个现实示例，许多大型互联网公司花费了数百万美元，在世界各地设立服务器集群来复制他们的内容，以使其尽可能快被他们的用户访问。缓存为你做同样的事情，而且他们更接近最终用户。最重要的是，你不要花银子。<img src="" alt=""></p>
<p>实际上呢，无论你喜欢与否，代理和浏览器缓存都会被使用。如果你站点的缓存配置不正确，你只能听天由命了。</p>
<h3 id="web-">Web缓存如何工作</h3>
<p>所以的缓存都有一套自己的规则，可以用来决定何时跟缓存暧昧往来。其中部分规则设定在协议中(HTTP 1.0 以及 1.1)，部分由缓存管理员⑤设置。
⑤缓存管理员：如果指的是浏览器缓存，则有可能就是我们服务器专家同事，在服务器上配置一些缓存规则；如果是代理缓存，则指的就是处理代理服务器这块的管理人员。</p>
<p>一般而言有如下常用规则N：</p>
<ol>
<li>响应头明确说明，偶不想被缓存，则不会被缓存；</li>
<li>如果请求信息是需要认证或者安全加密的(如, HTTPS)，相应内容也不会被缓存；</li>
<li>缓存如果有以下表现，则认为是<em>fresh</em>新鲜的（无需检查源服务器，直接发送给客户端）：</li>
</ol>
<ul>
<li>含有完整的过期时间和寿命控制头信息，并且内容仍在保鲜期内，或者</li>
<li>缓存最近已展现，并且在不久前修改。</li>
</ul>
<p>则内容缓存直取，绕过源服务器。</p>
<ul>
<li>若内容陈旧，则会要求源服务器做验证<em> validate </em>，或者告诉缓存其拷贝副本是否是OK的。</li>
<li>特定情况下——例如，断网了，之前有过的响应缓存直取而不检查源服务器。</li>
</ul>
<p>响应如果没有类似<em>ETag</em>或<em>Last-Modified</em>头这样的校验器，也没有明确的更新信息，通常（并不绝对）认为是不可缓存的。</p>
<p>总而言之，<strong>*新鲜度</strong>freshness<em>和**</em>校验<em>*validation</em>是确定缓存内容是否可用的最重要途径。如果要展示的足够新，直接缓存取；如果检测发现展示内容并未变化，则不会再来一次完整的传输。</p>
<h3 id="-">如何控制缓存和不缓存</h3>
<p>有很多工具可以帮助设计师和网站管理员调整服务器缓存网站的方式，这也许需要你亲自动手对服务器的配置进行一些调整，但绝对值得。了解如何使用这些工具请参考本文后面的章节。</p>
<p><strong>HTML Meta标签 vs. HTTP头信息</strong>
HTML<a href="http://www.amazon.cn/gp/product/B003BY6PLK/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&amp;tag=vastwork-23&amp;linkCode=as2&amp;camp=536&amp;creative=3200&amp;creativeASIN=B003BY6PLK" title="重构:改善既有代码的设计" target="_blank">重构</a>人员可以在文档的</p>
<p><head>
中添加标签进行描述。这些<em>meta</em>标签通常用来标记不可缓存或过期时间。</p>
<p>Meta标签使用简单，但效果一般。因为只被少数几个浏览器宠幸，而代理缓存基本上就不访问HTML文档。尽管我们可以在页面上试图添加</p>
<p>no-cache
 meta标签让页面一直是最新的，但其实没必要。</p>
<p>如果你的网站托管在ISP或者主机托管商那里，并且他们没有赋予您任意设置HTTP头信息的能力(比如Expires和Cache-Control)，你要投诉争取，因为在你的工作中这些是必须的。</p>
<p>另外一方面： <em>HTTP头</em>信息可以让你对浏览器和代理服务器如何处理你的副本进行更多的控制。他们在HTML代码中是看不见的，一般由Web服务器自动生成。但是，根据你使用的服务器，你可以在某种程度上进行控制。在下文中：你将看到一些有趣的HTTP头信息，以及如何在你的站点上应用部署这些特性。</p>
<p>HTTP头信息发送在HTML代码之前，只能被浏览器和一些中间缓存能看到，一个典型的HTTP 1.1协议返回的头信息看上去像这样：
HTTP/1.1 200 OK</p>
<p>Date: Fri, 30 Oct 1998 13:19:41 GMT
Server: Apache/1.3.3 (Unix)</p>
<p>Cache-Control: max-age=3600, must-revalidate
Expires: Fri, 30 Oct 1998 14:19:41 GMT</p>
<p>Last-Modified: Mon, 29 Jun 1998 02:28:12 GMT
ETag: &quot;3e86-410-3596fbbc&quot;</p>
<p>Content-Length: 1040
Content-Type: text/html</p>
<p>头信息空一行后是HTML代码的输出，关于如何设置HTTP头信息请参考对应章节。</p>
<p><strong>Pragma HTTP头信息（以及为什么不起作用）</strong>
很多人认为在HTTP头信息中设置了</p>
<p>Pragma: no-cache
后会让内容无法被缓存。但事实并非如此：HTTP的规范中，响应型头信息没有任何关于Pragma属性的说明，只说明了请求头信息（浏览器发送给服务器的头信息）中的Pragma属性。虽然有少部分缓存会买账，但大部分无视，使用Pragma没作用。若要使用，试试下面的头信息。</p>
<p><strong>使用Expires HTTP头信息控制不过期</strong>
Expires HTTP头是控制缓存的基本手段，Expires的中文意思是“有效期”，显然，就是告诉浏览器缓存的有效期。如果过期，缓存会检查源服务器以确定文件是否改变了。Expires头几乎每个缓存都支持。</p>
<p>大部分的服务器允许你以多种方式设置Expires响应头。通常，他们允许设置一个绝对过期时间，然后对比最后一次访问的时候或者最后一次文档修改的时候决定客户端内容的获取方式。</p>
<p>对于静态图片（如导航或按钮的图片）而言，Expires头信息是相当有用的，因为图片不怎么修改，您可以给图片设置一个相当长的过期时间，这回让你的用户感觉网站变快了。Expires对于控制有改变规律的网页也很有用，例如：你有一个新闻聚合页面，每天早上6点钟准时更新，您可以设置缓存的过期时间也是这个点，于是缓存就可以很聪明地知道什么时候该去重载新的内容，什么时候睡大觉。</p>
<p>Expires头唯一的有效值是HTTP时间，其他值都会被认为是“前男友前女友”之类，不会去缓存的。注意：时间是格林威治时间（GMT），而不是本地时间。如下所示：
Expires: Fri, 30 Oct 1998 14:19:41 GMT</p>
<p>显然，如果你要使用Expires头，确保你的Web服务器时间的准备就非常重要了。使用网络时间协议⑥(Network Time Protocol – NTP)不失为一个号方法。如果你的身边有本地系统管理员，可以向他咨询，或者查看下面的百科Add 。</p>
<p>尽管Expires头很有用，但它有一定的局限性。首先，因为牵扯到时间，Web服务器端的时钟必须和缓存的同步，否则很可能实现不了预期的结果——缓存把前女友当初现女友，把现女友当作过去式——那就悲剧了。</p>
<p>另外一个问题是，你很容易忘记给某内容设置了一个特定时间，如果返回内容的时候没有更新这个过期时间，则每个请求都是上访到服务器，反而增加了负载和响应时间。
⑥网络时间协议(NTP): 以封包交换把两台电脑的时钟同步化的网络协议。NTP使用UDP端口123作为传输层。它是用作抵销可变延迟的影响。NTP是仍在使用中的最古老的网络协议之一（在1985年前开始）。NTP最初由德拉瓦州大学的Dave Mills设计，他与一群志愿者仍在维护NTP。</p>
<p><strong>Cache-Control（缓存控制）HTTP头信息</strong>
HTTP 1.1引入了新的头信息：</p>
<p>Cache-Control
响应头信息，让网站的发布者可以更全面的控制他们的内容，更好地处理Expires的些限制。</p>
<p>Cache-Control
有用的响应头包括：</p>
<ul>
<li><strong>max-age=[秒]</strong>：表示在这个时间范围内缓存是新鲜的无需更新。类似Expires时间，不过这个时间是相对的，而不是绝对的。也就是某次请求成功后多少秒内缓存是新鲜的。</li>
<li><strong>s-maxage=[秒]</strong>：类似</li>
</ul>
<p>max-age
, 除了仅应用于共享缓存（如代理）。</p>
<ul>
<li><strong>public</strong>：标记认证的响应才能够被缓存。一般而言，需要认证HTTP请求内容会自动私有化（不会被缓存Add）。</li>
<li><strong>private</strong>N：允许缓存专门为某一个用户存储响应，比方说在浏览器中；共享缓存一般不会，例如在代理中。</li>
<li><strong>no-cache</strong>：每次在释放缓存副本之前都强制发送请求给源服务器进行验证，这在确保认证有效性上很管用（和</li>
</ul>
<p>public
结合使用）或者保证内容必须是即时的，不得无视缓存的所有优点，如国内的微博、twitter等的刷新显示Add。</p>
<ul>
<li><strong>no-store</strong>：强制缓存在任何情况下都不要保留任何副本。</li>
<li><strong>must-revalidate</strong>：告诉缓存，我给你准备了一些关于新鲜度的信息，在表现的时候要严格遵循之。HTTP允许缓存在某些特定情况下返回过期数据，指定了这个属性，相对于告诉缓存，你丫必须严格遵循我的规则。</li>
<li><strong>proxy-revalidate</strong>：类似</li>
</ul>
<p>must-revalidate
，除了只能应用于代理缓存。</p>
<p>举个板栗：
Cache-Control: max-age=3600, must-revalidate</p>
<p>如果</p>
<p>Cache-Control
和</p>
<p>Expires
同时存在，</p>
<p>Cache-Control
说了算N。如果你打算使用</p>
<p>Cache-Control
头，你应该好好看看”<a href="http://www.ietf.org/rfc/rfc2616.txt" target="_blank">HTTP 1.1 规范</a>“, 详见参考文章以及拓展阅读。</p>
<p><strong>验证器和验证</strong>
在缓存如何工作这段译文中，我们说过，服务器以及缓存通过验证来判断内容是否改变，在不确定内容是否过期的时候，可以避免本地已经存在副本的时候下载整个内容。</p>
<p>验证器是很重要的，如果一个都没有，同时没有可用的新鲜度信息(</p>
<p>Expires
或</p>
<p>Cache-Control
)，缓存一点儿都不会存储内容。</p>
<p>最常见的验证是通过</p>
<p>Last-Modified
头信息通信确定文档最后的修改时间，如果缓存有内容存储，会包含</p>
<p>Last-Modified
信息的，辅助</p>
<p>If-Modified-Since
请求，我们可以询问服务器内容是否改变了。</p>
<p>HTTP 1.1引入了一个新的验证器，称为</p>
<p><em>Etag</em>
⑦. </p>
<p>Etag
是每次展现内容改变时候由服务器生成的唯一标识符，由于服务器控制</p>
<p>ETag
如何生成，当缓存发起</p>
<p>If-None-Match
请求的时候，如果</p>
<p>Etag
匹配，就可以确定展示内容其实是一样的。
⑦Etag: HTTP协议规格说明定义ETag为”被请求变量的实体值”。另一种说法是，ETag是一个可以与Web资源关联的记号（token）。典型的Web资源可以一个Web页，但也可能是JSON或XML文档。服务器单独负责判断记号是什么及其含义，并在HTTP响应头中将其传送到客户端，以下是服务器端返回的格式：ETag:”50b1c1d4f775c61:df3″客户端的查询更新格式是这样的：If-None-Match : W / “50b1c1d4f775c61:df3″如果ETag没改变，则返回状态304然后不返回，这也和Last-Modified一样。测试Etag主要在断点下载时比较有用。</p>
<p>几乎所有的缓存使用</p>
<p>Last-Modified
时间作为验证器，</p>
<p>Etag
验证也开始变得流行。</p>
<p>所有新一代的Web服务器都对静态内容（如：文件）自动生成</p>
<p>ETag
和</p>
<p>Last-Modified
头信息，而你不必做任何设置。但是，服务器对于动态内容（例如：CGI, ASP或数据库生成的网站）并不知道如何生成这些信息，参考一下编写支持缓存的脚本章节；</p>
<h3 id="-">创建支持缓存网站的小技巧</h3>
<p>除了使用新鲜度信息以及验证，还有其他一些技巧可以让你网站的缓存更加友好：</p>
<ul>
<li><strong>保持URL稳定</strong>：这是缓存的金科玉律，如果你为不同页面，不同用户或不同网站提供相同的内容，他们应该使用相同的URL. 这是简单却非常行之有效的方法。例如，你的HTML中的某个引用地址是</li>
</ul>
<p>&quot;/index.html&quot;
, 则要一直使用这个地址。</p>
<ul>
<li>不同地方的图片和其他元素<strong>使用同一库</strong>。</li>
<li><strong>对于不经常改变的图片/页面启用缓存</strong>，通过将</li>
</ul>
<p>Cache-Control: max-age
头信息的值设大一点。</p>
<ul>
<li><strong>对于定期更新的内容</strong>通过指定</li>
</ul>
<p>max-age
或过期时间实现缓存。</p>
<ul>
<li><strong>如果资源改变了（尤其下载文件），改变其名字</strong>。由于一般这种资源会有很长的过期时间，而服务器上一直是正确的版本；因此，链接这个下载资源的页面需要要比较短的过期时间（//zxx: 我司页面5分钟过期）。否则，会出现服务器的资源是新的，但页面被缓存了，其中的链接地址还是旧的，就会出现新旧版本冲突的可能Add。</li>
<li><strong>万不得已不要变动文件</strong>：否则你要设置一个新的</li>
</ul>
<p>Last-Modified
值。另外，当你更新站点的时候，只要上传改动的那些文件，而不要把整个站点都覆盖过去。</p>
<ul>
<li><strong>Cookie能不用就不用</strong>：Cookie难以被缓存，且大多情境下是没有必要的。如果你非得使用Cookie，建议用在动态页面上。</li>
<li><strong>减少SSL⑧的使用</strong>：因为共享缓存不能存储认证页面，只在必要的时候使用，并且在SSL页面上减少图片的使用。</li>
<li><strong>使用<a href="http://redbot.org/" target="_blank">REDbot</a>⑨检查你的网站</strong>：可以帮助你应用本文所介绍的一些概念。
⑧ SSL：全称Secure Socket Layer – 安全套接层，为Netscape所研发，用以保障在Internet上数据传输之安全，利用数据加密(Encryption)技术，可确保数据在网络上之传输过程中不会被截取及窃听。目前一般通用之规格为40 bit之安全标准，美国则已推出128 bit之更高安全标准，但限制出境。只要3.0版本以上之I.E.或Netscape浏览器即可支持SSL。</li>
</ul>
<p>⑨ REDbot：REDbot = RED + robot，是个机器人，检查HTTP资源，看他们如何会表现，指出常见的问题，并提出改进建议。虽然它属于HTTP一致性测试仪，但却可以找到不少HTTP相关问题。</p>
<h3 id="-">编写支持缓存的脚本</h3>
<p>默认情况下，大多数的脚本不会返回验证器（</p>
<p>Last-Modified
或</p>
<p>Etag
响应头）或新鲜度信息（</p>
<p>Expires
或</p>
<p>Cache-Control
）。尽管有些脚本的确是动态的（意味着每次请求都有不同的响应），还是有很多（如搜索引擎或数据库驱动的）网站可以从缓存中受益。</p>
<p>一般来讲，对于同一个请求（无论是几分钟还是几天之后），如果脚本产生的内容是可重复的，则可以缓存。脚本内容的改变仅仅依赖于URL，则可以缓存。如果是依赖于Cookie，认证信息或其他外部条件，很可能不缓存。</p>
<ul>
<li>最利于缓存的脚本就是在内容改变时导出成静态文件，服务器会想对待其他Web一样对待它的，生成以及使用验证器，于是你可以好好地喝杯咖啡了。记住，只有文件更改的时候才写入，这样Last-Modified时间就会被保存下来。</li>
<li>另外的脚本缓存之道就是使用</li>
</ul>
<p>age
相关的头部，相比</p>
<p>Expires
, </p>
<p>Cache-Control: max-age
更容易些，因为是相对时间，每次新请求完成后重新设置，时间到了，再重新请求，再设置新的相对过期时间。</p>
<ul>
<li>如果上面的做法你搞不定，你还可以试试通过脚本生成一个校验器, 然后回应</li>
</ul>
<p>If-Modified-Since
和/或</p>
<p>If-None-Match
请求。通过分析HTTP头信息，在适合的时候回应</p>
<p>304 Not Modified
. 不幸的是，这不是个打打酱油就能<a href="http://www.amazon.cn/gp/product/B007XPTAIS/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&amp;tag=vastwork-23&amp;linkCode=as2&amp;camp=536&amp;creative=3200&amp;creativeASIN=B007XPTAIS" title="搞定(套装共3册) " target="_blank">搞定</a>的任务。</p>
<p><strong>其他一些技巧</strong></p>
<ul>
<li><strong>不要使用POST</strong>：若是获取数据，尽量不使用POST模式，因为POST方式返回内容大部分不会被缓存，相对的，通过GET以路径和查询发送的信息被缓存存储下来供后续使用。</li>
<li><strong>URL地址中不要嵌入特定的用户信息</strong>，除非生成的内容对于用户而言是唯一的。</li>
<li><strong>不要指望同一用户的所有请求来自同一主机</strong>，因为缓存经常协同工作。//zxx: 嘛意思？</li>
<li><strong>生成Content-Length⑩头信息</strong>。实现不难，可让你的脚本以持久连接(<em>persistent connection</em>)形式响应。这允许客户端在一个TCP/IP请求上请求多个内容，而不是为每次请求单独建立连接，这样你的网站相应会快很多。</li>
</ul>
<p>详见实现注意事项。
⑩Content-Length：指明实体正文的长度，以字节方式存储的十进制数字来表示。在数据下行的过程中，Content-Length的方式要预先在服务器中缓存所有数据，然后所有数据再一股脑儿地发给客户端。</p>
<h3 id="-">常见问题解答</h3>
<p><strong>缓存可用的最重要事情是？</strong>
其中一个不错的策略是找出常用的、规模较大的内容（尤其图片），然后优先处理之。</p>
<p><strong>我该如何利用缓存让我的页面尽可能的快？</strong>
最应该缓存的内容设置一个较长的过期时间。验证有助于减少查看内容的时间，不过缓存仍会连接源服务器查看是不是过期了。如果缓存已经知道内容是新鲜的，直接返回。</p>
<p><strong>我知道缓存是个好东西，但是我想随时知道多少人访问了我的网页！</strong>
如果你必须知道每一次页面被访问的情况，可以选择页面上的一个小元素(或页面本身)，然后给这个元素一个适当的头信息使它是不可缓存。比如，你可以在每一个页面上引用一个<em>1像素×1像素</em>的不可缓存（如scr地址后面加个随机数Add）的透明图片。Referer头信息将会包含调用它的页面信息。</p>
<p>请注意，即使这样也不能给出你用户的精确统计，并且对通过互联网访问的用户也不是很友好：产生不必要的流量，并强迫用户等待未被缓存的内容从网络上下载回来。更多的信息可参见拓展阅读中的“<a href="http://www.goldmark.org/netrants/webstats/" target="_blank">解读访问统计</a>”对应内容。</p>
<p><strong>我该如何查看HTTP头？</strong>
许多浏览器可以查看</p>
<p>Expires
和</p>
<p>Last-Modified
头信息，如右键→查看页面信息或类似面板。例如，在Firefox浏览器下Add：</p>
<p><a href="http://cdn2.jobbole.com/2013/06/cache-for-web-master-025.png" title="web制作、开发人员需知的Web缓存知识" target="_blank"><img src="&quot;web制作、开发人员需知的Web缓存知识&quot;" alt="web制作、开发人员需知的Web缓存知识"></a><a href="http://cdn2.jobbole.com/2013/06/cache-for-web-master-03.png" title="web制作、开发人员需知的Web缓存知识" target="_blank"><img src="&quot;web制作、开发人员需知的Web缓存知识&quot;" alt="web制作、开发人员需知的Web缓存知识"></a></p>
<p>表示要看到完整的头，您可以使用Telnet⑪客户端手动连接到Web服务器上。</p>
<p>为此，你可能需要用一个字段指定端口（默认是80），或者连接到</p>
<p>www.example.com:80
或者</p>
<p>www.example.com 80
(注意是空格)，更多设置请参考一下telnet客户端的文档。</p>
<p>一旦连接到该网站，输入请求。比如，你想查看</p>
<p><a href="http://www.example.com/foo.html" target="_blank">http://www.example.com/foo.html</a>
的头信息，首先连接到</p>
<p>www.example.com
, 使用80端口，并输入：
GET /foo.html HTTP/1.1 [return]</p>
<p>Host: www.example.com [return][return]</p>
<p>[return]
等同敲回车键，最后输入两次确认。这样就会输出头信息，然后跟着实际内容。如果只想看到头信息，使用</p>
<p>HEAD
来替换</p>
<p>GET
.</p>
<p>⑪Telnet：Telnet协议是<a href="http://www.amazon.cn/gp/product/B004JZY9BI/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&amp;tag=vastwork-23&amp;linkCode=as2&amp;camp=536&amp;creative=3200&amp;creativeASIN=B004JZY9BI" title="TCP/IP协议族" target="_blank">TCP/IP协议族</a>中的一员，是Internet远程登陆服务的标准协议和主要方式。它为用户提供了在本地计算机上完成远程主机工作的能力。在终端使用者的电脑上使用telnet程序，用它连接到服务器。终端使用者可以在telnet程序中输入命令，这些命令会在服务器上运行，就像直接在服务器的控制台上输入一样。可以在本地就能控制服务器。要开始一个telnet会话，必须输入用户名和密码来登录服务器。Telnet是常用的远程控制Web服务器的方法。</p>
<p><strong>我的页面是密码保护的，代理缓存是怎么处理的？</strong>
默认情况下，HTTP验证保护的页面是私有的，共享缓存是不能保存的。然而，你可以通过</p>
<p>Cache-Control: public
头的设置使其公有。HTTP 1.1标准兼容的缓存服务器可以使之缓存。</p>
<p>如果你希望这些缓存的页面在用户查看之前还要验证一下，可以组合使用</p>
<p>Cache-Control: public
和</p>
<p>no-cache
头，这相对于告诉缓存器它从缓存中送出内容前必须递交客户端的验证给原始服务器。这个头信息如下所示：
Cache-Control: public, no-cache</p>
<p>不管怎么，这是最小化验证最好的方法；例如，你的图片不敏感，你可以把它放在分离的目录中，并配置你的服务对它们不做强制验证。这样，那些图片就会很自然的被缓存了。</p>
<p><strong>如果人们通过缓存访问我的网站，我应该担心安全吗？</strong>
SSL页面不会被代理服务器缓存，所以这个你不需要担心。但是，代理服务器就好非SSL页面请求以及URL抓取这口，你懂的，这是不安全的。无良的管理员可能就会收集网站用户的信息，尤其在URL中。</p>
<p>事实上，任何网络管理员都可以收集你的客户端和服务器端之间的这类信息。CGI ⑫脚本有个漏洞，会把用户名和密码放在自身的URL地址中，这很容易让其他人发现用户的登陆信息。</p>
<p>如果你懂得互联网安全的些基本机制，就不会对代理缓存感到任何惊讶。
⑫CGI：通用网关接口(Common Gateway Interface). 用于初始化软件服务的服务器方接口。这套接口描述了Web服务器与同一计算机上的软件的通信方式。</p>
<p>通用网关接口，它是一段程序，运行在服务器上，提供同客户端HTML页面的接口，通俗的讲CGI就像是一座桥，把网页和WEB服务器中的执行程序连接起来，它把HTML接收的指令传递给服务器，再把服务器执行的结果返还给HTML页；用CGI可以实现处理表格，数据库查询，发送电子邮件等许多操作，最常见的CGI程序就是计数器。CGI使网页变得不是静态的，而是交互式的。</p>
<p><strong>我在寻找一个集成的Web发布解决方案。哪些是可缓存的？</strong>
这个是不确定的。一般来说，越复杂的系统越难缓存。最差的情况就是所有的内容都是动态生成，并且不提供校验器，与缓存压根无缘。你可以和你供应商的技术人员沟通获取更多信息，并参考下面实现注意事项。</p>
<p><strong>我的图片缓存一个月后才到期，我现在就想变动！</strong></p>
<p>Expires
头是绕不过去的，除非缓存（浏览器或者代理）空间不足才会删除副本，缓存副本会一直使用。</p>
<p>最有效的方法是修改链接，这样会从源服务器获取完整的新内容。请记住，调用图片的这个页面也会被缓存的，正因如此，我们需要让图片以及其他类似的静态资源易缓存，而页面呢可以随着自身的改变（例如改变了一个图片的URL地址Add）即时更新。</p>
<p>如果你想摆脱特定缓存，重载内容，可以试试强制刷新（在FireFox中，shift键+reload按钮等同于处理</p>
<p>Pragma: no-cache
请求头）或者让缓存管理员使用某些接口删除内容。</p>
<p><strong>我运行一个Web Hosting服务。我怎样才能让我的用户发布缓存友好的网页？</strong>
如果你使用apahe，可以考虑允许他们使用</p>
<p>.htaccess
文件并提供相应的文档。</p>
<p>否则你需要在每一个虚拟主机上为各种缓存属性建立预定的区域。比如：你可以指定一个叫</p>
<p>/cache-1m
的目录用来放读取后要缓存一个月的内容，然后再建一个</p>
<p>/no-cache
的目录，并在头信息中指定这么目录中的内容不被缓存。</p>
<p>不管上面你做的如何，总之最好优先给用户量大的客户做缓存处理。大部分服务器节约的流量以及负载都是来自高容量的网站。</p>
<p><strong>我明明告诉网页要好好缓存，但它老是去请求，怎么破？</strong>
缓存服务器并不总是要求内容要保持并重用，某些条件下，他们是不保存不重用的，所有的缓存服务器都回基于文件的大小、类型（图片、页面…），或者服务器空间的剩余来确定如何缓存。如果你的文件比较大或很热门，可能就不会被缓存。有些缓存服务器允许管理员决定哪些内容要存储，有些缓存服务器允许内容长存缓存中，所以，它们总是可用的。</p>
<h3 id="-web-">实现需注意的：Web服务器端</h3>
<p>一般说来，应该选择最新版本的Web服务器程序来部署。不仅因为它们包含更多利于缓存的功能，新版本往往在性能和安全性方面都有很多的改善。</p>
<p><strong>Apache HTTP服务器</strong>
<a href="http://www.apache.org/" target="_blank">Apache</a>使用可选模块包含头信息，头信息</p>
<p>Expires
和</p>
<p>Cache-Control
一并包含。这些模块在1.2版本以上都支持。</p>
<p>这些模块需要编译到Apache中，虽然包含，但是默认并未开启。为了确定相应模块已经被启用，找到httpd⑬程序，运行</p>
<p>httpd -l
, 它会列出可用的模块（注意，仅有内部编译的模块列表才会显示，在较新版本的Apache中，使用</p>
<p>httpd -M
可以包含动态加载的模块N），我们需要关注的是expires模块(</p>
<p>expires_module
)和headers模块(</p>
<p>headers_module
)。
⑬httpd：httpd是Apache超文本传输协议(HTTP)服务器的主程序。被设计为一个独立运行的后台进程，它会建立一个处理请求的子进程或线程的池。</p>
<ul>
<li>如果这些模块不可用，你需要联系管理员，重新编译以包含这些模块。这些模块可以通过取消配置文件中的注释掉启用，或者在编译的时候增加</li>
</ul>
<p>-enable -module=expires
和</p>
<p>-enable-module=headers
参数(apache 1.3+). 参开Apache中的INSTALL文件。</p>
<p>一旦你的Apache有了相应的模块，你可以使用</p>
<p>mod_expires
指定过期的时间，要么在</p>
<p>.htaccess
文件，要么在服务器的</p>
<p>access.conf
文件。你可以设置过期时间是从访问时间开始还是文件修改时间开始，并应用到特定类型文件上或设为默认配置。查看官方<a href="http://www.apache.org/docs/mod/mod_expires.html" target="_blank">该模块文档</a>获得更多信息，或者遇到问题的时候向你身边的apache专家讨教。</p>
<p>为应用</p>
<p>Cache-Control
头，你需要使用</p>
<p>mod_headers
模块，其允许你为资源指定任意的头信息。可参考<a href="http://www.apache.org/docs/mod/mod_headers.html" target="_blank">mod_headers官方文档</a>。</p>
<p>下面是</p>
<p>.htaccess
文件展示了如何使用头信息：</p>
<ul>
<li>.htaccess
文件允许Web发布者使用配置文件中的指定。可以影响目录以及子目录内容。和你的服务器管理员沟通下，看看它们是否可用。</li>
</ul>
<p>/#/#/# activate mod_expires</p>
<p>ExpiresActive On
/#/#/# Expire .gif&#39;s 1 month from when they&#39;re accessed</p>
<p>ExpiresByType image/gif A2592000
/#/#/# Expire everything else 1 day from when it&#39;s last modified</p>
<p>/#/#/# (this uses the Alternative syntax)
ExpiresDefault &quot;modification plus 1 day&quot;</p>
<p>/#/#/# Apply a Cache-Control header to index.html</p>
<Files index.html>

<p>Header append Cache-Control &quot;public, must-revalidate&quot;
</Files></p>
<ul>
<li>注意，在有些情况下，</li>
</ul>
<p>mod_expires
会自动计算并插入</p>
<p>Cache-Control:max-age
头信息。</p>
<p>Apache 2′s的配置和1.3类似，更多信息可以参考2.2N的<a href="http://httpd.apache.org/docs/2.2/mod/mod_expires.html" target="_blank">mod_expires</a>和<a href="http://httpd.apache.org/docs/2.2/mod/mod_headers.html" target="_blank">mod_headers</a>文档。</p>
<p><strong>微软IIS</strong>
微软的IIS有一些灵活的方式可以很容易得设置头信息，不过似乎只针对IIS 4.0服务器，并且只能在NT服务器上运行。</p>
<p>为了给网站某区域指定头信息，需要进入</p>
<p>Administration
(管理员)工具面板，然后再设置属性。选择</p>
<p>HTTP Headers
选项卡后，你会看到两个有意思的区域：</p>
<p>Enable Content Expiration
和</p>
<p>Custom HTTP headers
, 第一个含义一目了然，第二个用来应用</p>
<p>Cache-Control
头。//zxx: 此处的操作描述很过时了，看看window7下，操作界面早就大变样了！</p>
<p><a href="http://cdn2.jobbole.com/2013/06/cache-for-web-master-035.png" title="web制作、开发人员需知的Web缓存知识" target="_blank"><img src="&quot;web制作、开发人员需知的Web缓存知识&quot;" alt="web制作、开发人员需知的Web缓存知识"></a><a href="http://cdn2.jobbole.com/2013/06/cache-for-web-master-04.png" title="web制作、开发人员需知的Web缓存知识" target="_blank"><img src="&quot;web制作、开发人员需知的Web缓存知识&quot;" alt="web制作、开发人员需知的Web缓存知识"></a></p>
<p>设置ASP页面(Active Server Pages)的头信息可以参考后面的ASP章节，也可以通过ISAPI模块设置头信息，细节请参考MSDN。</p>
<p><strong>Netscape/iPlanet企业服务器</strong>
3.6版本以后，企业版服务器已经不能以任何方式设置</p>
<p>Expires
头信息了。然而，其从3.0版本开始支持HTTP 1.1的功能。这意味着HTTP 1.1的缓存（代理服务器/浏览器）利用你对</p>
<p>Cache-Control
的设置来获得。</p>
<p>为了使用</p>
<p>Cache-Control
头，在管理员服务器中选择</p>
<p>Content Management | Cache Control Directives
（内容管理|缓存控制指令）。然后，使用资源选择器(Resource Picker)，选择你希望设置头信息的目录。设置完头信息后，点击”确定”。更多信息请参考<a href="http://www.redhat.com/docs/manuals/ent-server/" target="_blank">NES手册</a>。</p>
<h3 id="-">实现需注意的：服务端脚本</h3>
<p>时刻谨记，在Web服务器上设置HTTP要比通过脚本设置轻松些。你可以两者都试试。</p>
<p>因为服务器端的脚本主要是为了动态内容，所以即使实际上内容可以被缓存的，其也不会生成缓存很强的页面。如果你的页面内容经常变动，但不是每个页面都中枪，可以考虑设置</p>
<p>Cache-Control: max-age
头信息，大部分用户是在相对端的时间内再次访问这个页面。例如：用户点击“后退”按钮，如果没有任何验证或新鲜度信息，他们将不得不等待，直到从服务器页面重新下载才能看到它。</p>
<p><strong>CGI</strong>
CGI脚本是生成内容最常用的技术之一。你可以轻轻松松在请求发送给主体之前添加HTTP请求信息。大部分CGI实现都需要添加</p>
<p>Content-Type
头信息，例如这个Perl脚本：//zxx: 还是挺好懂的
&lt;/#!/usr/bin/perl</p>
<p>print &quot;Content-type: text/htmln&quot;;
print &quot;Expires: Thu, 29 Oct 1998 17:04:19 GMTn&quot;;</p>
<p>print &quot;n&quot;;
/#/#/# the content body follows.../pre&gt;</p>
<p>由于都是文本，你可以很容易通过内置函数生成</p>
<p>Expires
和其他日期相关的头信息。如果你使用</p>
<p>Cache-Control: max-age
会更简单：</p>
<p>print &quot;Cache-Control: max-age=600n&quot;;</p>
<p>上面脚本可以让请求完成后缓存10分钟，因此，当用户点击“后退”按钮的时候，就不会重新涂胶请求了。</p>
<p>CGI的规范同时也允许在脚本环境中，客户端发送请求头信息，每个头信息都有一个’HTTP_’的前缀。于是乎，如果一个客户端发送一个</p>
<p>If-Modified-Since
请求，就是这样的：
HTTP_IF_MODIFIED_SINCE</p>
<p>可观摩<a href="http://www.mnot.net/cgi_buffer/" target="_blank">cgi_buffer</a>库，其可以自动实现</p>
<p>Etag
生成和验证，</p>
<p>Content-Length
生成及gzip内容，而所有这些实现，只需要一行include，就可以为Perl和Python写CGI脚本。Python版本还可以包装任意的CGI脚本。</p>
<p><strong>服务器端包含</strong>
SSI（扩展名通常是</p>
<p>.shtml
）最早可以生成动态内容的网站发布方案。通过在页面中使用特定的标签，有一定限制的内HTML脚本就可以使用了。大部分的SSI实现不设置验证器，故无法缓存。不过Apache服务器允许通过设置让SSI文件可缓存，通过适当的文件并结合</p>
<p>XbitHack full
指令设置组执行权限。欲了解更多信息，请参阅<a href="http://www.apache.org/docs/mod/mod_include.html" target="_blank">mod_include文档</a>。</p>
<p><strong>PHP</strong>
PHP为服务器端脚本语言，在服务器内置的时候，可以在HTML页面中内嵌使用，很像SSL，不过有更多的可选项。PHP可以在任何Web服务器(Unix或Windows)或Apache模块上作为CGI使用。</p>
<p>默认情况下，PHP生成的内容没有分配验证器，因此，不能缓存。不过，开发人员可以通过</p>
<p>Header()
函数设置HTTP头信息。例如，创建</p>
<p>Cache-Control
头，过期时间为3天：
&lt;?php</p>
<p>Header(&quot;Cache-Control: must-revalidate&quot;);</p>
<p>$offset = 60 /<em> 60 /</em> 24 /* 3;
$ExpStr = &quot;Expires: &quot; . gmdate(&quot;D, d M Y H:i:s&quot;, time() + $offset) . &quot; GMT&quot;;</p>
<p>Header($ExpStr);
?&gt;</p>
<p>记住</p>
<p>Header()
需要在所有的输出之前。</p>
<p>正如你看到的，你可以手工创建HTTP日期。PHP没有专门的函数（新版本已改进，请参考<a href="http://php.net/date" target="_blank">PHP的日期相关函数文档</a>）。当然，最简单的还是设置</p>
<p>Cache-Control: max-age
头信息，适用于大部分情况。</p>
<p>更多内容，请参阅<a href="http://www.php.net/manual/function.header.php3" target="_blank">header手册</a>。</p>
<p>还是<a href="http://www.mnot.net/cgi_buffer/" target="_blank">cgi_buffer</a>库，只要一行包含，就能以PHP脚本形式自动实现</p>
<p>Etag
生成和验证，</p>
<p>Content-Length
生成及gzip内容。</p>
<p><strong>Cold Fusion</strong>
<a href="http://www.adobe.com/products/coldfusion/" target="_blank">Cold Fusion</a>是Macromedia的商业服务器端脚本引擎，并且支持多种Windows平台，Linux平台和多种Unix平台。//zxx: 看到Macromedia心亮了半截，几百年前就被收购的公司……此文未免太过时了点了~~大家这段可以跳过了，几乎没有任何价值……</p>
<p>Cold Fusion通过CFHEADER标记设置HTTP头信息相对容易。可惜的是，以下的Expires头信息的设置有些容易误导：</p>
<CFHEADER NAME="Expires" VALUE="/#Now()/#">

<p>它并不像你想像的那样工作，因为时间（本例中为请求发起的时间）并不会被转换成一个符合HTTP时间，而且打印出副本的Cold fusion的日期/时间对象，大部分客户端会忽略或者将其转换成1970年1月1日。</p>
<p>但是：Cold Fusion另外提供了一套日期格式化函数-<a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00000483.htm" target="_blank">GetHttpTimeSTring</a>. 结合<a href="http://livedocs.macromedia.com/coldfusion/7/htmldocs/00000437.htm" target="_blank">DateAdd</a>函数，就很容易设置过期时间了，这里我们设置一个头信息，声明内容在1个月以后过期：</p>
<cfheader name="Expires"

  value="/#GetHttpTimeString(DateAdd('m', 1, Now()))/#">

<p>你也可以使用</p>
<p>CFHEADER
标签设置</p>
<p>Cache-Control: max-age
以及其他头信息。</p>
<p>记住，Web服务器也会将头信息设置转给Cold Fusion(做为CGI运行的时候)，检查你的服务器设置并确定你是否可以利用服务器设置代替Cold Fusion.</p>
<p><strong>ASP和ASP.NET</strong></p>
<p>在asp中设置HTTP头信息时，确保</p>
<p>Response
方法调用在HTML内容输出之前，或者使用</p>
<p>Response.Buffer
暂存输出。同时，注意某些版本的IIS默认设置会输出</p>
<p>Cache-Control: private
头信息，必须声明成</p>
<p>public
才能被共享缓存服务器缓存。</p>
<p>ASP(Active Server Pages)，IIS内置，也可用于其他Web服务器，同样允许你设置HTTP头。例如设置过期时间，你可以使用</p>
<p>Response
自带属性：
&lt;% Response.Expires=1440 %&gt;</p>
<p>指定内容过期的分钟数。</p>
<p>Cache-Control
头添加如下：</p>
<p>&lt;% Response.CacheControl=&quot;public&quot; %&gt;</p>
<p>在ASP.NET中，</p>
<p>Response.Expires
已经不推荐使用了，正确的方法是通过</p>
<p>Response.Cache
设置缓存相关的头信息，如下：</p>
<p>Response.Cache.SetExpires ( DateTime.Now.AddMinutes ( 60 ) ) ;</p>
<p>Response.Cache.SetCacheability ( HttpCacheability.Public ) ;</p>
<h3 id="-">参考文档和拓展阅读</h3>
<p><a href="http://www.ietf.org/rfc/rfc2616.txt" target="_blank"><strong>HTTP 1.1规范</strong></a>
HTTP 1.1的规范对页面缓存以及权威的接口实现指南有了大量的扩展，参考章节：13, 14.9, 14.21以及14.25 .</p>
<p><strong><a href="http://www.web-caching.com/" target="_blank">Web-Caching.com</a></strong>
对缓存概念有很好的介绍，并且有很多其他在线资源的链接。</p>
<p><a href="http://www.goldmark.org/netrants/webstats/" target="_blank"><strong>解读访问统计</strong></a>
Jeff Goldberg这篇内容丰富叙述会告诉你为什么不应该过度依赖访问统计和计数器。//zxx 上世纪的复古页面…</p>
<p><a href="http://www.zhangxinxu.com/wordpress/2013/05/caching-tutorial-for-web-authors-and-webmasters/" target="_blank"><strong>REDbot</strong></a>
检查HTTP资源，以确定它们如何与Web缓存交互，以及通常如何使用该协议。</p>
<p><a href="http://www.mnot.net/cgi_buffer/" target="_blank"><strong>cgi_buffer库</strong></a>
只要包含一行Perl CGI, Python CGI以及PHP脚本，就能自动实现</p>
<p>Etag
生成以及验证，</p>
<p>Content-Length
生成以及Gzip内容的正确编码。Python版本还可以包装任意的CGI脚本。</p>
<h3 id="-">关于本文档</h3>
<p>本文版权属于Mark Nottingham © 1998-2013 邮箱为</p>
<p>mnot@pobox.com
.</p>
<p>本作品遵循<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/" target="_blank">知识共享署名 – 非商业性使用 – 禁止演绎3.0声明页面许可证</a>N。</p>
<p>所有的商标版权为其持有人所有。</p>
<p>内容在发布时是可以确保其正确性，但是，随着时间推移，就不能保证正确无误了。因此，如有链接404，描述错误或其他需要纠正的问题请尽快告知作者。</p>
<p>本文最新版本可以从<a href="http://www.mnot.net/cache_docs/" target="_blank"><a href="http://www.mnot.net/cache_docs/">http://www.mnot.net/cache_docs/</a></a>获得</p>
<p>可用翻译：<a href="http://www.fatcow.com/edu/cache-docs-be/" target="_blank">白俄罗斯</a>，<a href="http://www.zhangxinxu.com/wordpress/?p=3338" target="_blank">中国</a>，<a href="http://www.jakpsatweb.cz/clanky/caching-tutorial-czech-translation.html" target="_blank">捷克</a>，<a href="http://thomas-huehn.de/web/caching-tutorial" target="_blank">德国</a>和<a href="http://www.mnot.net/cache_docs/index.fr.html" target="_blank">法国</a>。</p>
<p><strong>文档说明：</strong>含有上标N的表示与前辈翻译时候相比新增的；上标Add表示作为译者的我为了便于理解自己添加的；上标数字(①-⑬)是对一些可能不熟悉的名词的百科解释。</p>
<p>虽然原作语言不生动，教科书般一板一眼⑭；有些可能过时了。不过，还是学到了很多东西。还是很值的！欢迎分享，欢迎传播，以后面试之前来这里看看，可能会有帮助哦！
⑭ 如果我介绍缓存，我可能就这么讲：缓存是什么？顾名思意，就是缓慢的存钱。为什么要缓慢的存钱，因为工资卡都上交老婆了，为了攒点零花钱又不能被老婆发现，只能慢慢存了。那缓存有什么用呢？你想啊，自己有点小钱，做事情就方便快捷了，比方说我想买个鱼竿，就不要去向老婆要（给不给先不谈），自己从自己这边取，大大提高了执行的速度。</p>
<p>那什么时候可以存什么时候不能存呢？老婆给零花钱的时候，可能会有过期时间头，例如，周一甩了100块钱，拿去，这是一周的伙食！这个一周就是过期时间头(Expires Header)，在这个时间内，你的钱可以从缓存，也就是自己这里取……</p>
<p><img src="&quot;1 vote, average: 5.00 out of 5&quot;" alt="1 vote, average: 5.00 out of 5"><img src="&quot;1 vote, average: 5.00 out of 5&quot;" alt="1 vote, average: 5.00 out of 5"><img src="&quot;1 vote, average: 5.00 out of 5&quot;" alt="1 vote, average: 5.00 out of 5"><img src="&quot;1 vote, average: 5.00 out of 5&quot;" alt="1 vote, average: 5.00 out of 5"><img src="&quot;1 vote, average: 5.00 out of 5&quot;" alt="1 vote, average: 5.00 out of 5"> (<strong>*1</strong> 个评分，平均: <strong>5.00*</strong>)</p>
<p><img src="&quot;Loading ...&quot;" alt="Loading ..."> Loading ...</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/缓存/">缓存</a></li></span></span> | <span class="tags">Tagged <a href="/tags/缓存/" class="label label-primary">缓存</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:39"datetime="2014-03-07 09:54:39"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-缓存--Web开发人员需知的Web缓存知识/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-缓存--Web开发人员需知的Web缓存知识" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>



  <article>
<div id="post" class="post well">
  <div class="post-content">
    <header class="well-sm">
      <i class="fa icon fa-5x pull-left"></i>
      <h1 class="title"><a href="/2014/02/02/2014-02-02-缓存-ehcache--EHCache分布式缓存集群环境配置-七郎-博客园/">EHCache分布式缓存集群环境配置 </a></h1>
      
        <span>Posted on<time datetime="2014-02-02T01:54:39.000Z"> <a href="/2014/02/02/2014-02-02-缓存-ehcache--EHCache分布式缓存集群环境配置-七郎-博客园/">feb. 2 2014</a></time></span>      
    </header>
    
    
    <div class="entry">
      
        <h1 id="ehcache-">EHCache分布式缓存集群环境配置 - 七郎 - 博客园</h1>
<p><a href=""></a></p>
<p><a href="http://www.cnblogs.com/yangy608/" target="_blank"><img src="" alt="返回主页"></a></p>
<h1 id="-s-blog-http-www-cnblogs-com-yangy608-"><a href="http://www.cnblogs.com/yangy608/" target="_blank">七郎&#39;s Blog</a></h1>
<h2 id="-">草木竹石皆可為劒。至人之用人若鏡，不將不迎，應而不藏，故能勝物而不傷。</h2>
<ul>
<li><a href="http://www.cnblogs.com/" target="_blank">博客园</a></li>
<li><a href="http://www.cnblogs.com/yangy608/" target="_blank">首页</a></li>
<li><a href="http://news.cnblogs.com/" target="_blank">新闻</a></li>
<li><a href="http://www.cnblogs.com/yangy608/admin/EditPosts.aspx?opt=1" target="_blank">新随笔</a></li>
<li><a href="http://space.cnblogs.com/msg/send/%e4%b8%83%e9%83%8e" target="_blank">联系</a></li>
<li><a href="http://www.cnblogs.com/yangy608/admin/EditPosts.aspx" target="_blank">管理</a></li>
<li><a href="http://www.cnblogs.com/yangy608/rss" target="_blank">订阅</a><a href="http://www.cnblogs.com/yangy608/rss" target="_blank"><img src="" alt="订阅"></a>
随笔- 144 文章- 1 评论- 1 </li>
</ul>
<h1 id="-ehcache-http-www-cnblogs-com-yangy608-archive-2011-10-07-2200669-html-"><a href="http://www.cnblogs.com/yangy608/archive/2011/10/07/2200669.html" target="_blank">EHCache分布式缓存集群环境配置</a></h1>
<p>ehcache提供三种网络连接策略来实现集群，rmi,jgroup还有jms。同时ehcache可以可以实现多播的方式实现集群,也可以手动指定集群主机序列实现集群。</p>
<p>Ehcache支持的分布式缓存支持有三种RMI，JGroups，JMS，这里介绍下MRI和JGrpups两种方式，Ehcache使用版本为1.5.0，关于ehcache的其他信息请参考<a href="http://ehcache.sourceforge.net/EhcacheUserGuide.html" target="_blank"><a href="http://ehcache.sourceforge.net/EhcacheUserGuide.html">http://ehcache.sourceforge.net/EhcacheUserGuide.html</a></a>，</p>
<p>关于jgroups的信息请参考<a href="http://www.jgroups.org/manual/html_single/index.html。" target="_blank">http://www.jgroups.org/manual/html_single/index.html。</a></p>
<p>环境为两台机器 server1 ip：192.168.2.154，server2 ip：192.168.2.23</p>
<h3 id="1-rmi-">1. RMI方式：</h3>
<p>rmi的方式配置要点（下面均是server1上的配置，server2上的只需要把ip兑换即可）</p>
<p><strong>a. 配置PeerProvider：</strong></p>
<p>Xml代码</p>
<cacheManagerPeerProviderFactory class="net.sf.ehcache.distribution.RMICacheManagerPeerProviderFactory"

properties="peerDiscovery=manual,rmiUrls=//192.168.2.23:40001/userCache|//192.168.2.23:40001/resourceCache" /> 

<p>配置中通过手动方式同步sever2中的userCache和resourceCache。</p>
<p><strong>b. 配置CacheManagerPeerListener：</strong></p>
<p>Xml代码</p>
<cacheManagerPeerListenerFactory class="net.sf.ehcache.distribution.RMICacheManagerPeerListenerFactory"

properties="hostName=192.168.2.154, port=40001,socketTimeoutMillis=2000" /> 

<p>配置中server1监听本机40001端口。</p>
<p><strong>c. 在每一个cache中添加cacheEventListener，例子如下：</strong></p>
<p>Xml代码</p>
<cache name="userCache" maxElementsInMemory="10000" eternal="true" overflowToDisk="true" timeToIdleSeconds="0" timeToLiveSeconds="0"diskPersistent="false" diskExpiryThreadIntervalSeconds="120">

<cacheEventListenerFactory class="net.sf.ehcache.distribution.RMICacheReplicatorFactory" properties="replicateAsynchronously=true, replicatePuts=true, replicateUpdates=true,replicateUpdatesViaCopy= false, replicateRemovals= true " />

</cache>

<p><strong>属性解释：</strong></p>
<p>必须属性：</p>
<pre><code>    name:设置缓存的名称，用于标志缓存,惟一

    maxElementsInMemory:在内存中最大的对象数量

    maxElementsOnDisk：在DiskStore中的最大对象数量，如为0，则没有限制

    eternal：设置元素是否永久的，如果为永久，则timeout忽略

    overflowToDisk：是否当memory中的数量达到限制后，保存到Disk
</code></pre><p>可选的属性：</p>
<pre><code>    timeToIdleSeconds：设置元素过期前的空闲时间

    timeToLiveSeconds：设置元素过期前的活动时间

    diskPersistent：是否disk store在虚拟机启动时持久化。默认为false
</code></pre><p>   diskExpiryThreadIntervalSeconds:运行disk终结线程的时间，默认为120秒</p>
<pre><code>    memoryStoreEvictionPolicy：策略关于Eviction
</code></pre><p>缓存子元素：</p>
<pre><code>cacheEventListenerFactory：注册相应的的缓存监听类，用于处理缓存事件，如put,remove,update,和expire

bootstrapCacheLoaderFactory:指定相应的BootstrapCacheLoader，用于在初始化缓存，以及自动设置。
</code></pre><p>参考另外一篇学习笔记<a href="http://wozailongyou.javaeye.com/blog/230252" title="http://wozailongyou.javaeye.com/blog/230252" target="_blank"><a href="http://wozailongyou.javaeye.com/blog/230252">http://wozailongyou.javaeye.com/blog/230252</a></a>，也有集群的说明</p>
<h3 id="2-jgroups-">2. JGroups方式：</h3>
<p>ehcache 1.5.0之后版本支持的一种方式，配置起来比较简单，要点：</p>
<p><strong>a. 配置PeerProvider，使用tcp的方式，例子如下：</strong></p>
<p>Xml代码</p>
<cacheManagerPeerProviderFactory class="net.sf.ehcache.distribution.jgroups.JGroupsCacheManagerPeerProviderFactory"

properties="connect=TCP(start_port=7800):

TCPPING(initial_hosts=192.168.2.154[7800],192.168.2.23[7800];port_range=10;timeout=3000;

num_initial_members=3;up_thread=true;down_thread=true):

VERIFY_SUSPECT(timeout=1500;down_thread=false;up_thread=false):

pbcast.NAKACK(down_thread=true;up_thread=true;gc_lag=100;retransmit_timeout=3000):

pbcast.GMS(join_timeout=5000;join_retry_timeout=2000;shun=false;

print_local_addr=false;down_thread=true;up_thread=true)"

propertySeparator="::" />

<hr>
<p><strong>b.为每个cache添加cacheEventListener：</strong></p>
<p>Xml代码</p>
<cache name="userCache" maxElementsInMemory="10000" eternal="true"

overflowToDisk="true" timeToIdleSeconds="0" timeToLiveSeconds="0"

diskPersistent="false" diskExpiryThreadIntervalSeconds="120">

<cacheEventListenerFactory class="net.sf.ehcache.distribution.jgroups.JGroupsCacheReplicatorFactory"

properties="replicateAsynchronously=true, replicatePuts=true,

replicateUpdates=true, replicateUpdatesViaCopy=false, replicateRemovals=true"/>

</cache>

<p>JGroup方式配置的两个server上的配置文件一样，若有多个server，在initial_hosts中将server ip加上即可。</p>
<p>一个完整的ehcache.xml文件：</p>
<p>Xml代码
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</p>
<ehcache xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"

xsi:noNamespaceSchemaLocation="http://ehcache.sf.net/ehcache.xsd">

<diskStore path="java.io.tmpdir" />



<cacheManagerPeerProviderFactory class="net.sf.ehcache.distribution.jgroups.JGroupsCacheManagerPeerProviderFactory"

properties="connect=TCP(start_port=7800):

TCPPING(initial_hosts=192.168.2.154[7800],192.168.2.23[7800];port_range=10;timeout=3000;

num_initial_members=3;up_thread=true;down_thread=true):

VERIFY_SUSPECT(timeout=1500;down_thread=false;up_thread=false):

pbcast.NAKACK(down_thread=true;up_thread=true;gc_lag=100;retransmit_timeout=3000):

pbcast.GMS(join_timeout=5000;join_retry_timeout=2000;shun=false;

print_local_addr=false;down_thread=true;up_thread=true)"

propertySeparator="::" />



<defaultCache maxElementsInMemory="10000" eternal="true"

overflowToDisk="true" timeToIdleSeconds="0" timeToLiveSeconds="0"

diskPersistent="false" diskExpiryThreadIntervalSeconds="120">

<cacheEventListenerFactory class="net.sf.ehcache.distribution.jgroups.JGroupsCacheReplicatorFactory"

properties="replicateAsynchronously=true, replicatePuts=true,

replicateUpdates=true, replicateUpdatesViaCopy=false, replicateRemovals=true"/>

</defaultCache>



<cache name="velcroCache" maxElementsInMemory="10000" eternal="true"

overflowToDisk="true" timeToIdleSeconds="0" timeToLiveSeconds="0"

diskPersistent="false" diskExpiryThreadIntervalSeconds="120">

<cacheEventListenerFactory class="net.sf.ehcache.distribution.jgroups.JGroupsCacheReplicatorFactory"

properties="replicateAsynchronously=true, replicatePuts=true,

replicateUpdates=true, replicateUpdatesViaCopy=false, replicateRemovals=true"/>

</cache>

<cache name="userCache" maxElementsInMemory="10000" eternal="true"

overflowToDisk="true" timeToIdleSeconds="0" timeToLiveSeconds="0"

diskPersistent="false" diskExpiryThreadIntervalSeconds="120">

<cacheEventListenerFactory class="net.sf.ehcache.distribution.jgroups.JGroupsCacheReplicatorFactory"

properties="replicateAsynchronously=true, replicatePuts=true,

replicateUpdates=true, replicateUpdatesViaCopy=false, replicateRemovals=true"/>

</cache>

<cache name="resourceCache" maxElementsInMemory="10000"

eternal="true" overflowToDisk="true" timeToIdleSeconds="0"

timeToLiveSeconds="0" diskPersistent="false"

diskExpiryThreadIntervalSeconds="120">

<cacheEventListenerFactory class="net.sf.ehcache.distribution.jgroups.JGroupsCacheReplicatorFactory"

properties="replicateAsynchronously=true, replicatePuts=true,

replicateUpdates=true, replicateUpdatesViaCopy=false, replicateRemovals=true"/>

</cache>

</ehcache>

<p>posted @ 2011-10-07 17:30 <a href="http://www.cnblogs.com/yangy608/" target="_blank">七郎</a> 阅读(1963) 评论(0) <a href="http://www.cnblogs.com/yangy608/admin/EditPosts.aspx?postid=2200669" target="_blank">编辑</a> <a href="http://www.cnblogs.com/yangy608/archive/2011/10/07/2200669.html#" target="_blank">收藏</a>
<img src="" alt=""></p>
<p><a href="http://www.cnblogs.com/yangy608/archive/2011/10/07/2200669.html#" target="_blank">刷新页面</a><a href="http://www.cnblogs.com/yangy608/archive/2011/10/07/2200669.html#top" target="_blank">返回顶部</a></p>
<p>（评论功能已被博主禁用）
<a href="http://q.cnblogs.com/" target="_blank">程序员问答社区，解决您的技术难题</a></p>
<p><a href="http://www.cnblogs.com/" title="程序员的网上家园" target="_blank">博客园首页</a><a href="http://q.cnblogs.com/" title="程序员问答社区" target="_blank">博问</a><a href="http://news.cnblogs.com/" title="IT新闻" target="_blank">新闻</a><a href="http://home.cnblogs.com/ing/" target="_blank">闪存</a><a href="http://job.cnblogs.com/" target="_blank">程序员招聘</a><a href="http://kb.cnblogs.com/" target="_blank">知识库</a></p>
<h3 id="-">公告</h3>
<p>Copyright ©2012 七郎</p>

      
    </div>
    
    
      
    
    
        <footer id="post-meta">
        <span class="categories">Posted in<span class="breadcrumb fa fa-folder"><li><a href="/categories/缓存/">缓存</a></li></span><span class="breadcrumb"><li><a href="/categories/缓存/">缓存</a></li><li><a href="/categories/缓存/ehcache/">ehcache</a></li></span></span> | <span class="tags">Tagged <a href="/tags/ehcache/" class="label label-primary">ehcache</a><a href="/tags/缓存/" class="label label-success">缓存</a></span> | <span class="time">recent updated:<time title="2014-03-07 09:54:39"datetime="2014-03-07 09:54:39"> mar. 7 2014</time></span> | <span class="comment-link">
<a href="http://itsolife.com/2014/02/02/2014-02-02-缓存-ehcache--EHCache分布式缓存集群环境配置-七郎-博客园/#comments" class="ds-thread-count comment-link" data-thread-key="2014-02-02-缓存-ehcache--EHCache分布式缓存集群环境配置-七郎-博客园" data-count-type="comments">暂无评论</a></span>
        </footer>
    
    <div class="clearfix"></div>
  </div>
</div>
</article>





<ul id="pagination" class="pagination pagination-lg">
  <li><a class="extend prev" href="/page/80/">&laquo;</a></li><li><a class="page-number" href="/">1</a></li><li><a class="page-number" href="/page/2/">2</a></li><li><span class="space">&hellip;</span></li><li><a class="page-number" href="/page/78/">78</a></li><li><a class="page-number" href="/page/79/">79</a></li><li><a class="page-number" href="/page/80/">80</a></li><li class="active"><li><span class="page-number current">81</span></li><li><a class="page-number" href="/page/82/">82</a></li><li><a class="page-number" href="/page/83/">83</a></li><li><a class="page-number" href="/page/84/">84</a></li><li><span class="space">&hellip;</span></li></li><li><a class="page-number" href="/page/164/">164</a></li><li><a class="page-number" href="/page/165/">165</a></li><li><a class="extend next" href="/page/82/">&raquo;</a></li>
  <div class="clearfix"></div>
</ul></div><!--wapper-->
       </div><!-- ID main-col END -->
       <aside id="sidebar" class="alignright col-sx-6 col-sm-4 col-md-3 col-lg-3">
<div id="widget_search" class="widget panel panel-primary">
    <form action="//google.com/search" method="get" accept-charset="utf-8">
  <div class="input-group">
    <input class="form-control" id="searchbox" type="search" name="q" results="0" placeholder="search">
    <span class="input-group-btn">
      <button class="btn btn-default" type="submit">Go!</button>
    </span>
    <input type="hidden" name="q" value="site:itsolife.com">
  </div>
</form>
</div>

<div id="widget_category" class="widget panel panel-primary">
  <div class="panel-heading">category</div>  <div data-src='category' class='ajax_widgets'>正在加载...</div>
</div>

<div id="widget_recent_posts" class="widget panel panel-primary">
  <div class="panel-heading">recent posts</div>  <div data-src='recent_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_tagcloud" class="widget panel panel-primary">
  <div class="panel-heading">tagcloud</div>  <div data-src='tagcloud' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_latest_update_posts" class="widget panel panel-primary">
  <div class="panel-heading">最近更新</div>  <div data-src='latest_update_posts' class='ajax_widgets'>正在加载...</div></div>

<div id="widget_recent_comments" class="widget panel panel-primary">
  <div class="panel-heading">recent comments</div>  

<div class="list-group-item ds-recent-comments" data-num-items="6" data-show-avatars="1" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="50"></div>



</div>

</aside>
       <div class="clearfix"></div>
     </div><!-- row END -->
  </div>
  <footer id="footer" class="container">
  <div class="panel panel-info">
  <section id='footer_widget'></section>  <div class="panel-footer">
  <div id="site-info">
    <span class='author'>
  
  &copy; 2014 RobinChia
  
    &nbsp;&nbsp;</span>
  
  <span id='analytics-51la'></span><span id='analytics-google'>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-48559895-1']);
  _gaq.push(['_trackPageview']);
  _js2load.push({src:('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'});
</script></span><span id='analytics-cnzz'>
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_5774006'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s17.cnzz.com/stat.php%3Fid%3D5774006%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
</span><span id='analytics-baidu'>
<script>
var _hmt = _hmt || [];
_js2load.push({src:"//hm.baidu.com/hm.js?1442f50724afc42380b51f097c43082c"});
</script>
</span>  </div>
  <div id="copyright">Blog powered by <a href='http://zespia.tw/hexo/'><strong>hexo</strong></a> Theme <strong><a href='https://github.com/chenall/hexo-theme-chenall'>chenall</a></strong>(Some change in it)<span class="pull-right"> 更新时间: <em>2014-03-15 20:45:44</em></span></div>
</div>
<div class="clearfix"></div>


  </div>
  </footer>
  
        <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>        
        <script src="http://cdn.staticfile.org/twitter-bootstrap/3.1.0/js/bootstrap.min.js"></script>        
                
        <script src="http://cdn.bootcss.com/prettify/r298/prettify.min.js"></script>    <script type="text/javascript">
   var lang=["bsh", "c", "cc", "cpp", "cs", "csh", "cyc", "cv", "htm", "html",
    "java", "js", "m", "mxml", "perl", "pl", "pm", "py", "rb", "sh",
    "xhtml", "xml", "xsl"];
   var pretty_base='';
   $('script').each(function(){
	var c = $(this).attr('src');
	if (!c)
	    return;
	if (c.match(/(\/)?prettify(\.min)?\.js/i))
	{
	    var index = c.lastIndexOf('/');
	    if (index != -1)
		pretty_base = c.substr(0,index + 1);
	    return false;
	}
   })
   $('pre code').each(function(){
	var c = $(this).attr('class')
	if (!c)
	    return;
	c = c.match(/\s?(lang\-\w+)/i);
	if (c && lang.indexOf(c[1]) == -1)
	{
	    lang.push(c[1]);
	    $.getScript(pretty_base + c[1] + '.min.js');
	}
   })

    $(window).load(function(){
       $("pre").addClass("prettyprint");
       prettyPrint();
    })
</script>    
            <script type="text/javascript">
var duoshuoQuery = {short_name:"robinchia"};
_js2load.push({src:'http://static.duoshuo.com/embed.js',charset:'UTF-8'});
</script>
    
            <!--wumii_relatedItems-->
    
        <script src="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js"></script>    <script type="text/javascript">
(function($){
  $('.entry').each(function(i){
    $(this).find('img').each(function(){
      var alt = this.alt;

      if (alt){
        $(this).before('<span class="caption">' + alt + '</span>');
      }

      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="fancybox' + i + '" />');
    });
  });

  $('.fancybox').fancybox();
})(jQuery);
</script>    
        <script src="http://cdn.bootcss.com/mathjax/2.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>
    
<script type="text/javascript">
$('.ajax_widgets').each(function(){var src=$(this).attr('data-src');if(src)$(this).load('/widgets/'+src+'.html');});
$.each(_js2load,function(index,obj){loadjs(obj.src,obj.charset)});
</script>

<div id="scroll2top">
<img src="/scroll2top/arrow.png"/>
</div>
<script src="/scroll2top/scroll2top.min.js"></script>
<div id="winterland">
  <canvas></canvas>
</div>
<script src="/js/winterland.min.js"></script>

  </body>
</html>
